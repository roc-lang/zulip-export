[
    {
        "content": "<p>here is how I run tests, via <code>just test</code> <a href=\"https://gist.github.com/rickhull/ad4af8984a40d538ea1e1999af613492\">https://gist.github.com/rickhull/ad4af8984a40d538ea1e1999af613492</a></p>\n<p>This is the within-block usage of <code>expect</code>, not a \"unit test\" (as I understand these terms).  Is this the right way to do the accounting, or am I misusing or under-utilizing Roc / expect features?</p>",
        "id": 569100308,
        "sender_full_name": "Rick Hull",
        "timestamp": 1768933493
    },
    {
        "content": "<p>We have typically been using top level expects defined in the same file as the source for testing.</p>",
        "id": 569100570,
        "sender_full_name": "Anton",
        "timestamp": 1768933603
    },
    {
        "content": "<p>then you would issue <code>roc test</code> right?   how do you perform a comprehensive run across multiple files?</p>",
        "id": 569101584,
        "sender_full_name": "Rick Hull",
        "timestamp": 1768933935
    },
    {
        "content": "<blockquote>\n<p>then you would issue <code>roc test</code> right?</p>\n</blockquote>\n<p>Yes</p>\n<blockquote>\n<p>how do you perform a comprehensive run across multiple files?</p>\n</blockquote>\n<p>In the past with a bash script although I would like (as a new feature) the roc binary to auto-discover all tests in a project.</p>",
        "id": 569102047,
        "sender_full_name": "Anton",
        "timestamp": 1768934088
    },
    {
        "content": "<p>you could allow <code>roc test PATH</code> where PATH is like a subdir.  for a dir, recursive search all .roc files?</p>",
        "id": 569102382,
        "sender_full_name": "Rick Hull",
        "timestamp": 1768934209
    },
    {
        "content": "<p>Sounds good to me :)</p>",
        "id": 569102481,
        "sender_full_name": "Anton",
        "timestamp": 1768934240
    },
    {
        "content": "<p>because I am doing platform development, and host functions are impure, then I cannot use toplevel <code>expect</code> for these functions right?   i think I need the <code>justfile</code> runner</p>",
        "id": 569120085,
        "sender_full_name": "Rick Hull",
        "timestamp": 1768940369
    },
    {
        "content": "<p>it's a little confusing about the different <code>expect</code> behaviors in different contexts (toplevel vs not, pure vs impure, <code>roc test</code> vs <code>roc</code>).  I wonder if there is a way to unify the behaviors. </p>\n<p><span class=\"user-mention\" data-user-id=\"281383\">@Richard Feldman</span> said:</p>\n<blockquote>\n<p>the number one rule of <code>expect</code> is that it never affects control flow in any way<br>\nno matter where it is used<br>\nit is a harmless report<br>\nmaybe a better way to think of it is \"debug print that an expectation was false, and then mark this test as 'must fail' when it finishes running\"</p>\n</blockquote>",
        "id": 569121184,
        "sender_full_name": "Rick Hull",
        "timestamp": 1768940772
    },
    {
        "content": "<p>Keep in mind that it's possible that things aren't yet implemented, or if they are it's a first pass and needs polish. I have been slow rolling the platform development and fixings bugs as I find them. Almost everything I've worked on has had a few significant bugs, and most of my time was spent trying to understand what the behaviour should be so I could properly isolate and describe the bug. If you find any issues it would be helpful to investigate, it's probably not you but just something is broken.</p>",
        "id": 569126395,
        "sender_full_name": "Luke Boswell",
        "timestamp": 1768942711
    },
    {
        "content": "<p>Thanks Luke; to answer my own question a bit, I keep all my \"host functions\" in <code>platform/Host.roc</code>, though it's not necessary to do it this way.  I have now isolated all my impure function testing to <code>test/host.roc</code>, which only calls functions from <code>platform/Host.roc</code>; thus I don't need a \"test runner\" at this point as I only have a single <code>test/*.roc</code> file</p>\n<p>I migrated all other <code>test/*.roc</code> tests to \"unit tests\" at the toplevel within the source-file-under-test</p>",
        "id": 569126809,
        "sender_full_name": "Rick Hull",
        "timestamp": 1768942888
    },
    {
        "content": "<p><code>roc test DIR</code>: <a href=\"https://github.com/roc-lang/roc/issues/9057\">https://github.com/roc-lang/roc/issues/9057</a></p>",
        "id": 569130532,
        "sender_full_name": "Rick Hull",
        "timestamp": 1768944324
    }
]