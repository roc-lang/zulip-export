[
    {
        "content": "<p>I am currently trying to write the glue spec for go, using the <a href=\"https://github.com/lukewilliamboswell/roc-platform-template-go\">roc-platform-template</a> from <span class=\"user-mention\" data-user-id=\"515757\">@Luke Boswell</span> </p>\n<p>As a first step, I am trying to generate the <code>.h</code> file. The result should look like this:</p>\n<div class=\"codehilite\" data-code-language=\"C\"><pre><span></span><code><span class=\"cp\">#include</span><span class=\"w\"> </span><span class=\"cpf\">\"roc_std.h\"</span>\n\n<span class=\"k\">struct</span><span class=\"w\"> </span><span class=\"nc\">ResultVoidI32</span><span class=\"w\"> </span><span class=\"p\">{</span>\n<span class=\"w\">    </span><span class=\"k\">union</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"kt\">long</span><span class=\"w\"> </span><span class=\"kt\">int</span><span class=\"w\"> </span><span class=\"n\">exit_code</span><span class=\"p\">;}</span><span class=\"w\"> </span><span class=\"n\">payload</span><span class=\"p\">;</span>\n<span class=\"w\">    </span><span class=\"kt\">unsigned</span><span class=\"w\"> </span><span class=\"kt\">char</span><span class=\"w\"> </span><span class=\"n\">disciminant</span><span class=\"p\">;</span>\n<span class=\"p\">};</span>\n\n<span class=\"k\">struct</span><span class=\"w\"> </span><span class=\"nc\">ResultVoidStr</span><span class=\"w\"> </span><span class=\"p\">{</span>\n<span class=\"w\">    </span><span class=\"k\">union</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"k\">struct</span><span class=\"w\"> </span><span class=\"nc\">RocStr</span><span class=\"w\"> </span><span class=\"n\">str</span><span class=\"p\">;}</span><span class=\"w\"> </span><span class=\"n\">payload</span><span class=\"p\">;</span>\n<span class=\"w\">    </span><span class=\"kt\">unsigned</span><span class=\"w\"> </span><span class=\"kt\">char</span><span class=\"w\"> </span><span class=\"n\">disciminant</span><span class=\"p\">;</span>\n<span class=\"p\">};</span>\n\n<span class=\"kt\">void</span><span class=\"w\"> </span><span class=\"nf\">roc__mainForHost_1_exposed_generic</span><span class=\"p\">(</span><span class=\"kt\">void</span><span class=\"o\">*</span><span class=\"w\"> </span><span class=\"n\">captures</span><span class=\"p\">);</span>\n<span class=\"kt\">size_t</span><span class=\"w\"> </span><span class=\"nf\">roc__mainForHost_1_exposed_size</span><span class=\"p\">();</span>\n<span class=\"kt\">void</span><span class=\"w\"> </span><span class=\"nf\">roc__mainForHost_0_caller</span><span class=\"p\">(</span><span class=\"kt\">char</span><span class=\"o\">*</span><span class=\"w\"> </span><span class=\"n\">flags</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"kt\">void</span><span class=\"o\">*</span><span class=\"w\"> </span><span class=\"n\">closure_data</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"k\">struct</span><span class=\"w\"> </span><span class=\"nc\">ResultVoidI32</span><span class=\"w\"> </span><span class=\"o\">*</span><span class=\"n\">result</span><span class=\"p\">);</span>\n</code></pre></div>\n<p>My problem is, that the glue command does not include the functions to the list of types, when calling <code>makeGlue</code> in the spec.  <code>roc__mainForHost_0_caller</code> is included, but not <code>roc__mainForHost_1_exposed_generic</code> and <code>roc__mainForHost_1_exposed_size</code>.</p>\n<p>Is there some way to generate this function definitions?</p>",
        "id": 441379461,
        "sender_full_name": "Oskar Hahn",
        "timestamp": 1717045152
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"281543\">@Folkert de Vries</span> may be best placed to answer this</p>",
        "id": 441379648,
        "sender_full_name": "Luke Boswell",
        "timestamp": 1717045210
    },
    {
        "content": "<p>I tried looking throw the source code from roc, but I can not find the place, where the list of types is collected.</p>\n<p>I think, this happens <a href=\"https://github.com/roc-lang/roc/blob/86726e03e319f317a8ce8a8f4bfcda6562d45284/crates/glue/src/load.rs#L414\">here</a>, <a href=\"https://github.com/roc-lang/roc/blob/86726e03e319f317a8ce8a8f4bfcda6562d45284/crates/compiler/load/src/lib.rs#L145-L167\">here</a> and finally <a href=\"https://github.com/roc-lang/roc/blob/86726e03e319f317a8ce8a8f4bfcda6562d45284/crates/compiler/load_internal/src/file.rs#L1248-L1357\">here</a></p>\n<p>But I am not able, to understand this <code>load</code> function. Could someone give me a hint, for what reason the exported functions could be missing?</p>",
        "id": 442739079,
        "sender_full_name": "Oskar Hahn",
        "timestamp": 1717580464
    }
]