[
    {
        "content": "<p>The code:</p>\n<div class=\"codehilite\" data-code-language=\"F#\"><pre><span></span><code><span class=\"n\">app</span><span class=\"w\"> </span><span class=\"s\">\"day1\"</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"n\">packages</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"w\"> </span><span class=\"n\">pf</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"s\">\"basic-cli/src/main.roc\"</span><span class=\"w\"> </span><span class=\"o\">}</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"n\">imports</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">pf</span><span class=\"o\">.</span><span class=\"n\">Stdout</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">pf</span><span class=\"o\">.</span><span class=\"n\">File</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">pf</span><span class=\"o\">.</span><span class=\"n\">Task</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">pf</span><span class=\"o\">.</span><span class=\"n\">Path</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Json</span><span class=\"o\">]</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"n\">provides</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">main</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"k\">to</span><span class=\"w\"> </span><span class=\"n\">pf</span><span class=\"w\"></span>\n\n<span class=\"n\">main</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"n\">content</span><span class=\"w\"> </span><span class=\"o\">&lt;-</span><span class=\"w\"> </span><span class=\"s\">\"./aoc22/day1.txt\"</span><span class=\"w\"></span>\n<span class=\"w\">        </span><span class=\"o\">|&gt;</span><span class=\"w\"> </span><span class=\"nn\">Path</span><span class=\"p\">.</span><span class=\"n\">fromStr</span><span class=\"w\"></span>\n<span class=\"w\">        </span><span class=\"o\">|&gt;</span><span class=\"w\"> </span><span class=\"nn\">File</span><span class=\"p\">.</span><span class=\"n\">readUtf8</span><span class=\"w\"></span>\n<span class=\"w\">        </span><span class=\"o\">|&gt;</span><span class=\"w\"> </span><span class=\"nn\">Task</span><span class=\"p\">.</span><span class=\"n\">onFail</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"err\">\\</span><span class=\"n\">err</span><span class=\"w\"> </span><span class=\"o\">-&gt;</span><span class=\"w\"></span>\n<span class=\"w\">            </span><span class=\"k\">when</span><span class=\"w\"> </span><span class=\"n\">err</span><span class=\"w\"> </span><span class=\"n\">is</span><span class=\"w\"></span>\n<span class=\"w\">                </span><span class=\"n\">FileReadUtf8Err</span><span class=\"w\"> </span><span class=\"o\">_</span><span class=\"n\">path</span><span class=\"w\"> </span><span class=\"o\">_</span><span class=\"n\">fileErr</span><span class=\"w\"> </span><span class=\"o\">-&gt;</span><span class=\"w\"> </span><span class=\"n\">crash</span><span class=\"w\"> </span><span class=\"s\">\"FileReadUtf8Err\"</span><span class=\"w\"></span>\n<span class=\"w\">                </span><span class=\"n\">FileReadErr</span><span class=\"w\"> </span><span class=\"o\">_</span><span class=\"w\"> </span><span class=\"o\">_</span><span class=\"w\"> </span><span class=\"o\">-&gt;</span><span class=\"w\"> </span><span class=\"n\">crash</span><span class=\"w\"> </span><span class=\"s\">\"FileReadErr: asd\"</span><span class=\"w\"></span>\n<span class=\"w\">        </span><span class=\"o\">)</span><span class=\"w\"></span>\n<span class=\"w\">        </span><span class=\"o\">|&gt;</span><span class=\"w\"> </span><span class=\"nn\">Task</span><span class=\"p\">.</span><span class=\"n\">await</span><span class=\"w\"></span>\n\n<span class=\"w\">    </span><span class=\"n\">split</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">content</span><span class=\"w\"></span>\n<span class=\"w\">        </span><span class=\"o\">|&gt;</span><span class=\"w\"> </span><span class=\"nn\">Str</span><span class=\"p\">.</span><span class=\"n\">split</span><span class=\"w\"> </span><span class=\"s\">\"</span><span class=\"se\">\\n</span><span class=\"s\">\"</span><span class=\"w\"></span>\n<span class=\"w\">        </span><span class=\"o\">|&gt;</span><span class=\"w\"> </span><span class=\"nn\">List</span><span class=\"p\">.</span><span class=\"n\">split</span><span class=\"w\"> </span><span class=\"s\">\"\"</span><span class=\"w\"></span>\n\n<span class=\"w\">    </span><span class=\"n\">split</span><span class=\"w\"></span>\n<span class=\"w\">        </span><span class=\"o\">|&gt;</span><span class=\"w\"> </span><span class=\"nn\">Encode</span><span class=\"p\">.</span><span class=\"n\">toBytes</span><span class=\"w\"> </span><span class=\"nn\">Json</span><span class=\"p\">.</span><span class=\"n\">toUtf8</span><span class=\"w\"></span>\n<span class=\"w\">        </span><span class=\"o\">|&gt;</span><span class=\"w\"> </span><span class=\"nn\">Str</span><span class=\"p\">.</span><span class=\"n\">fromUtf8</span><span class=\"w\"></span>\n<span class=\"w\">        </span><span class=\"o\">|&gt;</span><span class=\"w\"> </span><span class=\"nn\">Result</span><span class=\"p\">.</span><span class=\"n\">withDefault</span><span class=\"w\"> </span><span class=\"s\">\"err\"</span><span class=\"w\"></span>\n<span class=\"w\">        </span><span class=\"o\">|&gt;</span><span class=\"w\"> </span><span class=\"nn\">Stdout</span><span class=\"p\">.</span><span class=\"n\">line</span><span class=\"w\"></span>\n</code></pre></div>\n<p>The error:</p>\n<div class=\"codehilite\"><pre><span></span><code>thread &#39;main&#39; panicked at &#39;internal error: entered unreachable code: symbol/layout `pf.InternalTask.fromEffect` ProcLayout {\n    arguments: [\n        LambdaSet(\n            LambdaSet {\n                set: [\n                    ( pf.Effect.30, [LambdaSet(LambdaSet { set: [( pf.Effect.76, [Union(NonRecursive([]))])], representation: Interned(12, PhantomData) }), LambdaSet(LambdaSet { set: [( pf.Stdout.3, [])], representation: Interned(3, PhantomData) })]),\n                    ( pf.Effect.32, [Struct { field_order_hash: FieldOrderHash(0), field_layouts: [] }]),\n                ],\n                representation: Interned(\n                    13,\n                    PhantomData,\n                ),\n            },\n        ),\n    ],\n    result: LambdaSet(\n        LambdaSet {\n            set: [\n                ( pf.Effect.30, [LambdaSet(LambdaSet { set: [( pf.Effect.76, [Union(NonRecursive([]))])], representation: Interned(12, PhantomData) }), LambdaSet(LambdaSet { set: [( pf.Stdout.3, [])], representation: Interned(3, PhantomData) })]),\n                ( pf.Effect.32, [Struct { field_order_hash: FieldOrderHash(0), field_layouts: [] }]),\n            ],\n            representation: Interned(\n                13,\n                PhantomData,\n            ),\n        },\n    ),\n    captures_niche: CapturesNiche(\n        [],\n    ),\n} combo must be in DeclarationToIndex&#39;, crates/compiler/mono/src/borrow.rs:165:9\n\nstack backtrace:\n   0: rust_begin_unwind\n             at /rustc/a55dd71d5fb0ec5a6a3a9e8c27b2127ba491ce52/library/std/src/panicking.rs:584:5\n   1: core::panicking::panic_fmt\n             at /rustc/a55dd71d5fb0ec5a6a3a9e8c27b2127ba491ce52/library/core/src/panicking.rs:142:14\n   2: roc_mono::borrow::DeclarationToIndex::get_param_offset\n             at ./crates/compiler/mono/src/borrow.rs:165:9\n   3: roc_mono::borrow::ParamMap::get_param_offset\n             at ./crates/compiler/mono/src/borrow.rs:188:9\n   4: roc_mono::borrow::ParamMap::get_symbol\n             at ./crates/compiler/mono/src/borrow.rs:193:28\n   5: roc_mono::borrow::BorrowInfState::collect_call\n             at ./crates/compiler/mono/src/borrow.rs:509:26\n   6: roc_mono::borrow::BorrowInfState::collect_expr\n             at ./crates/compiler/mono/src/borrow.rs:679:27\n   7: roc_mono::borrow::BorrowInfState::collect_stmt\n             at ./crates/compiler/mono/src/borrow.rs:792:17\n   8: roc_mono::borrow::BorrowInfState::collect_proc\n             at ./crates/compiler/mono/src/borrow.rs:856:9\n   9: roc_mono::borrow::infer_borrow\n             at ./crates/compiler/mono/src/borrow.rs:83:17\n  10: roc_mono::ir::Proc::insert_refcount_operations\n             at ./crates/compiler/mono/src/ir.rs:398:41\n  11: roc_load_internal::file::update\n             at ./crates/compiler/load_internal/src/file.rs:2912:21\n  12: roc_load_internal::file::state_thread_step\n             at ./crates/compiler/load_internal/src/file.rs:1749:37\n  13: roc_load_internal::file::load_multi_threaded::{{closure}}\n             at ./crates/compiler/load_internal/src/file.rs:1970:23\n  14: crossbeam_utils::thread::scope::{{closure}}\n             at /home/juliano/.cargo/registry/src/github.com-1ecc6299db9ec823/crossbeam-utils-0.8.10/src/thread.rs:161:65\n  15: &lt;core::panic::unwind_safe::AssertUnwindSafe&lt;F&gt; as core::ops::function::FnOnce&lt;()&gt;&gt;::call_once\n             at /rustc/a55dd71d5fb0ec5a6a3a9e8c27b2127ba491ce52/library/core/src/panic/unwind_safe.rs:271:9\n  16: std::panicking::try::do_call\n             at /rustc/a55dd71d5fb0ec5a6a3a9e8c27b2127ba491ce52/library/std/src/panicking.rs:492:40\n  17: __rust_try\n  18: std::panicking::try\n             at /rustc/a55dd71d5fb0ec5a6a3a9e8c27b2127ba491ce52/library/std/src/panicking.rs:456:19\n  19: std::panic::catch_unwind\n             at /rustc/a55dd71d5fb0ec5a6a3a9e8c27b2127ba491ce52/library/std/src/panic.rs:137:14\n  20: crossbeam_utils::thread::scope\n             at /home/juliano/.cargo/registry/src/github.com-1ecc6299db9ec823/crossbeam-utils-0.8.10/src/thread.rs:161:18\n  21: roc_load_internal::file::load_multi_threaded\n             at ./crates/compiler/load_internal/src/file.rs:1908:9\n  22: roc_load_internal::file::load\n             at ./crates/compiler/load_internal/src/file.rs:1543:35\n  23: roc_load::load\n             at ./crates/compiler/load/src/lib.rs:35:5\n  24: roc_load::load_and_monomorphize\n             at ./crates/compiler/load/src/lib.rs:132:11\n  25: roc_cli::build::build_file\n             at ./crates/cli/src/build.rs:95:23\n  26: roc_cli::build\n             at ./crates/cli/src/lib.rs:655:27\n  27: roc::main\n             at ./crates/cli/src/main.rs:52:17\n  28: core::ops::function::FnOnce::call_once\n             at /rustc/a55dd71d5fb0ec5a6a3a9e8c27b2127ba491ce52/library/core/src/ops/function.rs:248:5\n</code></pre></div>",
        "id": 313698998,
        "sender_full_name": "Juliano",
        "timestamp": 1670079699
    },
    {
        "content": "<p>Oh, 'List.split' doesn't do what I expect, nvm.</p>\n<p>I tried to write my own split by character, and I got another panic.</p>\n<p>The code</p>\n<div class=\"codehilite\" data-code-language=\"F#\"><pre><span></span><code><span class=\"n\">app</span><span class=\"w\"> </span><span class=\"s\">\"day1\"</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"n\">packages</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"w\"> </span><span class=\"n\">pf</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"s\">\"basic-cli/src/main.roc\"</span><span class=\"w\"> </span><span class=\"o\">}</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"n\">imports</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">pf</span><span class=\"o\">.</span><span class=\"n\">Stdout</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">pf</span><span class=\"o\">.</span><span class=\"n\">File</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">pf</span><span class=\"o\">.</span><span class=\"n\">Task</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">pf</span><span class=\"o\">.</span><span class=\"n\">Path</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Json</span><span class=\"o\">]</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"n\">provides</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">main</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"k\">to</span><span class=\"w\"> </span><span class=\"n\">pf</span><span class=\"w\"></span>\n\n<span class=\"n\">splitListOn</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">List</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">-&gt;</span><span class=\"w\"> </span><span class=\"n\">List</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">List</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">)</span><span class=\"w\"></span>\n<span class=\"n\">splitListOn</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"err\">\\</span><span class=\"kt\">list</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">delim</span><span class=\"w\"> </span><span class=\"o\">-&gt;</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"o\">{</span><span class=\"n\">cur</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">acc</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"nn\">List</span><span class=\"p\">.</span><span class=\"n\">walk</span><span class=\"w\"> </span><span class=\"kt\">list</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">cur</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">[]</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">acc</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">[]</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"err\">\\</span><span class=\"o\">{</span><span class=\"n\">cur</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">acc</span><span class=\"o\">},</span><span class=\"w\"> </span><span class=\"n\">elem</span><span class=\"w\"> </span><span class=\"o\">-&gt;</span><span class=\"w\"></span>\n<span class=\"w\">        </span><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"n\">elem</span><span class=\"w\"> </span><span class=\"o\">==</span><span class=\"w\"> </span><span class=\"n\">delim</span><span class=\"w\"> </span><span class=\"k\">then</span><span class=\"w\"></span>\n<span class=\"w\">            </span><span class=\"o\">{</span><span class=\"n\">cur</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">[]</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">acc</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"nn\">List</span><span class=\"p\">.</span><span class=\"n\">append</span><span class=\"w\"> </span><span class=\"n\">acc</span><span class=\"w\"> </span><span class=\"n\">cur</span><span class=\"o\">}</span><span class=\"w\"></span>\n<span class=\"w\">        </span><span class=\"k\">else</span><span class=\"w\"></span>\n<span class=\"w\">            </span><span class=\"o\">{</span><span class=\"n\">cur</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"nn\">List</span><span class=\"p\">.</span><span class=\"n\">append</span><span class=\"w\"> </span><span class=\"n\">cur</span><span class=\"w\"> </span><span class=\"n\">elem</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">acc</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">acc</span><span class=\"o\">}</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"o\">)</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"n\">acc</span><span class=\"w\"></span>\n\n<span class=\"n\">main</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"n\">content</span><span class=\"w\"> </span><span class=\"o\">&lt;-</span><span class=\"w\"> </span><span class=\"s\">\"./aoc22/day1.txt\"</span><span class=\"w\"></span>\n<span class=\"w\">        </span><span class=\"o\">|&gt;</span><span class=\"w\"> </span><span class=\"nn\">Path</span><span class=\"p\">.</span><span class=\"n\">fromStr</span><span class=\"w\"></span>\n<span class=\"w\">        </span><span class=\"o\">|&gt;</span><span class=\"w\"> </span><span class=\"nn\">File</span><span class=\"p\">.</span><span class=\"n\">readUtf8</span><span class=\"w\"></span>\n<span class=\"w\">        </span><span class=\"o\">|&gt;</span><span class=\"w\"> </span><span class=\"nn\">Task</span><span class=\"p\">.</span><span class=\"n\">onFail</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"err\">\\</span><span class=\"n\">err</span><span class=\"w\"> </span><span class=\"o\">-&gt;</span><span class=\"w\"></span>\n<span class=\"w\">            </span><span class=\"k\">when</span><span class=\"w\"> </span><span class=\"n\">err</span><span class=\"w\"> </span><span class=\"n\">is</span><span class=\"w\"></span>\n<span class=\"w\">                </span><span class=\"n\">FileReadUtf8Err</span><span class=\"w\"> </span><span class=\"o\">_</span><span class=\"n\">path</span><span class=\"w\"> </span><span class=\"o\">_</span><span class=\"n\">fileErr</span><span class=\"w\"> </span><span class=\"o\">-&gt;</span><span class=\"w\"> </span><span class=\"n\">crash</span><span class=\"w\"> </span><span class=\"s\">\"FileReadUtf8Err\"</span><span class=\"w\"></span>\n<span class=\"w\">                </span><span class=\"n\">FileReadErr</span><span class=\"w\"> </span><span class=\"o\">_</span><span class=\"w\"> </span><span class=\"o\">_</span><span class=\"w\"> </span><span class=\"o\">-&gt;</span><span class=\"w\"> </span><span class=\"n\">crash</span><span class=\"w\"> </span><span class=\"s\">\"FileReadErr: asd\"</span><span class=\"w\"></span>\n<span class=\"w\">        </span><span class=\"o\">)</span><span class=\"w\"></span>\n<span class=\"w\">        </span><span class=\"o\">|&gt;</span><span class=\"w\"> </span><span class=\"nn\">Task</span><span class=\"p\">.</span><span class=\"n\">await</span><span class=\"w\"></span>\n\n<span class=\"w\">    </span><span class=\"n\">split</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">content</span><span class=\"w\"></span>\n<span class=\"w\">        </span><span class=\"o\">|&gt;</span><span class=\"w\"> </span><span class=\"nn\">Str</span><span class=\"p\">.</span><span class=\"n\">split</span><span class=\"w\"> </span><span class=\"s\">\"</span><span class=\"se\">\\n</span><span class=\"s\">\"</span><span class=\"w\"></span>\n<span class=\"w\">        </span><span class=\"o\">|&gt;</span><span class=\"w\"> </span><span class=\"n\">splitListOn</span><span class=\"w\"> </span><span class=\"s\">\"\"</span><span class=\"w\"></span>\n\n<span class=\"w\">    </span><span class=\"n\">split</span><span class=\"w\"></span>\n<span class=\"w\">        </span><span class=\"o\">|&gt;</span><span class=\"w\"> </span><span class=\"nn\">Encode</span><span class=\"p\">.</span><span class=\"n\">toBytes</span><span class=\"w\"> </span><span class=\"nn\">Json</span><span class=\"p\">.</span><span class=\"n\">toUtf8</span><span class=\"w\"></span>\n<span class=\"w\">        </span><span class=\"o\">|&gt;</span><span class=\"w\"> </span><span class=\"nn\">Str</span><span class=\"p\">.</span><span class=\"n\">fromUtf8</span><span class=\"w\"></span>\n<span class=\"w\">        </span><span class=\"o\">|&gt;</span><span class=\"w\"> </span><span class=\"nn\">Result</span><span class=\"p\">.</span><span class=\"n\">withDefault</span><span class=\"w\"> </span><span class=\"s\">\"err\"</span><span class=\"w\"></span>\n<span class=\"w\">        </span><span class=\"o\">|&gt;</span><span class=\"w\"> </span><span class=\"nn\">Stdout</span><span class=\"p\">.</span><span class=\"n\">line</span><span class=\"w\"></span>\n</code></pre></div>\n<p>The error:</p>\n<div class=\"codehilite\"><pre><span></span><code>thread &#39;main&#39; panicked at &#39;internal error: entered unreachable code: symbol/layout `pf.InternalTask.fromEffect` ProcLayout {\n    arguments: [\n        LambdaSet(\n            LambdaSet {\n                set: [\n                    ( pf.Effect.30, [LambdaSet(LambdaSet { set: [( pf.Effect.76, [Union(NonRecursive([]))])], representation: Interned(12, PhantomData) }), LambdaSet(LambdaSet { set: [( pf.Stdout.3, [])], representation: Interned(3, PhantomData) })]),\n                    ( pf.Effect.32, [Struct { field_order_hash: FieldOrderHash(0), field_layouts: [] }]),\n                ],\n                representation: Interned(\n                    13,\n                    PhantomData,\n                ),\n            },\n        ),\n    ],\n    result: LambdaSet(\n        LambdaSet {\n            set: [\n                ( pf.Effect.30, [LambdaSet(LambdaSet { set: [( pf.Effect.76, [Union(NonRecursive([]))])], representation: Interned(12, PhantomData) }), LambdaSet(LambdaSet { set: [( pf.Stdout.3, [])], representation: Interned(3, PhantomData) })]),\n                ( pf.Effect.32, [Struct { field_order_hash: FieldOrderHash(0), field_layouts: [] }]),\n            ],\n            representation: Interned(\n                13,\n                PhantomData,\n            ),\n        },\n    ),\n    captures_niche: CapturesNiche(\n        [],\n    ),\n} combo must be in DeclarationToIndex&#39;, crates/compiler/mono/src/borrow.rs:165:9\nstack backtrace:\n   0: rust_begin_unwind\n             at /rustc/a55dd71d5fb0ec5a6a3a9e8c27b2127ba491ce52/library/std/src/panicking.rs:584:5\n   1: core::panicking::panic_fmt\n             at /rustc/a55dd71d5fb0ec5a6a3a9e8c27b2127ba491ce52/library/core/src/panicking.rs:142:14\n   2: roc_mono::borrow::DeclarationToIndex::get_param_offset\n             at ./crates/compiler/mono/src/borrow.rs:165:9\n   3: roc_mono::borrow::ParamMap::get_param_offset\n             at ./crates/compiler/mono/src/borrow.rs:188:9\n   4: roc_mono::borrow::ParamMap::get_symbol\n             at ./crates/compiler/mono/src/borrow.rs:193:28\n   5: roc_mono::borrow::BorrowInfState::collect_call\n             at ./crates/compiler/mono/src/borrow.rs:509:26\n   6: roc_mono::borrow::BorrowInfState::collect_expr\n             at ./crates/compiler/mono/src/borrow.rs:679:27\n   7: roc_mono::borrow::BorrowInfState::collect_stmt\n             at ./crates/compiler/mono/src/borrow.rs:792:17\n   8: roc_mono::borrow::BorrowInfState::collect_proc\n             at ./crates/compiler/mono/src/borrow.rs:856:9\n   9: roc_mono::borrow::infer_borrow\n             at ./crates/compiler/mono/src/borrow.rs:83:17\n  10: roc_mono::ir::Proc::insert_refcount_operations\n             at ./crates/compiler/mono/src/ir.rs:398:41\n  11: roc_load_internal::file::update\n             at ./crates/compiler/load_internal/src/file.rs:2912:21\n  12: roc_load_internal::file::state_thread_step\n             at ./crates/compiler/load_internal/src/file.rs:1749:37\n  13: roc_load_internal::file::load_multi_threaded::{{closure}}\n             at ./crates/compiler/load_internal/src/file.rs:1970:23\n  14: crossbeam_utils::thread::scope::{{closure}}\n             at /home/juliano/.cargo/registry/src/github.com-1ecc6299db9ec823/crossbeam-utils-0.8.10/src/thread.rs:161:65\n  15: &lt;core::panic::unwind_safe::AssertUnwindSafe&lt;F&gt; as core::ops::function::FnOnce&lt;()&gt;&gt;::call_once\n             at /rustc/a55dd71d5fb0ec5a6a3a9e8c27b2127ba491ce52/library/core/src/panic/unwind_safe.rs:271:9\n  16: std::panicking::try::do_call\n             at /rustc/a55dd71d5fb0ec5a6a3a9e8c27b2127ba491ce52/library/std/src/panicking.rs:492:40\n  17: __rust_try\n  18: std::panicking::try\n             at /rustc/a55dd71d5fb0ec5a6a3a9e8c27b2127ba491ce52/library/std/src/panicking.rs:456:19\n  19: std::panic::catch_unwind\n             at /rustc/a55dd71d5fb0ec5a6a3a9e8c27b2127ba491ce52/library/std/src/panic.rs:137:14\n  20: crossbeam_utils::thread::scope\n             at /home/juliano/.cargo/registry/src/github.com-1ecc6299db9ec823/crossbeam-utils-0.8.10/src/thread.rs:161:18\n  21: roc_load_internal::file::load_multi_threaded\n             at ./crates/compiler/load_internal/src/file.rs:1908:9\n  22: roc_load_internal::file::load\n             at ./crates/compiler/load_internal/src/file.rs:1543:35\n  23: roc_load::load\n             at ./crates/compiler/load/src/lib.rs:35:5\n  24: roc_load::load_and_monomorphize\n             at ./crates/compiler/load/src/lib.rs:132:11\n  25: roc_cli::build::build_file\n             at ./crates/cli/src/build.rs:95:23\n  26: roc_cli::build\n             at ./crates/cli/src/lib.rs:655:27\n  27: roc::main\n             at ./crates/cli/src/main.rs:52:17\n  28: core::ops::function::FnOnce::call_once\n             at /rustc/a55dd71d5fb0ec5a6a3a9e8c27b2127ba491ce52/library/core/src/ops/function.rs:248:5\n</code></pre></div>",
        "id": 313699343,
        "sender_full_name": "Juliano",
        "timestamp": 1670079861
    },
    {
        "content": "<p>removing <code>|&gt; splitListOn \"\"</code> made the panic go away and showed me other compilation errors.</p>\n<p>some were weird, some were good:</p>\n<div class=\"codehilite\"><pre><span></span><code>── DUPLICATE NAME ───────────────────────────────────────────── aoc22/day1.roc ─\n\nThe cur name is first defined here:\n\n8│      {cur, acc} = List.walk list {cur: [], acc: []} (\\{cur, acc}, elem -&gt;\n        ^^^^^^^^^^\n\nBut then it&#39;s defined a second time here:\n\n8│      {cur, acc} = List.walk list {cur: [], acc: []} (\\{cur, acc}, elem -&gt;\n                                                         ^^^^^^^^^^\n\nSince these variables have the same name, it&#39;s easy to use the wrong\none on accident. Give one of them a new name.\n\n\n── DUPLICATE NAME ───────────────────────────────────────────── aoc22/day1.roc ─\n\nThe acc name is first defined here:\n\n8│      {cur, acc} = List.walk list {cur: [], acc: []} (\\{cur, acc}, elem -&gt;\n        ^^^^^^^^^^\n\nBut then it&#39;s defined a second time here:\n\n8│      {cur, acc} = List.walk list {cur: [], acc: []} (\\{cur, acc}, elem -&gt;\n                                                         ^^^^^^^^^^\n\nSince these variables have the same name, it&#39;s easy to use the wrong\none on accident. Give one of them a new name.\n\n\n── TYPE MISMATCH ────────────────────────────────────────────── aoc22/day1.roc ─\n\nThis 2nd argument to isEq has an unexpected type:\n\n9│          if elem == delim then\n                       ^^^^^\n\nThis delim value is a:\n\n    a\n\nBut isEq needs its 2nd argument to be:\n\n    a | a has Eq\n\nTip: The type annotation uses the type variable a to say that this\ndefinition can produce any type of value. But in the body I see that\nit will only produce an instance of the ability Eq of a single\nspecific type. Maybe change the type annotation to be more specific?\nMaybe change the code to be more general?\n\n\n── CIRCULAR DEFINITION ──────────────────────────────────────── aoc22/day1.roc ─\n\nThe cur definition is causing a very tricky infinite loop:\n\n8│      {cur, acc} = List.walk list {cur: [], acc: []} (\\{cur, acc}, elem -&gt;\n         ^^^\n\nThe cur value depends on itself through the following chain of\ndefinitions:\n\n    ┌─────┐\n    │     cur\n    │     ↓\n    │     acc\n    └─────┘\n\n────────────────────────────────────────────────────────────────────────────────\n\n4 errors and 1 warning found in 2987 ms.\n</code></pre></div>",
        "id": 313701790,
        "sender_full_name": "Juliano",
        "timestamp": 1670080972
    },
    {
        "content": "<p>the Eq restriction on <code>a</code> was <span aria-label=\"thumbs up\" class=\"emoji emoji-1f44d\" role=\"img\" title=\"thumbs up\">:thumbs_up:</span> </p>\n<p>the duplicate names were silly, i think? i don't think there's a problem with:</p>\n<div class=\"codehilite\"><pre><span></span><code>x = List.map [1] (\\x -&gt; x+1)\n# or closer to what i did\n{a} = {a: 1} |&gt; (\\{a} -&gt; {a: a+1})\n</code></pre></div>\n<p>and with record destructuring we _have_ to use the same name</p>\n<p>the circular dependency, i've no idea how the compiler got there</p>",
        "id": 313702240,
        "sender_full_name": "Juliano",
        "timestamp": 1670081201
    },
    {
        "content": "<p>after working around compilation errors, re-adding <code>|&gt; splitListOn \"\"</code> didn't panic anymore</p>",
        "id": 313702335,
        "sender_full_name": "Juliano",
        "timestamp": 1670081239
    },
    {
        "content": "<p>Maybe not helpful here, but definitely try running <code>roc check ...</code> when you hit errors like this. It is a lot less likely to crash and will hopefully show the issue that is causing the crash.</p>",
        "id": 313711248,
        "sender_full_name": "Brendan Hansknecht",
        "timestamp": 1670085985
    },
    {
        "content": "<p>Also, roc doesn't allow shadowing so the circular definition is probably from naming the returned value <code>cur</code> and having <code>cur</code> as an argument to the lambda. Roc is trying to make them the same thing. Which is why it is getting such a messy error, i think.</p>\n<p>(At least that is my guess)</p>",
        "id": 313711437,
        "sender_full_name": "Brendan Hansknecht",
        "timestamp": 1670086100
    },
    {
        "content": "<p>Also, you can change name with record destructoring: <code>\\{a: newNameA} -&gt; #use newNameA</code></p>",
        "id": 313711630,
        "sender_full_name": "Brendan Hansknecht",
        "timestamp": 1670086239
    },
    {
        "content": "<p>Hi everyone a Roc newbie here. I'm trying to follow the tutorial but I get stuck on the \"<a href=\"https://www.roc-lang.org/tutorial#building-an-application\">Building an Application</a>\" section.</p>\n<div class=\"codehilite\"><pre><span></span><code>$ roc dev\n── FILE NOT FOUND ──────────────────────────────────────────────── UNKNOWN.roc ─\n\nI am looking for this file, but it&#39;s not there:\n\n    https://github.com/roc-lang/basic-cli/releases/download/0.1.1/zAoiC9xtQPHywYk350_b7ust04BmWLW00sjb9ZPtSQk.tar.br\n\nIs the file supposed to be there? Maybe there is a typo in the file\nname?%\n</code></pre></div>",
        "id": 313718972,
        "sender_full_name": "OliverHR",
        "timestamp": 1670090758
    },
    {
        "content": "<p>Hi Oliver, do you happen to be on a macos x86_64 device?</p>",
        "id": 313720424,
        "sender_full_name": "Anton",
        "timestamp": 1670091602
    },
    {
        "content": "<p>Hi Anton, yep I'm using an intel macbook running macOS Monterey 12.6.1</p>",
        "id": 313720680,
        "sender_full_name": "OliverHR",
        "timestamp": 1670091750
    },
    {
        "content": "<p>A workaround is mentioned in <a href=\"https://github.com/roc-lang/roc/issues/4655\">this issue</a>, I hope to resolve the issue next week. I also have a PR in the oven that adds some warnings in the docs for this issue.</p>",
        "id": 313721242,
        "sender_full_name": "Anton",
        "timestamp": 1670092142
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"361169\">@Anton</span> before I read your comment I've tried decompressing the file tar-brotli and used in the packages section but it didn't work.</p>\n<p>But I tried what you suggested on the github issue and it worked!, thank you very much!</p>\n<div class=\"codehilite\"><pre><span></span><code>app &quot;cli-tutorial&quot;\n    packages { pf: &quot;basic-cli/src/main.roc&quot; }\n    imports [pf.Stdout]\n    provides [main] to pf\n\nmain =\n    Stdout.line &quot;Hello, World!&quot;\n</code></pre></div>",
        "id": 313721950,
        "sender_full_name": "OliverHR",
        "timestamp": 1670092566
    },
    {
        "content": "<p>Happy to help :)</p>",
        "id": 313722654,
        "sender_full_name": "Anton",
        "timestamp": 1670093093
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"361169\">Anton</span> <a href=\"#narrow/stream/231634-beginners/topic/Compiler.20panic.20encoding.20list.20of.20lists.3F/near/313721242\">said</a>:</p>\n<blockquote>\n<p>A workaround is mentioned in <a href=\"https://github.com/roc-lang/roc/issues/4655\">this issue</a>, I hope to resolve the issue next week. I also have a PR in the oven that adds some warnings in the docs for this issue.</p>\n</blockquote>\n<p><span class=\"user-mention\" data-user-id=\"361169\">@Anton</span> now that you mention I think is also worth to mention that in this document: <a href=\"https://github.com/roc-lang/roc/blob/main/getting_started/macos_x86_64.md\">\"Roc installation guide for x86_64 macOS systems\"</a></p>\n<p>You can't select the zig version </p>\n<div class=\"codehilite\"><pre><span></span><code># Install the Zig compiler, for apps with Zig-based platforms:\n\nbrew install zig@0.9.1         #   &lt;--- this versioned packages are no longer available\n</code></pre></div>\n<p>We need to install just the \"zig\" package:</p>\n<div class=\"codehilite\"><pre><span></span><code>brew install zig\n</code></pre></div>\n<p>Current zig version (at the moment of the comment is 0.10.0) so I don't know if this affects.</p>",
        "id": 313723729,
        "sender_full_name": "OliverHR",
        "timestamp": 1670093914
    },
    {
        "content": "<p>Yes, that is a problem, zig 0.10.0 will not work. I'll take a look.</p>",
        "id": 313723829,
        "sender_full_name": "Anton",
        "timestamp": 1670093998
    },
    {
        "content": "<p>A workaround:</p>\n<ul>\n<li>remove zig 0.10.0 if you installed it with homebrew</li>\n<li>download zig 0.9.1 from the <a href=\"https://ziglang.org/download/\">zig website</a>. </li>\n<li>add <code>export PATH=$PATH:~/path/to/zig</code> to your shell startup script (.profile, .zshrc, …)</li>\n</ul>\n<p>I'll update the documentation tomorrow.</p>",
        "id": 313726499,
        "sender_full_name": "Anton",
        "timestamp": 1670095779
    },
    {
        "content": "<p>Thanks for bringing this to my attention <span class=\"user-mention\" data-user-id=\"570074\">@OliverHR</span> :)</p>",
        "id": 313726509,
        "sender_full_name": "Anton",
        "timestamp": 1670095795
    },
    {
        "content": "<p>If you are also using Zig for other projects too, you can set the environment variable ROC_ZIG to a specific path for Roc to use.</p>",
        "id": 313727427,
        "sender_full_name": "Brian Carroll",
        "timestamp": 1670096463
    },
    {
        "content": "<p>I didnt know you can change name with destructuring... thats cool!</p>",
        "id": 313728737,
        "sender_full_name": "Luke Boswell",
        "timestamp": 1670097538
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"361169\">@Anton</span> /<span class=\"user-mention\" data-user-id=\"431893\">@Brian Carroll</span> thank for the suggestions, I've installed manually zig 0.9.1 It was pretty straightforward, and to don't mess with my zsh/bash config I use <a href=\"https://direnv.net\">direnv</a>, so in this way with a <code>.envrc</code> file  I set the environment vars I need.</p>",
        "id": 313729526,
        "sender_full_name": "OliverHR",
        "timestamp": 1670098196
    },
    {
        "content": "<p>that <code>roc check</code> tip was pure gold <span class=\"user-mention\" data-user-id=\"343810\">@Brendan Hansknecht</span></p>",
        "id": 313738074,
        "sender_full_name": "Juliano",
        "timestamp": 1670105172
    }
]