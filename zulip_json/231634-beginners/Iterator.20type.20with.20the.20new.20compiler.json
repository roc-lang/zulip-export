[
    {
        "content": "<p>Iâ€™ve read that iterators are not yet part of the new compiler but Iâ€™m curious, if you had to define an <code>Iter</code> type with what exists today in the new compiler, how would you define it?</p>\n<p>For example, in elm, Iâ€™d probably define the type like this:</p>\n<div class=\"codehilite\" data-code-language=\"Elm\"><pre><span></span><code><span class=\"kr\">type</span><span class=\"w\"> </span><span class=\"kt\">Iter</span><span class=\"w\"> </span><span class=\"nv\">a</span><span class=\"w\"> </span><span class=\"nv\">s</span>\n<span class=\"w\">    </span><span class=\"nf\">=</span><span class=\"w\"> </span><span class=\"kt\">Iter</span>\n<span class=\"w\">        </span><span class=\"p\">{</span><span class=\"w\"> </span><span class=\"nv\">state</span><span class=\"w\"> </span><span class=\"nf\">:</span><span class=\"w\"> </span><span class=\"nv\">s</span>\n<span class=\"w\">        </span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"nv\">next_</span><span class=\"w\"> </span><span class=\"nf\">:</span><span class=\"w\"> </span><span class=\"kt\">Next</span><span class=\"w\"> </span><span class=\"nv\">a</span><span class=\"w\"> </span><span class=\"nv\">s</span>\n<span class=\"w\">        </span><span class=\"p\">}</span>\n\n<span class=\"kr\">type</span><span class=\"w\"> </span><span class=\"kr\">alias</span><span class=\"w\"> </span><span class=\"kt\">Next</span><span class=\"w\"> </span><span class=\"nv\">a</span><span class=\"w\"> </span><span class=\"nv\">s</span><span class=\"w\"> </span><span class=\"nf\">=</span>\n<span class=\"w\">    </span><span class=\"nv\">s</span><span class=\"w\"> </span><span class=\"nf\">-&gt;</span><span class=\"w\"> </span><span class=\"kt\">Maybe</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"w\"> </span><span class=\"nv\">a</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"nv\">s</span><span class=\"w\"> </span><span class=\"p\">)</span>\n\n<span class=\"nv\">next</span><span class=\"w\"> </span><span class=\"nf\">:</span><span class=\"w\"> </span><span class=\"kt\">Iter</span><span class=\"w\"> </span><span class=\"nv\">a</span><span class=\"w\"> </span><span class=\"nv\">s</span><span class=\"w\"> </span><span class=\"nf\">-&gt;</span><span class=\"w\"> </span><span class=\"kt\">Maybe</span><span class=\"w\"> </span><span class=\"nv\">a</span>\n<span class=\"nv\">next</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"kt\">Iter</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\"> </span><span class=\"nv\">state</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"nv\">next_</span><span class=\"w\"> </span><span class=\"p\">})</span><span class=\"w\"> </span><span class=\"nf\">=</span>\n<span class=\"w\">    </span><span class=\"kt\">Maybe</span><span class=\"nf\">.</span><span class=\"nv\">map</span><span class=\"w\"> </span><span class=\"kt\">Tuple</span><span class=\"nf\">.</span><span class=\"nv\">first</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"nv\">next_</span><span class=\"w\"> </span><span class=\"nv\">state</span><span class=\"p\">)</span>\n\n<span class=\"nv\">step</span><span class=\"w\"> </span><span class=\"nf\">:</span><span class=\"w\"> </span><span class=\"kt\">Iter</span><span class=\"w\"> </span><span class=\"nv\">a</span><span class=\"w\"> </span><span class=\"nv\">s</span><span class=\"w\"> </span><span class=\"nf\">-&gt;</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"w\"> </span><span class=\"kt\">Maybe</span><span class=\"w\"> </span><span class=\"nv\">a</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"kt\">Iter</span><span class=\"w\"> </span><span class=\"nv\">a</span><span class=\"w\"> </span><span class=\"nv\">s</span><span class=\"w\"> </span><span class=\"p\">)</span>\n<span class=\"nv\">step</span><span class=\"w\"> </span><span class=\"p\">((</span><span class=\"kt\">Iter</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\"> </span><span class=\"nv\">state</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"nv\">next_</span><span class=\"w\"> </span><span class=\"p\">})</span><span class=\"w\"> </span><span class=\"kr\">as</span><span class=\"w\"> </span><span class=\"nv\">iter</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"nf\">=</span>\n<span class=\"w\">    </span><span class=\"kr\">case</span><span class=\"w\"> </span><span class=\"nv\">next_</span><span class=\"w\"> </span><span class=\"nv\">state</span><span class=\"w\"> </span><span class=\"kr\">of</span>\n<span class=\"w\">        </span><span class=\"kt\">Just</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"w\"> </span><span class=\"nv\">a</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"nv\">newState</span><span class=\"w\"> </span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"nf\">-&gt;</span>\n<span class=\"w\">            </span><span class=\"p\">(</span><span class=\"w\"> </span><span class=\"kt\">Just</span><span class=\"w\"> </span><span class=\"nv\">a</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"kt\">Iter</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\"> </span><span class=\"nv\">state</span><span class=\"w\"> </span><span class=\"nf\">=</span><span class=\"w\"> </span><span class=\"nv\">newState</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"nv\">next_</span><span class=\"w\"> </span><span class=\"nf\">=</span><span class=\"w\"> </span><span class=\"nv\">next_</span><span class=\"w\"> </span><span class=\"p\">}</span><span class=\"w\"> </span><span class=\"p\">)</span>\n\n<span class=\"w\">        </span><span class=\"kt\">Nothing</span><span class=\"w\"> </span><span class=\"nf\">-&gt;</span>\n<span class=\"w\">            </span><span class=\"p\">(</span><span class=\"w\"> </span><span class=\"kt\">Nothing</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"nv\">iter</span><span class=\"w\"> </span><span class=\"p\">)</span>\n</code></pre></div>",
        "id": 563298946,
        "sender_full_name": "Matthieu Pizenberg",
        "timestamp": 1765495125
    },
    {
        "content": "<p>Iâ€™m asking because I wanted to experiment a bit with it, but struggling a bit with the type definitions ^^.</p>",
        "id": 563299042,
        "sender_full_name": "Matthieu Pizenberg",
        "timestamp": 1765495197
    },
    {
        "content": "<p>You may find this older thread interesting <a class=\"message-link\" href=\"/#narrow/channel/304641-ideas/topic/Iterators.20and.20fusion.20proposal/near/471140115\">#ideas &gt; Iterators and fusion proposal @ ðŸ’¬</a></p>",
        "id": 563299759,
        "sender_full_name": "Luke Boswell",
        "timestamp": 1765495736
    },
    {
        "content": "<p>interesting, though it doesnâ€™t seem to be up-to-date with the current syntax. Do you have example codebases with lots of different type definitions? I donâ€™t think there are any records or type aliases in Builtin.roc for example.</p>",
        "id": 563300166,
        "sender_full_name": "Matthieu Pizenberg",
        "timestamp": 1765496004
    },
    {
        "content": "<p>There are many examples in the <code>test/snapshots</code> directory which are using the current syntax</p>",
        "id": 563300480,
        "sender_full_name": "Luke Boswell",
        "timestamp": 1765496234
    },
    {
        "content": "<p>Nothing on <code>Iter</code> specifically -- I'm not sure if static dispatch would change the semantics significantly, or if it's just updating the syntax to use parens and commas etc</p>",
        "id": 563300530,
        "sender_full_name": "Luke Boswell",
        "timestamp": 1765496285
    },
    {
        "content": "<p>For example, when I try this:</p>\n<div class=\"codehilite\" data-code-language=\"Ruby\"><pre><span></span><code><span class=\"no\">Iter</span><span class=\"p\">(</span><span class=\"n\">item</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"p\">:</span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"no\">MyIter</span><span class=\"p\">({</span><span class=\"w\"> </span><span class=\"ss\">state</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"k\">next</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"o\">-&gt;</span><span class=\"w\"> </span><span class=\"no\">Try</span><span class=\"p\">((</span><span class=\"n\">item</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"p\">),</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"no\">Empty</span><span class=\"o\">]</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"p\">})</span><span class=\"o\">].</span><span class=\"p\">{</span>\n<span class=\"w\">    </span><span class=\"k\">next</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"o\">|</span><span class=\"no\">MyIter</span><span class=\"p\">(</span><span class=\"n\">myiter</span><span class=\"p\">)</span><span class=\"o\">|</span><span class=\"w\"> </span><span class=\"p\">{</span>\n<span class=\"w\">        </span><span class=\"n\">myiter</span><span class=\"o\">.</span><span class=\"n\">next</span><span class=\"p\">(</span><span class=\"n\">myiter</span><span class=\"o\">.</span><span class=\"n\">state</span><span class=\"p\">)</span>\n<span class=\"w\">    </span><span class=\"p\">}</span>\n<span class=\"p\">}</span>\n</code></pre></div>\n<p>I get this error</p>\n<div class=\"codehilite\"><pre><span></span><code>-- MISSING METHOD --------------------------------\n\nThis next method is being called on a value whose type doesn&#39;t have that method:\n    â”Œâ”€ day03.roc:111:16\n    â”‚\n111 â”‚         myiter.next(myiter.state)\n    â”‚                ^^^^\n\nThe value&#39;s type, which does not have a method named next, is:\n\n    { state: _field }\n</code></pre></div>\n<p>I havenâ€™t found much examples in the snapshots. If you have specific files in mind, let me know.</p>",
        "id": 563302677,
        "sender_full_name": "Matthieu Pizenberg",
        "timestamp": 1765497864
    },
    {
        "content": "<p>Ah I got this one!</p>\n<div class=\"codehilite\" data-code-language=\"Ruby\"><pre><span></span><code><span class=\"no\">Iter</span><span class=\"p\">(</span><span class=\"n\">item</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"p\">:</span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"no\">MyIter</span><span class=\"p\">({</span><span class=\"w\"> </span><span class=\"ss\">state</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"k\">next</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"o\">-&gt;</span><span class=\"w\"> </span><span class=\"no\">Try</span><span class=\"p\">((</span><span class=\"n\">item</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"p\">),</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"no\">Empty</span><span class=\"o\">]</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"p\">})</span><span class=\"o\">].</span><span class=\"p\">{</span>\n<span class=\"w\">    </span><span class=\"k\">next</span><span class=\"w\"> </span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"no\">Iter</span><span class=\"p\">(</span><span class=\"n\">item</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"o\">-&gt;</span><span class=\"w\"> </span><span class=\"no\">Try</span><span class=\"p\">((</span><span class=\"n\">item</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"p\">),</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"no\">Empty</span><span class=\"o\">]</span><span class=\"p\">)</span>\n<span class=\"w\">    </span><span class=\"k\">next</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"o\">|</span><span class=\"no\">MyIter</span><span class=\"p\">(</span><span class=\"n\">myiter</span><span class=\"p\">)</span><span class=\"o\">|</span><span class=\"w\"> </span><span class=\"p\">{</span>\n<span class=\"w\">        </span><span class=\"p\">(</span><span class=\"n\">myiter</span><span class=\"o\">.</span><span class=\"n\">next</span><span class=\"p\">)(</span><span class=\"n\">myiter</span><span class=\"o\">.</span><span class=\"n\">state</span><span class=\"p\">)</span>\n<span class=\"w\">    </span><span class=\"p\">}</span>\n<span class=\"p\">}</span>\n</code></pre></div>",
        "id": 563302996,
        "sender_full_name": "Matthieu Pizenberg",
        "timestamp": 1765498099
    },
    {
        "content": "<p>Is there a way to make a type opaque?</p>",
        "id": 563303169,
        "sender_full_name": "Matthieu Pizenberg",
        "timestamp": 1765498215
    },
    {
        "content": "<p><code>::</code> instead of <code>:=</code></p>",
        "id": 563303696,
        "sender_full_name": "Richard Feldman",
        "timestamp": 1765498474
    }
]