[
    {
        "content": "<p>hi roc friends, i looked at the couple previous nix flake topics but i think this is newer..</p>\n<p>is there an updated flake somewhere with an in-support rust version OR a zig-only version?</p>\n<p>i'm all good with nightly builds, closer to master the better, preferably with a flake to depend on. is this possible right now? should i make some sort of hashed binary derivation instead?</p>",
        "id": 553273845,
        "sender_full_name": "Drewry Pope",
        "timestamp": 1762117490
    },
    {
        "content": "<p>(1.77.2 is eol i think, by default i try to run just a single nixpkgs when possible. i could go ahead and use the roc flake as-is without following my nixpkgs from 2025, but wanted to check first. maybe it's better if i don't rely on this flake for now, add my own derivation directly in my repo?)</p>",
        "id": 553273961,
        "sender_full_name": "Drewry Pope",
        "timestamp": 1762117593
    },
    {
        "content": "<p>Hi <span class=\"user-mention\" data-user-id=\"747334\">@Drewry Pope</span>,</p>\n<blockquote>\n<p>is there an updated flake somewhere with an in-support rust version</p>\n</blockquote>\n<p>No, I have not updated the rust version so I can focus on getting the new compiler ready.</p>\n<blockquote>\n<p>OR a zig-only version?</p>\n</blockquote>\n<p>Yes: <a href=\"https://github.com/roc-lang/roc/blob/main/src/flake.nix\">https://github.com/roc-lang/roc/blob/main/src/flake.nix</a>. But, it is not ready to replace the old compiler yet.</p>",
        "id": 553563667,
        "sender_full_name": "Anton",
        "timestamp": 1762248540
    },
    {
        "content": "<blockquote>\n<p>i could go ahead and use the roc flake as-is without following my nixpkgs from 2025</p>\n</blockquote>\n<p>That would be the approach I recommend.</p>",
        "id": 553563768,
        "sender_full_name": "Anton",
        "timestamp": 1762248568
    },
    {
        "content": "<p>I noticed that the flake for the new Zig compiler doesn't define any output packages, is there a technical reason for that or is it just a lower priority thing?</p>",
        "id": 553747396,
        "sender_full_name": "Hannes",
        "timestamp": 1762306863
    },
    {
        "content": "<p>Yeah, lower priority</p>",
        "id": 553792764,
        "sender_full_name": "Anton",
        "timestamp": 1762331794
    },
    {
        "content": "<p>Cool, because that means I can open a PR for my local branch where I've added it <span aria-label=\"sweat smile\" class=\"emoji emoji-1f605\" role=\"img\" title=\"sweat smile\">:sweat_smile:</span></p>",
        "id": 553799904,
        "sender_full_name": "Hannes",
        "timestamp": 1762333952
    },
    {
        "content": "<p>It's open here: <a href=\"https://github.com/roc-lang/roc/pull/8351\">https://github.com/roc-lang/roc/pull/8351</a></p>",
        "id": 553816044,
        "sender_full_name": "Hannes",
        "timestamp": 1762338436
    },
    {
        "content": "<p>Thanks, I'll check it out :)</p>",
        "id": 553833541,
        "sender_full_name": "Anton",
        "timestamp": 1762343851
    },
    {
        "content": "<p>Hmm, this is going very slowly for me:</p>\n<div class=\"codehilite\"><pre><span></span><code>‚ùØ nix run ./src/#roc\nwarning: Git tree &#39;/Users/username/gitrepos/forks/hasnep/roc&#39; is dirty\n[1/0/1 built] building roc (buildPhase): install -C .zig-cache/o/63519b81310eced5835dbe3ca5ae69cd/roc /nix/var/nix/builds/nix-9378-2989836767/5lsb292nlfn65p09g6aqlfz2bdbsq44h-source/zig-out/bin/roc\n</code></pre></div>\n<p>But when I look in activity monitor it's not using much CPU or memory at all</p>",
        "id": 553838082,
        "sender_full_name": "Anton",
        "timestamp": 1762345050
    },
    {
        "content": "<p>Hey folks - anyone using the new compiler with nix flakes?<br>\nI noticed there is <a href=\"https://github.com/roc-lang/roc/pull/8351\">an open PR</a> but seems inactive.</p>\n<p>IIRC Anton used nix flakes for roc development, right? Do you have any working setup available?</p>",
        "id": 570093601,
        "sender_full_name": "Georges Boris",
        "timestamp": 1769434690
    },
    {
        "content": "<p>Georges, i used to run nixos and I used to do nix flake for some project setup, but I abandoned this approach for a moment.  So i may be able to help a little, maybe not.  But have you seen <a href=\"https://github.com/rickhull/roc-init\">https://github.com/rickhull/roc-init</a> ?</p>",
        "id": 570094667,
        "sender_full_name": "Rick Hull",
        "timestamp": 1769434943
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"364014\">Georges Boris</span> <a href=\"#narrow/channel/231634-beginners/topic/roc.20nix.20flake/near/570093601\">said</a>:</p>\n<blockquote>\n<p>Hey folks - anyone using the new compiler with nix flakes?<br>\nI noticed there is <a href=\"https://github.com/roc-lang/roc/pull/8351\">an open PR</a> but seems inactive.</p>\n<p>IIRC Anton used nix flakes for roc development, right? Do you have any working setup available?</p>\n</blockquote>\n<p>Hi Georges :) we already have a new compiler flake, use it with 'nix develop ./src'</p>",
        "id": 570096906,
        "sender_full_name": "Anton",
        "timestamp": 1769435495
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"364014\">Georges Boris</span> <a href=\"#narrow/channel/231634-beginners/topic/roc.20nix.20flake/near/570093601\">said</a>:</p>\n<blockquote>\n<p>I noticed there is <a href=\"https://github.com/roc-lang/roc/pull/8351\">an open PR</a> but seems inactive.</p>\n</blockquote>\n<p>That PR will become active again next week when I quit my job and have more time to work on Roc again <span aria-label=\"sweat smile\" class=\"emoji emoji-1f605\" role=\"img\" title=\"sweat smile\">:sweat_smile:</span></p>",
        "id": 570098081,
        "sender_full_name": "Hannes",
        "timestamp": 1769435730
    },
    {
        "content": "<p><a href=\"https://github.com/roc-lang/roc/blob/main/src/flake.nix\">https://github.com/roc-lang/roc/blob/main/src/flake.nix</a> # cool</p>",
        "id": 570098297,
        "sender_full_name": "Rick Hull",
        "timestamp": 1769435769
    },
    {
        "content": "<p>Oh and you should know that it seems like you need to run tests from the top level '/'. So I always run <code>nix develop</code> from in /src then go back to / and run <code>zig build test</code></p>",
        "id": 570112565,
        "sender_full_name": "Eli Dowling",
        "timestamp": 1769439121
    },
    {
        "content": "<p>You should be able to run <code>nix develop ./src</code> to use the flake in the src directory</p>",
        "id": 570209960,
        "sender_full_name": "Hannes",
        "timestamp": 1769471806
    }
]