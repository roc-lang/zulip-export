[
    {
        "content": "<p>Are multiline strings supported yet?</p>\n<p>This code runs but prints nothing:</p>\n<div class=\"codehilite\" data-code-language=\"Ruby\"><pre><span></span><code><span class=\"n\">app</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">main!</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\"> </span><span class=\"ss\">pf</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"n\">platform</span><span class=\"w\"> </span><span class=\"s2\">\"https://github.com/lukewilliamboswell/roc-platform-template-zig/releases/download/0.1-test/7iDKk44no3gF9Nrh2VyF8Y5yvy1jUBhrbhHURN1WQptB.tar.zst\"</span><span class=\"w\"> </span><span class=\"p\">}</span>\n\n<span class=\"n\">import</span><span class=\"w\"> </span><span class=\"n\">pf</span><span class=\"o\">.</span><span class=\"n\">Stdout</span>\n\n<span class=\"n\">data</span><span class=\"w\"> </span><span class=\"o\">=</span>\n<span class=\"w\">    </span><span class=\"s2\">\"\"\"</span>\n<span class=\"s2\">    This is a multiline</span>\n<span class=\"s2\">    string.</span>\n<span class=\"s2\">    \"\"\"</span>\n\n\n<span class=\"n\">main!</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"o\">|</span><span class=\"n\">_args</span><span class=\"o\">|</span><span class=\"w\"> </span><span class=\"p\">{</span>\n<span class=\"w\">    </span><span class=\"no\">Stdout</span><span class=\"o\">.</span><span class=\"n\">line!</span><span class=\"p\">(</span><span class=\"n\">data</span><span class=\"p\">)</span>\n<span class=\"w\">    </span><span class=\"no\">Ok</span><span class=\"p\">({})</span>\n<span class=\"p\">}</span>\n</code></pre></div>\n<p>For what it's worth, I initially got a compiler crash when the multiline string was too long (4000+ lines = my AoC day 1 input), and no output when the string was shorter. But then I recompiled the compiler and there's no longer a compiler crash, just no output.</p>",
        "id": 561554971,
        "sender_full_name": "Aurélien Geron",
        "timestamp": 1764730829
    },
    {
        "content": "<p>yes, we changed the syntax - now it's</p>\n<div class=\"codehilite\" data-code-language=\"Zig\"><pre><span></span><code><span class=\"n\">data</span><span class=\"w\"> </span><span class=\"o\">=</span>\n<span class=\"w\">    </span><span class=\"sh\">\\\\This is a multiline</span>\n<span class=\"w\">    </span><span class=\"sh\">\\\\string.</span>\n</code></pre></div>",
        "id": 561555555,
        "sender_full_name": "Richard Feldman",
        "timestamp": 1764731392
    },
    {
        "content": "<p>(same as Zig's syntax)</p>",
        "id": 561555563,
        "sender_full_name": "Richard Feldman",
        "timestamp": 1764731403
    },
    {
        "content": "<p>Oh cool, like in Zig, love it.</p>",
        "id": 561555579,
        "sender_full_name": "Aurélien Geron",
        "timestamp": 1764731416
    },
    {
        "content": "<p>Perhaps using \"\"\" should give a helpful warning / error</p>",
        "id": 561555604,
        "sender_full_name": "Aurélien Geron",
        "timestamp": 1764731454
    },
    {
        "content": "<p>Fixed. However, although the program runs normally now, it ends with:</p>\n<p>error(gpa): memory address 0x103200000 leaked:<br>\nUnable to print stack trace: Unable to open debug info: MissingDebugInfo</p>",
        "id": 561555729,
        "sender_full_name": "Aurélien Geron",
        "timestamp": 1764731592
    },
    {
        "content": "<p>I'm trying to print the number of bytes in my input string:</p>\n<div class=\"codehilite\" data-code-language=\"Ruby\"><pre><span></span><code><span class=\"o\">[...]</span>\n<span class=\"n\">main!</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"o\">|</span><span class=\"n\">_args</span><span class=\"o\">|</span><span class=\"w\"> </span><span class=\"p\">{</span>\n<span class=\"w\">    </span><span class=\"n\">bytes</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">data</span><span class=\"o\">.</span><span class=\"n\">to_utf8</span><span class=\"p\">()</span>\n<span class=\"w\">    </span><span class=\"n\">len</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">bytes</span><span class=\"o\">.</span><span class=\"n\">len</span><span class=\"p\">()</span>\n<span class=\"w\">    </span><span class=\"n\">output</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">len</span><span class=\"o\">.</span><span class=\"n\">to_str</span><span class=\"p\">()</span>\n<span class=\"w\">    </span><span class=\"no\">Stdout</span><span class=\"o\">.</span><span class=\"n\">line!</span><span class=\"p\">(</span><span class=\"n\">output</span><span class=\"p\">)</span>\n<span class=\"w\">    </span><span class=\"no\">Ok</span><span class=\"p\">({})</span>\n<span class=\"p\">}</span>\n</code></pre></div>\n<p>I get this runtime error:</p>\n<div class=\"codehilite\"><pre><span></span><code>thread 37216187 panic: incorrect alignment\n???:?:?: 0x102a59233 in ??? (roc_run_994723065)\n???:?:?: 0x102959e63 in ??? (roc_run_994723065)\n???:?:?: 0x10290a7a3 in ??? (roc_run_994723065)\n???:?:?: 0x1028e1d1f in ??? (roc_run_994723065)\n???:?:?: 0x1028df6a7 in ??? (roc_run_994723065)\n???:?:?: 0x1028df10b in ??? (roc_run_994723065)\n???:?:?: 0x1028d8913 in ??? (roc_run_994723065)\n???:?:?: 0x19fd42b97 in ??? (???)\n???:?:?: 0x0 in ??? (???)\nerror: Child process /Users/ageron/Library/Caches/roc/73212f0613ff7600bbf5b003b36e3cfa/temp/roc-tmp-EMJa9WuLIKioAEl7KAWvrpfkyRJeNXN3/roc_run_994723065 killed by signal: 6\nerror: Child process aborted (SIGABRT)\n</code></pre></div>",
        "id": 561556144,
        "sender_full_name": "Aurélien Geron",
        "timestamp": 1764732036
    },
    {
        "content": "<p>Can you please share the full .roc code that does that</p>",
        "id": 561556147,
        "sender_full_name": "Luke Boswell",
        "timestamp": 1764732040
    },
    {
        "content": "<p>Which platform URL are you using</p>",
        "id": 561556159,
        "sender_full_name": "Luke Boswell",
        "timestamp": 1764732051
    },
    {
        "content": "<p>This is the latest (v 0.3) I just pushed earlier today </p>\n<div class=\"codehilite\"><pre><span></span><code>https://github.com/lukewilliamboswell/roc-platform-template-zig/releases/download/0.3/98T93wthPgoBRLYtPTT4RBBsQunrfDG94gihPf1zYYmE.tar.zst\n</code></pre></div>",
        "id": 561556203,
        "sender_full_name": "Luke Boswell",
        "timestamp": 1764732090
    },
    {
        "content": "<p>Sure, same as above:</p>\n<div class=\"codehilite\" data-code-language=\"Ruby\"><pre><span></span><code><span class=\"n\">app</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">main!</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\"> </span><span class=\"ss\">pf</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"n\">platform</span><span class=\"w\"> </span><span class=\"s2\">\"https://github.com/lukewilliamboswell/roc-platform-template-zig/releases/download/0.1-test/7iDKk44no3gF9Nrh2VyF8Y5yvy1jUBhrbhHURN1WQptB.tar.zst\"</span><span class=\"w\"> </span><span class=\"p\">}</span>\n\n<span class=\"n\">import</span><span class=\"w\"> </span><span class=\"n\">pf</span><span class=\"o\">.</span><span class=\"n\">Stdout</span>\n\n<span class=\"n\">data</span><span class=\"w\"> </span><span class=\"o\">=</span>\n<span class=\"w\">    </span><span class=\"p\">\\\\</span><span class=\"no\">L4</span>\n<span class=\"w\">    </span><span class=\"p\">\\\\</span><span class=\"no\">R49</span>\n<span class=\"w\">    </span><span class=\"p\">\\\\</span><span class=\"w\"> </span><span class=\"o\">...</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">very</span><span class=\"w\"> </span><span class=\"n\">long</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"mi\">4000</span><span class=\"o\">+</span><span class=\"w\"> </span><span class=\"n\">lines</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"o\">...</span>\n\n\n<span class=\"n\">main!</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"o\">|</span><span class=\"n\">_args</span><span class=\"o\">|</span><span class=\"w\"> </span><span class=\"p\">{</span>\n<span class=\"w\">    </span><span class=\"n\">bytes</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">data</span><span class=\"o\">.</span><span class=\"n\">to_utf8</span><span class=\"p\">()</span>\n<span class=\"w\">    </span><span class=\"n\">len</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">bytes</span><span class=\"o\">.</span><span class=\"n\">len</span><span class=\"p\">()</span>\n<span class=\"w\">    </span><span class=\"n\">output</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">len</span><span class=\"o\">.</span><span class=\"n\">to_str</span><span class=\"p\">()</span>\n<span class=\"w\">    </span><span class=\"no\">Stdout</span><span class=\"o\">.</span><span class=\"n\">line!</span><span class=\"p\">(</span><span class=\"n\">output</span><span class=\"p\">)</span>\n<span class=\"w\">    </span><span class=\"no\">Ok</span><span class=\"p\">({})</span>\n<span class=\"p\">}</span>\n</code></pre></div>",
        "id": 561556237,
        "sender_full_name": "Aurélien Geron",
        "timestamp": 1764732123
    },
    {
        "content": "<p>Oh ok, thanks, I'll give this a try</p>",
        "id": 561556262,
        "sender_full_name": "Aurélien Geron",
        "timestamp": 1764732143
    },
    {
        "content": "<p>Yes, this fixed the issue, thanks! There's still a memory leak though, but at least the program runs normally:</p>\n<div class=\"codehilite\"><pre><span></span><code>4373823488\nerror(gpa): memory address 0x104d20000 leaked:\nUnable to print stack trace: Unable to open debug info: MissingDebugInfo\n</code></pre></div>",
        "id": 561556346,
        "sender_full_name": "Aurélien Geron",
        "timestamp": 1764732219
    },
    {
        "content": "<p>Could you upload the full .roc file somewhere so I can hunt down the leak</p>",
        "id": 561556380,
        "sender_full_name": "Luke Boswell",
        "timestamp": 1764732250
    },
    {
        "content": "<p>Sure:<br>\n<a href=\"https://gist.github.com/ageron/1f8fc1e302d772b23c2a5acc3b800f40\">https://gist.github.com/ageron/1f8fc1e302d772b23c2a5acc3b800f40</a></p>",
        "id": 561556503,
        "sender_full_name": "Aurélien Geron",
        "timestamp": 1764732361
    },
    {
        "content": "<p>Fixed in <a href=\"https://github.com/roc-lang/roc/pull/8552\">https://github.com/roc-lang/roc/pull/8552</a></p>",
        "id": 561559224,
        "sender_full_name": "Luke Boswell",
        "timestamp": 1764734461
    },
    {
        "content": "<p>Cool, thanks <span class=\"user-mention\" data-user-id=\"515757\">@Luke Boswell</span></p>",
        "id": 561559256,
        "sender_full_name": "Aurélien Geron",
        "timestamp": 1764734485
    },
    {
        "content": "<p>fyi I have <a href=\"https://github.com/Anton-4/roc-platform-template-zig/tree/fix-questionmarks-leak-trace\">a branch</a> that fixes the <code>???</code> in the traces but I still need to review it thoroughly.</p>",
        "id": 561598162,
        "sender_full_name": "Anton",
        "timestamp": 1764754420
    }
]