[
    {
        "content": "<p>Hi folks. I'm trying to test out command line parsing from the basic-cli platform, but I'm getting a thread panic. My code and output are here -- <a href=\"https://gist.github.com/drewolson/bef70f973c04e22e4ffe9ec44b9af135\">https://gist.github.com/drewolson/bef70f973c04e22e4ffe9ec44b9af135</a>. What am I doing wrong?</p>",
        "id": 397529265,
        "sender_full_name": "drew",
        "timestamp": 1697729133
    },
    {
        "content": "<p>I don't think its you, if I remember correctly the stuff in the <a href=\"https://www.roc-lang.org/packages/basic-cli/Arg\">arg parser module</a> has some issues.</p>",
        "id": 397534671,
        "sender_full_name": "Erik",
        "timestamp": 1697730973
    },
    {
        "content": "<p>Ahhh yeah <a href=\"https://github.com/roc-lang/basic-cli/issues/90\">here is the issue</a>.</p>",
        "id": 397534928,
        "sender_full_name": "Erik",
        "timestamp": 1697731082
    },
    {
        "content": "<p>Ah, bummer. Thanks!</p>",
        "id": 397535710,
        "sender_full_name": "drew",
        "timestamp": 1697731347
    },
    {
        "content": "<p>i'm curious if folks think this will be fixed before Advent of Code starts. with the new website release and advent of code just around the corner, i'm sure folks will be trying out roc, and command line arg parsing seems like it would be super useful!</p>",
        "id": 403258014,
        "sender_full_name": "drew",
        "timestamp": 1700520300
    },
    {
        "content": "<p>seems like the actual issue is <a href=\"https://github.com/roc-lang/roc/issues/5701\">https://github.com/roc-lang/roc/issues/5701</a></p>",
        "id": 403258062,
        "sender_full_name": "drew",
        "timestamp": 1700520322
    },
    {
        "content": "<blockquote>\n<p>if folks think this will be fixed before Advent of Code starts</p>\n</blockquote>\n<p>Probably not, sadly.</p>",
        "id": 403258727,
        "sender_full_name": "Brendan Hansknecht",
        "timestamp": 1700520570
    },
    {
        "content": "<p>Ah I see, you're writing a script to fetch AoC puzzles. The website examples include an example of CLI parsing that gets around this issue, but is a bit noisier <a href=\"https://www.roc-lang.org/examples/CommandLineArgs/README.html\">https://www.roc-lang.org/examples/CommandLineArgs/README.html</a></p>",
        "id": 403258818,
        "sender_full_name": "Elias Mulhall",
        "timestamp": 1700520609
    },
    {
        "content": "<p>It's not even a script to fetch the puzzles, rather just accepting args from the user as to the day of the puzzle and the part to run.</p>",
        "id": 403258929,
        "sender_full_name": "drew",
        "timestamp": 1700520667
    },
    {
        "content": "<p>so that all of my puzzles can be part of the same application. it's how i've done it for haskell and ocaml.</p>",
        "id": 403258950,
        "sender_full_name": "drew",
        "timestamp": 1700520686
    },
    {
        "content": "<p>i suppose i could just have a program per day</p>",
        "id": 403259069,
        "sender_full_name": "drew",
        "timestamp": 1700520743
    },
    {
        "content": "<p>or maybe this is my year of ocaml and next year is my year of roc :)</p>",
        "id": 403259084,
        "sender_full_name": "drew",
        "timestamp": 1700520753
    },
    {
        "content": "<p>Also, you can always directly work with <code>args &lt;- Arg.list |&gt; Task.await</code>. The bug is in the nested lambdas used for handling parsing. For AOC, naive parsing probably is enough with just directly using that list of strings.</p>",
        "id": 403259106,
        "sender_full_name": "Brendan Hansknecht",
        "timestamp": 1700520766
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"343810\">@Brendan Hansknecht</span> fair point. does the nested lambdas issue also become a problem for parser combinator style parsing of the input?</p>",
        "id": 403259158,
        "sender_full_name": "drew",
        "timestamp": 1700520803
    },
    {
        "content": "<p>i feel like all i need to start aoc is some parser combinator library and some arg parsing library. oh, and sum types ;)</p>",
        "id": 403259178,
        "sender_full_name": "drew",
        "timestamp": 1700520820
    },
    {
        "content": "<p>In case it helps anyone, I wrote this poor man's version of the arg parser while I was updating roc-pg to the latest basic-cli the other day: <a href=\"https://github.com/agu-z/roc-pg/blob/72f5390db26527bc3b6067f77ea570f895ff3c0b/sql-cli/src/roc-sql.roc#L191-L278\">https://github.com/agu-z/roc-pg/blob/72f5390db26527bc3b6067f77ea570f895ff3c0b/sql-cli/src/roc-sql.roc#L191-L278</a></p>",
        "id": 403259183,
        "sender_full_name": "Agus Zubiaga",
        "timestamp": 1700520822
    },
    {
        "content": "<p>I think it can affect parser combinator style parsers.</p>",
        "id": 403259271,
        "sender_full_name": "Brendan Hansknecht",
        "timestamp": 1700520855
    },
    {
        "content": "<p><span aria-label=\"cry\" class=\"emoji emoji-1f622\" role=\"img\" title=\"cry\">:cry:</span> got it, so maybe next year for me. i'm super excited about the language</p>",
        "id": 403259304,
        "sender_full_name": "drew",
        "timestamp": 1700520877
    },
    {
        "content": "<blockquote>\n<p>or maybe this is my year of ocaml and next year is my year of roc :)</p>\n</blockquote>\n<p>fair, they are similar languages and I love OCaml</p>\n<blockquote>\n<p>does the nested lambdas also become a problem for parser combinator style parsing of the input?</p>\n</blockquote>\n<p>Last month I worked through some AoC puzzles in Roc and mostly used parser combinators for parsing. You can see my code here <a href=\"https://github.com/mulias/roctoberfest/tree/main/advent_2022\">https://github.com/mulias/roctoberfest/tree/main/advent_2022</a></p>",
        "id": 403259327,
        "sender_full_name": "Elias Mulhall",
        "timestamp": 1700520888
    },
    {
        "content": "<p>thanks!</p>",
        "id": 403259350,
        "sender_full_name": "drew",
        "timestamp": 1700520901
    },
    {
        "content": "<p>The one type system issue I ran into with parser combinators was a case where I needed a <code>lazy</code> parser to parse recursive data. <span class=\"user-mention\" data-user-id=\"489294\">@Agus Zubiaga</span> showed me a workaround, which is here <a href=\"https://github.com/mulias/roctoberfest/blob/main/advent_2022/day_07/main.roc#L158\">https://github.com/mulias/roctoberfest/blob/main/advent_2022/day_07/main.roc#L158</a><br>\nYou need to use <code>buildPrimitiveParser</code> to \"reset\" something with the type system. Sorry I can't be more exact than that, it's definitely a hack to get around a bug.</p>",
        "id": 403259705,
        "sender_full_name": "Elias Mulhall",
        "timestamp": 1700521089
    },
    {
        "content": "<p>interesting. is <code>lazy</code> effectively a fixed point combinator?</p>",
        "id": 403259849,
        "sender_full_name": "drew",
        "timestamp": 1700521195
    },
    {
        "content": "<p>ah, i see it here, thanks. <a href=\"https://github.com/lukewilliamboswell/roc-parser/blob/46ab6e2a8c13f69601ad516520981331c6b7ce3b/package/Core.roc#L231-L234\">https://github.com/lukewilliamboswell/roc-parser/blob/46ab6e2a8c13f69601ad516520981331c6b7ce3b/package/Core.roc#L231-L234</a></p>",
        "id": 403260289,
        "sender_full_name": "drew",
        "timestamp": 1700521330
    },
    {
        "content": "<p>In general I wouldn't hesitate to use Roc for AoC <strong>if</strong> you're willing to ask for help around here. It's mostly smooth sailing, but every once in a while you run into a road block where it seems like you're doing the right thing and it's not working. Sometimes that's because you are doing the right thing and the compiler has a bug.</p>",
        "id": 403260549,
        "sender_full_name": "Elias Mulhall",
        "timestamp": 1700521442
    },
    {
        "content": "<p>Hi, I'm new to the language and ecosystem.</p>\n<p>Does anyone have a recommendation on command line parsing? I thought 'weaver' to be the de-facto standard, but I couldn't get it to work, the examples don't compile. I think it might be because of version mismatch with basic cli platform, or the roc version itself.</p>\n<p>Also, are there any schemes to indicate dependency version? \"my package relies on specific version of basic cli platform\"</p>",
        "id": 575928048,
        "sender_full_name": "Plas",
        "timestamp": 1772079507
    },
    {
        "content": "<p>Yeah I would have thought Weaver was the way to go. I haven't tried using it in a while it may need a minor update</p>",
        "id": 575930442,
        "sender_full_name": "Luke Boswell",
        "timestamp": 1772080732
    },
    {
        "content": "<p>you specify the version in the URL you use...</p>",
        "id": 575930475,
        "sender_full_name": "Luke Boswell",
        "timestamp": 1772080751
    },
    {
        "content": "<p>e.g.</p>\n<div class=\"codehilite\"><pre><span></span><code>app [main!] { pf: platform &quot;https://github.com/roc-lang/basic-cli/releases/download/0.20.0/X73hGh05nNTkDHU06FHC0YfFaQB1pimX7gncRcao5mU.tar.br&quot; }\n</code></pre></div>\n<p>refers to version <code>0.20.0</code> of basic-cli</p>",
        "id": 575930527,
        "sender_full_name": "Luke Boswell",
        "timestamp": 1772080779
    },
    {
        "content": "<p>I would assume the latest nightly release of Roc and that version of basic-cli (the latest) would be compatible.</p>",
        "id": 575930609,
        "sender_full_name": "Luke Boswell",
        "timestamp": 1772080808
    },
    {
        "content": "<p>The \"pre-release\" one is for the new Roc compiler written in Zig -- which isn't compatible with Weaver</p>",
        "id": 575930683,
        "sender_full_name": "Luke Boswell",
        "timestamp": 1772080846
    },
    {
        "content": "<p>I think this is the release of Roc you would want <a href=\"https://github.com/roc-lang/roc/releases/tag/alpha4-rolling\">https://github.com/roc-lang/roc/releases/tag/alpha4-rolling</a></p>",
        "id": 575930769,
        "sender_full_name": "Luke Boswell",
        "timestamp": 1772080899
    },
    {
        "content": "<p>If you want to try out the new Roc compiler (re-write in Zig) -- there are releases available at <a href=\"https://github.com/roc-lang/nightlies/releases\">https://github.com/roc-lang/nightlies/releases</a> -- but be warned there is basically no platforms or packages available to use with them yet, so it's not a friendly beginner experience.</p>",
        "id": 575930905,
        "sender_full_name": "Luke Boswell",
        "timestamp": 1772080976
    },
    {
        "content": "<p>I don't know how weaver works, but there shouldn't be that big of a dependence on platforms in packages. By that, I mean weaver probably takes a value (string or list of strings) and does the parsing. It's not like a go or js package where the package is also responsible for obtaining the values. If this is the case, even if there is a slight missmatch in the api, you as the app author should be able to make a simple transformation on the data, before you hand it over to weaver. <br>\nOr if it takes an effectul function, it's easy to wrap the efectul basic-cli fn and do the transformation there. Just saying it, becasue I don't know how familiar you are with Roc.<br>\nAs Luke's said, at this stage, language version missmatches are the main incompatibility issue. But this is a temporary state.</p>",
        "id": 575950672,
        "sender_full_name": "Norbert Hajagos",
        "timestamp": 1772091517
    },
    {
        "content": "<p>I'm kind of away now but iirc the failure probably was due to changes in Str or Result type</p>\n<p>I am very very new to Roc, I get that the project still changes a lot. I just wish people wouldn't put \"latest version of basic cli\" in their projects, and rather specify exact roc version and basic cli version they tested with, until roc hits 1.0.0</p>",
        "id": 575992772,
        "sender_full_name": "Plas",
        "timestamp": 1772103355
    },
    {
        "content": "<p>The examples repo has exact versions specified: <a href=\"https://github.com/roc-lang/examples/blob/main/examples/CommandLineArgs/main.roc\">https://github.com/roc-lang/examples/blob/main/examples/CommandLineArgs/main.roc</a></p>\n<p>Everything in the examples repo uses <a href=\"https://github.com/roc-lang/roc/releases/tag/alpha4-rolling\">roc alpha4</a>.</p>\n<p>We also plan to specify the Roc version in the .roc file to avoid all these version incompatibility issues.</p>",
        "id": 576222688,
        "sender_full_name": "Anton",
        "timestamp": 1772187037
    }
]