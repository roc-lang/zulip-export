[
    {
        "content": "<p>I implemented zig allocators in my platform lol</p>\n<div class=\"codehilite\"><pre><span></span><code>app [main!] { pf: platform &quot;../platform/main.roc&quot; }\n\nimport pf.Stdout\nimport pf.AllocHost\n\nmain! : List(Str) =&gt; Try({}, [Exit(I32)])\nmain! = |_args| {\n    Stdout.line!(&quot;Testing poke/peek with Try-based alloc...&quot;)\n\n    # Allocate 4 bytes - returns [Ok(U64), OutOfMemory]\n    alloc_result = AllocHost.alloc_impl!(4)\n\n    match alloc_result {\n        OutOfMemory =&gt; {\n            Stdout.line!(&quot;Allocation failed: OutOfMemory&quot;)\n            Err(Exit(1))\n        }\n\n        Ok(ptr) =&gt; {\n            Stdout.line!(&quot;Allocated 4 bytes.&quot;)\n\n            # Write &quot;Roc!&quot; using poke\n            AllocHost.poke_impl!({ byte: 82, ptr: ptr })\n            AllocHost.poke_impl!({ byte: 111, ptr: ptr + 1 })\n            AllocHost.poke_impl!({ byte: 99, ptr: ptr + 2 })\n            AllocHost.poke_impl!({ byte: 33, ptr: ptr + 3 })\n\n            Stdout.line!(&quot;Written &#39;Roc!&#39; to memory.&quot;)\n\n            # Read back using peek\n            c1 = AllocHost.peek_impl!(ptr)\n            c2 = AllocHost.peek_impl!(ptr + 1)\n            c3 = AllocHost.peek_impl!(ptr + 2)\n            c4 = AllocHost.peek_impl!(ptr + 3)\n\n            Stdout.line!(&quot;Read back: ${Str.inspect(c1)} ${Str.inspect(c2)} ${Str.inspect(c3)} ${Str.inspect(c4)}&quot;)\n\n            # Expected: 82 111 99 33 = &quot;Roc!&quot;\n            Stdout.line!(&quot;Expected:  82 111 99 33&quot;)\n\n            # Deallocate\n            AllocHost.dealloc_impl!(ptr)\n            Stdout.line!(&quot;Deallocated. SUCCESS!&quot;)\n            Ok({})\n        }\n    }\n}\n</code></pre></div>",
        "id": 571361251,
        "sender_full_name": "nandi",
        "timestamp": 1770017162
    },
    {
        "content": "<p>Cool!  Note, I have never issued a <code>malloc()</code>, ever.  However, in my reading, it seems that malloc/free is really a bad pattern unless you need it, and that arena allocation is probably a better starting point, depending on context, or else never-free-and-quit (not for long-running processes, obviously; but web workers can quit once the request is cleared).</p>",
        "id": 571485441,
        "sender_full_name": "Rick Hull",
        "timestamp": 1770052378
    },
    {
        "content": "<p>It was mostly satire since roc is not memory managed</p>",
        "id": 571485673,
        "sender_full_name": "nandi",
        "timestamp": 1770052451
    },
    {
        "content": "<p>RIP me <span aria-label=\"laughing\" class=\"emoji emoji-1f606\" role=\"img\" title=\"laughing\">:laughing:</span></p>",
        "id": 571486803,
        "sender_full_name": "Rick Hull",
        "timestamp": 1770052761
    }
]