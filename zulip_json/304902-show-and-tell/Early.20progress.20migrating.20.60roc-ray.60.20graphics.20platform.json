[
    {
        "content": "<p>Thought I'd share some cool progress on <code>roc-ray</code> -- I've been using this to help fix bugs in the platform/host side of things and validate the platform packages and linking designs. I got it to a pretty cool point today and wanted to share with everyone here. </p>\n<p><a href=\"/user_uploads/22008/elS9u5ZTTp_eNLkYxqSXCVDO/roc-ray-alpha-1.gif\">roc-ray-alpha-1.gif</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/22008/elS9u5ZTTp_eNLkYxqSXCVDO/roc-ray-alpha-1.gif\" title=\"roc-ray-alpha-1.gif\"><img data-animated=\"true\" data-original-content-type=\"image/gif\" data-original-dimensions=\"1136x782\" src=\"/user_uploads/thumbnail/22008/elS9u5ZTTp_eNLkYxqSXCVDO/roc-ray-alpha-1.gif/840x560-anim.webp\"></a></div><div class=\"codehilite\"><pre><span></span><code>app [Model, program] { rr: platform \"https://github.com/lukewilliamboswell/roc-ray/releases/download/alpha-0-test/HB6qgLwjKqjmVXTxJEzFqnC72SJEfif98CnJ8ZVN86UE.tar.zst\" }\n\nimport rr.Draw\nimport rr.Color\nimport rr.PlatformState\n\nModel : {\n    message: Str,\n}\nprogram = { init!, render! }\n\ninit! : () =&gt; Try(Model, [Exit(I64), ..])\ninit! = || Ok({\n    message: \"Roc :heart: Raylib!\",\n})\n\nrender! : Model, PlatformState =&gt; Try(Model, [Exit(I64), ..])\nrender! = |model, state| {\n\n    # Circle follows the mouse, changes color when clicked\n    circle_color = if state.mouse.left { Color.Red } else { Color.Green }\n\n    Draw.draw!(RayWhite, || {\n        Draw.text!({ pos: { x: 10, y: 10 }, text: model.message, size: 30, color: Color.DarkGray })\n        Draw.rectangle!({ x: 100, y: 200, width: 100, height: 80, color: Color.Red })\n        Draw.line!({ start: { x: 100, y: 500 }, end: { x: 600, y: 550 }, color: Color.Blue })\n\n        # Draw circle last so it is drawn over the top of other shapes\n        Draw.circle!({ center: { x: state.mouse.x, y: state.mouse.y }, radius: 50, color: circle_color })\n    })\n\n    Ok(model)\n}\n</code></pre></div>\n<p>This is using a <em>very</em> alpha release that only has macos pre-built host binaries included, and definitely requires roc built from source. I'd like to get Linux and Windows hosts supported next I think before adding too many more features and making a real branch in the roc-ray repository. </p>\n<div class=\"codehilite\"><pre><span></span><code>$ roc build examples/hello_world.roc\n</code></pre></div>\n<p>Note* that we have a bug that prevents using the run subcommand, so you just have to build it first then run the executable.</p>",
        "id": 567382821,
        "sender_full_name": "Luke Boswell",
        "timestamp": 1768128457
    },
    {
        "content": "<p>Yay linux seems to be working now also <span aria-label=\"smiley\" class=\"emoji emoji-1f603\" role=\"img\" title=\"smiley\">:smiley:</span> </p>\n<p><a href=\"/user_uploads/22008/twKtDtRafJd_qzxCamGBFVUJ/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/22008/twKtDtRafJd_qzxCamGBFVUJ/image.png\" title=\"image.png\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"1756x792\" src=\"/user_uploads/thumbnail/22008/twKtDtRafJd_qzxCamGBFVUJ/image.png/840x560.webp\"></a></div>",
        "id": 567657918,
        "sender_full_name": "Luke Boswell",
        "timestamp": 1768258942
    },
    {
        "content": "<div class=\"codehilite\"><pre><span></span><code>lbw@lbw-B850-GAMING-X-WIFI6E:~/Documents/Github/roc-platform-template-zig$ file hello_world\nhello_world: ELF 64-bit LSB executable, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib/x86_64-linux-gnu/ld-linux-x86-64.so.2, for GNU/Linux 3.2.0, with debug_info, not stripped\n</code></pre></div>\n<p>It's not a fully static binary though, I couldn't find a way to make it work with musl</p>",
        "id": 567658023,
        "sender_full_name": "Luke Boswell",
        "timestamp": 1768259004
    },
    {
        "content": "<p>I've found an issue with linking math symbols <code>libm</code> I'm digging into</p>",
        "id": 567658776,
        "sender_full_name": "Luke Boswell",
        "timestamp": 1768259470
    },
    {
        "content": "<p>Already this is way cooler than the original roc-ray implementation... no need to have a complete dev toolchain installed like cargo for application authors, just <code>roc</code> and your good to go!! (needs further testing to confirm this works for everyone)</p>",
        "id": 567658981,
        "sender_full_name": "Luke Boswell",
        "timestamp": 1768259609
    },
    {
        "content": "<p>Ok cool, fixed my maths symbols I think. </p>\n<p>Anyone running linux... can you help me test this?</p>\n<div class=\"codehilite\"><pre><span></span><code>app [Model, program] { rr: platform &quot;https://github.com/lukewilliamboswell/roc-ray/releases/download/alpha-0-test/EydNNTemUX6GMbTE4sY9JWqvLpPxvp2ZcwKDSn3WaDmB.tar.zst&quot; }\n\nimport rr.Draw\nimport rr.Color\nimport rr.PlatformState\n\nModel : {\n    message: Str,\n}\nprogram = { init!, render! }\n\ninit! : () =&gt; Try(Model, [Exit(I64), ..])\ninit! = || Ok({\n    message: &quot;Roc :heart: Raylib!&quot;,\n})\n\nrender! : Model, PlatformState =&gt; Try(Model, [Exit(I64), ..])\nrender! = |model, state| {\n\n    # Circle follows the mouse, changes color when clicked\n    circle_color = if state.mouse.left { Color.Red } else { Color.Green }\n\n    Draw.draw!(RayWhite, || {\n        Draw.text!({ pos: { x: 10, y: 10 }, text: model.message, size: 30, color: Color.DarkGray })\n        Draw.rectangle!({ x: 100, y: 200, width: 100, height: 80, color: Color.Red })\n        Draw.line!({ start: { x: 100, y: 500 }, end: { x: 600, y: 550 }, color: Color.Blue })\n\n        # Draw circle last so it is drawn over the top of other shapes\n        Draw.circle!({ center: { x: state.mouse.x, y: state.mouse.y }, radius: 50, color: circle_color })\n    })\n\n    Ok(model)\n}\n</code></pre></div>",
        "id": 567659904,
        "sender_full_name": "Luke Boswell",
        "timestamp": 1768260195
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"430894\">@Dan G Knutson</span> you might be interested</p>",
        "id": 567660013,
        "sender_full_name": "Luke Boswell",
        "timestamp": 1768260262
    },
    {
        "content": "<p>Next up is Windows... though it might be worthwhile revisiting this issue first <span aria-label=\"shrug\" class=\"emoji emoji-1f937\" role=\"img\" title=\"shrug\">:shrug:</span> <a href=\"https://github.com/roc-lang/roc/issues/8779\">https://github.com/roc-lang/roc/issues/8779</a></p>",
        "id": 567660264,
        "sender_full_name": "Luke Boswell",
        "timestamp": 1768260420
    },
    {
        "content": "<p><a href=\"/user_uploads/22008/cUKc-yfkbSS0fwgGWSrIqvy5/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/22008/cUKc-yfkbSS0fwgGWSrIqvy5/image.png\" title=\"image.png\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"884x692\" src=\"/user_uploads/thumbnail/22008/cUKc-yfkbSS0fwgGWSrIqvy5/image.png/840x560.webp\"></a></div><p>on linux</p>",
        "id": 567660951,
        "sender_full_name": "nandi",
        "timestamp": 1768260833
    },
    {
        "content": "<p>single file gui app lets goooo</p>",
        "id": 567661055,
        "sender_full_name": "nandi",
        "timestamp": 1768260900
    },
    {
        "content": "<p>Which distro are you running? what OS/Arch too?</p>",
        "id": 567661113,
        "sender_full_name": "Luke Boswell",
        "timestamp": 1768260930
    },
    {
        "content": "<p>ubuntu 24.04 x64, musl failed but glibc worked</p>",
        "id": 567661200,
        "sender_full_name": "nandi",
        "timestamp": 1768260998
    },
    {
        "content": "<p>Same over here! (on PopOS, which is basically ubuntu) I'm stoked for this</p>",
        "id": 567662776,
        "sender_full_name": "Dan G Knutson",
        "timestamp": 1768262116
    },
    {
        "content": "<p>Sounds like I need to move this into a branch in roc-ray so we can start adding more features</p>",
        "id": 567662883,
        "sender_full_name": "Luke Boswell",
        "timestamp": 1768262201
    },
    {
        "content": "<p>The problem here is different: libraylib.a is a static library (.a), not a compiled binary. It contains object files with<br>\n   unresolved symbols that expect to be linked against glibc at build time.</p>\n<p>When raylib was compiled on an older system with _FORTIFY_SOURCE, the compiler generated calls to __sprintf_chk etc. Those symbols<br>\n   existed in old glibc but have different signatures or are gone in glibc 2.42.</p>\n<p>Backwards compat only works for:</p>\n<div class=\"codehilite\"><pre><span></span><code> - Fully linked executables/shared libraries (.so)\n - They embed symbol versions like printf@GLIBC_2.2.5\n</code></pre></div>\n\n<p>Doesn't work for:</p>\n<div class=\"codehilite\"><pre><span></span><code> - Static .a files that still need to be linked\n - They just have raw symbol references\n</code></pre></div>\n\n<p>So this is a build-time incompatibility, not a runtime one. The solution is rebuilding raylib on your system.</p>",
        "id": 567675297,
        "sender_full_name": "nandi",
        "timestamp": 1768272018
    },
    {
        "content": "<p>When I try to run with arch linux</p>",
        "id": 567675313,
        "sender_full_name": "nandi",
        "timestamp": 1768272043
    },
    {
        "content": "<p>Ok I had a similar issue with the Rust version... I think the solution here is to bundle the published raylib libraries and then write our own C wrapper instead of using zigraylib</p>",
        "id": 567675403,
        "sender_full_name": "Luke Boswell",
        "timestamp": 1768272124
    },
    {
        "content": "<p>They're published here <a href=\"https://github.com/raysan5/raylib/releases/tag/5.5\">https://github.com/raysan5/raylib/releases/tag/5.5</a></p>",
        "id": 567675486,
        "sender_full_name": "Luke Boswell",
        "timestamp": 1768272196
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"515757\">Luke Boswell</span> <a href=\"#narrow/channel/304902-show-and-tell/topic/Early.20progress.20migrating.20.60roc-ray.60.20graphics.20platform/near/567662883\">said</a>:</p>\n<blockquote>\n<p>Sounds like I need to move this into a branch in roc-ray so we can start adding more features</p>\n</blockquote>\n<p>Yes please.</p>",
        "id": 567859016,
        "sender_full_name": "Will Alexander",
        "timestamp": 1768338486
    },
    {
        "content": "<p>It's been a busy day with work and I didn't achieve what I hoped to. </p>\n<p>My goals at the start of the day:</p>\n<ul>\n<li>switch to using the raylib release instead of building our own <code>libraylib.a</code></li>\n<li>migrate the branch to <code>roc-ray</code> repository</li>\n</ul>\n<p>What I ended up doing instead</p>\n<ul>\n<li>switch to using the raylib release instead of building our own <code>libraylib.a</code> <span aria-label=\"check\" class=\"emoji emoji-2705\" role=\"img\" title=\"check\">:check:</span> </li>\n<li>implement roc-ray support for web / canvas </li>\n<li>take a random detour and fix a memory leak in roc </li>\n</ul>\n<p>I'll try and finish cleaning up and migrate to a repo tomorrow. I'd love to add Windows support and cut an alpha release sometime this week. </p>\n<p>I'll be travelling for work all next week and it would be nice to know the harder integration issues (like linking hosts and dependencies) are resolved, and I can focus on adding features leading up to the online meetup.</p>",
        "id": 567955173,
        "sender_full_name": "Luke Boswell",
        "timestamp": 1768388217
    }
]