[
    {
        "content": "<p>Issue: <a href=\"https://github.com/roc-lang/roc/issues/9218\">#9218</a><br>\nI was updating the TryOperatorDesugaring example and stumbled across this error, which I could only fix, because I remembered we had talked about <code>return</code> only being allowed in statement positions.  <a href=\"https://roc-lang.github.io/roc-playground/#content=bWFpbiEgPSB8X2FyZ3N8IHsKCU9rKHt9KQp9CgpyZXBybyA9IHx8IHsKCSMgYHJldHVybmAgYXQgZXhwcmVzc2lvbiBwb3NpdGlvbgoJbXNnID0gcmV0dXJuIHt9CgkjIHRoZSBmaXg6CgkjIG1zZyA9IHsKCSMgCXJldHVybiB7fQoJIyB9Cgltc2cKfQoKc2ltcGxpZmllZF9yZWFsX3VzZV9jYXNlID0gfGlucHV0fCB7Cgltc2cgPSBtYXRjaCBpbnB1dCB7CgkJImhpIiA9PiAiaGkiCgkJXyA9PiByZXR1cm4gInRoZXJlIgoJCSMgdGhlIGZpeDoKCQkjIF8gPT4gewoJCSMgCXJldHVybiAidGhlcmUiCgkJIyB9Cgl9Cgltc2cKfQoKZXhwZWN0IHJlcHJvKCkgPT0ge30KZXhwZWN0IHNpbXBsaWZpZWRfcmVhbF91c2VfY2FzZSgiaGkiKSA9PSAiaGki\">Playground link</a></p>\n<div class=\"codehilite\" data-code-language=\"Ruby\"><pre><span></span><code><span class=\"n\">main!</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"o\">|</span><span class=\"n\">_args</span><span class=\"o\">|</span><span class=\"w\"> </span><span class=\"p\">{</span>\n<span class=\"w\">    </span><span class=\"no\">Ok</span><span class=\"p\">({})</span>\n<span class=\"p\">}</span>\n\n<span class=\"n\">repro</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"o\">||</span><span class=\"w\"> </span><span class=\"p\">{</span>\n<span class=\"w\">    </span><span class=\"c1\"># `return` at expression position</span>\n<span class=\"w\">    </span><span class=\"n\">msg</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"k\">return</span><span class=\"w\"> </span><span class=\"p\">{}</span>\n<span class=\"w\">    </span><span class=\"c1\"># the fix:</span>\n<span class=\"w\">    </span><span class=\"c1\"># msg = {</span>\n<span class=\"w\">    </span><span class=\"c1\">#   return {}</span>\n<span class=\"w\">    </span><span class=\"c1\"># }</span>\n<span class=\"w\">    </span><span class=\"n\">msg</span>\n<span class=\"p\">}</span>\n\n<span class=\"n\">simplified_real_use_case</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"o\">|</span><span class=\"n\">input</span><span class=\"o\">|</span><span class=\"w\"> </span><span class=\"p\">{</span>\n<span class=\"w\">    </span><span class=\"n\">msg</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">match</span><span class=\"w\"> </span><span class=\"n\">input</span><span class=\"w\"> </span><span class=\"p\">{</span>\n<span class=\"w\">        </span><span class=\"s2\">\"hi\"</span><span class=\"w\"> </span><span class=\"o\">=&gt;</span><span class=\"w\"> </span><span class=\"s2\">\"hi\"</span>\n<span class=\"w\">        </span><span class=\"n\">_</span><span class=\"w\"> </span><span class=\"o\">=&gt;</span><span class=\"w\"> </span><span class=\"k\">return</span><span class=\"w\"> </span><span class=\"s2\">\"there\"</span>\n<span class=\"w\">        </span><span class=\"c1\"># the fix:</span>\n<span class=\"w\">        </span><span class=\"c1\"># _ =&gt; {</span>\n<span class=\"w\">        </span><span class=\"c1\">#   return \"there\"</span>\n<span class=\"w\">        </span><span class=\"c1\"># }</span>\n<span class=\"w\">    </span><span class=\"p\">}</span>\n<span class=\"w\">    </span><span class=\"n\">msg</span>\n<span class=\"p\">}</span>\n\n<span class=\"n\">expect</span><span class=\"w\"> </span><span class=\"n\">repro</span><span class=\"p\">()</span><span class=\"w\"> </span><span class=\"o\">==</span><span class=\"w\"> </span><span class=\"p\">{}</span>\n<span class=\"n\">expect</span><span class=\"w\"> </span><span class=\"n\">simplified_real_use_case</span><span class=\"p\">(</span><span class=\"s2\">\"hi\"</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"o\">==</span><span class=\"w\"> </span><span class=\"s2\">\"hi\"</span>\n</code></pre></div>\n<p>The error msg, for which I was staring, thinking \"but <code>return</code> IS inside a function body !\" :</p>\n<div class=\"codehilite\"><pre><span></span><code>The return keyword can only be used inside a function body.\n\nUse `return` to exit early from a function and provide a value. For example:\n    foo = |x| { if x &lt; 0 { return Err(NegativeInput) }; Ok(x) }\n</code></pre></div>",
        "id": 576355897,
        "sender_full_name": "Norbert Hajagos",
        "timestamp": 1772229409
    }
]