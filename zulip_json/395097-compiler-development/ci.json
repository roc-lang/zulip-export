[
    {
        "content": "<p><a href=\"https://github.com/roc-lang/roc/pull/8565\">https://github.com/roc-lang/roc/pull/8565</a> failed on Nix checks only, but there's no error message and I'm not sure how to debug <span aria-label=\"sweat smile\" class=\"emoji emoji-1f605\" role=\"img\" title=\"sweat smile\">:sweat_smile:</span> </p>\n<p>I'm going to merge because it has some important fixes and is prone to merge conflicts, plus I don't see why anything should have changed in terms of Nix <span aria-label=\"raised\" class=\"emoji emoji-1f928\" role=\"img\" title=\"raised\">:raised:</span> </p>\n<p>can anyone who has Nix set up try to reproduce that locally?</p>",
        "id": 562110872,
        "sender_full_name": "Richard Feldman",
        "timestamp": 1764944184
    },
    {
        "content": "<p>I'll take a quick look</p>",
        "id": 562117864,
        "sender_full_name": "Anton",
        "timestamp": 1764945922
    },
    {
        "content": "<p>It passes now <a href=\"https://github.com/roc-lang/roc/pull/8575\">https://github.com/roc-lang/roc/pull/8575</a> , I did not change anything :p <br>\nThere was also nothing in your failing check output that showed what was going wrong, I guess we'll see if it pops up again.</p>",
        "id": 562122327,
        "sender_full_name": "Anton",
        "timestamp": 1764947059
    },
    {
        "content": "<p>I think I found a fix - <a href=\"https://github.com/roc-lang/roc/pull/8579\">https://github.com/roc-lang/roc/pull/8579</a> - I believe the problem was that we were rebuilding the roc binary before each fx test, to prevent staleness, and this resulted in too much disk usage for the Nix environment, resulting in an error with no clear error message.</p>",
        "id": 562256120,
        "sender_full_name": "Richard Feldman",
        "timestamp": 1765044333
    },
    {
        "content": "<p>however, that PR is now failing on a valgrind error that suggests maybe we install a non-stripped <a href=\"http://ld.so\">ld.so</a> equivalent in that environment?</p>\n<blockquote>\n<p>debug: reported NIL problems</p>\n<p>debug: processing snapshot file: /home/runner/work/roc/roc/test/snapshots/expr_no_space_dot_int.md</p>\n<p>debug: Generating snapshot for: /home/runner/work/roc/roc/test/snapshots/expr_no_space_dot_int.md</p>\n<p>debug: processing snapshot file: /home/runner/work/roc/roc/test/snapshots/can_import_exposing_types.md</p>\n<p>debug: Generating snapshot for: /home/runner/work/roc/roc/test/snapshots/can_import_exposing_types.md</p>\n<p>==6829==</p>\n<p>==6829== HEAP SUMMARY:</p>\n<p>==6829== in use at exit: 0 bytes in 0 blocks</p>\n<p>==6829== total heap usage: 0 allocs, 0 frees, 0 bytes allocated</p>\n<p>==6829==</p>\n<p>==6829== All heap blocks were freed -- no leaks are possible</p>\n<p>==6829==</p>\n<p>==6829== For lists of detected and suppressed errors, rerun with: -s</p>\n<p>==6829== ERROR SUMMARY: 0 errors from 0 contexts (suppressed: 0 from 0)</p>\n<p>==6906== Memcheck, a memory error detector</p>\n<p>==6906== Copyright (C) 2002-2024, and GNU GPL'd, by Julian Seward et al.</p>\n<p>==6906== Using Valgrind-3.26.0 and LibVEX; rerun with -h for copyright info</p>\n<p>==6906== Command: ./zig-out/bin/roc --no-cache test/str/app.roc</p>\n<p>==6906==</p>\n<p>valgrind: Fatal error at startup: a function redirection</p>\n<p>valgrind: which is mandatory for this platform-tool combination</p>\n<p>valgrind: cannot be set up. Details of the redirection are:</p>\n<p>valgrind:</p>\n<p>valgrind: A must-be-redirected function</p>\n<p>valgrind: whose name matches the pattern: memcmp</p>\n<p>valgrind: in an object with soname matching: ld-linux-x86-64.so.2</p>\n<p>valgrind: was not found whilst processing</p>\n<p>valgrind: symbols from the object with soname: ld-linux-x86-64.so.2</p>\n<p>valgrind:</p>\n<p>valgrind: Possible fixes: (1, short term): install glibc's debuginfo</p>\n<p>valgrind: package on this machine. (2, longer term): ask the packagers</p>\n<p>valgrind: for your Linux distribution to please in future ship a non-</p>\n<p>valgrind: stripped <a href=\"http://ld.so\">ld.so</a> (or whatever the dynamic linker .so is called)</p>\n<p>valgrind: that exports the above-named function using the standard</p>\n<p>valgrind: calling conventions for this platform. The package you need</p>\n<p>valgrind: to install for fix (1) is called</p>\n<p>valgrind:</p>\n<p>valgrind: On Debian, Ubuntu: libc6-dbg</p>\n<p>valgrind: On SuSE, openSuSE, Fedora, RHEL: glibc-debuginfo</p>\n<p>valgrind:</p>\n<p>valgrind: Note that if you are debugging a 32 bit process on a</p>\n<p>valgrind: 64 bit system, you will need a corresponding 32 bit debuginfo</p>\n<p>valgrind: package (e.g. libc6-dbg:i386).</p>\n<p>valgrind:</p>\n<p>valgrind: Cannot continue -- exiting now. Sorry</p>\n</blockquote>",
        "id": 562256165,
        "sender_full_name": "Richard Feldman",
        "timestamp": 1765044382
    },
    {
        "content": "<p>Looks like it's fixed :)</p>",
        "id": 562434512,
        "sender_full_name": "Anton",
        "timestamp": 1765190559
    },
    {
        "content": "<p>oh yeah Claude had a suggested fix in a recent PR, and it ended up resolving it</p>",
        "id": 562481472,
        "sender_full_name": "Richard Feldman",
        "timestamp": 1765204345
    }
]