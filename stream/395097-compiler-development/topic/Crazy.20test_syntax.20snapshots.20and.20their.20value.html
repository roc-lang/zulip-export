<html>
<head><meta charset="utf-8"><title>Crazy test_syntax snapshots and their value · compiler development · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/index.html">compiler development</a></h2>
<h3>Topic: <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html">Crazy test_syntax snapshots and their value</a></h3>

<hr>

<base href="https://roc.zulipchat.com">

<head><link href="https://roc-lang.github.io/zulip-export/style.css" rel="stylesheet"></head>

<a name="493382879"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493382879" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493382879">(Jan 13 2025 at 15:41)</a>:</h4>
<p>I have spent a lot of time on making this snapshot format in a stable fashion:</p>
<div class="codehilite" data-code-language="Elm"><pre><span></span><code><span class="mi">8</span>
<span class="p">(</span><span class="s">""""""""</span><span class="p">)</span><span class="nv">f</span><span class="nf">:</span><span class="kt">C</span>
<span class="kt">U</span>
</code></pre></div>
<p>Which should format to:</p>
<div class="codehilite" data-code-language="Elm"><pre><span></span><code><span class="mi">8</span>
<span class="p">(</span>
<span class="s">"""</span>
<span class="s">"""</span>
<span class="w">    </span><span class="s">""</span><span class="p">)</span>
<span class="w">    </span><span class="nv">f</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">C</span>
<span class="kt">U</span>
</code></pre></div>
<p>But on reformat ALWAYS becomes:</p>
<div class="codehilite" data-code-language="Elm"><pre><span></span><code><span class="mi">8</span>

<span class="p">(</span>
<span class="s">"""</span>
<span class="s">"""</span>
<span class="w">    </span><span class="s">""</span><span class="p">)</span>
<span class="w">    </span><span class="nv">f</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">C</span>
<span class="kt">U</span>
</code></pre></div>
<p>See that extra newline?  The reason for it is complicated and has to do with ParensAround not existing in Patterns and the fact that we first parse annotation headers as an expr and translate to Pattern.  But it really only impacts this case.</p>
<p>But what is the value of having a snapshot that tests the formatting behavior of a illegal pattern?  Should we have some way to say "This thing we parsed actually doesn't make any sense, so we expect the formatter to fail here and shouldn't test this?"  I think such a change would largely impact the fuzzer since it's the thing that introduced these snapshots in the first place.</p>



<a name="493383461"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493383461" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493383461">(Jan 13 2025 at 15:44)</a>:</h4>
<p>My large point is we have a lot of illegal or invalid Roc syntax in test_syntax snapshots.  I think there's value in us being able to parse them, but I think we should be more aggressive in making these not part of the Parse-&gt;Format-&gt;Reformat cycle - perhaps by making them Malformed sooner?</p>



<a name="493383607"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493383607" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493383607">(Jan 13 2025 at 15:45)</a>:</h4>
<p>Lastly, I really think that having test_syntax actually document invariants of what is <em>actual, valid Roc syntax</em> is just so much higher value.</p>



<a name="493383949"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493383949" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493383949">(Jan 13 2025 at 15:46)</a>:</h4>
<p>And if we can't find a way to turn a fuzzer failure into a real, valid piece of Roc syntax - we should be doing something in either the fuzzer or the parser to ensure that it is marked as Malformed and therefore the fuzzer will discard such an input in the future without generating noise.</p>



<a name="493384553"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493384553" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493384553">(Jan 13 2025 at 15:49)</a>:</h4>
<p>I'd like to see:</p>
<div class="codehilite" data-code-language="Elm"><pre><span></span><code><span class="p">(</span>
<span class="s">"""</span>
<span class="s">"""</span>
<span class="w">    </span><span class="s">""</span><span class="p">)</span>
<span class="w">    </span><span class="nv">f</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">C</span>
</code></pre></div>
<p>Be a TypeAnnotation(TypeHeader(Apply(Malformed, Ident("f"))), Tag("C")) and then have fuzzer bail out at that point</p>



<a name="493384689"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493384689" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493384689">(Jan 13 2025 at 15:50)</a>:</h4>
<p><span class="user-mention" data-user-id="453336">@Joshua Warner</span> <span class="user-mention" data-user-id="461444">@Sam Mohr</span> I think you will have the most thoughts on this.</p>



<a name="493385563"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493385563" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493385563">(Jan 13 2025 at 15:54)</a>:</h4>
<p>I guess I'll end my mini-rant on a positive note and give a potential vision of what these snapshots could be: </p>
<blockquote>
<p><strong>A visual guide to valid Roc syntax</strong> - from the simplest constructs to the most complex.  Showing how it can be written quickly, and how it will always look when formatted.  Documenting both the syntax of the language, as well as the formatter's style.</p>
</blockquote>
<p>That will then help us identify clearly what the style <em>is</em> and the principles we use when maintaining and extending it with new syntax.</p>



<a name="493386391"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493386391" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493386391">(Jan 13 2025 at 15:57)</a>:</h4>
<p>And just for a laugh, here's the same example with PNC migration if we did that</p>
<div class="codehilite" data-code-language="Elm"><pre><span></span><code><span class="mi">8</span>
<span class="s">"""</span>
<span class="s">"""</span><span class="p">(</span>
<span class="w">    </span><span class="s">""</span><span class="p">,</span>
<span class="p">)(</span>
<span class="w">    </span><span class="nv">f</span><span class="p">,</span>
<span class="p">)</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">C</span>
<span class="kt">U</span>
</code></pre></div>
<p>And with collapsed whitespace in the PNC applys:</p>
<div class="codehilite" data-code-language="Elm"><pre><span></span><code><span class="mi">8</span>
<span class="s">"""</span>
<span class="s">"""</span><span class="p">(</span><span class="s">""</span><span class="p">)(</span><span class="nv">f</span><span class="p">)</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">C</span>
<span class="kt">U</span>
</code></pre></div>



<a name="493388891"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493388891" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493388891">(Jan 13 2025 at 16:08)</a>:</h4>
<p>Just one more thing before i go to work (and I may move this to <a class="stream" data-stream-id="304641" href="/#narrow/channel/304641-ideas">#ideas</a> ), should this really just be a md document(or documents) with code blocks appropriately annotated?  Then it could really be what I envision above - a <strong><em>programmatically checked guide to valid Roc syntax and the canonical formatted style</em></strong>.</p>



<a name="493389951"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493389951" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493389951">(Jan 13 2025 at 16:12)</a>:</h4>
<blockquote>
<p><em>programmatically checked guide to valid Roc syntax</em></p>
</blockquote>
<p>That sure seems useful for the tree sitter parser and similar tools</p>



<a name="493390460"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493390460" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493390460">(Jan 13 2025 at 16:15)</a>:</h4>
<p>I think so, and for people learning Roc</p>



<a name="493390606"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493390606" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493390606">(Jan 13 2025 at 16:15)</a>:</h4>
<p>We could even tag the document sections and find a way to link Syntax problems with the relevant section(s) and output it with the report</p>



<a name="493392222"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493392222" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493392222">(Jan 13 2025 at 16:22)</a>:</h4>
<p>Someone does something crazy like the above and they get a nice syntax error report like:</p>
<div class="codehilite"><pre><span></span><code>Syntax Error @ main.roc 12:2-12:8 -----------------------------------------

(&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;) f: C
 ^----- | The problem is here

It looks like you are trying to perform function application on a string literal, but that
is not valid Roc.  Here&#39;s some tips:

Usually, you would apply an Identifier or a Tag, like this:

func(arg)
# Or
Tag(arg)

Both of these would format exactly the same as above.

To get more tips on syntax for function application, use `roc syntax apply`.

--------------------------------------------------------------------------------------
</code></pre></div>



<a name="493393739"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493393739" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493393739">(Jan 13 2025 at 16:28)</a>:</h4>
<p>Where <code>roc syntax</code> <em>could</em> be a new subcommand in the CLI to allow the user to browse or search the syntax guide</p>



<a name="493394717"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493394717" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493394717">(Jan 13 2025 at 16:32)</a>:</h4>
<p>And since this is checked in CI on every commit - this guide would always be correct for that version of the compiler.</p>



<a name="493434142"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493434142" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493434142">(Jan 13 2025 at 19:47)</a>:</h4>
<p>We generate an <code>llms.txt</code> file and provide it in the tutorial <a href="https://github.com/roc-lang/roc/blob/070de5841617423f2f59a370b7ea8cf7bab628d6/www/content/tutorial.md?plain=1#L32">here</a></p>



<a name="493434256"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493434256" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493434256">(Jan 13 2025 at 19:48)</a>:</h4>
<p>I think a generated file would suffice here, something that's <em>reasonably</em> legible for humans and definitely for computers</p>



<a name="493434610"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493434610" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493434610">(Jan 13 2025 at 19:50)</a>:</h4>
<p>What I'm talking about it a systematic inventory of valid syntax that can be tested and verified and can replace test_fmt at least the _vast_ majority of snapshots.  (They would act as snapshots)</p>



<a name="493434672"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493434672" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493434672">(Jan 13 2025 at 19:50)</a>:</h4>
<p>Oh, in <em>place</em> of snapshots.</p>



<a name="493434692"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493434692" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493434692">(Jan 13 2025 at 19:50)</a>:</h4>
<p>Yes</p>



<a name="493434828"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493434828" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493434828">(Jan 13 2025 at 19:51)</a>:</h4>
<p>And since they would be user-facing inside of documentation, there would be context around each example, they would be valid Roc code, and not a bunch of randomly-generated non-sense</p>



<a name="493434852"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493434852" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493434852">(Jan 13 2025 at 19:51)</a>:</h4>
<p>I agree that the snapshots are moving further from a set of unit test-like valid examples of Roc code and more like Eldritch horrors that get cleaned up and saved to keep us from crashing when we see them</p>



<a name="493434857"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493434857" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493434857">(Jan 13 2025 at 19:51)</a>:</h4>
<p>And this is NOT saying that the fuzzer does not have value.  But in it's current way of being used it's painful</p>



<a name="493435020"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493435020" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493435020">(Jan 13 2025 at 19:52)</a>:</h4>
<p>I'd like to see the fuzzer move to a generator/property-based test</p>



<a name="493435065"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493435065" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493435065">(Jan 13 2025 at 19:53)</a>:</h4>
<p>I'm thinking of the Rust reference: <a href="https://doc.rust-lang.org/reference/introduction.html">https://doc.rust-lang.org/reference/introduction.html</a></p>



<a name="493435193"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493435193" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493435193">(Jan 13 2025 at 19:53)</a>:</h4>
<p>(I know the fuzzer technically is, but I mean generated from a specification, not from a small corpus and otherwise random text)</p>



<a name="493435472"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493435472" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493435472">(Jan 13 2025 at 19:55)</a>:</h4>
<p>I think that Rust reference is a good place to start.  But I'd really like to show both the canonical form of each bit of syntax as well as the "most terrible way to type this and it still parse right"</p>



<a name="493435542"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493435542" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493435542">(Jan 13 2025 at 19:55)</a>:</h4>
<p>And that can be our version of <code>*_formats_to</code>/<code>*_formats_same</code></p>



<a name="493435599"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493435599" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493435599">(Jan 13 2025 at 19:56)</a>:</h4>
<p>That is a noble goal, but I don't know how achievable it is to make something that is a good reference resource AND good for testing</p>



<a name="493435689"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493435689" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493435689">(Jan 13 2025 at 19:56)</a>:</h4>
<p>Unless it's not actually your goal to do both at once</p>



<a name="493435835"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493435835" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493435835">(Jan 13 2025 at 19:57)</a>:</h4>
<p>I have a design that would make it possible to do both at once.  It's called the documentation will link in the code samples that are valid into the reference</p>



<a name="493436015"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493436015" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493436015">(Jan 13 2025 at 19:58)</a>:</h4>
<p>And if we do make a CLI subcommand for it you could have a --extended flag or something and see everything that matches the search term</p>



<a name="493456046"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493456046" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493456046">(Jan 13 2025 at 21:46)</a>:</h4>
<p>I feel like we could just delete any snapshots that are not helpful when making a change. They're not sacred or anything. Is this the core of your issue? trying to save or fix snapshots that are super random and strange. </p>
<p>We've been on a mission to get fuzz clean.... parsing and canonicalisation of all the things and not crashing. </p>
<p>Returning Malformed for something really strange sounds like a good strategy to me. </p>
<p>I'm concerned about changing the current setup dramatically, Josh has used it to good effect finding and smashing a lot of bugs.</p>



<a name="493456421"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493456421" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493456421">(Jan 13 2025 at 21:48)</a>:</h4>
<p>Yeah I just want a fuzzer thats only crashing on legit bugs</p>



<a name="493456458"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493456458" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493456458">(Jan 13 2025 at 21:48)</a>:</h4>
<p>And not crazy ass syntax it got by throwing paint on the wall</p>



<a name="493456554"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493456554" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493456554">(Jan 13 2025 at 21:49)</a>:</h4>
<p>So if we just make things malformed earlier (and / or canonicalize them) I think it would be better</p>



<a name="493457763"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493457763" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493457763">(Jan 13 2025 at 21:57)</a>:</h4>
<p>Agree a lot of them are on the funky side. Not sure I agree they aren't legitimate bugs.</p>



<a name="493457789"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493457789" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493457789">(Jan 13 2025 at 21:57)</a>:</h4>
<p>I strongly value _reliable_ software</p>



<a name="493458035"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493458035" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493458035">(Jan 13 2025 at 21:58)</a>:</h4>
<p>I want to provide a 100% guarantee that using the formatter is "safe" - i.e. it won't change the meaning of your code or change again once formatted again, etc.</p>



<a name="493458057"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493458057" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493458057">(Jan 13 2025 at 21:59)</a>:</h4>
<p>I will say, not that we'll feel the benefit for the next month or so, but the <code>roc_can</code> rewrite aims to never crash for this stuff. The parser might crash, but there will be literally zero unwraps or expects in the new canonicalization code</p>



<a name="493458332"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493458332" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493458332">(Jan 13 2025 at 22:00)</a>:</h4>
<p>So if we're putting a lot of effort into fixing current <code>roc_can</code>, that may not be necessary</p>



<a name="493458404"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493458404" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493458404">(Jan 13 2025 at 22:00)</a>:</h4>
<p>Ah good to know</p>



<a name="493458473"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493458473" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493458473">(Jan 13 2025 at 22:00)</a>:</h4>
<p>Do you have more detail on this roc_can rewrite? What's the goal/scope/etc?</p>



<a name="493458532"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493458532" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493458532">(Jan 13 2025 at 22:01)</a>:</h4>
<p>(maybe in another thread...)</p>



<a name="493458542"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493458542" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493458542">(Jan 13 2025 at 22:01)</a>:</h4>
<p>Sure</p>



<a name="493458594"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493458594" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493458594">(Jan 13 2025 at 22:01)</a>:</h4>
<p>I can also probably outline this at the next meetup</p>



<a name="493458624"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493458624" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493458624">(Jan 13 2025 at 22:01)</a>:</h4>
<p>I'll make another thread for now</p>



<a name="493458657"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493458657" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493458657">(Jan 13 2025 at 22:01)</a>:</h4>
<p>Anyway to finish my earlier thought, I want to provide that 100% guarantee, but I'd be open to alternative ways of accomplishing that</p>



<a name="493458794"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493458794" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493458794">(Jan 13 2025 at 22:02)</a>:</h4>
<p>For example, we could do things like detect some of these more niche cases and just refuse to format in that case (maybe that's what you're getting at)</p>



<a name="493458913"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493458913" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493458913">(Jan 13 2025 at 22:03)</a>:</h4>
<p>Ideally, that only introduces a "local" problem, so if you have one tiny problem in a giant file, most of the file can still be formatted properly, and it's only the top-level def with the problem that is copied verbatim from the input</p>



<a name="493458921"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493458921" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493458921">(Jan 13 2025 at 22:03)</a>:</h4>
<p>Roc <em>needs</em> to be 100% reliable</p>



<a name="493458946"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493458946" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493458946">(Jan 13 2025 at 22:03)</a>:</h4>
<p>Mental security is like, the whole point of this language</p>



<a name="493459828"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493459828" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493459828">(Jan 13 2025 at 22:08)</a>:</h4>
<p>Yes it will be safe and only introduce a local issue where the illegal syntax does not get formatted</p>



<a name="493459884"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493459884" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493459884">(Jan 13 2025 at 22:09)</a>:</h4>
<p>Cool, makes sense</p>



<a name="493459887"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493459887" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493459887">(Jan 13 2025 at 22:09)</a>:</h4>
<p>This is syntax that will NOT be accepted by later stages of the compiler anywya</p>



<a name="493459914"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493459914" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493459914">(Jan 13 2025 at 22:09)</a>:</h4>
<p>Yeah, that's true</p>



<a name="493459945"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493459945" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493459945">(Jan 13 2025 at 22:09)</a>:</h4>
<p>Like trying to apply a string literal <span aria-label="joy" class="emoji emoji-1f602" role="img" title="joy">:joy:</span></p>



<a name="493460042"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493460042" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493460042">(Jan 13 2025 at 22:10)</a>:</h4>
<p>I want all valid roc syntax to be Roc solid <em>ducks</em></p>



<a name="493460107"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493460107" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493460107">(Jan 13 2025 at 22:10)</a>:</h4>
<p>hey man, like, strings are functions too</p>



<a name="493460114"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493460114" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493460114">(Jan 13 2025 at 22:10)</a>:</h4>
<p>Just because the minimal example that currently hits this case is silly, doesn't mean all such examples that hit this case are silly</p>



<a name="493460184"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493460184" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493460184">(Jan 13 2025 at 22:10)</a>:</h4>
<p>The term "stringly-typed" should not need to exist</p>



<a name="493460198"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493460198" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493460198">(Jan 13 2025 at 22:10)</a>:</h4>
<p>Maybe but I’d like to focus on the actual examples that are</p>



<a name="493460320"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493460320" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493460320">(Jan 13 2025 at 22:11)</a>:</h4>
<p>I've thought about an April fools joke announcement of like introducing truthiness or unchecked <code>null</code> or something like that</p>



<a name="493460325"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493460325" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493460325">(Jan 13 2025 at 22:11)</a>:</h4>
<p>A fuzzer bug should be able to be coerced into a real working code sample and still reproduce</p>



<a name="493460384"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493460384" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493460384">(Jan 13 2025 at 22:11)</a>:</h4>
<p>In my experience, that quickly devolves into either:</p>
<ul>
<li>just fixing the bug and making the parser/formatter extra resiliant</li>
<li>OR: disallowing some broad bit of syntax, bailing out early</li>
</ul>



<a name="493460579"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493460579" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493460579">(Jan 13 2025 at 22:12)</a>:</h4>
<p>Yes, <a href="https://github.com/roc-lang/roc/issues/2">#2</a> but only bailing out at format</p>



<a name="493460665"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493460665" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493460665">(Jan 13 2025 at 22:13)</a>:</h4>
<p>That could be done in format itself</p>



<a name="493460793"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493460793" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493460793">(Jan 13 2025 at 22:13)</a>:</h4>
<p>For your example with multiline strings for example, I 100% agree applying a function like that is not valid - but take this as an example then:</p>
<div class="codehilite"><pre><span></span><code>&quot;&quot;&quot;abc&quot;&quot;&quot;.foo(1)(2)
</code></pre></div>
<p>... where foo is a curried function of some kind</p>



<a name="493460848"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493460848" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493460848">(Jan 13 2025 at 22:14)</a>:</h4>
<p>I think that'll end up hitting similar problems</p>



<a name="493461074"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493461074" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493461074">(Jan 13 2025 at 22:15)</a>:</h4>
<p>Now or when we have static dispatch?</p>



<a name="493461116"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493461116" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493461116">(Jan 13 2025 at 22:15)</a>:</h4>
<p>That example is obviously using static dispatch</p>



<a name="493461228"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493461228" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493461228">(Jan 13 2025 at 22:16)</a>:</h4>
<p>Anyway, my point is that I've found it's better to just give in and fix the problem rather than avoiding it</p>



<a name="493461290"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493461290" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493461290">(Jan 13 2025 at 22:16)</a>:</h4>
<p>Avoiding it completely ends up with very complicated conditions, or very "blunt" / annoying conditions</p>



<a name="493461294"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493461294" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493461294">(Jan 13 2025 at 22:16)</a>:</h4>
<p>I just don’t think it’s a problem. It’s invalid syntax, no?</p>



<a name="493461325"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493461325" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493461325">(Jan 13 2025 at 22:16)</a>:</h4>
<p>Maybe I’m just being dull</p>



<a name="493461326"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493461326" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493461326">(Jan 13 2025 at 22:16)</a>:</h4>
<p>No, it's perfectly valid syntax</p>



<a name="493461360"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493461360" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493461360">(Jan 13 2025 at 22:17)</a>:</h4>
<p>Sorry not what you just put</p>



<a name="493461373"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493461373" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493461373">(Jan 13 2025 at 22:17)</a>:</h4>
<p>The motivating example above</p>



<a name="493461433"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493461433" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493461433">(Jan 13 2025 at 22:17)</a>:</h4>
<p>Ahh</p>



<a name="493461446"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493461446" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493461446">(Jan 13 2025 at 22:17)</a>:</h4>
<p>Yeah</p>



<a name="493461487"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493461487" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493461487">(Jan 13 2025 at 22:17)</a>:</h4>
<p>In that particular case it is kinda-but-not-really invalid right now</p>



<a name="493461489"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493461489" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493461489">(Jan 13 2025 at 22:17)</a>:</h4>
<p>That’s what I’m talking about</p>



<a name="493461499"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493461499" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493461499">(Jan 13 2025 at 22:17)</a>:</h4>
<p>That'll bail early in <code>can</code></p>



<a name="493461607"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493461607" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493461607">(Jan 13 2025 at 22:18)</a>:</h4>
<p>I actually have a PR locally to refactor a bit and make that <code>malformed</code> syntax, which right now the fuzzer won't try to assert formatting conditions on</p>



<a name="493461615"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493461615" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493461615">(Jan 13 2025 at 22:18)</a>:</h4>
<p>Yes and if it bails early in can, I think we can kind of punt on it in formatting</p>



<a name="493461641"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493461641" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493461641">(Jan 13 2025 at 22:18)</a>:</h4>
<blockquote>
<p>I think we can kind of punt on it in formatting</p>
</blockquote>
<p>Disagree</p>



<a name="493461685"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493461685" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493461685">(Jan 13 2025 at 22:18)</a>:</h4>
<p><span class="user-mention silent" data-user-id="453336">Joshua Warner</span> <a href="#narrow/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value/near/493461607">said</a>:</p>
<blockquote>
<p>I actually have a PR locally to refactor a bit and make that <code>malformed</code> syntax, which right now the fuzzer won't try to assert formatting conditions on</p>
</blockquote>
<p>This is exactly what I’m advocating for</p>



<a name="493461744"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493461744" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493461744">(Jan 13 2025 at 22:19)</a>:</h4>
<p>Ok cool</p>



<a name="493461756"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493461756" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493461756">(Jan 13 2025 at 22:19)</a>:</h4>
<p>(deleted)</p>



<a name="493461766"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493461766" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493461766">(Jan 13 2025 at 22:19)</a>:</h4>
<p>Somehow we are disagreeing and agreeing at the same time. It’s probably my poor communication</p>



<a name="493461801"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493461801" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493461801">(Jan 13 2025 at 22:19)</a>:</h4>
<p>Haha np. Takes two to (mis)communicate</p>



<a name="493461844"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493461844" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493461844">(Jan 13 2025 at 22:19)</a>:</h4>
<p>To be clear the fuzzer is an awesome tool.</p>



<a name="493461974"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493461974" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493461974">(Jan 13 2025 at 22:20)</a>:</h4>
<p>I've been pushing hard on the angle of "just make it work", since I've been seeing progress there recently</p>



<a name="493461990"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493461990" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493461990">(Jan 13 2025 at 22:20)</a>:</h4>
<p>I just think that we need tests that give context on what they are testing, why we care, and what we want things to look like</p>



<a name="493462034"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493462034" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493462034">(Jan 13 2025 at 22:20)</a>:</h4>
<p>Like 2-ish years ago I ran into a period where I got very frustrated with that approach and basically gave up for a while</p>



<a name="493462121"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493462121" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493462121">(Jan 13 2025 at 22:21)</a>:</h4>
<p>I’ve read more gobbledygook fuzzer Roc than real Roc the past two weeks and I think I have PTSD</p>



<a name="493462173"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493462173" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493462173">(Jan 13 2025 at 22:21)</a>:</h4>
<p>Fo real</p>



<a name="493462194"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493462194" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493462194">(Jan 13 2025 at 22:21)</a>:</h4>
<p>100% on board with taking tests and changing them to make them more realistic, so long as they're still covering the same conditions</p>



<a name="493462275"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493462275" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493462275">(Jan 13 2025 at 22:22)</a>:</h4>
<p>(And totally fine if that means they are now marked as 'malformed')</p>



<a name="493462318"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493462318" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493462318">(Jan 13 2025 at 22:22)</a>:</h4>
<p>That makes me happy</p>



<a name="493462387"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493462387" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493462387">(Jan 13 2025 at 22:22)</a>:</h4>
<p>And then we can use the best of the best in the syntax reference I’m talking about (which could be very selective and part of the tutorial)</p>



<a name="493462701"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493462701" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493462701">(Jan 13 2025 at 22:25)</a>:</h4>
<p>I'm extremely excited to see all the progress on fixing these things the fuzzer is turning up, because compiler bugs are one of the biggest things holding Roc back from reaching its potential</p>



<a name="493462800"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493462800" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493462800">(Jan 13 2025 at 22:25)</a>:</h4>
<p>and fizzers that run for a long time without turning up anything give me way more confidence than anything like what we've ever had in the past!</p>



<a name="493462928"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493462928" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493462928">(Jan 13 2025 at 22:26)</a>:</h4>
<p>so I really appreciate all your efforts on wading through the gibberish to get us there! <span aria-label="hearts" class="emoji emoji-2665" role="img" title="hearts">:hearts:</span></p>



<a name="493463071"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493463071" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493463071">(Jan 13 2025 at 22:27)</a>:</h4>
<p>FWIW I don't think the fuzzer is covering any of the really "interesting" parts of the compiler yet (say, the solver) - where I'd define "interesting" as "users often hitting compiler crashes in this area"</p>



<a name="493463096"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493463096" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493463096">(Jan 13 2025 at 22:27)</a>:</h4>
<p>But that would be my eventual goal here</p>



<a name="493463105"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493463105" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493463105">(Jan 13 2025 at 22:27)</a>:</h4>
<p>Baby steps</p>



<a name="493463363"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493463363" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493463363">(Jan 13 2025 at 22:29)</a>:</h4>
<p>I think my open PR merging spaces within spaces will help with some fuzzer crashes</p>



<a name="493463830"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493463830" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493463830">(Jan 13 2025 at 22:31)</a>:</h4>
<p>There are some peculiarities of roc syntax that make it particularly hard to parse+format consistently</p>



<a name="493463942"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493463942" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493463942">(Jan 13 2025 at 22:32)</a>:</h4>
<p>For example, multiline strings very often cause problems if they're used outside of very specific situations</p>



<a name="493464075"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493464075" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493464075">(Jan 13 2025 at 22:32)</a>:</h4>
<p>Like, they're fine if you're just assigning that to a local, but if you try to do anything else with them, that requires a lot of persnickety condition checking in the formatter</p>



<a name="493464194"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493464194" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493464194">(Jan 13 2025 at 22:33)</a>:</h4>
<p><code>when</code> branches are also tough</p>



<a name="493465219"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493465219" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493465219">(Jan 13 2025 at 22:39)</a>:</h4>
<p>With backpassing gone, function types are [almost] the last instance where we have "naked" parens inside a syntax element (i.e. where there's not a starting + finishing delimiter to branch on, so we either have to do excessive backtracking or we have to de-normalize the function type parser in the context of tuple types and tag unions)</p>



<a name="493465282"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493465282" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493465282">(Jan 13 2025 at 22:39)</a>:</h4>
<p>The other case I believe just being comma-separated <code>where</code> clauses</p>



<a name="493465434"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493465434" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493465434">(Jan 13 2025 at 22:40)</a>:</h4>
<p>If <code>where ...</code> is the last place, is there a way to change how they look to make that not the case?</p>



<a name="493465564"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493465564" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493465564">(Jan 13 2025 at 22:41)</a>:</h4>
<p>Function types are still causing problems, so <code>where ...</code> is definitely not the last place, but anyway...</p>



<a name="493465611"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493465611" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493465611">(Jan 13 2025 at 22:41)</a>:</h4>
<p>The solution for function types would be to have some sort of "introduction" delimiter</p>



<a name="493465627"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493465627" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493465627">(Jan 13 2025 at 22:41)</a>:</h4>
<p>e.g. could prefix them with <code>\</code> or <code>fn</code></p>



<a name="493465706"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493465706" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493465706">(Jan 13 2025 at 22:42)</a>:</h4>
<p>Or use PNC for types right?</p>



<a name="493465751"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493465751" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493465751">(Jan 13 2025 at 22:42)</a>:</h4>
<p>Yeah, would <a class="stream-topic" data-stream-id="304641" href="/#narrow/channel/304641-ideas/topic/Using.20parens.20for.20types">#ideas &gt; Using parens for types</a> help?</p>



<a name="493465768"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493465768" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493465768">(Jan 13 2025 at 22:42)</a>:</h4>
<p>I don't think PNC helps with types</p>



<a name="493465862"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493465862" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493465862">(Jan 13 2025 at 22:43)</a>:</h4>
<p>Why not?  That makes all type expressions bounded</p>



<a name="493465875"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493465875" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493465875">(Jan 13 2025 at 22:43)</a>:</h4>
<p>PNC for types only changes type application, e.g. <code>List(foo)</code> instead of <code>List foo</code>. That's not the issue here.</p>



<a name="493465922"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493465922" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493465922">(Jan 13 2025 at 22:43)</a>:</h4>
<p>No, it also means () around params</p>



<a name="493465945"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493465945" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493465945">(Jan 13 2025 at 22:43)</a>:</h4>
<p>Ahhh yes that would help</p>



<a name="493465959"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493465959" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493465959">(Jan 13 2025 at 22:43)</a>:</h4>
<p>Sorry I misunderstood</p>



<a name="493465974"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493465974" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493465974">(Jan 13 2025 at 22:43)</a>:</h4>
<p>No worries</p>



<a name="493466044"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493466044" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493466044">(Jan 13 2025 at 22:44)</a>:</h4>
<p>I think Sam brought that up this morning or last night</p>



<a name="493466058"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493466058" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493466058">(Jan 13 2025 at 22:44)</a>:</h4>
<p>e.g. <code>(Str, Str) -&gt; Str</code> instead of <code>Str, Str -&gt; Str</code></p>



<a name="493466150"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493466150" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493466150">(Jan 13 2025 at 22:44)</a>:</h4>
<p>I suggested that because it would make parsing code for devs and the compiler all very consistent</p>



<a name="493466203"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493466203" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493466203">(Jan 13 2025 at 22:45)</a>:</h4>
<p>And would slot in well with zero-arg functions</p>



<a name="493466268"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493466268" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493466268">(Jan 13 2025 at 22:45)</a>:</h4>
<p>Oh yeah that works nicely</p>



<a name="493466684"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493466684" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493466684">(Jan 13 2025 at 22:48)</a>:</h4>
<p>Another point for Sam!</p>



<a name="493466704"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493466704" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493466704">(Jan 13 2025 at 22:48)</a>:</h4>
<p>For <code>where ...</code>, I think the solution would look something like allowing parens around the <code>...</code> part, and furthermore _requiring_ cases where there are multiple implements clauses to use that parens syntax, at least if it's in a context where <code>,</code> would separate elements (e.g. in a tuple type)</p>



<a name="493466710"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493466710" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493466710">(Jan 13 2025 at 22:48)</a>:</h4>
<p>Love you too</p>



<a name="493466739"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493466739" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493466739">(Jan 13 2025 at 22:48)</a>:</h4>
<p>That would almost never come up in practice, so probably not much of an actual change</p>



<a name="493466810"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493466810" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493466810">(Jan 13 2025 at 22:49)</a>:</h4>
<p>Or could just disallow <code>where</code> except at the top level</p>



<a name="493466960"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493466960" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493466960">(Jan 13 2025 at 22:50)</a>:</h4>
<p>That seems even better actually. Not sure why you'd ever want <code>(List a where a implements Foo, List b where b implements Foo)</code> instead of just <code>(List a, List b) where a implements Foo, b implements Foo</code></p>



<a name="493467231"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493467231" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493467231">(Jan 13 2025 at 22:52)</a>:</h4>
<p>The latter is my current thought for what Roc's type syntax would be. That's not a problem, right?</p>



<a name="493467313"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493467313" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493467313">(Jan 13 2025 at 22:52)</a>:</h4>
<p>Technically speaking I guess there are very niche cases where that could come up, if there's a list at a higher level</p>



<a name="493467505"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493467505" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493467505">(Jan 13 2025 at 22:53)</a>:</h4>
<p>e.g. a tuple of expressions, where one of the expressions is a Defs node with a type annotation</p>



<a name="493467681"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493467681" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493467681">(Jan 13 2025 at 22:54)</a>:</h4>
<p>Distinguishing whether that comma means we should parse the next <code>implements</code> clause, or go up and parse the next top-level expr in the tuple is non-trivial</p>



<a name="493467710"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493467710" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493467710">(Jan 13 2025 at 22:54)</a>:</h4>
<p>Wouldn’t that be bounded by the arrow?</p>



<a name="493467742"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493467742" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493467742">(Jan 13 2025 at 22:55)</a>:</h4>
<p>There's not necessarily any arrow after</p>



<a name="493467812"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493467812" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493467812">(Jan 13 2025 at 22:55)</a>:</h4>
<p>I think we should have implements at the tail end of an annotation always</p>



<a name="493467978"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493467978" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493467978">(Jan 13 2025 at 22:56)</a>:</h4>
<div class="codehilite"><pre><span></span><code>(
  a = 1
  b = 2
  foo: List a where a implements Foo,
  bar
)
</code></pre></div>



<a name="493468023"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493468023" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493468023">(Jan 13 2025 at 22:56)</a>:</h4>
<p>That's not fully valid syntax, but at the point where we see <code>bar</code>, we don't know that yet</p>



<a name="493468161"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493468161" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493468161">(Jan 13 2025 at 22:57)</a>:</h4>
<p>And in particular we don't know whether we should start parsing <code>bar</code> as a type (to be followed by <code>implements</code> or an expr (i.e. the next element of the tuple).</p>



<a name="493468232"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493468232" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493468232">(Jan 13 2025 at 22:57)</a>:</h4>
<p>Actually I take that back</p>



<a name="493468267"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493468267" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493468267">(Jan 13 2025 at 22:57)</a>:</h4>
<p>So long as we require a final expr in a Defs, this is fine</p>



<a name="493468521"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493468521" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493468521">(Jan 13 2025 at 22:59)</a>:</h4>
<p>That’s interesting, I hope we do</p>



<a name="493468578"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493468578" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493468578">(Jan 13 2025 at 22:59)</a>:</h4>
<p>That feels like an increasingly fragile condition with statements tho</p>



<a name="493468596"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493468596" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493468596">(Jan 13 2025 at 22:59)</a>:</h4>
<p>Yeah</p>



<a name="493468642"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493468642" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493468642">(Jan 13 2025 at 22:59)</a>:</h4>
<p>I would actually like to not require that, syntactically</p>



<a name="493468671"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493468671" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493468671">(Jan 13 2025 at 23:00)</a>:</h4>
<p>(and only validate that in <code>can</code>)</p>



<a name="493468737"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493468737" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493468737">(Jan 13 2025 at 23:00)</a>:</h4>
<p>I think if you have more than a single implements, you must have parens</p>



<a name="493614348"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493614348" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493614348">(Jan 14 2025 at 15:46)</a>:</h4>
<p>Here's that PR to introduce a proper TypeVar type (used in TypeHeader), and mark anything that's not a lowercase ident as Malformed in the AST. (Such things would already generate <code>can</code> errors) <a href="https://github.com/roc-lang/roc/pull/7511">https://github.com/roc-lang/roc/pull/7511</a></p>



<a name="493614903"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493614903" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493614903">(Jan 14 2025 at 15:49)</a>:</h4>
<p>I can review that at lunch</p>



<a name="493683369"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/Crazy%20test_syntax%20snapshots%20and%20their%20value/near/493683369" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/Crazy.20test_syntax.20snapshots.20and.20their.20value.html#493683369">(Jan 14 2025 at 22:41)</a>:</h4>
<p><span class="user-mention" data-user-id="781658">@Anthony Bullard</span> I hit approve... but feel free to also review</p>



<hr><p>Last updated: Mar 01 2026 at 12:20 UTC</p>
</html>