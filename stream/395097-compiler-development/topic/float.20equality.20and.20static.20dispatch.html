<html>
<head><meta charset="utf-8"><title>float equality and static dispatch · compiler development · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/index.html">compiler development</a></h2>
<h3>Topic: <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch.html">float equality and static dispatch</a></h3>

<hr>

<base href="https://roc.zulipchat.com">

<head><link href="https://roc-lang.github.io/zulip-export/style.css" rel="stylesheet"></head>

<a name="527055762"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/float%20equality%20and%20static%20dispatch/near/527055762" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch.html#527055762">(Jul 03 2025 at 18:43)</a>:</h4>
<p>I think we should revisit disallowing <code>==</code> on <code>F32</code> and <code>F64</code> (and therefore pattern matching on them too)</p>



<a name="527055838"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/float%20equality%20and%20static%20dispatch/near/527055838" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch.html#527055838">(Jul 03 2025 at 18:43)</a>:</h4>
<p>main reason is that in the static dispatch world I'm not sure if it's feasible without sacrificing other goals</p>



<a name="527055907"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/float%20equality%20and%20static%20dispatch/near/527055907" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch.html#527055907">(Jul 03 2025 at 18:44)</a>:</h4>
<p>in static dispatch, we need a <code>Num.equals</code> function and that's what <code>a == b</code> will desugar to</p>



<a name="527055927"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/float%20equality%20and%20static%20dispatch/near/527055927" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch.html#527055927">(Jul 03 2025 at 18:44)</a>:</h4>
<p>when <code>a</code> and <code>b</code> have the type <code>Num</code></p>



<a name="527055969"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/float%20equality%20and%20static%20dispatch/near/527055969" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch.html#527055969">(Jul 03 2025 at 18:44)</a>:</h4>
<p>the obvious type for <code>Num.equals</code> is <code>Num(a), Num(a) -&gt; Bool</code></p>



<a name="527056117"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/float%20equality%20and%20static%20dispatch/near/527056117" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch.html#527056117">(Jul 03 2025 at 18:45)</a>:</h4>
<p>if we need to make the type be "not a <code>F32</code> and not a <code>F64</code> but <code>Dec</code> is okay" then we need to make the number type system much more complicated than it is today</p>



<a name="527056153"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/float%20equality%20and%20static%20dispatch/near/527056153" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch.html#527056153">(Jul 03 2025 at 18:45)</a>:</h4>
<p>which I don't think is a cost that's worth the benefit of disallowing equality for floats</p>



<a name="527056310"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/float%20equality%20and%20static%20dispatch/near/527056310" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch.html#527056310">(Jul 03 2025 at 18:46)</a>:</h4>
<p>it would have to be strict bit equality right?</p>



<a name="527056346"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/float%20equality%20and%20static%20dispatch/near/527056346" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch.html#527056346">(Jul 03 2025 at 18:46)</a>:</h4>
<p>I'm setting that aside for now</p>



<a name="527056438"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/float%20equality%20and%20static%20dispatch/near/527056438" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch.html#527056438">(Jul 03 2025 at 18:47)</a>:</h4>
<p>it's more that we'd previously decided to disallow it, partly because it's error-prone and also because of what happens when you try to use infinity, -infinity, and NaN in dictionaries and sets</p>



<a name="527056858"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/float%20equality%20and%20static%20dispatch/near/527056858" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch.html#527056858">(Jul 03 2025 at 18:50)</a>:</h4>
<p>so, one idea would be:</p>
<ul>
<li><code>Num.equals : Num(a), Num(a) -&gt; Bool</code></li>
<li>allow float literals in patterns</li>
<li>if you try to put infinity, -infinity, or NaN into a dictionary or set, we just <code>crash</code></li>
</ul>



<a name="527056868"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/float%20equality%20and%20static%20dispatch/near/527056868" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch.html#527056868">(Jul 03 2025 at 18:50)</a>:</h4>
<p>yeah it's goofy</p>



<a name="527057000"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/float%20equality%20and%20static%20dispatch/near/527057000" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch.html#527057000">(Jul 03 2025 at 18:51)</a>:</h4>
<p>yeah i kinda hate that last bullet point</p>



<a name="527057085"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/float%20equality%20and%20static%20dispatch/near/527057085" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch.html#527057085">(Jul 03 2025 at 18:52)</a>:</h4>
<p>I'm open to suggested alternatives haha</p>



<a name="527057101"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/float%20equality%20and%20static%20dispatch/near/527057101" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch.html#527057101">(Jul 03 2025 at 18:52)</a>:</h4>
<p>can we just have a hard coded prohibition on dicts and sets around prohibiting fp</p>



<a name="527057191"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/float%20equality%20and%20static%20dispatch/near/527057191" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch.html#527057191">(Jul 03 2025 at 18:52)</a>:</h4>
<p>it's the same problem as <code>Num.equals</code></p>



<a name="527057201"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/float%20equality%20and%20static%20dispatch/near/527057201" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch.html#527057201">(Jul 03 2025 at 18:52)</a>:</h4>
<p>I think that's better than handing devs a footgun</p>



<a name="527057204"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/float%20equality%20and%20static%20dispatch/near/527057204" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch.html#527057204">(Jul 03 2025 at 18:52)</a>:</h4>
<p>how do you represent it in the type system?</p>



<a name="527057247"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/float%20equality%20and%20static%20dispatch/near/527057247" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch.html#527057247">(Jul 03 2025 at 18:52)</a>:</h4>
<p><span class="user-mention silent" data-user-id="781658">Anthony Bullard</span> <a href="#narrow/channel/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch/near/527057201">said</a>:</p>
<blockquote>
<p>I think that's better than handing devs a footgun</p>
</blockquote>
<p>that's why we originally disallowed this <span aria-label="smile" class="emoji emoji-1f604" role="img" title="smile">:smile:</span></p>



<a name="527057261"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/float%20equality%20and%20static%20dispatch/near/527057261" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch.html#527057261">(Jul 03 2025 at 18:53)</a>:</h4>
<p>I'm not saying representing it at all.</p>



<a name="527057313"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/float%20equality%20and%20static%20dispatch/near/527057313" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch.html#527057313">(Jul 03 2025 at 18:53)</a>:</h4>
<p>I definitely think it's a smaller footgun with <code>crash</code>  than with it doing what happens by default with nan in dictionaries/sets</p>



<a name="527057324"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/float%20equality%20and%20static%20dispatch/near/527057324" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch.html#527057324">(Jul 03 2025 at 18:53)</a>:</h4>
<p>Just a hard coded "i'm sorry dave..."</p>



<a name="527057351"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/float%20equality%20and%20static%20dispatch/near/527057351" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch.html#527057351">(Jul 03 2025 at 18:53)</a>:</h4>
<p>at compile time?</p>



<a name="527057376"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/float%20equality%20and%20static%20dispatch/near/527057376" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch.html#527057376">(Jul 03 2025 at 18:53)</a>:</h4>
<p>Yes with a clear explanation of why</p>



<a name="527057450"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/float%20equality%20and%20static%20dispatch/near/527057450" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch.html#527057450">(Jul 03 2025 at 18:54)</a>:</h4>
<p>we could do a warning I guess</p>



<a name="527057465"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/float%20equality%20and%20static%20dispatch/near/527057465" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch.html#527057465">(Jul 03 2025 at 18:54)</a>:</h4>
<p>NaNs are relatively easy to create especially through serialization/deserialization</p>



<a name="527057487"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/float%20equality%20and%20static%20dispatch/near/527057487" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch.html#527057487">(Jul 03 2025 at 18:54)</a>:</h4>
<p>error seems weird, like it's a type mismatch but not a type mismatch <span aria-label="sweat smile" class="emoji emoji-1f605" role="img" title="sweat smile">:sweat_smile:</span></p>



<a name="527057501"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/float%20equality%20and%20static%20dispatch/near/527057501" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch.html#527057501">(Jul 03 2025 at 18:54)</a>:</h4>
<p>Infinity not as much</p>



<a name="527057538"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/float%20equality%20and%20static%20dispatch/near/527057538" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch.html#527057538">(Jul 03 2025 at 18:55)</a>:</h4>
<p>i don't think it would be a type mismatch,</p>



<a name="527057592"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/float%20equality%20and%20static%20dispatch/near/527057592" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch.html#527057592">(Jul 03 2025 at 18:55)</a>:</h4>
<p>but at the very least a warning</p>



<a name="527057858"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/float%20equality%20and%20static%20dispatch/near/527057858" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch.html#527057858">(Jul 03 2025 at 18:57)</a>:</h4>
<p>the counterargument (which I do think is reasonable) is that if someone's using floats over the default of <code>Dec</code> in general, it's because their use case needs hardware-accelerated performance more than it needs footgun avoidance, and so even knowing that floats are full of footguns they are making the choice</p>



<a name="527057877"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/float%20equality%20and%20static%20dispatch/near/527057877" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch.html#527057877">(Jul 03 2025 at 18:57)</a>:</h4>
<p>and so blocking them from using floats in these ways is just hurting them and not really helping them</p>



<a name="527058468"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/float%20equality%20and%20static%20dispatch/near/527058468" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch.html#527058468">(Jul 03 2025 at 19:01)</a>:</h4>
<p>under that design philosophy, the purpose of the <code>crash</code> in dictionaries and sets would be the same as <code>crash</code> on integer overflow: if this ever happens, you have 100% for sure entered a broken state, and being loudly broken is better than being silently broken</p>



<a name="527058537"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/float%20equality%20and%20static%20dispatch/near/527058537" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch.html#527058537">(Jul 03 2025 at 19:02)</a>:</h4>
<p>I agree, so maybe a warning is the appropriate thing</p>



<a name="527060621"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/float%20equality%20and%20static%20dispatch/near/527060621" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch.html#527060621">(Jul 03 2025 at 19:20)</a>:</h4>
<p>well warning just means error that doesn't block you from running</p>



<a name="527060696"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/float%20equality%20and%20static%20dispatch/near/527060696" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch.html#527060696">(Jul 03 2025 at 19:20)</a>:</h4>
<p>but warnings return nonzero exit code and they're intended to convey "you should 100% fix this at some point, but your program isn't necessarily going to crash just because you didn't fix it"</p>



<a name="527060705"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/float%20equality%20and%20static%20dispatch/near/527060705" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kiryl Dziamura <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch.html#527060705">(Jul 03 2025 at 19:20)</a>:</h4>
<p>If the assumption is floats are used presumably for performance, why not moving them out from the set of good friendly numbers that lack NaNs, Infinities and variable precision? Yes, it would break generics over usual numbers. But floats seem to be too specific</p>



<a name="527060752"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/float%20equality%20and%20static%20dispatch/near/527060752" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch.html#527060752">(Jul 03 2025 at 19:21)</a>:</h4>
<p>because then you can't have like <code>my_float + my_other_float</code></p>



<a name="527060759"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/float%20equality%20and%20static%20dispatch/near/527060759" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch.html#527060759">(Jul 03 2025 at 19:21)</a>:</h4>
<p>that's not a realistic option <span aria-label="sweat smile" class="emoji emoji-1f605" role="img" title="sweat smile">:sweat_smile:</span></p>



<a name="527060855"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/float%20equality%20and%20static%20dispatch/near/527060855" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch.html#527060855">(Jul 03 2025 at 19:22)</a>:</h4>
<p>a general theme with floats has been me trying to make them less error-prone and then gradually realizing that attempts to make them less error-prone also make them less usable for the thing they're actually good at, which is high-performance fractional math</p>



<a name="527060972"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/float%20equality%20and%20static%20dispatch/near/527060972" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch.html#527060972">(Jul 03 2025 at 19:23)</a>:</h4>
<p>and at this point I'm leaning towards the actual answer being "use <code>Dec</code> if you want reliability, and if you want hardware-accelerated performance and footguns, use <code>F32</code>/<code>F64</code> and be aware that here there be dragons"</p>



<a name="527061023"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/float%20equality%20and%20static%20dispatch/near/527061023" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch.html#527061023">(Jul 03 2025 at 19:23)</a>:</h4>
<p>none of the experiments we've tried to make floats less error-prone have turned out well imo</p>



<a name="527061074"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/float%20equality%20and%20static%20dispatch/near/527061074" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch.html#527061074">(Jul 03 2025 at 19:24)</a>:</h4>
<p>but offering a non-error-prone alternative has been great and is unaffected by what we do with floats</p>



<a name="527061118"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/float%20equality%20and%20static%20dispatch/near/527061118" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kiryl Dziamura <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch.html#527061118">(Jul 03 2025 at 19:24)</a>:</h4>
<blockquote>
<p>because then you can't have like <code>my_float + my_other_float</code>.</p>
</blockquote>
<p>Introduce a sister of <code>Num</code>, <code>FloatNum</code> and call it a day <span aria-label="smile" class="emoji emoji-1f604" role="img" title="smile">:smile:</span></p>



<a name="527061155"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/float%20equality%20and%20static%20dispatch/near/527061155" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch.html#527061155">(Jul 03 2025 at 19:24)</a>:</h4>
<p>that doesn't work</p>



<a name="527061172"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/float%20equality%20and%20static%20dispatch/near/527061172" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch.html#527061172">(Jul 03 2025 at 19:24)</a>:</h4>
<p>We could have Floating point operators</p>



<a name="527061173"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/float%20equality%20and%20static%20dispatch/near/527061173" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch.html#527061173">(Jul 03 2025 at 19:24)</a>:</h4>
<p>numbers all need to have the base type <code>Num</code> and a different type parameter</p>



<a name="527061195"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/float%20equality%20and%20static%20dispatch/near/527061195" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch.html#527061195">(Jul 03 2025 at 19:25)</a>:</h4>
<p>And then they can live on an island</p>



<a name="527061211"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/float%20equality%20and%20static%20dispatch/near/527061211" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch.html#527061211">(Jul 03 2025 at 19:25)</a>:</h4>
<p><span class="user-mention silent" data-user-id="781658">Anthony Bullard</span> <a href="#narrow/channel/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch/near/527061172">said</a>:</p>
<blockquote>
<p>We could have Floating point operators</p>
</blockquote>
<p>yeah people love that about OCaml <span aria-label="joy" class="emoji emoji-1f602" role="img" title="joy">:joy:</span></p>



<a name="527061224"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/float%20equality%20and%20static%20dispatch/near/527061224" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch.html#527061224">(Jul 03 2025 at 19:25)</a>:</h4>
<p>Like .+, .-, etc</p>



<a name="527061253"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/float%20equality%20and%20static%20dispatch/near/527061253" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch.html#527061253">(Jul 03 2025 at 19:25)</a>:</h4>
<p>i'm just exploring the spaxe</p>



<a name="527061262"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/float%20equality%20and%20static%20dispatch/near/527061262" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch.html#527061262">(Jul 03 2025 at 19:25)</a>:</h4>
<p>yeah I hear ya</p>



<a name="527061289"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/float%20equality%20and%20static%20dispatch/near/527061289" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch.html#527061289">(Jul 03 2025 at 19:25)</a>:</h4>
<p>It's clearer what you are getting into</p>



<a name="527061333"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/float%20equality%20and%20static%20dispatch/near/527061333" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch.html#527061333">(Jul 03 2025 at 19:26)</a>:</h4>
<p>There is rational behavior over here, and floats over there</p>



<a name="527061363"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/float%20equality%20and%20static%20dispatch/near/527061363" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch.html#527061363">(Jul 03 2025 at 19:26)</a>:</h4>
<p>yeah, but like another thing I'm kind of tuned into here is that we're all coming at this from a web dev perspective</p>



<a name="527061379"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/float%20equality%20and%20static%20dispatch/near/527061379" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch.html#527061379">(Jul 03 2025 at 19:26)</a>:</h4>
<p>in my language i tried to get around it by only having DEC64 as the number type</p>



<a name="527061427"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/float%20equality%20and%20static%20dispatch/near/527061427" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch.html#527061427">(Jul 03 2025 at 19:27)</a>:</h4>
<p>I'm pretty sure if there were a Roc game dev in here they'd be like "wtf don't do that to me, I have to use floats all the damn time and I don't have a choice about it, why are you trying to make my life harder just bc I'm a game dev"</p>



<a name="527061468"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/float%20equality%20and%20static%20dispatch/near/527061468" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch.html#527061468">(Jul 03 2025 at 19:27)</a>:</h4>
<p>But apparently a lot of people like to shit on DEC64 and i didn't have the time to dig into the specific claims</p>



<a name="527061561"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/float%20equality%20and%20static%20dispatch/near/527061561" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch.html#527061561">(Jul 03 2025 at 19:28)</a>:</h4>
<p>GPU-powered native UI applications are in the same boat; <code>F32</code> is what the GPU wants</p>



<a name="527061600"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/float%20equality%20and%20static%20dispatch/near/527061600" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch.html#527061600">(Jul 03 2025 at 19:28)</a>:</h4>
<p>like probably if you're making a web app, more often than not just using <code>Dec</code> everywhere is the better choice, but Roc is aimed at a broader set of use cases</p>



<a name="527061605"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/float%20equality%20and%20static%20dispatch/near/527061605" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch.html#527061605">(Jul 03 2025 at 19:28)</a>:</h4>
<p><span class="user-mention silent" data-user-id="281383">Richard Feldman</span> <a href="#narrow/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch/near/527061427">said</a>:</p>
<blockquote>
<p>I'm pretty sure if there were a Roc game dev in here they'd be like "wtf don't do that to me, I have to use floats all the damn time and I don't have a choice about it, why are you trying to make my life harder just bc I'm a game dev"</p>
</blockquote>
<p>Roc is going to be high perf, but game dev level performant?  i mean outside of Love2D style?</p>



<a name="527061612"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/float%20equality%20and%20static%20dispatch/near/527061612" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kiryl Dziamura <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch.html#527061612">(Jul 03 2025 at 19:28)</a>:</h4>
<blockquote>
<p>game dev</p>
</blockquote>
<p>yeah, I bet they love equality checks</p>



<a name="527061630"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/float%20equality%20and%20static%20dispatch/near/527061630" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch.html#527061630">(Jul 03 2025 at 19:28)</a>:</h4>
<p><span class="user-mention silent" data-user-id="281383">Richard Feldman</span> <a href="#narrow/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch/near/527061561">said</a>:</p>
<blockquote>
<p>GPU-powered native UI applications are in the same boat; <code>F32</code> is what the GPU wants</p>
</blockquote>
<p>this is the real stickler</p>



<a name="527061680"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/float%20equality%20and%20static%20dispatch/near/527061680" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch.html#527061680">(Jul 03 2025 at 19:29)</a>:</h4>
<p><span class="user-mention silent" data-user-id="781658">Anthony Bullard</span> <a href="#narrow/channel/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch/near/527061605">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="281383">Richard Feldman</span> <a href="#narrow/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch/near/527061427">said</a>:</p>
<blockquote>
<p>I'm pretty sure if there were a Roc game dev in here they'd be like "wtf don't do that to me, I have to use floats all the damn time and I don't have a choice about it, why are you trying to make my life harder just bc I'm a game dev"</p>
</blockquote>
<p>Roc is going to be high perf, but game dev level performant?  i mean outside of Love2D style?</p>
</blockquote>
<p>people make a living on Unity games written in C#, and we should be faster than that</p>



<a name="527061930"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/float%20equality%20and%20static%20dispatch/near/527061930" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kiryl Dziamura <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch.html#527061930">(Jul 03 2025 at 19:31)</a>:</h4>
<p>Ok, floating equality is usually done with a fixed precision value?</p>



<a name="527062223"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/float%20equality%20and%20static%20dispatch/near/527062223" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kiryl Dziamura <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch.html#527062223">(Jul 03 2025 at 19:33)</a>:</h4>
<p>I mean, approximate equality, right? Also, warnings per equality check?</p>



<a name="527062494"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/float%20equality%20and%20static%20dispatch/near/527062494" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch.html#527062494">(Jul 03 2025 at 19:36)</a>:</h4>
<p>in most languages with floats, equality compiles down to the CPU instructions for float equality, which has these semantics (as defined by the <a href="https://en.wikipedia.org/wiki/IEEE_754">IEEE-754 hardware standard</a>):</p>
<ul>
<li><code>-0</code> and <code>0</code> are considered equal</li>
<li><code>NaN</code> is considered unequal to everything</li>
<li>everything else works the same way normal integer equality works</li>
</ul>



<a name="527062514"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/float%20equality%20and%20static%20dispatch/near/527062514" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kiryl Dziamura <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch.html#527062514">(Jul 03 2025 at 19:36)</a>:</h4>
<p>And in the warnings you would see "it's an approximate equality with x tolerance. If you want bit eq, use this, if you want different tolerance so that"</p>



<a name="527062536"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/float%20equality%20and%20static%20dispatch/near/527062536" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch.html#527062536">(Jul 03 2025 at 19:36)</a>:</h4>
<p>I shouldn't have said "warning" earlier - let's just say "compiler error"</p>



<a name="527062702"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/float%20equality%20and%20static%20dispatch/near/527062702" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch.html#527062702">(Jul 03 2025 at 19:37)</a>:</h4>
<p>if we give a warning, or special compiler error, for using floats with equals, to me this is basically equivalent to changing how number types work without actually making the change, except much hackier</p>



<a name="527062704"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/float%20equality%20and%20static%20dispatch/near/527062704" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch.html#527062704">(Jul 03 2025 at 19:37)</a>:</h4>
<p>I don't think we should do it</p>



<a name="527062774"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/float%20equality%20and%20static%20dispatch/near/527062774" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch.html#527062774">(Jul 03 2025 at 19:38)</a>:</h4>
<p>I think a reasonable comparison is with integer addition</p>



<a name="527062805"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/float%20equality%20and%20static%20dispatch/near/527062805" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch.html#527062805">(Jul 03 2025 at 19:39)</a>:</h4>
<p>we don't warn you at compile-time if you do <code>a + b</code> even though that can be a runtime crash if it overflows</p>



<a name="527062860"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/float%20equality%20and%20static%20dispatch/near/527062860" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch.html#527062860">(Jul 03 2025 at 19:39)</a>:</h4>
<p>like we could say "you should consider using checked addition so you can handle overflow errors properly, or saturating addition if it's ok to round off to the nearest high number"</p>



<a name="527062872"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/float%20equality%20and%20static%20dispatch/near/527062872" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch.html#527062872">(Jul 03 2025 at 19:39)</a>:</h4>
<p>and force you to do that everywhere</p>



<a name="527062927"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/float%20equality%20and%20static%20dispatch/near/527062927" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch.html#527062927">(Jul 03 2025 at 19:40)</a>:</h4>
<p>but we who are not doing game dev or native GUI development in Roc know that this would be super annoying and make us not want to use the language, much more so than the errors it would prevent</p>



<a name="527062951"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/float%20equality%20and%20static%20dispatch/near/527062951" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch.html#527062951">(Jul 03 2025 at 19:40)</a>:</h4>
<p>so we wouldn't support that change</p>



<a name="527062998"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/float%20equality%20and%20static%20dispatch/near/527062998" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch.html#527062998">(Jul 03 2025 at 19:40)</a>:</h4>
<p>and I don't think we'd support errors for floats either if we were forced by our use case to use them all over our code base</p>



<a name="527064795"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/float%20equality%20and%20static%20dispatch/near/527064795" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kiryl Dziamura <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch.html#527064795">(Jul 03 2025 at 19:56)</a>:</h4>
<p>I see. My take is that it's annoying searching for the place where two floats were compared if there was a bug. Especially in case of generic functions. But I lived like that and haven't died yet</p>



<a name="527066269"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/float%20equality%20and%20static%20dispatch/near/527066269" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kiryl Dziamura <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch.html#527066269">(Jul 03 2025 at 20:08)</a>:</h4>
<p>If we give a footgun, I think it makes sense to provide a pair of decent shoes. A linter? Does roc already have a debug assertion function?</p>



<a name="527073696"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/float%20equality%20and%20static%20dispatch/near/527073696" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch.html#527073696">(Jul 03 2025 at 21:14)</a>:</h4>
<p><code>expect</code> is basically Rust's <code>debug_assert!</code></p>



<a name="527073728"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/float%20equality%20and%20static%20dispatch/near/527073728" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch.html#527073728">(Jul 03 2025 at 21:14)</a>:</h4>
<p>I definitely would like to never have a linter in Roc</p>



<a name="527073754"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/float%20equality%20and%20static%20dispatch/near/527073754" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch.html#527073754">(Jul 03 2025 at 21:15)</a>:</h4>
<p>at least not the traditional kind that looks for generic "issues"</p>



<a name="527073813"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/float%20equality%20and%20static%20dispatch/near/527073813" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch.html#527073813">(Jul 03 2025 at 21:15)</a>:</h4>
<p>as opposed to project-specific ones where the end user sets rules like "hey we're trying to move away from Foo, so no new uses of it allowed!"</p>



<a name="527074632"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/float%20equality%20and%20static%20dispatch/near/527074632" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kiryl Dziamura <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch.html#527074632">(Jul 03 2025 at 21:22)</a>:</h4>
<p>Once the roc parser is in the wild, community driven linters will be a matter of time.<br>
But speaking of linter, I mean more clippy than eslint</p>



<a name="527078113"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/float%20equality%20and%20static%20dispatch/near/527078113" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kiryl Dziamura <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch.html#527078113">(Jul 03 2025 at 21:52)</a>:</h4>
<p>I understand the sentiment that linters have slipped into style checkers. As a result you have purism in the name of democracy (yes, oxymoron) and part of the team go with "whatever" and the other hate unreasonable rule they regularly face that mostly hinders development.</p>
<p>But the roc linter can concentrate on heuristics of correctness and not style. So it might be a tool, not constitution.</p>



<a name="527081452"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/float%20equality%20and%20static%20dispatch/near/527081452" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch.html#527081452">(Jul 03 2025 at 22:27)</a>:</h4>
<p><span class="user-mention silent" data-user-id="281383">Richard Feldman</span> <a href="#narrow/channel/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch/near/527060752">said</a>:</p>
<blockquote>
<p>because then you can't have like <code>my_float + my_other_float</code></p>
</blockquote>
<p>Can you explain this more? I thought with static dispatch as long as they had <code>add : F32, F32 -&gt; F32</code> then it would be ok to use <code>+</code></p>



<a name="527081528"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/float%20equality%20and%20static%20dispatch/near/527081528" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch.html#527081528">(Jul 03 2025 at 22:29)</a>:</h4>
<p><span class="user-mention silent" data-user-id="781658">Anthony Bullard</span> <a href="#narrow/channel/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch/near/527061195">said</a>:</p>
<blockquote>
<p>And then they can live on an island</p>
</blockquote>
<p>Is this because they're floating... thanks Dad <span aria-label="wink" class="emoji emoji-1f609" role="img" title="wink">:wink:</span></p>



<a name="527081664"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/float%20equality%20and%20static%20dispatch/near/527081664" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch.html#527081664">(Jul 03 2025 at 22:30)</a>:</h4>
<p><span class="user-mention silent" data-user-id="281383">Richard Feldman</span> <a href="#narrow/channel/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch/near/527060972">said</a>:</p>
<blockquote>
<p>and at this point I'm leaning towards the actual answer being "use <code>Dec</code> if you want reliability, and if you want hardware-accelerated performance and footguns, use <code>F32</code>/<code>F64</code> and be aware that here there be dragons"</p>
</blockquote>
<p>I think this is a very reasonable approach. </p>
<p>The "there be dragons" part is something we can also help with a lot more than in every other language where I assume these also exist.</p>



<a name="527082045"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/float%20equality%20and%20static%20dispatch/near/527082045" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch.html#527082045">(Jul 03 2025 at 22:34)</a>:</h4>
<p>I'm not sure about the "help a lot more than" -- because we're talking about runtime issues.</p>



<a name="527084712"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/float%20equality%20and%20static%20dispatch/near/527084712" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kiryl Dziamura <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch.html#527084712">(Jul 03 2025 at 23:06)</a>:</h4>
<p>I only hope that dragons won't be implicit</p>



<a name="527089981"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/float%20equality%20and%20static%20dispatch/near/527089981" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch.html#527089981">(Jul 04 2025 at 00:25)</a>:</h4>
<p><span class="user-mention silent" data-user-id="515757">Luke Boswell</span> <a href="#narrow/channel/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch/near/527081452">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="281383">Richard Feldman</span> <a href="#narrow/channel/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch/near/527060752">said</a>:</p>
<blockquote>
<p>because then you can't have like <code>my_float + my_other_float</code></p>
</blockquote>
<p>Can you explain this more? I thought with static dispatch as long as they had <code>add : F32, F32 -&gt; F32</code> then it would be ok to use <code>+</code></p>
</blockquote>
<p>oh you're right, sorry - that particular example would work, but you couldn't have (for example) the number literal <code>4.2</code> going from <code>Frac(a)</code> to <code>F32</code> anymore (or else you couldn't have it for <code>Dec</code> either)</p>



<a name="527090008"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/float%20equality%20and%20static%20dispatch/near/527090008" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch.html#527090008">(Jul 04 2025 at 00:26)</a>:</h4>
<p>number literals rely on all of the number literals having the same nominal type - <code>Num</code> - and then only the type variables change when you use them in more specific ways</p>



<a name="527090082"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/float%20equality%20and%20static%20dispatch/near/527090082" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch.html#527090082">(Jul 04 2025 at 00:27)</a>:</h4>
<p>The idea of pulling <code>F32</code> and <code>F64</code> out from <code>Num</code> is an option right? They're still in the stdlib and available for use if you need performance, but you know they're not the safe default options.</p>



<a name="527090165"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/float%20equality%20and%20static%20dispatch/near/527090165" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch.html#527090165">(Jul 04 2025 at 00:29)</a>:</h4>
<p>We could still have special handling support for them like <code>43.0f64</code></p>



<a name="527091203"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/float%20equality%20and%20static%20dispatch/near/527091203" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch.html#527091203">(Jul 04 2025 at 00:47)</a>:</h4>
<p>we could, yes, and then Roc will never be a C# competitor for game dev <span aria-label="joy" class="emoji emoji-1f602" role="img" title="joy">:joy:</span></p>



<a name="527091238"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/float%20equality%20and%20static%20dispatch/near/527091238" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch.html#527091238">(Jul 04 2025 at 00:48)</a>:</h4>
<p>or a JS competitor for cross-platorm native GUIs etc.</p>



<a name="527091304"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/float%20equality%20and%20static%20dispatch/near/527091304" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch.html#527091304">(Jul 04 2025 at 00:49)</a>:</h4>
<p>I think a big part of the problem here is that when I was originally thinking about it, I was thinking about it as if people are going to use floats for performance in just like one hotspot in a large code base that really needs a little extra juice</p>



<a name="527091315"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/float%20equality%20and%20static%20dispatch/near/527091315" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch.html#527091315">(Jul 04 2025 at 00:49)</a>:</h4>
<p>but I don't think that's right</p>



<a name="527091336"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/float%20equality%20and%20static%20dispatch/near/527091336" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch.html#527091336">(Jul 04 2025 at 00:50)</a>:</h4>
<p>I think it's actually more like "my whole use case is floats, and if Roc's ergonomics around floats are terrible then I just will not use it for my use case"</p>



<a name="527091389"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/float%20equality%20and%20static%20dispatch/near/527091389" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch.html#527091389">(Jul 04 2025 at 00:50)</a>:</h4>
<p>so I think a better mindset is like "make it really really ridiculously easy to not use floats if you don't have to, but if you <em>do</em> have to, make the experience as nice as possible"</p>



<a name="527091424"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/float%20equality%20and%20static%20dispatch/near/527091424" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch.html#527091424">(Jul 04 2025 at 00:51)</a>:</h4>
<p>Maybe this is a silly question.. but why are they more ergonomic in Num? Is it not casting between number types, like when adding an integer or similar?</p>



<a name="527091437"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/float%20equality%20and%20static%20dispatch/near/527091437" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch.html#527091437">(Jul 04 2025 at 00:51)</a>:</h4>
<p>which I do think includes crashing when a <code>NaN</code> would get inserted into a set or dict, instead of making the set or dict start quietly behaving in ludicrous ways</p>



<a name="527091497"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/float%20equality%20and%20static%20dispatch/near/527091497" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch.html#527091497">(Jul 04 2025 at 00:52)</a>:</h4>
<p>so like if I want to write the number <code>4.2</code>, just like that, and be able to use that exact syntax for an argument to a function that accepts a <code>Dec</code> and also a function that accepts a <code>F32</code>, then either they both need to be a <code>Num</code> nominal type (with different type parameters) or else we need a fancier type system just for numbers</p>



<a name="527091889"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/float%20equality%20and%20static%20dispatch/near/527091889" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch.html#527091889">(Jul 04 2025 at 00:59)</a>:</h4>
<p>Ah ofc. I forgot about the polymorphic type things.</p>



<a name="527091906"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/float%20equality%20and%20static%20dispatch/near/527091906" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dan G Knutson <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch.html#527091906">(Jul 04 2025 at 00:59)</a>:</h4>
<p>I'm only a newish, hobbyist game dev, but my impression is games people would generally also not want exact float equality. For example, the implementation of Vec3 equals in Unity has an epsilon range</p>



<a name="527092093"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/float%20equality%20and%20static%20dispatch/near/527092093" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dan G Knutson <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch.html#527092093">(Jul 04 2025 at 01:02)</a>:</h4>
<p>IIRC there was some prominent bug in Minecraft related to using float equality instead of a &lt;= guard. Which is the kind of thing where the consequence is youtuber lore instead of someone losing money, but game devs get got by floats too</p>



<a name="527092779"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/float%20equality%20and%20static%20dispatch/near/527092779" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch.html#527092779">(Jul 04 2025 at 01:12)</a>:</h4>
<p>yeah the problem is I've heard it's like "sometimes you actually do want it and other times you want to avoid it"</p>



<a name="527093759"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/float%20equality%20and%20static%20dispatch/near/527093759" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch.html#527093759">(Jul 04 2025 at 01:26)</a>:</h4>
<p><span class="user-mention silent" data-user-id="281383">Richard Feldman</span> <a href="#narrow/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch/near/527061173">said</a>:</p>
<blockquote>
<p>numbers all need to have the base type <code>Num</code> and a different type parameter</p>
</blockquote>
<p>Given anything can implement plus and such in the new compiler, is this still strictly needed?</p>



<a name="527093839"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/float%20equality%20and%20static%20dispatch/near/527093839" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch.html#527093839">(Jul 04 2025 at 01:28)</a>:</h4>
<p><span class="user-mention silent" data-user-id="281383">Richard Feldman</span> <a href="#narrow/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch/near/527061561">said</a>:</p>
<blockquote>
<p>GPU-powered native UI applications are in the same boat; <code>F32</code> is what the GPU wants</p>
</blockquote>
<p>Actually gpus really prefer bf16, tf32, or fp8. Fp32 is pretty outdated on gpus nowadays.</p>



<a name="527094041"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/float%20equality%20and%20static%20dispatch/near/527094041" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch.html#527094041">(Jul 04 2025 at 01:30)</a>:</h4>
<p><span class="user-mention silent" data-user-id="281383">Richard Feldman</span> <a href="#narrow/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch/near/527091437">said</a>:</p>
<blockquote>
<p>which I do think includes crashing when a <code>NaN</code> would get inserted into a set or dict, instead of making the set or dict start quietly behaving in ludicrous ways</p>
</blockquote>
<p>Honestly, if we are specially casing flaots anyway to do this, just ban hashing floats in general. I don't think there is a generic way in roc for a dictionary to check for this. So it has to be special cased.</p>



<a name="527094182"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/float%20equality%20and%20static%20dispatch/near/527094182" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch.html#527094182">(Jul 04 2025 at 01:32)</a>:</h4>
<p><span class="user-mention silent" data-user-id="281383">Richard Feldman</span> <a href="#narrow/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch/near/527092779">said</a>:</p>
<blockquote>
<p>yeah the problem is I've heard it's like "sometimes you actually do want it and other times you want to avoid it"</p>
</blockquote>
<p>I think it is 99% of the time you don't want it, but some hyper optimized code has uses.</p>



<a name="527102884"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/float%20equality%20and%20static%20dispatch/near/527102884" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch.html#527102884">(Jul 04 2025 at 04:00)</a>:</h4>
<p>banning floats from having hashing has the same problems as banning them from having equals</p>



<a name="527103711"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/float%20equality%20and%20static%20dispatch/near/527103711" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch.html#527103711">(Jul 04 2025 at 04:12)</a>:</h4>
<p>like basically if we want to have floats still be able to work with number literals but not support equals or hash, we have to change the Num hierarchy to something like this:</p>
<div class="codehilite" data-code-language="Haskell"><pre><span></span><code><span class="kt">F32</span><span class="w"> </span><span class="kt">:</span><span class="w"> </span><span class="kt">Num</span><span class="p">({</span>
<span class="w">    </span><span class="n">size</span><span class="w"> </span><span class="kt">:</span><span class="w"> </span><span class="kt">Fraction</span><span class="p">(</span><span class="kt">Binary32</span><span class="p">),</span>
<span class="w">    </span><span class="n">has_nan</span><span class="w"> </span><span class="kt">:</span><span class="w"> </span><span class="p">[</span><span class="kt">Yes</span><span class="p">]</span>
<span class="p">})</span>

<span class="kt">F32</span><span class="w"> </span><span class="kt">:</span><span class="w"> </span><span class="kt">Dec</span><span class="p">({</span>
<span class="w">    </span><span class="n">size</span><span class="w"> </span><span class="kt">:</span><span class="w"> </span><span class="kt">Fraction</span><span class="p">(</span><span class="kt">Binary32</span><span class="p">),</span>
<span class="w">    </span><span class="n">has_nan</span><span class="w"> </span><span class="kt">:</span><span class="w"> </span><span class="p">[</span><span class="kt">No</span><span class="p">]</span>
<span class="p">})</span>

<span class="kt">U64</span><span class="w"> </span><span class="kt">:</span><span class="w"> </span><span class="kt">Num</span><span class="p">({</span>
<span class="w">    </span><span class="n">size</span><span class="w"> </span><span class="kt">:</span><span class="w"> </span><span class="kt">Integer</span><span class="p">(</span><span class="kt">Unsigned64</span><span class="p">),</span>
<span class="w">    </span><span class="n">has_nan</span><span class="w"> </span><span class="kt">:</span><span class="w"> </span><span class="p">[</span><span class="kt">No</span><span class="p">]</span>
<span class="p">})</span>

<span class="kt">Num</span><span class="o">.</span><span class="n">equals</span><span class="w"> </span><span class="kt">:</span>
<span class="w">    </span><span class="kt">Num</span><span class="p">({</span><span class="w"> </span><span class="n">size</span><span class="p">,</span><span class="w"> </span><span class="n">has_nan</span><span class="w"> </span><span class="kt">:</span><span class="w"> </span><span class="p">[</span><span class="kt">No</span><span class="p">]</span><span class="w"> </span><span class="p">}),</span>
<span class="w">    </span><span class="kt">Num</span><span class="p">({</span><span class="w"> </span><span class="n">size</span><span class="p">,</span><span class="w"> </span><span class="n">has_nan</span><span class="w"> </span><span class="kt">:</span><span class="w"> </span><span class="p">[</span><span class="kt">No</span><span class="p">]</span><span class="w"> </span><span class="p">})</span>
<span class="w">    </span><span class="ow">-&gt;</span><span class="w"> </span><span class="kt">Bool</span>

<span class="kt">Frac</span><span class="p">(</span><span class="n">size</span><span class="p">,</span><span class="w"> </span><span class="n">has_nan</span><span class="p">)</span><span class="w"> </span><span class="kt">:</span><span class="w"> </span><span class="kt">Num</span><span class="p">({</span>
<span class="w">    </span><span class="n">size</span><span class="w"> </span><span class="kt">:</span><span class="w"> </span><span class="kt">Fraction</span><span class="p">(</span><span class="n">size</span><span class="p">),</span>
<span class="w">    </span><span class="n">has_nan</span><span class="p">,</span>
<span class="p">})</span>

<span class="kt">Num</span><span class="o">.</span><span class="n">div</span><span class="w"> </span><span class="kt">:</span>
<span class="w">    </span><span class="kt">Frac</span><span class="p">(</span><span class="n">size</span><span class="p">,</span><span class="w"> </span><span class="n">has_nan</span><span class="p">),</span>
<span class="w">    </span><span class="kt">Frac</span><span class="p">(</span><span class="n">size</span><span class="p">,</span><span class="w"> </span><span class="n">has_nan</span><span class="p">)</span>
<span class="w">    </span><span class="ow">-&gt;</span><span class="w"> </span><span class="kt">Frac</span><span class="p">(</span><span class="n">size</span><span class="p">,</span><span class="w"> </span><span class="n">has_nan</span><span class="p">)</span>
</code></pre></div>



<a name="527103881"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/float%20equality%20and%20static%20dispatch/near/527103881" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch.html#527103881">(Jul 04 2025 at 04:14)</a>:</h4>
<p>so the type complexity and learning curve for all numbers goes up, compile times get some amount worse because we have this extra stuff to check, and the payoff is that we have disallowed direct float equality in favor of having to do the <code>(x &gt;= y and x &lt;= y)</code> trick</p>



<a name="527105499"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/float%20equality%20and%20static%20dispatch/near/527105499" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch.html#527105499">(Jul 04 2025 at 04:37)</a>:</h4>
<p>How would a dict crash when used with floats?</p>



<a name="527105505"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/float%20equality%20and%20static%20dispatch/near/527105505" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch.html#527105505">(Jul 04 2025 at 04:38)</a>:</h4>
<p>I think it has to be some sort of special cases mechanism</p>



<a name="527105520"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/float%20equality%20and%20static%20dispatch/near/527105520" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch.html#527105520">(Jul 04 2025 at 04:38)</a>:</h4>
<p>I think we should just special cases this</p>



<a name="527105551"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/float%20equality%20and%20static%20dispatch/near/527105551" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch.html#527105551">(Jul 04 2025 at 04:38)</a>:</h4>
<p>Simply and am extra of condiction that if a hash resolves to a float create a compilation failure</p>



<a name="527105556"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/float%20equality%20and%20static%20dispatch/near/527105556" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch.html#527105556">(Jul 04 2025 at 04:38)</a>:</h4>
<p>Like have it just happen after resolution</p>



<a name="527105576"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/float%20equality%20and%20static%20dispatch/near/527105576" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch.html#527105576">(Jul 04 2025 at 04:39)</a>:</h4>
<p>That or have it crash at runtime (but compile time error is a better experience)</p>



<a name="527105615"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/float%20equality%20and%20static%20dispatch/near/527105615" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch.html#527105615">(Jul 04 2025 at 04:39)</a>:</h4>
<p>Like I think should just not represent it in the type system at all. Totally a special case</p>



<a name="527183272"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/float%20equality%20and%20static%20dispatch/near/527183272" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch.html#527183272">(Jul 04 2025 at 13:39)</a>:</h4>
<p>this is interesting: <a href="https://internals.rust-lang.org/t/f32-f64-should-implement-hash/5436/4">https://internals.rust-lang.org/t/f32-f64-should-implement-hash/5436/4</a></p>



<a name="527187585"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/float%20equality%20and%20static%20dispatch/near/527187585" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch.html#527187585">(Jul 04 2025 at 14:04)</a>:</h4>
<p>Yeah, reading some of that thread reinforces my opinion. We should just generate a custom compile time error if someone calls <code>.hash</code> on a float.</p>
<p>If a user wants float hashing, they should wrap the float in a custom type. The best part of this is that the special type also, can implement all the math functions and be nice enough to use.</p>



<a name="527188260"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/float%20equality%20and%20static%20dispatch/near/527188260" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch.html#527188260">(Jul 04 2025 at 14:08)</a>:</h4>
<p>And I think this is an odd enough edge cases that it is worth making a special error for after type resolution. I don't think it is worth truly representing in the type system.</p>



<a name="527188921"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/float%20equality%20and%20static%20dispatch/near/527188921" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch.html#527188921">(Jul 04 2025 at 14:11)</a>:</h4>
<p>Also, I guess if num was a more standard type instead of a magically dynamic type, this could be dealt with in pure roc by calling <code>Num.hash</code>, which would unwrap the outer type and then call <code>Frac.hash</code>, which would unwrap and call <code>F64.hash</code>, would either call <code>crash</code> or a new <code>compileTimeError</code> builtin. Frankly, you could just leave it as a header with no definition and that would technically work as a compile time error.</p>



<a name="527189205"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/float%20equality%20and%20static%20dispatch/near/527189205" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch.html#527189205">(Jul 04 2025 at 14:13)</a>:</h4>
<p>But I don't think num has true unwrapping of the outer type. Instead, it magically works for different multiple types.</p>



<a name="527208108"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/float%20equality%20and%20static%20dispatch/near/527208108" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch.html#527208108">(Jul 04 2025 at 16:27)</a>:</h4>
<p><span class="user-mention silent" data-user-id="343810">Brendan Hansknecht</span> <a href="#narrow/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch/near/527187585">said</a>:</p>
<blockquote>
<p>Yeah, reading some of that thread reinforces my opinion. We should just generate a custom compile time error if someone calls <code>.hash</code> on a float.</p>
</blockquote>
<p>I'm on mobile and don't have a quick explaination, but in general I don't think we should do this</p>



<a name="527208280"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/float%20equality%20and%20static%20dispatch/near/527208280" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch.html#527208280">(Jul 04 2025 at 16:28)</a>:</h4>
<p>this is basically saying "we should introduce the concept of secret type mismatches that aren't represented in the type system so you can no longer ever tell from looking at two types whether they're going to have a mismatch"</p>



<a name="527208499"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/float%20equality%20and%20static%20dispatch/near/527208499" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch.html#527208499">(Jul 04 2025 at 16:29)</a>:</h4>
<p>it means things like a package can publish a new version with identical type signatures, as a patch release, and now it breaks your builds because it secretly started using hashing somewhere deep behind the scenes and you were passing it a float</p>



<a name="527208600"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/float%20equality%20and%20static%20dispatch/near/527208600" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch.html#527208600">(Jul 04 2025 at 16:29)</a>:</h4>
<p>Take a look at <a class="stream-topic" data-stream-id="304641" href="/#narrow/channel/304641-ideas/topic/Do.20we.20need.20Num.20anymore.3F/with/527191038">#ideas &gt; Do we need Num anymore?</a> I think we may be able to do this more properly.</p>



<a name="527208614"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/float%20equality%20and%20static%20dispatch/near/527208614" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/float.20equality.20and.20static.20dispatch.html#527208614">(Jul 04 2025 at 16:29)</a>:</h4>
<p>if passing a particular type to a function can cause a type mismatch, that needs to be reflected in the type.</p>



<hr><p>Last updated: Mar 01 2026 at 12:20 UTC</p>
</html>