<html>
<head><meta charset="utf-8"><title>zig compiler - indent handling · compiler development · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/index.html">compiler development</a></h2>
<h3>Topic: <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html">zig compiler - indent handling</a></h3>

<hr>

<base href="https://roc.zulipchat.com">

<head><link href="https://roc-lang.github.io/zulip-export/style.css" rel="stylesheet"></head>

<a name="497284463"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497284463" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497284463">(Feb 02 2025 at 19:38)</a>:</h4>
<p>Wanted to pop this github thread out to zulip: <a href="https://github.com/roc-lang/roc/pull/7569#discussion_r1938529685">https://github.com/roc-lang/roc/pull/7569#discussion_r1938529685</a><br>
<span class="user-mention" data-user-id="781658">@Anthony Bullard</span> / <span class="user-mention" data-user-id="343810">@Brendan Hansknecht</span></p>
<p>The approach used in the current tokenizer PR is to preserve exact indent info and let the parser use that however it wants to figure out nesting.</p>
<p>The more-commonly-used alternative (e.g. in Python) would be to generate indent and dedent tokens. I believe this approach is viable for the current roc grammar, but it does force us to be a little bit more picky about indentation. When developing the parser that went along with this tokenizer, I found that trying to use only indent/dedent tokens resulted in very picky indentation that I found frustrating to get working.</p>
<p>Thoughts?</p>



<a name="497284661"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497284661" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497284661">(Feb 02 2025 at 19:41)</a>:</h4>
<p>I like it being more permissive - fits with the goal of having it be more error-tolerant</p>



<a name="497284764"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497284764" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497284764">(Feb 02 2025 at 19:42)</a>:</h4>
<p>so yeah, sounds like indent/dedent tokens aren't the way to go</p>



<a name="497284799"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497284799" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497284799">(Feb 02 2025 at 19:42)</a>:</h4>
<p>I have no thoughts besides making sure we document what we chose and why. I was just surprised that we are only counting spaces or tabs, that didn't feel like enough (but I don't work on the parser).</p>



<a name="497285023"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497285023" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497285023">(Feb 02 2025 at 19:45)</a>:</h4>
<p>We're counting both spaces and tabs in the current PR (keeping the counts separate). That's just enough information to be agnostic to whatever the editor configuration for tab indent width is, and still parse correctly.</p>



<a name="497285106"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497285106" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497285106">(Feb 02 2025 at 19:46)</a>:</h4>
<p>But like is <code>space space tab space</code> the same as <code>tab space space space</code>?</p>



<a name="497285125"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497285125" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497285125">(Feb 02 2025 at 19:46)</a>:</h4>
<p>Technically, if we wanted to be very particular, we could record the exact indent string that's used. that would let us catch cases where the first line uses spaces then tabs and the second line uses tabs and spaces. However, it doesn't feel important to me to reject that case in particular.</p>



<a name="497285128"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497285128" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497285128">(Feb 02 2025 at 19:47)</a>:</h4>
<p>Ha ha yeah exactly</p>



<a name="497285154"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497285154" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497285154">(Feb 02 2025 at 19:47)</a>:</h4>
<p>It is not perfectly the same, but would lead to the same indent, given typical editor configurations.</p>



<a name="497285166"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497285166" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497285166">(Feb 02 2025 at 19:47)</a>:</h4>
<p>A user might be forgiven for mistaking those as the same</p>



<a name="497285255"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497285255" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497285255">(Feb 02 2025 at 19:48)</a>:</h4>
<p>I guess it would depend on how many spaces a tab is for how it appears in a given editor and if it looks like the same indent level or not.</p>



<a name="497285766"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497285766" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497285766">(Feb 02 2025 at 19:55)</a>:</h4>
<p>Yeah, if an editor is using tabs to align to e.g. 8 char intervals, then those aren't identical.</p>



<a name="497285862"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497285862" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497285862">(Feb 02 2025 at 19:56)</a>:</h4>
<p>Yeah, but I guess I don't know what roc is supposed to do with that. So just counting tabs and spaces is probably fine.</p>



<a name="497285877"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497285877" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497285877">(Feb 02 2025 at 19:56)</a>:</h4>
<p>By that you mean tabs+spaces?</p>



<a name="497285885"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497285885" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497285885">(Feb 02 2025 at 19:56)</a>:</h4>
<p>(as a single number)</p>



<a name="497285892"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497285892" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497285892">(Feb 02 2025 at 19:56)</a>:</h4>
<p><span class="user-mention silent" data-user-id="453336">Joshua Warner</span> <a href="#narrow/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling/near/497285154">said</a>:</p>
<blockquote>
<p>It is not perfectly the same, but would lead to the same indent, given typical editor configurations.</p>
</blockquote>
<p>hm is that true? I think that's only true if the editor is replacing tabs with some fixed number of spaces, as opposed to doing tab stops</p>



<a name="497285920"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497285920" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497285920">(Feb 02 2025 at 19:57)</a>:</h4>
<p>Err yeah for that example you're right</p>



<a name="497286030"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497286030" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497286030">(Feb 02 2025 at 19:59)</a>:</h4>
<blockquote>
<p>By that you mean tabs+spaces?<br>
(as a single number)</p>
</blockquote>
<p>No, sorry, I meant doing what you are currently during in the PR with two different counts. That sounds reasonable cause we don't know what the users tab width is. So we can't really do better.</p>
<p>There is a chance that <code>space space space tab</code> is 2 indents in the users editor (tab rounds to 2 spaces). As such they see <code>space space tab space</code> as 2.5 indents and maybe accidentally use it as 3 indents, but I'm not sure how roc would derive any of that info.</p>



<a name="497286135"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497286135" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497286135">(Feb 02 2025 at 20:00)</a>:</h4>
<p>For any case where you have a sequence of: <code>((tab|space{n})*space*)</code> (forgive my relaxed, regular expressions syntax), keeping the count of tabs and count of spaces is sufficient to infer the correct indent level, regardless of if the user has an improper tabs versus spaces setting.</p>



<a name="497286386"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497286386" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497286386">(Feb 02 2025 at 20:03)</a>:</h4>
<p>The conservative alternative here is going back to what the current parser does - only allows spaces. That avoids all of these problems.</p>



<a name="497286487"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497286487" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497286487">(Feb 02 2025 at 20:04)</a>:</h4>
<p>The expressive alternative is to track the exact order of tabs and spaces and only allow indents that have the previous line's indent string as a prefix</p>



<a name="497286536"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497286536" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497286536">(Feb 02 2025 at 20:05)</a>:</h4>
<p>I think any other alternative here necessarily involves tracking the count of spaces and tabs. Given that, for example, we could give an error if the user is not consistently using either tabs or spaces with no mixing.</p>



<a name="497286630"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497286630" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497286630">(Feb 02 2025 at 20:06)</a>:</h4>
<p>Just out of curiosity, what do we do if one line is all spaces and the next is all tabs (this accidentally happens to me sometimes when I edit a file before saving it as a <code>.roc</code> file). I think the editor defaults to tabs, but my roc config and roc in general uses spaces. So sometimes have one line with 4 spaces and then the next with 2 tabs. Really irks me to fix this and last time I checked, the formatter fails to do so.</p>



<a name="497286667"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497286667" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497286667">(Feb 02 2025 at 20:07)</a>:</h4>
<p>fwiw I'd like to report a warning for using anything other than tabs for indentation</p>



<a name="497286694"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497286694" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497286694">(Feb 02 2025 at 20:07)</a>:</h4>
<p>so all of this is just for trying to recover if the user makes a mistake</p>



<a name="497286745"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497286745" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497286745">(Feb 02 2025 at 20:08)</a>:</h4>
<p>(including having the formatter translate all of these things into the appropriate number of tabs for you)</p>



<a name="497286893"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497286893" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497286893">(Feb 02 2025 at 20:10)</a>:</h4>
<blockquote>
<p>what do we do if one line is all spaces and the next is all tabs</p>
</blockquote>
<p>The parser would report an error, since we can't disambiguate that.</p>



<a name="497286930"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497286930" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497286930">(Feb 02 2025 at 20:11)</a>:</h4>
<p><span aria-label="cry" class="emoji emoji-1f622" role="img" title="cry">:cry:</span></p>



<a name="497287028"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497287028" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497287028">(Feb 02 2025 at 20:12)</a>:</h4>
<p>Are we switching to tabs? There was a lot of enthusiasm for using tabs for indentation <span aria-label="grinning" class="emoji emoji-1f600" role="img" title="grinning">:grinning:</span></p>



<a name="497287097"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497287097" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497287097">(Feb 02 2025 at 20:13)</a>:</h4>
<p>FWIW this scheme comes directly from python</p>



<a name="497287208"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497287208" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497287208">(Feb 02 2025 at 20:15)</a>:</h4>
<p>I think it is probably a totally reasonable scheme. It just doesn't solve my essentially only issue with tabs/spaces that I currently hit (though still pretty rare).</p>



<a name="497288096"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497288096" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497288096">(Feb 02 2025 at 20:27)</a>:</h4>
<p>I don't think that's deterministically solvable, is it?</p>



<a name="497288137"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497288137" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497288137">(Feb 02 2025 at 20:27)</a>:</h4>
<p>like how could the compiler infer what indentation level you intended without knowing what tab width you have configured?</p>



<a name="497288207"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497288207" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497288207">(Feb 02 2025 at 20:28)</a>:</h4>
<p>oh I forgot to mention earlier - I think tabs being used for anything other than indentation should also be a warning (and the formatter should change them to spaces)</p>



<a name="497288235"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497288235" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497288235">(Feb 02 2025 at 20:28)</a>:</h4>
<p>If we really wanted to be fancy, we could retry the parse assuming different values of tab width, and see which parse makes the most sense</p>



<a name="497288369"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497288369" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497288369">(Feb 02 2025 at 20:30)</a>:</h4>
<p><span class="user-mention" data-user-id="343810">@Brendan Hansknecht</span> can you give a concrete example of the issue you typically hit?</p>



<a name="497288676"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497288676" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497288676">(Feb 02 2025 at 20:34)</a>:</h4>
<p><span class="user-mention silent" data-user-id="281383">Richard Feldman</span> <a href="#narrow/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling/near/497288207">said</a>:</p>
<blockquote>
<p>oh I forgot to mention earlier - I think tabs being used for anything other than indentation should also be a warning (and the formatter should change them to spaces)</p>
</blockquote>
<p>hrm, I just realized we'd have to make an exception for this inside doc comments in which you have code blocks.</p>



<a name="497288799"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497288799" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497288799">(Feb 02 2025 at 20:36)</a>:</h4>
<p>also, those could be really annoying to edit actually, because a number of editors (most notably Cursor, but Zed is about to start doing this too) are binding the Tab button to mean "accept LLM-generated suggestion"</p>



<a name="497288903"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497288903" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497288903">(Feb 02 2025 at 20:37)</a>:</h4>
<p>it's fine outside a doc comment bc the editor generally understands where indentation should happen and inserts indents for you, but inside doc comment code blocks they usually don't realize you're in code mode and they don't indent for you</p>



<a name="497288904"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497288904" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497288904">(Feb 02 2025 at 20:37)</a>:</h4>
<p>I wouldn’t expect an editor to reliably insert tab characters in that position?</p>



<a name="497288979"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497288979" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497288979">(Feb 02 2025 at 20:38)</a>:</h4>
<p>We could always make the formatter parse markdown code blocks inside doc comments and format those.</p>



<a name="497288990"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497288990" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497288990">(Feb 02 2025 at 20:38)</a>:</h4>
<p>that would be good! <span aria-label="+1" class="emoji emoji-1f44d" role="img" title="+1">:+1:</span></p>



<a name="497289030"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497289030" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497289030">(Feb 02 2025 at 20:39)</a>:</h4>
<p>also maybe we can get the editor grammars able to understand that aspect of markdown and do the indentation</p>



<a name="497289037"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497289037" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497289037">(Feb 02 2025 at 20:39)</a>:</h4>
<p>I wonder how Go deals with that <span aria-label="thinking" class="emoji emoji-1f914" role="img" title="thinking">:thinking:</span></p>



<a name="497289056"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497289056" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497289056">(Feb 02 2025 at 20:39)</a>:</h4>
<p><span class="user-mention silent" data-user-id="453336">Joshua Warner</span> <a href="#narrow/channel/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling/near/497288369">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="343810">Brendan Hansknecht</span> can you give a concrete example of the issue you typically hit?</p>
</blockquote>
<p>Here is what normally happens. Copy some code from github that is a repro or something. Paste it into my editor. Edit the file before saving (leads to inserting tabs instead of spaces). Save and now have some lines with tabs and some with spaces.</p>
<p>Just did a small edit of basic cli hello world and got this:</p>
<div class="codehilite" data-code-language="Ruby"><pre><span></span><code><span class="n">app</span><span class="w"> </span><span class="o">[</span><span class="n">main!</span><span class="o">]</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="ss">pf</span><span class="p">:</span><span class="w"> </span><span class="n">platform</span><span class="w"> </span><span class="s2">"../platform/main.roc"</span><span class="w"> </span><span class="p">}</span>

<span class="c1"># To run this example: check the README.md in this folder</span>

<span class="n">import</span><span class="w"> </span><span class="n">pf</span><span class="o">.</span><span class="n">Stdout</span>

<span class="n">main!</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">\</span><span class="n">_args</span><span class="w"> </span><span class="o">-&gt;</span>
<span class="w">    </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Hello, World!"</span>
<span class="w">    </span><span class="no">Stdout</span><span class="o">.</span><span class="n">line!</span><span class="w"> </span><span class="n">x</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="no">Str</span><span class="o">.</span><span class="n">countUtf8Bytes</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="k">then</span>
<span class="w">        </span><span class="no">Stdout</span><span class="o">.</span><span class="n">line!</span><span class="w"> </span><span class="s2">"large"</span>
<span class="w">    </span><span class="k">else</span>
<span class="w">        </span><span class="no">Stdout</span><span class="o">.</span><span class="n">line!</span><span class="w"> </span><span class="s2">"small"</span>
</code></pre></div>
<p>The original indented line from hello world (<code>Stdout.line! x</code>) is now the only line indented with spaces. With large code snippets, this becomes a mess of tabs and spaces and I have to manually do a bunch of character replacing.</p>



<a name="497289128"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497289128" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497289128">(Feb 02 2025 at 20:40)</a>:</h4>
<p>This happens cause I edit the file before saving it. Once I save it with a <code>.roc</code> extension, the editor figures it out.</p>



<a name="497289177"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497289177" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497289177">(Feb 02 2025 at 20:41)</a>:</h4>
<p>But at that point the damage is done.</p>



<a name="497289190"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497289190" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497289190">(Feb 02 2025 at 20:41)</a>:</h4>
<p>This sounds like the right approach would be to detect there’s a mix of spaces and tabs, issue a warning, and retry parsing with different tab width configs</p>



<a name="497289248"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497289248" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497289248">(Feb 02 2025 at 20:42)</a>:</h4>
<p>The pick the one with the fewest parse errors/warnings</p>



<a name="497289332"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497289332" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497289332">(Feb 02 2025 at 20:43)</a>:</h4>
<p><a href="https://forum.cursor.com/t/ambiguity-with-the-tab-key-in-cursor/7663/12?utm_source=chatgpt.com">https://forum.cursor.com/t/ambiguity-with-the-tab-key-in-cursor/7663/12?utm_source=chatgpt.com</a></p>
<p>ah, apparently a common workaround for indentation specifically is to use an "increase indentation level" keybinding</p>



<a name="497289414"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497289414" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497289414">(Feb 02 2025 at 20:44)</a>:</h4>
<p>I don't think that would work in doc comments though</p>



<a name="497289429"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497289429" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497289429">(Feb 02 2025 at 20:45)</a>:</h4>
<p>it would just indent the comment <span aria-label="sweat smile" class="emoji emoji-1f605" role="img" title="sweat smile">:sweat_smile:</span></p>



<a name="497289454"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497289454" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497289454">(Feb 02 2025 at 20:45)</a>:</h4>
<p>I would tend to uncomment, edit normally, then recomment</p>



<a name="497289705"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497289705" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497289705">(Feb 02 2025 at 20:49)</a>:</h4>
<p>Sorry everyone - had a number of Lunar New Years parties this weekend and have mostly been out.</p>



<a name="497289809"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497289809" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497289809">(Feb 02 2025 at 20:51)</a>:</h4>
<p><span class="user-mention" data-user-id="453336">@Joshua Warner</span> I think that indent ambiguity is a really messy thing for both the parser and the user to deal with.  I personally think the consistency we could apply with INDENT and DEDENT tokens far outweighs the permissiveness of the alternative plan</p>



<a name="497289892"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497289892" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497289892">(Feb 02 2025 at 20:52)</a>:</h4>
<p>But I think regardless of what we decide to do with the specifics there, I think the current design of the token output is hard to work with.</p>



<a name="497289942"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497289942" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497289942">(Feb 02 2025 at 20:53)</a>:</h4>
<p>Specifically we have an SoA over the tokens but in the same struct a fourth array for lines where it's not exactly straightforward with how the parser is supposed to interact with it (its length has no relation to the rest)</p>



<a name="497289955"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497289955" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497289955">(Feb 02 2025 at 20:54)</a>:</h4>
<p>It’s actually not bad to work with. Logic for that is kept in a very thin layer around the tokenizer, and most of the parser doesn’t have to care.</p>



<a name="497290018"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497290018" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497290018">(Feb 02 2025 at 20:54)</a>:</h4>
<p>That layer tracks a current line index, incrementing that as appropriate in the parsers advance method</p>



<a name="497290061"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497290061" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497290061">(Feb 02 2025 at 20:55)</a>:</h4>
<p>Maybe I should stop what I'm working on because it sounds like you have already designed a parser around this tokenizer</p>



<a name="497290148"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497290148" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497290148">(Feb 02 2025 at 20:56)</a>:</h4>
<p>And the "thin layer" that you are speaking of doesn't jump off the page to me at all</p>



<a name="497290175"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497290175" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497290175">(Feb 02 2025 at 20:57)</a>:</h4>
<p>But I've only had about an hour or two and I've spent most of that exploring some different designs of the AST</p>



<a name="497290199"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497290199" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497290199">(Feb 02 2025 at 20:57)</a>:</h4>
<p>This is literally the tokenizer from the parser I linked in the other thread, translated to zig. So yeah there is a parser that goes with. But I wasn’t thinking of reusing that wholesale - just select parts.</p>



<a name="497290272"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497290272" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497290272">(Feb 02 2025 at 20:58)</a>:</h4>
<p>Oh, the one with the linear tree structure?</p>



<a name="497290278"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497290278" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497290278">(Feb 02 2025 at 20:58)</a>:</h4>
<p>Yeah</p>



<a name="497290295"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497290295" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497290295">(Feb 02 2025 at 20:58)</a>:</h4>
<p>I spent quite a lot of time trying out the indent and dedent token idea, and it was quite fragile</p>



<a name="497290299"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497290299" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497290299">(Feb 02 2025 at 20:58)</a>:</h4>
<p>Ok, I thought that was more of a thought experiment since we seemed to be aiming for simplicity</p>



<a name="497290320"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497290320" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497290320">(Feb 02 2025 at 20:59)</a>:</h4>
<p>Yeah, the linear tree parts of that I want to throw away</p>



<a name="497290337"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497290337" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497290337">(Feb 02 2025 at 20:59)</a>:</h4>
<p>That's interesting, usually with RD with a WSS language IDENT/DEDENT tokens are very straightforward</p>



<a name="497290408"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497290408" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497290408">(Feb 02 2025 at 21:00)</a>:</h4>
<p>But maybe it's different with Roc's philosophy of maximal flexibility in the parser</p>



<a name="497290434"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497290434" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497290434">(Feb 02 2025 at 21:00)</a>:</h4>
<p>The problem with indent/dedent in roc is there’s a long list of tokens that might jntroduce a block. Python only allow : to do that.</p>



<a name="497290554"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497290554" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497290554">(Feb 02 2025 at 21:02)</a>:</h4>
<p>Don’t get me wrong; indent/dedent can be made to work. But it gets messy.</p>



<a name="497290555"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497290555" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497290555">(Feb 02 2025 at 21:02)</a>:</h4>
<p>I think there would be two main helpers for that, say <code>parse_block (parses newline-delimited statements at same level of indentation)</code>, and <code>parse_collection</code>(parses a comma-delimited sequence that can dedent).</p>



<a name="497290660"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497290660" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497290660">(Feb 02 2025 at 21:03)</a>:</h4>
<p>Ok, I'd love to see the difference between the two as I can't imagine the other being simpler (but I'm probably just a dolt).</p>



<a name="497290744"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497290744" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497290744">(Feb 02 2025 at 21:05)</a>:</h4>
<p>You have to be careful because you don’t want the ￼tokenizer to insert indent tokens in the middle of an expression</p>



<a name="497290852"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497290852" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497290852">(Feb 02 2025 at 21:06)</a>:</h4>
<p>You also kinda want indent tokens inside parens (so that can allow stmts), but you also… don’t, because folks are used to eg python where indentation is relaxed inside parens</p>



<a name="497290863"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497290863" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497290863">(Feb 02 2025 at 21:06)</a>:</h4>
<p>Why not?  In Python:</p>
<div class="codehilite"><pre><span></span><code>some_func(
    a,
    b,
)
</code></pre></div>
<p>Would be a ID, PAREN_O, IDENT, ID, COMMA, NEWLINE, ID, COMMA, DEDENT, PAREN_C no?  Don't see why it wouldn't be the same in Roc</p>



<a name="497290891"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497290891" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497290891">(Feb 02 2025 at 21:07)</a>:</h4>
<p>(I don't remember the exact token names)</p>



<a name="497290897"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497290897" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497290897">(Feb 02 2025 at 21:07)</a>:</h4>
<p>What if b is dedented there? I’d like that to parse properly too since it’s completely unambiguous</p>



<a name="497290931"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497290931" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497290931">(Feb 02 2025 at 21:07)</a>:</h4>
<p>Similarly, maybe a is dedented but b is indented.</p>



<a name="497291020"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497291020" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497291020">(Feb 02 2025 at 21:08)</a>:</h4>
<p>Hmm....I would just expect us to push a parse error and fast forward to the closing paren and move on</p>



<a name="497291052"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497291052" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497291052">(Feb 02 2025 at 21:09)</a>:</h4>
<p>That’s a valid answer, yeah. But I want to be more forgiving than that.</p>



<a name="497291146"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497291146" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497291146">(Feb 02 2025 at 21:10)</a>:</h4>
<p>I’d like to have fewer annoyances than an indentation sensitive lang like python, not more</p>



<a name="497291150"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497291150" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497291150">(Feb 02 2025 at 21:10)</a>:</h4>
<p>Couldn't you just say in a collection "use INDENT and DEDENT to track current, and ensure that if we encounter a newline that the indentation is the same as the start?"</p>



<a name="497291157"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497291157" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497291157">(Feb 02 2025 at 21:10)</a>:</h4>
<p>And an apply as well?</p>



<a name="497291171"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497291171" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497291171">(Feb 02 2025 at 21:10)</a>:</h4>
<p>I don’t quite follow</p>



<a name="497291185"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497291185" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497291185">(Feb 02 2025 at 21:11)</a>:</h4>
<p>Ok, let me try an example</p>



<a name="497291335"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497291335" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497291335">(Feb 02 2025 at 21:13)</a>:</h4>
<div class="codehilite" data-code-language="Python"><pre><span></span><code><span class="n">foo</span><span class="p">(</span> <span class="c1"># start_indent=0, current_indent=0</span>
    <span class="n">a</span><span class="p">,</span> <span class="c1"># INDENT = current_indent = current_indent + 1 (1)</span>
<span class="n">b</span><span class="p">,</span> <span class="c1"># DEDENT = current_indent = current+indent - 1 (0)</span>
<span class="p">)</span> <span class="c1"># NEWLINE doesn't change indent</span>
</code></pre></div>
<p>This can parse because the apply (an args container), was satisfied because we ended with the current_indent the same as start_indent</p>



<a name="497291460"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497291460" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497291460">(Feb 02 2025 at 21:15)</a>:</h4>
<p>Or you just throw away the INDENTs and DEDENTs inside the container completely, and only monitor indent at the statement level</p>



<a name="497291544"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497291544" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497291544">(Feb 02 2025 at 21:17)</a>:</h4>
<p>But at <em>some point</em> I feel like you have to make the whitespace significant in a whitespace significant language.</p>



<a name="497291570"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497291570" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497291570">(Feb 02 2025 at 21:17)</a>:</h4>
<p>Hmm so I was definitely assuming indent/dedent would properly nest with other braces. I don’t think that would work with your design?</p>



<a name="497291655"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497291655" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497291655">(Feb 02 2025 at 21:18)</a>:</h4>
<p>In Python IDENT/DEDENT are braces - because its a militantly WSS language</p>



<a name="497291667"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497291667" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497291667">(Feb 02 2025 at 21:18)</a>:</h4>
<p>But they don't have to be, they can just be state-change tokens</p>



<a name="497291672"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497291672" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497291672">(Feb 02 2025 at 21:18)</a>:</h4>
<p>Hmm</p>



<a name="497291705"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497291705" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497291705">(Feb 02 2025 at 21:19)</a>:</h4>
<p>At that level, I think these two representations are approximately equivalent</p>



<a name="497291726"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497291726" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497291726">(Feb 02 2025 at 21:19)</a>:</h4>
<p>Or we can take a page from Lua and require blocks have an explicitly textual end delimiter.  (Don't kill me , I know I suggested this before)</p>



<a name="497291779"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497291779" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497291779">(Feb 02 2025 at 21:20)</a>:</h4>
<p>Ehhhh</p>



<a name="497291807"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497291807" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497291807">(Feb 02 2025 at 21:20)</a>:</h4>
<p>Yeah, it just pushes the logic for "what's an indent or dedent or just a newline?" to the tokenizer</p>



<a name="497291887"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497291887" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497291887">(Feb 02 2025 at 21:21)</a>:</h4>
<p>No, that logic has to cross both the parser and tokenizer. The parser has to know to ignore some of these indent/dedents where it doesn’t care about them.</p>



<a name="497291961"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497291961" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497291961">(Feb 02 2025 at 21:22)</a>:</h4>
<p>Let me ask you this, if</p>
<div class="codehilite" data-code-language="Python"><pre><span></span><code><span class="n">foo</span><span class="p">(</span>
    <span class="n">a</span><span class="p">,</span>
<span class="n">b</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>
<p>Should parse, what about:</p>
<div class="codehilite" data-code-language="Elm"><pre><span></span><code><span class="nv">when</span><span class="w"> </span><span class="nv">foo</span><span class="w"> </span><span class="nv">is</span>
<span class="w">    </span><span class="kt">Ok</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="nv">something</span>
<span class="kt">Err</span><span class="p">(</span><span class="nv">e</span><span class="p">)</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="nv">something_else</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nv">func</span><span class="p">(</span><span class="nv">a</span><span class="p">,</span><span class="w"> </span><span class="nv">b</span><span class="p">)</span>
<span class="nv">something_else</span>
</code></pre></div>
<p>?</p>



<a name="497292004"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497292004" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497292004">(Feb 02 2025 at 21:22)</a>:</h4>
<p>That should not parse</p>



<a name="497292020"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497292020" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497292020">(Feb 02 2025 at 21:23)</a>:</h4>
<p>And doesn’t, currently</p>



<a name="497292025"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497292025" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497292025">(Feb 02 2025 at 21:23)</a>:</h4>
<p><span class="user-mention silent" data-user-id="453336">Joshua Warner</span> <a href="#narrow/channel/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling/near/497291887">said</a>:</p>
<blockquote>
<p>No, that logic has to cross both the parser and tokenizer. The parser has to know to ignore some of these indent/dedents where it doesn’t care about them.</p>
</blockquote>
<p>Yes, but it doesn't have to decide what <strong>is</strong> a indent/dedent in terms of raw character bytes (1 space, 4 spaces, tab, etc)</p>



<a name="497292131"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497292131" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497292131">(Feb 02 2025 at 21:24)</a>:</h4>
<p><span class="user-mention silent" data-user-id="453336">Joshua Warner</span> <a href="#narrow/channel/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling/near/497292004">said</a>:</p>
<blockquote>
<p>That should not parse</p>
</blockquote>
<p>But why not?  It's just as unambiguous to me.  Or is it because the former has an explicit bounding pair around it?</p>



<a name="497292160"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497292160" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497292160">(Feb 02 2025 at 21:24)</a>:</h4>
<p>It’s only unambiguous if the input ends there</p>



<a name="497292203"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497292203" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497292203">(Feb 02 2025 at 21:25)</a>:</h4>
<p>And then</p>
<div class="codehilite" data-code-language="Elm"><pre><span></span><code><span class="nv">when</span><span class="w"> </span><span class="nv">foo</span><span class="w"> </span><span class="nv">is</span>
<span class="w">    </span><span class="kt">Ok</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="nv">something</span>
<span class="kt">Err</span><span class="p">(</span><span class="nv">e</span><span class="p">)</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="nv">something_else</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nv">func</span><span class="p">(</span><span class="nv">a</span><span class="p">,</span><span class="w"> </span><span class="nv">b</span><span class="p">)</span>
<span class="nv">something_else</span>
<span class="nv">end</span>
</code></pre></div>
<p>would be unambiguous if that syntax existed?</p>



<a name="497292218"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497292218" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497292218">(Feb 02 2025 at 21:25)</a>:</h4>
<p>Yeah but it doesn’t</p>



<a name="497292229"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497292229" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497292229">(Feb 02 2025 at 21:25)</a>:</h4>
<p>Cool, on the same page</p>



<a name="497292315"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497292315" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497292315">(Feb 02 2025 at 21:26)</a>:</h4>
<p>I'm trying to think of how we would <em>describe</em> the grammar of Roc, in say EBNF</p>



<a name="497292353"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497292353" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497292353">(Feb 02 2025 at 21:26)</a>:</h4>
<p>That’s a gnarly road to go down</p>



<a name="497292354"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497292354" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497292354">(Feb 02 2025 at 21:26)</a>:</h4>
<p>As opposed to thinking about the logic we'll implement in Zig</p>



<a name="497292376"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497292376" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497292376">(Feb 02 2025 at 21:26)</a>:</h4>
<p>But maybe it's just me, but I want things to be consistent</p>



<a name="497292405"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497292405" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497292405">(Feb 02 2025 at 21:27)</a>:</h4>
<p>Roc is not well designed to have a simple-ish ebnf</p>



<a name="497292407"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497292407" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497292407">(Feb 02 2025 at 21:27)</a>:</h4>
<p>I think that's what people like about C-syntax languages</p>



<a name="497292423"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497292423" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497292423">(Feb 02 2025 at 21:27)</a>:</h4>
<p>I don’t disagree with you</p>



<a name="497292426"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497292426" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497292426">(Feb 02 2025 at 21:27)</a>:</h4>
<p>Is that a block is _always_ in squirlies</p>



<a name="497292441"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497292441" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497292441">(Feb 02 2025 at 21:27)</a>:</h4>
<p>But that’s not what roc is right now</p>



<a name="497292519"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497292519" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497292519">(Feb 02 2025 at 21:28)</a>:</h4>
<p>(I would be open to changing that - and TBH that’s a direction I like, but that seems like a separate convo)</p>



<a name="497292533"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497292533" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497292533">(Feb 02 2025 at 21:28)</a>:</h4>
<p>What I'm saying is is that "Whitespace matters for a when expression, but not for a multi-line list or application" feels inconsistent to me</p>



<a name="497292566"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497292566" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497292566">(Feb 02 2025 at 21:29)</a>:</h4>
<p>I want to have a parser that’s not annoying to work with as a user</p>



<a name="497292573"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497292573" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497292573">(Feb 02 2025 at 21:29)</a>:</h4>
<p>It feels forgiving yes, but inconsistent</p>



<a name="497292587"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497292587" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497292587">(Feb 02 2025 at 21:29)</a>:</h4>
<p>We can issue a warning if we want</p>



<a name="497292590"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497292590" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497292590">(Feb 02 2025 at 21:29)</a>:</h4>
<p>Oh, so that's why it seems like you are saying to get rid of WSS :-)</p>



<a name="497292601"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497292601" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497292601">(Feb 02 2025 at 21:29)</a>:</h4>
<p>Or at least suggesting it</p>



<a name="497292607"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497292607" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497292607">(Feb 02 2025 at 21:29)</a>:</h4>
<p>Because it is fiddly</p>



<a name="497292608"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497292608" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497292608">(Feb 02 2025 at 21:29)</a>:</h4>
<p>No. Only relaxing it where it’s unambiguous</p>



<a name="497292700"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497292700" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497292700">(Feb 02 2025 at 21:30)</a>:</h4>
<p>I’m just describing how the current parser/language work. I want to keep that same behavior.</p>



<a name="497292916"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497292916" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497292916">(Feb 02 2025 at 21:32)</a>:</h4>
<p>That makes sense, but this new compiler is probably the best time to write down the principles we want for the parser and kind of move away from the past.  That's kind of what we are doing in every other phase (within reason).</p>
<p>Like, what would you change if the starting part for the grammar was properly formatted code from the current compiler?</p>



<a name="497292946"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497292946" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497292946">(Feb 02 2025 at 21:33)</a>:</h4>
<p>And then say "what should we be more forgiving on from this point?"</p>



<a name="497292971"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497292971" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497292971">(Feb 02 2025 at 21:33)</a>:</h4>
<p>You obviously don't want to require the user to write perfectly formatted code -  humans aren't structural editors</p>



<a name="497293045"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497293045" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497293045">(Feb 02 2025 at 21:34)</a>:</h4>
<p>Roc is not well designed to have a clean and simple grammar</p>



<a name="497293061"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497293061" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497293061">(Feb 02 2025 at 21:34)</a>:</h4>
<p>But what version of that grammar parses very fast, is very consistent, and not a pain to work with?</p>



<a name="497293138"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497293138" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497293138">(Feb 02 2025 at 21:35)</a>:</h4>
<p>Languages with significant white space are simply not encodable in context free grammars. You always need an adapter layer, and that can get ugly.</p>



<a name="497293208"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497293208" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497293208">(Feb 02 2025 at 21:36)</a>:</h4>
<p>If we want a language that has a simple grammar, that’ll require making some significant changes.</p>



<a name="497293269"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497293269" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497293269">(Feb 02 2025 at 21:37)</a>:</h4>
<p>Yes, I know.  That's why when I created my language I did one trick to make it neither require braces, nor be WSS: All blocks _must_ end in an expression.  But that requires a specific design of language that is not like Roc today and definitely not Roc of tomorrow</p>



<a name="497293322"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497293322" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497293322">(Feb 02 2025 at 21:38)</a>:</h4>
<p>Roc used to be like that</p>



<a name="497293362"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497293362" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497293362">(Feb 02 2025 at 21:38)</a>:</h4>
<p>It could technically be written in a single line and parse correctly (until I added that all blocks end in an expression followed by a newline)</p>



<a name="497293401"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497293401" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497293401">(Feb 02 2025 at 21:38)</a>:</h4>
<p>Presumably you need substitute line separators? Or were expressions always self-delimiting?</p>



<a name="497293406"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497293406" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497293406">(Feb 02 2025 at 21:39)</a>:</h4>
<p>Yeah, we seem to be much closer to a Ruby-style syntax</p>



<a name="497293591"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497293591" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497293591">(Feb 02 2025 at 21:41)</a>:</h4>
<p><span class="user-mention silent" data-user-id="453336">Joshua Warner</span> <a href="#narrow/channel/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling/near/497293401">said</a>:</p>
<blockquote>
<p>Presumably you need substitute line separators? Or were expressions always self-delimiting?</p>
</blockquote>
<p>Every expression was self-delimiting.  There were only literals for Strings, Numbers, Lists, Tuples, Records, Tuples, Lambdas and then Tags and a Match expression.  Lambas delimited with {} (only the anonymous kind, not top-level), and match required branches to be introduced with "|" so the last branch would delimit the whole expression</p>



<a name="497293625"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497293625" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497293625">(Feb 02 2025 at 21:41)</a>:</h4>
<p>Aha yep makes sense</p>



<a name="497293633"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497293633" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497293633">(Feb 02 2025 at 21:41)</a>:</h4>
<p>Cool</p>



<a name="497293684"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497293684" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497293684">(Feb 02 2025 at 21:42)</a>:</h4>
<p>It wasn't the most efficient, but parsed reasonably fast for being written in F#</p>



<a name="497293709"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497293709" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497293709">(Feb 02 2025 at 21:42)</a>:</h4>
<p>Hand rolled the RD parser at first, and then moved to FParsec which was 95% API compatible</p>



<a name="497293770"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497293770" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497293770">(Feb 02 2025 at 21:43)</a>:</h4>
<p>I’d like to keep the set of syntax changes we’re making with this rewrite as minimal as possible</p>



<a name="497293780"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497293780" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497293780">(Feb 02 2025 at 21:43)</a>:</h4>
<p>(Thank you Scott Wlaschin of <a href="https://fsharpforfunandprofit.com/">F# For Fun And Profit Fame</a> for giving me inspiration)</p>



<a name="497293792"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497293792" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497293792">(Feb 02 2025 at 21:43)</a>:</h4>
<p>Yeah I'd like to make zero</p>



<a name="497293851"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497293851" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497293851">(Feb 02 2025 at 21:44)</a>:</h4>
<p>So that leads us back to the initial discussion</p>



<a name="497293857"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497293857" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497293857">(Feb 02 2025 at 21:44)</a>:</h4>
<p>Cool, sounds like we’re aligned then</p>



<a name="497293894"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497293894" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497293894">(Feb 02 2025 at 21:44)</a>:</h4>
<p>I think I'll just wait and see what the skeleton of the parser you put up looks like on top of your tokenizer</p>



<a name="497293950"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497293950" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497293950">(Feb 02 2025 at 21:45)</a>:</h4>
<p>You are the parser guru, so I'll do my best to row the boat in the same direction</p>



<a name="497293970"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497293970" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497293970">(Feb 02 2025 at 21:45)</a>:</h4>
<p>Just wanted to say my piece and learn a few things along the way</p>



<a name="497294006"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497294006" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497294006">(Feb 02 2025 at 21:46)</a>:</h4>
<p>I appreciate the back pressure</p>



<a name="497294036"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497294036" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497294036">(Feb 02 2025 at 21:46)</a>:</h4>
<p>You’re asking reasonable questions</p>



<a name="497294055"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497294055" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497294055">(Feb 02 2025 at 21:46)</a>:</h4>
<p>As a young padawan, I still think of a parser as "enforcer of a described, mechanical grammar"</p>



<a name="497294078"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497294078" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497294078">(Feb 02 2025 at 21:46)</a>:</h4>
<p>Haha</p>



<a name="497294090"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497294090" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497294090">(Feb 02 2025 at 21:46)</a>:</h4>
<p>One that reliably generates AST Nodes when the user is being faithful to that grammar</p>



<a name="497331983"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497331983" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497331983">(Feb 03 2025 at 05:16)</a>:</h4>
<p><span class="user-mention" data-user-id="781658">@Anthony Bullard</span> Added a skeleton parser to <a href="https://github.com/roc-lang/roc/pull/7569">https://github.com/roc-lang/roc/pull/7569</a>, that shows the intended way of interoperating with the lines</p>



<a name="497332053"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497332053" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497332053">(Feb 03 2025 at 05:17)</a>:</h4>
<p><span aria-label="thinking" class="emoji emoji-1f914" role="img" title="thinking">:thinking:</span> Now that I think about this tho... I wonder if I could just have a <code>Newline</code> token, and subvert either the offset or the length field to sneak in the indent level...</p>



<a name="497332116"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497332116" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497332116">(Feb 03 2025 at 05:17)</a>:</h4>
<p>That may be a bit easier to integrate, and have lower cognitive overhead on the parser side</p>



<a name="497336320"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497336320" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497336320">(Feb 03 2025 at 05:57)</a>:</h4>
<p>Yep that seems cleaner; pushed that</p>



<a name="497399840"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497399840" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497399840">(Feb 03 2025 at 11:01)</a>:</h4>
<p>Sweet that sounds like a good compromise</p>



<a name="497438043"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497438043" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497438043">(Feb 03 2025 at 13:40)</a>:</h4>
<p><span class="user-mention silent" data-user-id="781658">Anthony Bullard</span> <a href="#narrow/channel/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling/near/497290408">said</a>:</p>
<blockquote>
<p>But maybe it's different with Roc's philosophy of maximal flexibility in the parser</p>
</blockquote>
<p>Just a comment: I believe the value of parser flexibility has dropped significantly. Beginners were likely to produce strange code, but beginners with LLMs are not. It is my understanding that flexibility comes with significant complexity.</p>



<a name="497471047"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497471047" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497471047">(Feb 03 2025 at 15:46)</a>:</h4>
<p>I think the main value is actually when you're temporarily in a strange editor state, e.g. because you've copy/pasted something in from somewhere else and the indentation is different</p>



<a name="497480629"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497480629" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497480629">(Feb 03 2025 at 16:23)</a>:</h4>
<blockquote>
<p>because you've copy/pasted something in from somewhere else and the indentation is different</p>
</blockquote>
<p>Can you explain more? Would you want the parser to able to fully parse everything with mixed indentation?</p>



<a name="497485092"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497485092" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497485092">(Feb 03 2025 at 16:43)</a>:</h4>
<p><span class="user-mention silent" data-user-id="281383">Richard Feldman</span> <a href="#narrow/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling/near/497471047">said</a>:</p>
<blockquote>
<p>I think the main value is actually when you're temporarily in a strange editor state, e.g. because you've copy/pasted something in from somewhere else and the indentation is different</p>
</blockquote>
<p>Except roc doesn't fix this with the current plans. That is exactly the case I mentioned above that breaks and is really hard to fix deterministically. It requires having to guess the tab width.</p>



<a name="497487692"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497487692" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497487692">(Feb 03 2025 at 16:54)</a>:</h4>
<p>But that’s just WSS</p>



<a name="497488055"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497488055" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497488055">(Feb 03 2025 at 16:56)</a>:</h4>
<p>That’s only solved by only accepting tabs for indentation (or some other more draconian measure like “only four spaces”)</p>



<a name="497489536"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497489536" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497489536">(Feb 03 2025 at 17:02)</a>:</h4>
<p>WSS?</p>



<a name="497489943"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497489943" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497489943">(Feb 03 2025 at 17:04)</a>:</h4>
<p>White space significance</p>



<a name="497490111"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497490111" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497490111">(Feb 03 2025 at 17:05)</a>:</h4>
<p>If you have 100% bounded expressions and statements this isn’t an issue</p>



<a name="497490204"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497490204" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497490204">(Feb 03 2025 at 17:05)</a>:</h4>
<p>Otherwise you need a deterministic indentation to act like “braces”</p>



<a name="497491208"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497491208" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497491208">(Feb 03 2025 at 17:10)</a>:</h4>
<p>Oh sure, but it is really frustrating nevertheless.</p>
<p>Theoretically roc could try and figure this out or at least the formatter could convert tabs to space or vice versa (even with broken code) such that I can notice why the file is broken.</p>



<a name="497491374"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497491374" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497491374">(Feb 03 2025 at 17:11)</a>:</h4>
<p>Just a very frustrating user experience that is hard to debug. Given everything lines up in my editor, roc could theoretically figure this out by guessing tab widths.</p>



<a name="497491450"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497491450" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497491450">(Feb 03 2025 at 17:11)</a>:</h4>
<p>Not saying it is worth doing, but I don't think it is unsolvable or innate as an edge case</p>



<a name="497495006"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497495006" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497495006">(Feb 03 2025 at 17:29)</a>:</h4>
<p>I would be fine with a bad indentation error. In an editor I would then use the "llm autofix error" button (zed already has this I believe). I bet llms are great at fixing indentation.</p>



<a name="497501199"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497501199" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497501199">(Feb 03 2025 at 18:03)</a>:</h4>
<p>I'm not a fan of that solution cause I don't use llms generally (and I'm sure many others are in this boat). So it really isn't a fix in my mind. Also, it isn't hard to manually fix, just the kind of thing where being permissive would be amazing.</p>



<a name="497515565"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497515565" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497515565">(Feb 03 2025 at 19:25)</a>:</h4>
<p>Note: I totally also recognize that it may be infeasible/unreasonable to implement.</p>



<a name="497515589"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497515589" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497515589">(Feb 03 2025 at 19:25)</a>:</h4>
<p>So the best we may get is a good error message</p>



<a name="497522433"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497522433" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> kris <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497522433">(Feb 03 2025 at 20:10)</a>:</h4>
<p>Was there ever a discussion about WSS? especially with regards to the parencomma restructuring. i could not find anything</p>



<a name="497522957"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497522957" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497522957">(Feb 03 2025 at 20:13)</a>:</h4>
<p>Nope</p>



<a name="497523093"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497523093" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497523093">(Feb 03 2025 at 20:14)</a>:</h4>
<p>You could start a <a class="stream" data-stream-id="304641" href="/#narrow/channel/304641-ideas">#ideas</a> thread, but I would not expect it to see traction.</p>



<a name="497528095"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497528095" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497528095">(Feb 03 2025 at 20:46)</a>:</h4>
<p>I’ve started such a thread in the past and it did not go well <span aria-label="rolling on the floor laughing" class="emoji emoji-1f923" role="img" title="rolling on the floor laughing">:rolling_on_the_floor_laughing:</span></p>



<a name="497567873"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20indent%20handling/near/497567873" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling.html#497567873">(Feb 04 2025 at 02:08)</a>:</h4>
<p><span class="user-mention silent" data-user-id="343810">Brendan Hansknecht</span> <a href="#narrow/stream/395097-compiler-development/topic/zig.20compiler.20-.20indent.20handling/near/497515565">said</a>:</p>
<blockquote>
<p>Note: I totally also recognize that it may be infeasible/unreasonable to implement.</p>
</blockquote>
<p>I think it is actually within reason to implement. Or at least improve the situation.</p>



<hr><p>Last updated: Mar 01 2026 at 12:20 UTC</p>
</html>