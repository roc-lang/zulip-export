<html>
<head><meta charset="utf-8"><title>zig compiler - running anyway even when there are errors · compiler development · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/index.html">compiler development</a></h2>
<h3>Topic: <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20running.20anyway.20even.20when.20there.20are.20errors.html">zig compiler - running anyway even when there are errors</a></h3>

<hr>

<base href="https://roc.zulipchat.com">

<head><link href="https://roc-lang.github.io/zulip-export/style.css" rel="stylesheet"></head>

<a name="497312414"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20running%20anyway%20even%20when%20there%20are%20errors/near/497312414" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20running.20anyway.20even.20when.20there.20are.20errors.html#497312414">(Feb 03 2025 at 01:38)</a>:</h4>
<p>it occurred to me that our interpreter can be faster than a lot of interpreters because it doesn't need to do runtime type checking</p>



<a name="497312450"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20running%20anyway%20even%20when%20there%20are%20errors/near/497312450" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20running.20anyway.20even.20when.20there.20are.20errors.html#497312450">(Feb 03 2025 at 01:38)</a>:</h4>
<p>because we'll already have type-checked it, so we know that if there are any type mismatches, we've already dealt with them at compile time</p>



<a name="497312603"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20running%20anyway%20even%20when%20there%20are%20errors/near/497312603" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20running.20anyway.20even.20when.20there.20are.20errors.html#497312603">(Feb 03 2025 at 01:40)</a>:</h4>
<p>Yes, though we will have to still dispatch on type for at least refcounting</p>



<a name="497312614"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20running%20anyway%20even%20when%20there%20are%20errors/near/497312614" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20running.20anyway.20even.20when.20there.20are.20errors.html#497312614">(Feb 03 2025 at 01:40)</a>:</h4>
<p>oh sure, and also for static dispatch</p>



<a name="497312638"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20running%20anyway%20even%20when%20there%20are%20errors/near/497312638" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20running.20anyway.20even.20when.20there.20are.20errors.html#497312638">(Feb 03 2025 at 01:41)</a>:</h4>
<p>Yeah, and to call zig builtins</p>



<a name="497312653"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20running%20anyway%20even%20when%20there%20are%20errors/near/497312653" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20running.20anyway.20even.20when.20there.20are.20errors.html#497312653">(Feb 03 2025 at 01:41)</a>:</h4>
<p>today, the way we (very often incorrectly) deal with type mismatches in the "I want to run my program anyway even though I know there are type mismatches" scenario is that during the building process, whenever we encounter a canonical IR node and go ask it what its type is, we then notice when its type is "type mismatch" and emit an IR node that's supposed to crash at runtime</p>



<a name="497312655"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20running%20anyway%20even%20when%20there%20are%20errors/near/497312655" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20running.20anyway.20even.20when.20there.20are.20errors.html#497312655">(Feb 03 2025 at 01:41)</a>:</h4>
<p>Well, not dispatch on type, but fill out type specific information for the call</p>



<a name="497312766"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20running%20anyway%20even%20when%20there%20are%20errors/near/497312766" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20running.20anyway.20even.20when.20there.20are.20errors.html#497312766">(Feb 03 2025 at 01:42)</a>:</h4>
<p>in the case where we're not doing a full build, and are instead running an interpreter right after type checking finishes, we aren't doing any more compile-time passes over the canonical IR, so we don't have the same opportunity to detect those type mismatches at compile time</p>



<a name="497312798"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20running%20anyway%20even%20when%20there%20are%20errors/near/497312798" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20running.20anyway.20even.20when.20there.20are.20errors.html#497312798">(Feb 03 2025 at 01:42)</a>:</h4>
<p>one way we could deal with those is to, at runtime, always check every single canonical IR node's type to see if it happens to be a type mismatch, and then crash if so</p>



<a name="497312836"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20running%20anyway%20even%20when%20there%20are%20errors/near/497312836" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20running.20anyway.20even.20when.20there.20are.20errors.html#497312836">(Feb 03 2025 at 01:43)</a>:</h4>
<p>but at that point we're potentially worse off than languages that check types at runtime <span aria-label="sweat smile" class="emoji emoji-1f605" role="img" title="sweat smile">:sweat_smile:</span></p>



<a name="497312843"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20running%20anyway%20even%20when%20there%20are%20errors/near/497312843" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20running.20anyway.20even.20when.20there.20are.20errors.html#497312843">(Feb 03 2025 at 01:43)</a>:</h4>
<p>I think there's a much simpler solution</p>



<a name="497312877"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20running%20anyway%20even%20when%20there%20are%20errors/near/497312877" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20running.20anyway.20even.20when.20there.20are.20errors.html#497312877">(Feb 03 2025 at 01:44)</a>:</h4>
<p>every time the type checker hits a type mismatch, in addition to pushing a <code>Problem</code> onto a list (to be reported later), it also pushes a "hey this <code>Variable</code> was a type mismatch" onto a list too</p>



<a name="497312967"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20running%20anyway%20even%20when%20there%20are%20errors/near/497312967" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20running.20anyway.20even.20when.20there.20are.20errors.html#497312967">(Feb 03 2025 at 01:45)</a>:</h4>
<p>then after type-checking is done, if we're going to be interpreting, we have one very quick pass where we go through the list of recorded type mismatches and replace all the canonical IR nodes corresponding to those <code>Variable</code>s with <code>crash</code> nodes</p>



<a name="497312979"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20running%20anyway%20even%20when%20there%20are%20errors/near/497312979" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20running.20anyway.20even.20when.20there.20are.20errors.html#497312979">(Feb 03 2025 at 01:45)</a>:</h4>
<p>if the list is empty and there are no type mismatches, this is free</p>



<a name="497313003"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20running%20anyway%20even%20when%20there%20are%20errors/near/497313003" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20running.20anyway.20even.20when.20there.20are.20errors.html#497313003">(Feb 03 2025 at 01:45)</a>:</h4>
<p>if there are type mismatches, then we only pay for however many we actually need to fixup</p>



<a name="497313016"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20running%20anyway%20even%20when%20there%20are%20errors/near/497313016" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20running.20anyway.20even.20when.20there.20are.20errors.html#497313016">(Feb 03 2025 at 01:45)</a>:</h4>
<p>and then at runtime we don't need to check for any type mismatches at all!</p>



<a name="497313124"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20running%20anyway%20even%20when%20there%20are%20errors/near/497313124" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20running.20anyway.20even.20when.20there.20are.20errors.html#497313124">(Feb 03 2025 at 01:47)</a>:</h4>
<p>also, we can make the "get the canonical IR node from the <code>Variable</code>" lookup trivial if we assign variables to be the same number as nodes by default, except for nodes that have multiple variables (in which case we can hand out those extra Variables starting from -1 and decrementing, whereas the canonical IR node IDs would all be 0 or positive)</p>



<a name="497313144"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20running%20anyway%20even%20when%20there%20are%20errors/near/497313144" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20running.20anyway.20even.20when.20there.20are.20errors.html#497313144">(Feb 03 2025 at 01:47)</a>:</h4>
<p><span class="user-mention silent" data-user-id="281383">Richard Feldman</span> <a href="#narrow/stream/395097-compiler-development/topic/zig.20compiler.20-.20running.20anyway.20even.20when.20there.20are.20errors/near/497312766">said</a>:</p>
<blockquote>
<p>are instead running an interpreter right after type checking finishes, we aren't doing any more compile-time passes over the canonical IR, so we don't have the same opportunity to detect those type mismatches at compile time</p>
</blockquote>
<p>Can you explain this more? In the current pipeline does creating these nodes happen later in the pipeline like after specialization or something?</p>



<a name="497313162"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20running%20anyway%20even%20when%20there%20are%20errors/near/497313162" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20running.20anyway.20even.20when.20there.20are.20errors.html#497313162">(Feb 03 2025 at 01:47)</a>:</h4>
<p>yeah exactly</p>



<a name="497313176"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20running%20anyway%20even%20when%20there%20are%20errors/near/497313176" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20running.20anyway.20even.20when.20there.20are.20errors.html#497313176">(Feb 03 2025 at 01:47)</a>:</h4>
<p>I think it's during specialization actually</p>



<a name="497313232"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20running%20anyway%20even%20when%20there%20are%20errors/near/497313232" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20running.20anyway.20even.20when.20there.20are.20errors.html#497313232">(Feb 03 2025 at 01:48)</a>:</h4>
<p>because we go and look up the type associated with the node to see what its layout is</p>



<a name="497313248"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20running%20anyway%20even%20when%20there%20are%20errors/near/497313248" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20running.20anyway.20even.20when.20there.20are.20errors.html#497313248">(Feb 03 2025 at 01:48)</a>:</h4>
<p>and then if the type is a mismatch, instead of getting a layout we replace it with a crash (in theory, although in practice we mess this up often)</p>



<a name="497313257"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20running%20anyway%20even%20when%20there%20are%20errors/near/497313257" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20running.20anyway.20even.20when.20there.20are.20errors.html#497313257">(Feb 03 2025 at 01:48)</a>:</h4>
<p>I don't think this strategy could be done with other forms of dispatch though</p>



<a name="497313258"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20running%20anyway%20even%20when%20there%20are%20errors/near/497313258" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20running.20anyway.20even.20when.20there.20are.20errors.html#497313258">(Feb 03 2025 at 01:48)</a>:</h4>
<p>In the interpreter, we would instead do it when calling a function (cause we know the concrete types for that call at that point)?</p>



<a name="497313269"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20running%20anyway%20even%20when%20there%20are%20errors/near/497313269" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20running.20anyway.20even.20when.20there.20are.20errors.html#497313269">(Feb 03 2025 at 01:49)</a>:</h4>
<p>it relies on the fact that once we hit a type mismatch in solving, we know it's game over</p>



<a name="497313327"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20running%20anyway%20even%20when%20there%20are%20errors/near/497313327" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20running.20anyway.20even.20when.20there.20are.20errors.html#497313327">(Feb 03 2025 at 01:49)</a>:</h4>
<p>I'm proposing that we do one more pass before we run the interpreter</p>



<a name="497313330"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20running%20anyway%20even%20when%20there%20are%20errors/near/497313330" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20running.20anyway.20even.20when.20there.20are.20errors.html#497313330">(Feb 03 2025 at 01:49)</a>:</h4>
<p>after type checking has completed</p>



<a name="497313339"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20running%20anyway%20even%20when%20there%20are%20errors/near/497313339" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20running.20anyway.20even.20when.20there.20are.20errors.html#497313339">(Feb 03 2025 at 01:50)</a>:</h4>
<p>and in that pass we go fixup some canonical IR nodes</p>



<a name="497313382"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20running%20anyway%20even%20when%20there%20are%20errors/near/497313382" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20running.20anyway.20even.20when.20there.20are.20errors.html#497313382">(Feb 03 2025 at 01:50)</a>:</h4>
<p>to replace them with <code>crash</code> nodes</p>



<a name="497313400"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20running%20anyway%20even%20when%20there%20are%20errors/near/497313400" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20running.20anyway.20even.20when.20there.20are.20errors.html#497313400">(Feb 03 2025 at 01:50)</a>:</h4>
<p>so the interpreter just encounters them and says "oh, a <code>crash</code>, I guess I will crash"</p>



<a name="497313485"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20running%20anyway%20even%20when%20there%20are%20errors/near/497313485" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20running.20anyway.20even.20when.20there.20are.20errors.html#497313485">(Feb 03 2025 at 01:51)</a>:</h4>
<p>How does that work for a function that is called with 4 different specializations?</p>



<a name="497313505"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20running%20anyway%20even%20when%20there%20are%20errors/near/497313505" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20running.20anyway.20even.20when.20there.20are.20errors.html#497313505">(Feb 03 2025 at 01:52)</a>:</h4>
<p>Like each specialization might or might not have the crash</p>



<a name="497313548"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20running%20anyway%20even%20when%20there%20are%20errors/near/497313548" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20running.20anyway.20even.20when.20there.20are.20errors.html#497313548">(Feb 03 2025 at 01:52)</a>:</h4>
<p>they'll all have it for sure</p>



<a name="497313558"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20running%20anyway%20even%20when%20there%20are%20errors/near/497313558" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20running.20anyway.20even.20when.20there.20are.20errors.html#497313558">(Feb 03 2025 at 01:52)</a>:</h4>
<p>type mismatches apply before specializations</p>



<a name="497313581"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20running%20anyway%20even%20when%20there%20are%20errors/near/497313581" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20running.20anyway.20even.20when.20there.20are.20errors.html#497313581">(Feb 03 2025 at 01:52)</a>:</h4>
<p>it's not possible in Roc to have a type mismatch for one specialization but not others</p>



<a name="497313587"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20running%20anyway%20even%20when%20there%20are%20errors/near/497313587" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20running.20anyway.20even.20when.20there.20are.20errors.html#497313587">(Feb 03 2025 at 01:52)</a>:</h4>
<p>like it would happen at the call site</p>



<a name="497313591"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20running%20anyway%20even%20when%20there%20are%20errors/near/497313591" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20running.20anyway.20even.20when.20there.20are.20errors.html#497313591">(Feb 03 2025 at 01:52)</a>:</h4>
<p>either that call site is busted or it isn't</p>



<a name="497313605"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20running%20anyway%20even%20when%20there%20are%20errors/near/497313605" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20running.20anyway.20even.20when.20there.20are.20errors.html#497313605">(Feb 03 2025 at 01:53)</a>:</h4>
<p>Oh, then sounds like in general type checking can just change the the node to a crash?</p>



<a name="497313614"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20running%20anyway%20even%20when%20there%20are%20errors/near/497313614" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20running.20anyway.20even.20when.20there.20are.20errors.html#497313614">(Feb 03 2025 at 01:53)</a>:</h4>
<p>yeah exactly</p>



<a name="497313641"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20running%20anyway%20even%20when%20there%20are%20errors/near/497313641" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20running.20anyway.20even.20when.20there.20are.20errors.html#497313641">(Feb 03 2025 at 01:53)</a>:</h4>
<p>Yeah, sounds reasonable to fold into type checking or a pass right after.</p>



<a name="497313756"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20running%20anyway%20even%20when%20there%20are%20errors/near/497313756" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20running.20anyway.20even.20when.20there.20are.20errors.html#497313756">(Feb 03 2025 at 01:54)</a>:</h4>
<p>yeah I think we'd want to do it right after because:</p>
<ul>
<li>if you're just doing <code>roc check</code> or editor analysis, fixing up the canonical IR is a waste of time</li>
<li>to keep the pass isolated, it would be best if type-checking didn't have a direct dependency on canonical IR</li>
</ul>



<a name="497313782"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20running%20anyway%20even%20when%20there%20are%20errors/near/497313782" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20running.20anyway.20even.20when.20there.20are.20errors.html#497313782">(Feb 03 2025 at 01:55)</a>:</h4>
<p>What about static dispatch?</p>



<a name="497313795"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20running%20anyway%20even%20when%20there%20are%20errors/near/497313795" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20running.20anyway.20even.20when.20there.20are.20errors.html#497313795">(Feb 03 2025 at 01:55)</a>:</h4>
<p>That would depend on the specific arg type for whether or not it is a crash.</p>



<a name="497313851"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20running%20anyway%20even%20when%20there%20are%20errors/near/497313851" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20running.20anyway.20even.20when.20there.20are.20errors.html#497313851">(Feb 03 2025 at 01:56)</a>:</h4>
<p>static dispatch always resolves to the same type</p>



<a name="497313908"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20running%20anyway%20even%20when%20there%20are%20errors/near/497313908" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20running.20anyway.20even.20when.20there.20are.20errors.html#497313908">(Feb 03 2025 at 01:56)</a>:</h4>
<p>one way to think of it is that</p>



<a name="497313923"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20running%20anyway%20even%20when%20there%20are%20errors/near/497313923" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20running.20anyway.20even.20when.20there.20are.20errors.html#497313923">(Feb 03 2025 at 01:56)</a>:</h4>
<p>if you have a language like Elm or OCaml or Haskell</p>



<a name="497313933"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20running%20anyway%20even%20when%20there%20are%20errors/near/497313933" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20running.20anyway.20even.20when.20there.20are.20errors.html#497313933">(Feb 03 2025 at 01:56)</a>:</h4>
<p>they don't monomorphize, there is no specialization pass</p>



<a name="497313939"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20running%20anyway%20even%20when%20there%20are%20errors/near/497313939" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20running.20anyway.20even.20when.20there.20are.20errors.html#497313939">(Feb 03 2025 at 01:56)</a>:</h4>
<p>but of course they still have type mismatches</p>



<a name="497313963"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20running%20anyway%20even%20when%20there%20are%20errors/near/497313963" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20running.20anyway.20even.20when.20there.20are.20errors.html#497313963">(Feb 03 2025 at 01:57)</a>:</h4>
<p>we have specialization, but there's no such thing as a "specialization error"</p>



<a name="497313982"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20running%20anyway%20even%20when%20there%20are%20errors/near/497313982" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20running.20anyway.20even.20when.20there.20are.20errors.html#497313982">(Feb 03 2025 at 01:57)</a>:</h4>
<p>like we don't report compile-time problems in that pass because all the userspace errors occur before that</p>



<a name="497313989"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20running%20anyway%20even%20when%20there%20are%20errors/near/497313989" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20running.20anyway.20even.20when.20there.20are.20errors.html#497313989">(Feb 03 2025 at 01:57)</a>:</h4>
<p>(I guess we can still have bugs in our compiler implementation though haha)</p>



<a name="497313996"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20running%20anyway%20even%20when%20there%20are%20errors/near/497313996" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20running.20anyway.20even.20when.20there.20are.20errors.html#497313996">(Feb 03 2025 at 01:57)</a>:</h4>
<p>so Elm, Haskell, OCaml, and Roc would all implement this feature in the same way</p>



<a name="497314003"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20running%20anyway%20even%20when%20there%20are%20errors/near/497314003" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20running.20anyway.20even.20when.20there.20are.20errors.html#497314003">(Feb 03 2025 at 01:58)</a>:</h4>
<p>If we have this function<br>
<code>fn: x -&gt; U64 where x.len() -&gt; U64</code></p>
<p>At one call sight, it might need to crash due to the type being passed in not having <code>.len()</code> and at another it might run just fine, right?</p>



<a name="497314060"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20running%20anyway%20even%20when%20there%20are%20errors/near/497314060" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20running.20anyway.20even.20when.20there.20are.20errors.html#497314060">(Feb 03 2025 at 01:58)</a>:</h4>
<p>yes, but we'd know that after type-checking</p>



<a name="497314067"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20running%20anyway%20even%20when%20there%20are%20errors/near/497314067" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20running.20anyway.20even.20when.20there.20are.20errors.html#497314067">(Feb 03 2025 at 01:58)</a>:</h4>
<p>we wouldn't need to specialize</p>



<a name="497314082"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20running%20anyway%20even%20when%20there%20are%20errors/near/497314082" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20running.20anyway.20even.20when.20there.20are.20errors.html#497314082">(Feb 03 2025 at 01:58)</a>:</h4>
<p>maybe I should clarify that when I say specialize I'm talking about monomorphization</p>



<a name="497314092"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20running%20anyway%20even%20when%20there%20are%20errors/near/497314092" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20running.20anyway.20even.20when.20there.20are.20errors.html#497314092">(Feb 03 2025 at 01:58)</a>:</h4>
<p>But we now have one call site that runs the crash and another call site that doesn't run the crash.</p>



<a name="497314095"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20running%20anyway%20even%20when%20there%20are%20errors/near/497314095" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20running.20anyway.20even.20when.20there.20are.20errors.html#497314095">(Feb 03 2025 at 01:58)</a>:</h4>
<p>there's also function application, which is arguably a form of specialization, but that's not really the term I hear used for that <span aria-label="big smile" class="emoji emoji-1f604" role="img" title="big smile">:big_smile:</span></p>



<a name="497314102"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20running%20anyway%20even%20when%20there%20are%20errors/near/497314102" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20running.20anyway.20even.20when.20there.20are.20errors.html#497314102">(Feb 03 2025 at 01:59)</a>:</h4>
<p>totally!</p>



<a name="497314115"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20running%20anyway%20even%20when%20there%20are%20errors/near/497314115" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20running.20anyway.20even.20when.20there.20are.20errors.html#497314115">(Feb 03 2025 at 01:59)</a>:</h4>
<p>but we have all the info necessary to do that after type-checking</p>



<a name="497314120"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20running%20anyway%20even%20when%20there%20are%20errors/near/497314120" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20running.20anyway.20even.20when.20there.20are.20errors.html#497314120">(Feb 03 2025 at 01:59)</a>:</h4>
<p>we don't need to perform specialization</p>



<a name="497314127"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20running%20anyway%20even%20when%20there%20are%20errors/near/497314127" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20running.20anyway.20even.20when.20there.20are.20errors.html#497314127">(Feb 03 2025 at 01:59)</a>:</h4>
<p>like Haskell literally has this feature haha</p>



<a name="497314159"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20running%20anyway%20even%20when%20there%20are%20errors/near/497314159" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20running.20anyway.20even.20when.20there.20are.20errors.html#497314159">(Feb 03 2025 at 02:00)</a>:</h4>
<p>and they have ad-hoc polymorphism (typeclasses, not static dispatch, but they both look up implementations based on their type)</p>



<a name="497314221"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20running%20anyway%20even%20when%20there%20are%20errors/near/497314221" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20running.20anyway.20even.20when.20there.20are.20errors.html#497314221">(Feb 03 2025 at 02:00)</a>:</h4>
<p><a href="https://ghc.gitlab.haskell.org/ghc/doc/users_guide/exts/defer_type_errors.html">https://ghc.gitlab.haskell.org/ghc/doc/users_guide/exts/defer_type_errors.html</a></p>



<a name="497314225"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20running%20anyway%20even%20when%20there%20are%20errors/near/497314225" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20running.20anyway.20even.20when.20there.20are.20errors.html#497314225">(Feb 03 2025 at 02:00)</a>:</h4>
<p>Interesting. I trust you, but I definitely don't understand.</p>



<a name="497314278"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20running%20anyway%20even%20when%20there%20are%20errors/near/497314278" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20running.20anyway.20even.20when.20there.20are.20errors.html#497314278">(Feb 03 2025 at 02:00)</a>:</h4>
<p>fair enough, I don't think I'm doing a good job explaining it <span aria-label="sweat smile" class="emoji emoji-1f605" role="img" title="sweat smile">:sweat_smile:</span></p>



<a name="497314287"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20running%20anyway%20even%20when%20there%20are%20errors/near/497314287" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20running.20anyway.20even.20when.20there.20are.20errors.html#497314287">(Feb 03 2025 at 02:00)</a>:</h4>
<p>Ayaz could probably explain it better</p>



<a name="497314308"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20running%20anyway%20even%20when%20there%20are%20errors/near/497314308" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20running.20anyway.20even.20when.20there.20are.20errors.html#497314308">(Feb 03 2025 at 02:00)</a>:</h4>
<p>Oh, I guess you could always generate a <code>.len()</code> that just calls crash for the type that is missing <code>.len()</code></p>



<a name="497316385"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20running%20anyway%20even%20when%20there%20are%20errors/near/497316385" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20running.20anyway.20even.20when.20there.20are.20errors.html#497316385">(Feb 03 2025 at 02:24)</a>:</h4>
<p>well we'd just crash at the call site</p>



<a name="497316395"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20running%20anyway%20even%20when%20there%20are%20errors/near/497316395" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20running.20anyway.20even.20when.20there.20are.20errors.html#497316395">(Feb 03 2025 at 02:24)</a>:</h4>
<p>like replace the call <em>itself</em></p>



<a name="497316396"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20running%20anyway%20even%20when%20there%20are%20errors/near/497316396" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20running.20anyway.20even.20when.20there.20are.20errors.html#497316396">(Feb 03 2025 at 02:24)</a>:</h4>
<p>not the function</p>



<a name="497316403"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20running%20anyway%20even%20when%20there%20are%20errors/near/497316403" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20running.20anyway.20even.20when.20there.20are.20errors.html#497316403">(Feb 03 2025 at 02:24)</a>:</h4>
<p>so when you get to the call, instead of calling anything it just crashes</p>



<a name="497317773"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20running%20anyway%20even%20when%20there%20are%20errors/near/497317773" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20running.20anyway.20even.20when.20there.20are.20errors.html#497317773">(Feb 03 2025 at 02:40)</a>:</h4>
<div class="codehilite" data-code-language="Ruby"><pre><span></span><code><span class="n">main!</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">||</span>
<span class="w">    </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">[]</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"string has no len()"</span>

<span class="w">    </span><span class="n">tmp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fn</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="no">Bool</span><span class="o">.</span><span class="n">true</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">fn</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="no">Bool</span><span class="o">.</span><span class="n">false</span><span class="p">)</span>

<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fn</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="no">Bool</span><span class="o">.</span><span class="n">true</span><span class="p">)</span>

<span class="n">fn</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="no">Bool</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="no">U64</span><span class="w"> </span><span class="n">where</span><span class="w"> </span><span class="n">a</span><span class="o">.</span><span class="n">len</span><span class="p">()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="no">U64</span>
<span class="n">fn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">|</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="o">|</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="k">then</span>
<span class="w">        </span><span class="n">a</span><span class="o">.</span><span class="n">len</span><span class="p">()</span>
<span class="w">    </span><span class="k">else</span>
<span class="w">        </span><span class="mi">0</span>
</code></pre></div>
<p>In the above, the first two calls to <code>fn</code> should pass with no issues. Only on the third call to <code>fn</code> (line with <code>z = ...</code>), it should crash. In this case, the crash should be generated from the line <code>a.len()</code> due to the type of <code>a</code> being a <code>Str</code>.</p>



<a name="497587740"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20running%20anyway%20even%20when%20there%20are%20errors/near/497587740" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20running.20anyway.20even.20when.20there.20are.20errors.html#497587740">(Feb 04 2025 at 05:48)</a>:</h4>
<p>We could/should crash on the second call site because its type is malformed. The type signature doesn’t match the args provided.</p>



<a name="497587908"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20running%20anyway%20even%20when%20there%20are%20errors/near/497587908" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20running.20anyway.20even.20when.20there.20are.20errors.html#497587908">(Feb 04 2025 at 05:50)</a>:</h4>
<p>Yeah, I guess that would be valid.</p>



<hr><p>Last updated: Mar 01 2026 at 12:20 UTC</p>
</html>