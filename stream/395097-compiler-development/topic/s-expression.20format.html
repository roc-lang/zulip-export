<html>
<head><meta charset="utf-8"><title>s-expression format · compiler development · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/index.html">compiler development</a></h2>
<h3>Topic: <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/s-expression.20format.html">s-expression format</a></h3>

<hr>

<base href="https://roc.zulipchat.com">

<head><link href="https://roc-lang.github.io/zulip-export/style.css" rel="stylesheet"></head>

<a name="525485853"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/s-expression%20format/near/525485853" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/s-expression.20format.html#525485853">(Jun 24 2025 at 10:22)</a>:</h4>
<p>I've been down a rabbit hole on the API for our s-expressions... this is what I have so far. </p>
<div class="codehilite" data-code-language="Clojure"><pre><span></span><code><span class="p">(</span><span class="nf">can_ir</span>
<span class="w">    </span><span class="p">(</span><span class="nf">d_let</span><span class="w"> </span><span class="ss">:idx=#87</span>
<span class="w">        </span><span class="p">(</span><span class="nf">p_assign</span><span class="w"> </span><span class="p">(</span><span class="mi">8</span><span class="ss">:1-8:6</span><span class="p">)</span><span class="w"> </span><span class="ss">:ident=</span><span class="s">"main!"</span><span class="w"> </span><span class="ss">:idx=#73</span><span class="p">)</span>
<span class="w">        </span><span class="p">(</span><span class="nf">e_lambda</span><span class="w"> </span><span class="p">(</span><span class="mi">8</span><span class="ss">:9-12:2</span><span class="p">)</span><span class="w"> </span><span class="ss">:idx=#86</span>
<span class="w">            </span><span class="p">(</span><span class="nf">args</span>
<span class="w">                </span><span class="p">(</span><span class="nf">p_underscore</span><span class="w"> </span><span class="p">(</span><span class="mi">8</span><span class="ss">:10-8:11</span><span class="p">)</span><span class="w"> </span><span class="ss">:idx=#74</span><span class="p">))</span>
<span class="w">            </span><span class="p">(</span><span class="nf">e_block</span><span class="w"> </span><span class="p">(</span><span class="mi">8</span><span class="ss">:13-12:2</span><span class="p">)</span>
<span class="w">                </span><span class="p">(</span><span class="nf">s_let</span><span class="w"> </span><span class="p">(</span><span class="mi">9</span><span class="ss">:2-9:17</span><span class="p">)</span>
<span class="w">                    </span><span class="p">(</span><span class="nf">p_assign</span><span class="w"> </span><span class="p">(</span><span class="mi">9</span><span class="ss">:2-9:7</span><span class="p">)</span><span class="w"> </span><span class="ss">:ident=</span><span class="s">"world"</span><span class="w"> </span><span class="ss">:idx=#75</span><span class="p">)</span>
<span class="w">                    </span><span class="p">(</span><span class="nf">e_string</span><span class="w"> </span><span class="p">(</span><span class="mi">9</span><span class="ss">:10-9:17</span><span class="p">)</span><span class="w"> </span><span class="ss">:idx=#77</span>
<span class="w">                        </span><span class="p">(</span><span class="nf">e_literal</span><span class="w"> </span><span class="p">(</span><span class="mi">9</span><span class="ss">:11-9:16</span><span class="p">)</span><span class="w"> </span><span class="ss">:string=</span><span class="s">"World"</span><span class="p">)))</span>
<span class="w">                </span><span class="p">(</span><span class="nf">e_call</span><span class="w"> </span><span class="p">(</span><span class="mi">11</span><span class="ss">:2-11:31</span><span class="p">)</span>
<span class="w">                    </span><span class="p">(</span><span class="nf">e_lookup_external</span>
<span class="w">                        </span><span class="p">(</span><span class="nf">ext_decl</span><span class="w"> </span><span class="p">(</span><span class="mi">11</span><span class="ss">:2-11:14</span><span class="p">)</span><span class="w"> </span><span class="ss">:qualified=</span><span class="s">"pf.Stdout.line!"</span><span class="w"> </span><span class="ss">:module=</span><span class="s">"pf.Stdout"</span><span class="w"> </span><span class="ss">:local=</span><span class="s">"line!"</span><span class="w"> </span><span class="ss">:kind=</span><span class="s">"value"</span><span class="w"> </span><span class="ss">:type_var=#79</span><span class="p">))</span>
<span class="w">                    </span><span class="p">(</span><span class="nf">e_string</span><span class="w"> </span><span class="p">(</span><span class="mi">11</span><span class="ss">:15-11:30</span><span class="p">)</span>
<span class="w">                        </span><span class="p">(</span><span class="nf">e_literal</span><span class="w"> </span><span class="p">(</span><span class="mi">11</span><span class="ss">:16-11:29</span><span class="p">)</span><span class="w"> </span><span class="ss">:string=</span><span class="s">"Hello, world!"</span><span class="p">))))))</span>
<span class="w">    </span><span class="p">(</span><span class="nf">s_import</span><span class="w"> </span><span class="p">(</span><span class="mi">6</span><span class="ss">:1-6:17</span><span class="p">)</span><span class="w"> </span><span class="ss">:module=</span><span class="s">"pf.Stdout"</span><span class="w"> </span><span class="ss">:idx=#72</span>
<span class="w">        </span><span class="p">(</span><span class="nf">exposes</span><span class="p">)))</span>
</code></pre></div>



<a name="525486033"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/s-expression%20format/near/525486033" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/s-expression.20format.html#525486033">(Jun 24 2025 at 10:23)</a>:</h4>
<p>I'm trying to make it easier to read and clearer by adding attributes <code>:name=value</code> to nodes instead of just hardcore nesting</p>



<a name="525486245"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/s-expression%20format/near/525486245" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/s-expression.20format.html#525486245">(Jun 24 2025 at 10:24)</a>:</h4>
<p>Doing this simplifies the rule for newlines, basically one for each child</p>



<a name="525486568"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/s-expression%20format/near/525486568" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/s-expression.20format.html#525486568">(Jun 24 2025 at 10:27)</a>:</h4>
<p>why is <code>:ident="main!"</code> better than <code>(ident "main!")</code>?</p>



<a name="525487345"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/s-expression%20format/near/525487345" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/s-expression.20format.html#525487345">(Jun 24 2025 at 10:32)</a>:</h4>
<p>It would seem that the newline rule should be a newline for each child node, and all attribute nodes are first and on the same line as the tag for the sexpr</p>
<div class="codehilite" data-code-language="Clojure"><pre><span></span><code><span class="p">(</span><span class="nf">tag</span><span class="w"> </span><span class="p">(</span><span class="nf">line</span><span class="ss">:col-line:col</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nf">attr1</span><span class="w"> </span><span class="nv">val</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nf">attr2</span><span class="w"> </span><span class="nv">val</span><span class="p">)</span><span class="w"> </span><span class="nv">...</span>
<span class="w">    </span><span class="p">(</span><span class="nf">child_1_tag</span><span class="w"> </span><span class="p">(</span><span class="nf">line</span><span class="ss">:col-line:col</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nf">attr1</span><span class="w"> </span><span class="nv">val</span><span class="p">)</span><span class="w"> </span><span class="nv">...</span>
<span class="w">    </span><span class="p">(</span><span class="nf">child_2_tag</span><span class="p">)</span><span class="w"> </span><span class="nv">...</span>
<span class="w">    </span><span class="nv">...</span><span class="p">)</span>
</code></pre></div>



<a name="525487461"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/s-expression%20format/near/525487461" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/s-expression.20format.html#525487461">(Jun 24 2025 at 10:33)</a>:</h4>
<blockquote>
<p>It would seem that the newline rule should be a newline for each child node, and all attribute nodes are first and on the same line as the tag for the sexpr</p>
</blockquote>
<p>This was the key change... I'll give the formatting a go with parens again</p>



<a name="525487568"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/s-expression%20format/near/525487568" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/s-expression.20format.html#525487568">(Jun 24 2025 at 10:33)</a>:</h4>
<p>I would probably go full sexpr and have no custom microformats to parse</p>
<div class="codehilite" data-code-language="Clojure"><pre><span></span><code><span class="p">(</span><span class="nf">tag</span><span class="w"> </span><span class="p">(</span><span class="nf">line</span><span class="w"> </span><span class="nv">col</span><span class="w"> </span><span class="nv">line</span><span class="w"> </span><span class="nv">col</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nf">attr1</span><span class="w"> </span><span class="nv">val</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nf">attr2</span><span class="w"> </span><span class="nv">val</span><span class="p">)</span><span class="w"> </span><span class="nv">...</span>
<span class="w">    </span><span class="p">(</span><span class="nf">child_1_tag</span><span class="w"> </span><span class="p">(</span><span class="nf">line</span><span class="w"> </span><span class="nv">col</span><span class="w"> </span><span class="nv">line</span><span class="w"> </span><span class="nv">col</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nf">attr1</span><span class="w"> </span><span class="nv">val</span><span class="p">)</span><span class="w"> </span><span class="nv">...</span>
<span class="w">    </span><span class="p">(</span><span class="nf">child_2_tag</span><span class="p">)</span><span class="w"> </span><span class="nv">...</span>
<span class="w">    </span><span class="nv">...</span><span class="p">)</span>
</code></pre></div>



<a name="525487610"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/s-expression%20format/near/525487610" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/s-expression.20format.html#525487610">(Jun 24 2025 at 10:34)</a>:</h4>
<div class="codehilite" data-code-language="Clojure"><pre><span></span><code><span class="p">(</span><span class="nf">can_ir</span>
<span class="w">    </span><span class="p">(</span><span class="nf">d_let</span><span class="w"> </span><span class="p">(</span><span class="nf">idx</span><span class="w"> </span><span class="o">#</span><span class="mi">87</span><span class="p">)</span>
<span class="w">        </span><span class="p">(</span><span class="nf">p_assign</span><span class="w"> </span><span class="p">(</span><span class="mi">8</span><span class="ss">:1-8:6</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nf">ident</span><span class="w"> </span><span class="s">"main!"</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nf">idx</span><span class="w"> </span><span class="o">#</span><span class="mi">73</span><span class="p">))</span>
<span class="w">        </span><span class="p">(</span><span class="nf">e_lambda</span><span class="w"> </span><span class="p">(</span><span class="mi">8</span><span class="ss">:9-12:2</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nf">idx</span><span class="w"> </span><span class="o">#</span><span class="mi">86</span><span class="p">)</span>
<span class="w">            </span><span class="p">(</span><span class="nf">args</span>
<span class="w">                </span><span class="p">(</span><span class="nf">p_underscore</span><span class="w"> </span><span class="p">(</span><span class="mi">8</span><span class="ss">:10-8:11</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nf">idx</span><span class="w"> </span><span class="o">#</span><span class="mi">74</span><span class="p">)))</span>
<span class="w">            </span><span class="p">(</span><span class="nf">e_block</span><span class="w"> </span><span class="p">(</span><span class="mi">8</span><span class="ss">:13-12:2</span><span class="p">)</span>
<span class="w">                </span><span class="p">(</span><span class="nf">s_let</span><span class="w"> </span><span class="p">(</span><span class="mi">9</span><span class="ss">:2-9:17</span><span class="p">)</span>
<span class="w">                    </span><span class="p">(</span><span class="nf">p_assign</span><span class="w"> </span><span class="p">(</span><span class="mi">9</span><span class="ss">:2-9:7</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nf">ident</span><span class="w"> </span><span class="s">"world"</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nf">idx</span><span class="w"> </span><span class="o">#</span><span class="mi">75</span><span class="p">))</span>
<span class="w">                    </span><span class="p">(</span><span class="nf">e_string</span><span class="w"> </span><span class="p">(</span><span class="mi">9</span><span class="ss">:10-9:17</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nf">idx</span><span class="w"> </span><span class="o">#</span><span class="mi">77</span><span class="p">)</span>
<span class="w">                        </span><span class="p">(</span><span class="nf">e_literal</span><span class="w"> </span><span class="p">(</span><span class="mi">9</span><span class="ss">:11-9:16</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nf">string</span><span class="w"> </span><span class="s">"World"</span><span class="p">))))</span>
<span class="w">                </span><span class="p">(</span><span class="nf">e_call</span><span class="w"> </span><span class="p">(</span><span class="mi">11</span><span class="ss">:2-11:31</span><span class="p">)</span>
<span class="w">                    </span><span class="p">(</span><span class="nf">e_lookup_external</span>
<span class="w">                        </span><span class="p">(</span><span class="nf">ext_decl</span><span class="w"> </span><span class="p">(</span><span class="mi">11</span><span class="ss">:2-11:14</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nf">qualified</span><span class="w"> </span><span class="s">"pf.Stdout.line!"</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nf">module</span><span class="w"> </span><span class="s">"pf.Stdout"</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nf">local</span><span class="w"> </span><span class="s">"line!"</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nf">kind</span><span class="w"> </span><span class="s">"value"</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nf">type_var</span><span class="w"> </span><span class="o">#</span><span class="mi">79</span><span class="p">)))</span>
<span class="w">                    </span><span class="p">(</span><span class="nf">e_string</span><span class="w"> </span><span class="p">(</span><span class="mi">11</span><span class="ss">:15-11:30</span><span class="p">)</span>
<span class="w">                        </span><span class="p">(</span><span class="nf">e_literal</span><span class="w"> </span><span class="p">(</span><span class="mi">11</span><span class="ss">:16-11:29</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nf">string</span><span class="w"> </span><span class="s">"Hello, world!"</span><span class="p">)))))))</span>
<span class="w">    </span><span class="p">(</span><span class="nf">s_import</span><span class="w"> </span><span class="p">(</span><span class="mi">6</span><span class="ss">:1-6:17</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nf">module</span><span class="w"> </span><span class="s">"pf.Stdout"</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nf">idx</span><span class="w"> </span><span class="o">#</span><span class="mi">72</span><span class="p">)</span>
<span class="w">        </span><span class="p">(</span><span class="nf">exposes</span><span class="p">)))</span>
</code></pre></div>



<a name="525487670"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/s-expression%20format/near/525487670" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/s-expression.20format.html#525487670">(Jun 24 2025 at 10:34)</a>:</h4>
<p>ok, i don't think the # is necessary</p>



<a name="525487803"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/s-expression%20format/near/525487803" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/s-expression.20format.html#525487803">(Jun 24 2025 at 10:35)</a>:</h4>
<div class="codehilite" data-code-language="Clojure"><pre><span></span><code><span class="p">(</span><span class="nf">can_ir</span>
<span class="w">    </span><span class="p">(</span><span class="nf">d_let</span><span class="w"> </span><span class="p">(</span><span class="nf">id</span><span class="w"> </span><span class="mi">87</span><span class="p">)</span>
<span class="w">        </span><span class="p">(</span><span class="nf">p_assign</span><span class="w"> </span><span class="p">(</span><span class="mi">8</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="mi">8</span><span class="w"> </span><span class="mi">6</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nf">ident</span><span class="w"> </span><span class="s">"main!"</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nf">id</span><span class="w"> </span><span class="mi">73</span><span class="p">))</span>
<span class="w">        </span><span class="p">(</span><span class="nf">e_lambda</span><span class="w"> </span><span class="p">(</span><span class="mi">8</span><span class="w"> </span><span class="mi">9</span><span class="w"> </span><span class="mi">12</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nf">id</span><span class="w"> </span><span class="mi">86</span><span class="p">)</span>
<span class="w">            </span><span class="p">(</span><span class="nf">args</span>
<span class="w">                </span><span class="p">(</span><span class="nf">p_underscore</span><span class="w"> </span><span class="p">(</span><span class="mi">8</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="mi">8</span><span class="w"> </span><span class="mi">11</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nf">id</span><span class="w"> </span><span class="mi">74</span><span class="p">)))</span>
<span class="w">            </span><span class="p">(</span><span class="nf">e_block</span><span class="w"> </span><span class="p">(</span><span class="mi">8</span><span class="w"> </span><span class="mi">13</span><span class="w"> </span><span class="mi">12</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span>
<span class="w">                </span><span class="p">(</span><span class="nf">s_let</span><span class="w"> </span><span class="p">(</span><span class="mi">9</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">9</span><span class="w"> </span><span class="mi">17</span><span class="p">)</span>
<span class="w">                    </span><span class="p">(</span><span class="nf">p_assign</span><span class="w"> </span><span class="p">(</span><span class="mi">9</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">9</span><span class="w"> </span><span class="mi">7</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nf">ident</span><span class="w"> </span><span class="s">"world"</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nf">id</span><span class="w"> </span><span class="mi">75</span><span class="p">))</span>
<span class="w">                    </span><span class="p">(</span><span class="nf">e_string</span><span class="w"> </span><span class="p">(</span><span class="mi">9</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="mi">9</span><span class="w"> </span><span class="mi">17</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nf">id</span><span class="w"> </span><span class="mi">77</span><span class="p">)</span>
<span class="w">                        </span><span class="p">(</span><span class="nf">e_literal</span><span class="w"> </span><span class="p">(</span><span class="mi">9</span><span class="w"> </span><span class="mi">11</span><span class="w"> </span><span class="mi">9</span><span class="w"> </span><span class="mi">16</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nf">string</span><span class="w"> </span><span class="s">"World"</span><span class="p">))))</span>
<span class="w">                </span><span class="p">(</span><span class="nf">e_call</span><span class="w"> </span><span class="p">(</span><span class="mi">11</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">11</span><span class="w"> </span><span class="mi">31</span><span class="p">)</span>
<span class="w">                    </span><span class="p">(</span><span class="nf">e_lookup_external</span>
<span class="w">                        </span><span class="p">(</span><span class="nf">ext_decl</span><span class="w"> </span><span class="p">(</span><span class="mi">11</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">11</span><span class="w"> </span><span class="mi">14</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nf">qualified</span><span class="w"> </span><span class="s">"pf.Stdout.line!"</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nf">module</span><span class="w"> </span><span class="s">"pf.Stdout"</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nf">local</span><span class="w"> </span><span class="s">"line!"</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nf">kind</span><span class="w"> </span><span class="s">"value"</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nf">type_var</span><span class="w"> </span><span class="mi">79</span><span class="p">)))</span>
<span class="w">                    </span><span class="p">(</span><span class="nf">e_string</span><span class="w"> </span><span class="p">(</span><span class="mi">11</span><span class="w"> </span><span class="mi">15</span><span class="w"> </span><span class="mi">11</span><span class="w"> </span><span class="mi">30</span><span class="p">)</span>
<span class="w">                        </span><span class="p">(</span><span class="nf">e_literal</span><span class="w"> </span><span class="p">(</span><span class="mi">11</span><span class="w"> </span><span class="mi">16</span><span class="w"> </span><span class="mi">11</span><span class="w"> </span><span class="mi">29</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nf">string</span><span class="w"> </span><span class="s">"Hello, world!"</span><span class="p">)))))))</span>
<span class="w">    </span><span class="p">(</span><span class="nf">s_import</span><span class="w"> </span><span class="p">(</span><span class="mi">6</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="mi">6</span><span class="w"> </span><span class="mi">17</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nf">module</span><span class="w"> </span><span class="s">"pf.Stdout"</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nf">id</span><span class="w"> </span><span class="mi">72</span><span class="p">)</span>
<span class="w">        </span><span class="p">(</span><span class="nf">exposes</span><span class="p">)))</span>
</code></pre></div>



<a name="525487848"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/s-expression%20format/near/525487848" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Notification Bot <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/s-expression.20format.html#525487848">(Jun 24 2025 at 10:35)</a>:</h4>
<p>10 messages were moved here from <a class="stream-topic" data-stream-id="395097" href="/#narrow/channel/395097-compiler-development/topic/casual.20conversation/with/373264697">#compiler development &gt; casual conversation</a> by <span class="user-mention silent" data-user-id="515757">Luke Boswell</span>.</p>



<a name="525488048"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/s-expression%20format/near/525488048" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/s-expression.20format.html#525488048">(Jun 24 2025 at 10:37)</a>:</h4>
<p>Maybe tag the Pos node and put the line/col pairs in <code>()</code>s?  Like <code>(pos (6 1) (6 17))</code>?</p>



<a name="525488072"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/s-expression%20format/near/525488072" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/s-expression.20format.html#525488072">(Jun 24 2025 at 10:37)</a>:</h4>
<p>It's an improvement over the current I think <a href="https://github.com/roc-lang/roc/blob/main/src/snapshots/hello_world_with_block.md#canonicalize">https://github.com/roc-lang/roc/blob/main/src/snapshots/hello_world_with_block.md#canonicalize</a></p>



<a name="525488155"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/s-expression%20format/near/525488155" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/s-expression.20format.html#525488155">(Jun 24 2025 at 10:37)</a>:</h4>
<p>Definitely</p>



<a name="525488299"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/s-expression%20format/near/525488299" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/s-expression.20format.html#525488299">(Jun 24 2025 at 10:39)</a>:</h4>
<p>you want to do the least amount of parsing possible, while it still being readable to someone unfamiliar with the specific format (but who has a base level of understanding of sexpr)</p>



<a name="525488376"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/s-expression%20format/near/525488376" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/s-expression.20format.html#525488376">(Jun 24 2025 at 10:39)</a>:</h4>
<p>I'm thinking something custom for Region's is unnavoidable</p>



<a name="525488411"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/s-expression%20format/near/525488411" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/s-expression.20format.html#525488411">(Jun 24 2025 at 10:39)</a>:</h4>
<p>are we saving the ids so that we can recover the IR from the Sexpr representation?</p>



<a name="525488481"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/s-expression%20format/near/525488481" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/s-expression.20format.html#525488481">(Jun 24 2025 at 10:40)</a>:</h4>
<p>I got a bit carried away there. Only some nodes (patterns I think?) need to show them.</p>



<a name="525488585"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/s-expression%20format/near/525488585" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/s-expression.20format.html#525488585">(Jun 24 2025 at 10:40)</a>:</h4>
<p>Other nodes reference them by NodeIdx. Also TypeVars are NodeIdx's</p>



<a name="525488696"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/s-expression%20format/near/525488696" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/s-expression.20format.html#525488696">(Jun 24 2025 at 10:41)</a>:</h4>
<p>I figure any node that is referenced (or could be) by another probably should show it's id</p>



<a name="525488769"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/s-expression%20format/near/525488769" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/s-expression.20format.html#525488769">(Jun 24 2025 at 10:41)</a>:</h4>
<p>I'm just trying to understand if that's useful for debugging</p>



<a name="525488782"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/s-expression%20format/near/525488782" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/s-expression.20format.html#525488782">(Jun 24 2025 at 10:41)</a>:</h4>
<p>I don't know though... just experimenting with it</p>



<a name="525488945"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/s-expression%20format/near/525488945" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/s-expression.20format.html#525488945">(Jun 24 2025 at 10:42)</a>:</h4>
<p>I guess we use the Region info to map back to the source, and the type information will reference a pattern in a declaration maybe.</p>



<a name="525488948"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/s-expression%20format/near/525488948" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/s-expression.20format.html#525488948">(Jun 24 2025 at 10:42)</a>:</h4>
<p>Ok, as far as region you can just have it be a standard s-expr symbol if you start with <code>@</code></p>



<a name="525489035"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/s-expression%20format/near/525489035" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/s-expression.20format.html#525489035">(Jun 24 2025 at 10:43)</a>:</h4>
<p>How?</p>



<a name="525489116"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/s-expression%20format/near/525489116" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/s-expression.20format.html#525489116">(Jun 24 2025 at 10:43)</a>:</h4>
<p><code>@6!1-6!17</code> is a valid S-expr symbol</p>



<a name="525489145"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/s-expression%20format/near/525489145" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/s-expression.20format.html#525489145">(Jun 24 2025 at 10:44)</a>:</h4>
<p>And that can just be an atom</p>



<a name="525489353"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/s-expression%20format/near/525489353" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/s-expression.20format.html#525489353">(Jun 24 2025 at 10:45)</a>:</h4>
<p>I think @ is helpful for understanding that it's a region (or related to where it's "at")</p>



<a name="525489390"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/s-expression%20format/near/525489390" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/s-expression.20format.html#525489390">(Jun 24 2025 at 10:45)</a>:</h4>
<div class="codehilite" data-code-language="Clojure"><pre><span></span><code><span class="p">(</span><span class="nf">can_ir</span>
<span class="w">    </span><span class="p">(</span><span class="nf">d_let</span><span class="w"> </span><span class="p">(</span><span class="nf">id</span><span class="w"> </span><span class="mi">87</span><span class="p">)</span>
<span class="w">        </span><span class="p">(</span><span class="nf">p_assign</span><span class="w"> </span><span class="o">@</span><span class="mi">8</span><span class="nv">!1-8!6</span><span class="w"> </span><span class="p">(</span><span class="nf">ident</span><span class="w"> </span><span class="s">"main!"</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nf">id</span><span class="w"> </span><span class="mi">73</span><span class="p">))</span>
<span class="w">        </span><span class="p">(</span><span class="nf">e_lambda</span><span class="w"> </span><span class="o">@</span><span class="mi">8</span><span class="nv">!9-12!2</span><span class="w"> </span><span class="p">(</span><span class="nf">id</span><span class="w"> </span><span class="mi">86</span><span class="p">)</span>
<span class="w">            </span><span class="p">(</span><span class="nf">args</span>
<span class="w">                </span><span class="p">(</span><span class="nf">p_underscore</span><span class="w"> </span><span class="o">@</span><span class="mi">8</span><span class="nv">!10-8!11</span><span class="w"> </span><span class="p">(</span><span class="nf">id</span><span class="w"> </span><span class="mi">74</span><span class="p">)))</span>
<span class="w">            </span><span class="p">(</span><span class="nf">e_block</span><span class="w"> </span><span class="o">@</span><span class="mi">8</span><span class="nv">!13-12!2</span>
<span class="w">                </span><span class="p">(</span><span class="nf">s_let</span><span class="w"> </span><span class="o">@</span><span class="mi">9</span><span class="nv">!2-9!17</span>
<span class="w">                    </span><span class="p">(</span><span class="nf">p_assign</span><span class="w"> </span><span class="o">@</span><span class="mi">9</span><span class="nv">!2-9!7</span><span class="w"> </span><span class="p">(</span><span class="nf">ident</span><span class="w"> </span><span class="s">"world"</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nf">id</span><span class="w"> </span><span class="mi">75</span><span class="p">))</span>
<span class="w">                    </span><span class="p">(</span><span class="nf">e_string</span><span class="w"> </span><span class="o">@</span><span class="mi">9</span><span class="nv">!10-9!17</span><span class="w"> </span><span class="p">(</span><span class="nf">id</span><span class="w"> </span><span class="mi">77</span><span class="p">)</span>
<span class="w">                        </span><span class="p">(</span><span class="nf">e_literal</span><span class="w"> </span><span class="o">@</span><span class="mi">9</span><span class="nv">!11-9!16</span><span class="w"> </span><span class="p">(</span><span class="nf">string</span><span class="w"> </span><span class="s">"World"</span><span class="p">))))</span>
<span class="w">                </span><span class="p">(</span><span class="nf">e_call</span><span class="w"> </span><span class="o">@</span><span class="mi">11</span><span class="nv">!2-11!31</span>
<span class="w">                    </span><span class="p">(</span><span class="nf">e_lookup_external</span>
<span class="w">                        </span><span class="p">(</span><span class="nf">ext_decl</span><span class="w"> </span><span class="o">@</span><span class="mi">11</span><span class="nv">!2-11!14</span><span class="w"> </span><span class="p">(</span><span class="nf">qualified</span><span class="w"> </span><span class="s">"pf.Stdout.line!"</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nf">module</span><span class="w"> </span><span class="s">"pf.Stdout"</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nf">local</span><span class="w"> </span><span class="s">"line!"</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nf">kind</span><span class="w"> </span><span class="s">"value"</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nf">type_var</span><span class="w"> </span><span class="mi">79</span><span class="p">)))</span>
<span class="w">                    </span><span class="p">(</span><span class="nf">e_string</span><span class="w"> </span><span class="o">@</span><span class="mi">11</span><span class="nv">!15-11!30</span>
<span class="w">                        </span><span class="p">(</span><span class="nf">e_literal</span><span class="w"> </span><span class="o">@</span><span class="mi">11</span><span class="nv">!16-11!29</span><span class="w"> </span><span class="p">(</span><span class="nf">string</span><span class="w"> </span><span class="s">"Hello, world!"</span><span class="p">)))))))</span>
<span class="w">    </span><span class="p">(</span><span class="nf">s_import</span><span class="w"> </span><span class="o">@</span><span class="mi">6</span><span class="nv">!1-6!17</span><span class="w"> </span><span class="p">(</span><span class="nf">module</span><span class="w"> </span><span class="s">"pf.Stdout"</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nf">id</span><span class="w"> </span><span class="mi">72</span><span class="p">)</span>
<span class="w">        </span><span class="p">(</span><span class="nf">exposes</span><span class="p">)))</span>
</code></pre></div>



<a name="525489397"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/s-expression%20format/near/525489397" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/s-expression.20format.html#525489397">(Jun 24 2025 at 10:45)</a>:</h4>
<p>But unfortunately <code>:</code> is not usually valid there</p>



<a name="525489463"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/s-expression%20format/near/525489463" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/s-expression.20format.html#525489463">(Jun 24 2025 at 10:46)</a>:</h4>
<p>Hmm.  I'm surprised with the syntax highlighting</p>



<a name="525489513"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/s-expression%20format/near/525489513" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/s-expression.20format.html#525489513">(Jun 24 2025 at 10:46)</a>:</h4>
<p>Maybe (@ (8 1) (8 16)) is better?</p>



<a name="525489535"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/s-expression%20format/near/525489535" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/s-expression.20format.html#525489535">(Jun 24 2025 at 10:47)</a>:</h4>
<p>Yeah I'm trying to find something nice</p>



<a name="525489660"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/s-expression%20format/near/525489660" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/s-expression.20format.html#525489660">(Jun 24 2025 at 10:47)</a>:</h4>
<p>What about this?</p>
<div class="codehilite" data-code-language="Clojure"><pre><span></span><code><span class="p">(</span><span class="nf">p_assign</span><span class="w"> </span><span class="o">@</span><span class="mi">8-1-8-6</span><span class="w"> </span><span class="p">(</span><span class="nf">ident</span><span class="w"> </span><span class="s">"main!"</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nf">id</span><span class="w"> </span><span class="mi">73</span><span class="p">))</span>
</code></pre></div>



<a name="525490216"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/s-expression%20format/near/525490216" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/s-expression.20format.html#525490216">(Jun 24 2025 at 10:51)</a>:</h4>
<p>I think that's my favourite so far.</p>



<a name="525490333"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/s-expression%20format/near/525490333" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/s-expression.20format.html#525490333">(Jun 24 2025 at 10:52)</a>:</h4>
<p>That looks fine to me</p>
<div class="codehilite" data-code-language="Scheme"><pre><span></span><code><span class="p">(</span><span class="nf">p_assign</span><span class="w"> </span><span class="nv">@8-1-8-6</span><span class="w"> </span><span class="p">(</span><span class="nf">ident</span><span class="w"> </span><span class="s">"main!"</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nf">id</span><span class="w"> </span><span class="mi">73</span><span class="p">))</span>
</code></pre></div>



<a name="525490448"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/s-expression%20format/near/525490448" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/s-expression.20format.html#525490448">(Jun 24 2025 at 10:52)</a>:</h4>
<p>Just the smallest of comments here, but canonically, sexpr symbols should be in kebab case, not snake</p>



<a name="525490547"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/s-expression%20format/near/525490547" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/s-expression.20format.html#525490547">(Jun 24 2025 at 10:53)</a>:</h4>
<p>but if we are using the string value of a zig tag directly, it might not be worth a conversion</p>



<a name="525491041"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/s-expression%20format/near/525491041" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/s-expression.20format.html#525491041">(Jun 24 2025 at 10:56)</a>:</h4>
<p>I might do a pass through each s-expr node and change that as I go.</p>



<a name="525491882"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/s-expression%20format/near/525491882" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/s-expression.20format.html#525491882">(Jun 24 2025 at 11:02)</a>:</h4>
<p>up to you, just calling it out</p>



<a name="525491935"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/s-expression%20format/near/525491935" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/s-expression.20format.html#525491935">(Jun 24 2025 at 11:02)</a>:</h4>
<p>you've been doing a great job with these and the snapshots!</p>



<a name="525493166"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/s-expression%20format/near/525493166" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/s-expression.20format.html#525493166">(Jun 24 2025 at 11:10)</a>:</h4>
<p>Here's an updated PARSE section</p>
<div class="codehilite" data-code-language="Clojure"><pre><span></span><code><span class="p">(</span><span class="nf">app</span><span class="w"> </span><span class="o">@</span><span class="mi">1-1-3-57</span>
<span class="w">    </span><span class="p">(</span><span class="nf">provides</span><span class="w"> </span><span class="o">@</span><span class="mi">2-3-2-10</span>
<span class="w">        </span><span class="p">(</span><span class="nf">exposed-lower-ident</span><span class="w"> </span><span class="p">(</span><span class="nf">text</span><span class="w"> </span><span class="s">"main!"</span><span class="p">)))</span>
<span class="w">    </span><span class="p">(</span><span class="nf">record-field</span><span class="w"> </span><span class="o">@</span><span class="mi">3-28-3-55</span><span class="w"> </span><span class="p">(</span><span class="nb">name </span><span class="s">"pf"</span><span class="p">)</span>
<span class="w">        </span><span class="p">(</span><span class="nf">e-string</span><span class="w"> </span><span class="o">@</span><span class="mi">3-41-3-54</span>
<span class="w">            </span><span class="p">(</span><span class="nf">e-string-part</span><span class="w"> </span><span class="o">@</span><span class="mi">3-42-3-53</span><span class="w"> </span><span class="p">(</span><span class="nf">raw</span><span class="w"> </span><span class="s">"../main.roc"</span><span class="p">))))</span>
<span class="w">    </span><span class="p">(</span><span class="nf">packages</span><span class="w"> </span><span class="o">@</span><span class="mi">3-2-3-57</span>
<span class="w">        </span><span class="p">(</span><span class="nf">record-field</span><span class="w"> </span><span class="o">@</span><span class="mi">3-4-3-27</span><span class="w"> </span><span class="p">(</span><span class="nb">name </span><span class="s">"somePkg"</span><span class="p">)</span>
<span class="w">            </span><span class="p">(</span><span class="nf">e-string</span><span class="w"> </span><span class="o">@</span><span class="mi">3-13-3-26</span>
<span class="w">                </span><span class="p">(</span><span class="nf">e-string-part</span><span class="w"> </span><span class="o">@</span><span class="mi">3-14-3-25</span><span class="w"> </span><span class="p">(</span><span class="nf">raw</span><span class="w"> </span><span class="s">"../main.roc"</span><span class="p">))))</span>
<span class="w">        </span><span class="p">(</span><span class="nf">record-field</span><span class="w"> </span><span class="o">@</span><span class="mi">3-28-3-55</span><span class="w"> </span><span class="p">(</span><span class="nb">name </span><span class="s">"pf"</span><span class="p">)</span>
<span class="w">            </span><span class="p">(</span><span class="nf">e-string</span><span class="w"> </span><span class="o">@</span><span class="mi">3-41-3-54</span>
<span class="w">                </span><span class="p">(</span><span class="nf">e-string-part</span><span class="w"> </span><span class="o">@</span><span class="mi">3-42-3-53</span><span class="w"> </span><span class="p">(</span><span class="nf">raw</span><span class="w"> </span><span class="s">"../main.roc"</span><span class="p">))))))</span>
</code></pre></div>



<a name="525493310"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/s-expression%20format/near/525493310" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/s-expression.20format.html#525493310">(Jun 24 2025 at 11:11)</a>:</h4>
<p>The kebab makes is more searchable using ctrl-F</p>



<a name="525493604"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/s-expression%20format/near/525493604" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/s-expression.20format.html#525493604">(Jun 24 2025 at 11:13)</a>:</h4>
<p>I think this looks great</p>



<a name="525495347"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/s-expression%20format/near/525495347" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/s-expression.20format.html#525495347">(Jun 24 2025 at 11:23)</a>:</h4>
<p>And this is the app we started with, Can section</p>
<div class="codehilite" data-code-language="Clojure"><pre><span></span><code><span class="p">(</span><span class="nf">can-ir</span>
<span class="w">    </span><span class="p">(</span><span class="nf">d-let</span><span class="w"> </span><span class="p">(</span><span class="nf">id</span><span class="w"> </span><span class="mi">87</span><span class="p">)</span>
<span class="w">        </span><span class="p">(</span><span class="nf">p-assign</span><span class="w"> </span><span class="o">@</span><span class="mi">8-1-8-6</span><span class="w"> </span><span class="p">(</span><span class="nf">ident</span><span class="w"> </span><span class="s">"main!"</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nf">id</span><span class="w"> </span><span class="mi">73</span><span class="p">))</span>
<span class="w">        </span><span class="p">(</span><span class="nf">e-lambda</span><span class="w"> </span><span class="o">@</span><span class="mi">8-9-12-2</span><span class="w"> </span><span class="p">(</span><span class="nf">id</span><span class="w"> </span><span class="mi">86</span><span class="p">)</span>
<span class="w">            </span><span class="p">(</span><span class="nf">args</span>
<span class="w">                </span><span class="p">(</span><span class="nf">p-underscore</span><span class="w"> </span><span class="o">@</span><span class="mi">8-10-8-11</span><span class="w"> </span><span class="p">(</span><span class="nf">id</span><span class="w"> </span><span class="mi">74</span><span class="p">)))</span>
<span class="w">            </span><span class="p">(</span><span class="nf">e-block</span><span class="w"> </span><span class="o">@</span><span class="mi">8-13-12-2</span>
<span class="w">                </span><span class="p">(</span><span class="nf">s-let</span><span class="w"> </span><span class="o">@</span><span class="mi">9-2-9-17</span>
<span class="w">                    </span><span class="p">(</span><span class="nf">p-assign</span><span class="w"> </span><span class="o">@</span><span class="mi">9-2-9-7</span><span class="w"> </span><span class="p">(</span><span class="nf">ident</span><span class="w"> </span><span class="s">"world"</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nf">id</span><span class="w"> </span><span class="mi">75</span><span class="p">))</span>
<span class="w">                    </span><span class="p">(</span><span class="nf">e-string</span><span class="w"> </span><span class="o">@</span><span class="mi">9-10-9-17</span><span class="w"> </span><span class="p">(</span><span class="nf">id</span><span class="w"> </span><span class="mi">77</span><span class="p">)</span>
<span class="w">                        </span><span class="p">(</span><span class="nf">e-literal</span><span class="w"> </span><span class="o">@</span><span class="mi">9-11-9-16</span><span class="w"> </span><span class="p">(</span><span class="nf">string</span><span class="w"> </span><span class="s">"World"</span><span class="p">))))</span>
<span class="w">                </span><span class="p">(</span><span class="nf">e-call</span><span class="w"> </span><span class="o">@</span><span class="mi">11-2-11-31</span>
<span class="w">                    </span><span class="p">(</span><span class="nf">e-lookup-external</span>
<span class="w">                        </span><span class="p">(</span><span class="nf">ext-decl</span><span class="w"> </span><span class="o">@</span><span class="mi">11-2-11-14</span><span class="w"> </span><span class="p">(</span><span class="nf">qualified</span><span class="w"> </span><span class="s">"pf.Stdout.line!"</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nf">module</span><span class="w"> </span><span class="s">"pf.Stdout"</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nf">local</span><span class="w"> </span><span class="s">"line!"</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nf">kind</span><span class="w"> </span><span class="s">"value"</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nf">type-var</span><span class="w"> </span><span class="mi">79</span><span class="p">)))</span>
<span class="w">                    </span><span class="p">(</span><span class="nf">e-string</span><span class="w"> </span><span class="o">@</span><span class="mi">11-15-11-30</span>
<span class="w">                        </span><span class="p">(</span><span class="nf">e-literal</span><span class="w"> </span><span class="o">@</span><span class="mi">11-16-11-29</span><span class="w"> </span><span class="p">(</span><span class="nf">string</span><span class="w"> </span><span class="s">"Hello, world!"</span><span class="p">)))))))</span>
<span class="w">    </span><span class="p">(</span><span class="nf">s-import</span><span class="w"> </span><span class="o">@</span><span class="mi">6-1-6-17</span><span class="w"> </span><span class="p">(</span><span class="nf">module</span><span class="w"> </span><span class="s">"pf.Stdout"</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nf">id</span><span class="w"> </span><span class="mi">72</span><span class="p">)</span>
<span class="w">        </span><span class="p">(</span><span class="nf">exposes</span><span class="p">)))</span>
</code></pre></div>



<a name="525495800"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/s-expression%20format/near/525495800" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/s-expression.20format.html#525495800">(Jun 24 2025 at 11:26)</a>:</h4>
<p>Beautiful</p>



<a name="525497583"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/s-expression%20format/near/525497583" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/s-expression.20format.html#525497583">(Jun 24 2025 at 11:36)</a>:</h4>
<p>Random side question... does anyone know how to rename a file so git is happy. I change the casing on this but I'm not sure git has carried it through.</p>
<p><a href="/user_uploads/22008/FKCQMGQDt2Sfj-Aqv7P_YwOS/Screenshot-2025-06-24-at-21.35.33.png">Screenshot 2025-06-24 at 21.35.33.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/22008/FKCQMGQDt2Sfj-Aqv7P_YwOS/Screenshot-2025-06-24-at-21.35.33.png" title="Screenshot 2025-06-24 at 21.35.33.png"><img data-original-content-type="image/png" data-original-dimensions="2580x986" src="/user_uploads/thumbnail/22008/FKCQMGQDt2Sfj-Aqv7P_YwOS/Screenshot-2025-06-24-at-21.35.33.png/840x560.webp"></a></div>



<a name="525497891"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/s-expression%20format/near/525497891" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kiryl Dziamura <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/s-expression.20format.html#525497891">(Jun 24 2025 at 11:38)</a>:</h4>
<p>maybe this would help<br>
<a href="https://adamj.eu/tech/2022/12/09/git-change-case-of-filenames/">https://adamj.eu/tech/2022/12/09/git-change-case-of-filenames/</a></p>
<p>tldr: <code>git mv</code></p>



<a name="525498249"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/s-expression%20format/near/525498249" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/s-expression.20format.html#525498249">(Jun 24 2025 at 11:40)</a>:</h4>
<p>Thank you.</p>



<a name="525544409"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/s-expression%20format/near/525544409" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/s-expression.20format.html#525544409">(Jun 24 2025 at 15:29)</a>:</h4>
<p>FWIW I think greppability of the s-expr names (i.e. exact match between what a thing is called in the s-expr and what it's called in the zig source) is really useful for ramping up in an unfamiliar codebase. Agree it's a bit more readable with kebab-case, but that does give me a bit of pause...</p>



<hr><p>Last updated: Nov 01 2025 at 12:13 UTC</p>
</html>