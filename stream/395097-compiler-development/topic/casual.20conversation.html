<html>
<head><meta charset="utf-8"><title>casual conversation · compiler development · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/index.html">compiler development</a></h2>
<h3>Topic: <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html">casual conversation</a></h3>

<hr>

<base href="https://roc.zulipchat.com">

<head><link href="https://roc-lang.github.io/zulip-export/style.css" rel="stylesheet"></head>

<a name="373264697"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/373264697" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ayaz Hafiz <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#373264697">(Jul 07 2023 at 16:12)</a>:</h4>
<p><span aria-label="sob" class="emoji emoji-1f62d" role="img" title="sob">:sob:</span> </p>
<div class="codehilite"><pre><span></span><code>error: implementation of `FnOnce` is not general enough
    --&gt; crates/compiler/gen_llvm/src/llvm/build.rs:5735:5
     |
...
     |
     = note: closure with signature `fn(&amp;&#39;2 [BasicMetadataValueEnum&lt;&#39;_&gt;]) -&gt; CallSiteValue
     = note: ...but it actually implements `FnOnce&lt;(&amp;&#39;2 [BasicMetadataValueEnum&lt;&#39;_&gt;],)&gt;`,
</code></pre></div>



<a name="373265211"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/373265211" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#373265211">(Jul 07 2023 at 16:13)</a>:</h4>
<p>can't you wrap it in another closure to fix this?</p>



<a name="373265331"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/373265331" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#373265331">(Jul 07 2023 at 16:14)</a>:</h4>
<p>also where did the return type go on the bottom line?</p>



<a name="373266112"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/373266112" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ayaz Hafiz <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#373266112">(Jul 07 2023 at 16:16)</a>:</h4>
<p>i don't know.. it's the classic thing where you have a parameter like</p>
<div class="codehilite"><pre><span></span><code>build_foo : FnOnce(Something&lt;&#39;ctx&gt;) -&gt; Other&lt;&#39;ctx&gt;,
</code></pre></div>
<p>and feed it</p>
<div class="codehilite"><pre><span></span><code>|something| env.builder.build_whatever(something)
</code></pre></div>
<p>and the inference breaks down over higher-rank lifetimes so you just need to explicitly type it as</p>
<div class="codehilite"><pre><span></span><code>|something: Something&lt;&#39;ctx&gt;| env.builder.build_whatever(something)
</code></pre></div>



<a name="373266164"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/373266164" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ayaz Hafiz <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#373266164">(Jul 07 2023 at 16:16)</a>:</h4>
<p>the fix is simple but it's unfortunate the error message is poor</p>



<a name="373740611"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/373740611" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#373740611">(Jul 09 2023 at 16:28)</a>:</h4>
<p>"ægraphs: Acyclic E-graphs for Efficient Optimization in a Production Compiler" <a href="https://vimeo.com/843540328">https://vimeo.com/843540328</a></p>



<a name="374062927"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/374062927" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#374062927">(Jul 10 2023 at 19:18)</a>:</h4>
<p>fyi we just upgraded main to rust 1.67. upgrading should be seamless, but you may see some longer build times</p>



<a name="374062963"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/374062963" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#374062963">(Jul 10 2023 at 19:18)</a>:</h4>
<p>also a <code>cargo clean</code> may save ~100gb on your system</p>



<a name="374747950"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/374747950" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ayaz Hafiz <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#374747950">(Jul 12 2023 at 21:22)</a>:</h4>
<p>function erasure is ready for review: <a href="https://github.com/roc-lang/roc/pull/5576">https://github.com/roc-lang/roc/pull/5576</a></p>



<a name="374758092"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/374758092" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#374758092">(Jul 12 2023 at 22:33)</a>:</h4>
<p>Random question, is the intent to use this instead of lambda sets? I.e. this helps remove a complex area of the compiler that was responsible for bugs? Just not entirely understanding why here. I don't need to know, but it looks cool and I'm  interested.</p>



<a name="374763758"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/374763758" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ayaz Hafiz <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#374763758">(Jul 12 2023 at 23:22)</a>:</h4>
<p>it's an alternative to compiling functions to lambda sets but it won't get rid of them. We need type-erasure (for values and functions) in order to support Map2, so it will at least be used for that. But we could also eventually use it for dev builds, since type-erased functions are faster to compiler, or for <code>roc check</code>, since lambda sets are not important for type checking.</p>



<a name="374763845"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/374763845" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#374763845">(Jul 12 2023 at 23:23)</a>:</h4>
<p>also they're more amenable to on-disk caching!</p>



<a name="374763856"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/374763856" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#374763856">(Jul 12 2023 at 23:23)</a>:</h4>
<p>(for dev builds)</p>



<a name="375622784"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/375622784" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ayaz Hafiz <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#375622784">(Jul 15 2023 at 20:28)</a>:</h4>
<p><a href="https://github.com/rust-lang/rust/blob/master/compiler/rustc_mir_transform/src/large_enums.rs">https://github.com/rust-lang/rust/blob/master/compiler/rustc_mir_transform/src/large_enums.rs</a></p>
<p>would be cool to consider this. we do this already in the llvm backend but it could be generalzied</p>



<a name="376437853"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/376437853" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#376437853">(Jul 18 2023 at 18:16)</a>:</h4>
<p><a href="https://github.com/wolfpld/tracy/">https://github.com/wolfpld/tracy/</a> h/t <span class="user-mention" data-user-id="406911">@Andrew Kelley</span></p>



<a name="376438462"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/376438462" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ayaz Hafiz <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#376438462">(Jul 18 2023 at 18:18)</a>:</h4>
<p>also the goated <a href="https://github.com/janestreet/magic-trace">https://github.com/janestreet/magic-trace</a></p>



<a name="376472675"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/376472675" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Andrew Kelley <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#376472675">(Jul 18 2023 at 20:59)</a>:</h4>
<p><span class="user-mention" data-user-id="281383">@Richard Feldman</span> &amp; Josh (unsure of your last name, sorry), since we briefly talked about how much logic was in <a href="http://file.rs">file.rs</a> I thought you might get a kick out of how many lines this file is in zig: <a href="https://github.com/ziglang/zig/blob/master/src/Sema.zig">https://github.com/ziglang/zig/blob/master/src/Sema.zig</a></p>



<a name="376472906"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/376472906" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#376472906">(Jul 18 2023 at 21:00)</a>:</h4>
<p><span class="user-mention" data-user-id="453336">@Joshua Warner</span></p>



<a name="376472931"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/376472931" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#376472931">(Jul 18 2023 at 21:00)</a>:</h4>
<p>that's awesome <span aria-label="joy" class="emoji emoji-1f602" role="img" title="joy">:joy:</span></p>



<a name="376473392"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/376473392" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Andrew Kelley <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#376473392">(Jul 18 2023 at 21:03)</a>:</h4>
<p>when people complain about this, I usually say something to the effect of, "they're good lines, Brent"</p>



<a name="376473492"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/376473492" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Andrew Kelley <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#376473492">(Jul 18 2023 at 21:04)</a>:</h4>
<p>(reference to <a href="https://knowyourmeme.com/memes/theyre-good-dogs-brent">https://knowyourmeme.com/memes/theyre-good-dogs-brent</a>)</p>



<a name="376476941"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/376476941" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pearce Keesling <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#376476941">(Jul 18 2023 at 21:26)</a>:</h4>
<p>That GitHub link makes the mobile app crash so I am gonna guess it's quite large <span aria-label="sweat smile" class="emoji emoji-1f605" role="img" title="sweat smile">:sweat_smile:</span></p>



<a name="376480508"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/376480508" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ayaz Hafiz <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#376480508">(Jul 18 2023 at 21:51)</a>:</h4>
<p>you should see <a href="https://github.com/microsoft/TypeScript/blob/main/src/compiler/checker.ts">https://github.com/microsoft/TypeScript/blob/main/src/compiler/checker.ts</a></p>



<a name="376482649"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/376482649" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Qqwy / Marten <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#376482649">(Jul 18 2023 at 22:06)</a>:</h4>
<p><span aria-label="laughter tears" class="emoji emoji-1f602" role="img" title="laughter tears">:laughter_tears:</span> <br>
Makes me long for FORTH a little. For example, the infamous IOCCC submission <a href="https://www.ioccc.org/1992/buzzard.2.c">buzzard.2</a>'s ~60 lines of C source code is <a href="https://www.ioccc.org/1992/buzzard.2.design">essentially all you need</a> to bootstrap a language runtime.</p>



<a name="377279362"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/377279362" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#377279362">(Jul 21 2023 at 12:20)</a>:</h4>
<p>it was inevitable of course: I have submitted a patch to llvm <a href="https://reviews.llvm.org/D155944">https://reviews.llvm.org/D155944</a></p>



<a name="377279570"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/377279570" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#377279570">(Jul 21 2023 at 12:21)</a>:</h4>
<p>no idea what the status of the C api is actually, and what the chances are of that being accepted, but long term we will absolutely need guaranteed tail calls</p>



<a name="378255974"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/378255974" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#378255974">(Jul 24 2023 at 19:54)</a>:</h4>
<p><a href="https://twitter.com/lemire/status/1683560952027815936">https://twitter.com/lemire/status/1683560952027815936</a></p>



<a name="378263014"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/378263014" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#378263014">(Jul 24 2023 at 20:32)</a>:</h4>
<p>Wow.... That took way way way longer than it should have to happen</p>



<a name="378263320"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/378263320" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#378263320">(Jul 24 2023 at 20:34)</a>:</h4>
<p>More power to the compiler, probably at the cost of more hardware register contention. But compilers are almost certainly good enough and code complex enough that this will be a gain.</p>



<a name="378278071"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/378278071" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ayaz Hafiz <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#378278071">(Jul 24 2023 at 21:17)</a>:</h4>
<p>that they're all caller saved is super sweet. hopefully will make compilers go faster too, less time for the register allocator to run</p>



<a name="379315578"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/379315578" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#379315578">(Jul 27 2023 at 22:32)</a>:</h4>
<p>some cool ideas here about data type representation <a href="https://inria.hal.science/hal-04165615/document">https://inria.hal.science/hal-04165615/document</a> needs some iteration I think to make it really usable, but it's a good start</p>



<a name="382189020"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/382189020" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#382189020">(Aug 05 2023 at 16:44)</a>:</h4>
<p>in recent rust versions, you can use <code>OnceLock</code> instead of <code>lazy_static!</code></p>
<div class="codehilite"><pre><span></span><code>    // globally cache the temporary directory
    static TEMP_DIR: OnceLock&lt;tempfile::TempDir&gt; = OnceLock::new();
    let temp_dir = TEMP_DIR.get_or_init(|| tempfile::tempdir().unwrap());
</code></pre></div>
<p>it's not always the most ergonomic approach (and <code>LazyLock</code>, the stdlib name for this thing, is an unstable feature, so may make it in at some point) but in many cases this works quite well and does not require any dependencies</p>



<a name="382189077"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/382189077" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#382189077">(Aug 05 2023 at 16:45)</a>:</h4>
<p>(from what I can read, the cost runtime cost is the same)</p>



<a name="382666732"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/382666732" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#382666732">(Aug 07 2023 at 15:09)</a>:</h4>
<p>someone is picking up the rust custom allocators work <a href="https://shift.click/blog/allocator-trait-talk/">https://shift.click/blog/allocator-trait-talk/</a></p>
<p>not holding my breath for quick progress there, but it's good that someone is working on it</p>



<a name="383303272"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/383303272" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#383303272">(Aug 09 2023 at 14:21)</a>:</h4>
<p>does anyone know if there is a technical reason for allocating from high to low addresses? It appears quite common, but I'd like to know if that is just a custom or that there are good technical reasons for it</p>



<a name="383308840"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/383308840" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ayaz Hafiz <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#383308840">(Aug 09 2023 at 14:36)</a>:</h4>
<p>do you mean on the stack or the heap? on the heap maybe just because of memory regions?</p>



<a name="383309663"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/383309663" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#383309663">(Aug 09 2023 at 14:38)</a>:</h4>
<p>I assume it's because the stack allocates the other way</p>



<a name="383309673"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/383309673" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#383309673">(Aug 09 2023 at 14:38)</a>:</h4>
<p>I mean heap-like things. E.g. an arena allocator</p>



<a name="383309931"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/383309931" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#383309931">(Aug 09 2023 at 14:39)</a>:</h4>
<p>like the stack and the heap can't both use the same strategy, unless one of them is set up to start right where the other one ends, but to do that you'd need to know the exact size of the stack</p>



<a name="383310035"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/383310035" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#383310035">(Aug 09 2023 at 14:39)</a>:</h4>
<p>which I think maybe requires a syscall or something, and/or may not always be supported on all OSes?</p>



<a name="383310071"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/383310071" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#383310071">(Aug 09 2023 at 14:39)</a>:</h4>
<p>well yes when you have some other region growing from the other side you need to make a choice</p>



<a name="383310239"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/383310239" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#383310239">(Aug 09 2023 at 14:40)</a>:</h4>
<p>but what if you didn't? is there still a reason to perfer starting at the end and growing down?</p>



<a name="383319945"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/383319945" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#383319945">(Aug 09 2023 at 15:05)</a>:</h4>
<p>None that I can think of.</p>



<a name="383320622"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/383320622" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#383320622">(Aug 09 2023 at 15:07)</a>:</h4>
<p>must just be convenience then</p>



<a name="383320760"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/383320760" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#383320760">(Aug 09 2023 at 15:07)</a>:</h4>
<p>as in, the thing I could copy-paste went high-to-low, so that is just what it does now</p>



<a name="383828555"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/383828555" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#383828555">(Aug 11 2023 at 05:23)</a>:</h4>
<p>looks like making valgrind work on Apple Silicon is...really difficult! <span aria-label="astonished" class="emoji emoji-1f632" role="img" title="astonished">:astonished:</span></p>
<p><a href="https://github.com/LouisBrunner/valgrind-macos/issues/56#issuecomment-1651811069">https://github.com/LouisBrunner/valgrind-macos/issues/56#issuecomment-1651811069</a></p>



<a name="385928237"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/385928237" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#385928237">(Aug 18 2023 at 14:23)</a>:</h4>
<p>good talk about performance of the Carbon compiler</p>
<p><a href="https://www.youtube.com/watch?v=ZI198eFghJk">https://www.youtube.com/watch?v=ZI198eFghJk</a></p>
<div class="youtube-video message_inline_image"><a data-id="ZI198eFghJk" href="https://www.youtube.com/watch?v=ZI198eFghJk"><img src="https://uploads.zulipusercontent.net/0d9111ca1650d1e5824e03d7e5a6603366c635c5/68747470733a2f2f692e7974696d672e636f6d2f76692f5a49313938654667684a6b2f64656661756c742e6a7067"></a></div>



<a name="386050947"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/386050947" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ayaz Hafiz <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#386050947">(Aug 19 2023 at 06:05)</a>:</h4>
<p>modeling the semantics (including checking) as an IR sounds very interesting</p>



<a name="386050967"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/386050967" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ayaz Hafiz <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#386050967">(Aug 19 2023 at 06:05)</a>:</h4>
<p>really want to read the source</p>



<a name="386205013"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/386205013" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> ShalokShalom <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#386205013">(Aug 20 2023 at 09:42)</a>:</h4>
<p>How does Roc's reference counting with cycles? I am wondering, since I am fascinated with ORC, the way Nim did it. Does Roc do it at all at the given moment? Thanks for your answers :)</p>



<a name="386228596"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/386228596" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ayaz Hafiz <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#386228596">(Aug 20 2023 at 14:29)</a>:</h4>
<p>Roc does not deal with cycles, because cycles are impossible to introduce in an immutable language like Roc, since to create a cycle you must create then mutate a value.</p>



<a name="386228690"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/386228690" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#386228690">(Aug 20 2023 at 14:30)</a>:</h4>
<p>small correction: immutable and strict language. Laziness in haskell can also create cycles</p>



<a name="386868589"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/386868589" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#386868589">(Aug 23 2023 at 13:26)</a>:</h4>
<p>that first operator in Carbon's source code <span aria-label="eyes" class="emoji emoji-1f440" role="img" title="eyes">:eyes:</span> </p>
<p><a href="/user_uploads/22008/LUvWU8evRqdt2uZ2s1QZaZ5C/Screen-Shot-2023-08-23-at-9.24.24-AM.png">Screen-Shot-2023-08-23-at-9.24.24-AM.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/22008/LUvWU8evRqdt2uZ2s1QZaZ5C/Screen-Shot-2023-08-23-at-9.24.24-AM.png" title="Screen-Shot-2023-08-23-at-9.24.24-AM.png"><img src="/user_uploads/22008/LUvWU8evRqdt2uZ2s1QZaZ5C/Screen-Shot-2023-08-23-at-9.24.24-AM.png"></a></div>



<a name="386868681"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/386868681" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#386868681">(Aug 23 2023 at 13:27)</a>:</h4>
<p>this is from <a href="https://youtu.be/ZI198eFghJk?t=2830">https://youtu.be/ZI198eFghJk?t=2830</a></p>
<div class="youtube-video message_inline_image"><a data-id="ZI198eFghJk" href="https://youtu.be/ZI198eFghJk?t=2830"><img src="https://uploads.zulipusercontent.net/0d9111ca1650d1e5824e03d7e5a6603366c635c5/68747470733a2f2f692e7974696d672e636f6d2f76692f5a49313938654667684a6b2f64656661756c742e6a7067"></a></div>



<a name="386881614"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/386881614" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#386881614">(Aug 23 2023 at 14:20)</a>:</h4>
<p>That is just normal c++, right?</p>



<a name="386881651"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/386881651" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#386881651">(Aug 23 2023 at 14:20)</a>:</h4>
<p>Shift and assign</p>



<a name="386881804"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/386881804" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#386881804">(Aug 23 2023 at 14:21)</a>:</h4>
<p>oh well that's no fun <span aria-label="stuck out tongue" class="emoji emoji-1f61b" role="img" title="stuck out tongue">:stuck_out_tongue:</span></p>



<a name="386881912"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/386881912" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#386881912">(Aug 23 2023 at 14:21)</a>:</h4>
<p>I think the last time I wrote a whole C++ program was over 20 years ago <span aria-label="sweat smile" class="emoji emoji-1f605" role="img" title="sweat smile">:sweat_smile:</span></p>



<a name="387066113"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/387066113" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pit Capitain <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#387066113">(Aug 24 2023 at 12:49)</a>:</h4>
<p>We realize that we're getting older when we look at our children... and at our old code <span aria-label="wink" class="emoji emoji-1f609" role="img" title="wink">:wink:</span></p>



<a name="387136977"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/387136977" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Zeljko Nesic <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#387136977">(Aug 24 2023 at 18:02)</a>:</h4>
<p>Yesterday I have updated an Elm file that hasn't been touched for over 7 years!</p>



<a name="387140715"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/387140715" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#387140715">(Aug 24 2023 at 18:22)</a>:</h4>
<p>I wish I still had that RPG I wrote in c++ I wrote all those years ago...I'm sure I could spot some undefined behavior in it today <span aria-label="laughing" class="emoji emoji-1f606" role="img" title="laughing">:laughing:</span></p>



<a name="387175007"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/387175007" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#387175007">(Aug 24 2023 at 23:15)</a>:</h4>
<p>very interesting!</p>
<p><a href="https://arxiv.org/pdf/2107.01250.pdf">https://arxiv.org/pdf/2107.01250.pdf</a></p>



<a name="387449871"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/387449871" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#387449871">(Aug 26 2023 at 18:49)</a>:</h4>
<p>this is a cool tip if we ever want to start testing big-endian targets in CI: <a href="https://twitter.com/burntsushi5/status/1695483429997945092">https://twitter.com/burntsushi5/status/1695483429997945092</a></p>
<p>(I'm fine with not officially supporting them as targets yet)</p>



<a name="388266173"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/388266173" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#388266173">(Aug 31 2023 at 07:29)</a>:</h4>
<p>I'll just leave this here <span aria-label="octopus" class="emoji emoji-1f419" role="img" title="octopus">:octopus:</span> </p>
<div class="codehilite"><pre><span></span><code>PS C:\Users\bosyl\Documents\GitHub\roc&gt; .\target\release\roc.exe run ..\basic-cli\examples\hello-world.roc
🔨 Rebuilding platform...
warning: ignoring debug info with an invalid version (0) in app
Hello, World!
</code></pre></div>



<a name="388266978"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/388266978" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#388266978">(Aug 31 2023 at 07:35)</a>:</h4>
<p>First time I've been able to get that working.</p>



<a name="388268147"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/388268147" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#388268147">(Aug 31 2023 at 07:43)</a>:</h4>
<p>I packaged <code>basic-cli</code> for Windows and uploaded the binary <a href="https://github.com/lukewilliamboswell/basic-cli/releases/tag/0.5.0">in the Github release</a>. Not sure if this is a bad idea to share like this... </p>
<div class="codehilite"><pre><span></span><code>PS C:\Users\bosyl\Documents\GitHub\basic-cli&gt; ..\roc\target\release\roc.exe run .\examples\hello-world.roc
Downloading https://github.com/lukewilliamboswell/basic-cli/releases/download/0.5.0/Dt_L3PF3VAAxtLzxXZ-g9nBp0Gzo6tbTevSep1SdDeQ.tar.br
    into C:\Users\bosyl\AppData\Roaming\Roc\packages

warning: ignoring debug info with an invalid version (0) in app
Hello, World!
</code></pre></div>



<a name="388268393"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/388268393" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#388268393">(Aug 31 2023 at 07:45)</a>:</h4>
<div class="codehilite"><pre><span></span><code>app &quot;hello-world&quot;
    packages { pf: &quot;https://github.com/lukewilliamboswell/basic-cli/releases/download/0.5.0/Dt_L3PF3VAAxtLzxXZ-g9nBp0Gzo6tbTevSep1SdDeQ.tar.br&quot; }
    imports [pf.Stdout, pf.Task.{ Task }]
    provides [main] to pf

main : Task {} I32
main =
    Stdout.line &quot;Hello, World!&quot;
</code></pre></div>



<a name="388270761"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/388270761" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#388270761">(Aug 31 2023 at 08:01)</a>:</h4>
<p>There are still a lot of issues here, other examples I've tried will build and run but not print anything... but at least this is a start. <span aria-label="smiley" class="emoji emoji-1f603" role="img" title="smiley">:smiley:</span></p>



<a name="388321831"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/388321831" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Fábio Beirão <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#388321831">(Aug 31 2023 at 13:13)</a>:</h4>
<p><a href="/user_uploads/22008/P2ja6_irJRpyPNg3pr6Jk3fX/image.png">image.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/22008/P2ja6_irJRpyPNg3pr6Jk3fX/image.png" title="image.png"><img src="/user_uploads/22008/P2ja6_irJRpyPNg3pr6Jk3fX/image.png"></a></div><p>I don't think the exe is code signed, so that can be a hurdle with SmartScreen <span aria-label="thinking" class="emoji emoji-1f914" role="img" title="thinking">:thinking:</span></p>



<a name="388322284"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/388322284" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Fábio Beirão <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#388322284">(Aug 31 2023 at 13:15)</a>:</h4>
<p>Ahh Windows <span aria-label="smile" class="emoji emoji-1f642" role="img" title="smile">:smile:</span><br>
<a href="/user_uploads/22008/IRas7L_66XCPj5PmpbWz9feT/image.png">image.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/22008/IRas7L_66XCPj5PmpbWz9feT/image.png" title="image.png"><img src="/user_uploads/22008/IRas7L_66XCPj5PmpbWz9feT/image.png"></a></div><p>What I did is I used the Windows Sandbox to get a clean windows version, downloaded the Exe. Went to the properties and clicked Unblock (due to it being downloaded from the internet) and then just double clicked the exe file.</p>



<a name="388322524"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/388322524" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Fábio Beirão <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#388322524">(Aug 31 2023 at 13:17)</a>:</h4>
<p><a href="/user_uploads/22008/qvWgQnaUKiR68B_HP9h8udEW/image.png">image.png</a><br>
Running it in powershell also yields no output</p>
<div class="message_inline_image"><a href="/user_uploads/22008/qvWgQnaUKiR68B_HP9h8udEW/image.png" title="image.png"><img src="/user_uploads/22008/qvWgQnaUKiR68B_HP9h8udEW/image.png"></a></div>



<a name="388322639"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/388322639" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Fábio Beirão <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#388322639">(Aug 31 2023 at 13:17)</a>:</h4>
<p><span class="user-mention" data-user-id="515757">@Luke Boswell</span> let me know if you need help with testing Windows stuff. I have Windows 10 on one machine and Windows 11 on another.</p>



<a name="388406039"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/388406039" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#388406039">(Aug 31 2023 at 21:06)</a>:</h4>
<p>I'm surprised the cli doesn't even print anything. <span aria-label="thinking" class="emoji emoji-1f914" role="img" title="thinking">:thinking:</span></p>



<a name="388899693"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/388899693" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#388899693">(Sep 04 2023 at 03:36)</a>:</h4>
<p>this is wild - I can't believe that nibble mask works, those numbers look so random! But it totally does - I tried it out.</p>
<p><a href="https://lemire.me/blog/2017/07/10/pruning-spaces-faster-on-arm-processors-with-vector-table-lookups/">https://lemire.me/blog/2017/07/10/pruning-spaces-faster-on-arm-processors-with-vector-table-lookups/</a></p>



<a name="388999681"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/388999681" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#388999681">(Sep 04 2023 at 14:05)</a>:</h4>
<p>Linux Torvalds on mmap vs buffered reading in Linux: <a href="https://lkml.iu.edu/hypermail/linux/kernel/0802.0/1496.html">https://lkml.iu.edu/hypermail/linux/kernel/0802.0/1496.html</a></p>



<a name="389001741"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/389001741" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#389001741">(Sep 04 2023 at 14:15)</a>:</h4>
<p>I'm confused whether this is specific to the linux kernel, or more general for "programs running on linux"</p>



<a name="389029035"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/389029035" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#389029035">(Sep 04 2023 at 17:07)</a>:</h4>
<p>also interesting: <a href="https://stackoverflow.com/a/260188">https://stackoverflow.com/a/260188</a></p>



<a name="389153336"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/389153336" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#389153336">(Sep 05 2023 at 10:13)</a>:</h4>
<p>I watched a few YouTube tutorials on interactive rebasing, and cherry-picking and I have to admit... I wish I had done that sooner! So simple, and would have saved me a lot of time. Learnt a few nice tricks along the way. <span aria-label="thumbs up" class="emoji emoji-1f44d" role="img" title="thumbs up">:thumbs_up:</span> <span aria-label="sweat smile" class="emoji emoji-1f605" role="img" title="sweat smile">:sweat_smile:</span></p>



<a name="389154050"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/389154050" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Fábio Beirão <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#389154050">(Sep 05 2023 at 10:15)</a>:</h4>
<p>This is something that when I started using Fork (<a href="https://git-fork.com/">https://git-fork.com/</a>) just became so much clearer to me. Unfortunately doesn't have a linux port, only Windows and Mac</p>



<a name="389160936"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/389160936" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#389160936">(Sep 05 2023 at 10:51)</a>:</h4>
<p>I'm just wondering, should the zig tests pass on MacOS? I get the below errors which  seem strange to me <code>thread 11673296 panic: incorrect alignment</code></p>
<div class="spoiler-block"><div class="spoiler-header">
<p>Aarch64ZigTestError</p>
</div><div class="spoiler-content" aria-hidden="true">
<p>192-168-1-105:bitcode luke$ pwd<br>
/Users/luke/Documents/GitHub/roc/crates/compiler/builtins/bitcode<br>
192-168-1-105:bitcode luke$ zig build test<br>
Test [4/153] dec.test "fromStr: empty"... thread 11673296 panic: incorrect alignment<br>
/Users/luke/Documents/GitHub/roc/crates/compiler/builtins/bitcode/src/libc/musl/memcpy.zig:41:32: 0x104f850b3 in libc.musl.memcpy.fallback_memcpy (test)<br>
        var s4 = @alignCast(4, s);<br>
                               ^<br>
/Users/luke/Documents/GitHub/roc/crates/compiler/builtins/bitcode/src/libc.zig:31:31: 0x104fc4e83 in libc.memcpy (test)<br>
            return musl.memcpy(dest, src, len);<br>
                              ^<br>
/Users/luke/Documents/GitHub/roc/crates/compiler/builtins/bitcode/src/str.zig:56:9: 0x104fb6ed3 in str.RocStr.init (test)<br>
        @memcpy(result.asU8ptrMut(), bytes_ptr, length);<br>
        ^<br>
/Users/luke/Documents/GitHub/roc/crates/compiler/builtins/bitcode/src/dec.zig:755:30: 0x104f8674b in dec.test "fromStr: empty" (test)<br>
    var roc_str = RocStr.init("", 0);<br>
                             ^<br>
/nix/store/1jsz44m30pxqzll6s641cxsibzbpvjmx-zig-0.9.1/lib/zig/std/special/test_runner.zig:80:28: 0x104fc6f8f in std.special.main (test)<br>
        } else test_fn.func();<br>
                           ^<br>
/nix/store/1jsz44m30pxqzll6s641cxsibzbpvjmx-zig-0.9.1/lib/zig/std/start.zig:551:22: 0x1050289b3 in std.start.callMain (test)<br>
            root.main();<br>
                     ^<br>
/nix/store/1jsz44m30pxqzll6s641cxsibzbpvjmx-zig-0.9.1/lib/zig/std/start.zig:495:12: 0x104fc8a43 in std.start.callMainWithArgs (test)<br>
    return @call(.{ .modifier = .always_inline }, callMain, .{});<br>
           ^<br>
/nix/store/1jsz44m30pxqzll6s641cxsibzbpvjmx-zig-0.9.1/lib/zig/std/start.zig:460:12: 0x104fc896f in std.start.main (test)<br>
    return @call(.{ .modifier = .always_inline }, callMainWithArgs, .{ @intCast(usize, c_argc), c_argv, envp });<br>
           ^<br>
???:?:?: 0x1a1ebff27 in ??? (???)<br>
???:?:?: 0xab71ffffffffffff in ??? (???)<br>
error: the following test command crashed:<br>
/Users/luke/Documents/GitHub/roc/crates/compiler/builtins/bitcode/zig-cache/o/00a242709486f6fe0044878fa17186a4/test /nix/store/1jsz44m30pxqzll6s641cxsibzbpvjmx-zig-0.9.1/bin/zig<br>
The following command exited with error code 1:<br>
/nix/store/1jsz44m30pxqzll6s641cxsibzbpvjmx-zig-0.9.1/bin/zig test /Users/luke/Documents/GitHub/roc/crates/compiler/builtins/bitcode/src/main.zig -lc --cache-dir /Users/luke/Documents/GitHub/roc/crates/compiler/builtins/bitcode/zig-cache --global-cache-dir /Users/luke/.cache/zig --name test <br>
error: the following build command failed with exit code 1:<br>
/Users/luke/Documents/GitHub/roc/crates/compiler/builtins/bitcode/zig-cache/o/1d46ff7b08d826ee45715195b67b4b10/build /nix/store/1jsz44m30pxqzll6s641cxsibzbpvjmx-zig-0.9.1/bin/zig /Users/luke/Documents/GitHub/roc/crates/compiler/builtins/bitcode /Users/luke/Documents/GitHub/roc/crates/compiler/builtins/bitcode/zig-cache /Users/luke/.cache/zig test</p>
</div></div>



<a name="389161142"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/389161142" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#389161142">(Sep 05 2023 at 10:52)</a>:</h4>
<p><a href="https://gist.github.com/lukewilliamboswell/e5753ace4acab836def53a28aacd0611">gist with errors and correct alignment</a></p>



<a name="389162225"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/389162225" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#389162225">(Sep 05 2023 at 10:59)</a>:</h4>
<p>that is weird. strings have a refcount, so the alignment should always be 8?</p>



<a name="389395020"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/389395020" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#389395020">(Sep 06 2023 at 11:07)</a>:</h4>
<p><a href="https://dl.acm.org/doi/pdf/10.1145/3243176.3243195">https://dl.acm.org/doi/pdf/10.1145/3243176.3243195</a> has some wild RC numbers:</p>
<ul>
<li>Swift apparently uses 30 bits to store their reference counts</li>
<li>The paper says "[our implementation] reduces the number of bits per counter from 30 bits to 14 bits,<br>
which is more than enough for RC. Many Java programs need only<br>
7 bits, and we observe similar behavior in our Swift programs"</li>
</ul>



<a name="389396507"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/389396507" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#389396507">(Sep 06 2023 at 11:16)</a>:</h4>
<p>How many do we use?</p>



<a name="389405089"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/389405089" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Carroll <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#389405089">(Sep 06 2023 at 12:06)</a>:</h4>
<p>Same number of bits as a pointer. So 64 or 32.</p>



<a name="389405508"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/389405508" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Carroll <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#389405508">(Sep 06 2023 at 12:08)</a>:</h4>
<p>We increase the alignment on many heap data structures because of the refcount. Like Str bytes for example.</p>



<a name="389489104"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/389489104" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#389489104">(Sep 06 2023 at 17:46)</a>:</h4>
<p>The github web vscode editor (press '.' key on a repo's page) works well now. In the past I always had issues with commit signing but that seems to have been fixed :) Handy for when you quickly want to make small changes to multiple files.</p>



<a name="389489524"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/389489524" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#389489524">(Sep 06 2023 at 17:49)</a>:</h4>
<p>Woah....never knew that was a feature</p>



<a name="389490630"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/389490630" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Zeljko Nesic <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#389490630">(Sep 06 2023 at 17:56)</a>:</h4>
<p><a href="https://buttondown.email/hillelwayne/archive/github-has-too-many-hidden-features/">https://buttondown.email/hillelwayne/archive/github-has-too-many-hidden-features/</a></p>



<a name="390918200"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/390918200" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#390918200">(Sep 14 2023 at 12:23)</a>:</h4>
<p><code>Dec</code> is now the default type for fractional values. This may cause breakage in some cases. Also I suspect there are still a bunch of missing functions for Dec that are used in practice. The quick fix is to explicitly make literals of the f64 type, like <code>3.14f64</code></p>



<a name="390983490"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/390983490" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#390983490">(Sep 14 2023 at 16:57)</a>:</h4>
<p><span class="user-mention" data-user-id="281543">@Folkert de Vries</span>  If you aren't looking into Dec sin/cos impl, I may look into it. Sounds like an interesting side project. I have always wondered how they are implemented in software.</p>



<a name="390984790"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/390984790" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#390984790">(Sep 14 2023 at 17:05)</a>:</h4>
<p>I'm not working on that, and don't plan to</p>



<a name="390992011"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/390992011" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#390992011">(Sep 14 2023 at 17:53)</a>:</h4>
<p>yessss that's awesome!</p>



<a name="391140445"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/391140445" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#391140445">(Sep 15 2023 at 11:10)</a>:</h4>
<p>very interesting reference counting technique, just published in 2021! <a href="https://dl.acm.org/doi/10.1145/3453483.3454060">https://dl.acm.org/doi/10.1145/3453483.3454060</a></p>



<a name="391140590"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/391140590" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#391140590">(Sep 15 2023 at 11:11)</a>:</h4>
<p>direct link to paper: <a href="https://dl.acm.org/doi/pdf/10.1145/3453483.3454060">https://dl.acm.org/doi/pdf/10.1145/3453483.3454060</a></p>



<a name="391215709"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/391215709" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#391215709">(Sep 15 2023 at 16:29)</a>:</h4>
<p>progress on aarch64 dev backend (elf only though)</p>
<p>this is gen_num</p>
<div class="codehilite"><pre><span></span><code>     Summary [  64.943s] 144 tests run: 19 passed, 125 failed, 709 skipped
</code></pre></div>
<p>now just needs a lot more instructions, but the scaffolding works</p>



<a name="391215841"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/391215841" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#391215841">(Sep 15 2023 at 16:30)</a>:</h4>
<p>also the rust library we use has very limited options for macho relocations. it's not clear whether that is fundamental or whether they've just not implemented it yet</p>



<a name="391226658"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/391226658" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#391226658">(Sep 15 2023 at 17:27)</a>:</h4>
<p>also the dev backend repl just got merged, so on x86 linux, the repl should now be much faster!</p>



<a name="391372112"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/391372112" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#391372112">(Sep 16 2023 at 12:25)</a>:</h4>
<p><span class="user-mention" data-user-id="515757">@Luke Boswell</span> and I got it to work on macos too now, and fixed some other issues. Now there  is some bug with branches that went unnoticed on x86 and then we'll have almost all of gen_num working already. (still some float stuff and 128-bit stuff to do)</p>



<a name="391404780"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/391404780" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#391404780">(Sep 16 2023 at 17:53)</a>:</h4>
<p>yoooooooooo</p>



<a name="391412061"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/391412061" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Carroll <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#391412061">(Sep 16 2023 at 19:23)</a>:</h4>
<p>Amazing work, you two!</p>



<a name="391414263"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/391414263" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#391414263">(Sep 16 2023 at 19:52)</a>:</h4>
<p>I just discovered Agner Fog's <a href="https://agner.org/optimize/">optimization resources page</a> (which is <em>incredible</em> btw) has <a href="https://agner.org/optimize/calling_conventions.pdf">a comprehensive explanation of calling conventions</a> on all the major OSes <span aria-label="exploding head" class="emoji emoji-1f92f" role="img" title="exploding head">:exploding_head:</span></p>



<a name="391418627"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/391418627" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#391418627">(Sep 16 2023 at 20:53)</a>:</h4>
<p>That page continues to gain content. Yeah, it is pretty great</p>



<a name="391462640"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/391462640" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#391462640">(Sep 17 2023 at 06:21)</a>:</h4>
<p>I've generated an object file from a test using e.g. <code>ROC_DEV_WRITE_OBJ=1 cargo nextest-gen-dev add_checked_dec</code> and then built this into an executable using <code>zig build-exe /var/folders/48/39th9k0n0wdcj18k3yhm_g5c0000gn/T/app.o crates/compiler/builtins/bitcode/builtins-aarch64.ll something.zig</code>. Note the <code>ROC_DEV_WRITE_OBJ</code> flags roc to write out the object file and print the location of the file.</p>
<p>But when I run step through the file from <code>test_main</code> it seems to never get into the <code>#UserApp_main_482528569654279254</code>. Instead it branches off at <code>0x100000804 &lt;+52&gt;:  b.ne   0x100000850</code> and then returns successfully without calling the actual test code I'm interested in I think. </p>
<div class="codehilite"><pre><span></span><code>(lldb) target create &quot;something&quot;
Current executable set to &#39;/Users/luke/Documents/GitHub/roc/something&#39; (arm64).
(lldb) b test_main
Breakpoint 1: where = something`test_main, address = 0x00000001000007d0
(lldb) r
Process 12932 launched: &#39;/Users/luke/Documents/GitHub/roc/something&#39; (arm64)
Process 12932 stopped
* thread #1, stop reason = breakpoint 1.1
    frame #0: 0x00000001000007d0 something`test_main
something`test_main:
-&gt;  0x1000007d0 &lt;+0&gt;:  sub    sp, sp, #0x60             ; =0x60
    0x1000007d4 &lt;+4&gt;:  str    x30, [sp, #0x58]
    0x1000007d8 &lt;+8&gt;:  str    x29, [sp, #0x50]
    0x1000007dc &lt;+12&gt;: add    x29, sp, #0x50            ; =0x50
(lldb) disassemble --frame
something`test_main:
-&gt;  0x1000007d0 &lt;+0&gt;:   sub    sp, sp, #0x60             ; =0x60
    0x1000007d4 &lt;+4&gt;:   str    x30, [sp, #0x58]
    0x1000007d8 &lt;+8&gt;:   str    x29, [sp, #0x50]
    0x1000007dc &lt;+12&gt;:  add    x29, sp, #0x50            ; =0x50
    0x1000007e0 &lt;+16&gt;:  ldr    x17, [x17]
    0x1000007e4 &lt;+20&gt;:  stur   x8, [x29, #-0x8]
    0x1000007e8 &lt;+24&gt;:  stur   x17, [x29, #-0x10]
    0x1000007ec &lt;+28&gt;:  ldur   x0, [x29, #-0x10]
    0x1000007f0 &lt;+32&gt;:  bl     0x100000770               ; roc_setjmp
    0x1000007f4 &lt;+36&gt;:  stur   x0, [x29, #-0x20]
    0x1000007f8 &lt;+40&gt;:  stur   x1, [x29, #-0x18]
    0x1000007fc &lt;+44&gt;:  ldur   x17, [x29, #-0x20]
    0x100000800 &lt;+48&gt;:  cmp    x17, #0x0                 ; =0x0
    0x100000804 &lt;+52&gt;:  b.ne   0x100000850               ; &lt;+128&gt;
    0x100000808 &lt;+56&gt;:  stur   x17, [x29, #-0x10]
    0x10000080c &lt;+60&gt;:  bl     0x100000920               ; #UserApp_main_482528569654279254
</code></pre></div>
<p>I suspect it might be because I have the type of <code>RocCallResult.value</code> wrong?   </p>
<div class="codehilite" data-code-language="Zig"><pre><span></span><code><span class="kr">const</span><span class="w"> </span><span class="n">std</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">@import</span><span class="p">(</span><span class="s">"std"</span><span class="p">);</span>

<span class="kr">const</span><span class="w"> </span><span class="n">RocCallResult</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kr">extern</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">tag</span><span class="o">:</span><span class="w"> </span><span class="kt">u64</span><span class="p">,</span>
<span class="w">    </span><span class="n">error_msg</span><span class="o">:</span><span class="w"> </span><span class="kt">u64</span><span class="p">,</span>
<span class="w">    </span><span class="n">value</span><span class="o">:</span><span class="w"> </span><span class="kt">bool</span><span class="p">,</span>
<span class="p">};</span>

<span class="kr">extern</span><span class="w"> </span><span class="k">fn</span><span class="w"> </span><span class="n">test_main</span><span class="p">()</span><span class="w"> </span><span class="n">callconv</span><span class="p">(.</span><span class="n">C</span><span class="p">)</span><span class="w"> </span><span class="n">RocCallResult</span><span class="p">;</span>

<span class="kr">pub</span><span class="w"> </span><span class="k">fn</span><span class="w"> </span><span class="n">main</span><span class="p">()</span><span class="w"> </span><span class="kt">u8</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kr">const</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">test_main</span><span class="p">();</span>

<span class="w">    </span><span class="n">std</span><span class="p">.</span><span class="n">debug</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="s">"done {}</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span><span class="w"> </span><span class="p">.{</span><span class="n">value</span><span class="p">.</span><span class="n">value</span><span class="p">});</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>



<a name="391462766"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/391462766" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#391462766">(Sep 17 2023 at 06:22)</a>:</h4>
<p>This is the test that I am trying to investigate</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="cp">#[test]</span>
<span class="cp">#[cfg(any(feature = </span><span class="s">"gen-llvm"</span><span class="cp">, feature = </span><span class="s">"gen-wasm"</span><span class="cp">, feature = </span><span class="s">"gen-dev"</span><span class="cp">))]</span>
<span class="k">fn</span> <span class="nf">add_checked_dec</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">assert_evals_to</span><span class="o">!</span><span class="p">(</span>
<span class="w">        </span><span class="n">indoc</span><span class="o">!</span><span class="p">(</span>
<span class="w">            </span><span class="s">r#"</span>
<span class="s">            Num.addChecked 2.0dec 4.0dec == Ok 6.0dec</span>
<span class="s">            "#</span>
<span class="w">        </span><span class="p">),</span>
<span class="w">        </span><span class="kc">true</span><span class="p">,</span>
<span class="w">        </span><span class="kt">bool</span>
<span class="w">    </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>



<a name="391465048"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/391465048" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#391465048">(Sep 17 2023 at 06:59)</a>:</h4>
<p>I'm pretty convinced this is my set-up and nothing to do with the test failing, tried the same method on a good test and had the same issue. <span aria-label="sad" class="emoji emoji-2639" role="img" title="sad">:sad:</span></p>



<a name="391468526"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/391468526" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#391468526">(Sep 17 2023 at 07:54)</a>:</h4>
<p>on aarch at the moment we don't use all of the rocresult stuff. instead I call/break on <code>extern fn roc__main_1_exposed() callconv(.C) u128;
</code></p>



<a name="391468686"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/391468686" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#391468686">(Sep 17 2023 at 07:56)</a>:</h4>
<p>the issue here is something with how the return value is passed. it is too big to fit into registers, and we allocate stack space wrong: it overwrites the stored frame pointer and link register. that's how far I got last night</p>



<a name="391516101"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/391516101" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#391516101">(Sep 17 2023 at 14:31)</a>:</h4>
<p>on the pi at least I've got all of gen_num now <a href="https://github.com/roc-lang/roc/pull/5824">https://github.com/roc-lang/roc/pull/5824</a></p>



<a name="391861844"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/391861844" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#391861844">(Sep 19 2023 at 08:49)</a>:</h4>
<p>weird thing: if you use the github UI to rebase a PR then the commits are unverified</p>



<a name="391861902"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/391861902" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#391861902">(Sep 19 2023 at 08:49)</a>:</h4>
<p>but if you e.g. adjust the readme from the ui then the commit is verified (at least it used to be)</p>



<a name="391928554"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/391928554" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#391928554">(Sep 19 2023 at 14:45)</a>:</h4>
<p>Yeah, I noticed that. No idea why. Can rebase a second time locally and that should verify the commits, but kinda defeats the purpose of the GitHub you button.</p>



<a name="391992098"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/391992098" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#391992098">(Sep 19 2023 at 20:44)</a>:</h4>
<p><span class="user-mention" data-user-id="281383">@Richard Feldman</span> and <span class="user-mention" data-user-id="361169">@Anton</span> re Windows, I think there is still a couple of issues which are causing most of the test failures. I suspect the issue is in strings and lists. It's a little slow making progress with the tests running slowly due to issues with caching on windows.</p>



<a name="392072085"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/392072085" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#392072085">(Sep 20 2023 at 08:59)</a>:</h4>
<p>About the "issues with caching", do you mean locally or on CI?</p>



<a name="392075801"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/392075801" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#392075801">(Sep 20 2023 at 09:20)</a>:</h4>
<p>Locally, when you run tests on windows it looks like zig has to rebuild the builtins and link the app every time</p>



<a name="392122386"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/392122386" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#392122386">(Sep 20 2023 at 13:52)</a>:</h4>
<p>we know the cause of these issues right?</p>
<ul>
<li>we use zig in a tempdir, which means nothing gets cached between builds. The solution is to have a tempdir per thread, not per test, so after the first test most zig stuff is cached</li>
<li>we know that there is a segfault when rust tries to deallocate strings/lists that were allocated by a zig builtin.</li>
</ul>



<a name="392408788"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/392408788" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#392408788">(Sep 21 2023 at 23:13)</a>:</h4>
<p>For a test which returns <code>RocResult::ok(RocDec::from(6))</code> what would the equivalent zig type be? I'm having trouble tracking down something related in our builtins. I.e. </p>
<div class="codehilite" data-code-language="Zig"><pre><span></span><code><span class="kr">const</span><span class="w"> </span><span class="n">RocCallResult</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kr">extern</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">tag</span><span class="o">:</span><span class="w"> </span><span class="kt">u64</span><span class="p">,</span>
<span class="w">    </span><span class="n">error_msg</span><span class="o">:</span><span class="w"> </span><span class="kt">u64</span><span class="p">,</span>
<span class="w">    </span><span class="n">value</span><span class="o">:</span><span class="w"> </span><span class="n">RocResultOrSomething</span><span class="o">??</span><span class="p">,</span>
<span class="p">};</span>
</code></pre></div>



<a name="392410831"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/392410831" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#392410831">(Sep 21 2023 at 23:34)</a>:</h4>
<p>I think this has done the trick</p>
<div class="codehilite" data-code-language="Zig"><pre><span></span><code><span class="kr">const</span><span class="w"> </span><span class="n">RocCallResult</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kr">extern</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">tag</span><span class="o">:</span><span class="w"> </span><span class="kt">u64</span><span class="p">,</span>
<span class="w">    </span><span class="n">error_msg</span><span class="o">:</span><span class="w"> </span><span class="kt">u64</span><span class="p">,</span>
<span class="w">    </span><span class="n">value</span><span class="o">:</span><span class="w"> </span><span class="n">RocResult</span><span class="p">,</span>
<span class="p">};</span>

<span class="kr">const</span><span class="w"> </span><span class="n">RocDec</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kr">extern</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">num</span><span class="o">:</span><span class="w"> </span><span class="kt">i128</span><span class="p">,</span>

<span class="w">    </span><span class="kr">pub</span><span class="w"> </span><span class="k">fn</span><span class="w"> </span><span class="n">addWithOverflow</span><span class="p">(</span><span class="n">self</span><span class="o">:</span><span class="w"> </span><span class="n">RocDec</span><span class="p">,</span><span class="w"> </span><span class="n">other</span><span class="o">:</span><span class="w"> </span><span class="n">RocDec</span><span class="p">)</span><span class="w"> </span><span class="n">WithOverflow</span><span class="p">(</span><span class="n">RocDec</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kr">var</span><span class="w"> </span><span class="n">answer</span><span class="o">:</span><span class="w"> </span><span class="kt">i128</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">undefined</span><span class="p">;</span>
<span class="w">        </span><span class="kr">const</span><span class="w"> </span><span class="n">overflowed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">@addWithOverflow</span><span class="p">(</span><span class="kt">i128</span><span class="p">,</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">num</span><span class="p">,</span><span class="w"> </span><span class="n">other</span><span class="p">.</span><span class="n">num</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">answer</span><span class="p">);</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="p">.{</span><span class="w"> </span><span class="p">.</span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">RocDec</span><span class="p">{</span><span class="w"> </span><span class="p">.</span><span class="n">num</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">answer</span><span class="w"> </span><span class="p">},</span><span class="w"> </span><span class="p">.</span><span class="n">has_overflowed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">overflowed</span><span class="w"> </span><span class="p">};</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">};</span>

<span class="kr">const</span><span class="w"> </span><span class="n">RocResultTag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">enum</span><span class="p">(</span><span class="kt">u8</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">RocErr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<span class="w">    </span><span class="n">RocOk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span>
<span class="p">};</span>

<span class="kr">const</span><span class="w"> </span><span class="n">RocResultPayload</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kr">extern</span><span class="w"> </span><span class="k">union</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">ok</span><span class="o">:</span><span class="w"> </span><span class="n">RocDec</span><span class="p">,</span>
<span class="w">    </span><span class="n">err</span><span class="o">:</span><span class="w"> </span><span class="kt">u8</span><span class="p">,</span>
<span class="p">};</span>

<span class="kr">const</span><span class="w"> </span><span class="n">RocResult</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kr">extern</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">payload</span><span class="o">:</span><span class="w"> </span><span class="n">RocResultPayload</span><span class="p">,</span>
<span class="w">    </span><span class="n">tag</span><span class="o">:</span><span class="w"> </span><span class="n">RocResultTag</span><span class="p">,</span>
<span class="p">};</span>
</code></pre></div>



<a name="392410976"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/392410976" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#392410976">(Sep 21 2023 at 23:36)</a>:</h4>
<p>glad you figured something out.</p>



<a name="392883287"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/392883287" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#392883287">(Sep 25 2023 at 01:08)</a>:</h4>
<p>I have encountered a load-bearing <code>dbg!</code> in my Rust code - the program does something differently depending on whether I do a <code>dbg!(list.len())</code> <span aria-label="sweat smile" class="emoji emoji-1f605" role="img" title="sweat smile">:sweat_smile:</span></p>



<a name="392884663"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/392884663" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#392884663">(Sep 25 2023 at 01:21)</a>:</h4>
<p>Probably means you are forcing the optimizer to not remove code</p>



<a name="392884678"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/392884678" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#392884678">(Sep 25 2023 at 01:21)</a>:</h4>
<p>relatedly: anyone who has valgrind set up want to pair on a <code>basic-webserevr</code> bug sometime? <span aria-label="big smile" class="emoji emoji-1f604" role="img" title="big smile">:big_smile:</span></p>



<a name="392884745"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/392884745" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#392884745">(Sep 25 2023 at 01:22)</a>:</h4>
<p>I'm also seeing fun stuff like if I remove an <code>if Bool.false then</code> things work differently, so some UB somewhere seems likely to blame</p>



<a name="393086485"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/393086485" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#393086485">(Sep 25 2023 at 18:53)</a>:</h4>
<p>Rust achievement unlocked:</p>
<div class="codehilite"><pre><span></span><code>= note: import resolution is stuck, try simplifying macro imports
</code></pre></div>



<a name="393087246"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/393087246" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#393087246">(Sep 25 2023 at 18:57)</a>:</h4>
<p>This was during the upgrade to rust 1.72. I'm done for today, if anyone else wants to take a stab at fixing the import resolution error, by my guest :)<br>
<a href="https://github.com/roc-lang/roc/pull/5856">https://github.com/roc-lang/roc/pull/5856</a></p>



<a name="393088035"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/393088035" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#393088035">(Sep 25 2023 at 19:01)</a>:</h4>
<p>Important sidenote: this error pops up during <code>cargo test --release --no-run</code></p>



<a name="393093562"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/393093562" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#393093562">(Sep 25 2023 at 19:31)</a>:</h4>
<p>Just a note, clippy seems to be messing up the readability of a lot of the indoc tests.</p>



<a name="393196438"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/393196438" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#393196438">(Sep 26 2023 at 09:32)</a>:</h4>
<p>I don't know how to fix the import resolution so I'm going to upgrade to rust 1.71.1 first and not let clippy autofix things :p</p>



<a name="393495994"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/393495994" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#393495994">(Sep 27 2023 at 14:00)</a>:</h4>
<p>this could be really useful when we get to writing a debugger for <code>roc</code>! <a href="https://www.timdbg.com/posts/writing-a-debugger-from-scratch-part-1/">https://www.timdbg.com/posts/writing-a-debugger-from-scratch-part-1/</a></p>



<a name="393607322"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/393607322" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ayaz Hafiz <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#393607322">(Sep 28 2023 at 03:25)</a>:</h4>
<p>til <a href="https://en.wikipedia.org/wiki/X86_debug_register">https://en.wikipedia.org/wiki/X86_debug_register</a></p>



<a name="393669092"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/393669092" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rasheed Starlet <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#393669092">(Sep 28 2023 at 10:00)</a>:</h4>
<p><span class="user-mention silent" data-user-id="281383">Richard Feldman</span> <a href="#narrow/stream/395097-compiler-development/topic/Casual.20Conversation/near/393495994">said</a>:</p>
<blockquote>
<p>this could be really useful when we get to writing a debugger for <code>roc</code>! <a href="https://www.timdbg.com/posts/writing-a-debugger-from-scratch-part-1/">https://www.timdbg.com/posts/writing-a-debugger-from-scratch-part-1/</a></p>
</blockquote>
<p>I am keeping my eyes peeled waiting for when it is time for writing the debugger.<br>
<span class="user-mention" data-user-id="281383">@Richard Feldman</span> when will that be?</p>



<a name="393676210"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/393676210" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#393676210">(Sep 28 2023 at 10:40)</a>:</h4>
<p>no concrete plans yet, but there's nothing blocking it as far as I know! Is it something you're interested in working on?</p>



<a name="393698630"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/393698630" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rasheed Starlet <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#393698630">(Sep 28 2023 at 12:08)</a>:</h4>
<p>Yes but I don’t have the technical know how to take on that task yet, It would take me some time to level up before.</p>



<a name="393698848"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/393698848" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Notification Bot <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#393698848">(Sep 28 2023 at 12:09)</a>:</h4>
<p><a href="#narrow/stream/395097-compiler-development/topic/casual.20conversation/near/393697825">A message</a> was moved here from <a class="stream-topic" data-stream-id="395097" href="/#narrow/stream/395097-compiler-development/topic/yes.20but.20I.20don.E2.80.99t.20have.20the.20technical.20know.20how.20to.20pick.20on.20su.2E.2E.2E">#compiler development &gt; yes but I don’t have the technical know how to pick on su...</a> by <span class="user-mention silent" data-user-id="652645">Rasheed Starlet</span>.</p>



<a name="393741741"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/393741741" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#393741741">(Sep 28 2023 at 14:48)</a>:</h4>
<p>I think we would first need good debug info generation before we would be interested in our own debugger</p>



<a name="393741812"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/393741812" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#393741812">(Sep 28 2023 at 14:49)</a>:</h4>
<p>Like our code should work well with a regular debugger first</p>



<a name="393917592"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/393917592" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#393917592">(Sep 29 2023 at 12:02)</a>:</h4>
<p>I'm doing a Software Unscripted episode with Matt Godbolt and he said "we should absolutely get Roc on Godbolt"</p>



<a name="393918456"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/393918456" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#393918456">(Sep 29 2023 at 12:08)</a>:</h4>
<p>also he tried the nightly on a fresh Ubuntu install and when he put "hello world" into the repl and got a panic about missing a dynamic library</p>



<a name="393919572"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/393919572" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#393919572">(Sep 29 2023 at 12:16)</a>:</h4>
<p>Hmm, we do test every nightly's repl on ubuntu, but this is github's workflow runner ubuntu so its dependencies are different. I happen to have a clean ubuntu vm so I'll try to reproduce.</p>



<a name="393921083"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/393921083" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#393921083">(Sep 29 2023 at 12:26)</a>:</h4>
<p>I was able to reproduce it, I'll make an issue for the error and another one to test nightlies on all kinds of docker containers to mimic fresh installs.</p>



<a name="393929540"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/393929540" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#393929540">(Sep 29 2023 at 13:19)</a>:</h4>
<p>awesome! I relayed this to him (we just finished recording) and he asked if there's something he can quickly <code>apt-get install</code> to fix it <span aria-label="big smile" class="emoji emoji-1f604" role="img" title="big smile">:big_smile:</span></p>



<a name="393933232"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/393933232" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#393933232">(Sep 29 2023 at 13:40)</a>:</h4>
<p>I'll look at it right now</p>



<a name="393933577"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/393933577" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#393933577">(Sep 29 2023 at 13:43)</a>:</h4>
<p>The amount of time that would be saved if the "No such file or directory" actually told you what file or dir it was looking for... :p</p>



<a name="393934214"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/393934214" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#393934214">(Sep 29 2023 at 13:46)</a>:</h4>
<p>one of my coworkers who has been helping me with getting Roc incorporated into certain parts of the build just started trying it out, and DM'd me a bunch of questions for things he ran into as a beginner, followed by:</p>
<blockquote>
<p>Richard, what have you done, now I just want to Roc(k) hahaha</p>
</blockquote>



<a name="393934675"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/393934675" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#393934675">(Sep 29 2023 at 13:49)</a>:</h4>
<p>we made a good thing! <span aria-label="heart" class="emoji emoji-2764" role="img" title="heart">:heart:</span></p>



<a name="393935456"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/393935456" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rasheed Starlet <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#393935456">(Sep 29 2023 at 13:54)</a>:</h4>
<p><span class="user-mention silent" data-user-id="281383">Richard Feldman</span> <a href="#narrow/stream/395097-compiler-development/topic/Casual.20Conversation/near/393934675">said</a>:</p>
<blockquote>
<p>we made a good thing! <span aria-label="heart" class="emoji emoji-2764" role="img" title="heart">:heart:</span></p>
</blockquote>
<p>that people love</p>



<a name="393946211"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/393946211" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#393946211">(Sep 29 2023 at 14:50)</a>:</h4>
<blockquote>
<p>awesome! I relayed this to him (we just finished recording) and he asked if there's something he can quickly <code>apt-get install</code> to fix it <span aria-label="big smile" class="emoji emoji-1f604" role="img" title="big smile">:big_smile:</span></p>
</blockquote>
<p>I'm not sure what part of this script fixes the issue but it does :p I'll look into a less bloated fix later.</p>
<div class="codehilite"><pre><span></span><code>wget https://apt.llvm.org/llvm.sh
chmod +x llvm.sh
sudo ./llvm.sh 13
</code></pre></div>
<p><code>sudo apt install llvm-13</code> does not work btw</p>



<a name="393946535"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/393946535" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#393946535">(Sep 29 2023 at 14:52)</a>:</h4>
<p>it might be missing certain features? what features are enabled for their official builds seems very random</p>



<a name="393975350"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/393975350" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#393975350">(Sep 29 2023 at 17:25)</a>:</h4>
<p>why is cargo slow, you ask? well maybe because they just casually perform many small allocations in a recent PR? </p>
<p><a href="https://github.com/rust-lang/cargo/pull/12751/files">https://github.com/rust-lang/cargo/pull/12751/files</a></p>
<p>it's just really weird to read that code?! it's so easy to remove most of those allocations</p>



<a name="393976645"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/393976645" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#393976645">(Sep 29 2023 at 17:34)</a>:</h4>
<p><span class="user-mention silent" data-user-id="361169">Anton</span> <a href="#narrow/stream/395097-compiler-development/topic/Casual.20Conversation/near/393946211">said</a>:</p>
<blockquote>
<blockquote>
<p>awesome! I relayed this to him (we just finished recording) and he asked if there's something he can quickly <code>apt-get install</code> to fix it <span aria-label="big smile" class="emoji emoji-1f604" role="img" title="big smile">:big_smile:</span></p>
</blockquote>
<p>I'm not sure what part of this script fixes the issue but it does :p I'll look into a less bloated fix later.</p>
<div class="codehilite"><pre><span></span><code>wget https://apt.llvm.org/llvm.sh
chmod +x llvm.sh
sudo ./llvm.sh 13
</code></pre></div>
<p><code>sudo apt install llvm-13</code> does not work btw</p>
</blockquote>
<p>Thanks! I'm surprised llvm isn't statically compiled into the <code>roc</code> binary though <span aria-label="face with raised eyebrow" class="emoji emoji-1f928" role="img" title="face with raised eyebrow">:face_with_raised_eyebrow:</span></p>



<a name="393976779"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/393976779" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#393976779">(Sep 29 2023 at 17:34)</a>:</h4>
<p>also surprising: I believe he's on x64, and ran into this in the repl...but the latest Linux x64 nightly should use the dev backend in the repl, not LLVM! <span aria-label="thinking" class="emoji emoji-1f914" role="img" title="thinking">:thinking:</span></p>



<a name="393979815"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/393979815" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#393979815">(Sep 29 2023 at 17:58)</a>:</h4>
<p>Doesn't matter the backend? Probably still loads the same shared libraries</p>



<a name="393979857"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/393979857" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#393979857">(Sep 29 2023 at 17:58)</a>:</h4>
<p>Though maybe somehow it failed to the load the dev backend generated shared library for the repl.</p>



<a name="393979983"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/393979983" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#393979983">(Sep 29 2023 at 17:59)</a>:</h4>
<p>Also, yeah, llvm can't be dynamic. Otherwise we would see way way more versioning issues, right?</p>



<a name="393980059"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/393980059" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#393980059">(Sep 29 2023 at 17:59)</a>:</h4>
<p>I would certainly think so! <span aria-label="sweat smile" class="emoji emoji-1f605" role="img" title="sweat smile">:sweat_smile:</span></p>



<a name="393983446"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/393983446" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#393983446">(Sep 29 2023 at 18:24)</a>:</h4>
<p>Yeah, I think it's something the llvmsh script installs, not llvm itself</p>



<a name="393983740"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/393983740" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#393983740">(Sep 29 2023 at 18:26)</a>:</h4>
<blockquote>
<p>Though maybe somehow it failed to the load the dev backend generated shared library for the repl.</p>
</blockquote>
<p>Yes indeed</p>



<a name="394008736"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/394008736" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#394008736">(Sep 29 2023 at 21:45)</a>:</h4>
<p>This is interesting: <a href="https://github.com/simd-everywhere/simde">https://github.com/simd-everywhere/simde</a></p>



<a name="394066229"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/394066229" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#394066229">(Sep 30 2023 at 08:58)</a>:</h4>
<p>Nice :)</p>



<a name="394104641"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/394104641" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#394104641">(Sep 30 2023 at 18:27)</a>:</h4>
<blockquote>
<p>Yeah, I think it's something the llvmsh script installs, not llvm itself</p>
</blockquote>
<p>Alright, found it, ld was missing, this can be fixed on Ubuntu with:</p>
<div class="codehilite"><pre><span></span><code>sudo apt install binutils
</code></pre></div>



<a name="394105460"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/394105460" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#394105460">(Sep 30 2023 at 18:36)</a>:</h4>
<p>I've added this to the linux getting started as well:<br>
<a href="https://github.com/roc-lang/roc/pull/5872">https://github.com/roc-lang/roc/pull/5872</a></p>



<a name="395333326"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/395333326" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#395333326">(Oct 06 2023 at 21:50)</a>:</h4>
<p>Does anyone know if it should be possible to import URL packages in the platform main file just like an app? I haven't been able to get it working. I'm getting errors like</p>
<div class="codehilite"><pre><span></span><code>thread &#39;main&#39; panicked at &#39;[Qualified(&quot;json&quot;, json.Core)] not in {} &#39;, crates/compiler/load_internal/src/file.rs:2211:25
note: run with `RUST_BACKTRACE=1` environment variable to display a backtrace
</code></pre></div>



<a name="395347063"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/395347063" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#395347063">(Oct 07 2023 at 00:39)</a>:</h4>
<p>it should be, but I remember there's some bug with it from way back <span aria-label="sweat smile" class="emoji emoji-1f605" role="img" title="sweat smile">:sweat_smile:</span></p>



<a name="395347093"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/395347093" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#395347093">(Oct 07 2023 at 00:39)</a>:</h4>
<p>might need to vendor it for now as a workaround</p>



<a name="395502488"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/395502488" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#395502488">(Oct 08 2023 at 07:20)</a>:</h4>
<p><a href="https://twitter.com/VictorTaelin/status/1710766199288570079">https://twitter.com/VictorTaelin/status/1710766199288570079</a> I saw the discussion about compiling Elm and making fast graphics apps and thought maybe this be relevant to Roc.</p>



<a name="395650628"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/395650628" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#395650628">(Oct 09 2023 at 08:58)</a>:</h4>
<p>Fascinating. It would be cool to have Victor Taelin on Software Unscripted <span class="user-mention" data-user-id="281383">@Richard Feldman</span></p>



<a name="395850427"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/395850427" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#395850427">(Oct 10 2023 at 10:15)</a>:</h4>
<p>What does the alignment mean in this function on a RocList <code>pub fn decref(self: RocList, alignment: u32) void</code>?</p>



<a name="395902785"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/395902785" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#395902785">(Oct 10 2023 at 14:59)</a>:</h4>
<p>Alignment is a memory loading concept. In aggregate data, it tends to be the size of the largest thing in the aggregate.</p>



<a name="395904685"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/395904685" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#395904685">(Oct 10 2023 at 15:08)</a>:</h4>
<p>This ended up being a good mini talk on why llvm is often a pain: <a href="https://youtu.be/g1qF9LZOoFE?si=7tifU78yyT1K2ZZy">https://youtu.be/g1qF9LZOoFE?si=7tifU78yyT1K2ZZy</a></p>
<div class="youtube-video message_inline_image"><a data-id="g1qF9LZOoFE" href="https://youtu.be/g1qF9LZOoFE?si=7tifU78yyT1K2ZZy"><img src="https://uploads.zulipusercontent.net/0978bfd248a915274a76066c6586e500b9b0aa2a/68747470733a2f2f692e7974696d672e636f6d2f76692f67317146394c5a4f6f46452f64656661756c742e6a7067"></a></div>



<a name="395910009"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/395910009" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#395910009">(Oct 10 2023 at 15:36)</a>:</h4>
<p>yes fun talk!</p>



<a name="396144198"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/396144198" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#396144198">(Oct 11 2023 at 18:25)</a>:</h4>
<p>wow, I had largely given up hope that this would ever land! <span aria-label="sweat smile" class="emoji emoji-1f605" role="img" title="sweat smile">:sweat_smile:</span> </p>
<p><a href="https://reviews.llvm.org/D86310">https://reviews.llvm.org/D86310</a></p>



<a name="396167911"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/396167911" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#396167911">(Oct 11 2023 at 21:33)</a>:</h4>
<p>Wow yeah, nice</p>



<a name="396606610"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/396606610" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#396606610">(Oct 14 2023 at 03:46)</a>:</h4>
<p>Trying to compile from main and I think there may be something up with the nix configuration. I haven't seen this before.</p>
<div class="codehilite"><pre><span></span><code>192-168-1-105:roc luke$ nix develop
192-168-1-105:roc luke$ cargo build --release --locked
   Compiling roc_repl_wasm v0.0.1 (/Users/luke/Documents/GitHub/roc/crates/repl_wasm)
error: failed to run custom build command for `roc_repl_wasm v0.0.1 (/Users/luke/Documents/GitHub/roc/crates/repl_wasm)`

Caused by:
  process didn&#39;t exit successfully: `/Users/luke/Documents/GitHub/roc/target/release/build/roc_repl_wasm-ba13b2d4af2101b5/build-script-build` (exit status: 101)
  --- stdout
  cargo:rerun-if-changed=build.rs
  cargo:rerun-if-changed=src/repl_platform.c

  --- stderr
  thread &#39;main&#39; panicked at &#39;Output {
      status: ExitStatus(
          unix_wait_status(
              256,
          ),
      ),
      stdout: &quot;&quot;,
      stderr: &quot;wasm-ld: error: Unknown attribute kind (86) (Producer: &#39;LLVM16.0.6&#39; Reader: &#39;LLVM 13.0.1&#39;)\n&quot;,
  }&#39;, crates/repl_wasm/build.rs:48:5
  note: run with `RUST_BACKTRACE=1` environment variable to display a backtrace
</code></pre></div>



<a name="396608724"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/396608724" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#396608724">(Oct 14 2023 at 04:12)</a>:</h4>
<p>Looks like you are still pulling in new zig from when you used the updated llvm branch?</p>



<a name="396608733"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/396608733" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#396608733">(Oct 14 2023 at 04:13)</a>:</h4>
<p>Or something newer in your stack</p>



<a name="396608759"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/396608759" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#396608759">(Oct 14 2023 at 04:13)</a>:</h4>
<p>That or a cached file that was built when you were on an updated branch....something along these lines</p>



<a name="396616690"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/396616690" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#396616690">(Oct 14 2023 at 05:28)</a>:</h4>
<p>Thank you <span class="user-mention" data-user-id="343810">@Brendan Hansknecht</span> <code>cargo clean</code> did the job!</p>



<a name="397407364"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/397407364" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ayaz Hafiz <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#397407364">(Oct 19 2023 at 01:36)</a>:</h4>
<p>from <a href="https://nibblestew.blogspot.com/2023/10/the-road-to-hell-is-paved-with-good.html">https://nibblestew.blogspot.com/2023/10/the-road-to-hell-is-paved-with-good.html</a></p>
<div class="codehilite"><pre><span></span><code>module;
#include&lt;evil.h&gt;
export module I_AM_A_DEFINE_GOOD_LUCK_FINDING_OUT_WHERE_I_COME_FROM;
</code></pre></div>
<p>sometimes I really wonder what is happens behind the C++ committee doors</p>



<a name="397517619"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/397517619" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ayaz Hafiz <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#397517619">(Oct 19 2023 at 14:25)</a>:</h4>
<p>Really interesting presentation from Modular/Mojo developers: <a href="https://www.modular.com/blog/mojo-llvm-2023">https://www.modular.com/blog/mojo-llvm-2023</a></p>
<p>Clever how the surface syntax almost immediately desugars to an MLIR. The slides on JIT architecture are super interesting too, especially the idea regarding shipping packages with bytecode for eval</p>



<a name="397519836"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/397519836" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#397519836">(Oct 19 2023 at 14:36)</a>:</h4>
<p>I thought their ideas of taking control of more llvm passes and then running llvm in parallel on a per function level is quite intriguing</p>



<a name="397520025"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/397520025" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#397520025">(Oct 19 2023 at 14:37)</a>:</h4>
<p>How to work around the beast of llvm</p>



<a name="397791275"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/397791275" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#397791275">(Oct 21 2023 at 00:15)</a>:</h4>
<p>apparently part of how bun is so fast! <a href="https://github.com/simdutf/simdutf">https://github.com/simdutf/simdutf</a></p>



<a name="397791839"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/397791839" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ayaz Hafiz <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#397791839">(Oct 21 2023 at 00:22)</a>:</h4>
<p>and nodejs!</p>



<a name="397847222"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/397847222" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#397847222">(Oct 21 2023 at 12:37)</a>:</h4>
<p>ooo <span aria-label="eyes" class="emoji emoji-1f440" role="img" title="eyes">:eyes:</span>  <a href="https://twitter.com/__protected/status/1715693892933153144">https://twitter.com/__protected/status/1715693892933153144</a></p>



<a name="397847661"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/397847661" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#397847661">(Oct 21 2023 at 12:46)</a>:</h4>
<p>at the end of that thread are links to papers, including: <a href="https://2023.splashcon.org/details/splash-2023-oopsla/47/Getting-into-the-Flow-Towards-Better-Type-Error-Messages-for-Constraint-Based-Type-I">https://2023.splashcon.org/details/splash-2023-oopsla/47/Getting-into-the-Flow-Towards-Better-Type-Error-Messages-for-Constraint-Based-Type-I</a></p>



<a name="397933504"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/397933504" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#397933504">(Oct 22 2023 at 10:27)</a>:</h4>
<p>Is there anyone online who has an apple silicon Mac and is able to test something for me? I have a graphical "hello world" in <a href="https://gist.github.com/lukewilliamboswell/acac5b641ac4b93ff2c1979eecfb6b54">this gist</a>  and am interested to know if it works for others or if there are issues. It should be a prebuilt-package so <em>just work</em>, as you need the latest zig to re-build the platform. Next step is to figure out what I need to cross-compile to various platforms so I can pre-build those object/archive files too.</p>



<a name="397933582"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/397933582" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#397933582">(Oct 22 2023 at 10:28)</a>:</h4>
<p>Oh, it should spit out a <code>zigimg.png</code> file in the local directory where you run it from using <code>roc run test.roc</code></p>



<a name="397942219"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/397942219" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ayaz Hafiz <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#397942219">(Oct 22 2023 at 12:43)</a>:</h4>
<p>I can try it in 15 min</p>



<a name="397942968"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/397942968" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ayaz Hafiz <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#397942968">(Oct 22 2023 at 12:55)</a>:</h4>
<p>"just worked" for me!</p>



<a name="398088207"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/398088207" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ayaz Hafiz <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#398088207">(Oct 23 2023 at 13:43)</a>:</h4>
<p><a href="https://dl.acm.org/doi/pdf/10.1145/3607858">https://dl.acm.org/doi/pdf/10.1145/3607858</a></p>



<a name="398088523"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/398088523" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#398088523">(Oct 23 2023 at 13:44)</a>:</h4>
<p>that trick to also store the color of an RBTree in the pointer (because you only need one bit for the node type) is cool</p>



<a name="398088672"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/398088672" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#398088672">(Oct 23 2023 at 13:45)</a>:</h4>
<p>you want very flexible niches on the one hand, on the other hand we need to generate code (and maybe also debuginfo) for that and that is hard</p>



<a name="398090255"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/398090255" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ayaz Hafiz <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#398090255">(Oct 23 2023 at 13:52)</a>:</h4>
<p>Yeah I agree. The codegen is painful, both to implement and debug</p>



<a name="398090374"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/398090374" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ayaz Hafiz <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#398090374">(Oct 23 2023 at 13:53)</a>:</h4>
<p>I feel like there must be some fundamental theorem that shows optimal-niche-finding is np-complete. it feels the same as instruction selection.</p>



<a name="398129021"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/398129021" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#398129021">(Oct 23 2023 at 17:26)</a>:</h4>
<p>Maybe useful to us at some point:<br>
<a href="https://www.npopov.com/2023/10/22/How-to-reduce-LLVM-crashes.html">https://www.npopov.com/2023/10/22/How-to-reduce-LLVM-crashes.html</a></p>



<a name="398580048"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/398580048" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#398580048">(Oct 26 2023 at 00:11)</a>:</h4>
<p>I've got another build of basic-graphics <a href="https://gist.github.com/lukewilliamboswell/bacf63b0d65fa284733cd3b5d1213dfc">gist of example here</a>; I think I have managed to include in the bundle a build for for the following targets:</p>
<ul>
<li>linux-x64</li>
<li>macOS-arm64</li>
<li>macOS-x64 </li>
</ul>
<p><del>Just wondering if anyone could test this for me? and let me know if you have any issues. </del></p>
<p>I would like to clean up the API a fair bit, but hoping I have all the parts together and working now.</p>
<p>EDIT: It does't work on Linux, I need to do more work to make that just work.</p>



<a name="398580139"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/398580139" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ayaz Hafiz <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#398580139">(Oct 26 2023 at 00:12)</a>:</h4>
<p>I think we’ll check in the language server in. Please review it or merge here: <a href="https://github.com/roc-lang/roc/pull/5937">https://github.com/roc-lang/roc/pull/5937</a></p>



<a name="398580185"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/398580185" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ayaz Hafiz <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#398580185">(Oct 26 2023 at 00:12)</a>:</h4>
<p>Also, the first CI job appears done in the details page, but the status check didn’t update. <span class="user-mention" data-user-id="361169">@Anton</span>  any ideas?</p>



<a name="398596837"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/398596837" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#398596837">(Oct 26 2023 at 03:22)</a>:</h4>
<p>Needed some tweaking to get the tests running on my current macos machine; fixed here: <a href="https://github.com/roc-lang/roc/pull/5938">https://github.com/roc-lang/roc/pull/5938</a></p>
<p>If folks have thoughts on whether we should go for the <code>xcode-select --print-path</code> approach instead, that'd be useful.</p>



<a name="400180694"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/400180694" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#400180694">(Nov 03 2023 at 17:47)</a>:</h4>
<p>lots of sweet stuff in here, but at the end he notes that you can make 32 bit pointers that Just Work on a 64-bit system, which immediately makes sense, but which had never actually occurred to me! <a href="https://www.youtube.com/watch?v=H8THRznXxpQ">https://www.youtube.com/watch?v=H8THRznXxpQ</a></p>
<div class="youtube-video message_inline_image"><a data-id="H8THRznXxpQ" href="https://www.youtube.com/watch?v=H8THRznXxpQ"><img src="https://uploads.zulipusercontent.net/ce7ec0b2e4e37c7488de1e5aae5bbc4d9a9526ca/68747470733a2f2f692e7974696d672e636f6d2f76692f48385448527a6e587870512f64656661756c742e6a7067"></a></div>



<a name="400183522"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/400183522" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Carroll <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#400183522">(Nov 03 2023 at 18:05)</a>:</h4>
<p>Oh I watched that video a few weeks ago but never got as far as that 32-bit trick! Will rewatch it. I've been taking his course since the start, enjoying it.</p>



<a name="400185529"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/400185529" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Carroll <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#400185529">(Nov 03 2023 at 18:20)</a>:</h4>
<p>Wow yeah so memory addresses are virtual and you can force them to be under 2^32 for your process as long as you don't actually use more than 4GB. Crazy.<br>
So you could shrink all pointers in your data structures from 64 to 32 and fit more stuff in cache.<br>
I never heard of this before and suddenly I think it's weird that more people don't do it!</p>



<a name="400776986"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/400776986" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#400776986">(Nov 07 2023 at 16:35)</a>:</h4>
<p>Do you guys know that rust has not small string optimization at all? It also can't ever have small string optimization due to how it defines its apis. Vec guarentees that it is always heap allocated. And String guaretees it can always seamlessly convert to a Vec without copying any data. As such String must also be heap allocated.</p>



<a name="400778290"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/400778290" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#400778290">(Nov 07 2023 at 16:42)</a>:</h4>
<p>I guess the main arguments are:</p>
<ol>
<li>SSO means that Strings and Vecs are not seamless in conversion/representation.</li>
<li>Most cases where SSO is a huge win are also the cases where <code>&amp;str</code> is a huge win. So SSO is often not actually used/needed.</li>
<li>Most other SSO use cases are constants where it doesn't matter anyway.</li>
<li>SSO is an extra often unpredictable branch.</li>
<li>SSO can always be done in userland if someone finds a case where they really need it.</li>
</ol>



<a name="400778602"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/400778602" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#400778602">(Nov 07 2023 at 16:44)</a>:</h4>
<p>Make me wonder how our perf would be affect if we dropped SSO and instead only had seamless slices. That said, <code>&amp;str</code> should be strictly higher perf than seamless slices, so maybe that wouldn't map to Roc in the same way.</p>



<a name="400778666"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/400778666" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#400778666">(Nov 07 2023 at 16:45)</a>:</h4>
<p>Cause <code>&amp;str</code> is in the type system and avoids runtime checks. It also doesn't have to deal with any sort of refcount.</p>



<a name="400778772"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/400778772" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#400778772">(Nov 07 2023 at 16:45)</a>:</h4>
<p>Really old and long threads on this:</p>
<ul>
<li><a href="https://internals.rust-lang.org/t/short-string-optimization/8436">https://internals.rust-lang.org/t/short-string-optimization/8436</a></li>
<li><a href="https://github.com/rust-lang/rust/issues/20198">https://github.com/rust-lang/rust/issues/20198</a></li>
</ul>



<a name="400837831"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/400837831" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#400837831">(Nov 08 2023 at 00:14)</a>:</h4>
<p>The <a href="https://github.com/roc-lang/roc/blob/main/getting_started/macos_apple_silicon.md">https://github.com/roc-lang/roc/blob/main/getting_started/macos_apple_silicon.md</a> states that we do not yet support MacOS 13, is this still true?</p>



<a name="400839057"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/400839057" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#400839057">(Nov 08 2023 at 00:25)</a>:</h4>
<p>Oh, that is outdated now that we updated zig</p>



<a name="400902524"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/400902524" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#400902524">(Nov 08 2023 at 09:17)</a>:</h4>
<p>I'll fix that</p>



<a name="400996668"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/400996668" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ayaz Hafiz <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#400996668">(Nov 08 2023 at 18:01)</a>:</h4>
<p>Semi-big development update: we're going to halt development on lambda sets for now, in favor of getting boxed closures to work across the board, so that we can unblock development on effect interpreters.</p>



<a name="400997701"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/400997701" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#400997701">(Nov 08 2023 at 18:06)</a>:</h4>
<p>this means closures will be heap-allocated, which unfortunately means worse runtime performance. However, this is actually something we want to try to speed up dev builds in the long term anyway (that is, heap allocating closures), so switching to having them all work that way will give us more data points about the runtime cost in practice as well as some idea of the effect on compile times</p>



<a name="401004532"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/401004532" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Carroll <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#401004532">(Nov 08 2023 at 18:53)</a>:</h4>
<p>I bet that was a tough call, sounds wise to move things forward.<br>
Does the boxed closure contain a function pointer or a tag union or both?</p>



<a name="401008137"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/401008137" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#401008137">(Nov 08 2023 at 19:17)</a>:</h4>
<p>just function pointer</p>



<a name="401008289"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/401008289" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#401008289">(Nov 08 2023 at 19:18)</a>:</h4>
<p>maybe we could keep the current functionality behind a flag like <code>--experimental-closures</code> or something, to make it easier to compare perf impact and compile times with and without</p>



<a name="401008870"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/401008870" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Carroll <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#401008870">(Nov 08 2023 at 19:22)</a>:</h4>
<p>Ok, where's the captured data stored?</p>



<a name="401009157"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/401009157" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Carroll <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#401009157">(Nov 08 2023 at 19:24)</a>:</h4>
<p>Is it a box containing a structure of function pointer and data?</p>



<a name="401010436"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/401010436" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#401010436">(Nov 08 2023 at 19:33)</a>:</h4>
<p>yeah exactly</p>



<a name="401012127"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/401012127" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#401012127">(Nov 08 2023 at 19:45)</a>:</h4>
<p>I hope llvm can still inline them ok.</p>



<a name="401012250"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/401012250" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ayaz Hafiz <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#401012250">(Nov 08 2023 at 19:46)</a>:</h4>
<p>Actually, it’s a bit more efficient than that. instead of boxing the pointer, it’s stored as a fat pointer. A boxed closure is a three-word record - one for the pointer, one for the closure data (or NULL), one for the ref counter function (or NULL). I have more details in <a href="https://www.notion.so/rwx/Type-Erasure-a3ed13ef1305422eba00dbda026e52b3?pvs=4">https://www.notion.so/rwx/Type-Erasure-a3ed13ef1305422eba00dbda026e52b3?pvs=4</a></p>



<a name="401012293"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/401012293" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#401012293">(Nov 08 2023 at 19:46)</a>:</h4>
<p>Also, just curious, why this over still keeping our static dispatch with a switch statement, but with just boxing the data. I thought mostly the data was the issue, not the function pionters.</p>



<a name="401012490"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/401012490" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ayaz Hafiz <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#401012490">(Nov 08 2023 at 19:48)</a>:</h4>
<p>We still end up needing the effective equivalent of lambda sets in that case</p>



<a name="401012583"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/401012583" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#401012583">(Nov 08 2023 at 19:48)</a>:</h4>
<p>ah. ok.</p>



<a name="401012841"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/401012841" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#401012841">(Nov 08 2023 at 19:51)</a>:</h4>
<p>Also, for the refcounter function, is it a function that could be called by the host to increment the refcount of all closure captures such that the host can call the same closure multiple times?</p>



<a name="401013163"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/401013163" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ayaz Hafiz <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#401013163">(Nov 08 2023 at 19:53)</a>:</h4>
<p>I think it could be, but I haven't fully thought that through. The host would need to manage the lifetime though</p>



<a name="401078200"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/401078200" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ayaz Hafiz <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#401078200">(Nov 09 2023 at 05:19)</a>:</h4>
<p>If you have any friends working on type theories or PL PhDs, would appreciate if you share this with them: <a href="https://github.com/roc-lang/roc/issues/5969">https://github.com/roc-lang/roc/issues/5969</a></p>



<a name="401460615"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/401460615" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#401460615">(Nov 11 2023 at 01:35)</a>:</h4>
<p><a href="https://abseil.io/docs/cpp/atomic_danger#performance-considerations">https://abseil.io/docs/cpp/atomic_danger#performance-considerations</a> very interesting</p>



<a name="401460640"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/401460640" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#401460640">(Nov 11 2023 at 01:35)</a>:</h4>
<p>just use mutexes I guess. that should keep things simple in nea</p>



<a name="401484939"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/401484939" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ayaz Hafiz <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#401484939">(Nov 11 2023 at 06:23)</a>:</h4>
<p><a href="https://blog.rust-lang.org/2023/11/09/parallel-rustc.html">https://blog.rust-lang.org/2023/11/09/parallel-rustc.html</a></p>
<p>we should try and see if this helps our project</p>



<a name="401485251"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/401485251" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ayaz Hafiz <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#401485251">(Nov 11 2023 at 06:28)</a>:</h4>
<p><a href="/user_uploads/22008/X99nGAfgBCCpn_ZMwTNzr7Ct/IMG_3540.jpeg">IMG_3540.jpeg</a></p>
<div class="message_inline_image"><a href="/user_uploads/22008/X99nGAfgBCCpn_ZMwTNzr7Ct/IMG_3540.jpeg" title="IMG_3540.jpeg"><img src="/user_uploads/22008/X99nGAfgBCCpn_ZMwTNzr7Ct/IMG_3540.jpeg"></a></div>



<a name="401485345"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/401485345" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ayaz Hafiz <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#401485345">(Nov 11 2023 at 06:30)</a>:</h4>
<p>this is actually really surprising to me, especially with the heavy multi-pass LLVM backend. i guess part of it might be explained by Rust trait selection/method selection being pretty involved. But it’s something we should be mindful of-right now all inference in our compiler is single pass, intentionally, and making it multi pass could have effects like this</p>



<a name="401495195"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/401495195" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#401495195">(Nov 11 2023 at 09:16)</a>:</h4>
<p>It just sounds like they manage to run more llvm threads at the same time cause other stuff finishes sooner, right?</p>



<a name="401495208"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/401495208" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#401495208">(Nov 11 2023 at 09:16)</a>:</h4>
<p>So that is why llvm is faster</p>



<a name="401520006"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/401520006" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ayaz Hafiz <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#401520006">(Nov 11 2023 at 15:35)</a>:</h4>
<p>i mean in principle the unit of parallelism between the front end and backend should be the same though</p>



<a name="401528942"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/401528942" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#401528942">(Nov 11 2023 at 16:55)</a>:</h4>
<p>Pretty sure this is why it is faster 8 instead of 1 thread generating llvm ir at the boundary of frontend and backend</p>
<blockquote>
<p>Eight of the LLVM threads start at the same time. This is because the eight "rustc" threads create the LLVM IR for eight codegen units in parallel. (For seven of those threads that is the only work they do in the back-end.) After that, the staircase effect returns because only one "rustc" thread does LLVM IR generation while seven or more LLVM threads are active. If the number of threads used by the front-end was changed to 16 the staircase shape would disappear entirely, though in this case the final execution time would barely change.</p>
</blockquote>



<a name="401607017"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/401607017" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#401607017">(Nov 12 2023 at 11:46)</a>:</h4>
<p><a href="https://utcc.utoronto.ca/~cks/space/blog/programming/GoModulesAndDomainExpiry">https://utcc.utoronto.ca/~cks/space/blog/programming/GoModulesAndDomainExpiry</a></p>
<blockquote>
<p>Let me be clear that this is a hard problem in general and no one has a good answer to it</p>
</blockquote>
<p>or at least no one <em>had</em> a good answer to it... <span aria-label="wink" class="emoji emoji-1f609" role="img" title="wink">:wink:</span></p>



<a name="401607131"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/401607131" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#401607131">(Nov 12 2023 at 11:48)</a>:</h4>
<p>(to be fair, we also don't have a solution for URL-based packages to the problem of "the domain expired or got taken over and now I don't have a good way to notify people about where the new package lives)</p>



<a name="401607182"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/401607182" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#401607182">(Nov 12 2023 at 11:49)</a>:</h4>
<p>but we do have a good answer to the security problems, and not just "any new owner of your package's URL has limited scope for being malicious" or "in theory they can't publish a new version (with malicious code) and have it automatically picked up by current users, because existing users will stick with the current version until they specifically update (new users of the package are not so lucky)"</p>



<a name="401932411"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/401932411" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#401932411">(Nov 14 2023 at 08:33)</a>:</h4>
<p>very interesting issue with the derived eq implementation here</p>
<p><a href="https://github.com/rust-lang/rust/issues/117800">https://github.com/rust-lang/rust/issues/117800</a></p>
<p>in this case changing the codegen gave a 10% speedup</p>
<p><a href="https://github.com/bevyengine/bevy/pull/10519">https://github.com/bevyengine/bevy/pull/10519</a></p>



<a name="401977453"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/401977453" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#401977453">(Nov 14 2023 at 12:37)</a>:</h4>
<p>really interesting real-world comparison of monomorphization and dictionary passing for parametric polymorphism </p>
<p><a href="https://planetscale.com/blog/generics-can-make-your-go-code-slower">https://planetscale.com/blog/generics-can-make-your-go-code-slower</a></p>



<a name="402111797"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/402111797" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#402111797">(Nov 15 2023 at 01:44)</a>:</h4>
<p>Is this glue issue an easy fix? <span class="user-mention" data-user-id="343810">@Brendan Hansknecht</span> do you know?<br>
<a href="/user_uploads/22008/ZTaUPWOzLkFuHlOESevP6jfh/Screenshot-2023-11-15-at-12.43.29.png">Screenshot-2023-11-15-at-12.43.29.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/22008/ZTaUPWOzLkFuHlOESevP6jfh/Screenshot-2023-11-15-at-12.43.29.png" title="Screenshot-2023-11-15-at-12.43.29.png"><img src="/user_uploads/22008/ZTaUPWOzLkFuHlOESevP6jfh/Screenshot-2023-11-15-at-12.43.29.png"></a></div>



<a name="402111905"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/402111905" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#402111905">(Nov 15 2023 at 01:45)</a>:</h4>
<p>My work around is to delete the broken parts, but it's really fickle and is breaking CI for the webserver. I haven't figure out a good way to resolve for all the architectures</p>



<a name="402111952"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/402111952" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#402111952">(Nov 15 2023 at 01:45)</a>:</h4>
<p>Probably easy to fix</p>



<a name="402111972"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/402111972" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#402111972">(Nov 15 2023 at 01:45)</a>:</h4>
<p>I'm generating using <code>roc glue ../roc/crates/glue/src/RustGlue.roc platform/glue2 platform/main-command-glue.roc</code></p>



<a name="402112034"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/402112034" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#402112034">(Nov 15 2023 at 01:45)</a>:</h4>
<p><a href="https://github.com/roc-lang/basic-webserver/pull/3">https://github.com/roc-lang/basic-webserver/pull/3</a></p>



<a name="402112869"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/402112869" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#402112869">(Nov 15 2023 at 01:51)</a>:</h4>
<p>I'm not seeing the error. How do I trigger it?</p>



<a name="402113219"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/402113219" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#402113219">(Nov 15 2023 at 01:54)</a>:</h4>
<p>I guess it's only happening on CI machines then?? <a href="https://github.com/roc-lang/basic-webserver/actions/runs/6871760208/job/18689150356">https://github.com/roc-lang/basic-webserver/actions/runs/6871760208/job/18689150356</a></p>



<a name="402113333"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/402113333" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#402113333">(Nov 15 2023 at 01:55)</a>:</h4>
<p>that</p>



<a name="402113336"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/402113336" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#402113336">(Nov 15 2023 at 01:55)</a>:</h4>
<p>If you regenerate the glue using this command <code>roc glue ../roc/crates/glue/src/RustGlue.roc platform/glue2 platform/main-command-glue.roc</code> then in glue2 folder rust analyser should complain</p>



<a name="402113363"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/402113363" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#402113363">(Nov 15 2023 at 01:55)</a>:</h4>
<p>that's an interesting discepancy between aarch64 and x86_64</p>



<a name="402113375"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/402113375" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#402113375">(Nov 15 2023 at 01:55)</a>:</h4>
<p>cool. I'll fix that</p>



<a name="402114231"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/402114231" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#402114231">(Nov 15 2023 at 02:01)</a>:</h4>
<p>Also, what is the difference between <code>glue</code> and <code>command_glue</code>? <code>command_glue</code> doesn't look like it is fully generated with regular glue commands?</p>



<a name="402114244"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/402114244" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#402114244">(Nov 15 2023 at 02:01)</a>:</h4>
<p>looks modified</p>



<a name="402114519"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/402114519" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#402114519">(Nov 15 2023 at 02:02)</a>:</h4>
<p>Yeah, so that is another workaround. If you run glue, it doesn't generate any of the types for the Command module.</p>



<a name="402114594"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/402114594" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#402114594">(Nov 15 2023 at 02:03)</a>:</h4>
<p>ah, yeah, fun</p>



<a name="402114689"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/402114689" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#402114689">(Nov 15 2023 at 02:03)</a>:</h4>
<p>I think it is because the mainForHost is <code>mainForHost : Request -&gt; Task Response []</code> and neither <code>Request</code> or <code>Response</code> include anything to do with <code>Command</code> module</p>



<a name="402114944"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/402114944" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#402114944">(Nov 15 2023 at 02:05)</a>:</h4>
<p>It feels like it is the same issue as <a href="https://github.com/roc-lang/roc/issues/5477">https://github.com/roc-lang/roc/issues/5477</a> just manifested in a different form. That not all the types are available or something</p>



<a name="402116857"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/402116857" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#402116857">(Nov 15 2023 at 02:16)</a>:</h4>
<p>can you try with the <code>rocresult-traits</code> branch that I just pushed?</p>



<a name="402117757"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/402117757" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#402117757">(Nov 15 2023 at 02:22)</a>:</h4>
<p>So far looks good. Just pushed to CI</p>



<a name="402118061"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/402118061" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#402118061">(Nov 15 2023 at 02:24)</a>:</h4>
<p>That worked <span aria-label="tada" class="emoji emoji-1f389" role="img" title="tada">:tada:</span> thank you</p>



<a name="402321047"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/402321047" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#402321047">(Nov 15 2023 at 20:22)</a>:</h4>
<p>Morphic reference implementation source code: <a href="https://zenodo.org/records/7712285">https://zenodo.org/records/7712285</a> (a 6.6gb download because it's a docker image)</p>
<blockquote>
<p>This repository contains a compressed docker image file, containing the artifact for the PLDI 2023 paper "Better Defunctionalization through Lambda Set Specialization."  To use this artifact,first decompress the file (using <code>tar</code> or an archiving program like 7zip), and then use <code>docker load</code> to load up the decompressed docker image.  Information for reproducing the results from our PLDI paper is available in README.md files in the 'morphic/' and 'LSSIsabelle/' directories inside the Docker image. Note! the Docker archive must be decompressed and then loaded with 'docker load' (<em>not</em> 'docker import', as our archive does not use squashed layers).</p>
</blockquote>



<a name="402359540"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/402359540" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ayaz Hafiz <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#402359540">(Nov 16 2023 at 01:24)</a>:</h4>
<p>Loading this tarball into docker is heavy</p>



<a name="402361545"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/402361545" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ayaz Hafiz <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#402361545">(Nov 16 2023 at 01:43)</a>:</h4>
<p>Anybody else able to load it? Im getting open /var/lib/docker/tmp/docker-import-143820044/repositories: no such file or directory</p>



<a name="402361806"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/402361806" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ayaz Hafiz <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#402361806">(Nov 16 2023 at 01:45)</a>:</h4>
<p>Oh I didn't gunzip</p>



<a name="402374896"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/402374896" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#402374896">(Nov 16 2023 at 03:31)</a>:</h4>
<p>What tooling do we need to compile a platform? Specifically if someone new was wanting to work with basic-webserver do they only need rust's <code>cargo</code> and a roc nightly?</p>



<a name="402394328"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/402394328" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#402394328">(Nov 16 2023 at 06:21)</a>:</h4>
<p>That sounds correct</p>



<a name="403344468"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/403344468" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#403344468">(Nov 21 2023 at 09:59)</a>:</h4>
<p>having lots of fun with my web server that never allocates</p>
<div class="codehilite"><pre><span></span><code>memory allocation of 97165916604719789682: bytes failed
</code></pre></div>



<a name="404009258"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/404009258" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#404009258">(Nov 24 2023 at 18:55)</a>:</h4>
<p>Today I learned you can also use <code>&gt;</code> to quote on zulip, just like on github.<br>
No need for the triple backticks with <code>quote</code></p>



<a name="404020500"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/404020500" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#404020500">(Nov 24 2023 at 21:15)</a>:</h4>
<p>Are there any plans to roll <a href="https://github.com/roc-lang/basic-webserver/tree/main/platform/src/roc_fn">roc_fn</a> into glue? I found that a really useful tool for basic-webserver. Would it be a good idea to copy it across into basic-cli too?</p>



<a name="404021118"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/404021118" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#404021118">(Nov 24 2023 at 21:23)</a>:</h4>
<p>Oh, was that written manually and not generated by glue? I thought that was part of folkerts new glue work.</p>



<a name="404021357"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/404021357" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#404021357">(Nov 24 2023 at 21:26)</a>:</h4>
<p>that is the plan yes</p>



<a name="404095007"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/404095007" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#404095007">(Nov 25 2023 at 10:39)</a>:</h4>
<p>I found the solution to <a href="https://github.com/roc-lang/roc/issues/6088">#6088</a> using the <a href="http://cursor.so">cursor.so</a> editor, I described the problem, told it where to start looking and it found the bug :)<br>
Definitely an easy bug but I'm still impressed.</p>



<a name="404103760"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/404103760" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#404103760">(Nov 25 2023 at 11:44)</a>:</h4>
<p><span class="user-mention" data-user-id="281543">@Folkert de Vries</span> and I have been investigating issues with slow tests on Windows and have posted <a href="https://discord.com/channels/605571803288698900/1107801545652838400/1177937261367660554">a question on the Zig discord</a>. Basically we have identified that linking a dynamic library using zig build-lib is much slower than we expected -- 1,793ms vs 81ms.</p>



<a name="404174113"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/404174113" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#404174113">(Nov 25 2023 at 23:41)</a>:</h4>
<p>issue <a href="https://github.com/ziglang/zig/issues/18123">https://github.com/ziglang/zig/issues/18123</a></p>



<a name="404174524"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/404174524" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#404174524">(Nov 25 2023 at 23:47)</a>:</h4>
<p>ooh, virus scanner sounds interesting</p>



<a name="404175873"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/404175873" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#404175873">(Nov 26 2023 at 00:06)</a>:</h4>
<p>yeah maybe try playing around with that</p>



<a name="404175908"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/404175908" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#404175908">(Nov 26 2023 at 00:07)</a>:</h4>
<p>but I'm sceptical, we clearly see zig rebuilding that mingw stuff</p>



<a name="404175982"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/404175982" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#404175982">(Nov 26 2023 at 00:08)</a>:</h4>
<p>if it helps, Andrew noted that:</p>
<blockquote>
<p>it's expected for the first time linking a dynamic lib against libc on windows to take a while to build the assets<br>
the cache namespace is determined by the zig version, target, and some other CLI flags</p>
</blockquote>



<a name="404465764"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/404465764" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#404465764">(Nov 27 2023 at 18:14)</a>:</h4>
<p>Llvm is so fun... <span aria-label="crying cat" class="emoji emoji-1f63f" role="img" title="crying cat">:crying_cat:</span><br>
<a href="https://twitter.com/DrawsMiguel/status/1729021572395286744?t=Jv1_8zERJt6Nb0qwp-_oGg&amp;s=19">https://twitter.com/DrawsMiguel/status/1729021572395286744?t=Jv1_8zERJt6Nb0qwp-_oGg&amp;s=19</a></p>



<a name="404471802"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/404471802" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#404471802">(Nov 27 2023 at 18:54)</a>:</h4>
<p>Also, good read: <a href="https://muxup.com/2023q4/storing-data-in-pointers">https://muxup.com/2023q4/storing-data-in-pointers</a></p>



<a name="404733017"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/404733017" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#404733017">(Nov 28 2023 at 22:49)</a>:</h4>
<p>another fun read, on simd tricks <a href="https://mcyoung.xyz/2023/11/27/simd-base64/">https://mcyoung.xyz/2023/11/27/simd-base64/</a></p>



<a name="404733095"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/404733095" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#404733095">(Nov 28 2023 at 22:50)</a>:</h4>
<p>it's long but good, and a cool look at the state of <code>std::simd</code></p>



<a name="404733134"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/404733134" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#404733134">(Nov 28 2023 at 22:50)</a>:</h4>
<p>though I tried it on some other code and ... I'm confused  and certainly from a code size standpoint can do better myself</p>



<a name="405475734"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/405475734" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#405475734">(Dec 02 2023 at 02:37)</a>:</h4>
<p>How do we go from a region to a line number?</p>



<a name="405478913"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/405478913" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#405478913">(Dec 02 2023 at 03:04)</a>:</h4>
<p>Oh, I found <code>LineInfo</code>, I think I figured this out.</p>



<a name="406345493"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/406345493" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#406345493">(Dec 06 2023 at 16:47)</a>:</h4>
<p>The backlog of things I want to work on keeps growing. I think I'm gonna need a bigger whiteboard to track this:<br>
<a href="/user_uploads/22008/tfGMo4wosS05qYv3pp5TOIct/PXL_20231206_164511901.MP.jpg">tasks.jpg</a></p>
<div class="message_inline_image"><a href="/user_uploads/22008/tfGMo4wosS05qYv3pp5TOIct/PXL_20231206_164511901.MP.jpg" title="tasks.jpg"><img src="/user_uploads/22008/tfGMo4wosS05qYv3pp5TOIct/PXL_20231206_164511901.MP.jpg"></a></div>



<a name="406364925"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/406364925" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#406364925">(Dec 06 2023 at 18:44)</a>:</h4>
<p>ME now: Why are my roc apps ooming???</p>
<p>ME an hour ago: disabled refcounting in the roc compiler for testing something.</p>



<a name="407436465"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/407436465" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#407436465">(Dec 12 2023 at 09:52)</a>:</h4>
<p>Does anyone know what <code>dynhost.pdb</code> is, and where I might find it? I have generated a binary for Windows using <code>--profiling</code> and am running it in the debugger. Without using profiling I haven't seen this file requested before. I can still disassemble and step though the binary without it, but I'm guess this has more information related to the source.</p>



<a name="407436920"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/407436920" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#407436920">(Dec 12 2023 at 09:55)</a>:</h4>
<p>it's where the debug info lives</p>



<a name="407437043"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/407437043" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#407437043">(Dec 12 2023 at 09:56)</a>:</h4>
<p>Is there a way to generate it?</p>



<a name="407437412"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/407437412" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#407437412">(Dec 12 2023 at 09:58)</a>:</h4>
<p>we don't have a way to do it I think. it should be the same one as for the host?</p>



<a name="407437476"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/407437476" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#407437476">(Dec 12 2023 at 09:58)</a>:</h4>
<p>in other words, when the host gets compiled, it should spit out this file for itself too (zig/rust/ect should). maybe you can just rename it and use that?</p>



<a name="409443687"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/409443687" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#409443687">(Dec 21 2023 at 18:34)</a>:</h4>
<p>Just saw a link to the inko programming language. Interesting idea on memory management. All values have one owner. When the owner goes out of scope it is dropped. Default is move semantics when assigning to a new variable and such (to keep all values having exactly one owner). You can make as many references to a value as you want (mutable and immutable). If an object is freed and references are used later (maybe if they exist at all), it will crash.</p>
<p>So doubling down on everything has exactly one owner like you usually get in rust via ownership and borrowing, but without complex tracking. No need to rc or GC. Some minor tracking to crash at runtime for use after free.</p>
<p><a href="https://inko-lang.org/">https://inko-lang.org/</a></p>



<a name="409443950"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/409443950" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#409443950">(Dec 21 2023 at 18:36)</a>:</h4>
<p>Trying to be like rust but a lot less complex and faster compiler times, but for that tradeoff, they lose some compile time guarantees and add runtime crashes. And then also a lot less runtime overhead than languages with rc or GC....not a tradeoff I would make, bit interesting to see</p>



<a name="409449682"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/409449682" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#409449682">(Dec 21 2023 at 19:13)</a>:</h4>
<p>I met its author at the rust meetup here, but we did not have a lot if time to discuss details . Would be interesting sometime</p>



<a name="409449710"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/409449710" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#409449710">(Dec 21 2023 at 19:13)</a>:</h4>
<p>(they are funded by nlnet, which also funds my nea work)</p>



<a name="410469665"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/410469665" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#410469665">(Dec 29 2023 at 19:25)</a>:</h4>
<p>Today I learned about Rust's <a href="https://doc.rust-lang.org/beta/unstable-book/compiler-flags/sanitizer.html">sanitizer</a>. If miri helped us find bugs, this may be useful as well.</p>



<a name="410474019"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/410474019" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#410474019">(Dec 29 2023 at 20:13)</a>:</h4>
<p>miri can't really handle programs that aren't written to be run with miri; it is very limited</p>



<a name="410474033"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/410474033" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#410474033">(Dec 29 2023 at 20:13)</a>:</h4>
<p>e.g. as soon as you do some <code>extern fn</code> thing it just gives up</p>



<a name="410474110"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/410474110" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#410474110">(Dec 29 2023 at 20:14)</a>:</h4>
<p>so an actual sanitizer is probably much more useful for us</p>



<a name="410474259"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/410474259" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#410474259">(Dec 29 2023 at 20:16)</a>:</h4>
<p>is that a thing in Rust? <span aria-label="thinking" class="emoji emoji-1f914" role="img" title="thinking">:thinking:</span></p>



<a name="410529667"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/410529667" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#410529667">(Dec 30 2023 at 09:45)</a>:</h4>
<blockquote>
<p>is that a thing in Rust? <span aria-label="thinking" class="emoji emoji-1f914" role="img" title="thinking">:thinking:</span> </p>
</blockquote>
<p>Well, yes, I linked to the sanitizer earlier <span aria-label="sweat smile" class="emoji emoji-1f605" role="img" title="sweat smile">:sweat_smile:</span>. But perhaps I misunderstand your question.</p>



<a name="410542596"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/410542596" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#410542596">(Dec 30 2023 at 12:34)</a>:</h4>
<p>ohh I thought based on the miri comment that the link used miri too!</p>



<a name="411279922"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/411279922" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#411279922">(Jan 04 2024 at 23:49)</a>:</h4>
<p>I think we should add a "Developing Platforms" guide for the website, and include discussion or summary about the current state of things. </p>
<p>After our plugin meeting earlier this morning, I had the thought that it would be helpful to communicate some of the known issues (like glue being in-development) and what the plan/vision is. I can draft something if this would be helpful. </p>
<p>In future we can update this guide when platform development is more mature.</p>



<a name="411280392"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/411280392" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#411280392">(Jan 04 2024 at 23:55)</a>:</h4>
<p>sounds good! I think there may be other informational things floating around - maybe ask in channel?</p>



<a name="411282795"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/411282795" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#411282795">(Jan 05 2024 at 00:12)</a>:</h4>
<p>and yeah I'll publish it this weekend probably</p>



<a name="411282930"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/411282930" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#411282930">(Jan 05 2024 at 00:14)</a>:</h4>
<p><span class="user-mention silent" data-user-id="281383">Richard Feldman</span> <a href="#narrow/stream/395097-compiler-development/topic/Casual.20Conversation/near/411282795">said</a>:</p>
<blockquote>
<p>and yeah I'll publish it this weekend probably</p>
</blockquote>
<p>The Strings language reference <span aria-label="smiley" class="emoji emoji-1f603" role="img" title="smiley">:smiley:</span></p>



<a name="411285116"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/411285116" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#411285116">(Jan 05 2024 at 00:29)</a>:</h4>
<p>yeah, that one <span aria-label="big smile" class="emoji emoji-1f604" role="img" title="big smile">:big_smile:</span></p>



<a name="411341175"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/411341175" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#411341175">(Jan 05 2024 at 10:16)</a>:</h4>
<blockquote>
<p>The Strings language reference</p>
</blockquote>
<p>The examples repo has sort of become a place for both examples and more in-depth explainers as well, should we just put it there? It's useful for users to have just one place they need to go to to find the answers to their questions.</p>



<a name="411344132"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/411344132" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#411344132">(Jan 05 2024 at 10:29)</a>:</h4>
<p>interesting, although I think the language reference should really go on <a href="http://roc-lang.org">roc-lang.org</a> rather than in a repo</p>



<a name="411345098"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/411345098" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#411345098">(Jan 05 2024 at 10:34)</a>:</h4>
<p>The examples are on <a href="http://roc-lang.org">roc-lang.org</a> at <a href="http://www.roc-lang.org/examples">www.roc-lang.org/examples</a> :)</p>



<a name="411346352"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/411346352" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#411346352">(Jan 05 2024 at 10:43)</a>:</h4>
<p>Perhaps we can find a better name instead of "examples", but I don't think we should further split up our "knowledge libraries", we already have the tutorial, docs, examples, faq, website pages and everything spread out on zulip and github.</p>



<a name="411366506"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/411366506" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#411366506">(Jan 05 2024 at 13:04)</a>:</h4>
<p>maybe we could just add lang ref entries in the same sidebar as the buildin modules</p>



<a name="411366537"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/411366537" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#411366537">(Jan 05 2024 at 13:04)</a>:</h4>
<p>and maybe this string reference could go at the top of the <code>Str</code> module</p>



<a name="411366650"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/411366650" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#411366650">(Jan 05 2024 at 13:05)</a>:</h4>
<p>I want to have separate articles on things like how conditionals and pattern matching and such work, which don't fit into any particular builtin module, so I think we need more than just those - but maybe they can be located in the same place</p>



<a name="411367657"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/411367657" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#411367657">(Jan 05 2024 at 13:14)</a>:</h4>
<blockquote>
<p>and maybe this string reference could go at the top of the <code>Str</code> module</p>
</blockquote>
<p>Yeah, that's a good spot for it, I do think we should then do something like add a ToC at the top, or collapse the headers by default. Scrolling to search for information is annoying.</p>



<a name="411368504"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/411368504" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#411368504">(Jan 05 2024 at 13:21)</a>:</h4>
<blockquote>
<p>I want to have separate articles on things like how conditionals and pattern matching and such work, which don't fit into any particular builtin module, so I think we need more than just those - but maybe they can be located in the same place</p>
</blockquote>
<p>One option is to to give these articles their own space and to combat fragmentation; create a powerful search page on the website that can search through faq, examples repo, articles, tutorial, zulip and github. The one-stop page for Roc knowledge :)</p>



<a name="411369055"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/411369055" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#411369055">(Jan 05 2024 at 13:26)</a>:</h4>
<p>I think it makes sense to have at least these things separated:</p>
<ul>
<li>tutorial</li>
<li>examples</li>
<li>documentation</li>
</ul>
<p>as a reader, I have different motivations for wanting to view each of those, and I would prefer to have them separate</p>



<a name="411369118"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/411369118" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#411369118">(Jan 05 2024 at 13:26)</a>:</h4>
<p>I think if we have some documentation that only exists in examples, that's a bug <span aria-label="big smile" class="emoji emoji-1f604" role="img" title="big smile">:big_smile:</span></p>



<a name="411369195"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/411369195" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#411369195">(Jan 05 2024 at 13:27)</a>:</h4>
<p>I can see arguments for and against having all the language docs (both builtin modules and also the rest of the language reference) in the same place, but I like the idea of trying out having both in one place</p>



<a name="411376326"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/411376326" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#411376326">(Jan 05 2024 at 14:13)</a>:</h4>
<blockquote>
<p>as a reader, I have different motivations for wanting to view each of those</p>
</blockquote>
<p>I agreed with this at first but then I thought I could definitely see a user searching through all three (tutorial, examples, docs) to learn about a specific concept in Roc.</p>



<a name="411377213"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/411377213" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#411377213">(Jan 05 2024 at 14:20)</a>:</h4>
<blockquote>
<p>I like the idea of trying out having both in one place</p>
</blockquote>
<p>It does seem like that would require substantial remodeling of <a href="http://roc-lang.org/builtins">roc-lang.org/builtins</a> to make it well integrated.</p>



<a name="411832166"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/411832166" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#411832166">(Jan 08 2024 at 23:10)</a>:</h4>
<p>Finally got around to the new rob pike talk about what go got right and wrong. This stuck out a ton: <a href="https://youtu.be/yE5Tpp2BSGw?si=aSKCgRkpGb-Ugk9c&amp;t=2166">https://youtu.be/yE5Tpp2BSGw?si=aSKCgRkpGb-Ugk9c&amp;t=2166</a></p>
<div class="youtube-video message_inline_image"><a data-id="yE5Tpp2BSGw" href="https://youtu.be/yE5Tpp2BSGw?si=aSKCgRkpGb-Ugk9c&amp;t=2166"><img src="https://uploads.zulipusercontent.net/cd985490be549e2262ac7e78c21b80ea6b1c5dc3/68747470733a2f2f692e7974696d672e636f6d2f76692f79453554707032425347772f64656661756c742e6a7067"></a></div><p>Huge change that Rob really wishes that they had done: default int type should be an arbitrary sized int type. Of course, you can still have sized integer types with that.</p>



<a name="411833988"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/411833988" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#411833988">(Jan 08 2024 at 23:27)</a>:</h4>
<p>interesting - the first benefit he mentioned was "security" - which I assume is because Go has wrapping overflow by default</p>



<a name="411834240"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/411834240" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#411834240">(Jan 08 2024 at 23:29)</a>:</h4>
<p>I don't really understand what he's proposing <span aria-label="sweat smile" class="emoji emoji-1f605" role="img" title="sweat smile">:sweat_smile:</span></p>
<p>I guess something along the lines of "when doing any arithmetic operation, on overflow upcast to arbitrary int and try again" but Go is statically typed - so what happens to the integer after that?</p>



<a name="411834379"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/411834379" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#411834379">(Jan 08 2024 at 23:31)</a>:</h4>
<p>he says "you just don't think about integer overflow anymore"</p>



<a name="411834441"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/411834441" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#411834441">(Jan 08 2024 at 23:31)</a>:</h4>
<p>like what happens if I have a struct with a u8 in it, I take it out and multiply it by a gazillion and then try to put it back?</p>



<a name="411834496"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/411834496" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#411834496">(Jan 08 2024 at 23:32)</a>:</h4>
<p>seems like just kicking the overflow can down the road? <span aria-label="face with raised eyebrow" class="emoji emoji-1f928" role="img" title="face with raised eyebrow">:face_with_raised_eyebrow:</span></p>



<a name="411836590"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/411836590" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#411836590">(Jan 08 2024 at 23:53)</a>:</h4>
<p>He is just saying that the default <code>int</code> type would be an arbitrary precision int that never overflows</p>



<a name="411836668"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/411836668" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#411836668">(Jan 08 2024 at 23:54)</a>:</h4>
<p>Probably would use 1 but to signify if It is a pointer to the real int or just an int stored locally on the stack.</p>



<a name="411836737"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/411836737" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#411836737">(Jan 08 2024 at 23:55)</a>:</h4>
<p>You would still get overflow if you use the <code>uint8</code> type.</p>



<a name="411836759"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/411836759" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#411836759">(Jan 08 2024 at 23:55)</a>:</h4>
<p>His point is just about changing the default to something safer and without overflow</p>



<a name="411845963"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/411845963" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#411845963">(Jan 09 2024 at 01:10)</a>:</h4>
<p>Just looking at some things for <code>roc docs</code> and I'm wondering what we should use for the platform name? Currently we could use the <code>platform "name" ...</code> but under the module params proposal that changes to the following which no longer includes a string in the module header. </p>
<div class="codehilite"><pre><span></span><code>platform package [Stdout, Stdin, echo, read]
    requires [main]
    provides [mainForHost] to &quot;prebuilt-hosts/&quot;
    packages [
        Foo, Bar, Baz from &quot;https://…&quot;,
        Something as Smt from &quot;https://…&quot;,
    ]
    hosts [
        echo : Str -&gt; Task {} [],
        read : Task Str [],
    ]
</code></pre></div>



<a name="411846035"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/411846035" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#411846035">(Jan 09 2024 at 01:11)</a>:</h4>
<p>The root path is usually something like <code>platform/main.roc</code> which isn't very descriptive</p>



<a name="411857179"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/411857179" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#411857179">(Jan 09 2024 at 03:15)</a>:</h4>
<p>I kinda wonder if we should have an overall name on the page at all</p>



<a name="411857250"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/411857250" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#411857250">(Jan 09 2024 at 03:16)</a>:</h4>
<p>as opposed to just a list of modules, and possibly some customizable introductory text (e.g. the doc comment for the package module)</p>



<a name="411857896"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/411857896" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#411857896">(Jan 09 2024 at 03:24)</a>:</h4>
<p>I don't mind if we dont, I guess the main thing I was wanting was to be able to include doc comments in the platform module which don't currently generate</p>



<a name="411857942"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/411857942" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#411857942">(Jan 09 2024 at 03:25)</a>:</h4>
<p>I noticed there was an issue for <a href="https://github.com/roc-lang/roc/issues/5712">displaying platform name in docs</a>, I went down a rabbit hole looking into making a PR for that.</p>



<a name="411861326"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/411861326" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Isaac Van Doren <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#411861326">(Jan 09 2024 at 04:09)</a>:</h4>
<blockquote>
<p>Finally got around to the new rob pike talk about what go got right and wrong.</p>
</blockquote>
<p>My key takeaway so far is that Roc needs a fun cartoon mascot <span aria-label="big smile" class="emoji emoji-1f604" role="img" title="big smile">:big_smile:</span></p>



<a name="411864135"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/411864135" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ayaz Hafiz <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#411864135">(Jan 09 2024 at 04:51)</a>:</h4>
<p><a href="https://www.youtube.com/watch?v=PgUsmO0YyQc&amp;list=PLCiAikFFaMJrgFrWRKn0-1EI3gVZLQJtJ">https://www.youtube.com/watch?v=PgUsmO0YyQc&amp;list=PLCiAikFFaMJrgFrWRKn0-1EI3gVZLQJtJ</a></p>
<div class="youtube-video message_inline_image"><a data-id="PgUsmO0YyQc" href="https://www.youtube.com/watch?v=PgUsmO0YyQc&amp;list=PLCiAikFFaMJrgFrWRKn0-1EI3gVZLQJtJ"><img src="https://uploads.zulipusercontent.net/03ca56e4199f3bc41b01129bae011ac9cf86edfa/68747470733a2f2f692e7974696d672e636f6d2f76692f506755736d4f30597951632f64656661756c742e6a7067"></a></div>



<a name="411864149"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/411864149" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ayaz Hafiz <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#411864149">(Jan 09 2024 at 04:51)</a>:</h4>
<p>Eisenberg is so good at explaining the modal extension</p>



<a name="412026735"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/412026735" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Agus Zubiaga <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#412026735">(Jan 09 2024 at 23:03)</a>:</h4>
<p><span class="user-mention silent" data-user-id="611722">Isaac Van Doren</span> <a href="#narrow/stream/395097-compiler-development/topic/Casual.20Conversation/near/411861326">said</a>:</p>
<blockquote>
<blockquote>
<p>Finally got around to the new rob pike talk about what go got right and wrong.</p>
</blockquote>
<p>My key takeaway so far is that Roc needs a fun cartoon mascot <span aria-label="big smile" class="emoji emoji-1f604" role="img" title="big smile">:big_smile:</span></p>
</blockquote>
<p>DALL-E thinks it should be a total bad boy:<br>
<a href="/user_uploads/22008/FWHeh_N6gRMJYkPOQ878RvoS/roc-mascot.png">roc-mascot.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/22008/FWHeh_N6gRMJYkPOQ878RvoS/roc-mascot.png" title="roc-mascot.png"><img src="/user_uploads/22008/FWHeh_N6gRMJYkPOQ878RvoS/roc-mascot.png"></a></div>



<a name="412035061"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/412035061" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Isaac Van Doren <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#412035061">(Jan 10 2024 at 00:12)</a>:</h4>
<p>Rocco the rockin’ Roc mascot <span aria-label="guitar" class="emoji emoji-1f3b8" role="img" title="guitar">:guitar:</span><span aria-label="big smile" class="emoji emoji-1f604" role="img" title="big smile">:big_smile:</span></p>



<a name="412039331"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/412039331" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#412039331">(Jan 10 2024 at 00:41)</a>:</h4>
<p>this rules hahahaha</p>



<a name="412039390"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/412039390" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#412039390">(Jan 10 2024 at 00:42)</a>:</h4>
<p>or Rocky? After all, Roc was created in Philadelphia</p>



<a name="412044342"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/412044342" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Isaac Van Doren <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#412044342">(Jan 10 2024 at 01:24)</a>:</h4>
<p>Rocky is good too</p>



<a name="412044396"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/412044396" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Isaac Van Doren <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#412044396">(Jan 10 2024 at 01:25)</a>:</h4>
<p>There’s always the option to make the mascot a bird made of rocks</p>



<a name="412248785"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/412248785" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#412248785">(Jan 11 2024 at 01:06)</a>:</h4>
<p>I'm looking for help to find a name for a concept... most roc platforms will generate an executable, so <code>roc build</code> on your application and you have a program you can execute. </p>
<p>Some platforms are different and they are for making a plugin, so <code>roc build</code> produces a library instead which will ultimately be loaded and used by another program. </p>
<p>Is this a fair distinction between two use cases? are there others? What would be good names for these? Executable Platforms and Embedding Platforms?</p>



<a name="412249141"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/412249141" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#412249141">(Jan 11 2024 at 01:10)</a>:</h4>
<p>I'm trying to research what I can to collect infromation for a guide on platform development</p>



<a name="412250829"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/412250829" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#412250829">(Jan 11 2024 at 01:30)</a>:</h4>
<ul>
<li><code>roc build</code> <a href="https://github.com/roc-lang/basic-cli">basic-cli</a> produces executable</li>
<li><code>roc build</code> <a href="https://github.com/roc-lang/basic-webserver">basic-webserver</a> produces executable</li>
<li><code>roc build --lib</code> <a href="https://github.com/alexpyattaev/roc-plugin-example">roc-plugin-example</a> produces dynamic library</li>
<li><code>roc build --no-link</code> <a href="https://github.com/bhansconnect/roc-fuzz">roc-fuzz</a> produces static library</li>
<li><code>roc build --no-link</code> <a href="https://github.com/lukewilliamboswell/roc-wasm4">roc-wasm4</a> produces static library</li>
</ul>



<a name="412517130"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/412517130" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Zeljko Nesic <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#412517130">(Jan 12 2024 at 10:29)</a>:</h4>
<p>Concept-wise I would not use the word "plugin" to describe non-application artifact.</p>



<a name="412887960"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/412887960" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#412887960">(Jan 15 2024 at 05:19)</a>:</h4>
<p>This is a new one, I added an extra Task and it fixed an error in alias analysis. <a href="https://github.com/lukewilliamboswell/roc-wasm4/blob/8eb900bddbe2cd49c12b0dab8227eee09e3e1d7f/examples/rocci-bird.roc#L266-L268">https://github.com/lukewilliamboswell/roc-wasm4/blob/8eb900bddbe2cd49c12b0dab8227eee09e3e1d7f/examples/rocci-bird.roc#L266-L268</a></p>
<p>In this specific case, <code>N</code> Tasks is fine, <code>N + 1</code> is broken, but <code>N + 2</code> is fine again.</p>



<a name="412919606"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/412919606" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#412919606">(Jan 15 2024 at 09:47)</a>:</h4>
<p>Nice to have a workaround for this one :)</p>



<a name="413014639"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/413014639" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#413014639">(Jan 15 2024 at 18:56)</a>:</h4>
<p>I'm taking some time off and will be back on the 26th of January <span aria-label="wave" class="emoji emoji-1f44b" role="img" title="wave">:wave:</span><br>
I'll check my mentions and direct messages on zulip once a day for urgent stuff.</p>



<a name="413015319"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/413015319" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Carroll <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#413015319">(Jan 15 2024 at 19:02)</a>:</h4>
<p>Enjoy yourself!</p>



<a name="413017929"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/413017929" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#413017929">(Jan 15 2024 at 19:25)</a>:</h4>
<p>enjoy! <span aria-label="smiley" class="emoji emoji-1f603" role="img" title="smiley">:smiley:</span></p>



<a name="413049936"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/413049936" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#413049936">(Jan 16 2024 at 00:22)</a>:</h4>
<p>If I read this correctly:</p>
<p>Error, expected type "nothing", found type "complicated nothing"</p>
<blockquote>
<p>expected type '()', found type 'union { ((),), ((),) }'</p>
</blockquote>



<a name="417137087"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/417137087" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jared Cone <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#417137087">(Jan 22 2024 at 00:30)</a>:</h4>
<p>Hello, I'm checking in on Roc progress and I see it's able to build the compiler on Windows now which is awesome. Is the roc compiler itself able to work on Windows yet?</p>



<a name="417137261"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/417137261" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#417137261">(Jan 22 2024 at 00:32)</a>:</h4>
<p><span class="user-mention" data-user-id="515757">@Luke Boswell</span> would know a lot better, but it looks like we are getting close to enabling all the codegen tests: <a href="https://github.com/roc-lang/roc/issues/6408">#6408</a></p>



<a name="417139438"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/417139438" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#417139438">(Jan 22 2024 at 00:51)</a>:</h4>
<p>I've been using roc on Windows. All the LLVM tests pass now as of last night. <span aria-label="grinning" class="emoji emoji-1f600" role="img" title="grinning">:grinning:</span> There is at least one bug with the surgical linker on Windows so you have to use <code>--linker=legacy</code>. Most of the current platforms have been developed without support for Windows, so there is a bit of work to upgrade them and test them out. The roc-wasm4 platform works really well though, and I've not had any issues with my zig platforms. I think we might want to track down and fix the surgical linker before we make a release?? though it hasn't been discussed yet.</p>



<a name="417148594"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/417148594" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jared Cone <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#417148594">(Jan 22 2024 at 02:46)</a>:</h4>
<p>Am I using this arg right?</p>
<div class="codehilite"><pre><span></span><code>d:\External\Roc&gt;target\debug\deps\roc build --linker=legacy Roctris\Roctris.roc

thread &#39;main&#39; has overflowed its stack
</code></pre></div>



<a name="417151461"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/417151461" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#417151461">(Jan 22 2024 at 03:23)</a>:</h4>
<p>Yes that looks right. What platform is roctris using? Ive had similar issues using basic cli</p>



<a name="417157634"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/417157634" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jared Cone <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#417157634">(Jan 22 2024 at 04:45)</a>:</h4>
<p>It's a custom CLI platform from before the CLI example was a thing. Yea I get the same error when typing any expression into the repl</p>



<a name="417160497"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/417160497" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#417160497">(Jan 22 2024 at 05:22)</a>:</h4>
<p>Can try a release build. Otherwise, getting rust to dump a back trace may help.</p>



<a name="417163113"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/417163113" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jared Cone <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#417163113">(Jan 22 2024 at 05:59)</a>:</h4>
<p>Definitely something fishy going on. Here I'm telling it to build an empty file:</p>
<div class="codehilite"><pre><span></span><code>d:\External\Roc&gt;target\debug\deps\roc Roctris\Roctris.roc
←[36m── MISSING HEADER in Roctris\Roctris.roc ───────────────────────────────────────←[0m

I am expecting a header, but got stuck here:

←[36m1←[0m←[36m│←[0m
    ←[31m^←[0m

I am expecting a module keyword next, one of ←[32minterface←[0m, ←[32mapp←[0m, ←[32mpackage←[0m
or ←[32mplatform←[0m.
</code></pre></div>



<a name="417164620"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/417164620" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jared Cone <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#417164620">(Jan 22 2024 at 06:16)</a>:</h4>
<p>Different error when building with release:</p>
<div class="codehilite"><pre><span></span><code>d:\External\Roc&gt;target\release\deps\roc build Roctris\Roctris.roc
🔨 Rebuilding platform...
An internal compiler expectation was broken.
This is definitely a compiler bug.
Please file an issue here: https://github.com/roc-lang/roc/issues/new/choose
thread &#39;&lt;unnamed&gt;&#39; panicked at &#39;Error:
    Failed to rebuild src/main.rs:
        The executed command was:
            rustup run nightly-2023-05-28 cargo build --bin host
        stderr of that command:
            error: toolchain &#39;nightly-2023-05-28-x86_64-pc-windows-msvc&#39; is not installed
&#39;, crates\compiler\build\src\link.rs:1414:21
stack backtrace:
   0: std::panicking::begin_panic_handler
             at /rustc/eb26296b556cef10fb713a38f3d16b9886080f26/library\std\src\panicking.rs:593
   1: core::panicking::panic_fmt
             at /rustc/eb26296b556cef10fb713a38f3d16b9886080f26/library\core\src\panicking.rs:67
   2: roc_build::link::preprocess_host_wasm32
   3: roc_build::link::rebuild_host
   4: roc_build::program::build_file
   5: &lt;anstyle::style::StyleDisplay as core::fmt::Display&gt;::fmt
   6: &lt;anstyle::style::StyleDisplay as core::fmt::Display&gt;::fmt
   7: std::sys::windows::thread::impl$0::new::thread_start
</code></pre></div>



<a name="417165487"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/417165487" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#417165487">(Jan 22 2024 at 06:26)</a>:</h4>
<p>First issue looks to be just bad color codes for the terminal</p>



<a name="417165510"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/417165510" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#417165510">(Jan 22 2024 at 06:26)</a>:</h4>
<p>Second looks to be a real error. I think windows requires nightly currently for some rust stuff</p>



<a name="417170811"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/417170811" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#417170811">(Jan 22 2024 at 07:22)</a>:</h4>
<p>If you can share your platform impl and that app I could have a look?</p>



<a name="417271256"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/417271256" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#417271256">(Jan 22 2024 at 16:42)</a>:</h4>
<p>some cool debugger tricks here <a href="https://www.youtube.com/watch?v=PorfLSr3DDI&amp;list=WL&amp;index=1">https://www.youtube.com/watch?v=PorfLSr3DDI&amp;list=WL&amp;index=1</a></p>
<div class="youtube-video message_inline_image"><a data-id="PorfLSr3DDI" href="https://www.youtube.com/watch?v=PorfLSr3DDI&amp;list=WL&amp;index=1"><img src="https://uploads.zulipusercontent.net/371908bca78ef74d643572d12572b93a75f3afb6/68747470733a2f2f692e7974696d672e636f6d2f76692f506f72664c5372334444492f64656661756c742e6a7067"></a></div>



<a name="417359979"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/417359979" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jared Cone <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#417359979">(Jan 23 2024 at 02:56)</a>:</h4>
<p>is there an up-to-date example C platform?</p>



<a name="417360464"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/417360464" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#417360464">(Jan 23 2024 at 03:00)</a>:</h4>
<p><code>examples/platform-switching/c-platform/host.c</code> should be</p>



<a name="417374691"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/417374691" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#417374691">(Jan 23 2024 at 05:35)</a>:</h4>
<p>Have we ever discussed having fuzzing within roc, maybe using something like <code>expect</code>? How might something like this work in the future?</p>



<a name="417374780"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/417374780" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#417374780">(Jan 23 2024 at 05:36)</a>:</h4>
<p>I know it was discuss at some point, but no idea where currently. We also discussed property based testing some.</p>



<a name="417374828"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/417374828" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#417374828">(Jan 23 2024 at 05:37)</a>:</h4>
<p>Probably a nice property based testing framework will be more useful to most users. Given roc is a safe language fuzzing should be less needed except for low level internals testing. Though both are useful and can be used together to some extent.</p>



<a name="417375255"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/417375255" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#417375255">(Jan 23 2024 at 05:42)</a>:</h4>
<p><span class="user-mention" data-user-id="666594">@John Murray</span> did you make any progress with <a href="#narrow/stream/302903-Writing-a-platform/topic/platform.20effect.20function.20calling.20roc.20closure/near/408637991">this line of effort</a>?</p>



<a name="417376157"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/417376157" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#417376157">(Jan 23 2024 at 05:53)</a>:</h4>
<p>Hmm...I think I could modify the roc fuzz platform to make a nice property based testing setup with multiple tests.</p>
<p>Of course baking it into roc would be best. Cause then you don't need a platform at all.</p>



<a name="417423544"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/417423544" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Murray <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#417423544">(Jan 23 2024 at 11:15)</a>:</h4>
<p><span class="user-mention silent" data-user-id="515757">Luke Boswell</span> <a href="#narrow/stream/395097-compiler-development/topic/Casual.20Conversation/near/417375255">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="666594">John Murray</span> did you make any progress with <a href="#narrow/stream/302903-Writing-a-platform/topic/platform.20effect.20function.20calling.20roc.20closure/near/408637991">this line of effort</a>?</p>
</blockquote>
<p>Not much, ran into some issues with having the platform call arbitrary roc closures.</p>
<p>I think integration into roc would be the best approach imo</p>



<a name="417489775"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/417489775" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#417489775">(Jan 23 2024 at 17:03)</a>:</h4>
<p>One thing that is a bit sad is that fuzzing tools are not easier to setup and use. In a perfect world, all property testing tools would be based off of a fuzzing engine. Cause fuzzing uses coverage in the actual source code to explore inputs better.</p>
<p>Like property tests will never generate a proper gzip header (without explicit user guidance), but a fuzzer will.</p>
<p>That said, property testing is faster and generally doesn't store a bunch of data to disk. Fuzzing has to build a corpus to run well.</p>



<a name="417598042"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/417598042" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#417598042">(Jan 24 2024 at 08:50)</a>:</h4>
<p>I thought this was really cool <a href="https://ziglang.org/news/announcing-donor-bounties/">https://ziglang.org/news/announcing-donor-bounties/</a></p>



<a name="417646820"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/417646820" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#417646820">(Jan 24 2024 at 13:37)</a>:</h4>
<p>huh, interesting idea!</p>



<a name="417676962"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/417676962" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#417676962">(Jan 24 2024 at 16:04)</a>:</h4>
<p>Feels off to me. Sure, they spend the donations on paying contributors, but the money isn't going to the specific person who fixes the bounty. That person may not be on zigs payroll at all.</p>



<a name="417677099"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/417677099" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#417677099">(Jan 24 2024 at 16:05)</a>:</h4>
<p>So it's kinda like. If you fixes this bug, you also make us money.</p>



<a name="418046257"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/418046257" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Fabian Schmalzried <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#418046257">(Jan 25 2024 at 10:09)</a>:</h4>
<p>It's not about bugs, it's about features. I see it like this: if I want to spend some of my free time to implement something for a cool project, then I  might as well make the project some money by implementing a bounty. If I spend my time that means I like the project, therefore I would be happy if the project would have more funding (even if I don't get any of it).</p>



<a name="418107096"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/418107096" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#418107096">(Jan 25 2024 at 15:41)</a>:</h4>
<p>I totally get that.</p>
<p>Maybe it is more of a problem with how they worded/presented it. By talking about how the money is going towards paying contributors, it makes it sound like people who fix the issue or add the new feature will get some part of the value. They are contributors after all. This is only true if that person happens to be on zigs payroll<br>
 So I would label it as misleading at best. Not any sort of mal intent, but as a company donating, I think it would be easy to miss that point.</p>



<a name="418279728"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/418279728" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Fabian Schmalzried <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#418279728">(Jan 26 2024 at 13:54)</a>:</h4>
<p>I'm interested in how this turns out. How the whole zig community is reacting to this and if there even will be a significant amount of bounties.</p>



<a name="418299366"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/418299366" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#418299366">(Jan 26 2024 at 15:36)</a>:</h4>
<p>For sure</p>



<a name="418317688"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/418317688" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rupert Smith <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#418317688">(Jan 26 2024 at 17:15)</a>:</h4>
<p>Hi, I have been conversing with <span class="user-mention" data-user-id="686843">@GordonBGood</span> on the Elm Discourse and got onto the subject of how Roc optimizes away imutables and copying values sometimes by directly modifying structures on the heap. I have also been reading the papers on how this is implemented in Lean4 which seems to have quite a sophisticated implementation of it.<br>
I was hoping to compare with the code for Roc.<br>
Grepping the source I found this: <a href="https://github.com/roc-lang/roc/blob/main/crates/vendor/morphic_lib/src/api.rs#L176">https://github.com/roc-lang/roc/blob/main/crates/vendor/morphic_lib/src/api.rs#L176</a><br>
Which comments on it, but isn't the implementation.<br>
Sorry, I am not a Rust programmer so not sure how to find my way around... Can anyone point me to where the implementation is? Hoping there are maybe some comments I can read too to understand how it works, or failing that any docs or other sources I can consult (like a GitHub Issue or Pull Request)?<br>
Thanks - first post here. I thought maybe I should post this in #beginners since I cannot even really claim that level of Roc ability!</p>



<a name="418341271"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/418341271" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Carroll <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#418341271">(Jan 26 2024 at 19:45)</a>:</h4>
<p>I have only a limited knowledge but I'll share what I can!</p>
<p>This is not really in just one place. There are some aspects in the compiler and some in the standard library built-in functions.</p>
<p>The built-ins are easier to follow. Search for <code>isUnique</code> in the Zig code in this directory:<br>
<a href="https://github.com/roc-lang/roc/tree/main/crates%2Fcompiler%2Fbuiltins%2Fbitcode%2Fsrc">https://github.com/roc-lang/roc/tree/main/crates%2Fcompiler%2Fbuiltins%2Fbitcode%2Fsrc</a><br>
(And if you're wondering how/why we use both Zig and Rust, look in the FAQ!)</p>
<p>One of the compiler features is reuse of allocations. Search for the <code>Reuse</code> variant of the monomorphic IR in <code>crates/compiler/mono</code></p>



<a name="418358944"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/418358944" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#418358944">(Jan 26 2024 at 22:19)</a>:</h4>
<p><a href="https://github.com/WebAssembly/WASI/tree/main/preview2#wasi-preview-2">https://github.com/WebAssembly/WASI/tree/main/preview2#wasi-preview-2</a></p>
<p>Looks like WASI Preview 2 just launched. This will be fun to play with. <span aria-label="laughing" class="emoji emoji-1f606" role="img" title="laughing">:laughing:</span></p>



<a name="418361501"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/418361501" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#418361501">(Jan 26 2024 at 22:45)</a>:</h4>
<p><span class="user-mention" data-user-id="686997">@Rupert Smith</span> our implementation is now based on the one in Koka, but before that we basically implemented the Lean4 strategy. The current approach is better for algebraic data types, but has some nasty edge cases for our built-in lists and strings. So we'll need to move to more of a hybrid of the two systems. </p>
<p>the core of our logic is in <code>crates/compiler/mono/src/inc_dec.rs</code> and some related modules in the same folder like <a href="http://reset_reuse.rs">reset_reuse.rs</a>.</p>



<a name="418361537"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/418361537" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#418361537">(Jan 26 2024 at 22:45)</a>:</h4>
<p>this is all based on a bunch of papers that I think are good for getting the ideas (going from the paper to an implementation is really hard though, so that's why it is very helpful that the lean and koka sources are available).</p>



<a name="418361677"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/418361677" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#418361677">(Jan 26 2024 at 22:47)</a>:</h4>
<p><a href="https://arxiv.org/pdf/1908.05647.pdf">https://arxiv.org/pdf/1908.05647.pdf</a><br>
<a href="https://www.microsoft.com/en-us/research/uploads/prod/2020/11/perceus-tr-v1.pdf">https://www.microsoft.com/en-us/research/uploads/prod/2020/11/perceus-tr-v1.pdf</a><br>
<a href="https://www.microsoft.com/en-us/research/uploads/prod/2021/11/flreuse-tr.pdf">https://www.microsoft.com/en-us/research/uploads/prod/2021/11/flreuse-tr.pdf</a><br>
<a href="https://www.microsoft.com/en-us/research/uploads/prod/2023/05/fbip.pdf">https://www.microsoft.com/en-us/research/uploads/prod/2023/05/fbip.pdf</a></p>
<p>are the papers in chronological order</p>



<a name="418361957"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/418361957" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#418361957">(Jan 26 2024 at 22:50)</a>:</h4>
<p>(we like these papers, have read them already, and are always happy to talk about them)</p>



<a name="418403229"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/418403229" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rupert Smith <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#418403229">(Jan 27 2024 at 09:24)</a>:</h4>
<p>Thanks for the help - now I got some more papers to read!</p>



<a name="418403679"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/418403679" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rupert Smith <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#418403679">(Jan 27 2024 at 09:31)</a>:</h4>
<p>Interesting that all these papers are in the last 3 years - I might have thought this to have been a significant research area in FP in the 90s, whem computers were slower and had way less memory. I guess we didn't have the compiler infrastructure (LLVM etc) that we do now, and also a lot of research focussed on the theory side. MLton was highly optimised and never did this? But then ML did have mutation so I guess not needed.</p>
<p>The authors of the "counting immutable beans" paper suggest that their work is only scratching the surface of what ought to be possible.</p>
<p>Although, looking at the bilbiographies I see work by Hoffman in 2000 referenced and lots of other stuff around that time. I guess its just a topic that has come back for another round of consideration.</p>



<a name="418449542"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/418449542" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#418449542">(Jan 27 2024 at 22:00)</a>:</h4>
<p>it's an old idea, but does not work in most languages because it is so easy to create RC cycles: in languages with mutation it is trivial (java, ocaml) and in haskell laziness relies on cyclic values. So in most PL tradictions RC just did not make sense</p>



<a name="418449553"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/418449553" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#418449553">(Jan 27 2024 at 22:00)</a>:</h4>
<p>until we got some pure, strict languages</p>



<a name="418460301"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/418460301" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#418460301">(Jan 28 2024 at 01:04)</a>:</h4>
<p><span class="user-mention" data-user-id="343810">@Brendan Hansknecht</span> raised a good point in <a href="https://github.com/roc-lang/basic-webserver/issues/23">https://github.com/roc-lang/basic-webserver/issues/23</a></p>
<p>Specifically the part about</p>
<blockquote>
<p>We need to implement the Body and Buf trait on RocList type. That will enable us to hand the roc list off to hyper with hyper reading directly from the list. Again, no need to copy data or reallocate. The implementation should be pretty simple and the same as would be done for a vector of bytes in rust.</p>
</blockquote>
<p>I was thinking maybe we should add this to <code>RustGlue.roc</code> for the benefit of all. Brendan pointed out that <code>Buf</code> and <code>Body</code> are hyper specific, but maybe there is a generic rust trait that would be more suitable.</p>



<a name="418460551"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/418460551" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#418460551">(Jan 28 2024 at 01:09)</a>:</h4>
<p>Looks like we get <code>Buf</code> through <a href="https://docs.rs/hyper/latest/hyper/body/trait.Buf.html#impl-Buf-for-Cursor%3CT%3E">Cursor</a>. To get <a href="https://doc.rust-lang.org/nightly/std/io/struct.Cursor.html">Cursor</a> just requires <a href="https://doc.rust-lang.org/nightly/std/convert/trait.AsRef.html">AsRef&lt;[u8]&gt;</a> which we should be able to implement in general.</p>



<a name="418460595"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/418460595" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#418460595">(Jan 28 2024 at 01:10)</a>:</h4>
<p>So that is at least part of the story with just a builtin trait</p>



<a name="418460627"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/418460627" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#418460627">(Jan 28 2024 at 01:11)</a>:</h4>
<p>I can add an issue for this if we want to update RustGlue to generate this</p>



<a name="418460644"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/418460644" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#418460644">(Jan 28 2024 at 01:11)</a>:</h4>
<p>I think I understand the idea enough to write up an issue</p>



<a name="418525670"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/418525670" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#418525670">(Jan 28 2024 at 18:47)</a>:</h4>
<p>Huh, apparently inline expectations always run even if they aren't checked: <a href="https://github.com/roc-lang/roc/issues/6456">https://github.com/roc-lang/roc/issues/6456</a></p>



<a name="418528484"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/418528484" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#418528484">(Jan 28 2024 at 19:24)</a>:</h4>
<p>they are also not implemented in the repl/dev backend. bit of a shame</p>



<a name="418847115"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/418847115" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#418847115">(Jan 30 2024 at 14:29)</a>:</h4>
<p>can someone one aarch64 figure out what LLVM is actually complaining about here </p>
<p><a href="https://github.com/roc-lang/roc/actions/runs/7711240861/job/21016231307?pr=6463">https://github.com/roc-lang/roc/actions/runs/7711240861/job/21016231307?pr=6463</a></p>
<p>it works fine on all the other targets, so it's odd</p>



<a name="418849706"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/418849706" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kiryl Dziamura <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#418849706">(Jan 30 2024 at 14:41)</a>:</h4>
<p>I can run it locally, would it be helpful if I provide the IR file? or I can dig into the problem on my own but it will be very ineffective I think</p>
<p>anyway, let me check, maybe I can do smth about it. at least I already reproduced the problem. it's clear that it's an inconsistency between the expected return type and the actual one</p>



<a name="418863340"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/418863340" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kiryl Dziamura <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#418863340">(Jan 30 2024 at 15:30)</a>:</h4>
<p>it helped:</p>
<div class="codehilite"><pre><span></span><code>pub fn powC(arg1: RocDec, arg2: RocDec) callconv(.C) i128 {
    return @call(.always_inline, RocDec.pow, .{ arg1, arg2 }).num;
}
</code></pre></div>
<p>should I create a pr?</p>



<a name="418863473"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/418863473" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#418863473">(Jan 30 2024 at 15:31)</a>:</h4>
<p>let me check how that affects x86 real quick</p>



<a name="418864133"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/418864133" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#418864133">(Jan 30 2024 at 15:34)</a>:</h4>
<p>that works, I'll just amend my commit and force push that. thanks for looking!</p>



<a name="419134902"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/419134902" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#419134902">(Jan 31 2024 at 22:29)</a>:</h4>
<p>how do we validate that this fix is correct? <a href="https://github.com/roc-lang/roc/pull/6476">https://github.com/roc-lang/roc/pull/6476</a> it adjusts some CSS, I'm assuming it's correct but actually have no idea</p>



<a name="419141479"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/419141479" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#419141479">(Jan 31 2024 at 23:18)</a>:</h4>
<p>I'll take a look at it tonight</p>



<a name="419181497"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/419181497" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#419181497">(Feb 01 2024 at 06:22)</a>:</h4>
<p>What is our recommendation for one off error types?</p>
<p>In this specific case, I am implementing <code>TryFrom</code> to go from a <code>target_lexicon::Triple</code> to a <code>roc_target::Target</code>. <code>target_lexicon</code> has tons of triples we don't support. So the error type would literally just be a single element enum if I create a full error type. Just <code>UnsupportedTriple</code>.</p>



<a name="419181693"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/419181693" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#419181693">(Feb 01 2024 at 06:25)</a>:</h4>
<p>I guess since there is only one possible failure, I could also just implement it with <code>Err(())</code></p>



<a name="419212354"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/419212354" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Carroll <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#419212354">(Feb 01 2024 at 10:07)</a>:</h4>
<p>If you make a single variant enum then it's equivalent to <code>()</code> but at least there's an informative name in the source code. And it's easy to extend later if needed.<br>
I think that's our recommendation at work for Elm and Haskell code.</p>



<a name="419274542"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/419274542" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#419274542">(Feb 01 2024 at 15:44)</a>:</h4>
<p>True. Wish I had roc tag unions in rust.</p>
<p>Just feels kinda strange to make a one off super specific error enum. But I guess it doesn't hurt anything that it exists.</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="k">pub</span><span class="w"> </span><span class="k">enum</span> <span class="nc">TargetFromTripleError</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">TripleUnsupported</span><span class="p">,</span>
<span class="p">}</span>
</code></pre></div>



<a name="419956933"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/419956933" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#419956933">(Feb 06 2024 at 01:10)</a>:</h4>
<p>SIMD is wild: decoding a bunch of UTF-8 bytes faster than memcpy, and that's only using 128-bit SIMD</p>
<p><a href="https://twitter.com/mitchellh/status/1754645531312435584">https://twitter.com/mitchellh/status/1754645531312435584</a></p>



<a name="419957579"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/419957579" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#419957579">(Feb 06 2024 at 01:18)</a>:</h4>
<p>I remember chatting with someone who is working on future CPUs and also in memory mini CPU like devices. He made a big complaint about memcpys being horridly slow compared to how fast it could be.</p>



<a name="419966801"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/419966801" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#419966801">(Feb 06 2024 at 03:04)</a>:</h4>
<p>I heard there was some plan to do dedicated CPU instructions for memcpy in some mainstream chips</p>



<a name="419966809"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/419966809" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#419966809">(Feb 06 2024 at 03:04)</a>:</h4>
<p>like intel or arm or something</p>



<a name="419966846"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/419966846" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#419966846">(Feb 06 2024 at 03:05)</a>:</h4>
<p>Intel has <code>rep mov</code></p>



<a name="419966878"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/419966878" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#419966878">(Feb 06 2024 at 03:05)</a>:</h4>
<p>With the right CPU and extensions for microcode, I think it tends to be a reasonable speed. That said, a number of CPUs it is worse than the generic simd versions</p>



<a name="419966943"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/419966943" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#419966943">(Feb 06 2024 at 03:06)</a>:</h4>
<p>I would assume arm has an equivalent</p>



<a name="419966965"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/419966965" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#419966965">(Feb 06 2024 at 03:07)</a>:</h4>
<p>I think risc v has a generic use the largest simd you have then let me deal with the little bit of leftover bytes type vector instructions.</p>



<a name="419967578"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/419967578" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#419967578">(Feb 06 2024 at 03:15)</a>:</h4>
<blockquote>
<p>The CPUID feature "ERMS", "Enhanced REP MOVSB", means you should use <code>rep movsb</code> for any memory copy that's at least 128 bytes. The CPUID feature "FSRM", "Fast Short REP MOVSB", implies ERMS and additionally means that you should use <code>rep movsb</code> for any memory copy, even if it's shorter than 128 bytes.</p>
</blockquote>
<p>This is starting with ice lake where rep mov should be pretty competitive but still isn't always the best on Intel.</p>



<a name="419968459"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/419968459" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#419968459">(Feb 06 2024 at 03:25)</a>:</h4>
<p>From a stack overflow post they suggest that a fully optimized and prefecthed sse2 memcopy can still be ~25% faster for large memory copies. That said it is decently old and theoretically rep.mov should be even better now. That said sse will be consistent across CPUs, rep mov will not, so I think a lot of implementations defensively use sse.</p>



<a name="419969258"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/419969258" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#419969258">(Feb 06 2024 at 03:34)</a>:</h4>
<p>Digging around a bit more, depending on exact CPU, small memcpys (which is most memcpys) that use <code>rep mov</code> could have anywhere from 7 to 50ish cycle of startup latency. For something that is under let's say 64 bytes, it will generally still be way faster to just use 8 byte wide mov operations that target registers or similar.</p>
<p>This is also why the advice is to avoid memcpys if you know the size (and it is small). The cost of looping for something like this can be pretty darn heavy.</p>



<a name="419969374"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/419969374" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#419969374">(Feb 06 2024 at 03:35)</a>:</h4>
<p>branch mispredictions strike again</p>



<a name="419969664"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/419969664" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#419969664">(Feb 06 2024 at 03:39)</a>:</h4>
<p>Not just that, but like the actual number of extra instructions between the memory movement instructions. Each cycle might load 8 instructions. Those 8 instructions might be check, conditional jump, load, store, inc counter, jump to top, 2 unused after loop instructions.</p>
<p>Instead it could be 4 load and 4 store operations for the entire copy if the move is 32 bytes and copied with registers.</p>



<a name="419969796"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/419969796" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#419969796">(Feb 06 2024 at 03:40)</a>:</h4>
<p>Loop unrolling of course helps some with this, but then you hit the branch misprediction issues more due to the loop running so few times.</p>



<a name="420310520"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/420310520" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#420310520">(Feb 07 2024 at 17:59)</a>:</h4>
<p><span aria-label="star" class="emoji emoji-2b50" role="img" title="star">:star:</span> Achievement unlocked</p>
<div class="codehilite"><pre><span></span><code>Panicked during a panic. Aborting
</code></pre></div>



<a name="420310710"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/420310710" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#420310710">(Feb 07 2024 at 18:00)</a>:</h4>
<p>Welcome to the club <span aria-label="clap" class="emoji emoji-1f44f" role="img" title="clap">:clap:</span></p>



<a name="421779285"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/421779285" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#421779285">(Feb 16 2024 at 03:10)</a>:</h4>
<p><a href="https://www.bazhenov.me/posts/2024-02-performance-roulette/">https://www.bazhenov.me/posts/2024-02-performance-roulette/</a></p>



<a name="421792896"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/421792896" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#421792896">(Feb 16 2024 at 05:31)</a>:</h4>
<p>Related to trying to deal with stuff like this: <a href="https://github.com/llvm/llvm-project/blob/main/bolt/README.md">https://github.com/llvm/llvm-project/blob/main/bolt/README.md</a></p>



<a name="421968928"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/421968928" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#421968928">(Feb 17 2024 at 03:00)</a>:</h4>
<p>So they updated one of the examples in the Mojo vs Rust blog and this is actually a really useful footgun in rust to know of:</p>
<p>In Rust, this is not a tail recursive function:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="k">fn</span> <span class="nf">recursive</span><span class="p">(</span><span class="n">x</span>: <span class="kt">usize</span><span class="p">){</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="k">mut</span><span class="w"> </span><span class="n">stuff</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">Vec</span>::<span class="n">with_capacity</span><span class="p">(</span><span class="n">x</span><span class="p">);</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="mi">0</span><span class="o">..</span><span class="n">x</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">stuff</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="n">recursive</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>
<p><a href="https://rust.godbolt.org/z/7q3os1fsq">https://rust.godbolt.org/z/7q3os1fsq</a></p>



<a name="421968965"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/421968965" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#421968965">(Feb 17 2024 at 03:00)</a>:</h4>
<p>Another reason why rust is not really a true functional language (despite having many functional features). If you do a lot of true functional programming patterns you may hit cases like this that blow up.</p>



<a name="421969020"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/421969020" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#421969020">(Feb 17 2024 at 03:01)</a>:</h4>
<p>Essentially, the drop function for the <code>Vec</code> is run at the end of the scope. This means that it runs after the recursive call.</p>



<a name="421969025"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/421969025" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#421969025">(Feb 17 2024 at 03:01)</a>:</h4>
<p>As such, the function can't have TCO.</p>



<a name="421998509"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/421998509" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#421998509">(Feb 17 2024 at 09:55)</a>:</h4>
<p>Interesting :)</p>



<a name="422006021"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/422006021" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#422006021">(Feb 17 2024 at 11:58)</a>:</h4>
<p>wow, I never thought about that!</p>



<a name="422026247"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/422026247" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#422026247">(Feb 17 2024 at 16:42)</a>:</h4>
<p><a href="https://zed.dev/blog/we-have-to-start-over">https://zed.dev/blog/we-have-to-start-over</a> really resonates with me!</p>



<a name="422035891"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/422035891" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#422035891">(Feb 17 2024 at 19:12)</a>:</h4>
<p>I'd like to try out the llvm interpreter <a href="https://llvm.org/docs/CommandGuide/lli.html">lli</a> to help me debug something. Does anybody here have experience with it?</p>



<a name="425685788"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/425685788" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#425685788">(Mar 09 2024 at 13:19)</a>:</h4>
<p>interesting comment about crate features and CLI parsing edge cases from the author of <code>clap</code> <a href="https://lobste.rs/s/nqootu/sudo_rs_dependencies_when_less_is_better#c_zzvxru">https://lobste.rs/s/nqootu/sudo_rs_dependencies_when_less_is_better#c_zzvxru</a></p>



<a name="426165501"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/426165501" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#426165501">(Mar 12 2024 at 16:24)</a>:</h4>
<p>What does expect-fx do exactly?</p>



<a name="426165708"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/426165708" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#426165708">(Mar 12 2024 at 16:24)</a>:</h4>
<p>When implemented, it will allow you to mock effects so that you can run an expect on an effectful function</p>



<a name="426165791"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/426165791" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#426165791">(Mar 12 2024 at 16:25)</a>:</h4>
<p>Thanks Brendan :)</p>



<a name="426169517"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/426169517" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#426169517">(Mar 12 2024 at 16:42)</a>:</h4>
<p>slight correction: the idea is for that one to run the real effects</p>



<a name="426169543"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/426169543" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#426169543">(Mar 12 2024 at 16:42)</a>:</h4>
<p>for integration tests and such</p>



<a name="426169828"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/426169828" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#426169828">(Mar 12 2024 at 16:44)</a>:</h4>
<p>So regular expect will be extended to mocking effects?</p>



<a name="426187841"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/426187841" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#426187841">(Mar 12 2024 at 18:21)</a>:</h4>
<p><a href="https://docs.google.com/document/d/110MwQi7Dpo1Y69ECFXyyvDWzF4OYv1BLojIm08qDTvg/edit?usp=sharing">https://docs.google.com/document/d/110MwQi7Dpo1Y69ECFXyyvDWzF4OYv1BLojIm08qDTvg/edit?usp=sharing</a> under "Simulation Tests"</p>



<a name="426187964"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/426187964" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#426187964">(Mar 12 2024 at 18:22)</a>:</h4>
<p>I think we need a separate keyword for that</p>



<a name="426187974"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/426187974" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#426187974">(Mar 12 2024 at 18:22)</a>:</h4>
<p>the proposal uses <code>expect-sim</code></p>



<a name="426188616"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/426188616" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#426188616">(Mar 12 2024 at 18:26)</a>:</h4>
<p>Ah yeah</p>



<a name="426453554"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/426453554" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#426453554">(Mar 14 2024 at 01:22)</a>:</h4>
<p>I'm seeing this error <code>thread 'test::lookup_clone_result' panicked at 'misaligned pointer dereference: address must be a multiple of 0x8 but is 0x16dc05d74', crates/repl_expect/src/app.rs:57:45</code>. on this PR <a href="https://github.com/roc-lang/roc/pull/6586">https://github.com/roc-lang/roc/pull/6586</a> but I'm pretty sure it is unrelated. (when I run <code>cargo test</code> locally on my mac, I've pushed to CI to see if that is just my setup)</p>
<p>Also, I wasn't sure if I should have committed all the glue/tests/fixtures/. Would appreciate if someone could confirm if that is the correct thing to do when they are changed.</p>



<a name="426665789"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/426665789" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#426665789">(Mar 15 2024 at 03:03)</a>:</h4>
<p>Is anyone familar with <code>glue/tests/fixtures</code> able to comment on <a href="https://github.com/roc-lang/roc/pull/6586">https://github.com/roc-lang/roc/pull/6586</a> please?</p>
<p>There were a bunch of files generated and I'm not sure if they should be committed. This is the header from one of them</p>
<div class="codehilite"><pre><span></span><code># ⚠️ READ THIS BEFORE MODIFYING THIS FILE! ⚠️
#
# This file is a fixture template. If the file you&#39;re looking at is
# in the fixture-templates/ directory, then you&#39;re all set - go ahead
# and modify it, and it will modify all the fixture tests.
#
# If this file is in the fixtures/ directory, on the other hand, then
# it is gitignored and will be overwritten the next time tests run.
</code></pre></div>



<a name="426665868"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/426665868" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#426665868">(Mar 15 2024 at 03:04)</a>:</h4>
<p>I'm guessing I should remove these from the PR and update our gitignore so these aren't included</p>



<a name="426666620"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/426666620" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#426666620">(Mar 15 2024 at 03:13)</a>:</h4>
<p>Yeah, Don't commit them.</p>



<a name="426766132"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/426766132" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jonathan Schear <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#426766132">(Mar 15 2024 at 15:22)</a>:</h4>
<p><span class="user-mention silent" data-user-id="515757">Luke Boswell</span> <a href="#narrow/stream/395097-compiler-development/topic/Casual.20Conversation/near/426453554">said</a>:</p>
<blockquote>
<p>I'm seeing this error <code>thread 'test::lookup_clone_result' panicked at 'misaligned pointer dereference: address must be a multiple of 0x8 but is 0x16dc05d74', crates/repl_expect/src/app.rs:57:45</code>. on this PR <a href="https://github.com/roc-lang/roc/pull/6586">https://github.com/roc-lang/roc/pull/6586</a> but I'm pretty sure it is unrelated. (when I run <code>cargo test</code> locally on my mac, I've pushed to CI to see if that is just my setup)</p>
</blockquote>
<p>I'm seeing this on my M1 mac too, but haven't seen it hit on CI.</p>



<a name="426767737"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/426767737" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jonathan Schear <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#426767737">(Mar 15 2024 at 15:29)</a>:</h4>
<p>ah, looks like its logged here: <a href="https://github.com/roc-lang/roc/issues/6100">https://github.com/roc-lang/roc/issues/6100</a> (it passes when running with <code>--release</code> (oof))</p>



<a name="426890416"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/426890416" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#426890416">(Mar 16 2024 at 13:17)</a>:</h4>
<p><a href="https://kobzol.github.io/rust/rustc/2024/03/15/rustc-what-takes-so-long.html">https://kobzol.github.io/rust/rustc/2024/03/15/rustc-what-takes-so-long.html</a></p>
<p>slightly more detailed benchmarks of what part of compilation takes so long in rust</p>



<a name="426895875"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/426895875" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#426895875">(Mar 16 2024 at 14:31)</a>:</h4>
<p>looks familiar! <span aria-label="big smile" class="emoji emoji-1f604" role="img" title="big smile">:big_smile:</span><br>
<a href="/user_uploads/22008/Ugl--A-QdFcoL-ulD3eNJ-Ux/share_5249400518627343545.png">share_5249400518627343545.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/22008/Ugl--A-QdFcoL-ulD3eNJ-Ux/share_5249400518627343545.png" title="share_5249400518627343545.png"><img src="/user_uploads/22008/Ugl--A-QdFcoL-ulD3eNJ-Ux/share_5249400518627343545.png"></a></div>



<a name="426895990"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/426895990" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#426895990">(Mar 16 2024 at 14:32)</a>:</h4>
<p>I remain very confused why nobody on the Rust team is even talking about doing a direct to machine code backend</p>



<a name="426896027"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/426896027" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#426896027">(Mar 16 2024 at 14:33)</a>:</h4>
<p>that and linking are where all the compilation time goes!</p>



<a name="426899398"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/426899398" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#426899398">(Mar 16 2024 at 15:20)</a>:</h4>
<p>Most surprising part of that article to me was how much work the rust frontend must do in release builds.</p>



<a name="426899430"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/426899430" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#426899430">(Mar 16 2024 at 15:21)</a>:</h4>
<p>I expected the release and dev full compilation builds to be more starkly different due to llvm eating way way more time.</p>



<a name="426899488"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/426899488" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#426899488">(Mar 16 2024 at 15:22)</a>:</h4>
<p>Instead we have llvm going from ~70% to ~80%</p>



<a name="426899863"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/426899863" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#426899863">(Mar 16 2024 at 15:27)</a>:</h4>
<p>I guess to be fair, he said it was using the default 16 different units. So llvm could be running on up to 16 threads. So if it was single threaded it would be a lot slower.</p>



<a name="426900013"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/426900013" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#426900013">(Mar 16 2024 at 15:29)</a>:</h4>
<p>yeah that makes sense <span aria-label="thumbs up" class="emoji emoji-1f44d" role="img" title="thumbs up">:thumbs_up:</span></p>



<a name="426900144"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/426900144" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#426900144">(Mar 16 2024 at 15:30)</a>:</h4>
<p>Found a good article on the backend code gen units. Apparently incremental builds set code gen units to 256. So really break up crates in hopes of making compilation able to cache more work: <a href="https://nnethercote.github.io/2023/07/11/back-end-parallelism-in-the-rust-compiler.html">https://nnethercote.github.io/2023/07/11/back-end-parallelism-in-the-rust-compiler.html</a></p>



<a name="426900458"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/426900458" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#426900458">(Mar 16 2024 at 15:35)</a>:</h4>
<p>Interesting</p>



<a name="426900494"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/426900494" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#426900494">(Mar 16 2024 at 15:35)</a>:</h4>
<p>yeah that's what <span class="user-mention" data-user-id="516570">@matklad</span> was telling me - more, smaller crates improves caching</p>



<a name="427090287"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/427090287" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#427090287">(Mar 17 2024 at 11:18)</a>:</h4>
<p><a href="https://twitter.com/mitchellh/status/1769143787862049013">https://twitter.com/mitchellh/status/1769143787862049013</a></p>
<p>I don't think LLVM automatically bit-packs booleans (let alone tag unions) does it?</p>



<a name="427100463"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/427100463" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#427100463">(Mar 17 2024 at 12:03)</a>:</h4>
<p>no you'd have to do that yourself</p>



<a name="427100610"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/427100610" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#427100610">(Mar 17 2024 at 12:04)</a>:</h4>
<p>there is <code>repr(packed)</code> which might do some amount of packing ?</p>



<a name="427106846"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/427106846" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#427106846">(Mar 17 2024 at 12:33)</a>:</h4>
<p>I thought that just meant no alignment padding</p>



<a name="427144433"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/427144433" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#427144433">(Mar 17 2024 at 15:20)</a>:</h4>
<p>really interesting read about debuggers and libc! <a href="https://www.brendangregg.com/blog/2024-03-17/the-return-of-the-frame-pointers.html">https://www.brendangregg.com/blog/2024-03-17/the-return-of-the-frame-pointers.html</a></p>



<a name="427160919"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/427160919" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#427160919">(Mar 17 2024 at 16:31)</a>:</h4>
<p><span class="user-mention silent" data-user-id="281383">Richard Feldman</span> <a href="#narrow/stream/395097-compiler-development/topic/Casual.20Conversation/near/426900494">said</a>:</p>
<blockquote>
<p>yeah that's what <span class="user-mention silent" data-user-id="516570">matklad</span> was telling me - more, smaller crates improves caching</p>
</blockquote>
<p>That's kinda surprising. If every crate is split into 256 pieces, you would think that small crate size wouldn't matter. At least not much.</p>



<a name="427161415"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/427161415" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#427161415">(Mar 17 2024 at 16:34)</a>:</h4>
<p>well in the sense of like - as opposed to having big crates with lots of modules</p>



<a name="427161545"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/427161545" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#427161545">(Mar 17 2024 at 16:34)</a>:</h4>
<p>because things are cached at the level of crates and not modules, so more crates means a higher % of the build that's cached</p>



<a name="427164890"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/427164890" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#427164890">(Mar 17 2024 at 16:49)</a>:</h4>
<p>Sure, but assuming they are actually able to split into fine grain enough pieces (with incremental compilation having a goal of 256 pieces per crate), you would think that most things are split well enough to have decent incremental compilation. Cause even if you have 1024 functions in your crate, that is only compiling 4 functions per code gen unit. So a small change only has to recompile 4 functions (and things that depend on those 4 functions). I guess any crate 256 functions or less means function level caching and dependency graph.</p>



<a name="427165222"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/427165222" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#427165222">(Mar 17 2024 at 16:50)</a>:</h4>
<p>I wonder how many functions the average crate actually is.</p>



<a name="427739574"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/427739574" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#427739574">(Mar 19 2024 at 14:48)</a>:</h4>
<p>Good rant: <a href="http://danluu.com/slow-device/">danluu.com/slow-device/</a></p>
<p>Only skilled it so far. I'll have to give it a more detailed read later.</p>



<a name="427747246"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/427747246" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#427747246">(Mar 19 2024 at 15:18)</a>:</h4>
<blockquote>
<p>[...] a lot of forums are now inaccessible to people who don't have enough wealth to buy a device with effectively infinite CPU.</p>
</blockquote>
<p>Interesting post, this is not something I've deeply thought about before.</p>



<a name="427757534"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/427757534" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#427757534">(Mar 19 2024 at 15:59)</a>:</h4>
<p>I think <a href="#narrow/stream/304641-ideas/topic/design.20for.20a.20Roc.20forum/near/423225836">this proposed forum design</a> should do very well on those benchmarks! <span aria-label="smiley" class="emoji emoji-1f603" role="img" title="smiley">:smiley:</span></p>



<a name="427818509"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/427818509" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eli Dowling <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#427818509">(Mar 19 2024 at 21:59)</a>:</h4>
<p>Wow, very interesting read. <br>
I think about this very time I use a language server <span aria-label="sweat smile" class="emoji emoji-1f605" role="img" title="sweat smile">:sweat_smile:</span>. Like this should be able to run on the worst device imaginable, it's actually one of the reasons I started working on developer tooling, seeing that many folks would find some of these tools impossible to use because of their "everyone has a fast PC" design.</p>
<p>On that, I can confidently say rocls runs comfortably on my laptop in its power saving mode with the CPU limited to 800mhz, but we can definitely improve caching to make that even better.</p>



<a name="427876426"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/427876426" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#427876426">(Mar 20 2024 at 08:38)</a>:</h4>
<p><a href="https://davidlattimore.github.io/posts/2024/03/18/wild-linker-march-update.html">https://davidlattimore.github.io/posts/2024/03/18/wild-linker-march-update.html</a> cool rust linker stuff</p>



<a name="428048767"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/428048767" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#428048767">(Mar 21 2024 at 02:46)</a>:</h4>
<p>Finally working on roc again. Continuing my changes to how we handle targets. I am now super deep in letting the types guide me. Very much type error driven development. Kinda satisfying, but also such a gigantic footprint.</p>



<a name="428048944"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/428048944" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#428048944">(Mar 21 2024 at 02:49)</a>:</h4>
<p>Also, I really want to remove target from type checking only flows. It shouldn't be needed, but ends up being required cause uses farther down the compiler need it. Might reorchestrate that. Would require passing it in later instead of storing it in a bunch of types. May not be worth it, but want to look into it more.</p>



<a name="428098793"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/428098793" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#428098793">(Mar 21 2024 at 10:42)</a>:</h4>
<p>that makes sense!</p>



<a name="428120387"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/428120387" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> matklad <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#428120387">(Mar 21 2024 at 12:48)</a>:</h4>
<blockquote>
<p>yeah that's what @matklad was telling me - more, smaller crates improves caching</p>
</blockquote>
<p>Not exactly: this is not as much about the _size_ of the crate, as about the topology of crate graph. If you have one thousand tiny crates which are linearly dependent on each other, this is more or less the same as one giant crate.</p>
<p>On the other hand, if you have a sort-of start topology with 1 central crate, and 10 mutually-independent supporting crates, than that's great for incremental. </p>
<p>Topology &gt; Size</p>



<a name="428135228"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/428135228" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#428135228">(Mar 21 2024 at 13:58)</a>:</h4>
<p>sure, I meant smaller just in the sense of breaking up a larger crate to be more granular necessarily means making it smaller</p>



<a name="428251120"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/428251120" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#428251120">(Mar 22 2024 at 02:39)</a>:</h4>
<p>I think we should make the <code>--linker=legacy</code> the default option for Windows for now as we know we have a surgical linker bug that segfaults. <span class="user-mention" data-user-id="281543">@Folkert de Vries</span> what do you think?</p>



<a name="428374546"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/428374546" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#428374546">(Mar 22 2024 at 17:03)</a>:</h4>
<p>well we never really investigated that bug right? on the other hand, using the legacy linker as the default might be pragmatic for now</p>



<a name="428374563"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/428374563" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#428374563">(Mar 22 2024 at 17:03)</a>:</h4>
<p>I'm not opposed to it, anyway</p>



<a name="429088632"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/429088632" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#429088632">(Mar 23 2024 at 15:10)</a>:</h4>
<p>Cranelift Rust frontend putting up some impressive improvements: <a href="https://www.williballenthin.com/post/rust-compilation-time/">https://www.williballenthin.com/post/rust-compilation-time/</a></p>



<a name="429151765"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/429151765" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#429151765">(Mar 24 2024 at 04:36)</a>:</h4>
<p>Good read on bash pipes, benchmarking, and zig: <a href="https://mtlynch.io/zig-extraneous-build/">https://mtlynch.io/zig-extraneous-build/</a></p>
<p>Shows a very easy benchmarking mistake to make with pipes.</p>



<a name="429322409"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/429322409" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#429322409">(Mar 25 2024 at 09:05)</a>:</h4>
<blockquote>
<p>It turns out that all commands in a bash pipeline start at the same time.</p>
</blockquote>
<p>Weird...</p>



<a name="429322605"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/429322605" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#429322605">(Mar 25 2024 at 09:06)</a>:</h4>
<p>yeah this is fun</p>
<div class="codehilite"><pre><span></span><code>$ time $(sleep 1 | sleep 1)

real    0m1.020s
user    0m0.002s
sys 0m0.006s
</code></pre></div>



<a name="429420852"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/429420852" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#429420852">(Mar 25 2024 at 14:26)</a>:</h4>
<p>I'm surprised more people don't know this. Pipe can only store like 4k characters by default. The inputting app will get stuck on IO if the next isn't processing fast enough.</p>
<p>Also, you want them all to start at the same time so that it runs faster as a whole without eating all your memory buffering.</p>
<p>This is also why you can pipe through a programming like tee and see live output.</p>



<a name="429441587"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/429441587" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#429441587">(Mar 25 2024 at 15:37)</a>:</h4>
<p>this is sweet! <a href="https://coredumped.dev/2024/03/25/bump-allocation-up-or-down/">https://coredumped.dev/2024/03/25/bump-allocation-up-or-down/</a></p>



<a name="429530482"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/429530482" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#429530482">(Mar 25 2024 at 23:52)</a>:</h4>
<p>Not sure if anyone here has read more details of the new apple hardware vulnerability, but I hate how nice things that make CPUs faster are almost always the source of security vulnerabilities: <a href="https://gofetch.fail/">https://gofetch.fail/</a></p>



<a name="429530516"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/429530516" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#429530516">(Mar 25 2024 at 23:53)</a>:</h4>
<p>In this case, this vulnerability was fully explored on apple hardware, but probably also affects the newest intel hardware.</p>



<a name="429530572"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/429530572" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#429530572">(Mar 25 2024 at 23:54)</a>:</h4>
<p>It probably will also affect other new hardware if they don't make changes/fixes. Apple was just ahead of the game on adding data dependent memory prefetchers to their cpus (part of the reason why the apple M chips are so fast)</p>



<a name="429530676"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/429530676" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#429530676">(Mar 25 2024 at 23:54)</a>:</h4>
<p>Basically when they load a cache line, they check it for things that look like pointers. If they find one, they prefetch it. Huge gain when loading a linked list for example.</p>



<a name="429530729"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/429530729" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#429530729">(Mar 25 2024 at 23:55)</a>:</h4>
<p>That said, I don't know how much this vulnerability matters. It has to be exploited by a process running locally on your machine. If an attacker has a process running locally on your machine, you are probably already screwed.</p>



<a name="429748653"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/429748653" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#429748653">(Mar 26 2024 at 22:15)</a>:</h4>
<p><a href="https://blog.rust-lang.org/inside-rust/2024/03/26/this-development-cycle-in-cargo-1.78.html">https://blog.rust-lang.org/inside-rust/2024/03/26/this-development-cycle-in-cargo-1.78.html</a> has some cool ideas for testing the styling of compiler output with svgs</p>



<a name="429751501"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/429751501" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#429751501">(Mar 26 2024 at 22:45)</a>:</h4>
<p>whoooa, apparently Windows APIs are going UTF-8 by default! <span aria-label="astonished" class="emoji emoji-1f632" role="img" title="astonished">:astonished:</span> </p>
<p><a href="https://stackoverflow.com/questions/70201846/windows-11-default-api-and-utf-encoding/70263105#70263105">https://stackoverflow.com/questions/70201846/windows-11-default-api-and-utf-encoding/70263105#70263105</a></p>



<a name="429819169"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/429819169" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Fabian Schmalzried <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#429819169">(Mar 27 2024 at 09:45)</a>:</h4>
<p><span class="user-mention silent" data-user-id="343810">Brendan Hansknecht</span> <a href="#narrow/stream/395097-compiler-development/topic/Casual.20Conversation/near/429530482">said</a>:</p>
<blockquote>
<p>Not sure if anyone here has read more details of the new apple hardware vulnerability, but I hate how nice things that make CPUs faster are almost always the source of security vulnerabilities: <a href="https://gofetch.fail/">https://gofetch.fail/</a></p>
</blockquote>
<p>Wow that exploit is fascinating: <a href="https://youtu.be/klhDbLV4Los?si=5Gc8RZf1B98aGV6o">https://youtu.be/klhDbLV4Los?si=5Gc8RZf1B98aGV6o</a></p>
<div class="youtube-video message_inline_image"><a data-id="klhDbLV4Los" href="https://youtu.be/klhDbLV4Los?si=5Gc8RZf1B98aGV6o"><img src="https://uploads.zulipusercontent.net/3ac543f533c1b18bf7a0229642f221cf4965b805/68747470733a2f2f692e7974696d672e636f6d2f76692f6b6c6844624c56344c6f732f64656661756c742e6a7067"></a></div>



<a name="430020109"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/430020109" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#430020109">(Mar 28 2024 at 08:45)</a>:</h4>
<p>I've been wanting a thing to help me print debug parser issues. I've been using snapshot tests which are great, but don't quite seem to be enough. </p>
<p>So I started threading a boolean through the parser functions and didn't really stop to think if that was a good idea. It started as a helper so I could pass in from the top of a module and then I could print debug for just that modules information. Just wondering if this would be useful to keep around, or if I shouldn't include in a PR -- there's a lot of parser functions and when you touch one it kind of explodes to all of them.</p>



<a name="430020318"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/430020318" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#430020318">(Mar 28 2024 at 08:47)</a>:</h4>
<p>I figure something like this might be optimised out of any release build if it is a constant <code>false</code> value and there was nothing using it.</p>



<a name="430021889"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/430021889" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#430021889">(Mar 28 2024 at 08:57)</a>:</h4>
<p>For example I can do something like the following and it will only print out for the modules where I have passed in <code>true</code>.</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">print_debug</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="fm">dbg!</span><span class="p">(</span><span class="o">&amp;</span><span class="n">result</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
</code></pre></div>
<p>Probably a bad idea, but it was the only way I could think to do this.</p>



<a name="430092495"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/430092495" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#430092495">(Mar 28 2024 at 15:22)</a>:</h4>
<p>A constant would be better. Optimizing away a parameter that is passed deep down the stack can happen but is unlikely.</p>



<a name="430136261"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/430136261" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ayaz Hafiz <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#430136261">(Mar 28 2024 at 18:08)</a>:</h4>
<p>Id recommend an env var or something</p>



<a name="430136344"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/430136344" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ayaz Hafiz <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#430136344">(Mar 28 2024 at 18:08)</a>:</h4>
<p>Check out roc_debug_flags and their uses elsewhere in the codebase</p>



<a name="430424032"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/430424032" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#430424032">(Mar 30 2024 at 22:20)</a>:</h4>
<p>I just learned about <code>RUSTFLAGS="-A warnings" cargo check</code> and I am SO HAPPY</p>



<a name="430424040"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/430424040" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#430424040">(Mar 30 2024 at 22:20)</a>:</h4>
<p>it's <code>cargo check</code> but where it doesn't print warnings, only errors</p>



<a name="430445412"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/430445412" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#430445412">(Mar 31 2024 at 04:42)</a>:</h4>
<p>achievement unlocked: new Rust compiler error I've never seen before <span aria-label="laughing" class="emoji emoji-1f606" role="img" title="laughing">:laughing:</span> </p>
<p><a href="/user_uploads/22008/aU7KDlftts1kCRn9TbFx9y_o/Screenshot-2024-03-31-at-12.41.37AM.png">Screenshot-2024-03-31-at-12.41.37AM.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/22008/aU7KDlftts1kCRn9TbFx9y_o/Screenshot-2024-03-31-at-12.41.37AM.png" title="Screenshot-2024-03-31-at-12.41.37AM.png"><img src="/user_uploads/22008/aU7KDlftts1kCRn9TbFx9y_o/Screenshot-2024-03-31-at-12.41.37AM.png"></a></div>



<a name="430495777"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/430495777" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#430495777">(Mar 31 2024 at 18:04)</a>:</h4>
<p>Is it just me or am I looking at the same line twice:</p>
<div class="codehilite" data-code-language="Diff"><pre><span></span><code><span class="gd">-## This means the #U64 this function returns can always be safely converted to #I64 or #I32, depending on the target.</span>
<span class="gi">+## This means the #U64 this function returns can always be safely converted to #I64 or #I32, depending on the target.</span>
</code></pre></div>



<a name="430495829"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/430495829" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#430495829">(Mar 31 2024 at 18:05)</a>:</h4>
<p>yeah? unless there is some whitespace difference?</p>



<a name="430495855"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/430495855" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#430495855">(Mar 31 2024 at 18:05)</a>:</h4>
<p>Ah, extra space at the end of the line.</p>



<a name="430682050"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/430682050" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#430682050">(Apr 01 2024 at 23:45)</a>:</h4>
<p>I'm trying to run the fuzzer for the parser and a bit stuck with rust; does anyone have any pointers?</p>
<div class="codehilite"><pre><span></span><code>10:43:02 ~/Documents/GitHub/roc/crates/compiler/test_syntax/fuzz optional-unit-assign $ cargo +nightly fuzz run -j2 fuzz_expr -- -dict=../parse/fuzz/dict.txt
error: failed to parse manifest at `/Users/luke/Documents/GitHub/roc/crates/compiler/test_syntax/fuzz/Cargo.toml`

Caused by:
  error inheriting `version` from workspace root manifest&#39;s `workspace.package.version`

Caused by:
  `workspace.package.version` was not defined
</code></pre></div>



<a name="430689391"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/430689391" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#430689391">(Apr 02 2024 at 01:12)</a>:</h4>
<p>Figured it out, and found my first bug <span aria-label="smiley" class="emoji emoji-1f603" role="img" title="smiley">:smiley:</span> with the fuzzer.</p>



<a name="430691746"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/430691746" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#430691746">(Apr 02 2024 at 01:34)</a>:</h4>
<p>Fuzzers are good at finding the same bug in many ways, so be a bit careful with that.</p>



<a name="430823461"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/430823461" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#430823461">(Apr 02 2024 at 15:59)</a>:</h4>
<p>Does the surgical linker require position independent executables(pie) as input?</p>



<a name="430834337"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/430834337" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#430834337">(Apr 02 2024 at 16:57)</a>:</h4>
<p>I would need to think about this more. That just means the executable can be loaded to anywhere in memory. That shouldn't strictly matter, but it probably does. My default thought is definitely yes.</p>



<a name="431428737"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/431428737" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#431428737">(Apr 05 2024 at 01:28)</a>:</h4>
<p>I'm finally starting to look at the big refcounting change for lists again. Where we need to pass the element dec functions into list functions so that when a list is free, all of the elements are decremented. Instead of doing recursive increfs and decrefs that kill performance everywhere.</p>
<p>I am so glad that llvm ir is strongly typed. Makes it list out all of the function signature mismatches for me. That said, still have hundreds of tests to fix....will be a journey.</p>



<a name="431430478"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/431430478" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#431430478">(Apr 05 2024 at 01:49)</a>:</h4>
<p><code>PASS [   0.665s] test_gen::test_gen gen_list::basic_int_list_len</code><br>
First heart beat. Got a super basic test passing. Now just to wire everything else up....</p>



<a name="431430576"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/431430576" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#431430576">(Apr 05 2024 at 01:50)</a>:</h4>
<p>~70 passing gen_list tests and ~130 failing.... What is that 35% passing. Not bad for most functions not being wired yet.</p>



<a name="431433663"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/431433663" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#431433663">(Apr 05 2024 at 02:24)</a>:</h4>
<p>yooooooo I am SO HYPE for this change!!!</p>



<a name="431435348"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/431435348" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#431435348">(Apr 05 2024 at 02:47)</a>:</h4>
<p>Will probably be slow progress with mem leaks and segfaults, but pushing it forward</p>



<a name="431545183"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/431545183" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#431545183">(Apr 05 2024 at 14:58)</a>:</h4>
<p>This is actually going surprisingly fast (though I have only touched the llvm backend so far).</p>
<p>gen_list: <code>208 tests run: 183 passed, 25 failed</code></p>
<p>All failures are now segfaults. Most are probably from <a class="stream-topic" data-stream-id="395097" href="/#narrow/stream/395097-compiler-development/topic/Host.20Refcounting">#compiler development &gt; Host Refcounting</a> and rust not knowing how to free refcounted lists.</p>



<a name="433013170"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/433013170" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#433013170">(Apr 13 2024 at 04:02)</a>:</h4>
<p>I'm just wondering what is going on with CI for this PR <a href="https://github.com/roc-lang/roc/pull/6587">https://github.com/roc-lang/roc/pull/6587</a></p>



<a name="433034209"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/433034209" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#433034209">(Apr 13 2024 at 09:52)</a>:</h4>
<p>It needed a new release of basic-cli, the bundle is made now, so I expect we'll be able to merge it today</p>



<a name="433034584"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/433034584" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#433034584">(Apr 13 2024 at 09:58)</a>:</h4>
<p>basic-cli also typically uses nightly Roc, but in this case we needed to use the branch, so I had to make some changes for that.</p>



<a name="433039081"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/433039081" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#433039081">(Apr 13 2024 at 11:18)</a>:</h4>
<p>Ahk, thank you. I wasn't sure. I thought it might be stuck or something.</p>



<a name="433100060"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/433100060" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#433100060">(Apr 14 2024 at 03:46)</a>:</h4>
<p>Does anyone know what could be causing this error in CI?</p>
<div class="codehilite"><pre><span></span><code>error: cvt doesn&#39;t compile for this platform yet
  --&gt; /Users/m1ci/.cargo/registry/src/index.crates.io-6f17d22bba15001f/cvt-0.1.2/src/lib.rs:22:9
   |
22 |         compile_error!(&quot;cvt doesn&#39;t compile for this platform yet&quot;);
   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

error: could not compile `cvt` (lib) due to previous error
</code></pre></div>



<a name="433101759"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/433101759" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#433101759">(Apr 14 2024 at 04:18)</a>:</h4>
<p>Or more specifically, how do we resolve something like this? </p>
<p>It seems like something that shouldn't have passed CI the first time, and not a flake. </p>
<p>I think it's unrelated to the parser/can changes on my chaining syntax PR.</p>



<a name="433171171"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/433171171" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jackson Wambolt <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#433171171">(Apr 14 2024 at 22:35)</a>:</h4>
<p>I'm investigating <a href="https://github.com/roc-lang/roc/issues/6641">#6641</a>, and I'm curious why macros like <code>skip_second</code> are macros when they could be functions - I've only verified that for <code>skip_second</code> but it looks like its true for others like <code>and</code> and <code>between</code>. Wouldn't it be faster to compile a regular function? And any runtime performance loss from could be replicated with <code>#[inline(always)]</code>.</p>



<a name="433171245"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/433171245" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#433171245">(Apr 14 2024 at 22:36)</a>:</h4>
<p>this _might_ be a renmant of the earlier parser where we wanted to use functions but that caused the rust compiler to just grind to a halt</p>



<a name="433171254"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/433171254" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#433171254">(Apr 14 2024 at 22:36)</a>:</h4>
<p>so if using a function now just works I'd say go for it!</p>



<a name="433171297"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/433171297" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#433171297">(Apr 14 2024 at 22:37)</a>:</h4>
<p>the original problem was that types got too large but both the rust compiler and our parser implementation have improved in the meantime</p>



<a name="433171363"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/433171363" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jackson Wambolt <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#433171363">(Apr 14 2024 at 22:38)</a>:</h4>
<p>Awesome, I'll see which ones can be replaced and if it compiles faster now I'll submit a PR</p>



<a name="433171409"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/433171409" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#433171409">(Apr 14 2024 at 22:39)</a>:</h4>
<p>I think functions are preferable it they are not slower (so if compile time stays the same that's also fine)</p>



<a name="433171783"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/433171783" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#433171783">(Apr 14 2024 at 22:45)</a>:</h4>
<p>yeah exactly</p>



<a name="433171798"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/433171798" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#433171798">(Apr 14 2024 at 22:45)</a>:</h4>
<p>a lot of those used to be functions and then the rust type checker was giving "recursion limit reached" errors</p>



<a name="433171849"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/433171849" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#433171849">(Apr 14 2024 at 22:46)</a>:</h4>
<p>the solution was to replace them with macros so that they didn't participate in type checking as functions</p>



<a name="433242175"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/433242175" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#433242175">(Apr 15 2024 at 09:29)</a>:</h4>
<p><span class="user-mention" data-user-id="515757">@Luke Boswell</span> on what OS are you running this? Based <a href="https://github.com/badboy/cvt/blob/45d62f6f298a69bab6cd573c73eee2d13b7a37af/src/lib.rs#L22">on the relevant source</a> it should work on macos, linux and windows...</p>



<a name="433244055"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/433244055" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#433244055">(Apr 15 2024 at 09:39)</a>:</h4>
<p>See CI in <a href="https://github.com/roc-lang/roc/pull/6634">this PR</a></p>



<a name="433244207"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/433244207" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#433244207">(Apr 15 2024 at 09:40)</a>:</h4>
<p>I've investigated a bit and I can't figure out why it doesn't work on my mac.</p>



<a name="433246683"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/433246683" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#433246683">(Apr 15 2024 at 09:52)</a>:</h4>
<p>It fails when building for wasm so the relevant source code makes sense at least. There were some changes to dependencies in that PR so I think cvt is now accidentally included in the wasm build and the cvt functionality doesn't make sense for wasm.</p>



<a name="433246842"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/433246842" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#433246842">(Apr 15 2024 at 09:53)</a>:</h4>
<p>Ohk, so adding the error macros or test utils might be causing it?</p>



<a name="433246904"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/433246904" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#433246904">(Apr 15 2024 at 09:53)</a>:</h4>
<p>Yeah, I expect one of them has cvt as a dependency</p>



<a name="433247165"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/433247165" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#433247165">(Apr 15 2024 at 09:55)</a>:</h4>
<div class="codehilite"><pre><span></span><code>[package]
name = &quot;roc_error_macros&quot;
description = &quot;Provides macros for consistent reporting of errors in Roc&#39;s rust code.&quot;

authors.workspace = true
edition.workspace = true
license.workspace = true
version.workspace = true

[dependencies]
</code></pre></div>
<div class="codehilite"><pre><span></span><code>[package]
name = &quot;roc_test_utils&quot;
description = &quot;Utility functions used all over the code base.&quot;

authors.workspace = true
edition.workspace = true
license.workspace = true
version.workspace = true

[dependencies]
pretty_assertions.workspace = true
remove_dir_all.workspace = true

[dev-dependencies]
</code></pre></div>



<a name="433247412"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/433247412" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#433247412">(Apr 15 2024 at 09:56)</a>:</h4>
<p>It may be further down the dependency tree, remove_dir_all probably does not make sense for wasm</p>



<a name="433247682"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/433247682" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#433247682">(Apr 15 2024 at 09:58)</a>:</h4>
<p>Yeah so it's definitely <code>remove_dir_all</code></p>
<div class="codehilite"><pre><span></span><code>[target.&#39;cfg(not(windows))&#39;.dependencies]
cvt = &quot;0.1.1&quot;
libc = &quot;0.2&quot;
</code></pre></div>



<a name="433247895"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/433247895" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#433247895">(Apr 15 2024 at 09:59)</a>:</h4>
<p>I can probably do without that macro if that would be the easiest solution</p>



<a name="433247940"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/433247940" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#433247940">(Apr 15 2024 at 09:59)</a>:</h4>
<p>Just compare strings normally. It's just to show pretty colors for the snapshots</p>



<a name="433248110"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/433248110" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#433248110">(Apr 15 2024 at 10:00)</a>:</h4>
<p>I'm just using this <code>`use roc_test_utils::assert_multiline_str_eq;</code></p>



<a name="433248454"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/433248454" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#433248454">(Apr 15 2024 at 10:02)</a>:</h4>
<p>We could also split some test_utils off into test_utils_no_wasm, there we can put all the dir stuff in.</p>



<a name="433254878"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/433254878" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#433254878">(Apr 15 2024 at 10:38)</a>:</h4>
<p>Merged the changes from <a href="https://github.com/roc-lang/roc/pull/6643">https://github.com/roc-lang/roc/pull/6643</a> and that fixes the issue above. <span aria-label="tada" class="emoji emoji-1f389" role="img" title="tada">:tada:</span></p>



<a name="434550008"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/434550008" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#434550008">(Apr 21 2024 at 01:53)</a>:</h4>
<p>It looks like glue has regressed somehow, or at least there is a bug in module imports which prevents us from generating the glue types for roc-wasm4.</p>
<div class="codehilite"><pre><span></span><code>$ roc glue ../roc/crates/glue/src/ZigGlue.roc platform/glue/ platform/main-glue.roc

── MODULE NOT IMPORTED in ../roc/crates/glue/src/../platform/Types.roc ─────────

The `TypeId` module is not imported:

37│          id = TypeId.fromU64 index
                  ^^^^^^^^^^^^^^

Did you mean to import it?
</code></pre></div>



<a name="434550128"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/434550128" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#434550128">(Apr 21 2024 at 01:55)</a>:</h4>
<p>I found a workaround by just copying the opaque type in directly.</p>



<a name="435095063"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/435095063" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#435095063">(Apr 24 2024 at 02:14)</a>:</h4>
<p>Just discovered that using <code>dbg</code> statements can mess with <code>!</code> suffixes... needs further investigation.</p>



<a name="435156021"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/435156021" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#435156021">(Apr 24 2024 at 10:10)</a>:</h4>
<p>Can you make an issue for that?</p>



<a name="435157127"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/435157127" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#435157127">(Apr 24 2024 at 10:18)</a>:</h4>
<p>Can do. I'll also fix it, hopefully soon</p>



<a name="435953972"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/435953972" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#435953972">(Apr 29 2024 at 04:45)</a>:</h4>
<p>Looking at timing of our compilation, almost all of the frontend time is spent in "Other". do we know what that is likely to be? Is it mono? Something else?</p>
<p>Ex:</p>
<div class="codehilite"><pre><span></span><code>            0.036 ms   Read .roc file from disk
            0.045 ms   Parse header
            0.147 ms   Parse body
            1.059 ms   Canonicalize
            0.000 ms   Constrain
            1.395 ms   Solve
            0.058 ms   Find Specializations
            1.337 ms   Make Specializations (Pass 0)
            0.170 ms   Make Specializations (Pass 1)
            0.030 ms   Make Specializations (Pass 2)
           15.413 ms   Other
</code></pre></div>



<a name="436146245"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/436146245" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ayaz Hafiz <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#436146245">(Apr 29 2024 at 21:50)</a>:</h4>
<p>make specializations is mono</p>



<a name="436146311"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/436146311" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ayaz Hafiz <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#436146311">(Apr 29 2024 at 21:50)</a>:</h4>
<p>might be coordination overhead, especially if there are multiple mono passes</p>



<a name="436147073"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/436147073" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#436147073">(Apr 29 2024 at 21:56)</a>:</h4>
<p>Even our basic <code>rocLovesZig</code> example where main is just a string spends most of the time in other across essentially all modules. Though I guess it is compiling all of the standard library.</p>
<div class="spoiler-block"><div class="spoiler-header">
<p>timings</p>
</div><div class="spoiler-content" aria-hidden="true">
<div class="codehilite"><pre><span></span><code>Here&#39;s how long each module took to compile:

    Bool
            0.000 ms   Read .roc file from disk
            0.000 ms   Parse header
            0.098 ms   Parse body
            0.144 ms   Canonicalize
            0.000 ms   Constrain
            0.020 ms   Solve
            0.013 ms   Find Specializations
            0.010 ms   Make Specializations
            1.003 ms   Other

            1.289 ms   Total

    #Derived_gen
            0.000 ms   Read .roc file from disk
            0.000 ms   Parse header
            0.000 ms   Parse body
            0.000 ms   Canonicalize
            0.000 ms   Constrain
            0.000 ms   Solve
            0.001 ms   Find Specializations
            0.005 ms   Make Specializations
            0.000 ms   Other

            0.000 ms   Total

    Str
            0.000 ms   Read .roc file from disk
            0.000 ms   Parse header
            0.580 ms   Parse body
            0.796 ms   Canonicalize
            0.000 ms   Constrain
            0.076 ms   Solve
            0.053 ms   Find Specializations
            0.023 ms   Make Specializations
            4.636 ms   Other

            6.164 ms   Total

    Dict
            0.000 ms   Read .roc file from disk
            0.000 ms   Parse header
            2.035 ms   Parse body
            3.452 ms   Canonicalize
            0.000 ms   Constrain
            0.247 ms   Solve
            0.226 ms   Find Specializations
            0.039 ms   Make Specializations
            4.616 ms   Other

           10.615 ms   Total

    List
            0.000 ms   Read .roc file from disk
            0.000 ms   Parse header
            1.550 ms   Parse body
            2.359 ms   Canonicalize
            0.000 ms   Constrain
            0.136 ms   Solve
            0.140 ms   Find Specializations
            0.030 ms   Make Specializations
            0.995 ms   Other

            5.209 ms   Total


            0.021 ms   Read .roc file from disk
            0.015 ms   Parse header
            0.503 ms   Parse body
            0.044 ms   Canonicalize
            0.000 ms   Constrain
            0.415 ms   Solve
            0.017 ms   Find Specializations
            0.068 ms   Make Specializations
           13.683 ms   Other

           14.766 ms   Total

    Num
            0.000 ms   Read .roc file from disk
            0.000 ms   Parse header
            0.605 ms   Parse body
            1.051 ms   Canonicalize
            0.000 ms   Constrain
            0.185 ms   Solve
            0.150 ms   Find Specializations
            0.042 ms   Make Specializations
            0.622 ms   Other

            2.656 ms   Total

    Result
            0.000 ms   Read .roc file from disk
            0.000 ms   Parse header
            0.087 ms   Parse body
            0.098 ms   Canonicalize
            0.000 ms   Constrain
            0.044 ms   Solve
            0.030 ms   Find Specializations
            0.006 ms   Make Specializations
            1.042 ms   Other

            1.306 ms   Total

    #UserApp
            0.036 ms   Read .roc file from disk
            0.028 ms   Parse header
            0.002 ms   Parse body
            0.044 ms   Canonicalize
            0.000 ms   Constrain
            0.516 ms   Solve
            0.005 ms   Find Specializations
            0.034 ms   Make Specializations
           13.651 ms   Other

           14.317 ms   Total

    Decode
            0.000 ms   Read .roc file from disk
            0.000 ms   Parse header
            0.130 ms   Parse body
            0.181 ms   Canonicalize
            0.000 ms   Constrain
            0.210 ms   Solve
            0.009 ms   Find Specializations
            0.006 ms   Make Specializations
            4.937 ms   Other

            5.475 ms   Total

    Inspect
            0.000 ms   Read .roc file from disk
            0.000 ms   Parse header
            0.454 ms   Parse body
            0.634 ms   Canonicalize
            0.000 ms   Constrain
            0.267 ms   Solve
            0.034 ms   Find Specializations
            0.017 ms   Make Specializations
            5.733 ms   Other

            7.139 ms   Total

    Box
            0.000 ms   Read .roc file from disk
            0.000 ms   Parse header
            0.039 ms   Parse body
            0.100 ms   Canonicalize
            0.000 ms   Constrain
            0.017 ms   Solve
            0.032 ms   Find Specializations
            0.011 ms   Make Specializations
            1.074 ms   Other

            1.273 ms   Total

    Encode
            0.000 ms   Read .roc file from disk
            0.000 ms   Parse header
            0.095 ms   Parse body
            0.261 ms   Canonicalize
            0.000 ms   Constrain
            0.178 ms   Solve
            0.010 ms   Find Specializations
            0.017 ms   Make Specializations
            2.596 ms   Other

            3.156 ms   Total

    Set
            0.000 ms   Read .roc file from disk
            0.000 ms   Parse header
            0.349 ms   Parse body
            0.539 ms   Canonicalize
            0.000 ms   Constrain
            0.185 ms   Solve
            0.037 ms   Find Specializations
            0.017 ms   Make Specializations
           10.311 ms   Other

           11.438 ms   Total

    Hash
            0.000 ms   Read .roc file from disk
            0.000 ms   Parse header
            0.133 ms   Parse body
            0.152 ms   Canonicalize
            0.000 ms   Constrain
            0.025 ms   Solve
            0.011 ms   Find Specializations
            0.012 ms   Make Specializations
            5.887 ms   Other

            6.219 ms   Total

 (note, total time ~20ms)
</code></pre></div>
</div></div>



<a name="436147703"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/436147703" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#436147703">(Apr 29 2024 at 22:01)</a>:</h4>
<p>Oh, I think I see.</p>
<p>We are measuring time spent waiting on dependencies as part of compiling a module<br>
List: 5.2ms<br>
Dict (which depends on list): 10.6ms with 4.6ms other<br>
Set (which depends on dict): 11.4ms with 10.3ms other</p>
<p>UserApp depends on everything else but is just a string and super trivial. So it has <code>14.317 ms</code> total and <code>13.651 ms</code> for other. I think the <code>13.651 ms</code> was waiting on all deps.</p>



<a name="436148950"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/436148950" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ayaz Hafiz <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#436148950">(Apr 29 2024 at 22:09)</a>:</h4>
<p>yeah that makes sense. the earlier phases cannot really be parallelized across the entire dependency graph, and even mono cannot really be, so the wall time for a single module is likely to be much higher than the actual work done for it</p>



<a name="436158839"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/436158839" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#436158839">(Apr 29 2024 at 23:19)</a>:</h4>
<p>It the process of updating roc-json to the latest basic-cli release I've discovered a strange compiler bug I think. Haven't tracked down what the issue is, but have been able to isolate it to the <code>package/Option.roc</code> module.</p>
<div class="codehilite"><pre><span></span><code>$ RUST_BACKTRACE=1 roc test package/Option.roc
thread &#39;main&#39; panicked at /Users/luke/.cargo/registry/src/index.crates.io-6f17d22bba15001f/bumpalo-3.14.0/src/lib.rs:1854:5:
out of memory
stack backtrace:
   0: rust_begin_unwind
             at /rustc/cc66ad468955717ab92600c770da8c1601a4ff33/library/std/src/panicking.rs:595:5
   1: core::panicking::panic_fmt
             at /rustc/cc66ad468955717ab92600c770da8c1601a4ff33/library/core/src/panicking.rs:67:14
   2: bumpalo::oom
   3: roc_repl_eval::eval::addr_to_ast
   4: roc_repl_eval::eval::struct_to_ast
   5: roc_repl_expect::get_values
   6: roc_repl_expect::run::render_expect_failure
   7: roc_cli::test
   8: roc::main
note: Some details are omitted, run with `RUST_BACKTRACE=full` for a verbose backtrace.
</code></pre></div>



<a name="436159061"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/436159061" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#436159061">(Apr 29 2024 at 23:21)</a>:</h4>
<p>It's only the last two <code>expect</code>s in that file that have this issue.</p>



<a name="436253264"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/436253264" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#436253264">(Apr 30 2024 at 11:49)</a>:</h4>
<p>Is there any particular reason we use a <code>host.c</code> in basic-cli and build that using clang, and then link using ld to get a prebuilt binary when "rebuilding platform"? Im wondering if I could replace this with another crate to produce the static library using just cargo?</p>



<a name="436253491"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/436253491" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#436253491">(Apr 30 2024 at 11:50)</a>:</h4>
<p>In the (near) future I'm hoping to remove this rebuilding platform from the cli, and so the platform needs to producs the prebuilt binary / static library itself.</p>



<a name="436254190"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/436254190" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#436254190">(Apr 30 2024 at 11:54)</a>:</h4>
<p>yeah context is here: <a href="https://users.rust-lang.org/t/error-when-compiling-linking-with-o-files/49635/5">https://users.rust-lang.org/t/error-when-compiling-linking-with-o-files/49635/5</a></p>



<a name="436254575"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/436254575" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#436254575">(Apr 30 2024 at 11:57)</a>:</h4>
<p>basically host.c is a workaround way to get a .o executable out of Rust, because apparently there's no way to convince pure rust to compile an executable into a .o file</p>



<a name="436254692"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/436254692" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#436254692">(Apr 30 2024 at 11:57)</a>:</h4>
<p>or at least that's the only way we were able to figure out how to do it in that forum <span aria-label="sweat smile" class="emoji emoji-1f605" role="img" title="sweat smile">:sweat_smile:</span></p>



<a name="436321918"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/436321918" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#436321918">(Apr 30 2024 at 17:28)</a>:</h4>
<p>Ok nice, thats good to know. Though we've since added support for using archives <code>.a</code> and cargo happily produces them with staticlib crates, so we could do it all with cargo now I think.</p>



<a name="436322345"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/436322345" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#436322345">(Apr 30 2024 at 17:31)</a>:</h4>
<p>IIRC, the problem isn't producing a <code>.a/o</code> it's that the <code>.a/o</code> needs to contain everything to generate the executable. I don't think cargo is willing to put a <code>main</code> function in a <code>.a</code>.</p>
<p>But please double check.</p>



<a name="436323167"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/436323167" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#436323167">(Apr 30 2024 at 17:36)</a>:</h4>
<p>It is, here's an exMple <a href="https://github.com/lukewilliamboswell/basic-ssg/blob/8a11665efa2074b65a71a966d3ecde8d30b9ba9a/crates/host/src/lib.rs#L127">https://github.com/lukewilliamboswell/basic-ssg/blob/8a11665efa2074b65a71a966d3ecde8d30b9ba9a/crates/host/src/lib.rs#L127</a></p>
<p>Though the issue then is using that library in a bin crate that also has a main, in which case there is duplicate symbols called main. </p>
<p>I'm not suggesting the way Its currently written in basic-ssg is the right way, because I think that was a mistake. But I think it's possible. So I am thinking we might be able to have another crate that depends on the core library and just adds a main fn, similar to how its done in <a href="http://main.rs">main.rs</a></p>



<a name="436460056"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/436460056" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#436460056">(May 01 2024 at 07:01)</a>:</h4>
<p>I'm working on <a href="https://github.com/roc-lang/roc/issues/6414">https://github.com/roc-lang/roc/issues/6414</a>, and have removed the platform rebuilding from roc. </p>
<p>I would like to clarify the best approach for dealing with our internal tests. </p>
<p>One approach I can think of is to include a script alongside each platform called <code>build.roc</code> and when we run any of the tests, we first run this script which is responsible for rebuilding the host. </p>
<p>For most platforms, this is as simple as running <code>zig build-lib -lc host.c</code> to produce a c-archive and then running <code>mv libhost.a macos-arm64.a</code> to rename it for the current architecture.</p>
<p>This removes a significant amount of host rebuilding logic from the compiler.</p>
<p>Alternatively we could leave the current rebuilding host functionality, and rewire it so that it is called before running a test to ensure we have the prebuilt binaries available.</p>



<a name="436461427"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/436461427" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#436461427">(May 01 2024 at 07:18)</a>:</h4>
<p>This is the WIP PR <a href="https://github.com/roc-lang/roc/pull/6696">https://github.com/roc-lang/roc/pull/6696</a></p>



<a name="436490850"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/436490850" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#436490850">(May 01 2024 at 12:23)</a>:</h4>
<p><span class="user-mention silent" data-user-id="515757">Luke Boswell</span> <a href="#narrow/stream/395097-compiler-development/topic/Casual.20Conversation/near/436460056">said</a>:</p>
<blockquote>
<p>One approach I can think of is to include a script alongside each platform called <code>build.roc</code> and when we run any of the tests, we first run this script which is responsible for rebuilding the host. </p>
</blockquote>
<p>I think if the tests are in Rust it'll be best if we keep that logic in Rust, as like a test helper function</p>



<a name="436490965"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/436490965" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#436490965">(May 01 2024 at 12:24)</a>:</h4>
<p>otherwise we get into situations like "the actual problem was that the .roc file to build the test's platform didn't run because <em>that</em> .roc file's platform was broken because of an in-progress change to the current compiler code base..."</p>



<a name="436550343"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/436550343" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#436550343">(May 01 2024 at 18:21)</a>:</h4>
<p>No I think this is just for the cli tests where we have a platform and app.</p>



<a name="436550674"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/436550674" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#436550674">(May 01 2024 at 18:23)</a>:</h4>
<p>Where we currently build the host anyway, except the logic to do that is in the compiler.</p>
<p>I think we could remove all of that logic from the compiler.</p>



<a name="436554373"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/436554373" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#436554373">(May 01 2024 at 18:49)</a>:</h4>
<p>Yeah, this is planned, but never completed: <a href="https://github.com/roc-lang/roc/issues/6037">https://github.com/roc-lang/roc/issues/6037</a></p>



<a name="436561327"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/436561327" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#436561327">(May 01 2024 at 19:41)</a>:</h4>
<p>Ahk, thank you Brendan. I'll carry on.</p>



<a name="436562256"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/436562256" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#436562256">(May 01 2024 at 19:48)</a>:</h4>
<p>I have no major thought on if the build script should be in roc vs in whatever the native language would use. I guess I prefer native language if possible so the platforms feel more familiar to people who use the host language. That said, a lot of the platforms are super tiny and some languages like c/c++ don't have clear build tooling. Also can't just use a bash script due to eventually needing to support Windows. So that pushes for <code>build.roc</code> for simple consistency.</p>



<a name="436564953"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/436564953" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#436564953">(May 01 2024 at 20:08)</a>:</h4>
<p>do you mean in tests in the roc-lang/roc repo specifically? Or for other projects?</p>



<a name="436564978"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/436564978" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#436564978">(May 01 2024 at 20:08)</a>:</h4>
<p>personally I have no preference on what other projects want to use (if they want to use build.roc, great!)</p>



<a name="436564980"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/436564980" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#436564980">(May 01 2024 at 20:08)</a>:</h4>
<p>Roc repo specifically</p>



<a name="436564991"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/436564991" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#436564991">(May 01 2024 at 20:08)</a>:</h4>
<p>Other projects can do whatever they want</p>



<a name="436565032"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/436565032" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#436565032">(May 01 2024 at 20:08)</a>:</h4>
<p>I guess I should also be more granular, come to think of it</p>



<a name="436565054"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/436565054" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#436565054">(May 01 2024 at 20:08)</a>:</h4>
<p>I think it's also fine in roc-lang/roc's examples/ folder</p>



<a name="436565063"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/436565063" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#436565063">(May 01 2024 at 20:09)</a>:</h4>
<p>to use build.roc</p>



<a name="436565173"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/436565173" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#436565173">(May 01 2024 at 20:09)</a>:</h4>
<p>actually I guess it's probably fine to try out build.roc in the roc-lang/roc tests too and see if it's a problem in practice</p>



<a name="436565180"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/436565180" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#436565180">(May 01 2024 at 20:09)</a>:</h4>
<p>Fundamentally, roc no longer builds the host. It is up to the host to decide how it will get built. Roc will essentially run as if <code>--prebuilt-playform</code> is always true.</p>



<a name="436565195"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/436565195" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#436565195">(May 01 2024 at 20:09)</a>:</h4>
<p>we can always change to something else if it's not working out well</p>



<a name="436565379"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/436565379" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#436565379">(May 01 2024 at 20:11)</a>:</h4>
<p>Also, thinking about this more, I think I actually like forcing everything to be <code>build.roc</code>. Then I don't need to figure out the build script/command. always just <code>roc build.roc</code></p>



<a name="436565427"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/436565427" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#436565427">(May 01 2024 at 20:11)</a>:</h4>
<p>For the roc examples specifically</p>



<a name="436589888"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/436589888" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#436589888">(May 01 2024 at 23:32)</a>:</h4>
<p>For the changes I'm working on to remove the platform rebuilding... I've hit a problem now where I need glue gen to build the platforms, but to gen glue I need to be able to build platforms. It's a vicious cycle. </p>
<p>So I think the best approach is to make a release of the glue platform just like any other platform. We could a URL for the glue platform in the GH releases.  </p>
<p>TBH I've been thinking about this for other reasons anyway. Currently whenever I use glue elsewhere I have to have roc repository cloned locally to reference the platform which isn't ideal.</p>



<a name="436590978"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/436590978" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#436590978">(May 01 2024 at 23:43)</a>:</h4>
<p>seems reasonable to me! <span aria-label="thumbs up" class="emoji emoji-1f44d" role="img" title="thumbs up">:thumbs_up:</span></p>



<a name="436624532"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/436624532" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#436624532">(May 02 2024 at 06:26)</a>:</h4>
<p>I hadn't  realised how big of a change this is. I apologise in advance for how large this PR is going to be. I'm trying to keep it reasonable, but I'm also trying to clean things up as I go and leave it in a better state.</p>



<a name="436624636"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/436624636" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#436624636">(May 02 2024 at 06:27)</a>:</h4>
<p>For example, I've had to touch all of the roc_cli tests and update the platform implementations</p>



<a name="436668222"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/436668222" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#436668222">(May 02 2024 at 11:06)</a>:</h4>
<p>no worries!</p>



<a name="436844866"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/436844866" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#436844866">(May 03 2024 at 09:08)</a>:</h4>
<p>Does file ingesting work with the new syntax?</p>



<a name="436845060"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/436845060" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#436845060">(May 03 2024 at 09:10)</a>:</h4>
<p>I'll log an issue because I think it's broken</p>



<a name="436847470"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/436847470" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#436847470">(May 03 2024 at 09:27)</a>:</h4>
<p><a href="https://github.com/roc-lang/roc/issues/6710">https://github.com/roc-lang/roc/issues/6710</a></p>



<a name="436848100"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/436848100" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#436848100">(May 03 2024 at 09:31)</a>:</h4>
<p>In the space of about 15-30mins I was able to update <strong>roc-json</strong>, <strong>roc-parser</strong>, <strong>roc-ansi</strong>, and <strong>roc-random</strong> to use the new syntax. Super quick and painless upgrade. Thank you <span class="user-mention" data-user-id="489294">@Agus Zubiaga</span> for putting the effort in to make that possible.</p>



<a name="436848883"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/436848883" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> JRI98 <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#436848883">(May 03 2024 at 09:37)</a>:</h4>
<p>According to <a href="https://github.com/roc-lang/roc/pull/6658#issue-2255059371">https://github.com/roc-lang/roc/pull/6658#issue-2255059371</a>, file ingestion should look like <code>import "data.json" as data : List U8</code></p>



<a name="436849093"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/436849093" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#436849093">(May 03 2024 at 09:38)</a>:</h4>
<p>Oh neat, just missing the type annotation causes that issue then.</p>



<a name="436849108"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/436849108" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#436849108">(May 03 2024 at 09:38)</a>:</h4>
<p>I'll update the issue</p>



<a name="436859632"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/436859632" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Agus Zubiaga <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#436859632">(May 03 2024 at 10:50)</a>:</h4>
<p>Ah, interesting. Wasn’t the annotation already mandatory in the old syntax? I guess we can make it optional and have it behave as if you wrote:</p>
<div class="codehilite"><pre><span></span><code>import &quot;data.json&quot; as data : _
</code></pre></div>



<a name="436860351"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/436860351" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Agus Zubiaga <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#436860351">(May 03 2024 at 10:55)</a>:</h4>
<p>I agree we should have a nicer error message if we don’t, though</p>



<a name="436860490"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/436860490" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#436860490">(May 03 2024 at 10:56)</a>:</h4>
<p><span class="user-mention silent" data-user-id="489294">Agus Zubiaga</span> <a href="#narrow/stream/395097-compiler-development/topic/casual.20conversation/near/436859632">said</a>:</p>
<blockquote>
<p>Ah, interesting. Wasn’t the annotation already mandatory in the old syntax? I guess we can make it optional and have it behave as if you wrote:</p>
<p><div class="codehilite"><pre><span></span><code>import &quot;data.json&quot; as data : _
</code></pre></div><br>
</p>
</blockquote>
<p>I think that's what we should do, yeah!</p>



<a name="436860512"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/436860512" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#436860512">(May 03 2024 at 10:56)</a>:</h4>
<p>I like the type annotation being optional here, because type annotations are optional for all other values <span aria-label="big smile" class="emoji emoji-1f604" role="img" title="big smile">:big_smile:</span></p>



<a name="437157183"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/437157183" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Agus Zubiaga <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#437157183">(May 05 2024 at 19:33)</a>:</h4>
<p>Hm, this is not as easy as I thought. The way solve <a href="https://github.com/roc-lang/roc/blob/bbb54b4cc9e2ff34409b64ffc913346a013bf2b4/crates/compiler/solve/src/solve.rs#L1333">works</a> for ingested files means that:</p>
<div class="codehilite"><pre><span></span><code>import &quot;data.json&quot; as data : _
</code></pre></div>
<p>is effectively the same as:</p>
<div class="codehilite"><pre><span></span><code>import &quot;data.json&quot; as data : List U8
</code></pre></div>
<p>Instead, I think we want <code>data</code> to be inferred as <code>Str</code> or <code>List U8</code> from usage.</p>



<a name="437157659"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/437157659" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#437157659">(May 05 2024 at 19:41)</a>:</h4>
<p>agreed!</p>



<a name="437157674"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/437157674" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#437157674">(May 05 2024 at 19:41)</a>:</h4>
<p>and then give a compile error if it infers to neither of those</p>



<a name="437157694"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/437157694" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#437157694">(May 05 2024 at 19:42)</a>:</h4>
<p>would you like help doing that?</p>



<a name="437157769"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/437157769" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Agus Zubiaga <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#437157769">(May 05 2024 at 19:42)</a>:</h4>
<p>Yeah, I'll probably need some because I don't have any experience in this part of the compiler.</p>



<a name="437157792"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/437157792" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#437157792">(May 05 2024 at 19:43)</a>:</h4>
<p>ok cool</p>



<a name="437157799"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/437157799" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#437157799">(May 05 2024 at 19:43)</a>:</h4>
<p>I'd say we should do it in 2 parts then</p>



<a name="437157813"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/437157813" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#437157813">(May 05 2024 at 19:43)</a>:</h4>
<p>like make one PR to enable the functionality if you write out the annotation</p>



<a name="437157819"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/437157819" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#437157819">(May 05 2024 at 19:43)</a>:</h4>
<p>and then we can do the inference separately</p>



<a name="437157852"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/437157852" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#437157852">(May 05 2024 at 19:43)</a>:</h4>
<p>I'd like to use this feature in the live coding on Tuesday <span aria-label="grinning face with smiling eyes" class="emoji emoji-1f601" role="img" title="grinning face with smiling eyes">:grinning_face_with_smiling_eyes:</span></p>



<a name="437157921"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/437157921" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#437157921">(May 05 2024 at 19:44)</a>:</h4>
<p>(even if it doesn't do inference yet)</p>



<a name="437157929"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/437157929" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Agus Zubiaga <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#437157929">(May 05 2024 at 19:44)</a>:</h4>
<p>Cool! I'll make a PR with the first part today.</p>



<a name="437157958"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/437157958" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Agus Zubiaga <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#437157958">(May 05 2024 at 19:45)</a>:</h4>
<p>If it's ok, I'd like to continue working on params before shifting focus to the inference part</p>



<a name="437157980"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/437157980" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Agus Zubiaga <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#437157980">(May 05 2024 at 19:45)</a>:</h4>
<p>unless you think it's gonna be really easy</p>



<a name="437158079"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/437158079" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#437158079">(May 05 2024 at 19:46)</a>:</h4>
<p>it might be easy but might also have surprises haha</p>



<a name="437158088"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/437158088" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#437158088">(May 05 2024 at 19:46)</a>:</h4>
<p>so leaving it for later seems fine!</p>



<a name="437158417"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/437158417" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Agus Zubiaga <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#437158417">(May 05 2024 at 19:49)</a>:</h4>
<p>Made an <a href="https://github.com/roc-lang/roc/issues/6716">issue</a> for the second part</p>



<a name="437159635"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/437159635" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Agus Zubiaga <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#437159635">(May 05 2024 at 20:06)</a>:</h4>
<p>Here's the PR for the first part: <a href="https://github.com/roc-lang/roc/pull/6717">https://github.com/roc-lang/roc/pull/6717</a></p>



<a name="437159657"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/437159657" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Agus Zubiaga <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#437159657">(May 05 2024 at 20:07)</a>:</h4>
<p>Separately, I am also going to improve the parsing error messages for imports</p>



<a name="438201491"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/438201491" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#438201491">(May 12 2024 at 18:03)</a>:</h4>
<p><span class="user-mention" data-user-id="361169">@Anton</span> do the CI machines have roc on their PATH?</p>



<a name="438221615"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/438221615" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ayaz Hafiz <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#438221615">(May 13 2024 at 00:03)</a>:</h4>
<p>I think we should make a repository called "rfcs" or something similar to keep design documents of the sort typically shared in ideas. I used to do it in Notion, and I know Richard sometimes does them in Google Docs, but for me at least writing in google docs is quite laborious. It would also be good to centralize this. Any thoughts?</p>



<a name="438225813"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/438225813" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#438225813">(May 13 2024 at 01:16)</a>:</h4>
<p>yeah I totally agree! Someone talked about this at some point in the past but I don't know how much progress was actually made on it <span aria-label="sweat smile" class="emoji emoji-1f605" role="img" title="sweat smile">:sweat_smile:</span></p>



<a name="438226025"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/438226025" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ayaz Hafiz <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#438226025">(May 13 2024 at 01:20)</a>:</h4>
<p>i’m just gonna make it</p>



<a name="438300450"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/438300450" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#438300450">(May 13 2024 at 08:12)</a>:</h4>
<blockquote>
<p><span class="user-mention silent" data-user-id="361169">Anton</span> do the CI machines have roc on their PATH?</p>
</blockquote>
<p>No, I expect that would lead to tricky bugs with unexpected different versions</p>



<a name="438312448"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/438312448" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#438312448">(May 13 2024 at 09:13)</a>:</h4>
<p>Ok, well I've been converting the platforms to build using roc as the scripting language. Maybe we should use bash instead then? I think Roc is nicer for the scripting, and will be even better soon with builtin Task and we can move a bunch of duplicate logic into a package.</p>



<a name="438313695"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/438313695" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#438313695">(May 13 2024 at 09:19)</a>:</h4>
<p>I don't see how bash fixes anything</p>



<a name="438313765"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/438313765" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#438313765">(May 13 2024 at 09:20)</a>:</h4>
<p>We could build the compiler first and add roc to the path at the start of the CI workflow</p>



<a name="438313828"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/438313828" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#438313828">(May 13 2024 at 09:20)</a>:</h4>
<p>Don't you require calling roc to proprecess platforms and what not</p>



<a name="438313913"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/438313913" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#438313913">(May 13 2024 at 09:20)</a>:</h4>
<p>So even if you don't do <code>roc build.roc</code>, you still have a call to roc in the equivalent <code>build.sh</code> script</p>



<a name="438313955"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/438313955" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#438313955">(May 13 2024 at 09:20)</a>:</h4>
<p>So either way, the user has to build roc and add it to the path (or make it otherwise accessible)</p>



<a name="438314037"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/438314037" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#438314037">(May 13 2024 at 09:21)</a>:</h4>
<blockquote>
<p>We could build the compiler first and add roc to the path at the start of the CI workflow</p>
</blockquote>
<p>Yeah, I think we should do that for the e2e tests.</p>



<a name="438317548"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/438317548" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#438317548">(May 13 2024 at 09:39)</a>:</h4>
<p>Well the current approach is that each test will rebuild the platform when running the example. So it doesn't really use roc as a separate fork or child process or anything.</p>



<a name="438317627"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/438317627" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#438317627">(May 13 2024 at 09:39)</a>:</h4>
<p><span class="user-mention silent" data-user-id="361169">Anton</span> <a href="#narrow/stream/395097-compiler-development/topic/casual.20conversation/near/438313765">said</a>:</p>
<blockquote>
<p>We could build the compiler first and add roc to the path at the start of the CI workflow</p>
</blockquote>
<p>I'll have a crack at doing that.</p>



<a name="439622868"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/439622868" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#439622868">(May 20 2024 at 17:49)</a>:</h4>
<p>it's really cool how many people in <a class="stream" data-stream-id="231634" href="/#narrow/stream/231634-beginners">#beginners</a> are looking to make their own platforms <span aria-label="smiley" class="emoji emoji-1f603" role="img" title="smiley">:smiley:</span></p>



<a name="439623675"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/439623675" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#439623675">(May 20 2024 at 17:54)</a>:</h4>
<p>Yeah, I think it's kind of a novel spark that creates opportunities</p>



<a name="440711433"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/440711433" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#440711433">(May 26 2024 at 12:51)</a>:</h4>
<p>really interesting article about summing floats: <a href="https://orlp.net/blog/taming-float-sums/">https://orlp.net/blog/taming-float-sums/</a></p>



<a name="440714741"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/440714741" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#440714741">(May 26 2024 at 13:50)</a>:</h4>
<p>Oh, I have a fun tidbit with floating point summation.</p>
<p>Floating point sum reductions (same thing as the summation) happen in machine learning quite often. In a neutral net that I was debugging, I noticed that one ml framework had significantly less accurate results for the neural net as a whole. After digging into the network, I realized that the results deviated the most when reaching a reduction. I originally assumed the framework was cutting corners in reduction in the name of performance. It wasn't. Turns out that the framework actually had the most accurate floating point reductions. So a more numerically accurate floating point reduction made the neural network as a whole noticeably less accurate. Why? The neural net was trained with a less accurate reduction and had optimized the weights for a less accurate reduction.</p>



<a name="440727666"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/440727666" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#440727666">(May 26 2024 at 17:25)</a>:</h4>
<p>I wonder if we should make <code>List.sum</code> do some of this</p>



<a name="440730500"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/440730500" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#440730500">(May 26 2024 at 18:16)</a>:</h4>
<p>Definitely could. Though if floats are for speed, I don't think we should really care about summation accuracy. If anything, I would argue for dumb simd and more speed instead of accuracy.</p>



<a name="440733876"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/440733876" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#440733876">(May 26 2024 at 19:20)</a>:</h4>
<p>yeah I was thinking the same <span aria-label="thumbs up" class="emoji emoji-1f44d" role="img" title="thumbs up">:thumbs_up:</span></p>



<a name="442138106"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/442138106" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#442138106">(Jun 03 2024 at 03:11)</a>:</h4>
<p>On <a href="https://github.com/lukewilliamboswell/roc-htmx-playground/commit/efd9fc125f52b62820173ba26621b20519f1050c">this commit in roc-htmx-playground</a></p>
<p>I got the following... 30 seconds to build on my M2 macbook</p>
<div class="codehilite" data-code-language="Bash"><pre><span></span><code><span class="w">    </span>Code<span class="w"> </span>Generation
<span class="w">         </span><span class="m">5737</span>.190<span class="w"> </span>ms<span class="w">   </span>Generate<span class="w"> </span>final<span class="w"> </span>IR<span class="w"> </span>from<span class="w"> </span>Mono<span class="w"> </span>IR
<span class="w">        </span><span class="m">16199</span>.271<span class="w"> </span>ms<span class="w">   </span>Generate<span class="w"> </span>object

<span class="w">        </span><span class="m">21936</span>.461<span class="w"> </span>ms<span class="w">   </span>Total

Finished<span class="w"> </span>compilation<span class="w"> </span>and<span class="w"> </span>code<span class="w"> </span>gen<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="m">28207</span><span class="w"> </span>ms

Produced<span class="w"> </span>a<span class="w"> </span>app.o<span class="w"> </span>file<span class="w"> </span>of<span class="w"> </span>size<span class="w"> </span><span class="m">999952</span>

Finished<span class="w"> </span>linking<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="m">1115</span><span class="w"> </span>ms

<span class="m">0</span><span class="w"> </span>errors<span class="w"> </span>and<span class="w"> </span><span class="m">13</span><span class="w"> </span>warnings<span class="w"> </span>found<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="m">29325</span><span class="w"> </span>ms
</code></pre></div>



<a name="442140562"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/442140562" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#442140562">(Jun 03 2024 at 03:39)</a>:</h4>
<p>And <a href="https://github.com/lukewilliamboswell/roc-htmx-playground/commit/9c719f33c556787ce6d17b5375c44be9772582a3">this commit </a> is even slower and now has a runtime crash...</p>
<div class="codehilite"><pre><span></span><code>thread &#39;tokio-runtime-worker&#39; panicked at &#39;The Roc app crashed with: Erroneous: Expr::Call&#39;, src/lib.rs:46:5
note: run with `RUST_BACKTRACE=1` environment variable to display a backtrace
</code></pre></div>
<div class="codehilite"><pre><span></span><code>    Code Generation
        13051.603 ms   Generate final IR from Mono IR
        35184.772 ms   Generate object

        48236.376 ms   Total

Finished compilation and code gen in 66731 ms

Produced a app.o file of size 965568

Finished linking in 4643 ms

0 errors and 13 warnings found in 71376 ms
</code></pre></div>



<a name="442140724"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/442140724" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#442140724">(Jun 03 2024 at 03:41)</a>:</h4>
<p>These aren't optimised builds...  just running with <code>$ DB_PATH=test.db roc --time src/main.roc</code></p>



<a name="442144765"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/442144765" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#442144765">(Jun 03 2024 at 04:32)</a>:</h4>
<p>Trying to figure out what's causing this... I think I'm going backwards <span aria-label="sweat smile" class="emoji emoji-1f605" role="img" title="sweat smile">:sweat_smile:</span> <br>
<code>0 errors and 6 warnings found in 179487 ms</code> &lt;-- 180 seconds</p>



<a name="442150281"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/442150281" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#442150281">(Jun 03 2024 at 05:17)</a>:</h4>
<p>Looks to be mac specific. With my (tiny) linux server <br>
<code>0 errors and 6 warnings found in 3671 ms</code></p>



<a name="442201415"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/442201415" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#442201415">(Jun 03 2024 at 09:43)</a>:</h4>
<p>Ok, so I've now got it working normally <code>0 errors and 6 warnings found in 2853 ms</code></p>
<p>I've got no idea what was causing that. </p>
<p>I cleaned basically every cache I could find. Upgraded my MacOS version, updated all the packages I could find, and rebuilt roc and roc_ls from latest main using nix.</p>



<a name="442306280"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/442306280" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#442306280">(Jun 03 2024 at 16:30)</a>:</h4>
<p>wow super weird</p>



<a name="442381541"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/442381541" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#442381541">(Jun 03 2024 at 21:56)</a>:</h4>
<p>Yeah, I was a little worried for a bit. I suspect I had done something strange like built roc from a branch somewhere or there was some combination of things in caches. Glad it's back to normal.</p>



<a name="442410312"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/442410312" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#442410312">(Jun 04 2024 at 01:09)</a>:</h4>
<p>Actually, I think it's still a problem. It's like every time I compile my app it gets a bit slower, and slower to build.</p>



<a name="442417158"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/442417158" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#442417158">(Jun 04 2024 at 02:01)</a>:</h4>
<p>hm, what's really odd about that is that we don't currently store anything on disk during builds</p>



<a name="442417208"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/442417208" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#442417208">(Jun 04 2024 at 02:01)</a>:</h4>
<p>well, I guess there are changes in between these builds, right?</p>



<a name="442417658"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/442417658" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#442417658">(Jun 04 2024 at 02:03)</a>:</h4>
<p>Yes.</p>



<a name="442417941"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/442417941" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#442417941">(Jun 04 2024 at 02:05)</a>:</h4>
<p>Any cache's in particular I should experiment with?</p>



<a name="442417993"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/442417993" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#442417993">(Jun 04 2024 at 02:06)</a>:</h4>
<p>so it's possible that it's something pathological about the source code itself</p>



<a name="442418019"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/442418019" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#442418019">(Jun 04 2024 at 02:06)</a>:</h4>
<p>like it might not be related to the state of the computer itself</p>



<a name="442418075"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/442418075" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#442418075">(Jun 04 2024 at 02:06)</a>:</h4>
<p>since we've seen (and fixed) pathological cases in the past</p>



<a name="442418318"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/442418318" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#442418318">(Jun 04 2024 at 02:08)</a>:</h4>
<p>I definitely "fixed" it when I rebuilt everything, and it was fine on my linux server. I'll keep playing with it and see if I can find any correlations between things.</p>



<a name="442418494"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/442418494" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#442418494">(Jun 04 2024 at 02:09)</a>:</h4>
<p>I am doing a lot with Tasks in basic-webserver, so it could be something related to nesting those maybe.</p>



<a name="442421504"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/442421504" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#442421504">(Jun 04 2024 at 02:32)</a>:</h4>
<p>I think I know what the issue might be. The language server looks to be hogging all the CPU</p>



<a name="442421624"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/442421624" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#442421624">(Jun 04 2024 at 02:33)</a>:</h4>
<p>If I turn it off I'm back down to a more normal <code>0 errors and 0 warnings found in 18753 ms</code></p>



<a name="442425027"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/442425027" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#442425027">(Jun 04 2024 at 03:00)</a>:</h4>
<p>yikes, that's still a ton of time though!</p>



<a name="442425038"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/442425038" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#442425038">(Jun 04 2024 at 03:00)</a>:</h4>
<p>that's for <code>roc check</code>?</p>



<a name="442425732"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/442425732" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#442425732">(Jun 04 2024 at 03:05)</a>:</h4>
<p>That's roc build. Check is sitting around 1800 ms</p>



<a name="442471546"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/442471546" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#442471546">(Jun 04 2024 at 08:27)</a>:</h4>
<p>someone is having some more ambitious ideas about rust compiler performance, finally <a href="https://docs.google.com/document/d/1pE3UV-LUQnZyJCjcL6Kl5RBlj7VVk1Q3EXQmvn43w0I/edit">https://docs.google.com/document/d/1pE3UV-LUQnZyJCjcL6Kl5RBlj7VVk1Q3EXQmvn43w0I/edit</a></p>
<p>a Software Unscripted episode with matklad is one of the references</p>



<a name="443149844"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/443149844" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#443149844">(Jun 06 2024 at 20:02)</a>:</h4>
<p>I haven't actually listen to this yet, but I was told it is good and plan to listen later. Thought it would be a good share: <a href="https://learn.microsoft.com/en-us/shows/Seth-Juarez/Anders-Hejlsberg-on-Modern-Compiler-Construction">https://learn.microsoft.com/en-us/shows/Seth-Juarez/Anders-Hejlsberg-on-Modern-Compiler-Construction</a></p>



<a name="443206135"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/443206135" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#443206135">(Jun 07 2024 at 04:10)</a>:</h4>
<p>Two other interesting reads. Mojo is testing new areas related to simple ownership (or at least more automatic and less explicit)</p>
<ul>
<li><a href="https://www.modular.com/blog/what-ownership-is-really-about-a-mental-model-approach">https://www.modular.com/blog/what-ownership-is-really-about-a-mental-model-approach</a></li>
<li><a href="https://www.modular.com/blog/deep-dive-into-ownership-in-mojo">https://www.modular.com/blog/deep-dive-into-ownership-in-mojo</a></li>
</ul>



<a name="443243403"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/443243403" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#443243403">(Jun 07 2024 at 08:46)</a>:</h4>
<p>Found a new class of bug I think <code>Roc app crashed with: voided tag constructor is unreachable</code> <a href="https://github.com/lukewilliamboswell/roc-htmx-playground/commit/a0852625d36152ce37f8b0490a48c2359177931d">commit</a></p>



<a name="447812778"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/447812778" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#447812778">(Jun 28 2024 at 16:15)</a>:</h4>
<p>I think i have a functional (but ugly) implementation of borrow inference that seems to pass all of our tests <a href="https://github.com/roc-lang/roc/pull/6849">https://github.com/roc-lang/roc/pull/6849</a></p>
<p>that needs some cleanups, but hopefully this'll fix a bunch of performance problems</p>



<a name="448105037"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/448105037" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#448105037">(Jun 30 2024 at 11:12)</a>:</h4>
<p>I've been helping <span class="user-mention" data-user-id="461444">@Sam Mohr</span> with the builtin-task changes. </p>
<p>We were experiencing some hard to track down bugs on basic-cli... which we suspect are from rust glue generated code in <code>roc_app</code>. </p>
<p>So we used a PR on <a href="https://github.com/lukewilliamboswell/roc-platform-template-zig/pull/3">roc-platform-template-zig</a> to test the implementation instead. It looks like task as builtin is good to go. <span aria-label="tada" class="emoji emoji-1f389" role="img" title="tada">:tada:</span> </p>
<p>We had issues not that long ago with the glue types in basic-cli when implementing the API changes just before SYCL. I had removed a lot of them around that time. </p>
<p>Sam and I have been working on removing the remaining few glue types in <a href="https://github.com/roc-lang/basic-cli/pull/221">#221</a> and replacing these with roc_std or hand rolled rust types. This should eliminate this as a significant variable for debugging, and hopefully even eliminate the bug and unlock builtin task.</p>



<a name="448108996"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/448108996" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#448108996">(Jun 30 2024 at 12:01)</a>:</h4>
<p>amazing!!!</p>



<a name="448109291"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/448109291" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#448109291">(Jun 30 2024 at 12:04)</a>:</h4>
<p>It turns out that Tasks aren't super hard to implement because there's nothing going on under the hood, really, it's just a lambda returns a result. They just happen to work <em>very well</em> as a contract for IO management, which we can enforce for free using opaque types!</p>



<a name="448223501"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/448223501" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#448223501">(Jul 01 2024 at 05:13)</a>:</h4>
<p>I've been upgrading platforms for Task as a builtin... and just couldn't wait to test out <strong>platform independent packages</strong> (even though we don't quite have module params yet). </p>
<p>They work <span aria-label="tada" class="emoji emoji-1f389" role="img" title="tada">:tada:</span> and it's super <span aria-label="cool" class="emoji emoji-1f192" role="img" title="cool">:cool:</span>  </p>
<div class="codehilite" data-code-language="Elm"><pre><span></span><code><span class="err">#</span><span class="w"> </span><span class="nf">/</span><span class="nv">package</span><span class="nf">/</span><span class="nv">main</span><span class="nf">.</span><span class="nv">roc</span>
<span class="nv">package</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="kt">ReversePrint</span>
<span class="p">]</span><span class="w"> </span><span class="p">{}</span>
</code></pre></div>
<div class="codehilite" data-code-language="Elm"><pre><span></span><code><span class="err">#</span><span class="w"> </span><span class="nf">/</span><span class="nv">package</span><span class="nf">/</span><span class="kt">ReversePrint</span><span class="nf">.</span><span class="nv">roc</span>
<span class="kn">module</span><span class="w"> </span><span class="err">[</span><span class="nc">line</span><span class="p">]</span>

<span class="nv">line</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Str</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">Str</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Task</span><span class="w"> </span><span class="nv">a</span><span class="w"> </span><span class="nv">b</span><span class="p">)</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Task</span><span class="w"> </span><span class="nv">a</span><span class="w"> </span><span class="nv">b</span>
<span class="nv">line</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nf">\</span><span class="nv">msg</span><span class="p">,</span><span class="w"> </span><span class="nv">echo</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">    </span><span class="nv">reversed</span><span class="w"> </span><span class="nf">=</span>
<span class="w">        </span><span class="nv">msg</span>
<span class="w">        </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">Str</span><span class="nf">.</span><span class="nv">toUtf8</span>
<span class="w">        </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">List</span><span class="nf">.</span><span class="nv">reverse</span>
<span class="w">        </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">Str</span><span class="nf">.</span><span class="nv">fromUtf8</span>
<span class="w">        </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">Result</span><span class="nf">.</span><span class="nv">withDefault</span><span class="w"> </span><span class="s">"BAD UTF8"</span>

<span class="w">    </span><span class="nv">echo</span><span class="w"> </span><span class="nv">reversed</span>
</code></pre></div>
<div class="codehilite" data-code-language="Elm"><pre><span></span><code><span class="err">#</span><span class="w"> </span><span class="nv">example</span><span class="w"> </span><span class="nv">application</span>
<span class="nv">app</span><span class="w"> </span><span class="p">[</span><span class="nv">main</span><span class="p">]</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nv">pf</span><span class="nf">:</span><span class="w"> </span><span class="nv">platform</span><span class="w"> </span><span class="s">"platform/main.roc"</span><span class="p">,</span>
<span class="w">    </span><span class="nv">test</span><span class="nf">:</span><span class="w"> </span><span class="s">"package/main.roc"</span><span class="p">,</span>
<span class="p">}</span>

<span class="kn">import</span><span class="w"> </span><span class="nc">pf.Stdout</span>
<span class="kn">import</span><span class="w"> </span><span class="nc">test.ReversePrint</span>

<span class="kr">main </span><span class="nf">=</span><span class="w"> </span><span class="kt">ReversePrint</span><span class="nf">.</span><span class="nv">line</span><span class="w"> </span><span class="s">"Roc loves Zig"</span><span class="w"> </span><span class="kt">Stdout</span><span class="nf">.</span><span class="nv">line</span>
</code></pre></div>
<p>And we get "Roc loves Zig" reversed <span aria-label="smiley" class="emoji emoji-1f603" role="img" title="smiley">:smiley:</span> </p>
<div class="codehilite"><pre><span></span><code>$ roc test.roc
🔨 Rebuilding platform...
giZ sevol coR
Runtime: 0.027ms
</code></pre></div>



<a name="448422610"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/448422610" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Agus Zubiaga <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#448422610">(Jul 01 2024 at 19:48)</a>:</h4>
<p>That's awesome! I can't wait to rewrite roc-pg with Task as a builtin and params</p>



<a name="448592222"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/448592222" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#448592222">(Jul 02 2024 at 12:18)</a>:</h4>
<p>This is a <a href="https://github.com/roc-lang/roc/pull/6859">WIP PR</a> to replace cli flag <code>--prebuilt-platform</code> with <code>--build-host</code>. </p>
<p>It's a bit of a different direction to effectively remove platform rebuilding from the cli for end users. </p>
<p>Still only a draft -- there's a few tests failing and some linux things to fix. </p>
<p>I'm also trying to add some documentation in the build pipeline and refactor as much as I can.</p>



<a name="448724925"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/448724925" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#448724925">(Jul 02 2024 at 23:54)</a>:</h4>
<p>Just wondering if anyone with Nix experience can look at this and has any intuition for what is causing this to break in CI? It works for me locally <a href="https://github.com/roc-lang/basic-cli/actions/runs/9769507618/job/26969069029?pr=194">https://github.com/roc-lang/basic-cli/actions/runs/9769507618/job/26969069029?pr=194</a></p>



<a name="448724982"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/448724982" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#448724982">(Jul 02 2024 at 23:55)</a>:</h4>
<p>Actually -- I haven't tried running it in the shell yet. I'll do that</p>



<a name="448725057"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/448725057" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#448725057">(Jul 02 2024 at 23:56)</a>:</h4>
<p>Ok, I can repro... now to try and learn nix</p>



<a name="448726452"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/448726452" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#448726452">(Jul 03 2024 at 00:11)</a>:</h4>
<p>ChatGPT to the rescue <span aria-label="smiley" class="emoji emoji-1f603" role="img" title="smiley">:smiley:</span></p>



<a name="448984456"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/448984456" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#448984456">(Jul 04 2024 at 02:09)</a>:</h4>
<p>Possibly quick question: anyone know why <code>AnnotatedBody</code>s exist in the AST, instead of being separate type def + <code>Body</code>? What's the intuition behind why those are paired up?</p>



<a name="448986770"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/448986770" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#448986770">(Jul 04 2024 at 02:36)</a>:</h4>
<p>I dont know sorry.</p>



<a name="449073009"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/449073009" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#449073009">(Jul 04 2024 at 12:11)</a>:</h4>
<p>I think <span class="user-mention" data-user-id="281543">@Folkert de Vries</span> might remember? That’s a super old node <span aria-label="big smile" class="emoji emoji-1f604" role="img" title="big smile">:big_smile:</span></p>



<a name="449073161"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/449073161" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#449073161">(Jul 04 2024 at 12:12)</a>:</h4>
<p>I think that's for making can easier, and possibly error message generation too?</p>



<a name="449073261"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/449073261" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#449073261">(Jul 04 2024 at 12:13)</a>:</h4>
<p>so, it was convenient at the time</p>



<a name="449073378"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/449073378" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#449073378">(Jul 04 2024 at 12:14)</a>:</h4>
<p>if there's good reasons to refactor that now, then if we can keep generating good error messages I don't think there is a reason not to do that refactor</p>



<a name="449383424"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/449383424" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kiryl Dziamura <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#449383424">(Jul 05 2024 at 19:31)</a>:</h4>
<p>just a note, <code>AnnotatedBody</code> is the only way to define a type annotation for a variable right now</p>



<a name="449718925"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/449718925" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kiryl Dziamura <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#449718925">(Jul 07 2024 at 20:47)</a>:</h4>
<p>A good high-level introduction into lambda sets (roc was mentioned! <img alt=":roc:" class="emoji" src="https://zulip-avatars.s3.amazonaws.com/22008/emoji/images/18217.png" title="roc"> )<br>
<a href="https://www.youtube.com/watch?v=CYcf02fTE8E">https://www.youtube.com/watch?v=CYcf02fTE8E</a></p>
<div class="youtube-video message_inline_image"><a data-id="CYcf02fTE8E" href="https://www.youtube.com/watch?v=CYcf02fTE8E"><img src="https://uploads.zulipusercontent.net/5ac807d3ee23fff2b40323ac30ad12f017b6b4b8/68747470733a2f2f692e7974696d672e636f6d2f76692f43596366303266544538452f64656661756c742e6a7067"></a></div>



<a name="449719441"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/449719441" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kiryl Dziamura <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#449719441">(Jul 07 2024 at 20:53)</a>:</h4>
<p>woah, Mae Milano is one of the authors of the paper and Morphic. I already knew her by this brilliant talk: <a href="https://www.youtube.com/watch?v=Mc3tTRkjCvE">https://www.youtube.com/watch?v=Mc3tTRkjCvE</a></p>
<div class="youtube-video message_inline_image"><a data-id="Mc3tTRkjCvE" href="https://www.youtube.com/watch?v=Mc3tTRkjCvE"><img src="https://uploads.zulipusercontent.net/8a34180b6b13013998eecbe68f56deb3a81f364a/68747470733a2f2f692e7974696d672e636f6d2f76692f4d63337454526b6a4376452f64656661756c742e6a7067"></a></div>



<a name="449721135"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/449721135" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#449721135">(Jul 07 2024 at 21:04)</a>:</h4>
<p>yes that strangeloop talk is on my list of talks to watch before giving a talk: on a second (or more) watch you start to notice some of the timing and structure that makes it so good while it treats a bunch of hard technical subject matter</p>



<a name="449766207"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/449766207" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ayaz Hafiz <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#449766207">(Jul 08 2024 at 03:59)</a>:</h4>
<p>Been working with a lot of retail distribution data lately, and there is one distribution center owned by UNFI called UNFI ROC (Rocklin, CA) - always makes me think of this community</p>



<a name="449766246"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/449766246" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#449766246">(Jul 08 2024 at 03:59)</a>:</h4>
<p>Sponsorship opportunity? <span aria-label="thinking" class="emoji emoji-1f914" role="img" title="thinking">:thinking:</span></p>



<a name="449766268"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/449766268" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ayaz Hafiz <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#449766268">(Jul 08 2024 at 03:59)</a>:</h4>
<p>hahahaha</p>



<a name="449766360"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/449766360" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#449766360">(Jul 08 2024 at 04:00)</a>:</h4>
<p>Maybe they could provide yohgurt for the next meetup</p>



<a name="449766389"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/449766389" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ayaz Hafiz <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#449766389">(Jul 08 2024 at 04:00)</a>:</h4>
<p>I will say the retail supply chain could use a lot of love in terms of software products, so totally maybe</p>



<a name="449766507"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/449766507" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#449766507">(Jul 08 2024 at 04:01)</a>:</h4>
<p>Ironically, I'm currently staring at Roc code that attempts to improve the situation in supply chain management</p>



<a name="449766531"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/449766531" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#449766531">(Jul 08 2024 at 04:01)</a>:</h4>
<p>Not sure it will help UNFI though</p>



<a name="449767860"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/449767860" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#449767860">(Jul 08 2024 at 04:15)</a>:</h4>
<p>Well, if your code makes yogurt...</p>



<a name="449767877"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/449767877" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ayaz Hafiz <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#449767877">(Jul 08 2024 at 04:16)</a>:</h4>
<p>we should chat haha</p>



<a name="449984335"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/449984335" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#449984335">(Jul 08 2024 at 21:17)</a>:</h4>
<p>So not that it is particularly meaningful, but I finally have actually committed to llvm. I have a single commit that adds like 10 lines to expose and mlir c API that I wanted for debugging.</p>



<a name="449984468"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/449984468" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#449984468">(Jul 08 2024 at 21:18)</a>:</h4>
<p>How quick is their release cycle? Will you be able to use it anytime soon without building LLVM from source?</p>



<a name="449984711"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/449984711" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#449984711">(Jul 08 2024 at 21:19)</a>:</h4>
<p>My job builds llvm from source, so should be pulled in for our weekly update. Otherwise, llvm releases like every 6 months</p>



<a name="449984952"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/449984952" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#449984952">(Jul 08 2024 at 21:21)</a>:</h4>
<p>For a concrete date Sept 3rd is the planned next llvm release.</p>



<a name="449985100"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/449985100" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#449985100">(Jul 08 2024 at 21:22)</a>:</h4>
<p>And they don't cut from main until July 23rd so my or will make it in.</p>



<a name="450018138"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/450018138" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Zeljko Nesic <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#450018138">(Jul 09 2024 at 00:54)</a>:</h4>
<p><span class="user-mention silent" data-user-id="515757">Luke Boswell</span> <a href="#narrow/stream/395097-compiler-development/topic/casual.20conversation/near/449766507">said</a>:</p>
<blockquote>
<p>Ironically, I'm currently staring at Roc code that attempts to improve the situation in supply chain management</p>
</blockquote>
<p>The Italian guide dude from the SYCL Conf from the Zig crew that we sat down had actually worked on supply chain models software. Maybe he can give you some directions.</p>



<a name="450070855"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/450070855" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#450070855">(Jul 09 2024 at 05:53)</a>:</h4>
<p>Does anyone know how the benchmarks work? I'm trying to figure out how/where they get built for the run in CI</p>



<a name="450073330"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/450073330" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#450073330">(Jul 09 2024 at 06:06)</a>:</h4>
<p>Found it. <code>crates/cli_utils/src/bench_utils.rs</code></p>



<a name="450333326"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/450333326" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#450333326">(Jul 10 2024 at 03:20)</a>:</h4>
<p>It looks like <code>roc build --bundle</code> doesn't pick up and include any windows binaries even if they exist. <span aria-label="sad" class="emoji emoji-2639" role="img" title="sad">:sad:</span></p>



<a name="450334126"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/450334126" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#450334126">(Jul 10 2024 at 03:25)</a>:</h4>
<p>Found the issue, easy fix -- need to add <code>.lib</code>as a recognised legacy host file type</p>



<a name="450344475"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/450344475" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#450344475">(Jul 10 2024 at 04:55)</a>:</h4>
<p>Does anyone know how to find a rust dependency that is using Tcp? I've got basic-ssg building on Windows -- but when I go to link it there are a bunch of missing symbols that all look related to Tcp.</p>



<a name="450344540"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/450344540" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#450344540">(Jul 10 2024 at 04:56)</a>:</h4>
<p>I suspect I might need to turn a feature off on a dependency using a feature flag.</p>



<a name="450344543"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/450344543" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#450344543">(Jul 10 2024 at 04:56)</a>:</h4>
<p><code>cargo-tree</code> can be a good place to start</p>



<a name="450344560"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/450344560" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#450344560">(Jul 10 2024 at 04:56)</a>:</h4>
<p>It's built in to <code>cargo</code> now</p>



<a name="450345947"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/450345947" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#450345947">(Jul 10 2024 at 05:06)</a>:</h4>
<p>I've narrowed my issue down to definitely just a missing library when linking on Windows</p>



<a name="450896207"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/450896207" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#450896207">(Jul 12 2024 at 07:22)</a>:</h4>
<p>Does this look like an issue I should report? </p>
<div class="codehilite"><pre><span></span><code>Listening on &lt;http://localhost:8000&gt;
2024-07-12T07:21:16Z GET /dashboard
thread &#39;tokio-runtime-worker&#39; panicked at &#39;The Roc app crashed with: Can&#39;t create record with improper layout&#39;, src/lib.rs:46:5
</code></pre></div>



<a name="450899955"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/450899955" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#450899955">(Jul 12 2024 at 07:44)</a>:</h4>
<p>I know what caused the issue, at least in the roc source code. </p>
<p>It should have been this</p>
<div class="codehilite"><pre><span></span><code>baseWithBody = \content, navBar -&gt; Generated.Pages.baseWithBody {
        content,
        navBarRtl: navBar,
        headerRtl,
        isWhiteBackground: Bool.true,
    }
</code></pre></div>
<p>But instead I was doing this</p>
<div class="codehilite"><pre><span></span><code>baseWithBody = \content, navBar -&gt; Generated.Pages.baseWithBody {
        content,
        navBar,
        headerRtl,
        isWhiteBackground: Bool.true,
    }
</code></pre></div>
<p>Roc turns this into a runtime error and happily <code>roc build</code>s and outputs the built file -- which means I don't pick this up until it panics at runtime.</p>
<p>But because roc returns Warnings as a non-zero exit code I've been ignoring the exit code and just checking the app was built. I probably need to revisit this strategy.</p>
<p>I'd love a way to say, don't <code>roc build</code> if there are any errors. I think this should be the dafault actually.</p>



<a name="450927978"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/450927978" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#450927978">(Jul 12 2024 at 10:05)</a>:</h4>
<blockquote>
<p>I'd love a way to say, don't <code>roc build</code> if there are any errors. I think this should be the dafault actually.</p>
</blockquote>
<p>I've had this thought as well and mentioned it on zulip before but I can't find the conversation anymore...<br>
I'd say the problem is that we want both ways to be discoverable and want the user to be aware if their command ignores errors or not.</p>



<a name="450928519"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/450928519" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#450928519">(Jul 12 2024 at 10:08)</a>:</h4>
<p><a href="https://github.com/roc-lang/roc/issues/6637">https://github.com/roc-lang/roc/issues/6637</a></p>



<a name="450928717"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/450928717" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#450928717">(Jul 12 2024 at 10:09)</a>:</h4>
<p>I think after we land the rebuild host changes that are almost done, this will be the next step. There's just been a lot of preparation to get to this point and enable ^^&amp;</p>



<a name="450929514"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/450929514" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#450929514">(Jul 12 2024 at 10:13)</a>:</h4>
<p>I wonder if we can improve upon the name <code>run</code> to make it obvious that it runs even with errors, some suggestions:</p>
<ul>
<li>force-run</li>
<li>run-anyway</li>
<li>run-with-errors</li>
<li>risky-run</li>
</ul>



<a name="450930114"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/450930114" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#450930114">(Jul 12 2024 at 10:17)</a>:</h4>
<p>Well in that issue we have</p>
<blockquote>
<ul>
<li>Note <code>roc run</code> and <code>roc dev</code> commands removed as redundant</li>
</ul>
</blockquote>



<a name="450930218"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/450930218" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#450930218">(Jul 12 2024 at 10:17)</a>:</h4>
<p>I don't think we need it anymore -- if we want to be able to pipe input into just roc, or run without any arguments, we otherwise would be back in the situation of having multiple alternative ways to run a script if we keep <code>run</code> subcommand.</p>



<a name="450934819"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/450934819" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#450934819">(Jul 12 2024 at 10:38)</a>:</h4>
<blockquote>
<p>Note <code>roc run</code> and <code>roc dev</code> commands removed as redundant</p>
</blockquote>
<p>Oh ok, I assumed it was still there given the "run workflow" title. I'll read through the whole thing in a bit</p>



<a name="450956507"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/450956507" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#450956507">(Jul 12 2024 at 12:21)</a>:</h4>
<blockquote>
<p>I'd love a way to say, don't <code>roc build</code> if there are any errors. I think this should be the dafault actually.</p>
</blockquote>
<p>Ok, so looking at the issue, this is already the plan...</p>



<a name="451210828"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/451210828" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#451210828">(Jul 13 2024 at 18:44)</a>:</h4>
<p>intriguing!</p>
<p><a href="https://github.com/nicholassm/disruptor-rs?tab=readme-ov-file">https://github.com/nicholassm/disruptor-rs?tab=readme-ov-file</a></p>
<blockquote>
<p>The library also supports pinning threads on cores to avoid latency induced by context switching.</p>
</blockquote>



<a name="451384161"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/451384161" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#451384161">(Jul 14 2024 at 21:53)</a>:</h4>
<p>whooooooa</p>
<p><a href="https://github.com/mazeppa-dev/mazeppa">https://github.com/mazeppa-dev/mazeppa</a></p>



<a name="451384944"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/451384944" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#451384944">(Jul 14 2024 at 22:07)</a>:</h4>
<p>this is absolutely wild</p>
<blockquote>
<p>The lambda normalizer also shows us how to incarnate higher-order functions into a first-order language. In Mazeppa, we cannot treat functions as values, but it does not mean that we cannot simulate them! By performing a metasystem transition, we can efficiently implement higher-order functions in a first-order language. Along with defunctionalization and closure conversion, this technique can be used for compilation of higher-order languages into efficient first-order code.</p>
</blockquote>



<a name="451385036"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/451385036" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#451385036">(Jul 14 2024 at 22:09)</a>:</h4>
<p><span class="user-mention" data-user-id="454654">@Ayaz Hafiz</span> <span class="user-mention" data-user-id="281543">@Folkert de Vries</span> imagine if we could adopt this for <code>--optimize</code> and use it to defunctionalize instead of lambda sets, then use heap-allocated closures in dev builds</p>



<a name="451385187"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/451385187" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#451385187">(Jul 14 2024 at 22:11)</a>:</h4>
<p>I wonder if it's guaranteed to defunctionalize fully <span aria-label="thinking" class="emoji emoji-1f914" role="img" title="thinking">:thinking:</span></p>



<a name="451385273"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/451385273" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#451385273">(Jul 14 2024 at 22:12)</a>:</h4>
<p>real question is whether they've solved the problems we have. e.g. is it efficient/possible to perform the analysis on a per-module basis?</p>



<a name="451385290"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/451385290" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#451385290">(Jul 14 2024 at 22:13)</a>:</h4>
<p>we can spin a cool story about lambda sets just ignoring the practical problems we face as a production language</p>



<a name="451385359"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/451385359" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#451385359">(Jul 14 2024 at 22:14)</a>:</h4>
<p>if it's only for optimize builds, maybe it's ok if it's whole-program only?</p>



<a name="451385387"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/451385387" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#451385387">(Jul 14 2024 at 22:14)</a>:</h4>
<p>I really think programs just get too big for that to be a practical solution long-term</p>



<a name="451385713"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/451385713" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#451385713">(Jul 14 2024 at 22:21)</a>:</h4>
<p>without being able to parallelize? or do incrementally with caching?</p>



<a name="451385787"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/451385787" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#451385787">(Jul 14 2024 at 22:22)</a>:</h4>
<p>yeah here the details start to matter, and I wonder if they have run into that sort of problem with their implementation</p>



<a name="451385829"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/451385829" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#451385829">(Jul 14 2024 at 22:23)</a>:</h4>
<p>caching etc could go a long way though, but I think that only gets investigated once performance problems come up</p>



<a name="451386057"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/451386057" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#451386057">(Jul 14 2024 at 22:27)</a>:</h4>
<p>sure haha</p>



<a name="451386684"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/451386684" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#451386684">(Jul 14 2024 at 22:39)</a>:</h4>
<p>but the idea of having one process that does all of these and more is pretty intriguing:</p>
<ul>
<li>defunctionalization</li>
<li>deforestation</li>
<li>partial evaluation</li>
</ul>



<a name="451696834"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/451696834" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#451696834">(Jul 16 2024 at 07:28)</a>:</h4>
<p>Interesting / amusing bug -- if you name an Effect <code>tmpDir</code> roc won't expose it for some reason.</p>



<a name="451697689"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/451697689" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#451697689">(Jul 16 2024 at 07:33)</a>:</h4>
<p>Hmmm, having trouble getting an effect that just returns a string to work <code>someTmpDir : Effect Str</code></p>



<a name="451698100"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/451698100" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#451698100">(Jul 16 2024 at 07:35)</a>:</h4>
<p>Like, I'm not going crazy here right? This should be possible?</p>
<div class="codehilite"><pre><span></span><code># Effect.roc
someTmpDir : Effect Str
</code></pre></div>
<div class="codehilite"><pre><span></span><code># Dir.roc
tmpDir : Task Str []_
tmpDir =
    Effect.someTmpDir
    |&gt; Effect.map Ok
    |&gt; InternalTask.fromEffect
</code></pre></div>
<div class="codehilite"><pre><span></span><code>$ roc build --no-link examples/hello-world.roc
0 errors and 0 warnings found in 116 ms
 while successfully building:

    examples/hello-world.o
$ objdump -t examples/hello-world.o | grep &quot;roc_fx_someDir&quot;
$
</code></pre></div>



<a name="451701326"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/451701326" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#451701326">(Jul 16 2024 at 07:56)</a>:</h4>
<p>Ok, not going insane, misspelled something</p>



<a name="452286519"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/452286519" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#452286519">(Jul 18 2024 at 08:42)</a>:</h4>
<p>I've been seeing this bug a fair bit today. I thought I might log an issue for it as it's really strange <br>
<a href="https://github.com/roc-lang/roc/issues/6913">https://github.com/roc-lang/roc/issues/6913</a></p>
<p>Basically, <code>expect</code> is failing for values which should be equal.</p>



<a name="452553188"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/452553188" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#452553188">(Jul 19 2024 at 11:42)</a>:</h4>
<p>I love that a release includes a hash of all the files. </p>
<p>I just checked if I needed to update the glue platform package as it's been a while -- re-generated the bundle and it's got an identical hash. <span aria-label="smiley" class="emoji emoji-1f603" role="img" title="smiley">:smiley:</span></p>



<a name="452910757"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/452910757" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#452910757">(Jul 20 2024 at 23:08)</a>:</h4>
<p>I'm thinking about the chain of <code>alloca</code> related issues. cc: <span class="user-mention" data-user-id="281543">@Folkert de Vries</span></p>
<p>With our joinpoints, we guarantee that everything that lives for multiple iterations is explicitly passed to the jump expression. As such, anything that is alloca'ed in the middle of the loop created by the joinpoint should be safe to have it's alloca be part of the entry block. Correct?</p>
<p>It' just that at the jump instruction, we have to copy out of any temporary allocas and into the allocas for the joinpoint. Otherwise, we may run into mutation bugs where the the the next run of loop mutate values that became joinpoint args.</p>
<p>I think that is roughly correct.</p>
<hr>
<p>If so, I think that means we can hoist all allocas period to the entry block. Then cleanup jointpoints/jumps and hopefully have fixed a number of bugs.</p>



<a name="452910759"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/452910759" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#452910759">(Jul 20 2024 at 23:08)</a>:</h4>
<p>context <a href="https://github.com/roc-lang/roc/issues/6434">#6434</a></p>



<a name="452938772"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/452938772" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#452938772">(Jul 21 2024 at 04:27)</a>:</h4>
<p>So turns out I should have tried to fix this a long time ago. Turned out to be pretty easy:</p>
<p><a href="https://github.com/roc-lang/roc/issues/6916">#6916</a> is ready for review</p>



<a name="452943703"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/452943703" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#452943703">(Jul 21 2024 at 05:18)</a>:</h4>
<p>Also, this cut a whole minute off of <code>1brc</code> in roc. <code>llvm</code> really does optimize better with all allocas in the entry block.</p>
<div class="codehilite"><pre><span></span><code>Benchmark 1: ./1brc data/measurements_1_000_000_000.txt
  Time (mean ± σ):     118.589 s ±  0.643 s    [User: 116.121 s, System: 1.720 s]
  Range (min … max):   118.009 s … 119.280 s    3 runs

Benchmark 2: ./1brc-old data/measurements_1_000_000_000.txt
  Time (mean ± σ):     188.869 s ±  3.279 s    [User: 186.282 s, System: 1.635 s]
  Range (min … max):   185.188 s … 191.478 s    3 runs

Summary
  ./1brc data/measurements_1_000_000_000.txt ran
    1.59 ± 0.03 times faster than ./1brc-old data/measurements_1_000_000_000.txt
</code></pre></div>



<a name="452999318"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/452999318" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#452999318">(Jul 21 2024 at 15:32)</a>:</h4>
<p>Also, most of the flamegraph is now allocating for <code>RocList::extend_from_slice</code> So platform primitives instead of roc itself.</p>



<a name="453548044"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/453548044" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#453548044">(Jul 23 2024 at 23:10)</a>:</h4>
<p>This may not help at all, but on the refactor-host branch of basic-webserver I was able to get a working executable by using zig within the nix shell, and compiling my app using <code>--no-link</code>. </p>
<div class="codehilite"><pre><span></span><code>zig build-exe ./target/release/libhost.a  app.o -lc -lunwind -fstrip
</code></pre></div>
<p>This is a workaround for the linux musl and linking issue, that I doubt is really bothering anyone, but sharing just in case. </p>
<p>I suspect our linking issue with basic-cli may be related to <code>-lunwind</code> which isn't included by default in our roc linker flags. I'll try and test that more later.</p>



<a name="453548271"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/453548271" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#453548271">(Jul 23 2024 at 23:12)</a>:</h4>
<p><code>libunwind</code> looks to be a dependency of the <code>backtrace</code> crate</p>



<a name="453987097"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/453987097" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#453987097">(Jul 25 2024 at 16:01)</a>:</h4>
<p>So assuming the numbers in this repo are correct (which I expect them to be), we apparently shouldn't be using linear search anymore. We should be using monobound binary search: <a href="https://github.com/scandum/binary_search/">https://github.com/scandum/binary_search/</a></p>
<p>This is thinking about the many cases in the compiler where for small maps, we attempt to use vec map and linear searching. Hmm, though that doesn't take into account the cost of keeping the list sorted so you can binary search.</p>



<a name="453993175"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/453993175" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#453993175">(Jul 25 2024 at 16:19)</a>:</h4>
<p>since we use <code>VecMap</code> in so many places, might not be a big effort to swap its implementation for something which does that, and just see what happens</p>



<a name="453995798"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/453995798" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#453995798">(Jul 25 2024 at 16:28)</a>:</h4>
<p>True</p>



<a name="454893215"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/454893215" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#454893215">(Jul 29 2024 at 17:14)</a>:</h4>
<p>We just landed task as builtin...didn't we...That is probably why my code using task suddenly broke on main?</p>



<a name="454893313"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/454893313" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#454893313">(Jul 29 2024 at 17:15)</a>:</h4>
<div class="codehilite"><pre><span></span><code>── UNRECOGNIZED NAME in ../sorting/builtin.roc ─────────────────────────────────

Nothing is named `Task` in this scope.

56│&gt;      Stdout.line!
57│&gt;          (
58│&gt;              if testSort answrlst then
59│&gt;                  &quot;List sorted correctly!&quot;
60│&gt;              else
61│&gt;                  &quot;Failure in sorting list!!!&quot;
62│&gt;          )

Did you mean one of these?

    Hash
    main
    List
    U8

────────────────────────────────────────────────────────────────────────────────
</code></pre></div>



<a name="454894824"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/454894824" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#454894824">(Jul 29 2024 at 17:20)</a>:</h4>
<p>No, it's not on main yet or in TESTING</p>



<a name="454894970"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/454894970" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#454894970">(Jul 29 2024 at 17:21)</a>:</h4>
<p>Ah I know what this is, you need to add <code>exposing [Task]</code></p>



<a name="454895002"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/454895002" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#454895002">(Jul 29 2024 at 17:21)</a>:</h4>
<p><span class="user-mention" data-user-id="343810">@Brendan Hansknecht</span> did you add a exposing Task suffix to your import?</p>



<a name="454895133"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/454895133" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#454895133">(Jul 29 2024 at 17:22)</a>:</h4>
<p>Interesting. Why is that needed today but not yesterday (or a few days ago, don't have exact bisect)</p>



<a name="454895405"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/454895405" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#454895405">(Jul 29 2024 at 17:23)</a>:</h4>
<p>It was due to fixes around <code>!</code> but I did not get to the bottom of it myself</p>



<a name="454895736"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/454895736" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#454895736">(Jul 29 2024 at 17:24)</a>:</h4>
<p>Yes, I think it was caused by <a href="https://github.com/roc-lang/roc/pull/6868">PR#6868</a></p>



<a name="454909235"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/454909235" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#454909235">(Jul 29 2024 at 18:07)</a>:</h4>
<p>I guess once we have task as built-in this will be fixed cause task will be automatically imported.</p>



<a name="454909263"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/454909263" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#454909263">(Jul 29 2024 at 18:07)</a>:</h4>
<p>Yup</p>



<a name="454949586"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/454949586" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Musab Nazir <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#454949586">(Jul 29 2024 at 21:04)</a>:</h4>
<p>I ran into this exact issue yesterday and was confused (using testing releases). I don't think the docs / tutorial mentions the need to use exposing [Task] or maybe I didn't look hard enough</p>



<a name="454951606"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/454951606" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#454951606">(Jul 29 2024 at 21:15)</a>:</h4>
<p>We only just merged that change, and I don't think anyone realised it would impact the imports in this way. The Task as builtin change is basically ready and will eliminate this entirely. We just are going through the process to make sure that is well tested before making anither breaking change and new release.</p>



<a name="454951796"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/454951796" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#454951796">(Jul 29 2024 at 21:16)</a>:</h4>
<p>When Task is a builtin there wont be any need to import it manually, it will be automatically available in every app.</p>



<a name="455194395"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/455194395" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#455194395">(Jul 30 2024 at 18:49)</a>:</h4>
<p>Good info and visualization on how memory really should be accessed if you want to maximize throughput: <a href="https://blog.mattstuchlik.com/2024/07/21/fastest-memory-read.html">https://blog.mattstuchlik.com/2024/07/21/fastest-memory-read.html</a></p>



<a name="455194625"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/455194625" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#455194625">(Jul 30 2024 at 18:51)</a>:</h4>
<p>Theoretically would also be a more optimal way to do large <code>List.map</code> operations assuming the mapping function is simple enough (too expensive of a mapping function and doing more complex memory loading may actually hurt a lot).</p>



<a name="455194718"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/455194718" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#455194718">(Jul 30 2024 at 18:51)</a>:</h4>
<p>someone suggested using large pages somewhere for basically the same effect with less effort</p>



<a name="455195881"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/455195881" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#455195881">(Jul 30 2024 at 18:59)</a>:</h4>
<p>How do large pages fix the issue? I thought the core problem was needing multiple memory streams to increase memory load throughput and keep the load buffer full.</p>



<a name="455777291"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/455777291" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#455777291">(Aug 01 2024 at 23:38)</a>:</h4>
<p>Maybe this is a completely crazy idea... but LLVM bitcode isn't specific to an os/arch and is basically an IR. Right?</p>
<p>Is there any reason why a platform host couldn't be a LLVM bitcode file? So platform authors provide that one <code>generic-llvm.bc</code> or something and then roc can build and link targeting anything supported by LLVM. </p>
<p>It woudn't be compiled into machine code already, so it would be much slower than just linking, and probably much larger. But maybe it provides a more flexibility or is a good option for some use-cases?</p>



<a name="455779300"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/455779300" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#455779300">(Aug 01 2024 at 23:59)</a>:</h4>
<p>Versioning is a problem (no guarantee that llvm 16 ir will load with llvm 17). Also wouldn't work with dev backends.</p>



<a name="455785783"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/455785783" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#455785783">(Aug 02 2024 at 00:29)</a>:</h4>
<p>So it could work then? We could version the file, like <code>generic_llvm_18_1_8.bc</code>.</p>
<p>Even is this only worked for slower optimised builds, it might be useful, particularly for e.g. getting support for various long tail of targets.</p>



<a name="455785976"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/455785976" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#455785976">(Aug 02 2024 at 00:30)</a>:</h4>
<p>The most immediate use case I can think of is for WASM/WASI targets.</p>



<a name="455789794"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/455789794" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#455789794">(Aug 02 2024 at 00:48)</a>:</h4>
<p>Cant we just use wasm LD?</p>



<a name="455789869"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/455789869" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#455789869">(Aug 02 2024 at 00:48)</a>:</h4>
<p>Avoid the error and problems of merging llvm ir directly?</p>



<a name="456138433"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/456138433" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Notification Bot <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#456138433">(Aug 03 2024 at 11:07)</a>:</h4>
<p>3 messages were moved from this topic to <a class="stream-topic" data-stream-id="395097" href="/#narrow/stream/395097-compiler-development/topic/glue.20generation.20error">#compiler development &gt; glue generation error</a> by <span class="user-mention silent" data-user-id="281383">Richard Feldman</span>.</p>



<a name="456372876"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/456372876" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#456372876">(Aug 04 2024 at 18:50)</a>:</h4>
<p>We can generate some "interesting" types:</p>
<blockquote>
<p>expected type 'union { (union { ((),), ((heap_cell,),), (), ((heap_cell,), union { (), (), (), (), (), (), (), (), (), (), (), (), (), (), (), (), (), (), (), (), (), (), (), (), (), (), (), (), (), () }), (), ((),), () },), ((heap_cell, bag&lt;(heap_cell,)&gt;),) }', found type 'union { (union { ((),), ((heap_cell,),), ((heap_cell,), union { (), (), (), (), (), (), (), (), (), (), (), (), (), (), (), (), (), (), (), (), (), (), (), (), (), (), (), (), (), () }), ((),) },), ((heap_cell, bag&lt;(heap_cell,)&gt;),) }'</p>
</blockquote>



<a name="456400920"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/456400920" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#456400920">(Aug 04 2024 at 22:46)</a>:</h4>
<p>Is this the work of the alias analysis, lambda sets? I imagine this is what is happening in the "Specialise" stage of the compiler.</p>



<a name="456400943"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/456400943" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#456400943">(Aug 04 2024 at 22:47)</a>:</h4>
<p>And thinking about Jasper's comment the other day, could this be represented in Roc style syntax, or is this completely something different?</p>



<a name="456432891"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/456432891" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#456432891">(Aug 05 2024 at 03:59)</a>:</h4>
<blockquote>
<p>Is this the work of the alias analysis, lambda sets?</p>
</blockquote>
<p>I think it is related. Like it happens for all types that unify, lambdasets being one of them. I think this specific error may come from morphic related code? Caues I think it use things like <code>bag&lt;(heap_cell,)&gt;</code>. Theoretically you could represent this as a roc style tag union, but I don't think that would erally be helpful.</p>
<p>As a note, this is generating from basic webserver with sqlite. I ported the todos example over. Using the query function twice in different contexts seems to be leading to this somehow. If I comment out either the <code>createTodo</code> path or the <code>listTodos</code> path, it seems to fix things. I am very much not sure what all is going on/the real issue. I think the first type has extra empty <code>()</code> values. Maybe something should be collapsing those together? Cause <code>union { (), () }</code> is probably the same thing as <code>union { () }</code> (assuming this are raw unions.</p>
<p>PR here: <a href="https://github.com/roc-lang/basic-webserver/pull/61">https://github.com/roc-lang/basic-webserver/pull/61</a><br>
With repro command being <code>roc build.roc &amp;&amp; roc examples/todos.roc</code> if any has a chance to take a look/a guess at the issues.</p>



<a name="456662166"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/456662166" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#456662166">(Aug 05 2024 at 17:35)</a>:</h4>
<p><span class="user-mention" data-user-id="281543">@Folkert de Vries</span> just curious if you have any thoughts or comments on the above. Specifically around alias analysis union simplification and if it is valid. Like are we missing a canonicalization step here that would lead to all the <code>()</code> in the union merging into a single <code>()</code>. I'm not sure the semantics expected here.</p>



<a name="456984266"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/456984266" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#456984266">(Aug 07 2024 at 01:16)</a>:</h4>
<p><span class="user-mention" data-user-id="454654">@Ayaz Hafiz</span> just curious if you have any idea about the above.</p>



<a name="456985365"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/456985365" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ayaz Hafiz <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#456985365">(Aug 07 2024 at 01:31)</a>:</h4>
<p>() are units</p>



<a name="456985419"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/456985419" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ayaz Hafiz <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#456985419">(Aug 07 2024 at 01:32)</a>:</h4>
<p>there's probably a way to simplify it, but simplifying it is also likely covering up a bug</p>



<a name="456985441"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/456985441" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ayaz Hafiz <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#456985441">(Aug 07 2024 at 01:32)</a>:</h4>
<p>i would run the IR checker - that will point to an issue if there is one earlier on, which i suspect there is</p>



<a name="456985465"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/456985465" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#456985465">(Aug 07 2024 at 01:33)</a>:</h4>
<p>I think it crashes before check mono ir runs. That or it passes and then gets to this failure anyway.</p>



<a name="456985496"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/456985496" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ayaz Hafiz <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#456985496">(Aug 07 2024 at 01:33)</a>:</h4>
<p>there should be a mono IR check pass that runs before alias analysis (morphic). this is a panic in morphic</p>



<a name="456985565"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/456985565" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ayaz Hafiz <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#456985565">(Aug 07 2024 at 01:34)</a>:</h4>
<p>I would check roc_debug_flags, i think its ROC_CHECK_IR_AFTER_SPECIALIZATION or something</p>



<a name="456985620"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/456985620" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#456985620">(Aug 07 2024 at 01:35)</a>:</h4>
<p>Ok. I'll double check when I get the chance. I'm pretty sure I ran it with <code>ROC_CHECK_MONO_IR</code> and it still got to the error above and crashed.</p>



<a name="457059140"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/457059140" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#457059140">(Aug 07 2024 at 09:13)</a>:</h4>
<p>Should we enable these env vars in CI when doing <code>cargo test</code> without <code>--release</code> to catch any bugs that may otherwise go undetected?</p>
<div class="codehilite"><pre><span></span><code>ROC_VERIFY_RIGID_LET_GENERALIZED
ROC_VERIFY_OCCURS_ONE_RECURSION
ROC_CHECK_MONO_IR
</code></pre></div>



<a name="457180497"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/457180497" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#457180497">(Aug 07 2024 at 19:13)</a>:</h4>
<p>That sounds like a great idea!</p>



<a name="459504148"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/459504148" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#459504148">(Aug 09 2024 at 15:21)</a>:</h4>
<p>After reading the descriptions of the  verify flags (in crates/compiler/debug_flags/src/lib.rs), I ended up enabling only ROC_CHECK_MONO_IR (<a href="https://github.com/roc-lang/roc/pull/6976">PR#6976</a>)</p>



<a name="459596873"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/459596873" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#459596873">(Aug 10 2024 at 00:00)</a>:</h4>
<p>Oh, we do have a mono ir failure here:</p>
<div class="spoiler-block"><div class="spoiler-header">
<p>check failure</p>
</div><div class="spoiler-content" aria-hidden="true">
<div class="codehilite"><pre><span></span><code>Full source: procedure `pf.Sqlite.87` (`pf.Sqlite.464`):
    let `pf.Sqlite.865` : [C [C [], C Str, C Str [C , C , C , C , C , C , C , C , C , C , C , C , C , C , C , C , C , C , C , C , C , C , C , C , C , C , C , C , C , C ], C U8], C List Str] = TagId(1) `pf.Sqlite.464`;
    ret `pf.Sqlite.865`;
IR PROBLEMS FOUND:
── SYMBOL LAYOUT DOESN&#39;T MATCH ITS USE ─────────────────────────────────────────

in 87 : (List Str) -&gt;
[C [C [], C Str, C , C Str [C , C , C , C , C , C , C , C , C , C , C , C , C , C , C , C , C , C , C , C , C , C , C , C , C , C , C , C , C , C ], C , C U8, C ], C List Str] ((niche
{}))

0│  procedure `pf.Sqlite.87` (`pf.Sqlite.464`):
1│&gt;     let `pf.Sqlite.865` : [C [C [], C Str, C Str [C , C , C , C , C , C , C , C , C , C , C , C , C , C , C , C , C , C , C , C , C , C , C , C , C , C , C , C , C , C ], C U8], C List Str] = TagId(1) `pf.Sqlite.464`;
2│      ret `pf.Sqlite.865`;

Sqlite.865 defined here with layout
[C [C [], C Str, C Str [C , C , C , C , C , C , C , C , C , C , C , C , C , C , C , C , C , C , C , C , C , C , C , C , C , C , C , C , C , C ], C U8], C List Str]

1│      let `pf.Sqlite.865` : [C [C [], C Str, C Str [C , C , C , C , C , C , C , C , C , C , C , C , C , C , C , C , C , C , C , C , C , C , C , C , C , C , C , C , C , C ], C U8], C List Str] = TagId(1) `pf.Sqlite.464`;
2│&gt;     ret `pf.Sqlite.865`;

Sqlite.865 used as a return value here with layout
[C [C [], C Str, C , C Str [C , C , C , C , C , C , C , C , C , C , C , C , C , C , C , C , C , C , C , C , C , C , C , C , C , C , C , C , C , C ], C , C U8, C ], C List Str]
</code></pre></div>
<div class="codehilite"><pre><span></span><code>
</code></pre></div>
</div></div>



<a name="459597200"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/459597200" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#459597200">(Aug 10 2024 at 00:04)</a>:</h4>
<p>The type difference is this:</p>
<div class="codehilite" data-code-language="Diff"><pre><span></span><code>[
<span class="w"> </span>   C [
<span class="w"> </span>       C [],
<span class="w"> </span>       C Str,
<span class="gd">-       C ,</span>
<span class="w"> </span>       C Str [C , C , C , C , C , C , C , C , C , C , C , C , C , C , C , C , C , C , C , C , C , C , C , C , C , C , C , C , C , C ],
<span class="gd">-       C ,</span>
<span class="w"> </span>       C U8,
<span class="gd">-       C</span>
<span class="w"> </span>   ],
<span class="w"> </span>   C List Str
]
</code></pre></div>



<a name="462610186"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/462610186" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Carroll <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#462610186">(Aug 15 2024 at 18:15)</a>:</h4>
<p>Just saw someone share this collection of "Resources for Amateur Compiler Writers". I haven't dug into them yet, but thought I'd pass it on anyway!<br>
<a href="https://c9x.me/compile/bib/">https://c9x.me/compile/bib/</a></p>



<a name="462839096"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/462839096" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#462839096">(Aug 16 2024 at 18:42)</a>:</h4>
<p>I just tried IDA free for the first time, it is definitely the best assembly debugger I have ever used<br>
<a href="/user_uploads/22008/q5OKxtPhBMtzB3xwSBkULdzO/Screenshot-from-2024-08-16-20-39-28.png">IDA-screenshot</a></p>
<div class="message_inline_image"><a href="/user_uploads/22008/q5OKxtPhBMtzB3xwSBkULdzO/Screenshot-from-2024-08-16-20-39-28.png" title="IDA-screenshot"><img data-original-dimensions="4968x2701" src="/user_uploads/thumbnail/22008/q5OKxtPhBMtzB3xwSBkULdzO/Screenshot-from-2024-08-16-20-39-28.png/840x560.webp"></a></div>



<a name="462839190"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/462839190" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#462839190">(Aug 16 2024 at 18:43)</a>:</h4>
<p>Wow, that's basically exactly what we want</p>



<a name="462841390"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/462841390" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#462841390">(Aug 16 2024 at 19:00)</a>:</h4>
<p>That's a lot like gdb tui mode</p>



<a name="462841787"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/462841787" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#462841787">(Aug 16 2024 at 19:03)</a>:</h4>
<p>TIL gdb has a TUI: <a href="https://dev.to/irby/making-gdb-easier-the-tui-interface-15l2">https://dev.to/irby/making-gdb-easier-the-tui-interface-15l2</a></p>



<a name="462864407"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/462864407" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Zeljko Nesic <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#462864407">(Aug 16 2024 at 22:24)</a>:</h4>
<p><span class="user-mention" data-user-id="361169">@Anton</span>  Have you tried Cutter?</p>



<a name="462951931"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/462951931" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#462951931">(Aug 17 2024 at 08:02)</a>:</h4>
<p>Wow, cutter looks very clean, definitely going to try that out</p>



<a name="462962732"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/462962732" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#462962732">(Aug 17 2024 at 10:14)</a>:</h4>
<p>The debugger is in beta and crashes easily on the binary I'm testing it with, it definitely has potential though!</p>



<a name="463918324"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/463918324" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#463918324">(Aug 21 2024 at 02:21)</a>:</h4>
<p>I am once again reminded how fast memcpy is for giant chunks of data.</p>
<p>I was looking at basic webserver and the cost of always copying the request and response bodies. Cause currently it always copies the input and output data from rust vectors into roc lists and back.</p>
<p>Did some testing of echoing with a large payload (~100KB).</p>
<p>Raw rust, fully async but still manifesting the fully body into bytes (aka avoid streaming in the request body):<br>
<code>787482 requests in 20.10s, 72.66GB read</code></p>
<p>Roc with <code>spawn_blocking</code> and copying all inputs and outputs between rust vector and roc lists:<br>
<code>627501 requests in 20.00s, 57.90GB read</code></p>
<p>So 2 extra copies of all bytes only costs ~20% loss in overall perf. Still a hefty loss, but I was expecting a lot more.</p>
<p>Note: if we also constrain rust to use <code>spawn_blocking</code> it takes a ~4% perf hit:<br>
<code>755249 requests in 20.10s, 69.69GB read</code></p>



<a name="464179762"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/464179762" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Zeljko Nesic <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#464179762">(Aug 21 2024 at 22:00)</a>:</h4>
<p>See if you can try copying 1MB of data back and forth and see how much of penalty does it take! :)</p>



<a name="464196840"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/464196840" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#464196840">(Aug 21 2024 at 23:59)</a>:</h4>
<p>I mean the process as a whole gets slower but the ratio is roughly the same.</p>
<p>raw rust without <code>spawn_blocking</code>:<br>
<code>69261 requests in 20.08s, 63.86GB read</code></p>
<p>roc:<br>
<code>58514 requests in 20.08s, 53.95GB read</code></p>
<p>Roc is ~15% slower in overall perf.</p>



<a name="465099591"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/465099591" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#465099591">(Aug 26 2024 at 07:10)</a>:</h4>
<p>What is this post?? <a href="https://github.com/roc-lang/roc/issues/7027#issuecomment-2309494585">https://github.com/roc-lang/roc/issues/7027#issuecomment-2309494585</a></p>
<p>Concerning, it looks like spam/malware</p>



<a name="465099643"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/465099643" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#465099643">(Aug 26 2024 at 07:10)</a>:</h4>
<p>I want to "Report Content"</p>



<a name="465099661"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/465099661" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#465099661">(Aug 26 2024 at 07:10)</a>:</h4>
<p>I hid it, you should probably report it</p>



<a name="465099783"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/465099783" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#465099783">(Aug 26 2024 at 07:11)</a>:</h4>
<p>Their only contribution I can publically see on Github is 3 hours ago: <a href="https://github.com/TerraFirmaCraft/TerraFirmaCraft/issues/2772">https://github.com/TerraFirmaCraft/TerraFirmaCraft/issues/2772</a></p>



<a name="465099849"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/465099849" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#465099849">(Aug 26 2024 at 07:12)</a>:</h4>
<p>Reported</p>



<a name="465104171"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/465104171" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#465104171">(Aug 26 2024 at 07:31)</a>:</h4>
<p>Terrafirmacraft...that's a throwback</p>



<a name="465114620"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/465114620" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#465114620">(Aug 26 2024 at 08:16)</a>:</h4>
<p>Password protected to evade malware scanners, sneaky...</p>



<a name="466190044"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/466190044" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#466190044">(Aug 30 2024 at 08:06)</a>:</h4>
<p>1023 unread messages in ideas :p</p>



<a name="466190153"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/466190153" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#466190153">(Aug 30 2024 at 08:07)</a>:</h4>
<p>Howdy</p>



<a name="466190374"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/466190374" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#466190374">(Aug 30 2024 at 08:07)</a>:</h4>
<p>We can summarize, but there was a good amount of useful convo</p>



<a name="466190515"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/466190515" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#466190515">(Aug 30 2024 at 08:08)</a>:</h4>
<p>Mainly about purity inference, super cool idea, no perfect way to do it</p>



<a name="466193451"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/466193451" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#466193451">(Aug 30 2024 at 08:17)</a>:</h4>
<blockquote>
<p>We can summarize, but there was a good amount of useful convo</p>
</blockquote>
<p>Nah, I can't break my reading everything streak :p</p>



<a name="466193491"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/466193491" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#466193491">(Aug 30 2024 at 08:17)</a>:</h4>
<p>That's dedication</p>



<a name="466193532"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/466193532" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#466193532">(Aug 30 2024 at 08:17)</a>:</h4>
<p>Well, we'll be happy to get your input on everything</p>



<a name="466193557"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/466193557" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#466193557">(Aug 30 2024 at 08:17)</a>:</h4>
<p>These are extremely important discussions!</p>



<a name="467311003"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/467311003" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#467311003">(Sep 03 2024 at 16:46)</a>:</h4>
<p>Always fun to remember just how much perf is often left on the table: <a href="/user_uploads/22008/kSxE6mBK7iNfHL-VOpoEfg-f/41b1ca8f-ae9e-4406-9c07-0a99fc0f35bf.jpg">41b1ca8f-ae9e-4406-9c07-0a99fc0f35bf.jpg</a></p>
<div class="message_inline_image"><a href="/user_uploads/22008/kSxE6mBK7iNfHL-VOpoEfg-f/41b1ca8f-ae9e-4406-9c07-0a99fc0f35bf.jpg" title="41b1ca8f-ae9e-4406-9c07-0a99fc0f35bf.jpg"><img data-original-dimensions="4080x3072" src="/user_uploads/thumbnail/22008/kSxE6mBK7iNfHL-VOpoEfg-f/41b1ca8f-ae9e-4406-9c07-0a99fc0f35bf.jpg/840x560.webp"></a></div>



<a name="467312231"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/467312231" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#467312231">(Sep 03 2024 at 16:51)</a>:</h4>
<p>I'm assuming this is from a matmul or similar op.</p>



<a name="467505617"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/467505617" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#467505617">(Sep 04 2024 at 11:39)</a>:</h4>
<p>How do I fix a snapshot failure like this? I made a completely unrelated change (as far as I can tell) and now this is failing...</p>
<p><a href="/user_uploads/22008/l4r1zWio-vB2ks22lPf1-gJL/Screenshot-2024-09-04-at-21.39.20.png">Screenshot-2024-09-04-at-21.39.20.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/22008/l4r1zWio-vB2ks22lPf1-gJL/Screenshot-2024-09-04-at-21.39.20.png" title="Screenshot-2024-09-04-at-21.39.20.png"><img data-original-dimensions="1748x752" src="/user_uploads/thumbnail/22008/l4r1zWio-vB2ks22lPf1-gJL/Screenshot-2024-09-04-at-21.39.20.png/840x560.webp"></a></div>



<a name="467505895"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/467505895" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#467505895">(Sep 04 2024 at 11:40)</a>:</h4>
<p>looks like there's a newline at the end of the line in the source file, and maybe it got saved and your editor automatically trimmed it off?</p>



<a name="467506072"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/467506072" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#467506072">(Sep 04 2024 at 11:41)</a>:</h4>
<p>that used to happen to me all the time, but I edited the tests in question to no longer need a trailing newline</p>



<a name="467506179"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/467506179" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#467506179">(Sep 04 2024 at 11:41)</a>:</h4>
<p>Do I modify the error report maybe?</p>



<a name="467506226"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/467506226" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#467506226">(Sep 04 2024 at 11:41)</a>:</h4>
<p>Why would it have a blank space on the end?</p>



<a name="467506626"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/467506626" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#467506626">(Sep 04 2024 at 11:43)</a>:</h4>
<p>Hmm... it shouldn't have one there from what I can tell. </p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="n">alloc</span><span class="p">.</span><span class="n">reflow</span><span class="p">(</span><span class="s">"Tip: Learn more about builtins in the tutorial:</span><span class="se">\n\n</span><span class="s">&lt;https://www.roc-lang.org/tutorial#builtin-modules&gt;"</span><span class="p">),</span>
</code></pre></div>



<a name="467507614"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/467507614" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#467507614">(Sep 04 2024 at 11:47)</a>:</h4>
<p>I think the reflow can put one there based on the terminal width</p>



<a name="467507847"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/467507847" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#467507847">(Sep 04 2024 at 11:48)</a>:</h4>
<p>although I agree that would be strange in this case haha</p>



<a name="467508669"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/467508669" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#467508669">(Sep 04 2024 at 11:51)</a>:</h4>
<p>I'm just going to leave that for now and come back to it later... in the build-host PR / rebuild-platform branch I've managed to remove all references to basic-cli from roc (aside from the scripts for building the website) now.</p>



<a name="467508791"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/467508791" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#467508791">(Sep 04 2024 at 11:52)</a>:</h4>
<p>I've migrated the tests we want to keep onto other test platforms.</p>



<a name="468263631"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/468263631" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#468263631">(Sep 06 2024 at 18:40)</a>:</h4>
<p>Scale of waste is mind boggling to me sometimes. I get the computers are fast, so a company can make a ton of money well also wasting a ton, but it just feels wrong to me.</p>
<blockquote>
<p>15,000 requests/second! That's what I just got out of that $220/month EPYC 48-core hobby box from Hetzner running a basic Rails 8 scaffold MessagesController#show loading a single record from the DB with no caching of any kind. Hot diggity!</p>
</blockquote>
<p>jitted multithreaded ruby using sqlite as a local database... on a modern high end bare metal server with 48 cores.... only getting 15k requests per second.</p>
<p>Basic webserver still has wasted copies and is missing the effect interpreter to enable full async. Yet it can do 120k requests per second on 4 cores of my m1 Mac.</p>
<p>So 30k per core vs 300 per core.</p>
<p>Obviously an apples to oranges comparison to some extent. But the rough scale is real.</p>
<hr>
<p>Related aside: shouldn't ruby have async and await that turns this into just waiting on the network card? Shouldn't this still be able to saturate the network card for something so simple? Is Ruby with rails all blocking io?</p>



<a name="468263884"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/468263884" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#468263884">(Sep 06 2024 at 18:41)</a>:</h4>
<p>My company primarily runs a Ruby on Rails monolith, tell me about it... <span aria-label="smiling face with tear" class="emoji emoji-1f972" role="img" title="smiling face with tear">:smiling_face_with_tear:</span></p>



<a name="468264998"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/468264998" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#468264998">(Sep 06 2024 at 18:46)</a>:</h4>
<p><a href="https://www.wjwh.eu/posts/2020-12-28-ruby-fiber-scheduler-c-extension.html">https://www.wjwh.eu/posts/2020-12-28-ruby-fiber-scheduler-c-extension.html</a></p>



<a name="468265529"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/468265529" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#468265529">(Sep 06 2024 at 18:47)</a>:</h4>
<p>It seems like Ruby 3.0 onwards does async IO automatically, but we run Ruby 2.7 because any company using something so outdated as Rails will avoid the cost of upgrading things whenever possible</p>



<a name="470775816"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/470775816" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eli Dowling <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#470775816">(Sep 16 2024 at 23:48)</a>:</h4>
<p>Hahaha, this is deeply relatable. I just started on a codebase with a few hundred thousand lines of nightmarish PHP. <br>
We have pages that take over 10 seconds to load because they query all 250k users on the database to display a stat.</p>
<p>I can promise you, nobody has any idea how many requests per second we manage.... But I can also promise it ain't good <span aria-label="sweat smile" class="emoji emoji-1f605" role="img" title="sweat smile">:sweat_smile:</span></p>



<a name="471642810"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/471642810" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#471642810">(Sep 20 2024 at 07:17)</a>:</h4>
<p>Does the LLVM Ir </p>
<div class="codehilite"><pre><span></span><code>define void @roc__mainForHost_1_exposed_generic(ptr %0) !dbg !21
</code></pre></div>
<p>Look right for a platform with API?</p>
<div class="codehilite"><pre><span></span><code>mainForHost : Str -&gt; Str
</code></pre></div>



<a name="471642905"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/471642905" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#471642905">(Sep 20 2024 at 07:18)</a>:</h4>
<p>That would take a RocStr and mutate it right?</p>



<a name="471710968"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/471710968" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#471710968">(Sep 20 2024 at 12:07)</a>:</h4>
<p>No, I think we would take two pointers for that</p>



<a name="473000400"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/473000400" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ayaz Hafiz <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#473000400">(Sep 27 2024 at 02:07)</a>:</h4>
<p>How does <code>try</code>/<code>?</code> work? Is this a correct desugar?</p>
<div class="codehilite"><pre><span></span><code>y = try x
y + 1
</code></pre></div>
<div class="codehilite"><pre><span></span><code>when x is
  Error e -&gt; Error e
  Ok y -&gt; y + 1
</code></pre></div>
<p>or does it wrap the continuation in the Ok constructor?</p>



<a name="473000432"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/473000432" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#473000432">(Sep 27 2024 at 02:07)</a>:</h4>
<p>We're going with <code>return</code></p>



<a name="473000511"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/473000511" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#473000511">(Sep 27 2024 at 02:08)</a>:</h4>
<div class="codehilite" data-code-language="Elm"><pre><span></span><code><span class="nv">when</span><span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="nv">is</span>
<span class="w">    </span><span class="kt">Err</span><span class="w"> </span><span class="nv">e</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="nv">return</span><span class="w"> </span><span class="kt">Err</span><span class="w"> </span><span class="nv">e</span>
<span class="w">    </span><span class="kt">Ok</span><span class="w"> </span><span class="nv">y</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">        </span><span class="nv">y</span><span class="w"> </span><span class="nf">+</span><span class="mi">1</span>
</code></pre></div>



<a name="473000513"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/473000513" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ayaz Hafiz <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#473000513">(Sep 27 2024 at 02:08)</a>:</h4>
<p>kk thanks</p>



<a name="473000545"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/473000545" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#473000545">(Sep 27 2024 at 02:09)</a>:</h4>
<p>This works with the continuation monad well</p>



<a name="473000679"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/473000679" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#473000679">(Sep 27 2024 at 02:10)</a>:</h4>
<p>Returning early from the continuation will return to the parent function's return value immediately, since the parent function doesn't do anything after calling the continuation</p>



<a name="473000680"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/473000680" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#473000680">(Sep 27 2024 at 02:10)</a>:</h4>
<p>It all just fits together</p>



<a name="473002250"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/473002250" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ayaz Hafiz <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#473002250">(Sep 27 2024 at 02:28)</a>:</h4>
<p>sorry I'm not sure I follow that piece</p>



<a name="473002312"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/473002312" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ayaz Hafiz <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#473002312">(Sep 27 2024 at 02:29)</a>:</h4>
<p>wouldn't the early return immediately pass the result value to the next continuation in the chain? if you return to the parent function wouldn't that break the sequence of continuations?</p>



<a name="477318684"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/477318684" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#477318684">(Oct 16 2024 at 23:28)</a>:</h4>
<p>Is <code>zstd</code> a dependency for using a roc nightly on intel macos? I'm trying to setup a GH runner and it's given me an error like</p>
<div class="codehilite"><pre><span></span><code>dyld[4651]: Library not loaded: /usr/local/opt/zstd/lib/libzstd.1.dylib
  Referenced from: &lt;4E33E9A3-ECE7-3A94-90F3-D55423A81AF9&gt; /Users/runner/work/roc-ray/roc-ray/roc_nightly/roc
  Reason: tried: &#39;/usr/local/opt/zstd/lib/libzstd.1.dylib&#39; (no such file), &#39;/System/Volumes/Preboot/Cryptexes/OS/usr/local/opt/zstd/lib/libzstd.1.dylib&#39; (no such file), &#39;/usr/local/opt/zstd/lib/libzstd.1.dylib&#39; (no such file), &#39;/usr/local/lib/libzstd.1.dylib&#39; (no such file), &#39;/usr/lib/libzstd.1.dylib&#39; (no such file, not in dyld cache)
/Users/runner/work/_temp/97a43c70-cd5c-446e-a653-669d45f49f87.sh: line 1:  4651 Abort trap: 6           ./roc_nightly/roc version
</code></pre></div>
<p>Trying different things to resolve it. Just noticed nothing about it in our Getting Started guide <a href="https://www.roc-lang.org/install/macos_x86_64">https://www.roc-lang.org/install/macos_x86_64</a></p>



<a name="477319577"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/477319577" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#477319577">(Oct 16 2024 at 23:37)</a>:</h4>
<p>I think so: <a href="https://github.com/roc-lang/roc/pull/7008">https://github.com/roc-lang/roc/pull/7008</a></p>



<a name="477320165"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/477320165" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#477320165">(Oct 16 2024 at 23:44)</a>:</h4>
<p>hm... that doesn't appear to have helped</p>



<a name="477320182"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/477320182" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#477320182">(Oct 16 2024 at 23:44)</a>:</h4>
<div class="codehilite"><pre><span></span><code>Run ./roc_nightly/roc version

dyld[2644]: Library not loaded: /usr/local/opt/zstd/lib/libzstd.1.dylib
  Referenced from: &lt;4E33E9A3-ECE7-3A94-90F3-D55423A81AF9&gt; /Users/runner/work/roc-ray/roc-ray/roc_nightly/roc
  Reason: tried: &#39;/usr/local/opt/zstd/lib/libzstd.1.dylib&#39; (no such file), &#39;/System/Volumes/Preboot/Cryptexes/OS/usr/local/opt/zstd/lib/libzstd.1.dylib&#39; (no such file), &#39;/usr/local/opt/zstd/lib/libzstd.1.dylib&#39; (no such file), &#39;/usr/local/lib/libzstd.1.dylib&#39; (no such file), &#39;/usr/lib/libzstd.1.dylib&#39; (no such file, not in dyld cache)
/Users/runner/work/_temp/e7c7fbc1-dcab-4aba-8b61-ee456c77d93c.sh: line 1:  2644 Abort trap: 6           ./roc_nightly/roc version
</code></pre></div>



<a name="477321103"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/477321103" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#477321103">(Oct 16 2024 at 23:55)</a>:</h4>
<p>Yeah I goofed up... got confused between Arm64 and x64 <span aria-label="sweat smile" class="emoji emoji-1f605" role="img" title="sweat smile">:sweat_smile:</span></p>



<a name="483612882"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/483612882" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#483612882">(Nov 21 2024 at 03:54)</a>:</h4>
<p>I think we've managed to break the <code>--no-link</code> build pipeline sometime recently... I used to be able to do this.</p>
<div class="codehilite"><pre><span></span><code> $ roc build --no-link --emit-llvm-ir examples/simple.roc
Legacy linking failed: Failed to find any legacy linking files; I need one of these three paths to exist:
    examples/../platform/macos-arm64.a
    examples/../platform/macos-arm64.o
    examples/../platform/libhost.a
</code></pre></div>



<a name="483612922"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/483612922" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#483612922">(Nov 21 2024 at 03:55)</a>:</h4>
<p>I didn't think this was --rebuild-host PR... but that's probably the most likely candidate</p>



<a name="483614179"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/483614179" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#483614179">(Nov 21 2024 at 04:10)</a>:</h4>
<p>Yeah. No link should turn off all the host stuff</p>



<a name="483614190"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/483614190" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#483614190">(Nov 21 2024 at 04:10)</a>:</h4>
<p>Almost certainly the rebuild host pr</p>



<a name="483619861"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/483619861" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#483619861">(Nov 21 2024 at 05:25)</a>:</h4>
<p>PR to fix this<br>
<a href="https://github.com/roc-lang/roc/pull/7236">https://github.com/roc-lang/roc/pull/7236</a></p>



<a name="483829065"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/483829065" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#483829065">(Nov 22 2024 at 03:20)</a>:</h4>
<p>QQ: Is there any particular reason why there are two phases to canonicalization? (desugaring, and then conversion to can::Expr/etc)</p>



<a name="483829425"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/483829425" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#483829425">(Nov 22 2024 at 03:24)</a>:</h4>
<p>I'm wondering if it'd be crazy to try to combine those...</p>



<a name="483829571"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/483829571" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#483829571">(Nov 22 2024 at 03:26)</a>:</h4>
<p>There's a comment on this already</p>



<a name="483829604"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/483829604" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#483829604">(Nov 22 2024 at 03:27)</a>:</h4>
<p><a href="https://github.com/roc-lang/roc/blob/22423ca98bef41e2f55ae54e11c632bd0610c241/crates/compiler/can/src/module.rs#L265">https://github.com/roc-lang/roc/blob/22423ca98bef41e2f55ae54e11c632bd0610c241/crates/compiler/can/src/module.rs#L265</a></p>



<a name="483829647"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/483829647" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#483829647">(Nov 22 2024 at 03:27)</a>:</h4>
<p>Oho well that sounds very fixable</p>



<a name="483829686"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/483829686" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#483829686">(Nov 22 2024 at 03:28)</a>:</h4>
<p>I've wanted to move precedence/associativity handling into the parser anyway</p>



<a name="483835648"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/483835648" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#483835648">(Nov 22 2024 at 04:38)</a>:</h4>
<p>If you can do that cleanly, I think that's a good improvement!</p>



<a name="483838371"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/483838371" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#483838371">(Nov 22 2024 at 05:09)</a>:</h4>
<p>ooo, using <a href="https://matklad.github.io/2020/04/13/simple-but-powerful-pratt-parsing.html">Pratt parsing</a>? <span aria-label="smiley" class="emoji emoji-1f603" role="img" title="smiley">:smiley:</span></p>



<a name="483840720"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/483840720" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#483840720">(Nov 22 2024 at 05:40)</a>:</h4>
<blockquote>
<p>Not only does it send your mind into Möbeus-shaped hamster wheel, it also handles associativity and precedence!</p>
</blockquote>
<p><span aria-label="zany face" class="emoji emoji-1f92a" role="img" title="zany face">:zany_face:</span></p>



<a name="483841045"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/483841045" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#483841045">(Nov 22 2024 at 05:44)</a>:</h4>
<p>Yeah that looks roughly right</p>



<a name="483841108"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/483841108" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#483841108">(Nov 22 2024 at 05:45)</a>:</h4>
<p>I've written basically that ~5 times now. Every time I need to either look up how exactly it's done, and/or spend hours debugging.</p>



<a name="483841117"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/483841117" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#483841117">(Nov 22 2024 at 05:45)</a>:</h4>
<p>Mobeus-shaped hamster wheel indeed</p>



<a name="483873455"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/483873455" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#483873455">(Nov 22 2024 at 09:49)</a>:</h4>
<blockquote>
<p>send your mind into Möbeus-shaped hamster wheel</p>
</blockquote>
<blockquote>
<p>spend hours debugging</p>
</blockquote>
<p>That does not sound like something we want <span aria-label="big smile" class="emoji emoji-1f604" role="img" title="big smile">:big_smile:</span></p>



<a name="483931341"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/483931341" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#483931341">(Nov 22 2024 at 15:12)</a>:</h4>
<p>Well the great thing is that once it works you never have to touch it again</p>



<a name="483944360"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/483944360" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#483944360">(Nov 22 2024 at 16:16)</a>:</h4>
<p>it's basically the gold standard for how to efficiently resolve precedence without needing a separate pass later, and lots of compilers use it</p>



<a name="483945939"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/483945939" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#483945939">(Nov 22 2024 at 16:24)</a>:</h4>
<p>Or .... Just have simple precedence that is easy to parse like uiua.</p>



<a name="483945978"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/483945978" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#483945978">(Nov 22 2024 at 16:24)</a>:</h4>
<p>Not a real suggestion if you want your language to read normal</p>



<a name="483946077"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/483946077" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#483946077">(Nov 22 2024 at 16:25)</a>:</h4>
<p>But it does point to how bad binary ops and precedence are</p>



<a name="483951938"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/483951938" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#483951938">(Nov 22 2024 at 16:56)</a>:</h4>
<p>In my own language I was working on, I didn't have bin/unary ops and let the user decide the precedence through function call.  Was that principal or laziness?  I'll let you make the call</p>



<a name="485438679"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/485438679" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#485438679">(Dec 01 2024 at 02:13)</a>:</h4>
<p>fiiiiiiinally<br>
<a href="/user_uploads/22008/VbzkNTbGcD2h5-JFdJe5P0Rh/Screenshot-2024-11-30-at-9.12.36PM.png">Screenshot 2024-11-30 at 9.12.36 PM.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/22008/VbzkNTbGcD2h5-JFdJe5P0Rh/Screenshot-2024-11-30-at-9.12.36PM.png" title="Screenshot 2024-11-30 at 9.12.36 PM.png"><img data-original-dimensions="884x1776" src="/user_uploads/thumbnail/22008/VbzkNTbGcD2h5-JFdJe5P0Rh/Screenshot-2024-11-30-at-9.12.36PM.png/840x560.webp"></a></div>



<a name="485438692"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/485438692" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#485438692">(Dec 01 2024 at 02:13)</a>:</h4>
<p>We have DOCS!!!!</p>



<a name="485438696"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/485438696" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#485438696">(Dec 01 2024 at 02:13)</a>:</h4>
<p>I need a bunch of cleanup before it's ready for a PR, but it actually works end to end now</p>



<a name="485438804"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/485438804" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#485438804">(Dec 01 2024 at 02:15)</a>:</h4>
<p>(for those who haven't been following along, this resolves the extremely longstanding issue where if you expose a type alias of a type from another module - such as <code>Http.Request : InternalHttp.Request</code> in this example) it would render as nothing - which is why the <a href="https://www.roc-lang.org/packages/basic-cli/Http">Http docs today</a> are not very helpful <span aria-label="sweat smile" class="emoji emoji-1f605" role="img" title="sweat smile">:sweat_smile:</span></p>



<a name="485443699"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/485443699" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Isaac Van Doren <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#485443699">(Dec 01 2024 at 03:40)</a>:</h4>
<p>Great! <span aria-label="star struck" class="emoji emoji-1f929" role="img" title="star struck">:star_struck:</span></p>



<a name="485547497"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/485547497" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eli Dowling <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#485547497">(Dec 02 2024 at 05:17)</a>:</h4>
<p>Hey, would anyone a little more familiar with the inner workings of the compiler be able to suggest how I could get types for the tag completions I just added to the language server?<br>
Currently I get the tag names from the subs <code>tag_names</code> field</p>
<p>Initially as an experiment I just tried to brute force it by iterating every variable entry in the current module subs looking for Tags<br>
But that approach didn't seem to find many of the tags that exist in <code>tag_names</code></p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="w"> </span><span class="n">subs</span><span class="p">.</span><span class="n">variables</span>
<span class="w">                </span><span class="p">.</span><span class="n">iter</span><span class="p">()</span>
<span class="w">                </span><span class="p">.</span><span class="n">flat_map</span><span class="p">(</span><span class="o">|</span><span class="n">var1</span><span class="o">|</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="kd">let</span><span class="w"> </span><span class="n">res</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">subs2</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">var1</span><span class="p">.</span><span class="n">clone</span><span class="p">()).</span><span class="n">content</span><span class="p">.</span><span class="n">clone</span><span class="p">();</span>
<span class="w">                    </span><span class="k">match</span><span class="w"> </span><span class="n">res</span><span class="w"> </span><span class="p">{</span>
<span class="w">                        </span><span class="n">Content</span><span class="p">::</span><span class="n">Structure</span><span class="p">(</span><span class="n">structure</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n">structure</span><span class="w"> </span><span class="p">{</span>
<span class="w">                            </span><span class="n">FlatType</span><span class="p">::</span><span class="n">FunctionOrTagUnion</span><span class="p">(</span><span class="n">names</span><span class="p">,</span><span class="w"> </span><span class="n">_</span><span class="p">,</span><span class="w"> </span><span class="n">ext</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">                                </span><span class="kd">let</span><span class="w"> </span><span class="n">res</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">subs</span><span class="p">.</span><span class="n">get_subs_slice</span><span class="p">(</span><span class="n">names</span><span class="p">).</span><span class="n">iter</span><span class="p">().</span><span class="n">filter_map</span><span class="p">(</span><span class="o">|</span><span class="p">(</span><span class="n">label</span><span class="p">)</span><span class="o">|</span><span class="w"> </span><span class="p">{</span>
<span class="w">                                    </span><span class="k">if</span><span class="w"> </span><span class="n">label</span><span class="p">.</span><span class="n">as_ident_str</span><span class="p">().</span><span class="n">starts_with</span><span class="p">(</span><span class="n">prefix</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                                        </span><span class="c1">// let type_str = SubsFmtFlatType()</span>
<span class="w">                                        </span><span class="nb">Some</span><span class="p">(</span><span class="n">CompletionItem</span><span class="w"> </span><span class="p">{</span>
<span class="w">                                            </span><span class="n">label</span><span class="p">:</span><span class="w"> </span><span class="nc">label</span><span class="p">.</span><span class="n">as_ident_str</span><span class="p">().</span><span class="n">to_string</span><span class="p">(),</span>
<span class="w">                                            </span><span class="n">kind</span><span class="p">:</span><span class="w"> </span><span class="nb">Some</span><span class="p">(</span><span class="n">CompletionItemKind</span><span class="p">::</span><span class="n">ENUM</span><span class="p">),</span>
<span class="w">                                            </span><span class="n">documentation</span><span class="p">:</span><span class="w"> </span><span class="nb">Some</span><span class="p">(</span><span class="n">lsp_types</span><span class="p">::</span><span class="n">Documentation</span><span class="p">::</span><span class="nb">String</span><span class="p">(</span>
<span class="w">                                                </span><span class="n">format_var_type</span><span class="p">(</span>
<span class="w">                                                    </span><span class="n">ext</span><span class="p">.</span><span class="n">var</span><span class="p">(),</span>
<span class="w">                                                    </span><span class="o">&amp;</span><span class="k">mut</span><span class="w"> </span><span class="n">subs2</span><span class="p">,</span>
<span class="w">                                                    </span><span class="n">module_id</span><span class="p">,</span>
<span class="w">                                                    </span><span class="n">interns</span><span class="p">,</span>
<span class="w">                                                </span><span class="p">),</span>
<span class="w">                                            </span><span class="p">)),</span>
<span class="w">                                            </span><span class="o">..</span><span class="nb">Default</span><span class="p">::</span><span class="n">default</span><span class="p">()</span>
<span class="w">                                        </span><span class="p">})</span>
<span class="w">                                    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">                                        </span><span class="nb">None</span>
<span class="w">                                    </span><span class="p">}</span>
<span class="w">                                </span><span class="p">});</span>
<span class="w">                                </span><span class="n">res</span><span class="p">.</span><span class="n">collect</span><span class="p">()</span>
<span class="w">                            </span><span class="p">}</span>
<span class="w">                            </span><span class="n">FlatType</span><span class="p">::</span><span class="n">TagUnion</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">ext</span><span class="p">)</span>
<span class="w">                            </span><span class="o">|</span><span class="w"> </span><span class="n">FlatType</span><span class="p">::</span><span class="n">RecursiveTagUnion</span><span class="p">(</span><span class="n">_</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">ext</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">                                </span><span class="kd">let</span><span class="w"> </span><span class="n">res</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">name</span><span class="p">.</span><span class="n">iter_from_subs</span><span class="p">(</span><span class="o">&amp;</span><span class="n">subs</span><span class="p">).</span><span class="n">filter_map</span><span class="p">(</span><span class="o">|</span><span class="p">(</span><span class="n">label</span><span class="p">,</span><span class="w"> </span><span class="n">var</span><span class="p">)</span><span class="o">|</span><span class="w"> </span><span class="p">{</span>
<span class="w">                                    </span><span class="k">if</span><span class="w"> </span><span class="n">label</span><span class="p">.</span><span class="n">as_ident_str</span><span class="p">().</span><span class="n">starts_with</span><span class="p">(</span><span class="n">prefix</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                                        </span><span class="c1">// let type_str = SubsFmtFlatType()</span>
<span class="w">                                        </span><span class="nb">Some</span><span class="p">(</span><span class="n">CompletionItem</span><span class="w"> </span><span class="p">{</span>
<span class="w">                                            </span><span class="n">label</span><span class="p">:</span><span class="w"> </span><span class="nc">label</span><span class="p">.</span><span class="n">as_ident_str</span><span class="p">().</span><span class="n">to_string</span><span class="p">(),</span>
<span class="w">                                            </span><span class="n">kind</span><span class="p">:</span><span class="w"> </span><span class="nb">Some</span><span class="p">(</span><span class="n">CompletionItemKind</span><span class="p">::</span><span class="n">ENUM</span><span class="p">),</span>
<span class="w">                                            </span><span class="n">documentation</span><span class="p">:</span><span class="w"> </span><span class="nb">Some</span><span class="p">(</span><span class="n">lsp_types</span><span class="p">::</span><span class="n">Documentation</span><span class="p">::</span><span class="nb">String</span><span class="p">(</span>
<span class="w">                                                </span><span class="n">format_var_type</span><span class="p">(</span>
<span class="w">                                                    </span><span class="n">ext</span><span class="p">.</span><span class="n">var</span><span class="p">(),</span>
<span class="w">                                                    </span><span class="o">&amp;</span><span class="k">mut</span><span class="w"> </span><span class="n">subs2</span><span class="p">,</span>
<span class="w">                                                    </span><span class="n">module_id</span><span class="p">,</span>
<span class="w">                                                    </span><span class="n">interns</span><span class="p">,</span>
<span class="w">                                                </span><span class="p">),</span>
<span class="w">                                            </span><span class="p">)),</span>
<span class="w">                                            </span><span class="o">..</span><span class="nb">Default</span><span class="p">::</span><span class="n">default</span><span class="p">()</span>
<span class="w">                                        </span><span class="p">})</span>
<span class="w">                                    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">                                        </span><span class="nb">None</span>
<span class="w">                                    </span><span class="p">}</span>
<span class="w">                                </span><span class="p">});</span>
<span class="w">                                </span><span class="n">res</span><span class="p">.</span><span class="n">collect</span><span class="p">()</span>
<span class="w">                            </span><span class="p">}</span>
<span class="w">                            </span><span class="n">_</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="fm">vec!</span><span class="p">[],</span>
<span class="w">                        </span><span class="p">},</span>

<span class="w">                        </span><span class="n">_</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="fm">vec!</span><span class="p">[],</span>
<span class="w">                    </span><span class="p">}</span>
<span class="w">                </span><span class="p">})</span>
<span class="w">                </span><span class="p">.</span><span class="n">collect</span><span class="p">::</span><span class="o">&lt;</span><span class="nb">Vec</span><span class="o">&lt;</span><span class="n">_</span><span class="o">&gt;&gt;</span><span class="p">()</span><span class="w"> </span><span class="c1">//we have to collect so that we can release the lock</span>
</code></pre></div>
<p>How can I go from tag_names to types? or maybe where should I add in the compiler some way of saving the tag unions that exist so i can use them later in the completion?</p>



<a name="488749259"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/488749259" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#488749259">(Dec 13 2024 at 01:40)</a>:</h4>
<p>If you see this error</p>
<div class="codehilite"><pre><span></span><code>Please file an issue here: &lt;https://github.com/roc-lang/roc/issues/new/choose&gt;
Invalid decimal for float literal = 1e10. This should be a type error!
Location: crates/compiler/mono/src/ir/literal.rs:115:25
</code></pre></div>
<p>Is this in dev-backend... or a Can related issue?</p>



<a name="488750027"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/488750027" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#488750027">(Dec 13 2024 at 01:49)</a>:</h4>
<p>inbetween the two in mono</p>



<a name="488750117"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/488750117" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#488750117">(Dec 13 2024 at 01:50)</a>:</h4>
<p>rocdec from str failed</p>



<a name="488750122"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/488750122" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#488750122">(Dec 13 2024 at 01:50)</a>:</h4>
<p>it doesn't understand <code>e</code> I guess</p>



<a name="489040575"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/489040575" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#489040575">(Dec 15 2024 at 01:03)</a>:</h4>
<p>Apparently my new version of the false interpreter found a bug in drop specialization.</p>



<a name="489040586"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/489040586" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#489040586">(Dec 15 2024 at 01:03)</a>:</h4>
<p>Failing in a debug assert</p>



<a name="489040649"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/489040649" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#489040649">(Dec 15 2024 at 01:04)</a>:</h4>
<p>I was hoping to just update and land this change quickly, not to round about debug a bunch of things due to the update (I guess it at least proves the value of having false interpreter as a test case)</p>



<a name="489041882"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/489041882" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#489041882">(Dec 15 2024 at 01:25)</a>:</h4>
<p><span class="user-mention" data-user-id="463199">@J.Teeuwissen</span> any chance you can look at <a href="https://github.com/roc-lang/roc/actions/runs/12334298533/job/34424325103?pr=7369">the failure here</a>?</p>
<p>It is a debug assert being hit in drop specialization. Can be reproed on the <a href="https://github.com/roc-lang/roc/tree/fix-false">fix-false branch</a> on any target with <code>cargo test -p roc_cli -- false_</code></p>



<a name="489078599"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/489078599" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> J.Teeuwissen <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#489078599">(Dec 15 2024 at 12:01)</a>:</h4>
<p><span class="user-mention silent" data-user-id="343810">Brendan Hansknecht</span> <a href="#narrow/channel/395097-compiler-development/topic/casual.20conversation/near/489041882">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="463199">J.Teeuwissen</span> any chance you can look at <a href="https://github.com/roc-lang/roc/actions/runs/12334298533/job/34424325103?pr=7369">the failure here</a>?</p>
<p>It is a debug assert being hit in drop specialization. Can be reproed on the <a href="https://github.com/roc-lang/roc/tree/fix-false">fix-false branch</a> on any target with <code>cargo test -p roc_cli -- false_</code></p>
</blockquote>
<p>Opened pr that should fix this specific issue: <a href="https://github.com/roc-lang/roc/pull/7376">https://github.com/roc-lang/roc/pull/7376</a><br>
I haven't touched Roc in a while, i suggest checking/testing the changes thoroughly ;)</p>



<a name="489865752"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/489865752" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#489865752">(Dec 19 2024 at 00:31)</a>:</h4>
<p>Does this error message mean anything to anyone? for context, it's a <a href="https://github.com/roc-lang/basic-cli/actions/runs/12403271262/job/34626411898">CI failure</a> in basic-cli after upgrading hyper and removing "ring" and replacing with "aws-lc-sys"  crate. Only failing in macOS-13 -- passes everywhere else.</p>
<div class="codehilite"><pre><span></span><code>cargo:warning=In file included from /Users/runner/.cargo/registry/src/index.crates.io-6f17d22bba15001f/aws-lc-sys-0.24.0/aws-lc/crypto/fipsmodule/bcm.c:150:
  cargo:warning=In file included from /Users/runner/.cargo/registry/src/index.crates.io-6f17d22bba15001f/aws-lc-sys-0.24.0/aws-lc/crypto/fipsmodule/rand/urandom.c:69:
  cargo:warning=/nix/store/hmchx96ysd0h19p7kx0w12pljkbp30j3-Libsystem-1238.60.2/include/CommonCrypto/CommonRandom.h:35:9: error: unknown type name &#39;CCCryptorStatus&#39;
  cargo:warning=typedef CCCryptorStatus CCRNGStatus;
  cargo:warning=        ^
  cargo:warning=In file included from /Users/runner/.cargo/registry/src/index.crates.io-6f17d22bba15001f/aws-lc-sys-0.24.0/aws-lc/crypto/fipsmodule/bcm.c:150:
  cargo:warning=/Users/runner/.cargo/registry/src/index.crates.io-6f17d22bba15001f/aws-lc-sys-0.24.0/aws-lc/crypto/fipsmodule/rand/urandom.c:394:42: error: use of undeclared identifier &#39;kCCSuccess&#39;
  cargo:warning=  if (CCRandomGenerateBytes(out, len) == kCCSuccess) {
  cargo:warning=                                         ^
  cargo:warning=2 errors generated.
</code></pre></div>



<a name="489865867"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/489865867" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#489865867">(Dec 19 2024 at 00:32)</a>:</h4>
<p>I tried adding <code>CoreFoundation</code> do the nix flake... but that didn't help</p>
<div class="codehilite" data-code-language="Nix"><pre><span></span><code><span class="ss">darwinInputs</span> <span class="o">=</span> <span class="k">with</span> pkgs<span class="p">;</span>
    lib<span class="o">.</span>optionals stdenv<span class="o">.</span>isDarwin
    <span class="p">(</span><span class="k">with</span> pkgs<span class="o">.</span>darwin<span class="o">.</span>apple_sdk<span class="o">.</span>frameworks<span class="p">;</span> <span class="p">[</span>
        Security
        CoreFoundation
    <span class="p">]);</span>
</code></pre></div>



<a name="489866035"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/489866035" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#489866035">(Dec 19 2024 at 00:34)</a>:</h4>
<p>It's part of libsystem...that feels relevant...but not really sure</p>



<a name="489866148"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/489866148" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#489866148">(Dec 19 2024 at 00:35)</a>:</h4>
<p>Also, looks to be part of libc in rust? <a href="https://concoct-rs.github.io/viewbuilder/libc/type.CCRNGStatus.html">https://concoct-rs.github.io/viewbuilder/libc/type.CCRNGStatus.html</a></p>



<a name="491142067"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491142067" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Notification Bot <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491142067">(Dec 29 2024 at 03:33)</a>:</h4>
<p>37 messages were moved from this topic to <a class="stream-topic" data-stream-id="395097" href="/#narrow/channel/395097-compiler-development/topic/bug.3A.20Outstanding.20references.20to.20the.20derived.20module">#compiler development &gt; bug: Outstanding references to the derived module</a> by <span class="user-mention silent" data-user-id="515757">Luke Boswell</span>.</p>



<a name="491204734"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491204734" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491204734">(Dec 29 2024 at 20:26)</a>:</h4>
<p>Do we have a syntax for extending a union twice:</p>
<p>I have</p>
<div class="codehilite"><pre><span></span><code>Tag1: [A]
Tag2: [B]
</code></pre></div>
<p>I want the sum of those two and <code>C</code><br>
So:</p>
<div class="codehilite"><pre><span></span><code>Tag3: [C]Tag1,Tag2
</code></pre></div>
<p>But that is invalid syntax. Do we have a way to do this?</p>



<a name="491204874"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491204874" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ayaz Hafiz <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491204874">(Dec 29 2024 at 20:28)</a>:</h4>
<p>Maybe <code>([C]Tag1)Tag2</code>?</p>



<a name="491205356"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491205356" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491205356">(Dec 29 2024 at 20:35)</a>:</h4>
<p>Looks like that probably should work but we parse it wrong:</p>
<div class="codehilite"><pre><span></span><code>── INVALID_EXTENSION_TYPE in examples/../platform/Sqlite.roc ───────────────────

This record extension type is invalid:

50│  Tag3 : ([C]Tag1)Tag2
                     ^^^^

Note: A record extension variable can only contain a type variable or
another record.


── INVALID_EXTENSION_TYPE in examples/../platform/Sqlite.roc ───────────────────

This tag union extension type is invalid:

50│  Tag3 : ([C]Tag1)Tag2
                ^^^^

Note: A tag union extension variable can only contain a type variable
or another tag union.
</code></pre></div>



<a name="491205407"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491205407" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491205407">(Dec 29 2024 at 20:36)</a>:</h4>
<p>Note that the first error is a <code>record</code> extension</p>



<a name="491207353"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491207353" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491207353">(Dec 29 2024 at 21:08)</a>:</h4>
<p>I thought I saw someone was proposing a spread type syntax for this?</p>



<a name="491207743"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491207743" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491207743">(Dec 29 2024 at 21:14)</a>:</h4>
<p>There is. Just needs to be implemented.</p>



<a name="491207749"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491207749" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491207749">(Dec 29 2024 at 21:14)</a>:</h4>
<p>Was wondering if something works today.</p>



<a name="491216444"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491216444" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491216444">(Dec 29 2024 at 23:39)</a>:</h4>
<p>Is anyone interested to review <span class="user-mention" data-user-id="453336">@Joshua Warner</span>'s PR <a href="https://github.com/roc-lang/roc/pull/7431">https://github.com/roc-lang/roc/pull/7431</a></p>
<blockquote>
<p>This is a fairly significant refactor, where we introduce a strongly-normalizing intermediate representation from which we actually generate the output in the formatter.</p>
</blockquote>



<a name="491216546"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491216546" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491216546">(Dec 29 2024 at 23:40)</a>:</h4>
<p>I think his idea is good and any potential (unforeseen negative) impact limited to the formatter.</p>



<a name="491223879"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491223879" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491223879">(Dec 30 2024 at 01:38)</a>:</h4>
<p>Oh…..</p>



<a name="491223882"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491223882" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491223882">(Dec 30 2024 at 01:38)</a>:</h4>
<p><span aria-label="melting face" class="emoji emoji-1fae0" role="img" title="melting face">:melting_face:</span></p>



<a name="491223904"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491223904" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491223904">(Dec 30 2024 at 01:38)</a>:</h4>
<p>I feel like half of my PNC change is going up in smoke <span aria-label="laughing" class="emoji emoji-1f606" role="img" title="laughing">:laughing:</span></p>



<a name="491224175"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491224175" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491224175">(Dec 30 2024 at 01:42)</a>:</h4>
<p>And this is what I was working on right now</p>



<a name="491224293"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491224293" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491224293">(Dec 30 2024 at 01:44)</a>:</h4>
<p>But more seriously I wish this design could work well with some sort of line width constraints (if it does and I missed it somehow i apologize), me and Richard were talking about that for better formatting of docs code blocks than what we have today</p>



<a name="491224463"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491224463" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491224463">(Dec 30 2024 at 01:47)</a>:</h4>
<p>I think I just need to talk to Joshua about this</p>



<a name="491228171"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491228171" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491228171">(Dec 30 2024 at 02:42)</a>:</h4>
<blockquote>
<p>I wish this design could work well with some sort of line width constraints</p>
</blockquote>
<p>Yep, this has been on my mind</p>



<a name="491228217"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491228217" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491228217">(Dec 30 2024 at 02:43)</a>:</h4>
<p>When I've floated that previously (and seen it discussed separately), I think Richard has been somewhat against it</p>



<a name="491228312"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491228312" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491228312">(Dec 30 2024 at 02:44)</a>:</h4>
<p>There's probably a happy medium where there aren't dramatic changes from how things operate today, but line-length constraints / adjustments really only operate on the fringes / fix up some of the edge cases</p>



<a name="491228352"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491228352" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491228352">(Dec 30 2024 at 02:45)</a>:</h4>
<blockquote>
<p>I feel like half of my PNC change is going up in smoke</p>
</blockquote>
<p>Oh noes! I definitely didn't intend to interfere.</p>



<a name="491228417"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491228417" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491228417">(Dec 30 2024 at 02:46)</a>:</h4>
<p>I think we'd want line length constraints that can be applied to type signatures for docs generation, but otherwise are ignored</p>



<a name="491228424"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491228424" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491228424">(Dec 30 2024 at 02:46)</a>:</h4>
<p>yeah exactly <span aria-label="point up" class="emoji emoji-1f446" role="img" title="point up">:point_up:</span></p>



<a name="491228449"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491228449" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491228449">(Dec 30 2024 at 02:47)</a>:</h4>
<p>in other words, have the line width be configurable, and have <code>roc format</code> set it to infinity, but set it to different numbers when generating docs</p>



<a name="491228477"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491228477" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491228477">(Dec 30 2024 at 02:47)</a>:</h4>
<p>Because line length constraints in code just tend to force awkward breaking up of lines that need to be longer than the arbitrary limit</p>



<a name="491228740"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491228740" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491228740">(Dec 30 2024 at 02:51)</a>:</h4>
<p>FWIW for normal formatting, I've been thinking of experimenting with soft line _width_ constraints rather than line length constraints - i.e. not counting indentation against you</p>



<a name="491228820"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491228820" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491228820">(Dec 30 2024 at 02:52)</a>:</h4>
<p>That avoids some kinds of awkward breaking when code is at a high indent level</p>



<a name="491229002"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491229002" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491229002">(Dec 30 2024 at 02:55)</a>:</h4>
<p>That also happens to be somewhat easier to implement</p>



<a name="491229109"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491229109" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491229109">(Dec 30 2024 at 02:56)</a>:</h4>
<p>Thinking about the docs use-case a bit more, a few things come to mind:</p>



<a name="491229159"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491229159" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491229159">(Dec 30 2024 at 02:57)</a>:</h4>
<ul>
<li>Is one fixed limit for docs actually sufficient? Is it really ideal for docs to have the same width regardless of the width of the browser window?</li>
</ul>



<a name="491229239"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491229239" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491229239">(Dec 30 2024 at 02:58)</a>:</h4>
<ul>
<li>What if the user is on mobile? I'm not sure how practical / helpful that is - but having that look nice when someone's reading the tutorial on their phone after having clicked a hackernews link sounds good.</li>
</ul>



<a name="491229482"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491229482" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491229482">(Dec 30 2024 at 03:02)</a>:</h4>
<p>The "simple" solution of just having everything authored to fit a reasonably narrow viewport (i.e. manually insert newlines to force multi-line representations in the formatter) feels not _terrible_.</p>



<a name="491229559"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491229559" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491229559">(Dec 30 2024 at 03:02)</a>:</h4>
<p>The big thing that tends to blow line length limits accidentally in roc code would be comments, and I don't know if there's an easy solution for that.</p>



<a name="491229562"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491229562" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491229562">(Dec 30 2024 at 03:02)</a>:</h4>
<p>Currently, the type signatures in docs have a max width about 600px wide even on really wide screens. So type signatures can get narrower than that, but are pretty much the same size on desktop and most mobile views</p>



<a name="491229616"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491229616" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491229616">(Dec 30 2024 at 03:03)</a>:</h4>
<p>Why are type signatures special here?</p>



<a name="491229674"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491229674" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491229674">(Dec 30 2024 at 03:04)</a>:</h4>
<p>Because that's the thing we display in docs</p>



<a name="491229691"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491229691" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491229691">(Dec 30 2024 at 03:04)</a>:</h4>
<p>Besides code examples, which I wouldn't expect to get special formatting</p>



<a name="491229702"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491229702" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491229702">(Dec 30 2024 at 03:04)</a>:</h4>
<p>I'd just have those have <code>horizontal-scroll: auto</code></p>



<a name="491229894"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491229894" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491229894">(Dec 30 2024 at 03:06)</a>:</h4>
<p>On formatting comments: since doc comments are markdown, any group of lines that doesn't have an empty line between its lines can be treated as a giant, single line and wrapped based on the word lengths. But I think normal comments just need to be left as-is</p>



<a name="491230011"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491230011" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491230011">(Dec 30 2024 at 03:08)</a>:</h4>
<p>And why not just do line wrapping in the browser?</p>



<a name="491230023"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491230023" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491230023">(Dec 30 2024 at 03:08)</a>:</h4>
<p>I mean, just let the browser do that</p>



<a name="491230029"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491230029" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491230029">(Dec 30 2024 at 03:08)</a>:</h4>
<p>That seems not terrible?</p>



<a name="491230134"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491230134" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491230134">(Dec 30 2024 at 03:10)</a>:</h4>
<p>It may look a little weird if there's a very long type decl, but it'll copy-paste just fine</p>



<a name="491230318"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491230318" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491230318">(Dec 30 2024 at 03:12)</a>:</h4>
<p>For function types, we do let the browser do line wrapping after forcing multilining on long types</p>



<a name="491230340"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491230340" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491230340">(Dec 30 2024 at 03:13)</a>:</h4>
<p>I think it would be less readable if we didn't force multilining</p>



<a name="491230364"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491230364" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491230364">(Dec 30 2024 at 03:13)</a>:</h4>
<p>A good way to see this is to compare <code>List.walk</code> in the search results vs. its main section in the <code>List</code> module</p>



<a name="491230495"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491230495" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491230495">(Dec 30 2024 at 03:15)</a>:</h4>
<p>Or maybe <code>List.walkFrom</code>:</p>
<div class="codehilite" data-code-language="Elm"><pre><span></span><code><span class="nv">walkFrom</span><span class="w"> </span><span class="nf">:</span>
<span class="w">    </span><span class="kt">List</span><span class="w"> </span><span class="nv">elem</span><span class="p">,</span>
<span class="w">    </span><span class="kt">U64</span><span class="p">,</span>
<span class="w">    </span><span class="nv">state</span><span class="p">,</span>
<span class="w">    </span><span class="p">(</span><span class="nv">state</span><span class="p">,</span><span class="w"> </span><span class="nv">elem</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="nv">state</span><span class="p">)</span>
<span class="w">    </span><span class="nf">-&gt;</span><span class="w"> </span><span class="nv">state</span>
</code></pre></div>
<p>vs.</p>
<div class="codehilite" data-code-language="Elm"><pre><span></span><code><span class="nv">walkFrom</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">List</span><span class="w"> </span><span class="nv">elem</span><span class="p">,</span><span class="w"> </span><span class="kt">U64</span><span class="p">,</span><span class="w"> </span><span class="nv">state</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="nv">state</span><span class="p">,</span><span class="w"> </span><span class="nv">elem</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="nv">state</span><span class="p">)</span>
<span class="w">    </span><span class="nf">-&gt;</span><span class="w"> </span><span class="nv">state</span>
</code></pre></div>



<a name="491230632"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491230632" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491230632">(Dec 30 2024 at 03:17)</a>:</h4>
<p>Or on a small width, <code>List.walkFromUntil</code>:</p>
<div class="codehilite" data-code-language="Elm"><pre><span></span><code><span class="kt">List</span><span class="nf">.</span><span class="nv">walkFromUntil</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">List</span><span class="w"> </span><span class="nv">elem</span><span class="p">,</span><span class="w"> </span><span class="kt">U64</span><span class="p">,</span><span class="w"> </span><span class="nv">state</span><span class="p">,</span>
<span class="w">    </span><span class="p">(</span><span class="nv">state</span><span class="p">,</span><span class="w"> </span><span class="nv">elem</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="kt">Continue</span><span class="w"> </span><span class="nv">state</span><span class="p">,</span><span class="w"> </span><span class="kt">Break</span>
<span class="w">    </span><span class="nv">state</span><span class="w"> </span><span class="p">])</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="nv">state</span>
</code></pre></div>



<a name="491230649"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491230649" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491230649">(Dec 30 2024 at 03:17)</a>:</h4>
<p>It's <em>fine</em>, but I think were better with proper multilining</p>



<a name="491230763"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491230763" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491230763">(Dec 30 2024 at 03:18)</a>:</h4>
<p>But don’t those same reasons also apply to the source code?</p>



<a name="491230780"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491230780" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491230780">(Dec 30 2024 at 03:19)</a>:</h4>
<p>Why is the developer ok with that super long type in the source but not ok when it’s in docs?</p>



<a name="491231008"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491231008" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491231008">(Dec 30 2024 at 03:22)</a>:</h4>
<p>Because the developer can decide to break up a long def with a newline. Just putting a newline in the middle will make Roc multiline it for you</p>



<a name="491231020"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491231020" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491231020">(Dec 30 2024 at 03:22)</a>:</h4>
<p>But you can also decide to leave it more legible as a single line</p>



<a name="491231041"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491231041" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491231041">(Dec 30 2024 at 03:22)</a>:</h4>
<p>This lets people choose for themselves in wide display environments how to display their signatures</p>



<a name="491231048"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491231048" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491231048">(Dec 30 2024 at 03:23)</a>:</h4>
<p>But the docs online are always narrow</p>



<a name="491231088"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491231088" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491231088">(Dec 30 2024 at 03:23)</a>:</h4>
<p>So keeping them in a single line and autowrapping leads to potentially many <code>List.walkFromUntil</code>s</p>



<a name="491231138"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491231138" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491231138">(Dec 30 2024 at 03:24)</a>:</h4>
<p>I personally don't feel that strongly about this, I don't think it matters that much</p>



<a name="491279126"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491279126" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491279126">(Dec 30 2024 at 12:54)</a>:</h4>
<p>I think I agree with your logic there, but to me it more strongly indicates the formatting should adapt to the viewport in all situations where that’s possible.</p>



<a name="491279390"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491279390" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491279390">(Dec 30 2024 at 12:57)</a>:</h4>
<p>Eg in the editor with LSP, it would ideally be possible to do a “view-only” reformat or something, where the on-disk version has longer lines</p>



<a name="491279530"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491279530" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491279530">(Dec 30 2024 at 12:59)</a>:</h4>
<p>Or maybe this is done at ‘git checkout’ time: code is formatted to your preference when checked out, and formatted back to some generic standard when committed. Pretty sure hooks for that sort of thing do already exist.</p>



<a name="491285226"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491285226" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491285226">(Dec 30 2024 at 13:57)</a>:</h4>
<p><span class="user-mention silent" data-user-id="453336">Joshua Warner</span> <a href="#narrow/stream/395097-compiler-development/topic/casual.20conversation/near/491279126">said</a>:</p>
<blockquote>
<p>I think I agree with your logic there, but to me it more strongly indicates the formatting should adapt to the viewport in all situations where that’s possible.</p>
</blockquote>
<p>I understand in theory, but having spent years with formatters that do and don't enforce line width, I've found that the line width enforcement is frequently annoying and almost never helpful.</p>



<a name="491285389"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491285389" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491285389">(Dec 30 2024 at 13:58)</a>:</h4>
<p>for example, sometimes I have two lines that are doing things that are very similar, and will be easier to understand if they are side by side and formatted the same way - so the similarities between them are visually obvious - but one happens to call functions with slightly longer names, causing the formatter to make it multiline.</p>



<a name="491285559"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491285559" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491285559">(Dec 30 2024 at 14:00)</a>:</h4>
<p>I've wasted a bunch of time trying to coax line-width-enforcing formatters to not make my code harder to read, and I've wasted zero time doing that with formatters that don't enforce it</p>



<a name="491285761"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491285761" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491285761">(Dec 30 2024 at 14:02)</a>:</h4>
<p>the difference is that when there is a hard width cap, like in types in docs, if there's going to be wrapping anyway, it's better if we can apply a wrapping algorithm that looks nicer than the browser default of just word wrapping without taking into account indentation, whether an entire type should now render as multiline, etc <span aria-label="big smile" class="emoji emoji-1f604" role="img" title="big smile">:big_smile:</span></p>



<a name="491286202"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491286202" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491286202">(Dec 30 2024 at 14:06)</a>:</h4>
<p>I think we're mostly agreeing :)</p>



<a name="491286721"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491286721" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491286721">(Dec 30 2024 at 14:11)</a>:</h4>
<p>The same view-width logic applies to my editor (I run it full screen and I'm not reducing the font size - so it's not getting any wider). I would love my editor to have nicer line wrapping behavior that's guided by a language server. Or alternatively, an easy git config to format my code to some line limit on checkout (supposing it's somehow perfectly invertable).</p>
<p>The practical difference there is in difficulty. Docs (in theory) have one width across all users. Editor config is often unique-ish for each user.</p>



<a name="491286863"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491286863" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491286863">(Dec 30 2024 at 14:12)</a>:</h4>
<p>I would add tho that many times I've come across a docs site that looked silly because of how much it restricted the content width, and I've gone into the browser inspector and removed that width constraint while I read.</p>



<a name="491286881"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491286881" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491286881">(Dec 30 2024 at 14:12)</a>:</h4>
<p>(which is to say, I would push back a bit on the notion that 600px is great for everyone)</p>



<a name="491286939"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491286939" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491286939">(Dec 30 2024 at 14:13)</a>:</h4>
<p>Here's an idea: ship the formatter as a wasm binary in the browser that will dynamically re-format lines to match whatever the real display width is :)</p>



<a name="491292065"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491292065" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491292065">(Dec 30 2024 at 15:01)</a>:</h4>
<p>oh I was thinking we'd pick a few different breakpoints and render each of them</p>



<a name="491292089"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491292089" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491292089">(Dec 30 2024 at 15:01)</a>:</h4>
<p>then CSS could hide all but one of them depending on browser width</p>



<a name="491292282"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491292282" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491292282">(Dec 30 2024 at 15:03)</a>:</h4>
<p>Interesting!</p>



<a name="491292317"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491292317" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491292317">(Dec 30 2024 at 15:03)</a>:</h4>
<p>That's definitely lighter-weight, in terms of what we ship to the browser, so probably better.</p>



<a name="491292328"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491292328" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491292328">(Dec 30 2024 at 15:03)</a>:</h4>
<p>Not as much fun tho :)</p>



<a name="491292406"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491292406" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491292406">(Dec 30 2024 at 15:04)</a>:</h4>
<p>(I like it!)</p>



<a name="491292453"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491292453" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491292453">(Dec 30 2024 at 15:04)</a>:</h4>
<p>Deliciously constrained</p>



<a name="491295193"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491295193" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491295193">(Dec 30 2024 at 15:28)</a>:</h4>
<p>Ok, anyway, with that in mind: yes, I think this "Node" refactor for the formatter that I've been working on could be updated to (optionally) do line-length limits</p>



<a name="491295250"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491295250" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491295250">(Dec 30 2024 at 15:29)</a>:</h4>
<p>That's not high on my priority list right now, but happy to provide some guidance if someone else wanted to tackle that</p>



<a name="491305490"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491305490" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491305490">(Dec 30 2024 at 17:00)</a>:</h4>
<p>that's awesome! <span aria-label="smiley" class="emoji emoji-1f603" role="img" title="smiley">:smiley:</span></p>



<a name="491382784"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491382784" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jasper Woudenberg <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491382784">(Dec 31 2024 at 09:02)</a>:</h4>
<p>I'm working on migrating my blog to the Roc-based static site generator I'm working on. I was doing some styling and trying to figure out the best approach to display code snippets on mobile.</p>
<p>Rewriting the code snippets to have very short line widths is one approach. The thing is, while that means you don't have to scroll horizontally anymore, I think it creates a different flavor of poor readability where even simple expressions need to be broken across multiple lines.</p>
<p>One approach that I'm wondering if others have tried before (haven't ran into this myself): Suppose code snippets on mobile are replaced with an icon, that when pressed open the snippet full screen, in landscape mode. The user presses the code example, flips their phone, then only needs to scroll vertically.</p>
<p>In a brief experiment, I get a line width of about 65 characters with reasonble fontsize that way. I believe 50-70 characters or about 10 words per line is considered about ideal for readability of regular text, so if main-body width is around 50-70 characters on a big screen, then 65-character wide examples will look great on the big screen too, at least typographically speaking.</p>
<p>Plus, if we can have a simple rule like "code examples should have a max linewidth of 65", and the result is the code is readable _and_ looks like same across different screen sizes, that creates a pretty nice experience writing code examples, because what-you-see-is-what-you-get.</p>



<a name="491847088"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491847088" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491847088">(Jan 04 2025 at 05:09)</a>:</h4>
<p>Interested to know if anyone has any ideas what could be causing this bug? </p>
<p><a href="https://github.com/roc-lang/roc/issues/7461">https://github.com/roc-lang/roc/issues/7461</a></p>



<a name="491847101"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491847101" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491847101">(Jan 04 2025 at 05:09)</a>:</h4>
<p>I've been trying to isolate it and make a minimal repro. Been hacking code out and deleting things.</p>



<a name="491847343"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491847343" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491847343">(Jan 04 2025 at 05:13)</a>:</h4>
<p>It's not related to the platform at all... this is just the package and compiler</p>



<a name="491847695"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491847695" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491847695">(Jan 04 2025 at 05:19)</a>:</h4>
<p>I found even more code to cull out... it's pretty small now</p>



<a name="491848129"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491848129" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491848129">(Jan 04 2025 at 05:27)</a>:</h4>
<p>Down to 1 file <span aria-label="tada" class="emoji emoji-1f389" role="img" title="tada">:tada:</span></p>



<a name="491885085"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491885085" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491885085">(Jan 04 2025 at 15:24)</a>:</h4>
<p>I assume this line was meant to be removed before merging a PR: <a href="https://github.com/roc-lang/roc/blame/main/crates/compiler/fmt/src/def.rs#L434">https://github.com/roc-lang/roc/blame/main/crates/compiler/fmt/src/def.rs#L434</a></p>
<p>cc: <span class="user-mention" data-user-id="781658">@Anthony Bullard</span></p>



<a name="491885106"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491885106" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491885106">(Jan 04 2025 at 15:25)</a>:</h4>
<p>Was really confused when I formated a file and it became:</p>
<div class="codehilite"><pre><span></span><code>WTF???
WTF???
app [main] { pf: platform &quot;platform/main.roc&quot; }

...
</code></pre></div>



<a name="491885139"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491885139" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491885139">(Jan 04 2025 at 15:25)</a>:</h4>
<p>Hah, I had that too :)</p>



<a name="491885240"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491885240" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491885240">(Jan 04 2025 at 15:26)</a>:</h4>
<p>Yes, I have a PR to remove</p>



<a name="491885246"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491885246" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491885246">(Jan 04 2025 at 15:27)</a>:</h4>
<p>I'm so sorry</p>



<a name="491885265"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491885265" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491885265">(Jan 04 2025 at 15:27)</a>:</h4>
<p>I thought someone would catch it in code review</p>



<a name="491885267"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491885267" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491885267">(Jan 04 2025 at 15:27)</a>:</h4>
<p>Because I obviously missed it</p>



<a name="491885276"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491885276" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491885276">(Jan 04 2025 at 15:27)</a>:</h4>
<p><a href="https://github.com/roc-lang/roc/pull/7464">https://github.com/roc-lang/roc/pull/7464</a></p>



<a name="491885355"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491885355" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491885355">(Jan 04 2025 at 15:28)</a>:</h4>
<p>The Ubuntu fuzzer is my enemy</p>



<a name="491885369"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491885369" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491885369">(Jan 04 2025 at 15:28)</a>:</h4>
<p>We probably should just force a merge and worry about the fuzzing issue separately</p>



<a name="491885380"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491885380" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491885380">(Jan 04 2025 at 15:28)</a>:</h4>
<p>Clearly removing the println is correct</p>



<a name="491885417"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491885417" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491885417">(Jan 04 2025 at 15:29)</a>:</h4>
<p>For some reason I keep hitting it</p>



<a name="491885514"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491885514" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491885514">(Jan 04 2025 at 15:30)</a>:</h4>
<p>If you have the perms to force merge, feel free</p>



<a name="491885561"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491885561" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491885561">(Jan 04 2025 at 15:31)</a>:</h4>
<p>cc: <span class="user-mention" data-user-id="453336">@Joshua Warner</span> Another fuzzing failure: <a href="https://github.com/roc-lang/roc/actions/runs/12610505189/job/35147114059">https://github.com/roc-lang/roc/actions/runs/12610505189/job/35147114059</a></p>



<a name="491885597"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491885597" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491885597">(Jan 04 2025 at 15:31)</a>:</h4>
<p>Not sure if it is a new regression that slipped in or something older that just took a while for the fuzzer to happen upon.</p>



<a name="491885788"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491885788" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491885788">(Jan 04 2025 at 15:34)</a>:</h4>
<p>I'd like to get the crash report and debug myself</p>



<a name="491885792"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491885792" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491885792">(Jan 04 2025 at 15:35)</a>:</h4>
<p>Since it <em>may</em> have come from the PNC change</p>



<a name="491885834"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491885834" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491885834">(Jan 04 2025 at 15:35)</a>:</h4>
<p>Also did we meant to always allow this kind of syntax?</p>
<div class="codehilite" data-code-language="Elm"><pre><span></span><code><span class="p">{</span>
<span class="w">    </span><span class="nv">some_field</span><span class="err">?</span>
<span class="w">    </span><span class="s">"""</span>
<span class="s">    """</span><span class="p">,</span>
<span class="p">}</span>
</code></pre></div>



<a name="491885876"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491885876" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491885876">(Jan 04 2025 at 15:36)</a>:</h4>
<p>To destructure an optional?</p>



<a name="491885919"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491885919" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491885919">(Jan 04 2025 at 15:36)</a>:</h4>
<p>I don't see why that wouldn't work as silly as it looks</p>



<a name="491885960"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491885960" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491885960">(Jan 04 2025 at 15:37)</a>:</h4>
<p>Ok, then I have to figure out why my change to <code>??</code> doesn't like</p>
<div class="codehilite"><pre><span></span><code>{
    some_field??
    &quot;&quot;&quot;
    &quot;&quot;&quot;,
}
</code></pre></div>



<a name="491886014"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491886014" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491886014">(Jan 04 2025 at 15:38)</a>:</h4>
<p>Might be PNC. failing input: <code>((@Y)@Y)((@Y)@Y)</code></p>



<a name="491886061"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491886061" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491886061">(Jan 04 2025 at 15:39)</a>:</h4>
<p>Formats to <code>(@Y) @Y((@Y) @Y)</code> which is a different ast</p>



<a name="491886086"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491886086" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491886086">(Jan 04 2025 at 15:39)</a>:</h4>
<p>So yeah, probably a new failure case</p>



<a name="491886186"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491886186" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491886186">(Jan 04 2025 at 15:41)</a>:</h4>
<p><span class="user-mention" data-user-id="343810">@Brendan Hansknecht</span> You mean for the new fuzzer bug?</p>



<a name="491886272"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491886272" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491886272">(Jan 04 2025 at 15:42)</a>:</h4>
<p>This is hard to parse for my human eyes</p>



<a name="491886430"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491886430" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491886430">(Jan 04 2025 at 15:44)</a>:</h4>
<p>I would think this should be a PNC apply with the result of the whitespace application of <code>@Y @Y</code> as the func and then result of the whitespace application of <code>@Y @Y</code> as the first arg, so just <code>(@Y @Y)(@Y @Y)</code></p>



<a name="491886488"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491886488" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491886488">(Jan 04 2025 at 15:45)</a>:</h4>
<p>Of after migration to PNC <code>(@Y(@Y))(@Y(@Y))</code></p>



<a name="491886613"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491886613" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491886613">(Jan 04 2025 at 15:47)</a>:</h4>
<p>Minimization is <code>((Y)Y)()</code></p>



<a name="491886808"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491886808" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491886808">(Jan 04 2025 at 15:50)</a>:</h4>
<p><code>(Y Y)()</code> or migrated <code>(Y(Y))()</code> should be the formatted</p>



<a name="491887283"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491887283" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491887283">(Jan 04 2025 at 15:57)</a>:</h4>
<p>Just a formatting error, parses correctly. I’ll put the fix in with my current PR</p>



<a name="491901634"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491901634" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491901634">(Jan 04 2025 at 19:27)</a>:</h4>
<p>I have a fix for this.  It was super simple</p>



<a name="491905489"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491905489" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491905489">(Jan 04 2025 at 20:28)</a>:</h4>
<p><a href="https://github.com/roc-lang/roc/pull/7467">https://github.com/roc-lang/roc/pull/7467</a></p>



<a name="491927922"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491927922" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491927922">(Jan 05 2025 at 02:29)</a>:</h4>
<p>Can someone try repro this bug for me? </p>
<p><a href="https://github.com/roc-lang/roc/issues/7461#issuecomment-2571475674">https://github.com/roc-lang/roc/issues/7461#issuecomment-2571475674</a></p>



<a name="491927927"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491927927" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491927927">(Jan 05 2025 at 02:29)</a>:</h4>
<p>Just copy that file and </p>
<div class="codehilite"><pre><span></span><code>$ cargo run -- test bug.roc
</code></pre></div>



<a name="491927933"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491927933" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491927933">(Jan 05 2025 at 02:29)</a>:</h4>
<p>Sam hasn't been able to repro</p>



<a name="491928159"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491928159" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491928159">(Jan 05 2025 at 02:33)</a>:</h4>
<p>I’ll try in a few</p>



<a name="491928519"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491928519" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491928519">(Jan 05 2025 at 02:39)</a>:</h4>
<p><span class="user-mention" data-user-id="515757">@Luke Boswell</span> Repro'd on my m1 mac:</p>
<div class="codehilite"><pre><span></span><code>❯ RUST_BACKTRACE=1 ../roc/target/debug/roc test bug.roc
thread &#39;main&#39; panicked at crates/compiler/mono/src/reset_reuse.rs:1244:42:
Expected symbol to have a layout. It should have been inserted in the environment already.
stack backtrace:
   0: rust_begin_unwind
             at /rustc/25ef9e3d85d934b27d9dada2f9dd52b1dc63bb04/library/std/src/panicking.rs:647:5
   1: core::panicking::panic_fmt
             at /rustc/25ef9e3d85d934b27d9dada2f9dd52b1dc63bb04/library/core/src/panicking.rs:72:14
   2: core::panicking::panic_display
             at /rustc/25ef9e3d85d934b27d9dada2f9dd52b1dc63bb04/library/core/src/panicking.rs:196:5
   3: core::panicking::panic_str
             at /rustc/25ef9e3d85d934b27d9dada2f9dd52b1dc63bb04/library/core/src/panicking.rs:171:5
   4: core::option::expect_failed
             at /rustc/25ef9e3d85d934b27d9dada2f9dd52b1dc63bb04/library/core/src/option.rs:1988:5
   5: expect&lt;&amp;roc_mono::reset_reuse::LayoutOption&gt;
             at /rustc/25ef9e3d85d934b27d9dada2f9dd52b1dc63bb04/library/core/src/option.rs:894:21
   6: get_symbol_layout
             at /Users/anthonybullard/Development/roc/crates/compiler/mono/src/reset_reuse.rs:1244:9
   7: insert_reset_reuse_operations_stmt
             at /Users/anthonybullard/Development/roc/crates/compiler/mono/src/reset_reuse.rs:444:41
   8: insert_reset_reuse_operations_stmt
             at /Users/anthonybullard/Development/roc/crates/compiler/mono/src/reset_reuse.rs:516:36
   9: insert_reset_reuse_operations_stmt
             at /Users/anthonybullard/Development/roc/crates/compiler/mono/src/reset_reuse.rs:213:36
  10: insert_reset_reuse_operations_stmt
             at /Users/anthonybullard/Development/roc/crates/compiler/mono/src/reset_reuse.rs:516:36
  11: insert_reset_reuse_operations_stmt
             at /Users/anthonybullard/Development/roc/crates/compiler/mono/src/reset_reuse.rs:757:39
  12: insert_reset_reuse_operations_stmt
             at /Users/anthonybullard/Development/roc/crates/compiler/mono/src/reset_reuse.rs:516:36
  13: insert_reset_reuse_operations_stmt
             at /Users/anthonybullard/Development/roc/crates/compiler/mono/src/reset_reuse.rs:757:39
  14: insert_reset_reuse_operations_stmt
             at /Users/anthonybullard/Development/roc/crates/compiler/mono/src/reset_reuse.rs:516:36
  15: insert_reset_reuse_operations_stmt
             at /Users/anthonybullard/Development/roc/crates/compiler/mono/src/reset_reuse.rs:516:36
  16: insert_reset_reuse_operations_stmt
             at /Users/anthonybullard/Development/roc/crates/compiler/mono/src/reset_reuse.rs:213:36
  17: insert_reset_reuse_operations_stmt
             at /Users/anthonybullard/Development/roc/crates/compiler/mono/src/reset_reuse.rs:516:36
  18: insert_reset_reuse_operations_stmt
             at /Users/anthonybullard/Development/roc/crates/compiler/mono/src/reset_reuse.rs:213:36
  19: insert_reset_reuse_operations_proc
             at /Users/anthonybullard/Development/roc/crates/compiler/mono/src/reset_reuse.rs:82:20
  20: insert_reset_reuse_operations
             at /Users/anthonybullard/Development/roc/crates/compiler/mono/src/reset_reuse.rs:44:24
  21: update
             at /Users/anthonybullard/Development/roc/crates/compiler/load_internal/src/file.rs:2921:21
  22: state_thread_step
             at /Users/anthonybullard/Development/roc/crates/compiler/load_internal/src/file.rs:1765:25
  23: {closure#1}
             at /Users/anthonybullard/Development/roc/crates/compiler/load_internal/src/file.rs:2104:23
  24: {closure#0}&lt;roc_load_internal::file::load_multi_threaded::{closure_env#1}, core::result::Result&lt;roc_load_internal::file::LoadResult, roc_load_internal::file::LoadingProblem&gt;&gt;
             at /Users/anthonybullard/.cargo/registry/src/index.crates.io-6f17d22bba15001f/crossbeam-utils-0.8.16/src/thread.rs:163:65
  25: call_once&lt;core::result::Result&lt;roc_load_internal::file::LoadResult, roc_load_internal::file::LoadingProblem&gt;, crossbeam_utils::thread::scope::{closure_env#0}&lt;roc_load_internal::file::load_multi_threaded::{closure_env#1}, core::result::Result&lt;roc_load_internal::file::LoadResult, roc_load_internal::file::LoadingProblem&gt;&gt;&gt;
             at /rustc/25ef9e3d85d934b27d9dada2f9dd52b1dc63bb04/library/core/src/panic/unwind_safe.rs:272:9
  26: do_call&lt;core::panic::unwind_safe::AssertUnwindSafe&lt;crossbeam_utils::thread::scope::{closure_env#0}&lt;roc_load_internal::file::load_multi_threaded::{closure_env#1}, core::result::Result&lt;roc_load_internal::file::LoadResult, roc_load_internal::file::LoadingProblem&gt;&gt;&gt;, core::result::Result&lt;roc_load_internal::file::LoadResult, roc_load_internal::file::LoadingProblem&gt;&gt;
             at /rustc/25ef9e3d85d934b27d9dada2f9dd52b1dc63bb04/library/std/src/panicking.rs:554:40
  27: ___rust_try
  28: try&lt;core::result::Result&lt;roc_load_internal::file::LoadResult, roc_load_internal::file::LoadingProblem&gt;, core::panic::unwind_safe::AssertUnwindSafe&lt;crossbeam_utils::thread::scope::{closure_env#0}&lt;roc_load_internal::file::load_multi_threaded::{closure_env#1}, core::result::Result&lt;roc_load_internal::file::LoadResult, roc_load_internal::file::LoadingProblem&gt;&gt;&gt;&gt;
             at /rustc/25ef9e3d85d934b27d9dada2f9dd52b1dc63bb04/library/std/src/panicking.rs:518:19
  29: catch_unwind&lt;core::panic::unwind_safe::AssertUnwindSafe&lt;crossbeam_utils::thread::scope::{closure_env#0}&lt;roc_load_internal::file::load_multi_threaded::{closure_env#1}, core::result::Result&lt;roc_load_internal::file::LoadResult, roc_load_internal::file::LoadingProblem&gt;&gt;&gt;, core::result::Result&lt;roc_load_internal::file::LoadResult, roc_load_internal::file::LoadingProblem&gt;&gt;
             at /rustc/25ef9e3d85d934b27d9dada2f9dd52b1dc63bb04/library/std/src/panic.rs:142:14
  30: scope&lt;roc_load_internal::file::load_multi_threaded::{closure_env#1}, core::result::Result&lt;roc_load_internal::file::LoadResult, roc_load_internal::file::LoadingProblem&gt;&gt;
             at /Users/anthonybullard/.cargo/registry/src/index.crates.io-6f17d22bba15001f/crossbeam-utils-0.8.16/src/thread.rs:163:18
  31: load_multi_threaded
             at /Users/anthonybullard/Development/roc/crates/compiler/load_internal/src/file.rs:2040:29
  32: load
             at /Users/anthonybullard/Development/roc/crates/compiler/load_internal/src/file.rs:1550:35
  33: load
             at /Users/anthonybullard/Development/roc/crates/compiler/load/src/lib.rs:39:5
  34: load_and_monomorphize
             at /Users/anthonybullard/Development/roc/crates/compiler/load/src/lib.rs:143:11
  35: test
             at /Users/anthonybullard/Development/roc/crates/cli/src/lib.rs:586:27
  36: main
             at /Users/anthonybullard/Development/roc/crates/cli/src/main.rs:83:17
  37: call_once&lt;fn() -&gt; core::result::Result&lt;(), std::io::error::Error&gt;, ()&gt;
             at /rustc/25ef9e3d85d934b27d9dada2f9dd52b1dc63bb04/library/core/src/ops/function.rs:250:5
note: Some details are omitted, run with `RUST_BACKTRACE=full` for a verbose backtrace.
</code></pre></div>



<a name="491928580"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491928580" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491928580">(Jan 05 2025 at 02:40)</a>:</h4>
<p>Ok, good to know... maybe it's only on Mac somehow. <span class="user-mention" data-user-id="461444">@Sam Mohr</span> must have been using a linux machine</p>



<a name="491928626"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491928626" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491928626">(Jan 05 2025 at 02:41)</a>:</h4>
<p>Maybe add a format! in that expect and see what the symbol is</p>



<a name="491928634"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491928634" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491928634">(Jan 05 2025 at 02:41)</a>:</h4>
<p>That's not getting a layout inserted</p>



<a name="491928684"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491928684" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491928684">(Jan 05 2025 at 02:42)</a>:</h4>
<p>&lt;-- <em>Does not know anything about mono</em></p>



<a name="491928689"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491928689" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491928689">(Jan 05 2025 at 02:42)</a>:</h4>
<p>Yea've I've tried that. It doesn't give me much more info. I'm not sure how to get any more detail than just a symbol number</p>



<a name="491928699"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491928699" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491928699">(Jan 05 2025 at 02:42)</a>:</h4>
<p>Are the symbols interned?</p>



<a name="491928728"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491928728" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491928728">(Jan 05 2025 at 02:43)</a>:</h4>
<p>Looks like it, there's a MutSet of them</p>



<a name="491928730"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491928730" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491928730">(Jan 05 2025 at 02:43)</a>:</h4>
<p>Adding a <code>format!</code> in there I can get</p>
<div class="codehilite"><pre><span></span><code>thread &#39;main&#39; panicked at crates/compiler/mono/src/reset_reuse.rs:1244:42:
Expected symbol `bug.60` to have a layout. It should have been inserted in the environment already.
note: run with `RUST_BACKTRACE=1` environment variable to display a backtrace
</code></pre></div>



<a name="491928736"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491928736" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491928736">(Jan 05 2025 at 02:43)</a>:</h4>
<p>Maybe print that out as well</p>



<a name="491928838"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491928838" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491928838">(Jan 05 2025 at 02:44)</a>:</h4>
<p>Actually that's not useful</p>



<a name="491929044"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491929044" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491929044">(Jan 05 2025 at 02:48)</a>:</h4>
<p>This part of the compiler is harder for me to follow... it's like peering into the dark</p>



<a name="491929156"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491929156" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491929156">(Jan 05 2025 at 02:50)</a>:</h4>
<p>You could instrument all of the calls to <code>Symbol::new</code> and see what kind of thing goes in, and the symbol that comes out</p>



<a name="491929182"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491929182" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491929182">(Jan 05 2025 at 02:51)</a>:</h4>
<p>But this looks like something for Brendan to chew on much more effectively</p>



<a name="491929190"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491929190" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491929190">(Jan 05 2025 at 02:51)</a>:</h4>
<p>It's so easy for it to go away too</p>



<a name="491929473"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491929473" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491929473">(Jan 05 2025 at 02:57)</a>:</h4>
<p>Yep, I was on Linux</p>



<a name="491931890"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491931890" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491931890">(Jan 05 2025 at 03:45)</a>:</h4>
<p>I want to force merge: <a href="https://github.com/roc-lang/roc/pull/7466">https://github.com/roc-lang/roc/pull/7466</a></p>
<p>It just updates the benchmarks to PI, PNC, and snake_case.</p>
<p>It is failing for 2 reasons:</p>
<ol>
<li>fuzzer is failing (definitely not caused by this PR)</li>
<li>The benchmark job is failing due to nQueens. That said, looking at the perf overall, I think we should merge it. Mostly perf is a wash. 2 examples are 3% faster. nQueens regressed by 1.5%. Feels mostly to be noise.</li>
</ol>
<p>any concerns?</p>



<a name="491932288"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491932288" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491932288">(Jan 05 2025 at 03:53)</a>:</h4>
<p>Sounds good to me <span aria-label="+1" class="emoji emoji-1f44d" role="img" title="+1">:+1:</span></p>



<a name="491933064"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/491933064" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#491933064">(Jan 05 2025 at 04:08)</a>:</h4>
<p>merged! <span aria-label="boom" class="emoji emoji-1f4a5" role="img" title="boom">:boom:</span></p>



<a name="492004682"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492004682" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492004682">(Jan 05 2025 at 22:38)</a>:</h4>
<p>I've got a couple of hours free... I'm going to poke at PR's and CI and try and land a bunch of things.</p>



<a name="492004713"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492004713" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492004713">(Jan 05 2025 at 22:39)</a>:</h4>
<p>I'd like to finish the <code>examples/</code> folder cleanup, and then start on removing <code>Task</code> from the builtins and tests</p>



<a name="492005289"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492005289" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492005289">(Jan 05 2025 at 22:48)</a>:</h4>
<p>You are hot on the trigger Luke!</p>



<a name="492005296"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492005296" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492005296">(Jan 05 2025 at 22:48)</a>:</h4>
<p>I'll have to land these fuzzer fixes on a new PR :-P</p>



<a name="492005350"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492005350" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492005350">(Jan 05 2025 at 22:49)</a>:</h4>
<p>It's a lesser of two evils, we're only going to give ourselves grief trying to keep Task around. The sooner we transition things across we can eliminate a lot of known bugs and rough edges.</p>



<a name="492005370"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492005370" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492005370">(Jan 05 2025 at 22:49)</a>:</h4>
<p>Love it, it's probably for the best</p>



<a name="492005420"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492005420" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492005420">(Jan 05 2025 at 22:50)</a>:</h4>
<p>This part has become larger than I expected</p>



<a name="492011732"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492011732" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492011732">(Jan 06 2025 at 00:34)</a>:</h4>
<p>I have about a 400 file collection of updating almost all idents to snake_case idents</p>



<a name="492011753"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492011753" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492011753">(Jan 06 2025 at 00:34)</a>:</h4>
<p>I have a couple tests left to fix, but we can actually maybe update everything at once</p>



<a name="492011788"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492011788" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492011788">(Jan 06 2025 at 00:35)</a>:</h4>
<p>I don't know if it's worth breaking up into multiple PRs</p>



<a name="492011818"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492011818" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492011818">(Jan 06 2025 at 00:35)</a>:</h4>
<p>Seems difficult to avoid breaking everything</p>



<a name="492011868"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492011868" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492011868">(Jan 06 2025 at 00:36)</a>:</h4>
<p>I guess we could do one builtin module at a time?</p>



<a name="492012920"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492012920" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492012920">(Jan 06 2025 at 00:51)</a>:</h4>
<p>Once I get tests passing, I'll see what I can do to break this up</p>



<a name="492014331"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492014331" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492014331">(Jan 06 2025 at 01:11)</a>:</h4>
<p>I don't follow the logic of breaking it up. Is that to make it easier to roll back?</p>



<a name="492014597"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492014597" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492014597">(Jan 06 2025 at 01:14)</a>:</h4>
<p>I'd rather not break it up, I just read the lack of response as people being unhappy with a big change.</p>



<a name="492014602"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492014602" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492014602">(Jan 06 2025 at 01:14)</a>:</h4>
<p>I was getting in my head.</p>



<a name="492014607"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492014607" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492014607">(Jan 06 2025 at 01:14)</a>:</h4>
<p>I'll keep it as is</p>



<a name="492014621"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492014621" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492014621">(Jan 06 2025 at 01:15)</a>:</h4>
<p>Pull off the band-aid!</p>



<a name="492014641"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492014641" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492014641">(Jan 06 2025 at 01:15)</a>:</h4>
<p>Okay, go team</p>



<a name="492014916"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492014916" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492014916">(Jan 06 2025 at 01:19)</a>:</h4>
<p>Then people can just migrate!</p>



<a name="492014996"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492014996" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492014996">(Jan 06 2025 at 01:20)</a>:</h4>
<p>Some handsome feller added a tool to make it easy</p>



<a name="492015030"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492015030" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492015030">(Jan 06 2025 at 01:20)</a>:</h4>
<p>I think he looks more like Quasimodo, but agree to disagree</p>



<a name="492015191"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492015191" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492015191">(Jan 06 2025 at 01:23)</a>:</h4>
<p><span class="user-mention" data-user-id="461444">@Sam Mohr</span> to clarify, this is basically upgrading all the Builtins to <code>snake_case</code> right? not doing the sneaky Can case change thing in the background?</p>



<a name="492015210"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492015210" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492015210">(Jan 06 2025 at 01:23)</a>:</h4>
<p>Nope, just me manually updating every camelCase ident I found to snake_case</p>



<a name="492015289"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492015289" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492015289">(Jan 06 2025 at 01:24)</a>:</h4>
<p>Some notes:</p>
<ul>
<li>I also changed the default entry point from <code>mainForHost</code> to <code>main_for_host</code></li>
<li>I added parens where easy, but not in all of our string-based tests, that would have been hell</li>
</ul>



<a name="492015294"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492015294" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492015294">(Jan 06 2025 at 01:24)</a>:</h4>
<p>But it does include all the builtins</p>



<a name="492015296"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492015296" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492015296">(Jan 06 2025 at 01:24)</a>:</h4>
<p>Yes</p>



<a name="492015320"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492015320" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492015320">(Jan 06 2025 at 01:25)</a>:</h4>
<p>That's why it's 400 gosh darn files</p>



<a name="492015335"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492015335" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492015335">(Jan 06 2025 at 01:25)</a>:</h4>
<p>It's a bandaid that covers your whole body</p>



<a name="492015511"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492015511" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ian McLerran <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492015511">(Jan 06 2025 at 01:27)</a>:</h4>
<p>I'm all in favor of this as one big bandaid. I want to start migrating my packages to snake case, but hesitant to do so until I can migrate everything all at once.</p>



<a name="492139747"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492139747" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492139747">(Jan 06 2025 at 16:37)</a>:</h4>
<p>Seems like ? is broken with the new PNC change:</p>
<div class="codehilite" data-code-language="Elm"><pre><span></span><code><span class="kn">module</span><span class="w"> </span><span class="err">[]</span>

<span class="nv">println</span><span class="err">!</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Str</span><span class="w"> </span><span class="nf">=&gt;</span><span class="w"> </span><span class="kt">Result</span><span class="w"> </span><span class="p">{}</span><span class="w"> </span><span class="nv">_</span>

<span class="nv">print_something</span><span class="err">!</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nf">\</span><span class="p">{}</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">    </span><span class="nv">println</span><span class="err">!</span><span class="p">(</span><span class="s">"Hello, world!"</span><span class="p">)</span><span class="err">?</span>

<span class="w">    </span><span class="kt">Ok</span><span class="p">({})</span>
</code></pre></div>
<div class="codehilite"><pre><span></span><code>❯ roc check test.roc
── UNKNOWN OPERATOR in test.roc ────────────────────────────────────────────────

This looks like an operator, but it&#39;s not one I recognize!

6│      println!(&quot;Hello, world!&quot;)?
                                 ^

I have no specific suggestion for this operator, see
https://www.roc-lang.org/tutorial#operator-desugaring-table for the
full list of operators in Roc.⏎
</code></pre></div>



<a name="492139997"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492139997" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492139997">(Jan 06 2025 at 16:38)</a>:</h4>
<p>So you are saying it just doesn’t work with PNC?  Or doesn’t work at all</p>



<a name="492140203"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492140203" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492140203">(Jan 06 2025 at 16:39)</a>:</h4>
<p>PNC</p>



<a name="492140215"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492140215" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492140215">(Jan 06 2025 at 16:39)</a>:</h4>
<p>It works with spaces</p>



<a name="492140683"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492140683" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492140683">(Jan 06 2025 at 16:42)</a>:</h4>
<p>This makes sense. The parsing logic for question mark suffixes needs to be moved to the same spot as we’re handling pnc args</p>



<a name="492140983"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492140983" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492140983">(Jan 06 2025 at 16:43)</a>:</h4>
<p>I’ll put that in with my refactor I’m working on right now</p>



<a name="492141050"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492141050" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492141050">(Jan 06 2025 at 16:43)</a>:</h4>
<p>Moving PncApply to its own expr node</p>



<a name="492397008"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492397008" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492397008">(Jan 07 2025 at 22:13)</a>:</h4>
<p>Just upgrading basic-cli... there is only one external dependency on another package. <code>roc-json</code> in one example. </p>
<p>I think we should remove that... well actually move it to the roc-json repo.</p>
<p>This will make future breaking changes easier.</p>



<a name="492397140"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492397140" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492397140">(Jan 07 2025 at 22:14)</a>:</h4>
<p>I agree with this. We can just have an example using <code>roc-json</code> on the website or in <code>examples</code></p>



<a name="492411139"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492411139" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492411139">(Jan 08 2025 at 00:13)</a>:</h4>
<p>Seemingly, the last CI test failure in the <code>snake_case</code> change is that we are failing to generate the docs for <code>basic-cli</code> to host on the website.</p>



<a name="492411156"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492411156" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492411156">(Jan 08 2025 at 00:13)</a>:</h4>
<p>In <code>basic-webserver</code>, we generate and host them in the <code>basic-webserver</code> repo</p>



<a name="492411201"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492411201" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492411201">(Jan 08 2025 at 00:14)</a>:</h4>
<p>But presumably for outdated reasons, we generate the docs for <code>basic-cli</code> in the compiler repo and host them with the main website</p>



<a name="492411261"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492411261" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492411261">(Jan 08 2025 at 00:14)</a>:</h4>
<p>Luke made a good point that this may be something we want because it lets us host multiple versions of the docs</p>



<a name="492411273"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492411273" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492411273">(Jan 08 2025 at 00:14)</a>:</h4>
<p>For an old and a new version of <code>basic-cli</code></p>



<a name="492411325"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492411325" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492411325">(Jan 08 2025 at 00:15)</a>:</h4>
<p>But I think we should just generate the docs for <code>basic-cli</code> in its own repo and host them there, as we do for <code>basic-webserver</code>. Any objections?</p>



<a name="492411652"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492411652" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492411652">(Jan 08 2025 at 00:18)</a>:</h4>
<p>I think we need to figure out a better solution long term, but that works for now</p>



<a name="492411715"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492411715" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492411715">(Jan 08 2025 at 00:18)</a>:</h4>
<p>Yes, to confirm, <code>basic-webserver</code> only <a href="https://github.com/roc-lang/basic-webserver/blob/8c95d6e9d41aa93bc5b7dd205f83dfa721f90b87/README.md?plain=1#L6">hosts docs for main</a>, but <code>basic-cli</code> <a href="https://github.com/roc-lang/basic-cli/blob/2b8b01da7f6e4070e377bb773e629b03c66e31c8/README.md?plain=1#L16">hosts for a few versions</a></p>



<a name="492411962"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492411962" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492411962">(Jan 08 2025 at 00:21)</a>:</h4>
<p>I wonder if we could just commit the html files into the repo under a folder structure... </p>
<div class="codehilite"><pre><span></span><code>www/
- 0.16.0/
- 0.17.0/
</code></pre></div>
<p>I'm not sure if this is compatible with GH pages...</p>



<a name="492411979"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492411979" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492411979">(Jan 08 2025 at 00:21)</a>:</h4>
<p>I think it is compatible</p>



<a name="492411994"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492411994" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492411994">(Jan 08 2025 at 00:21)</a>:</h4>
<p>Then we don't need all the CI magic (and complications) in all the different repos</p>



<a name="492412100"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492412100" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492412100">(Jan 08 2025 at 00:22)</a>:</h4>
<p>It's a bit handraulic, when making a release, but brain dead simple and easy to manage.</p>



<a name="492412106"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492412106" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492412106">(Jan 08 2025 at 00:22)</a>:</h4>
<p>We'd want some script to make that process easier</p>



<a name="492412159"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492412159" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492412159">(Jan 08 2025 at 00:23)</a>:</h4>
<p>Do we want to block updating Roc by changing this process, or are we okay with just stealing the <code>basic-webserver</code> code for now and doing that later?</p>



<a name="492412380"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492412380" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492412380">(Jan 08 2025 at 00:25)</a>:</h4>
<p>Can we test the idea in something else like weaver or roc-json?</p>



<a name="492412500"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492412500" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492412500">(Jan 08 2025 at 00:26)</a>:</h4>
<p>If it's reliable to host the static site versions this way, I'd lean towards removing the build stuff from roc's CI and just point at the basic-cli repo docs like webserver</p>



<a name="492412654"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492412654" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492412654">(Jan 08 2025 at 00:28)</a>:</h4>
<p><a href="https://github.com/roc-lang/basic-cli/pull/306">https://github.com/roc-lang/basic-cli/pull/306</a></p>



<a name="492412696"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492412696" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492412696">(Jan 08 2025 at 00:28)</a>:</h4>
<p>I use a similar workflow in <code>Weaver</code></p>



<a name="492412714"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492412714" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492412714">(Jan 08 2025 at 00:29)</a>:</h4>
<p>Yeah, I just tried that... even making a test release in basic-cli but we cant without a new testing release of roc</p>



<a name="492412716"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492412716" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492412716">(Jan 08 2025 at 00:29)</a>:</h4>
<p><a href="https://github.com/smores56/weaver/blob/main/.github/workflows/generate-docs.yaml">https://github.com/smores56/weaver/blob/main/.github/workflows/generate-docs.yaml</a></p>



<a name="492412754"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492412754" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492412754">(Jan 08 2025 at 00:29)</a>:</h4>
<p>So my idea above was just to do it manually (locally), and we can side-step all the CI madness when making/testing breaking changes like this</p>



<a name="492412864"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492412864" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492412864">(Jan 08 2025 at 00:30)</a>:</h4>
<p><a href="https://github.com/roc-lang/basic-cli/pull/305/files#diff-fcd4ffb682977fbcdc5e8a679eed82aa4ed2729be1ccb722f002e74be853fb35">https://github.com/roc-lang/basic-cli/pull/305/files#diff-fcd4ffb682977fbcdc5e8a679eed82aa4ed2729be1ccb722f002e74be853fb35</a></p>
<p>Here's where I tried the same thing... pushed it into the snake_case PR</p>



<a name="492412941"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492412941" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492412941">(Jan 08 2025 at 00:30)</a>:</h4>
<p>Give me 5, I'll try it in roc-json -- I might need to read up on GH Pages</p>



<a name="492412995"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492412995" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492412995">(Jan 08 2025 at 00:31)</a>:</h4>
<p>Okay, sounds good!</p>



<a name="492414201"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492414201" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492414201">(Jan 08 2025 at 00:43)</a>:</h4>
<p>slight bump -- apparently the latest roc nightly isn't passing all test in roc-json <a href="https://github.com/lukewilliamboswell/roc-json/actions/runs/12661819172/job/35285690202?pr=43">https://github.com/lukewilliamboswell/roc-json/actions/runs/12661819172/job/35285690202?pr=43</a> <span aria-label="sad" class="emoji emoji-2639" role="img" title="sad">:sad:</span></p>



<a name="492414224"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492414224" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492414224">(Jan 08 2025 at 00:43)</a>:</h4>
<p>We must have fixed something recently</p>



<a name="492414321"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492414321" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492414321">(Jan 08 2025 at 00:44)</a>:</h4>
<p>Does this test look like the actual is correct now?</p>
<div class="codehilite"><pre><span></span><code>── EXPECT FAILED in package/Json.roc ───────────────────────────────────────────

This expectation failed:

657│&gt;  # Test decode of F32
658│&gt;  expect
659│&gt;      actual : DecodeResult F32
660│&gt;      actual = Str.toUtf8 &quot;12.34e-5&quot; |&gt; Decode.fromBytesPartial utf8
661│&gt;      numStr = actual.result |&gt; Result.map Num.toStr
662│&gt;
663│&gt;      Result.withDefault numStr &quot;&quot; == &quot;0.00012339999375399202&quot;

When it failed, these variables had these values:

actual : DecodeResult F32
actual = { rest: [], result: Ok 0.0001234 }

numStr : Result Str DecodeError
numStr = Ok &quot;0.0001234&quot;


1 failed and 111 passed in 1252 ms.
</code></pre></div>



<a name="492414336"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492414336" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492414336">(Jan 08 2025 at 00:44)</a>:</h4>
<p>It looks like we've lost a lot of precision maybe when converting to Str?</p>



<a name="492414411"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492414411" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492414411">(Jan 08 2025 at 00:45)</a>:</h4>
<p>Or somehow storing the F32 so it encode/decodes correctly</p>



<a name="492414532"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492414532" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492414532">(Jan 08 2025 at 00:46)</a>:</h4>
<p><span class="user-mention" data-user-id="343810">@Brendan Hansknecht</span> do you have any thoughts on this?</p>



<a name="492414621"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492414621" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492414621">(Jan 08 2025 at 00:48)</a>:</h4>
<p>Oh, this is just the zig update</p>



<a name="492414673"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492414673" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492414673">(Jan 08 2025 at 00:48)</a>:</h4>
<p>F32 now prints with the minimal digits necessary to be the correct number</p>



<a name="492414688"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492414688" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492414688">(Jan 08 2025 at 00:48)</a>:</h4>
<p>Interestingly the <code>F64</code> one is still fine</p>
<div class="codehilite"><pre><span></span><code># Test decode of F64
expect
    actual : DecodeResult F64
    actual = Str.toUtf8 &quot;12.34e-5&quot; |&gt; Decode.fromBytesPartial utf8
    numStr = actual.result |&gt; Result.map Num.toStr

    Result.withDefault numStr &quot;&quot; == &quot;0.0001234&quot;
</code></pre></div>



<a name="492414696"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492414696" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492414696">(Jan 08 2025 at 00:48)</a>:</h4>
<p>Before it was printing tons of unnecessary/incorrect precision</p>



<a name="492417386"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492417386" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Notification Bot <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492417386">(Jan 08 2025 at 01:17)</a>:</h4>
<p>A message was moved from this topic to <a class="stream-topic" data-stream-id="304641" href="/#narrow/channel/304641-ideas/topic/casual.20conversation">#ideas &gt; casual conversation</a> by <span class="user-mention silent" data-user-id="515757">Luke Boswell</span>.</p>



<a name="492470353"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492470353" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492470353">(Jan 08 2025 at 10:00)</a>:</h4>
<blockquote>
<p>Do we want to block updating Roc by changing this process, or are we okay with just stealing the <code>basic-webserver</code> code for now and doing that later?</p>
</blockquote>
<p>Can we keep the docs for 0.18.0, 0.17.0 etc. available? They don't need to be rebuild every time, they use a docs.tar.gz that's in the release assets, so it should not create issues with breaking changes  in Roc</p>



<a name="492470734"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492470734" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492470734">(Jan 08 2025 at 10:01)</a>:</h4>
<p>I pinged you but you haven't seen it yet <span class="user-mention" data-user-id="361169">@Anton</span> <a href="https://github.com/roc-lang/basic-cli/pull/307">https://github.com/roc-lang/basic-cli/pull/307</a></p>



<a name="492470921"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492470921" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492470921">(Jan 08 2025 at 10:02)</a>:</h4>
<p>That PR includes the docs in the repo</p>
<div class="codehilite"><pre><span></span><code>docs/
- 0.17.0/
- 0.18.0/
</code></pre></div>



<a name="492471416"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492471416" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492471416">(Jan 08 2025 at 10:05)</a>:</h4>
<p>Ok, I'm going to merge that, configure and deploy the Pages site, and update the README</p>



<a name="492471676"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492471676" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492471676">(Jan 08 2025 at 10:07)</a>:</h4>
<p>Ok, docs live at <br>
<a href="https://roc-lang.github.io/basic-cli/">https://roc-lang.github.io/basic-cli/</a><br>
<a href="https://roc-lang.github.io/basic-cli/0.17.0/">https://roc-lang.github.io/basic-cli/0.17.0/</a><br>
<a href="https://roc-lang.github.io/basic-cli/0.18.0/">https://roc-lang.github.io/basic-cli/0.18.0/</a></p>



<a name="492472591"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492472591" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492472591">(Jan 08 2025 at 10:12)</a>:</h4>
<p>I'll check if I can forward the old links with netlify</p>



<a name="492597891"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492597891" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492597891">(Jan 08 2025 at 23:04)</a>:</h4>
<p>This might just be a WIP thing... <span class="user-mention" data-user-id="781658">@Anthony Bullard</span> </p>
<p>I am updating basic-webserver and used <code>--migrate</code> and noticed this</p>
<div class="codehilite" data-code-language="Ruby"><pre><span></span><code><span class="c1"># default --migrate gives, but this looked a little confusing</span>
<span class="n">try</span><span class="p">(</span><span class="no">Stdout</span><span class="o">.</span><span class="n">line!</span><span class="p">,</span><span class="w"> </span><span class="s2">"$(datetime) $(Inspect.to_str(req.method)) $(req.uri)"</span><span class="p">)</span>

<span class="c1"># works, but has the dreaded interrobang</span>
<span class="no">Stdout</span><span class="o">.</span><span class="n">line!</span><span class="sc">?(</span><span class="s2">"$(datetime) $(Inspect.to_str(req.method)) $(req.uri)"</span><span class="p">)</span>

<span class="c1"># what I expected, but doesn't compile right now</span>
<span class="no">Stdout</span><span class="o">.</span><span class="n">line!</span><span class="p">(</span><span class="s2">"$(datetime) $(Inspect.to_str(req.method)) $(req.uri)"</span><span class="p">)?</span>
</code></pre></div>



<a name="492597959"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492597959" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492597959">(Jan 08 2025 at 23:05)</a>:</h4>
<p>I might fix it accidentally in the Task removal, we'll see once I finish updating the code</p>



<a name="492597975"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492597975" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492597975">(Jan 08 2025 at 23:05)</a>:</h4>
<p>But yep, that's broken for me</p>



<a name="492598085"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492598085" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492598085">(Jan 08 2025 at 23:06)</a>:</h4>
<p>My PR that's open right now fixes this</p>



<a name="492598221"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492598221" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492598221">(Jan 08 2025 at 23:07)</a>:</h4>
<p>Ahk... I might just wait for that to land in main, it looks virtually done</p>



<a name="492598419"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492598419" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492598419">(Jan 08 2025 at 23:09)</a>:</h4>
<p>Yeah, some guy is giving me a hard time in the review, but it'll get merged soon</p>



<a name="492598443"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492598443" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492598443">(Jan 08 2025 at 23:09)</a>:</h4>
<p>Just tell me who, I'll beat him up for you</p>



<a name="492598458"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492598458" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492598458">(Jan 08 2025 at 23:09)</a>:</h4>
<p>He looks like a Smore</p>



<a name="492598507"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492598507" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492598507">(Jan 08 2025 at 23:10)</a>:</h4>
<p>And likes name-based puns</p>



<a name="492598513"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492598513" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492598513">(Jan 08 2025 at 23:10)</a>:</h4>
<p>We need a smore or marshmellow emoji</p>



<a name="492598554"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492598554" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492598554">(Jan 08 2025 at 23:10)</a>:</h4>
<p><a href="/user_uploads/22008/N9_q8rx_pmyKkEh6xHJbfPt1/image.png">image.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/22008/N9_q8rx_pmyKkEh6xHJbfPt1/image.png" title="image.png"><img data-original-dimensions="500x500" src="/user_uploads/thumbnail/22008/N9_q8rx_pmyKkEh6xHJbfPt1/image.png/840x560.webp"></a></div><p>Just put this in the custom emojis</p>



<a name="492598597"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492598597" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492598597">(Jan 08 2025 at 23:11)</a>:</h4>
<p>Is that gen-llvm failure genuine?</p>



<a name="492598613"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492598613" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492598613">(Jan 08 2025 at 23:11)</a>:</h4>
<div class="codehilite"><pre><span></span><code>Run cargo nextest-gen-llvm --release --no-fail-fast --locked -E &quot;package(test_gen) - test(gen_str::str_append_scalar)&quot;
error: failed to run `rustc` to learn about target-specific information

Caused by:
  process didn&#39;t exit successfully: `/Users/username1/.cargo/bin/sccache /Users/username1/.rustup/toolchains/1.77.2-x86_64-apple-darwin/bin/rustc - --crate-name ___ --print=file-names --crate-type bin --crate-type rlib --crate-type dylib --crate-type cdylib --crate-type staticlib --crate-type proc-macro --print=sysroot --print=split-debuginfo --print=crate-name --print=cfg` (exit status: 2)
  --- stderr
  sccache: error: Timed out waiting for server startup
error: command `/Users/username1/.rustup/toolchains/1.77.2-x86_64-apple-darwin/bin/cargo test --no-run --message-format json-render-diagnostics --package test_gen --release --locked` exited with code 101
Error: Process completed with exit code 101.
</code></pre></div>



<a name="492598724"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492598724" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492598724">(Jan 08 2025 at 23:12)</a>:</h4>
<p>It's passed everything else except the fuzzer... so looks good to merge</p>



<a name="492598755"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492598755" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492598755">(Jan 08 2025 at 23:12)</a>:</h4>
<p>What is this on <span class="user-mention" data-user-id="515757">@Luke Boswell</span> ?</p>



<a name="492598772"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492598772" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492598772">(Jan 08 2025 at 23:13)</a>:</h4>
<p><a href="https://github.com/roc-lang/roc/actions/runs/12679852096/job/35340490822?pr=7480">https://github.com/roc-lang/roc/actions/runs/12679852096/job/35340490822?pr=7480</a></p>



<a name="492598777"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492598777" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492598777">(Jan 08 2025 at 23:13)</a>:</h4>
<p>Your PR "Move PNC apply to separate Expr/Pattern variant"</p>



<a name="492598906"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492598906" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492598906">(Jan 08 2025 at 23:14)</a>:</h4>
<p>I don't know how to parse that error?</p>



<a name="492598924"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492598924" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492598924">(Jan 08 2025 at 23:14)</a>:</h4>
<p>Does that seem like something likely from my PR if all the other tests pass?</p>



<a name="492598955"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492598955" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492598955">(Jan 08 2025 at 23:14)</a>:</h4>
<p>It looks odd to me also</p>



<a name="492599043"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492599043" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492599043">(Jan 08 2025 at 23:15)</a>:</h4>
<p>FWIW I took a brief look at your replies on that PR <span class="user-mention" data-user-id="781658">@Anthony Bullard</span>. Made sense to me. I can re-review after work today, but no concerns with going ahead and merging if you want to maintain momentum</p>



<a name="492599118"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492599118" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492599118">(Jan 08 2025 at 23:16)</a>:</h4>
<p>I think we can either ignore it or restart the run... I lean towards merging now, and we can follow up if needed</p>



<a name="492599134"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492599134" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492599134">(Jan 08 2025 at 23:16)</a>:</h4>
<p><img alt=":smores:" class="emoji" src="https://avatars.zulip.com/22008/emoji/images/cdbc1121.png" title="smores"></p>



<a name="492599136"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492599136" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492599136">(Jan 08 2025 at 23:16)</a>:</h4>
<p>I can get started on the platform migrations then</p>



<a name="492599138"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492599138" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492599138">(Jan 08 2025 at 23:16)</a>:</h4>
<p>There ya go</p>



<a name="492599171"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492599171" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492599171">(Jan 08 2025 at 23:16)</a>:</h4>
<p>OW!</p>



<a name="492599213"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492599213" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492599213">(Jan 08 2025 at 23:17)</a>:</h4>
<p>Forgive me, I'm merging it</p>



<a name="492599266"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492599266" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492599266">(Jan 08 2025 at 23:17)</a>:</h4>
<p>And restarting the refcount PR in CI so we can see that's still ready to go (and also confirm the PNC change was a non-issue)</p>



<a name="492600621"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492600621" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492600621">(Jan 08 2025 at 23:31)</a>:</h4>
<p>What would you say is better for where we're currently at?</p>
<div class="codehilite" data-code-language="Ruby"><pre><span></span><code><span class="c1"># THIS?</span>
<span class="n">cwd</span><span class="w"> </span><span class="o">=</span>
<span class="w">    </span><span class="no">Env</span><span class="o">.</span><span class="n">cwd!</span><span class="p">({})</span>
<span class="w">    </span><span class="o">|&gt;</span><span class="w"> </span><span class="no">Result</span><span class="o">.</span><span class="n">map_err</span><span class="p">(\</span><span class="no">CwdUnavailable</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="no">Exit</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s2">"Unable to read current working directory"</span><span class="p">))</span>
<span class="w">    </span><span class="o">|&gt;</span><span class="w"> </span><span class="n">try</span>

<span class="c1"># OR THIS?</span>
<span class="n">cwd</span><span class="w"> </span><span class="o">=</span>
<span class="w">    </span><span class="no">Result</span><span class="o">.</span><span class="n">map_err</span><span class="p">(</span>
<span class="w">        </span><span class="no">Env</span><span class="o">.</span><span class="n">cwd!</span><span class="p">({}),</span>
<span class="w">        </span><span class="p">\</span><span class="no">CwdUnavailable</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="no">Exit</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s2">"Unable to read current working directory"</span><span class="p">)</span>
<span class="w">    </span><span class="p">)?</span>

<span class="c1"># OR EVEN??</span>
<span class="n">cwd</span><span class="w"> </span><span class="o">=</span>
<span class="w">    </span><span class="no">Env</span><span class="o">.</span><span class="n">cwd!</span><span class="p">({})</span>
<span class="w">    </span><span class="o">|&gt;</span><span class="w"> </span><span class="no">Result</span><span class="o">.</span><span class="n">map_err?</span><span class="p">(\</span><span class="no">CwdUnavailable</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="no">Exit</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s2">"Unable to read current working directory"</span><span class="p">))</span>
</code></pre></div>



<a name="492600765"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492600765" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492600765">(Jan 08 2025 at 23:33)</a>:</h4>
<p>I'm leaning towards the second because it feels closest to the PNC vision despite not having static dispatch to chain it</p>



<a name="492600802"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492600802" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492600802">(Jan 08 2025 at 23:33)</a>:</h4>
<p>The second is the syntax I used for the recent experiment in <a class="stream-topic" data-stream-id="463736" href="/#narrow/channel/463736-bugs/topic/Compiler.20panic.20for.20naming.20mismatch.20between.20type.20def.20and.20use">#bugs &gt; Compiler panic for naming mismatch between type def and use</a></p>



<a name="492600968"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492600968" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492600968">(Jan 08 2025 at 23:34)</a>:</h4>
<p>The first is also nice, in that the chain is clearer.</p>



<a name="492601468"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492601468" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492601468">(Jan 08 2025 at 23:39)</a>:</h4>
<p>Though it's not quite the point of your example, this case is specifically handled by binop ?:</p>
<div class="codehilite" data-code-language="Elm"><pre><span></span><code><span class="nv">cwd</span><span class="w"> </span><span class="nf">=</span>
<span class="w">    </span><span class="kt">Env</span><span class="nf">.</span><span class="nv">cwd</span><span class="err">!</span><span class="p">()</span><span class="w"> </span><span class="err">?</span><span class="w"> </span><span class="nf">|</span><span class="kt">CwdUnavailable</span><span class="nf">|</span>
<span class="w">        </span><span class="kt">Exit</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s">"Unable to read current working directory"</span><span class="p">)</span>
</code></pre></div>



<a name="492601668"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492601668" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492601668">(Jan 08 2025 at 23:41)</a>:</h4>
<p>I think it's relevant here because the problematic cases are function calls with only a couple args in my eyes</p>



<a name="492601682"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492601682" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492601682">(Jan 08 2025 at 23:41)</a>:</h4>
<p>I think this helps with that</p>



<a name="492603442"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492603442" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492603442">(Jan 08 2025 at 23:55)</a>:</h4>
<p>Minor thing... but I don't think <code>--migrate</code> catches idents in import with <code>as</code> e.g.</p>
<div class="codehilite"><pre><span></span><code>import &quot;todos.html&quot; as todoHtml : List U8
</code></pre></div>



<a name="492603486"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492603486" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492603486">(Jan 08 2025 at 23:55)</a>:</h4>
<p>It doesn't for me either</p>



<a name="492603687"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492603687" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492603687">(Jan 08 2025 at 23:57)</a>:</h4>
<p>Is that not a pattern?</p>



<a name="492603819"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492603819" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492603819">(Jan 08 2025 at 23:58)</a>:</h4>
<p>It's probably something special, then</p>



<a name="492607666"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492607666" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492607666">(Jan 09 2025 at 00:34)</a>:</h4>
<p>Just upgrading the basic-cli snake_case builtins PR to PNC now</p>



<a name="492607903"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492607903" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492607903">(Jan 09 2025 at 00:37)</a>:</h4>
<p>Can you run it on <code>basic-webserver</code>'s build.roc while you're at it?</p>



<a name="492608036"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492608036" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492608036">(Jan 09 2025 at 00:38)</a>:</h4>
<p>I have tested basic-webserver locally and it works well.</p>



<a name="492608064"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492608064" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492608064">(Jan 09 2025 at 00:38)</a>:</h4>
<div class="codehilite" data-code-language="Elm"><pre><span></span><code><span class="nv">main</span><span class="err">!</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="nv">_</span><span class="w"> </span><span class="nf">=&gt;</span><span class="w"> </span><span class="kt">Result</span><span class="w"> </span><span class="p">{}</span><span class="w"> </span><span class="nv">_</span>
<span class="nv">main</span><span class="err">!</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nf">\</span><span class="nv">args</span><span class="w"> </span><span class="nf">-&gt;</span>

<span class="w">    </span><span class="nv">parsed_args</span><span class="w"> </span><span class="nf">=</span>
<span class="w">        </span><span class="kt">Cli</span><span class="nf">.</span><span class="nv">parse_or_display_message</span><span class="p">(</span><span class="nv">cli_parser</span><span class="p">,</span><span class="w"> </span><span class="nv">args</span><span class="p">,</span><span class="w"> </span><span class="kt">Arg</span><span class="nf">.</span><span class="nv">to_os_raw</span><span class="p">)</span>
<span class="w">        </span><span class="nf">|&gt;</span><span class="w"> </span><span class="nv">try</span><span class="w"> </span><span class="kt">Result</span><span class="nf">.</span><span class="nv">on_err</span><span class="err">!</span><span class="w"> </span><span class="nf">\</span><span class="nv">message</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Err</span><span class="w"> </span><span class="p">(</span><span class="kt">Exit</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="nv">message</span><span class="p">)</span>
</code></pre></div>



<a name="492608079"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492608079" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492608079">(Jan 09 2025 at 00:38)</a>:</h4>
<p>That <code>try</code> statement is not PNC'ed</p>



<a name="492608104"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492608104" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492608104">(Jan 09 2025 at 00:39)</a>:</h4>
<p>I haven't been removing all try's. It's just messy for longer chains.</p>



<a name="492608139"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492608139" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492608139">(Jan 09 2025 at 00:39)</a>:</h4>
<p>I guess here we could... my heuristic has been -- if it's going to be a chain in SD then leave it for now</p>



<a name="492608288"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492608288" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492608288">(Jan 09 2025 at 00:41)</a>:</h4>
<p>Fine by me, but we might need to make another pass when whitespace calling is removed, since I think that'll happen before static dispatch is ready</p>



<a name="492608296"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492608296" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492608296">(Jan 09 2025 at 00:41)</a>:</h4>
<p>Though I may be wrong on that</p>



<a name="492608323"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492608323" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492608323">(Jan 09 2025 at 00:41)</a>:</h4>
<p>I expect that's the case because static dispatch is hard to implement, and <code>\args -&gt;</code> going to <code>|args|</code> is easy to implement</p>



<a name="492608472"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492608472" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492608472">(Jan 09 2025 at 00:43)</a>:</h4>
<p>I guess we can just cut a few testing releases and keep these breaking platform PRs in sync and do an actual release once we get <code>|args|</code> and <code>${interpolation}</code> etc</p>



<a name="492608491"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492608491" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492608491">(Jan 09 2025 at 00:43)</a>:</h4>
<p>It's easier to update them as we go, but does look a bit strange being in this intermediate state -- so we probably don't want to do a full release with what we currently have</p>



<a name="492608546"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492608546" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492608546">(Jan 09 2025 at 00:44)</a>:</h4>
<p>I don't have a strong opinion, do whatever is easy</p>



<a name="492608648"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492608648" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492608648">(Jan 09 2025 at 00:45)</a>:</h4>
<p>We don't even need testing releases with the nix CI's, we just land the breaking change in roc main and we're good to go</p>



<a name="492608798"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492608798" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492608798">(Jan 09 2025 at 00:47)</a>:</h4>
<p>Even without static dispatch... these examples are looking really nice!</p>



<a name="492787374"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492787374" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492787374">(Jan 09 2025 at 18:12)</a>:</h4>
<p>So much talking on Zulip lately. Have to skim tons of things cause I don't have the time to keep up.</p>



<a name="492789034"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492789034" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ayaz Hafiz <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492789034">(Jan 09 2025 at 18:21)</a>:</h4>
<p>same</p>



<a name="492789267"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492789267" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492789267">(Jan 09 2025 at 18:22)</a>:</h4>
<p>A good sign, even if it has its drawbacks</p>



<a name="492790775"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492790775" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492790775">(Jan 09 2025 at 18:30)</a>:</h4>
<p>yeah, I'm a big fan <span aria-label="grinning face with smiling eyes" class="emoji emoji-1f601" role="img" title="grinning face with smiling eyes">:grinning_face_with_smiling_eyes:</span></p>



<a name="492834772"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492834772" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Notification Bot <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492834772">(Jan 09 2025 at 22:52)</a>:</h4>
<p>26 messages were moved from this topic to <a class="stream-topic" data-stream-id="395097" href="/#narrow/channel/395097-compiler-development/topic/checking.20doc.20comments">#compiler development &gt; checking doc comments</a> by <span class="user-mention silent" data-user-id="515757">Luke Boswell</span>.</p>



<a name="492846785"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492846785" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492846785">(Jan 10 2025 at 00:23)</a>:</h4>
<p>I'm presuming that <code>foo_!</code> is how we'd represent a re-assignable effectful closure. Or would it be <code>foo!_</code>?</p>



<a name="492846911"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492846911" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492846911">(Jan 10 2025 at 00:24)</a>:</h4>
<p><code>foo!_</code></p>



<a name="492846923"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492846923" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492846923">(Jan 10 2025 at 00:24)</a>:</h4>
<p>I'm okay with that</p>



<a name="492849509"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492849509" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492849509">(Jan 10 2025 at 00:47)</a>:</h4>
<p>Or just don't have reassignable effectful closures....who needs that</p>



<a name="492849619"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492849619" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492849619">(Jan 10 2025 at 00:48)</a>:</h4>
<p>Generally I'd agree, but you never know</p>



<a name="492855989"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/492855989" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#492855989">(Jan 10 2025 at 01:42)</a>:</h4>
<p>I don't actually feel that strongly against it. I could see building up a lazy computation with a for loop</p>



<a name="493061217"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/493061217" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Notification Bot <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#493061217">(Jan 11 2025 at 04:03)</a>:</h4>
<p>14 messages were moved from this topic to <a class="stream-topic" data-stream-id="395097" href="/#narrow/channel/395097-compiler-development/topic/roc-json.20compiler.20bug">#compiler development &gt; roc-json compiler bug</a> by <span class="user-mention silent" data-user-id="515757">Luke Boswell</span>.</p>



<a name="493066871"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/493066871" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#493066871">(Jan 11 2025 at 05:41)</a>:</h4>
<p>What should a IgnoredValue field desugar / canonicalize to? e.g.</p>
<div class="codehilite"><pre><span></span><code>{ _name: 123 }
</code></pre></div>
<p>I ask because I have a test that triggers this panic: <a href="https://github.com/roc-lang/roc/blob/10ea93e838d290beda1da5ca2bf3c9c1fb53e6e0/crates/compiler/can/src/expr.rs#L2109">https://github.com/roc-lang/roc/blob/10ea93e838d290beda1da5ca2bf3c9c1fb53e6e0/crates/compiler/can/src/expr.rs#L2109</a></p>
<p>But it looks to me like desugaring doesn't remove IgnoredValue fields at all: <a href="https://github.com/roc-lang/roc/blob/10ea93e838d290beda1da5ca2bf3c9c1fb53e6e0/crates/compiler/can/src/desugar.rs#L1272">https://github.com/roc-lang/roc/blob/10ea93e838d290beda1da5ca2bf3c9c1fb53e6e0/crates/compiler/can/src/desugar.rs#L1272</a></p>



<a name="493067731"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/493067731" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#493067731">(Jan 11 2025 at 05:56)</a>:</h4>
<p>Those are used for record builders</p>



<a name="493067753"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/493067753" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#493067753">(Jan 11 2025 at 05:56)</a>:</h4>
<p>Ideally, an IgnoredValue field would be a runtime error outside of a record builder</p>



<a name="493067779"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/493067779" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#493067779">(Jan 11 2025 at 05:57)</a>:</h4>
<p>So we should probably emit one at that site</p>



<a name="493067784"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/493067784" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#493067784">(Jan 11 2025 at 05:57)</a>:</h4>
<p>That you linked</p>



<a name="493163833"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/493163833" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#493163833">(Jan 12 2025 at 07:08)</a>:</h4>
<p>Regarding PNC... my muscle memory definitely hasn't caught up yet. I'm really glad we have the <code>--migrate</code> flag, because I'm finding I write a lot of code before I realise, and then it's easy to just fix it up. </p>
<p>I assume at some point it will be natural to add the <code>(</code> <code>)</code> but for now it's taking mental effort to remember.</p>



<a name="493679392"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/493679392" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#493679392">(Jan 14 2025 at 22:07)</a>:</h4>
<p>I'm WFH today, so should have time between things to poke at PR's etc. Let me know if you need anything.</p>



<a name="493679442"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/493679442" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#493679442">(Jan 14 2025 at 22:07)</a>:</h4>
<p><span class="user-mention silent" data-user-id="515757">Luke Boswell</span> <a href="#narrow/channel/395097-compiler-development/topic/casual.20conversation/near/493679392">said</a>:</p>
<blockquote>
<p>I'm WFH today, so should have time between things to poke at PR's etc. Let me know if you need anything.</p>
</blockquote>
<p>Got anything with Chocolate?</p>



<a name="493679507"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/493679507" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#493679507">(Jan 14 2025 at 22:08)</a>:</h4>
<p>I'm still waiting for those Red Bulls</p>



<a name="493679577"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/493679577" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#493679577">(Jan 14 2025 at 22:08)</a>:</h4>
<p>Not offering emotional support today, sorry <span class="user-mention" data-user-id="461444">@Sam Mohr</span></p>



<a name="494273098"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/494273098" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#494273098">(Jan 17 2025 at 02:54)</a>:</h4>
<p>Did we accidentally or deliberately remove the <code>todos.roc</code> example from basic-cli? ... (I'm probably the guilty one)... I can't remember</p>



<a name="494273242"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/494273242" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#494273242">(Jan 17 2025 at 02:56)</a>:</h4>
<p>Oh nvm, I think it's just <span class="user-mention" data-user-id="343810">@Brendan Hansknecht</span> added <code>todos.db</code> for the sqlite example...</p>



<a name="494273254"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/494273254" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#494273254">(Jan 17 2025 at 02:56)</a>:</h4>
<p>All good</p>



<a name="495565793"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/495565793" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#495565793">(Jan 23 2025 at 18:50)</a>:</h4>
<div class="codehilite"><pre><span></span><code>[crates/compiler/mono/src/reset_reuse.rs:1244:9] symbol = `temp.64`
[crates/compiler/mono/src/reset_reuse.rs:1244:9] symbol = `temp.data2`
[crates/compiler/mono/src/reset_reuse.rs:1244:9] symbol = `temp.orientation_str`
[crates/compiler/mono/src/reset_reuse.rs:1244:9] symbol = `temp.56`
[crates/compiler/mono/src/reset_reuse.rs:1244:9] symbol = `temp.54`
[crates/compiler/mono/src/reset_reuse.rs:1244:9] symbol = `temp.name_str`
[crates/compiler/mono/src/reset_reuse.rs:1244:9] symbol = `temp.64`
[crates/compiler/mono/src/reset_reuse.rs:1244:9] symbol = `temp.58`
</code></pre></div>
<p>Are the numbered symbols like temp.58 for variables that we make ourselves like during desugaring or something like that?</p>



<a name="495582073"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/495582073" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#495582073">(Jan 23 2025 at 20:42)</a>:</h4>
<p>I think so, that or also in Can I assume.</p>



<a name="495621157"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/495621157" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#495621157">(Jan 24 2025 at 02:31)</a>:</h4>
<p>I think they are also for all intermediates when we breakdown expressions, but would need to double check that.</p>



<a name="495621179"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/495621179" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#495621179">(Jan 24 2025 at 02:31)</a>:</h4>
<p>Sometimes yes</p>



<a name="495621193"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/495621193" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#495621193">(Jan 24 2025 at 02:31)</a>:</h4>
<p>They can get generated in mono</p>



<a name="495621219"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/495621219" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#495621219">(Jan 24 2025 at 02:31)</a>:</h4>
<p>Basically anywhere an ident would be used but we don't have a user-defined one</p>



<a name="495621289"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/495621289" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#495621289">(Jan 24 2025 at 02:32)</a>:</h4>
<p>We generate a new one with a numeric name since that isn't syntactically valid</p>



<a name="495953603"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/495953603" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#495953603">(Jan 26 2025 at 10:08)</a>:</h4>
<p>If we always converted <code>if</code> statements to <code>when bool is 1 -&gt; ...; _ -&gt; ...</code> there wouldn't be a perf drop, would there?</p>



<a name="495953611"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/495953611" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#495953611">(Jan 26 2025 at 10:08)</a>:</h4>
<p>I'd expect it to always be the same perf or better</p>



<a name="495953631"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/495953631" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#495953631">(Jan 26 2025 at 10:09)</a>:</h4>
<p>That should help us simplify our IR if we can get away with it</p>



<a name="495954951"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/495954951" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#495954951">(Jan 26 2025 at 10:28)</a>:</h4>
<p>We already do this in <a href="https://github.com/roc-lang/roc/blob/3f09235d6afcf4fde3861e6546f521004d6de8b0/crates/compiler/mono/src/ir.rs#L1484">mono/src/ir.rs</a>, so I'm gonna roll with it</p>



<a name="495967933"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/495967933" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#495967933">(Jan 26 2025 at 13:33)</a>:</h4>
<p>should be the same perf, although we can give nicer error messages for type mismatches if we know it was an <code>if</code> compared to a <code>when</code></p>



<a name="495967954"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/495967954" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#495967954">(Jan 26 2025 at 13:33)</a>:</h4>
<p>Fair</p>



<a name="495967966"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/495967966" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#495967966">(Jan 26 2025 at 13:33)</a>:</h4>
<p>and that relies on constraint gen knowing it was an <code>if</code> compared to a <code>when</code>, and constraint gen (currently) does a separate pass over the canonical IR</p>



<a name="495968038"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/495968038" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#495968038">(Jan 26 2025 at 13:34)</a>:</h4>
<p>I'm thinking about post typechecking, on the <code>build/</code> side of things</p>



<a name="495968043"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/495968043" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#495968043">(Jan 26 2025 at 13:34)</a>:</h4>
<p>oh that's fine then</p>



<a name="495968048"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/495968048" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#495968048">(Jan 26 2025 at 13:34)</a>:</h4>
<p>Yeah, great</p>



<a name="495968105"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/495968105" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#495968105">(Jan 26 2025 at 13:35)</a>:</h4>
<p>incidentally, I think we can potentially do it differently someday (where we generate constraints at the same time as making the canonical IR) but it's tricky because order of constraints matters, and we need them to be sorted by dependencies (e.g. first constrain functions whose types don't depend on other functions, etc.) - right now, doing the constraint pass after canonicalization (and sorting the canonical IR) takes care of that, but if we wanted to do (constrain + canonicalize) at the same time, then we'd need to have the ability to sort the constraints separately after the fact</p>



<a name="495968113"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/495968113" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#495968113">(Jan 26 2025 at 13:35)</a>:</h4>
<p>since we don't know the dependency order until after canonicalization has completely finished</p>



<a name="495968165"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/495968165" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#495968165">(Jan 26 2025 at 13:36)</a>:</h4>
<p>so I don't think now is the right time to do that since it might break things if we get it wrong <span aria-label="big smile" class="emoji emoji-1f604" role="img" title="big smile">:big_smile:</span></p>



<a name="495968183"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/495968183" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#495968183">(Jan 26 2025 at 13:36)</a>:</h4>
<p>It seems like the lesson of the moment is to do everything in separate passes for greater likelihood of correctness</p>



<a name="495968191"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/495968191" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#495968191">(Jan 26 2025 at 13:36)</a>:</h4>
<p>yeah</p>



<a name="495968218"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/495968218" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#495968218">(Jan 26 2025 at 13:37)</a>:</h4>
<p>and then in the future we can experiment with incrementally combining things to see if they make that one step faster while maintaining correctness</p>



<a name="495968255"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/495968255" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#495968255">(Jan 26 2025 at 13:37)</a>:</h4>
<p>but yeah, correctness is the name of the game!</p>



<a name="496097553"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/496097553" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#496097553">(Jan 27 2025 at 11:20)</a>:</h4>
<p><span class="user-mention silent" data-user-id="461444">Sam Mohr</span> <a href="#narrow/channel/395097-compiler-development/topic/casual.20conversation/near/495968183">said</a>:</p>
<blockquote>
<p>It seems like the lesson of the moment is to do everything in separate passes for greater likelihood of correctness</p>
</blockquote>
<p>This is also echoed by <a href="https://nanopass.org/index.html">nanopass</a></p>



<a name="496110842"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/496110842" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> emma <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#496110842">(Jan 27 2025 at 12:31)</a>:</h4>
<p>is there any docs/papers on how tags are inferred? it seems like they break the fundamental unification rule of not allowing type variables to be solved to a type containing themself.</p>



<a name="496112312"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/496112312" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#496112312">(Jan 27 2025 at 12:38)</a>:</h4>
<p><span class="user-mention" data-user-id="454654">@Ayaz Hafiz</span></p>



<a name="496140670"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/496140670" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ayaz Hafiz <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#496140670">(Jan 27 2025 at 14:51)</a>:</h4>
<p><span class="user-mention" data-user-id="871424">@emma</span> the topic in literature is "polymorphic variants", roc takes a combination of approaches</p>



<a name="496140771"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/496140771" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ayaz Hafiz <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#496140771">(Jan 27 2025 at 14:51)</a>:</h4>
<p>Can you elaborate on the unification rule you're describing? I'm not sure I follow the problem fully</p>



<a name="496166816"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/496166816" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#496166816">(Jan 27 2025 at 16:41)</a>:</h4>
<p><span class="user-mention silent" data-user-id="361169">Anton</span> <a href="#narrow/stream/395097-compiler-development/topic/casual.20conversation/near/496097553">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="461444">Sam Mohr</span> <a href="#narrow/channel/395097-compiler-development/topic/casual.20conversation/near/495968183">said</a>:</p>
<blockquote>
<p>It seems like the lesson of the moment is to do everything in separate passes for greater likelihood of correctness</p>
</blockquote>
<p>This is also echoed by <a href="https://nanopass.org/index.html">nanopass</a></p>
</blockquote>
<p>This makes some sense, but generally nano pass compilers are measurably very slow. I think it is better to make reasonably sized passes than nano passes. But perf depends on a lot of things. So leaning toward the simplest first makes the most sense.</p>



<a name="496456053"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/496456053" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#496456053">(Jan 29 2025 at 02:00)</a>:</h4>
<p>For a long time I've wanted to try to "nanopass, but use some compiler magic to merge passes and make it fast"</p>



<a name="496525784"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/496525784" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#496525784">(Jan 29 2025 at 11:26)</a>:</h4>
<p>Seems like the <a href="https://github.com/roc-lang/roc/pull/7130">auto-annotate type signatures</a> PR is ready to merge. Anyone against doing that now? I don't think it will interfere with the release process we're working on right now</p>



<a name="496526915"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/496526915" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#496526915">(Jan 29 2025 at 11:32)</a>:</h4>
<p>Let's hold that for 24 hours to be safe</p>



<a name="496703723"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/496703723" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ayaz Hafiz <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#496703723">(Jan 30 2025 at 06:44)</a>:</h4>
<p>Frank Pfenning and co with yet another banger <a href="https://blog.sigplan.org/2025/01/29/parametric-subtyping-for-structural-parametric-polymorphism/">https://blog.sigplan.org/2025/01/29/parametric-subtyping-for-structural-parametric-polymorphism/</a></p>



<a name="496705126"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/496705126" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#496705126">(Jan 30 2025 at 06:58)</a>:</h4>
<p>Where do you find these papers? Conferences?</p>



<a name="496705201"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/496705201" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ayaz Hafiz <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#496705201">(Jan 30 2025 at 06:58)</a>:</h4>
<p>used to track but too lazy now. found it on a forum</p>



<a name="496705254"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/496705254" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#496705254">(Jan 30 2025 at 06:59)</a>:</h4>
<p>Which forum?</p>



<a name="496705276"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/496705276" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#496705276">(Jan 30 2025 at 06:59)</a>:</h4>
<p>I think I could replace some doomscrolling with this kind of info</p>



<a name="497301490"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/497301490" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ayaz Hafiz <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#497301490">(Feb 02 2025 at 23:21)</a>:</h4>
<p><a href="/user_uploads/22008/A-t-RlwmOY__kXOW_mOoeDaq/image.png">image.png</a><br>
ooph</p>
<div class="message_inline_image"><a href="/user_uploads/22008/A-t-RlwmOY__kXOW_mOoeDaq/image.png" title="image.png"><img data-original-content-type="image/png" data-original-dimensions="542x64" src="/user_uploads/thumbnail/22008/A-t-RlwmOY__kXOW_mOoeDaq/image.png/840x560.webp"></a></div>



<a name="497301514"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/497301514" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#497301514">(Feb 02 2025 at 23:21)</a>:</h4>
<p>We’ve been talking</p>



<a name="497301533"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/497301533" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ayaz Hafiz <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#497301533">(Feb 02 2025 at 23:21)</a>:</h4>
<p>i love yappers ngl</p>



<a name="497301584"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/497301584" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#497301584">(Feb 02 2025 at 23:22)</a>:</h4>
<p>It’s almost like deciding to rewrite the compiler sparks a lot of convo</p>



<a name="497301596"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/497301596" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ayaz Hafiz <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#497301596">(Feb 02 2025 at 23:22)</a>:</h4>
<p>crazy thought</p>



<a name="497301654"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/497301654" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#497301654">(Feb 02 2025 at 23:23)</a>:</h4>
<p>My plan is to hang in there as long as possible... and hopefully I'll learn the dark arts of roc's compiler internals by osmosis -- reading all the discussion and seeing the PR's roll in.</p>



<a name="497303490"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/497303490" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#497303490">(Feb 02 2025 at 23:45)</a>:</h4>
<p>Man, I'm glad we have the rest of the team for the low-level stuff. I never had a good introduction to it and it still feels like black magic. I look forward to reading lots of PRs that might educate me!</p>



<a name="497304414"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/497304414" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#497304414">(Feb 02 2025 at 23:57)</a>:</h4>
<p>Me too buddy, me too</p>



<a name="497482196"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/497482196" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jan kili <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#497482196">(Feb 03 2025 at 16:29)</a>:</h4>
<p><a href="/user_uploads/22008/Ay08P0iRKWGEn6H_ZzTUjv1c/3489a045-b487-43da-b4c6-48ab2b961b0b.png">3489a045-b487-43da-b4c6-48ab2b961b0b.png</a><br>
lol I was caught up on all threads yesterday, this has gotta be some kind of record in here <span aria-label="clap" class="emoji emoji-1f44f" role="img" title="clap">:clap:</span><span aria-label="saluting face" class="emoji emoji-1fae1" role="img" title="saluting face">:saluting_face:</span><span aria-label="popcorn" class="emoji emoji-1f37f" role="img" title="popcorn">:popcorn:</span></p>
<div class="message_inline_image"><a href="/user_uploads/22008/Ay08P0iRKWGEn6H_ZzTUjv1c/3489a045-b487-43da-b4c6-48ab2b961b0b.png" title="3489a045-b487-43da-b4c6-48ab2b961b0b.png"><img data-original-content-type="image/png" data-original-dimensions="720x1600" src="/user_uploads/thumbnail/22008/Ay08P0iRKWGEn6H_ZzTUjv1c/3489a045-b487-43da-b4c6-48ab2b961b0b.png/840x560.webp"></a></div>



<a name="497515771"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/497515771" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#497515771">(Feb 03 2025 at 19:27)</a>:</h4>
<p>Wait.... <a class="stream" data-stream-id="395097" href="/#narrow/channel/395097-compiler-development">#compiler development</a> is a different color for different people....that bugs me.</p>



<a name="497515944"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/497515944" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#497515944">(Feb 03 2025 at 19:28)</a>:</h4>
<p>It's red for me, green for Jan, looks to be lavender for ayaz.</p>



<a name="497527933"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/497527933" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Isaac Van Doren <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#497527933">(Feb 03 2025 at 20:45)</a>:</h4>
<p>It’s greyish brown for me</p>



<a name="497528041"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/497528041" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#497528041">(Feb 03 2025 at 20:46)</a>:</h4>
<p>light purple</p>



<a name="497528348"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/497528348" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jasper Woudenberg <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#497528348">(Feb 03 2025 at 20:48)</a>:</h4>
<p>Same color as <a class="stream" data-stream-id="231634" href="/#narrow/channel/231634-beginners">#beginners</a> but slightly brighter</p>



<a name="497910678"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/497910678" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> emma <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#497910678">(Feb 05 2025 at 14:47)</a>:</h4>
<p><span class="user-mention silent" data-user-id="454654">Ayaz Hafiz</span> <a href="#narrow/channel/395097-compiler-development/topic/casual.20conversation/near/496140670">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="871424">emma</span> the topic in literature is "polymorphic variants", roc takes a combination of approaches</p>
</blockquote>
<p><span class="user-mention" data-user-id="454654">@Ayaz Hafiz</span> apologies for the very late reply - I'm aware of the term "polymorphic variants" but I haven't found any (simple) descriptions of how it gets implemented on top of typical HM systems - it seems to be hard to fit into the usual unification rules. Do you know if theres any good explanations of how roc or other languages implement it?</p>



<a name="497912244"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/497912244" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ayaz Hafiz <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#497912244">(Feb 05 2025 at 14:54)</a>:</h4>
<p>there are a ton of papers from Leijen etc. but I don't know how interpretable they might be. Daan Leijen’s “Extensible records” paper is the simplest approach I know of, and is similar to the approach Elm/Roc use. I'll give a short description of the mechanism in Roc, feel free to ask for elaboration if it's confusing or incomplete. The approach for records is to bind a type variable to a record that unifies freely; for example the call <code>(fun r -&gt; r.x) {x: 1, y: 1}</code> types the function as <code>{x: a}b -&gt; a</code> (where <code>b</code> is free) and the record as <code>{x: int, y: int}c</code> (where <code>c</code> is free); <code>{x: a}b ~ {x: int, y: int}c</code> yields <code>b = {y: int}d, c = {}d</code> (where <code>d</code> is fresh).<br>
The approach for variants is the dual. That is, an expression <code> `A 1 = `B "foo" </code> types the LHS and RHS as <code>[A int]a</code> and <code>[B str]b</code> respectively, the constraint <code>[A int]a ~ [B str]b</code> then solves <code>a = [B str]c, b = [A int]c</code> and both the LHS and RHS have type <code>[A int, B str]c</code>. However, a function <code>[A, B]a -&gt; {}</code> is materially different than <code>[A, B] -&gt; {}</code> - if you have a pattern match over the input on the former, you always need a catch-all branch, whereas a pattern match on the latter only needs a branch for <code>A</code> and <code>B</code>. To handle this, Roc selectively removes the remaining unbound variable (<code>a</code> in <code>[A, B]a</code> above) depending on the usage pattern of the variable, for example if it is used in an pattern match without a catch-all branch.</p>



<a name="497921897"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/497921897" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> osa1 <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#497921897">(Feb 05 2025 at 15:35)</a>:</h4>
<p><span class="user-mention" data-user-id="871424">@emma</span> Poly. variant implementation in Fir may be useful: <a href="https://github.com/fir-lang/fir">https://github.com/fir-lang/fir</a> it's basically "A Polymorphic Type System for Extensible Records and Variants" except it doesn't have "absent" constraints (yet, at least). I use them for error values and exceptions: <a href="https://osa1.net/posts/2025-01-18-fir-error-handling.html">https://osa1.net/posts/2025-01-18-fir-error-handling.html</a></p>



<a name="497922614"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/497922614" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> osa1 <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#497922614">(Feb 05 2025 at 15:38)</a>:</h4>
<p>We also had a discussion here with <span class="user-mention" data-user-id="454654">@Ayaz Hafiz</span> on variants and some of the counter intuitive type checking with rows, that may also be helpful. (gotta run now so can't find the thread, sorry)</p>



<a name="498253242"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/498253242" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wizard ish <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#498253242">(Feb 07 2025 at 03:28)</a>:</h4>
<p>Ok yall this might just be sleep deprivation talking but what do yall think about a C++ concepts / rewriting rules feature in Roc</p>



<a name="498253281"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/498253281" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wizard ish <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#498253281">(Feb 07 2025 at 03:29)</a>:</h4>
<p>That is to say, we have a way to say “if this expression is well formed, then for some other expression we can derive its meaning”</p>



<a name="498253523"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/498253523" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#498253523">(Feb 07 2025 at 03:31)</a>:</h4>
<p>I'm not understanding. Could you give an example?</p>



<a name="498253683"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/498253683" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wizard ish <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#498253683">(Feb 07 2025 at 03:33)</a>:</h4>
<p>So, like, basically auto functors</p>



<a name="498253781"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/498253781" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wizard ish <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#498253781">(Feb 07 2025 at 03:34)</a>:</h4>
<p>So, if we have a function f on x to y, we can apply f to Maybe x without specifying that it is a map</p>



<a name="498253965"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/498253965" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wizard ish <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#498253965">(Feb 07 2025 at 03:36)</a>:</h4>
<p>Basically, allowing code to be fully modular (a more complex structure can always be used in place of a simpler one)</p>



<a name="498254492"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/498254492" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#498254492">(Feb 07 2025 at 03:43)</a>:</h4>
<p>So this is a combo of Ocaml's module functors and Zig's "everything is a struct", right?</p>



<a name="498254617"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/498254617" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wizard ish <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#498254617">(Feb 07 2025 at 03:45)</a>:</h4>
<p>Essentially, yes</p>



<a name="498254690"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/498254690" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wizard ish <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#498254690">(Feb 07 2025 at 03:46)</a>:</h4>
<p>(From what I know of these)</p>



<a name="498254728"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/498254728" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#498254728">(Feb 07 2025 at 03:46)</a>:</h4>
<p>I think we've so far been successful in reducing the complexity of features in Roc to basically flavors of functions and values (values being sum or product types) with some light desugaring thrown on top. This comes with the recent push to remove proper typeclasses in the form of abilities and module params, since the simpler Roc without them can still be as productive as necessary</p>



<a name="498254764"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/498254764" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#498254764">(Feb 07 2025 at 03:46)</a>:</h4>
<p>I think adding a feature like that would be cool and I can definitely think of places we could get use out of it</p>



<a name="498254785"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/498254785" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#498254785">(Feb 07 2025 at 03:46)</a>:</h4>
<p>But I'm not sure how much we can do with that which we can't do today</p>



<a name="498254804"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/498254804" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#498254804">(Feb 07 2025 at 03:47)</a>:</h4>
<p>And it would now be in my eyes the most complex feature in Roc</p>



<a name="498254821"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/498254821" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#498254821">(Feb 07 2025 at 03:47)</a>:</h4>
<p>So that's a pretty high bar to hit, unless we can justify its addition</p>



<a name="498254840"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/498254840" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#498254840">(Feb 07 2025 at 03:47)</a>:</h4>
<p>So I'd love to see some patterns we think this could help with in Roc apps</p>



<a name="498254965"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/498254965" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wizard ish <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#498254965">(Feb 07 2025 at 03:49)</a>:</h4>
<p>Hmmmm yeah a simple type system is definitely better</p>



<a name="498406221"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/498406221" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#498406221">(Feb 07 2025 at 18:49)</a>:</h4>
<p>I didn't expect zig to be so similar to Roc. If zig did not exist and we made a low-level language starting from our Roc experience, we could have ended up very close to zig :)</p>



<a name="498406784"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/498406784" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jan kili <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#498406784">(Feb 07 2025 at 18:53)</a>:</h4>
<p><span aria-label="exploding head" class="emoji emoji-1f92f" role="img" title="exploding head">:exploding_head:</span> that's delightful to hear, now I may actually try learning it!</p>



<a name="498412516"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/498412516" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#498412516">(Feb 07 2025 at 19:29)</a>:</h4>
<p><span class="user-mention silent" data-user-id="361169">Anton</span> <a href="#narrow/stream/395097-compiler-development/topic/casual.20conversation/near/498406221">said</a>:</p>
<blockquote>
<p>I didn't expect zig to be so similar to Roc. If zig did not exist and we made a low-level language starting from our Roc experience, we could have ended up very close to zig :)</p>
</blockquote>
<p>What makes you say this? Just curious. I wouldn't consider them very similar, but I guess it depends on which aspect you re comparing.</p>



<a name="498493266"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/498493266" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#498493266">(Feb 08 2025 at 11:19)</a>:</h4>
<p>error union, try, switch, compiled, likes to go fast, type inference, structs are similar to records, no shadowing, generics, snake_case variables, PascalCase types, likes to keep it simple</p>



<a name="498519175"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/498519175" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lucas Rosa <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#498519175">(Feb 08 2025 at 17:21)</a>:</h4>
<p>saw the switching to zig thing, very cool, very very cool. Also nice that it's happening right in the repo next to the existing code. I'll keep an eye out, been needing an excuse to write some zig. I come to you now at the turn of the tide.</p>



<a name="498519499"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/498519499" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#498519499">(Feb 08 2025 at 17:25)</a>:</h4>
<p>good to see you Lucas :)</p>



<a name="498519740"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/498519740" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lucas Rosa <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#498519740">(Feb 08 2025 at 17:28)</a>:</h4>
<p>nice to see you too Anton. My Aiken side quest was fruitful and it got the niche adoption it needed to last haha. New gig is compiler stuff for this language called compact that compiles to zero knowledge circuits.</p>



<a name="498520011"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/498520011" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#498520011">(Feb 08 2025 at 17:32)</a>:</h4>
<blockquote>
<p>zero knowledge circuits</p>
</blockquote>
<p>Can you define this? Or link to it?</p>



<a name="498520425"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/498520425" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lucas Rosa <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#498520425">(Feb 08 2025 at 17:37)</a>:</h4>
<p><span class="user-mention" data-user-id="343810">@Brendan Hansknecht</span> this kind of thing<br>
<a href="https://eprint.iacr.org/2019/953.pdf">https://eprint.iacr.org/2019/953.pdf</a><br>
<a href="https://coingeek.com/how-plonk-works-part-1/">https://coingeek.com/how-plonk-works-part-1/</a></p>



<a name="498524425"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/498524425" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#498524425">(Feb 08 2025 at 18:31)</a>:</h4>
<p>Interesting, I've forgotten the details of how zero knowledge proofs work but I do remember that I thought it was cool <span aria-label="big smile" class="emoji emoji-1f604" role="img" title="big smile">:big_smile:</span></p>



<a name="498557884"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/498557884" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#498557884">(Feb 09 2025 at 02:38)</a>:</h4>
<p>I just locally added a <code>.ignore</code> file that ignores the crates directory. So nice to have helix only seeing the new compiler and limited files.</p>



<a name="498609088"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/498609088" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#498609088">(Feb 09 2025 at 15:34)</a>:</h4>
<p>Yeah, I'm happy only opening the src/ directory in Neovim</p>



<a name="498618946"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/498618946" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#498618946">(Feb 09 2025 at 17:42)</a>:</h4>
<p>I keep editing build and ci files which are outside of src</p>



<a name="498810023"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/498810023" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#498810023">(Feb 10 2025 at 16:40)</a>:</h4>
<p>Seems like a lot of people are excited to contribute because of the accessibility of a rewrite! You love to see it</p>



<a name="498877719"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/498877719" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#498877719">(Feb 10 2025 at 22:30)</a>:</h4>
<p>Is there even a syntax planned to allow making custom tags for custom unions usable within the same module in the way that you can <code>import exposing [Result.[Ok, Err]]</code>?</p>



<a name="498877766"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/498877766" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#498877766">(Feb 10 2025 at 22:31)</a>:</h4>
<p>Trying to figure out if/how canonicalization scope should handle that</p>



<a name="498877789"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/498877789" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#498877789">(Feb 10 2025 at 22:31)</a>:</h4>
<p>I think the answer is no right now</p>



<a name="499163334"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/499163334" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#499163334">(Feb 12 2025 at 07:18)</a>:</h4>
<p><span class="user-mention" data-user-id="453336">@Joshua Warner</span> do you have a plan for how the compiler post-parsing will know the "region" for some entity?</p>



<a name="499163424"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/499163424" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#499163424">(Feb 12 2025 at 07:19)</a>:</h4>
<p>Will it be a pair of token IDs, a start and an end index into the source file, or a line and a column?</p>



<a name="499163481"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/499163481" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#499163481">(Feb 12 2025 at 07:19)</a>:</h4>
<p>Or is that info not expected to last past parsing/maybe formatting in this compiler</p>



<a name="499258534"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/499258534" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#499258534">(Feb 12 2025 at 15:12)</a>:</h4>
<p>I’ve gone back and forth on that</p>



<a name="499258658"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/499258658" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#499258658">(Feb 12 2025 at 15:13)</a>:</h4>
<p>I would say probably not separate line/col numbers</p>



<a name="499259049"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/499259049" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#499259049">(Feb 12 2025 at 15:14)</a>:</h4>
<p>The simplest of course is probably a pair of byte offsets</p>



<a name="499259465"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/499259465" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#499259465">(Feb 12 2025 at 15:16)</a>:</h4>
<p>The possibly compelling alternative would be to use a node id for a parser node - that’s a single u32 that can be mapped back to a precise source range when needed, and is smaller that the u32 pair needed for a byte range</p>



<a name="501342330"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/501342330" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#501342330">(Feb 23 2025 at 06:23)</a>:</h4>
<p>When someone runs <code>roc check Module.roc</code> and <code>Module.roc</code> is not the root of its package, or at least not the only file in the package, which set of diagnostics do we want to show them?</p>
<ul>
<li>Only errors for that file, ignoring those from other files</li>
<li>Only errors for that file and its dependencies</li>
<li>All errors from the package</li>
</ul>
<p>It seems pretty easy to do the last one, and I'm not sure if someone would want the other cases, though maybe I'd understand the second one. It also shouldn't be that hard to implement.</p>



<a name="501360486"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/501360486" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#501360486">(Feb 23 2025 at 10:22)</a>:</h4>
<p>Also, we currently allow setting an alternative package main file using a query fragment in the package download URL, and I don't think there's a need for that anymore. Anyone opposed to me removing that?</p>



<a name="501372912"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/501372912" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#501372912">(Feb 23 2025 at 13:03)</a>:</h4>
<p>I think it's one of the first two</p>



<a name="501372975"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/501372975" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#501372975">(Feb 23 2025 at 13:04)</a>:</h4>
<p>one way to think about this is "if I want a particular set of outputs, is there any possible way to convince the compiler to give them to me?"</p>



<a name="501372984"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/501372984" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#501372984">(Feb 23 2025 at 13:04)</a>:</h4>
<p>Yep</p>



<a name="501372995"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/501372995" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#501372995">(Feb 23 2025 at 13:04)</a>:</h4>
<p>there's certainly already a way to say "give me all the errors from the package"</p>



<a name="501373001"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/501373001" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#501373001">(Feb 23 2025 at 13:04)</a>:</h4>
<p>namely, give <code>roc check</code> the package's root module directly</p>



<a name="501373026"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/501373026" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#501373026">(Feb 23 2025 at 13:05)</a>:</h4>
<p>so then the question is, if I say "I want <code>roc check</code> to check just this one file" - do I also want it to give me the errors from its dependencies, or not?</p>



<a name="501373040"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/501373040" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#501373040">(Feb 23 2025 at 13:05)</a>:</h4>
<p>The decision between the first two in my mind is "if we give only the errors for a single module even if its deps are wrong, then is that correct?"</p>



<a name="501373044"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/501373044" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#501373044">(Feb 23 2025 at 13:05)</a>:</h4>
<p>yeah</p>



<a name="501373052"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/501373052" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#501373052">(Feb 23 2025 at 13:05)</a>:</h4>
<p>I can see arguments either way <span aria-label="thinking" class="emoji emoji-1f914" role="img" title="thinking">:thinking:</span></p>



<a name="501373070"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/501373070" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#501373070">(Feb 23 2025 at 13:05)</a>:</h4>
<p>like "I know about those, I'm not working on them right now" vs. "I want to know if this thing completely works"</p>



<a name="501373118"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/501373118" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#501373118">(Feb 23 2025 at 13:06)</a>:</h4>
<p>Lets say my module imports something that's malformed. We won't report two errors, so it'll look like my usage is correct even if the thing I imported is broken</p>



<a name="501373157"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/501373157" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#501373157">(Feb 23 2025 at 13:07)</a>:</h4>
<p>Doing just the current file and nothing else should be easier to implement actually</p>



<a name="501373182"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/501373182" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#501373182">(Feb 23 2025 at 13:07)</a>:</h4>
<p>Because we'd have to analyze the dep tree for "this modules and its deps"</p>



<a name="501373203"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/501373203" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#501373203">(Feb 23 2025 at 13:07)</a>:</h4>
<p>We <em>naively</em> can't use the toposorted module list because its sorted over all modules</p>



<a name="501373261"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/501373261" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#501373261">(Feb 23 2025 at 13:08)</a>:</h4>
<p>I'll ignore implementation for now</p>



<a name="501373278"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/501373278" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#501373278">(Feb 23 2025 at 13:08)</a>:</h4>
<p>Yeah, not sure</p>



<a name="501373295"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/501373295" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#501373295">(Feb 23 2025 at 13:09)</a>:</h4>
<p>I'll default to just the current module for now to avoid bikeshedding</p>



<a name="501373337"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/501373337" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#501373337">(Feb 23 2025 at 13:10)</a>:</h4>
<p>And we can do the option of "my module and its deps" later since it's more work but not obviously the right option</p>



<a name="501389452"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/501389452" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#501389452">(Feb 23 2025 at 16:28)</a>:</h4>
<p>The big thing for me is that I think it should fully check the single module if possible</p>



<a name="501389473"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/501389473" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#501389473">(Feb 23 2025 at 16:28)</a>:</h4>
<p>This means it must know all of the types of the imports</p>



<a name="501389552"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/501389552" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#501389552">(Feb 23 2025 at 16:30)</a>:</h4>
<p>I don't think it needs to recursively check all dependencies even things that aren't used.</p>



<a name="501413736"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/501413736" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#501413736">(Feb 23 2025 at 21:57)</a>:</h4>
<p>Yes, I think we should do typechecking and all for at least the module and its deps. I'm just suggesting that we only report the errors for that module</p>



<a name="501413848"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/501413848" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#501413848">(Feb 23 2025 at 21:59)</a>:</h4>
<p>yeah the work for sure has to be done regardless</p>



<a name="501413864"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/501413864" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#501413864">(Feb 23 2025 at 21:59)</a>:</h4>
<p>I think it could be confusing if we don't show errors from other modules</p>



<a name="501415162"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/501415162" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wizard ish <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#501415162">(Feb 23 2025 at 22:15)</a>:</h4>
<p>out of curiosity, what is the theoretical / computational model that Roc's type system uses?</p>



<a name="501415390"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/501415390" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#501415390">(Feb 23 2025 at 22:18)</a>:</h4>
<p>There's some notes here <a href="https://github.com/roc-lang/roc/blob/c72993c7519188698937bcc359d15e5b032ebe78/crates/compiler/solve/src/solve.rs#L44">https://github.com/roc-lang/roc/blob/c72993c7519188698937bcc359d15e5b032ebe78/crates/compiler/solve/src/solve.rs#L44</a></p>



<a name="501415404"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/501415404" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#501415404">(Feb 23 2025 at 22:18)</a>:</h4>
<p>My understanding it that it's very similar to HM</p>



<a name="501415425"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/501415425" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#501415425">(Feb 23 2025 at 22:19)</a>:</h4>
<p>Also see <a href="https://github.com/roc-lang/rfcs/blob/ayaz/compile-with-lambda-sets/0102-compiling-lambda-sets.md">https://github.com/roc-lang/rfcs/blob/ayaz/compile-with-lambda-sets/0102-compiling-lambda-sets.md</a></p>



<a name="501415445"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/501415445" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#501415445">(Feb 23 2025 at 22:19)</a>:</h4>
<p>This is a new architecture that <span class="user-mention" data-user-id="454654">@Ayaz Hafiz</span> laid out to solve our issues with compiling Lambda Sets</p>



<a name="501415529"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/501415529" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#501415529">(Feb 23 2025 at 22:20)</a>:</h4>
<p>That RFCS repository has a lot of gold in there</p>



<a name="502967303"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/502967303" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#502967303">(Mar 03 2025 at 08:30)</a>:</h4>
<p>My first pass at implementing the <a href="https://github.com/roc-lang/roc/blob/main/src/coordinate.zig">coordinate</a> logic has just been merged in (<a href="https://github.com/roc-lang/roc/pull/7625">PR</a>), meaning that the main thrust of the work to typecheck or build a module (and its deps) is put together, outside of running the code with the interpreter/LLVM. I'm sure there are some bugs in the impl, but we'll want to get something basic working for canonicalization and import resolution to work said bugs out, so those stages are my next project.</p>
<p>As a side benefit, I was able to remove most of the <code>refAllDeclsRecursive</code> calls from our <a href="https://github.com/roc-lang/roc/blob/main/src/test.zig">testing entrypoint</a>.</p>



<a name="503153647"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/503153647" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#503153647">(Mar 04 2025 at 00:46)</a>:</h4>
<p>So... argument order. I tend to write functions with "stuff to focus on" near the front of the arg list, and "needed context" near the end of the arg list. This is the Roc way to do it, and usually the Rust way as well. But in Zig, the allocator seems to usually get passed first (or second after the method target). What's the right pattern here?</p>



<a name="503153951"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/503153951" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#503153951">(Mar 04 2025 at 00:50)</a>:</h4>
<p>Yeah, zig's default is allocator first</p>



<a name="503153968"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/503153968" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#503153968">(Mar 04 2025 at 00:50)</a>:</h4>
<p>I would lean towargs following that convention</p>



<a name="503153999"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/503153999" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#503153999">(Mar 04 2025 at 00:50)</a>:</h4>
<p>So I would say env/allocator first (and I assume env stores the allocator so you never need both)</p>



<a name="503154027"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/503154027" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#503154027">(Mar 04 2025 at 00:51)</a>:</h4>
<p>But ultimately it is pretty minor, it is more important we aim to be consistent than which choice we pick</p>



<a name="503154030"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/503154030" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#503154030">(Mar 04 2025 at 00:51)</a>:</h4>
<p>But just the allocator? A lot of our functions in the Rust-based compiler use <code>env</code> and <code>arena</code>. Would it be better to do <code>(gpa, important, other, env)</code> or <code>(gpa, env, important, other)</code>?</p>



<a name="503154082"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/503154082" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#503154082">(Mar 04 2025 at 00:51)</a>:</h4>
<p>Yeah, I was gonna vote we put the <code>gpa</code> in the <code>env</code> to make it less of a pain to use unmanaged lists, and then convert the <code>Safe(Multi)List</code> types to unmanaged</p>



<a name="503154097"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/503154097" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#503154097">(Mar 04 2025 at 00:52)</a>:</h4>
<p>I personally would lean to <code>env, gpa, important, other</code>. It feels most conventionally correct.</p>



<a name="503154169"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/503154169" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#503154169">(Mar 04 2025 at 00:52)</a>:</h4>
<p>But yaeh, I would put gpa in the env</p>



<a name="503154193"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/503154193" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#503154193">(Mar 04 2025 at 00:52)</a>:</h4>
<p>Then you only need to pass around local arenas (which I think will be relatively rare)</p>



<a name="503154217"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/503154217" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#503154217">(Mar 04 2025 at 00:52)</a>:</h4>
<p>Okay, sounds good</p>



<a name="503176806"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/503176806" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#503176806">(Mar 04 2025 at 04:18)</a>:</h4>
<p>On the above discussion, here's a PR for cleanup: <a href="https://github.com/roc-lang/roc/pull/7657">https://github.com/roc-lang/roc/pull/7657</a></p>
<ul>
<li>Prefer passing the <code>std.mem.Allocator</code> as the first argument to functions</li>
<li>Put the <code>gpa: std.mem.Allocator</code> in <code>base.ModuleEnv</code> and prefer that for passing around the <code>Allocator</code><ul>
<li>the <code>ModuleEnv</code> should be used enough to usually be in the L1 cache, meaning the double indirection of <code>ir.env.gpa</code> shouldn't be expensive</li>
</ul>
</li>
<li>Prefer <code>ArrayListUnmanaged</code> over <code>ArrayList</code> (same for all list-backed collections) since it avoids storing a pointer to the <code>Allocator</code> in every collection<ul>
<li>Not enforced for testing collections/buffers</li>
</ul>
</li>
<li>Use Andrew Kelley's suggestion for catching OOM errors by capturing the <code>Allocator.Error</code> instead of discarding it, this should prevent us from accidentally over/under-catching errors</li>
</ul>
<p><span class="user-mention" data-user-id="343810">@Brendan Hansknecht</span> please take a look if you get a chance</p>



<a name="503176851"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/503176851" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#503176851">(Mar 04 2025 at 04:19)</a>:</h4>
<p>It's extremely mechanical as PRs come, but it's 32 files, so no pressure if you don't have time</p>



<a name="503178585"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/503178585" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#503178585">(Mar 04 2025 at 04:34)</a>:</h4>
<p><span class="user-mention" data-user-id="343810">@Brendan Hansknecht</span> what's the strategy for avoiding <code>for (items) |item| item.deinit()</code> deeper in our data types? Making an arena just for that collection, or making a top-level arena that gets passed around, or something else?</p>



<a name="503181195"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/503181195" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#503181195">(Mar 04 2025 at 05:00)</a>:</h4>
<p>Depends on the specific use case. One option is definitely to just use an arena for the items if they never grow and that is reasonable. Another option would be to flatten things out more. That way instead of a list of lists, you have a list of slices and then a second list of data.</p>
<p>I think flattening is what would make most sense for <code>exposed_idents</code>. Cause exposed_idents is a static slice of data essentially. So instead of nesting you would have a larger context <code>ollections.SafeList(Ident.Idx)</code>. Then you would have each ModuleImport include <code>exposed_idents</code> as a Slice into the list.</p>



<a name="503181337"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/503181337" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#503181337">(Mar 04 2025 at 05:00)</a>:</h4>
<p>slice being two <code>u32</code>s, not a zig slice</p>



<a name="503181371"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/503181371" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#503181371">(Mar 04 2025 at 05:01)</a>:</h4>
<p>Thinking about that latest video from Andrew, that makes sense</p>



<a name="503181478"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/503181478" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#503181478">(Mar 04 2025 at 05:02)</a>:</h4>
<p>Yeah, it is exactly that pattern</p>



<a name="503215249"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/503215249" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#503215249">(Mar 04 2025 at 09:13)</a>:</h4>
<p>Do we want to support two imports of the same external module in a single module? Feels like yes or no, it doesn't matter much. It feels like there's not much of a reason to want that except for only exposing some ident in a more narrow scope. At least at the top level, I don't see it being much besides a fragmentation in imports that makes reading harder. Could we maybe put warnings on subsequent imports at the top level?</p>



<a name="503215273"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/503215273" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#503215273">(Mar 04 2025 at 09:14)</a>:</h4>
<p>That's my current plan until we decide otherwise</p>



<a name="503215758"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/503215758" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#503215758">(Mar 04 2025 at 09:16)</a>:</h4>
<p>I'm being reminded by the parsed AST that we can do <code>import Foo as AliasedFoo</code>, and that might be useful to allow two of.</p>



<a name="503215810"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/503215810" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#503215810">(Mar 04 2025 at 09:16)</a>:</h4>
<p>I'll forgo the warning for now to trim complexity and therefore implementation time</p>



<a name="503257566"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/503257566" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#503257566">(Mar 04 2025 at 12:44)</a>:</h4>
<p>yeah I agree with that plan!</p>
<p>I think it makes sense to treat imports like declarations: shadowing is a warning</p>



<a name="503257640"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/503257640" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#503257640">(Mar 04 2025 at 12:45)</a>:</h4>
<p>(and multiples is fine as long as they're in non overlapping scopes)</p>



<a name="503410476"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/503410476" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#503410476">(Mar 05 2025 at 02:55)</a>:</h4>
<p><span class="user-mention silent" data-user-id="461444">Sam Mohr</span> <a href="#narrow/channel/395097-compiler-development/topic/casual.20conversation/near/503176806">said</a>:</p>
<blockquote>
<p>On the above discussion, here's a PR for cleanup: <a href="https://github.com/roc-lang/roc/pull/7657">https://github.com/roc-lang/roc/pull/7657</a></p>
<ul>
<li>Prefer passing the <code>std.mem.Allocator</code> as the first argument to functions</li>
<li>Put the <code>gpa: std.mem.Allocator</code> in <code>base.ModuleEnv</code> and prefer that for passing around the <code>Allocator</code><ul>
<li>the <code>ModuleEnv</code> should be used enough to usually be in the L1 cache, meaning the double indirection of <code>ir.env.gpa</code> shouldn't be expensive</li>
</ul>
</li>
<li>Prefer <code>ArrayListUnmanaged</code> over <code>ArrayList</code> (same for all list-backed collections) since it avoids storing a pointer to the <code>Allocator</code> in every collection<ul>
<li>Not enforced for testing collections/buffers</li>
</ul>
</li>
<li>Use Andrew Kelley's suggestion for catching OOM errors by capturing the <code>Allocator.Error</code> instead of discarding it, this should prevent us from accidentally over/under-catching errors</li>
</ul>
<p><span class="user-mention silent" data-user-id="343810">Brendan Hansknecht</span> please take a look if you get a chance</p>
</blockquote>
<p>I wish I had built my change on top of this....</p>



<a name="503410574"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/503410574" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#503410574">(Mar 05 2025 at 02:56)</a>:</h4>
<p>Have a bad merge/rebase now?</p>



<a name="503410652"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/503410652" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#503410652">(Mar 05 2025 at 02:56)</a>:</h4>
<p>It's not gonna be too bad, just tedious.  I'll probably just checkout my copy of all of these and fix the errors by hand</p>



<a name="503410684"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/503410684" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#503410684">(Mar 05 2025 at 02:57)</a>:</h4>
<p>I touched most of the <code>append</code> calls</p>



<a name="503410712"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/503410712" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#503410712">(Mar 05 2025 at 02:57)</a>:</h4>
<p>And removed a ton of them</p>



<a name="503410736"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/503410736" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#503410736">(Mar 05 2025 at 02:57)</a>:</h4>
<p>Make sure to check my comment on your PR</p>



<a name="503410865"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/503410865" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#503410865">(Mar 05 2025 at 02:58)</a>:</h4>
<p>That solution really doesn't work</p>



<a name="503410884"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/503410884" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#503410884">(Mar 05 2025 at 02:58)</a>:</h4>
<p>Those items aren't in scratch anymore</p>



<a name="503411023"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/503411023" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#503411023">(Mar 05 2025 at 02:59)</a>:</h4>
<p>I could get rid of the iterator completely honestly, and would do that over returning a slice over the extra data</p>



<a name="503411256"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/503411256" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#503411256">(Mar 05 2025 at 03:01)</a>:</h4>
<p>That's what I wrote, right?</p>



<a name="503411333"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/503411333" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#503411333">(Mar 05 2025 at 03:01)</a>:</h4>
<p>The <code>*Iter</code> functions just create an <code>Iter</code> around an <code>ArrayList</code> of the <code>extra_data</code></p>



<a name="503411398"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/503411398" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#503411398">(Mar 05 2025 at 03:02)</a>:</h4>
<p>And you want it to be typed ids</p>



<a name="503411486"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/503411486" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#503411486">(Mar 05 2025 at 03:02)</a>:</h4>
<p>So you can make that happen by making the desired slice into the <code>UnmanagedArrayList</code> and calling <code>@ptrCast</code> to change the <code>[]const u32</code> into <code>[]const StatementIdx</code></p>



<a name="503411510"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/503411510" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#503411510">(Mar 05 2025 at 03:03)</a>:</h4>
<p>That would look like this in usage:</p>
<div class="codehilite" data-code-language="Zig"><pre><span></span><code><span class="w">            </span><span class="kr">var</span><span class="w"> </span><span class="n">i</span><span class="o">:</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">@as</span><span class="p">(</span><span class="kt">usize</span><span class="p">,</span><span class="w"> </span><span class="nb">@intCast</span><span class="p">(</span><span class="n">t</span><span class="p">.</span><span class="n">annos</span><span class="p">.</span><span class="n">span</span><span class="p">.</span><span class="n">start</span><span class="p">));</span>
<span class="w">            </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">t</span><span class="p">.</span><span class="n">annos</span><span class="p">.</span><span class="n">span</span><span class="p">.</span><span class="n">start</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">t</span><span class="p">.</span><span class="n">annos</span><span class="p">.</span><span class="n">span</span><span class="p">.</span><span class="n">len</span><span class="p">)</span><span class="w">  </span><span class="p">{</span>
<span class="w">                </span><span class="kr">const</span><span class="w"> </span><span class="n">ann</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TypeAnnoIdx</span><span class="p">{</span><span class="w"> </span><span class="p">.</span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fmt</span><span class="p">.</span><span class="n">ast</span><span class="p">.</span><span class="n">store</span><span class="p">.</span><span class="n">extra_data</span><span class="p">.</span><span class="n">items</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">};</span>
<span class="w">                </span><span class="n">fmt</span><span class="p">.</span><span class="n">formatTypeAnno</span><span class="p">(</span><span class="n">an</span><span class="p">);</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="p">(</span><span class="n">t</span><span class="p">.</span><span class="n">annos</span><span class="p">.</span><span class="n">span</span><span class="p">.</span><span class="n">len</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="n">fmt</span><span class="p">.</span><span class="n">pushAll</span><span class="p">(</span><span class="s">", "</span><span class="p">);</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">                </span><span class="n">i</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">            </span><span class="p">}</span>
</code></pre></div>
<p>over the current</p>
<div class="codehilite" data-code-language="Zig"><pre><span></span><code><span class="w">            </span><span class="kr">var</span><span class="w"> </span><span class="n">anno_iter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fmt</span><span class="p">.</span><span class="n">ast</span><span class="p">.</span><span class="n">store</span><span class="p">.</span><span class="n">typeAnnoIter</span><span class="p">(</span><span class="n">t</span><span class="p">.</span><span class="n">annos</span><span class="p">);</span>
<span class="w">            </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">anno_iter</span><span class="p">.</span><span class="n">next</span><span class="p">())</span><span class="w"> </span><span class="o">|</span><span class="n">an</span><span class="o">|</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">fmt</span><span class="p">.</span><span class="n">formatTypeAnno</span><span class="p">(</span><span class="n">an</span><span class="p">);</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="p">(</span><span class="n">t</span><span class="p">.</span><span class="n">annos</span><span class="p">.</span><span class="n">span</span><span class="p">.</span><span class="n">len</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="n">fmt</span><span class="p">.</span><span class="n">pushAll</span><span class="p">(</span><span class="s">", "</span><span class="p">);</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">                </span><span class="n">i</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">            </span><span class="p">}</span>
</code></pre></div>



<a name="503411520"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/503411520" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#503411520">(Mar 05 2025 at 03:03)</a>:</h4>
<p>I literally made the change in my editor for expressions and everything compiled</p>



<a name="503411655"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/503411655" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#503411655">(Mar 05 2025 at 03:04)</a>:</h4>
<p>I'm sorry, but I'm not sure why those are desirable over </p>
<div class="codehilite" data-code-language="Zig"><pre><span></span><code><span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">fmt</span><span class="p">.</span><span class="n">ast</span><span class="p">.</span><span class="n">store</span><span class="p">.</span><span class="n">typeAnnoSlice</span><span class="p">(</span><span class="n">t</span><span class="p">.</span><span class="n">annos</span><span class="p">))</span><span class="w"> </span><span class="o">|</span><span class="n">an</span><span class="o">|</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">fmt</span><span class="p">.</span><span class="n">formatTypeAnno</span><span class="p">(</span><span class="n">an</span><span class="p">);</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="p">(</span><span class="n">t</span><span class="p">.</span><span class="n">annos</span><span class="p">.</span><span class="n">span</span><span class="p">.</span><span class="n">len</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="n">fmt</span><span class="p">.</span><span class="n">pushAll</span><span class="p">(</span><span class="s">", "</span><span class="p">);</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">            </span><span class="p">}</span>
</code></pre></div>



<a name="503411661"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/503411661" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#503411661">(Mar 05 2025 at 03:04)</a>:</h4>
<p>Sorry, I misread the code you wrote.  I'm literally was trying to avoid slices here at all</p>



<a name="503411682"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/503411682" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#503411682">(Mar 05 2025 at 03:04)</a>:</h4>
<p>I'm not sure why you'd want to, the Zig compiler works with slices really well</p>



<a name="503411699"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/503411699" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#503411699">(Mar 05 2025 at 03:05)</a>:</h4>
<p>Well the first option doesn't create a struct of any sort if that's what we are optimizing for</p>



<a name="503411752"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/503411752" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#503411752">(Mar 05 2025 at 03:05)</a>:</h4>
<p>I'm optimizing for <code>for (items) |item|</code> working well in Zig</p>



<a name="503411859"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/503411859" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#503411859">(Mar 05 2025 at 03:06)</a>:</h4>
<p>And it's more terse than the other options</p>



<a name="503411864"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/503411864" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#503411864">(Mar 05 2025 at 03:06)</a>:</h4>
<p>If you have reason to believe that is truly faster, then I will do it</p>



<a name="503411915"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/503411915" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#503411915">(Mar 05 2025 at 03:06)</a>:</h4>
<p>I think it's more terse and at least as performant, if not <em>sketchy maybe</em> faster</p>



<a name="503411964"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/503411964" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#503411964">(Mar 05 2025 at 03:07)</a>:</h4>
<p>The iterator needs to do math and casting every time between number types</p>



<a name="503411980"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/503411980" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#503411980">(Mar 05 2025 at 03:07)</a>:</h4>
<p>A slice doesn't seem to have those problems</p>



<a name="503412194"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/503412194" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#503412194">(Mar 05 2025 at 03:09)</a>:</h4>
<p>Ok, I just wish that kind of feedback could have came on the first PR - whose purpose was to get such feedback so I applied something everyone was on-board with before doing it everywhere.</p>
<p>But luckily this is largely a mechanical change - maybe I could even make it comptime and reduce the number of unique functions I have to maintain here</p>



<a name="503412211"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/503412211" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#503412211">(Mar 05 2025 at 03:09)</a>:</h4>
<p>I'll do the change for you if you want</p>



<a name="503412215"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/503412215" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#503412215">(Mar 05 2025 at 03:09)</a>:</h4>
<p>I'm happy to</p>



<a name="503412221"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/503412221" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#503412221">(Mar 05 2025 at 03:09)</a>:</h4>
<p>No worries</p>



<a name="503412233"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/503412233" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#503412233">(Mar 05 2025 at 03:09)</a>:</h4>
<p>I'm already doing a rebase</p>



<a name="503412307"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/503412307" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#503412307">(Mar 05 2025 at 03:10)</a>:</h4>
<p>I can get rid of two struct defs and hopefully 7-8 functions</p>



<a name="503412338"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/503412338" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#503412338">(Mar 05 2025 at 03:10)</a>:</h4>
<p>And about 8 type aliases</p>



<a name="503412365"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/503412365" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#503412365">(Mar 05 2025 at 03:10)</a>:</h4>
<p>It'll cut about 60 LOC</p>



<a name="503412372"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/503412372" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#503412372">(Mar 05 2025 at 03:10)</a>:</h4>
<p>yeet</p>



<a name="503412392"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/503412392" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#503412392">(Mar 05 2025 at 03:11)</a>:</h4>
<p>The problem I had with slices won't affect me here</p>



<a name="503412457"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/503412457" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#503412457">(Mar 05 2025 at 03:11)</a>:</h4>
<p>I didn't think about that before and was worried about slices in general - but that's only an issue when we are appending to them (and they can resize and invalidate pointers)</p>



<a name="503412477"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/503412477" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#503412477">(Mar 05 2025 at 03:12)</a>:</h4>
<p>makes sense</p>



<a name="503412645"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/503412645" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#503412645">(Mar 05 2025 at 03:13)</a>:</h4>
<p>I'll have that change (and merge conflicts addressed) in the morning</p>



<a name="503414188"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/503414188" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#503414188">(Mar 05 2025 at 03:26)</a>:</h4>
<p>Yeah, not going to try to comptime it.  it really won't save much code since Idxs and DataSpans aren't Generic.  I'd have to write a complicated comptime block that seems too clever by half</p>



<a name="503414237"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/503414237" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#503414237">(Mar 05 2025 at 03:27)</a>:</h4>
<p>I'll just replace the Iter functions with Slice functions and remove the Iterator and IdIterator structs and the type aliases</p>



<a name="503496292"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/503496292" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#503496292">(Mar 05 2025 at 12:14)</a>:</h4>
<p>Ok, this is done</p>



<a name="504117365"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/504117365" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jared <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#504117365">(Mar 07 2025 at 15:08)</a>:</h4>
<p>Do y'all already have a plan for how to do type inference w/ multiple static dispatch? (the planned replacement for abilities). I looked into how koka does it, and it leaves a lot to be desired.</p>



<a name="504147905"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/504147905" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#504147905">(Mar 07 2025 at 17:37)</a>:</h4>
<p><span aria-label="thinking" class="emoji emoji-1f914" role="img" title="thinking">:thinking:</span> what's multiple static dispatch?</p>



<a name="504149407"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/504149407" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jared <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#504149407">(Mar 07 2025 at 17:45)</a>:</h4>
<p>I may have misinterpreted this line<br>
<a href="/user_uploads/22008/IcP3Bea4WCvrX8guTDve_sxL/image.png">image.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/22008/IcP3Bea4WCvrX8guTDve_sxL/image.png" title="image.png"><img data-original-content-type="image/png" data-original-dimensions="1780x162" src="/user_uploads/thumbnail/22008/IcP3Bea4WCvrX8guTDve_sxL/image.png/840x560.webp"></a></div>



<a name="504149592"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/504149592" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jared <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#504149592">(Mar 07 2025 at 17:46)</a>:</h4>
<p>I figured it meant koka-style "there are multiple functions in scope with the same name, and we use type inference to determine which one to use". It's a way of doing ability-like or typeclass-like behavior</p>



<a name="504156711"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/504156711" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#504156711">(Mar 07 2025 at 18:23)</a>:</h4>
<p>If we see <code>x.foo(a, b, c)</code>. We query the type of <code>x</code>. When then load the module that type is from and call <code>ModuleOf(x).foo(x, a, b, c)</code></p>



<a name="504156894"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/504156894" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#504156894">(Mar 07 2025 at 18:24)</a>:</h4>
<p>x must get specialized to a concrete type for this dispatch to work.</p>



<a name="504156967"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/504156967" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#504156967">(Mar 07 2025 at 18:25)</a>:</h4>
<p><span class="user-mention" data-user-id="343810">@Brendan Hansknecht</span> we actually plan to allow multiple custom types per module, though a single one per module is preferred</p>



<a name="504157025"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/504157025" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#504157025">(Mar 07 2025 at 18:25)</a>:</h4>
<p>Sure, that is unrelated to my comment though.</p>



<a name="504157066"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/504157066" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#504157066">(Mar 07 2025 at 18:25)</a>:</h4>
<p>So it's a module lookup paired with a type lookup</p>



<a name="504157280"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/504157280" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#504157280">(Mar 07 2025 at 18:26)</a>:</h4>
<p>Type doesn't really matter (past finding the module) cause we don't have namespaces within modules. So the module + function name is a unique identifier. Of course can still get a type mismatch if you use the wrong custom type.</p>



<a name="504157386"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/504157386" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#504157386">(Mar 07 2025 at 18:27)</a>:</h4>
<p>yep</p>



<a name="504158689"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/504158689" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jared <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#504158689">(Mar 07 2025 at 18:33)</a>:</h4>
<p>yeah so "if we see x, we query the type of x", if implemented in the koka way, <em>really</em> restricts things in an annoying way. For example, in koka, if you have</p>
<div class="codehilite"><pre><span></span><code>fun x(y) {
   y.z() + 2
}
</code></pre></div>
<p>if there are two <code>z</code> functions available, one returning an <code>int</code> and one returning a <code>string</code>, you would think that this should be inferrable because the return value is being used as an <code>int</code>. But koka chokes on this, requiring you to add an annotation or disambiguate the z with a prefix. imo this forfeits one of the key benefits of hindley-milner-style type inference, namely that the "order" of expressions doesn't matter, all information is essentially considered "at once".</p>



<a name="504158907"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/504158907" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jared <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#504158907">(Mar 07 2025 at 18:34)</a>:</h4>
<p>I've been thinking about how to implement something like this for my own language, and I think the route I'll take is, if you see a <code>z</code> that is ambiguous, just give it a type variable, and let inference continue. At the end of inference, find all the type variables that were created in this manner, and then use the type information that resulted from the inference to disambiguate.</p>



<a name="504159064"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/504159064" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#504159064">(Mar 07 2025 at 18:35)</a>:</h4>
<p>We'd infer the type of that function as</p>
<div class="codehilite" data-code-language="Ruby"><pre><span></span><code><span class="n">x</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="no">Num</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">where</span><span class="w"> </span><span class="n">y</span><span class="o">.</span><span class="n">z</span><span class="p">()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="no">Num</span><span class="w"> </span><span class="n">a</span>
<span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">|</span><span class="n">y</span><span class="o">|</span><span class="w"> </span><span class="n">y</span><span class="o">.</span><span class="n">z</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">2</span>
</code></pre></div>



<a name="504159349"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/504159349" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#504159349">(Mar 07 2025 at 18:36)</a>:</h4>
<p>In that <code>y.z()</code> is inferred as <code>y where y.z() -&gt; b</code> and then <code>b</code> is constrained to some number type <code>Num a</code> because of the addition</p>



<a name="504159547"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/504159547" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jared <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#504159547">(Mar 07 2025 at 18:37)</a>:</h4>
<p>ok and if there's later in that function something that makes the type of y concrete, you then do the module lookup to satisfy the "where" bound?</p>



<a name="504159620"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/504159620" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#504159620">(Mar 07 2025 at 18:38)</a>:</h4>
<p>Yes</p>



<a name="504159649"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/504159649" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jared <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#504159649">(Mar 07 2025 at 18:38)</a>:</h4>
<p>solid</p>



<a name="504159780"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/504159780" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jared <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#504159780">(Mar 07 2025 at 18:39)</a>:</h4>
<p>does <code>where y.z() -&gt; Num a</code> mean <code>where ModuleOf(y).z(y) -&gt; Num a</code>?</p>



<a name="504159835"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/504159835" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#504159835">(Mar 07 2025 at 18:39)</a>:</h4>
<p>Basically</p>



<a name="504159891"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/504159891" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jared <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#504159891">(Mar 07 2025 at 18:39)</a>:</h4>
<p>yeah that's a neat solution</p>



<a name="504160053"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/504160053" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#504160053">(Mar 07 2025 at 18:40)</a>:</h4>
<p>It means "in the module where the custom type <code>y</code> is defined, there needs to be a function <code>z</code> that returns a type that unifies with <code>Num a</code>, and the function <code>z</code> needs to take a <code>y</code> as the first and only arg"</p>



<a name="504160131"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/504160131" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#504160131">(Mar 07 2025 at 18:40)</a>:</h4>
<p>We discussed what you're calling multiple dispatch a little bit and it got ruled out for ambiguity reasons</p>



<a name="504160567"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/504160567" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jared <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#504160567">(Mar 07 2025 at 18:43)</a>:</h4>
<p>custom type means "nominal type", as opposed to structural, I imagine?</p>



<a name="504160588"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/504160588" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#504160588">(Mar 07 2025 at 18:43)</a>:</h4>
<p>Yep</p>



<a name="504160764"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/504160764" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jared <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#504160764">(Mar 07 2025 at 18:44)</a>:</h4>
<p>this does mean you would be able to have multi-type traits, but that seems like a reasonable sacrifice</p>



<a name="504160927"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/504160927" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#504160927">(Mar 07 2025 at 18:45)</a>:</h4>
<p>Also, you can explicitly do <code>module(y).foo(...)</code>. This is needed for things like <code>decode</code> where the type is not an arg.</p>



<a name="504161004"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/504161004" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#504161004">(Mar 07 2025 at 18:45)</a>:</h4>
<p>In this case <code>y</code> is a type variable.</p>



<a name="504161024"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/504161024" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#504161024">(Mar 07 2025 at 18:46)</a>:</h4>
<p>Not a regular variable</p>



<a name="506621818"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/506621818" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Trevor Settles <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#506621818">(Mar 19 2025 at 02:48)</a>:</h4>
<p>Is anyone doing some collaborative coding, like pairing or ensemble programming while working on the compiler? I had tried to do some work on the rust compiler, but never quite found a foothold in the codebase. It seems like now might be a good time to get back into it, since things are smaller and a little more well-thought-out</p>



<a name="506624235"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/506624235" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#506624235">(Mar 19 2025 at 03:12)</a>:</h4>
<p>There definitely has been some. That said, less so recently (just the ebb and flow as folks getting busy). That said, I'm sure we can make more time for it.</p>



<a name="506632942"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/506632942" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#506632942">(Mar 19 2025 at 04:44)</a>:</h4>
<p>This weekend I'll do a session or two!</p>



<a name="506633655"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/506633655" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Trevor Settles <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#506633655">(Mar 19 2025 at 04:51)</a>:</h4>
<p>Ok, cool. Thanks for the info!  I'm coming back from vacation on Saturday, so I'll check them</p>



<a name="506635699"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/506635699" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#506635699">(Mar 19 2025 at 05:09)</a>:</h4>
<p>I'm in the middle of a move interstate, so my availability for roc has dropped off a little this week. I'm definitely keen for more collaborative coding. <span class="user-mention" data-user-id="479378">@Trevor Settles</span> happy to spend time with you or anyone else interested, and sharing what I know about things. </p>
<p>Now is a great time to get involved with the new zig compiler work. There are lots of parts that are basically just stubbed out with a TODO or placeholder waiting for someone to give it some love. </p>
<p>If there isn't a draft PR then you can probably assume it's not being looked at or worked on by someone else. </p>
<p>I think for anyone who wants to help -- getting involved by reviewing PR's and leaving comments, contributing ideas to discussions, and reading the code/making PR's are all really helpful.</p>



<a name="506635807"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/506635807" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#506635807">(Mar 19 2025 at 05:10)</a>:</h4>
<p>And if you want specific feature work, we can carve our a specific chunk for you, big or small</p>



<a name="506874025"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/506874025" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Reed Harston <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#506874025">(Mar 20 2025 at 03:49)</a>:</h4>
<p>Hello everyone, my name is Reed Harston.<br>
I just came here from the Zig Showtime interview about the compiler rewrite.<br>
Roc looks interesting, and I’d like to try it, but I don’t have any projects right now that seem like a good fit. But as soon as Richard said Zig people are welcome to come pitch in without even using Roc I paused the video and came right here. <span aria-label="big smile" class="emoji emoji-1f604" role="img" title="big smile">:big_smile:</span></p>
<p>I won’t have time right now to really dig into development, but I’d love to help out so I was thinking about jumping in and commenting on PRs and the like, and it turns out that just two message ago Luke said that would be helpful, so I plan on starting there.</p>
<p>Glad to be here and I look forward to getting to know you.</p>



<a name="506874515"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/506874515" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#506874515">(Mar 20 2025 at 03:55)</a>:</h4>
<p>Welcome to the club! We'd love to get any help on PRs or anything</p>



<a name="506890192"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/506890192" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#506890192">(Mar 20 2025 at 06:41)</a>:</h4>
<p>Awesome <span class="user-mention" data-user-id="890690">@Reed Harston</span>, any feedback on PRs are very welcome. I'm a zig noob and have been having a blast learning as I go. It's a different vibe from Rust, but so far it's been really great. I'm super excited for the builtin fuzzing features.</p>



<a name="507099154"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/507099154" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#507099154">(Mar 21 2025 at 00:27)</a>:</h4>
<p><span class="user-mention silent" data-user-id="461444">Sam Mohr</span> <a href="#narrow/channel/395097-compiler-development/topic/casual.20conversation/near/506632942">said</a>:</p>
<blockquote>
<p>This weekend I'll do a session or two!</p>
</blockquote>
<p>Anyone interested in an ad-hoc contributor meeting this weekend? Chat current status. Chat what could use support. Chat what is needed to unblock various work. Also, I'll show off tracy for profiling.</p>



<a name="507099697"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/507099697" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#507099697">(Mar 21 2025 at 00:32)</a>:</h4>
<p>I'd love to if the timing works out!</p>



<a name="507099939"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/507099939" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#507099939">(Mar 21 2025 at 00:34)</a>:</h4>
<p><a href="https://www.when2meet.com/?29672150-cuT6d">https://www.when2meet.com/?29672150-cuT6d</a></p>



<a name="507116229"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/507116229" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Isaac Van Doren <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#507116229">(Mar 21 2025 at 03:03)</a>:</h4>
<p>Would love to join but I’ll be out of town</p>



<a name="507351946"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/507351946" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#507351946">(Mar 21 2025 at 19:28)</a>:</h4>
<p>Ping for a few folks to see if they have interest in joining/availability to add: <span class="user-mention" data-user-id="515757">@Luke Boswell</span> <span class="user-mention" data-user-id="461444">@Sam Mohr</span> <span class="user-mention" data-user-id="479378">@Trevor Settles</span> <span class="user-mention" data-user-id="781658">@Anthony Bullard</span> <span class="user-mention" data-user-id="453336">@Joshua Warner</span></p>



<a name="507352984"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/507352984" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#507352984">(Mar 21 2025 at 19:34)</a>:</h4>
<p>Would like to join if possible, but very hard to know ahead of time if any particular time slot works</p>



<a name="507360047"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/507360047" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#507360047">(Mar 21 2025 at 20:19)</a>:</h4>
<p>Sorry, I'd love to but not available at all this weekend. In the middle of moving house (like the actual moving part).</p>



<a name="507404625"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/507404625" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#507404625">(Mar 22 2025 at 03:27)</a>:</h4>
<p>lets do <time datetime="2025-03-22T17:30:00Z">2025-03-22T10:30:00-07:00</time> cc: <span class="user-mention" data-user-id="361169">@Anton</span> <span class="user-mention" data-user-id="281383">@Richard Feldman</span> <span class="user-mention" data-user-id="461444">@Sam Mohr</span></p>



<a name="507471712"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/507471712" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#507471712">(Mar 22 2025 at 17:31)</a>:</h4>
<p>Should we do a Google Meet or something?</p>



<a name="507471961"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/507471961" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#507471961">(Mar 22 2025 at 17:34)</a>:</h4>
<p><a href="https://meet.jit.si/moderated/672e6cc127f67c355ac33a6c800ab60136fe27de5db001bed534ad2d2e3ee02d">https://meet.jit.si/moderated/672e6cc127f67c355ac33a6c800ab60136fe27de5db001bed534ad2d2e3ee02d</a></p>



<a name="507472186"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/507472186" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#507472186">(Mar 22 2025 at 17:37)</a>:</h4>
<p>There in a minute!</p>



<a name="507472520"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/507472520" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Loris Cro <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#507472520">(Mar 22 2025 at 17:40)</a>:</h4>
<p>are lurkers allowed?</p>



<a name="507472662"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/507472662" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#507472662">(Mar 22 2025 at 17:42)</a>:</h4>
<p>sure!</p>



<a name="507989755"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/507989755" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#507989755">(Mar 25 2025 at 10:58)</a>:</h4>
<p>Sorry y'all!  I've been super heads down the past couple of weeks with a major work project and family stuff</p>



<a name="507989816"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/507989816" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#507989816">(Mar 25 2025 at 10:59)</a>:</h4>
<p>But <span aria-label="hi" class="emoji emoji-1f44b" role="img" title="hi">:hi:</span>  I'll try to catch up sometime soon</p>



<a name="507999814"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/507999814" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#507999814">(Mar 25 2025 at 11:46)</a>:</h4>
<p>No need to apologize :)</p>



<a name="513037759"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/513037759" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#513037759">(Apr 18 2025 at 14:00)</a>:</h4>
<p>Ugh, using bash for anything mildly complex is such a disaster</p>



<a name="513039704"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/513039704" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Reed Harston <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#513039704">(Apr 18 2025 at 14:12)</a>:</h4>
<p>Yep. That’s what Python is for. <span aria-label="big smile" class="emoji emoji-1f604" role="img" title="big smile">:big_smile:</span></p>



<a name="513039820"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/513039820" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Reed Harston <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#513039820">(Apr 18 2025 at 14:13)</a>:</h4>
<p>Or Swift even. It does a good job at simple single file scripts.</p>



<a name="513040016"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/513040016" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#513040016">(Apr 18 2025 at 14:14)</a>:</h4>
<p>Roc can do it too :) but I was just modifying an existing bash script that I thought was going to be a quick fix :p</p>



<a name="513040107"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/513040107" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Reed Harston <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#513040107">(Apr 18 2025 at 14:15)</a>:</h4>
<p>Oh, yeah. Nothing ever seems to be quick in a bash script.</p>



<a name="513050638"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/513050638" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#513050638">(Apr 18 2025 at 15:20)</a>:</h4>
<blockquote>
<p>Ugh, using bash for anything mildly complex is such a disaster</p>
</blockquote>
<p>Lol; at my last company we had a script called <a href="http://deploy.sh">deploy.sh</a> (the name of the entrypoint, but there were probably 100+ files involved). It was IIRC 25k+ lines.</p>



<a name="513099382"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/513099382" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#513099382">(Apr 18 2025 at 21:22)</a>:</h4>
<p>The only place I’ve worked where bash was reasonable was Google.  They have so much tooling around it it’s pretty nice</p>



<a name="513099407"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/513099407" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#513099407">(Apr 18 2025 at 21:22)</a>:</h4>
<p>But usually, if you are making an array, you should probably use a real PL</p>



<a name="513103739"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/513103739" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#513103739">(Apr 18 2025 at 22:07)</a>:</h4>
<p>100% agree</p>



<a name="513103765"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/513103765" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#513103765">(Apr 18 2025 at 22:07)</a>:</h4>
<p>I was very impressed at how functional and usable that script was, despite all the problems</p>



<a name="513109790"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/513109790" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#513109790">(Apr 18 2025 at 23:23)</a>:</h4>
<p>Now that I have used python a lot more, I feel less and less confident that anyone should use it. Like bash, convenient in the small. But to go to medium, you really need type checking and python type checking is slow and pretty buggy. Yes it has tons of libraries and scales farther than bash, but it kinda really sucks except in super interactive notebook style flows. And even in that case you often get stuck when you realize that production requires leaving the interactive flow and then you want fast type checking and what not.</p>



<a name="513109832"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/513109832" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#513109832">(Apr 18 2025 at 23:23)</a>:</h4>
<p>So I guess I put python minorly ahead of bash, but a lot less far ahead than one would hope.</p>



<a name="513121291"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/513121291" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wizard ish <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#513121291">(Apr 19 2025 at 02:08)</a>:</h4>
<p>yeah i litterally just had a discussion about how python is essentially the C(++) of scripting languages, it just had things piled on top of it until it barely works anymore</p>



<a name="513122470"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/513122470" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#513122470">(Apr 19 2025 at 02:24)</a>:</h4>
<p>And at the same time, this is part of the reason it is so successful</p>



<a name="513122912"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/513122912" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wizard ish <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#513122912">(Apr 19 2025 at 02:30)</a>:</h4>
<p>Yeah, it may be the C++ of scripting languages <em>but</em> it is the C++ of scripting languages <span aria-label="grinning face with smiling eyes" class="emoji emoji-1f601" role="img" title="grinning face with smiling eyes">:grinning_face_with_smiling_eyes:</span></p>



<a name="513130048"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/513130048" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Reed Harston <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#513130048">(Apr 19 2025 at 03:53)</a>:</h4>
<p>Yep</p>



<a name="513130092"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/513130092" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Reed Harston <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#513130092">(Apr 19 2025 at 03:54)</a>:</h4>
<p>I like it. I’d never seen that before.</p>



<a name="513130111"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/513130111" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Reed Harston <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#513130111">(Apr 19 2025 at 03:54)</a>:</h4>
<p>The funny thing is, at work the two languages we use are C++ and Python. Just those two.</p>



<a name="513131099"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/513131099" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#513131099">(Apr 19 2025 at 04:06)</a>:</h4>
<p>Almost everything at my work is c++ or python. Though we have a ton of mojo too.</p>



<a name="513169253"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/513169253" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Reed Harston <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#513169253">(Apr 19 2025 at 13:19)</a>:</h4>
<p>Ooh, first time I’ve met someone that has used Mojo. And professionally! What have you thought of it so far? Live up to its promises?</p>



<a name="513169410"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/513169410" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Reed Harston <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#513169410">(Apr 19 2025 at 13:22)</a>:</h4>
<p>I knows it’s designed for accelerating the AI work being done in Python, but I wonder if anybody has started using it for anything else they’re doing in Python but want to be fasted.</p>



<a name="513170369"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/513170369" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#513170369">(Apr 19 2025 at 13:33)</a>:</h4>
<blockquote>
<p>Ooh, first time I’ve met someone that has used Mojo.</p>
</blockquote>
<p>Brendan works there :)</p>



<a name="513184944"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/513184944" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Reed Harston <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#513184944">(Apr 19 2025 at 16:30)</a>:</h4>
<p>I guess I need to catch up on the community. <span aria-label="sweat smile" class="emoji emoji-1f605" role="img" title="sweat smile">:sweat_smile:</span></p>



<a name="513184965"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/513184965" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Reed Harston <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#513184965">(Apr 19 2025 at 16:30)</a>:</h4>
<p>Actually, I think I did know that. <span aria-label="upside down" class="emoji emoji-1f643" role="img" title="upside down">:upside_down:</span></p>



<a name="513185848"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/513185848" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#513185848">(Apr 19 2025 at 16:40)</a>:</h4>
<p>this is the SIMD-powered lexing strategy (based on simdjson) that I want to try out someday for Roc: <span aria-label="grinning face with smiling eyes" class="emoji emoji-1f601" role="img" title="grinning face with smiling eyes">:grinning_face_with_smiling_eyes:</span></p>
<p><a href="https://lobste.rs/s/2ydd6d/deus_lex_machina_releasing_new">https://lobste.rs/s/2ydd6d/deus_lex_machina_releasing_new</a></p>



<a name="513185879"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/513185879" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#513185879">(Apr 19 2025 at 16:40)</a>:</h4>
<p>except without the AVX-512 part <span aria-label="sweat smile" class="emoji emoji-1f605" role="img" title="sweat smile">:sweat_smile:</span></p>



<a name="513187094"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/513187094" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#513187094">(Apr 19 2025 at 16:56)</a>:</h4>
<p>Will be very cool to see</p>



<a name="513187103"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/513187103" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#513187103">(Apr 19 2025 at 16:56)</a>:</h4>
<p>And tinker with</p>



<a name="513224342"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/513224342" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wizard ish <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#513224342">(Apr 20 2025 at 01:45)</a>:</h4>
<p>honestly python is just so... python the moment I hear that a language has "whitespace sensitive syntax", I can't deal with it, even something like NIM</p>



<a name="513224360"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/513224360" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wizard ish <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#513224360">(Apr 20 2025 at 01:46)</a>:</h4>
<p>except for haskell</p>



<a name="513224405"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/513224405" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wizard ish <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#513224405">(Apr 20 2025 at 01:46)</a>:</h4>
<p>because it has (that might be overstating it given that it never works) a way to write syntax in a way that is whitespace agnostic</p>



<a name="513224511"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/513224511" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wizard ish <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#513224511">(Apr 20 2025 at 01:48)</a>:</h4>
<p>wait oh no, it has RValues and LValues? <a href="https://en.cppreference.com/w/cpp/language/value_category">C++ flashbacks</a></p>



<a name="513224727"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/513224727" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wizard ish <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#513224727">(Apr 20 2025 at 01:50)</a>:</h4>
<p>although frankly i should learn nim</p>



<a name="513225981"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/513225981" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#513225981">(Apr 20 2025 at 02:07)</a>:</h4>
<p>I think whitespace sensitive syntax is totally fine</p>



<a name="513226001"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/513226001" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#513226001">(Apr 20 2025 at 02:07)</a>:</h4>
<p>I think tabs verse spaces leads to some issues, but it is generally more readable</p>



<a name="513230703"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/513230703" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Reed Harston <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#513230703">(Apr 20 2025 at 03:12)</a>:</h4>
<p>I’ve had multiple issues at work where we release a Python script to production and then a certain flow is broken because of a white space issue and our testing did catch it because we didn’t hit that flow or something.</p>
<p>Yes there that flagged an area to improve our process, and we did, but it still is frustrating that it was possible at all for that to get out into production because to the human eye everything looked right, but only because the tabs were the right width to match the spaces on the other lines.</p>



<a name="513230918"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/513230918" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Reed Harston <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#513230918">(Apr 20 2025 at 03:14)</a>:</h4>
<p>(There were two files that had a nearly identical section of code and when one was edited that section was copied to the other file. But one file used tabs and the other used spaces. Why? Ask someone from 5 years ago. I wish I knew. When I pasted it over everything looked right, and I happened to test the file that was right, and not the one that was wrong. Yes, user error. I haven’t done that again!)</p>



<a name="513231203"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/513231203" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#513231203">(Apr 20 2025 at 03:18)</a>:</h4>
<p><span class="user-mention silent" data-user-id="890690">Reed Harston</span> <a href="#narrow/stream/395097-compiler-development/topic/casual.20conversation/near/513230703">said</a>:</p>
<blockquote>
<p>I’ve had multiple issues at work where we release a Python script to production and then a certain flow is broken because of a white space issue and our testing did catch it because we didn’t hit that flow or something.</p>
<p>Yes there that flagged an area to improve our process, and we did, but it still is frustrating that it was possible at all for that to get out into production because to the human eye everything looked right, but only because the tabs were the right width to match the spaces on the other lines.</p>
</blockquote>
<p>That should be easy to catch with any longer or type checker for python.</p>



<a name="513231231"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/513231231" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#513231231">(Apr 20 2025 at 03:19)</a>:</h4>
<p>Also, not saying it is a good state, but definitely manageable.</p>



<a name="513231304"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/513231304" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#513231304">(Apr 20 2025 at 03:20)</a>:</h4>
<p>But this is where I definitely prefer mojo (though it is young and needs other support) but it can be compiled and fully type checked and etc.</p>



<a name="513236127"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/513236127" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Reed Harston <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#513236127">(Apr 20 2025 at 04:22)</a>:</h4>
<p>Part of our process improvement for Python includes linters run in Jenkins when we push changes.<br>
We didn’t have anything before because all our Python is written by C++ firmware developers that write their code like it is C with classes. So you can imagine the state of our Python. <span aria-label="sweat smile" class="emoji emoji-1f605" role="img" title="sweat smile">:sweat_smile:</span></p>



<a name="513254773"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/513254773" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Romain Lepert <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#513254773">(Apr 20 2025 at 08:59)</a>:</h4>
<p><span class="user-mention silent" data-user-id="361169">Anton</span> <a href="#narrow/channel/395097-compiler-development/topic/casual.20conversation/near/513170369">said</a>:</p>
<blockquote>
<blockquote>
<p>Ooh, first time I’ve met someone that has used Mojo.</p>
</blockquote>
<p>Brendan works there :)</p>
</blockquote>
<p><span class="user-mention" data-user-id="343810">@Brendan Hansknecht</span> curious what part of Mojo you work on. Mojo is my <a href="https://github.com/roc-lang/roc/issues/1">#1</a> upcoming language of interest. Hugely impressed with what it can do already. You guys have been doing magic (<span aria-label="wink" class="emoji emoji-1f609" role="img" title="wink">:wink:</span>).</p>



<a name="513337677"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/513337677" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#513337677">(Apr 21 2025 at 04:06)</a>:</h4>
<p>I don't work on mojo at all, just work with it some. I initially worked mostly on the graph compiler (compiles ai models down to kernels). Now I work at the max framework level helping build out the tools we use to write models. Compilers are all c++. Frameworks are all python. Kernels are all mojo. I interact with everything to some extent, but mostly python lately.</p>



<a name="517766720"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/517766720" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#517766720">(May 13 2025 at 08:21)</a>:</h4>
<p>Looking at <span class="user-mention" data-user-id="341568">@Jared Ramirez</span>'s PR I can see a few comments like this... which I assume is because we have that lint to ensure all top-level decls have a comment. </p>
<p>Would it be possible to not require that where it's just re-exporting something from another file? I think Zig's language server/editor integration? picks up the referenced comments -- and just appends the additional comment.</p>
<div class="codehilite" data-code-language="Zig"><pre><span></span><code><span class="c1">/// Type Desc</span>
<span class="kr">pub</span><span class="w"> </span><span class="kr">const</span><span class="w"> </span><span class="n">Desc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">types</span><span class="p">.</span><span class="n">Descriptor</span><span class="p">;</span>

<span class="w"> </span><span class="c1">/// Type Rank</span>
<span class="w"> </span><span class="kr">pub</span><span class="w"> </span><span class="kr">const</span><span class="w"> </span><span class="n">Rank</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">types</span><span class="p">.</span><span class="n">Rank</span><span class="p">;</span>

<span class="w"> </span><span class="c1">/// Type Mark</span>
<span class="w"> </span><span class="kr">pub</span><span class="w"> </span><span class="kr">const</span><span class="w"> </span><span class="n">Mark</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">types</span><span class="p">.</span><span class="n">Mark</span><span class="p">;</span>
</code></pre></div>



<a name="517767365"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/517767365" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#517767365">(May 13 2025 at 08:24)</a>:</h4>
<p><a href="/user_uploads/22008/aERPRd6izmZZ-WcSjAAXtbJd/Screenshot-2025-05-13-at-18.23.47.png">Screenshot 2025-05-13 at 18.23.47.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/22008/aERPRd6izmZZ-WcSjAAXtbJd/Screenshot-2025-05-13-at-18.23.47.png" title="Screenshot 2025-05-13 at 18.23.47.png"><img data-original-content-type="image/png" data-original-dimensions="1510x676" src="/user_uploads/thumbnail/22008/aERPRd6izmZZ-WcSjAAXtbJd/Screenshot-2025-05-13-at-18.23.47.png/840x560.webp"></a></div><p>I do like the way Jared has done it here.</p>



<a name="517767581"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/517767581" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#517767581">(May 13 2025 at 08:25)</a>:</h4>
<p>I'll see if I can easily add an exception for re-exports</p>



<a name="517767871"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/517767871" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#517767871">(May 13 2025 at 08:26)</a>:</h4>
<blockquote>
<p>I do like the way Jared has done it here.</p>
</blockquote>
<p>It's not clear to me what generalized means though</p>



<a name="517813866"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/517813866" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#517813866">(May 13 2025 at 12:14)</a>:</h4>
<p>All times I’ve seen an attempt to enforce doc comments via tooling, it has devolved in exactly this way</p>



<a name="517813978"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/517813978" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#517813978">(May 13 2025 at 12:15)</a>:</h4>
<p>I’m very skeptical of the cost/benefit tradeoff here</p>



<a name="517817463"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/517817463" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#517817463">(May 13 2025 at 12:30)</a>:</h4>
<p>In the old compiler we had nothing to encourage comments, and so we had very few comments. In the new compiler we force comments on pub things and we have decent comments in a lot of places and some redundant ones. I feel like it's already working, how do you see this devolving?</p>



<a name="517818559"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/517818559" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#517818559">(May 13 2025 at 12:35)</a>:</h4>
<blockquote>
<p>and so we had very few comments</p>
</blockquote>
<p>And a lot of cases where I felt "I have no idea what this thing is".</p>



<a name="517860159"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/517860159" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#517860159">(May 13 2025 at 15:21)</a>:</h4>
<p>In my experience, things start off great, and then the percentage of low-value comments creeps up and up until they’re the cast majority of comments</p>



<a name="517860801"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/517860801" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#517860801">(May 13 2025 at 15:24)</a>:</h4>
<p>Hmm... <img alt=":thinkies:" class="emoji" src="https://avatars.zulip.com/22008/emoji/images/9055c9eb.png" title="thinkies"></p>



<a name="517860889"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/517860889" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#517860889">(May 13 2025 at 15:24)</a>:</h4>
<p>Sound plausible.</p>



<a name="517860950"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/517860950" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#517860950">(May 13 2025 at 15:25)</a>:</h4>
<p>I still think this test/trail is well worth it given the experience of the rust compiler.</p>



<a name="517877457"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/517877457" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jared Ramirez <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#517877457">(May 13 2025 at 16:39)</a>:</h4>
<p>FWIW, there were very few comments in the Rust unify/subs code, and there were many places where I think they would have been helpful.</p>
<p>I can see how we'll likely end up with many self-describing comments like above with the <code>pub</code> enforcement, but I would guess the total number of <em>good</em> comments will be higher than without</p>



<a name="517878791"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/517878791" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#517878791">(May 13 2025 at 16:45)</a>:</h4>
<p>Encouraging good comments is IMO much more about carrot than stick</p>



<a name="517878923"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/517878923" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#517878923">(May 13 2025 at 16:46)</a>:</h4>
<p>What's a good carrot in this case?</p>



<a name="517879083"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/517879083" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#517879083">(May 13 2025 at 16:46)</a>:</h4>
<p>Being really appreciative of someone going out of their way to document things well, for one</p>



<a name="517879405"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/517879405" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#517879405">(May 13 2025 at 16:48)</a>:</h4>
<p>Gentle prodding on the code review is good, to try to encourage that. But imo it’s really important that it’s actually a person making that code review comment rather than a bot. It’s much more likely people will respect and listen to a person.</p>



<a name="517879828"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/517879828" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#517879828">(May 13 2025 at 16:50)</a>:</h4>
<blockquote>
<p>It’s much more likely people will respect and listen to a person.</p>
</blockquote>
<p>That is true but it's also hard to review consistently with different people.</p>



<a name="517880014"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/517880014" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#517880014">(May 13 2025 at 16:51)</a>:</h4>
<p>One alternative approach that comes to mind is a small checklist that shows up when you make a PR in github:</p>
<ul>
<li>I added tests where needed</li>
<li>I added comments where needed</li>
</ul>



<a name="517880148"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/517880148" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#517880148">(May 13 2025 at 16:52)</a>:</h4>
<p>A gentle reminder</p>



<a name="517880578"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/517880578" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#517880578">(May 13 2025 at 16:54)</a>:</h4>
<blockquote>
<p>I added comments where needed</p>
</blockquote>
<p>Below this one we could provide a collapsible list with all pub functions that you added but did not provide a comment for. So they have an easy overview without a hard reject mechanism.</p>



<a name="518818981"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/518818981" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#518818981">(May 17 2025 at 13:25)</a>:</h4>
<p><span class="user-mention silent" data-user-id="515757">Luke Boswell</span> <a href="#narrow/channel/395097-compiler-development/topic/casual.20conversation/near/517766720">said</a>:</p>
<blockquote>
<p>Would it be possible to not require that where it's just re-exporting something from another file?</p>
<p><div class="codehilite" data-code-language="Zig"><pre><span></span><code><span class="c1">/// Type Desc</span>
<span class="kr">pub</span><span class="w"> </span><span class="kr">const</span><span class="w"> </span><span class="n">Desc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">types</span><span class="p">.</span><span class="n">Descriptor</span><span class="p">;</span>

<span class="w"> </span><span class="c1">/// Type Rank</span>
<span class="w"> </span><span class="kr">pub</span><span class="w"> </span><span class="kr">const</span><span class="w"> </span><span class="n">Rank</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">types</span><span class="p">.</span><span class="n">Rank</span><span class="p">;</span>

<span class="w"> </span><span class="c1">/// Type Mark</span>
<span class="w"> </span><span class="kr">pub</span><span class="w"> </span><span class="kr">const</span><span class="w"> </span><span class="n">Mark</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">types</span><span class="p">.</span><span class="n">Mark</span><span class="p">;</span>
</code></pre></div><br>
</p>
</blockquote>
<p>Done :) <a href="https://github.com/roc-lang/roc/pull/7790">PR#7790</a></p>



<a name="518842753"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/518842753" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#518842753">(May 17 2025 at 18:32)</a>:</h4>
<p>Oh no :p <br>
<a href="/user_uploads/22008/3m0GAsGJWwpjJKjN9lTJ3Tu-/zig_dependency_graph.png">zig_dependency_graph.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/22008/3m0GAsGJWwpjJKjN9lTJ3Tu-/zig_dependency_graph.png" title="zig_dependency_graph.png"><img data-original-content-type="image/png" data-original-dimensions="6821x1979" src="/user_uploads/thumbnail/22008/3m0GAsGJWwpjJKjN9lTJ3Tu-/zig_dependency_graph.png/840x560.webp"></a></div>



<a name="518843769"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/518843769" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#518843769">(May 17 2025 at 18:42)</a>:</h4>
<p>This actually looks relatively one direction and decent....though base is definitely a bit sketch as a super aggregator</p>



<a name="518928982"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/518928982" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#518928982">(May 18 2025 at 14:55)</a>:</h4>
<p>How to make llvm compile at a reasonable speed (from one of my coworkers who works on mojo): <a href="https://youtu.be/6Ro6XTHAffY?si=iBPwdfjcA8hKqUQG">https://youtu.be/6Ro6XTHAffY?si=iBPwdfjcA8hKqUQG</a></p>
<div class="youtube-video message_inline_image"><a data-id="6Ro6XTHAffY" href="https://youtu.be/6Ro6XTHAffY?si=iBPwdfjcA8hKqUQG"><img src="https://uploads.zulipusercontent.net/9d8dc746ef6e7213bffef0c8fa09edc9a973fc0d/68747470733a2f2f692e7974696d672e636f6d2f76692f36526f36585448416666592f6d7164656661756c742e6a7067"></a></div>



<a name="519183408"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/519183408" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#519183408">(May 19 2025 at 17:55)</a>:</h4>
<p>I put up a slightly improved version of the import graph on <a href="https://anton-4.github.io/roc-compiler-vis/zig_dependency_graph.png">https://anton-4.github.io/roc-compiler-vis/zig_dependency_graph.png</a><br>
It's updated once a day based on the roc repo :)</p>
<div class="message_inline_image"><a href="https://anton-4.github.io/roc-compiler-vis/zig_dependency_graph.png"><img src="https://uploads.zulipusercontent.net/accaa7eafcff52605581c5f12742fefaec3af2ca/68747470733a2f2f616e746f6e2d342e6769746875622e696f2f726f632d636f6d70696c65722d7669732f7a69675f646570656e64656e63795f67726170682e706e67"></a></div>



<a name="519185248"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/519185248" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#519185248">(May 19 2025 at 18:03)</a>:</h4>
<p>is this done by generating Mermaid from the dependency graph?</p>



<a name="519334181"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/519334181" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#519334181">(May 20 2025 at 09:15)</a>:</h4>
<p>I use graphviz based on grepped imports: <a href="https://github.com/Anton-4/roc-compiler-vis/blob/main/.github/workflows/publish_every_day.yml">https://github.com/Anton-4/roc-compiler-vis/blob/main/.github/workflows/publish_every_day.yml</a></p>



<a name="519483166"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/519483166" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#519483166">(May 20 2025 at 22:17)</a>:</h4>
<p>Should we upgrade our rust version? </p>
<p>I was trying to run typos (like in CI) and were running an older version of rustc with our <code>rust-toolchain.toml</code> </p>
<div class="codehilite"><pre><span></span><code>$ cargo install typos-cli --version 1.32.0
    Updating crates.io index
error: cannot install package `typos-cli 1.32.0`, it requires rustc 1.80 or newer, while the currently active rustc version is 1.77.2
`typos-cli 1.28.2` supports rustc 1.75
</code></pre></div>



<a name="519484220"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/519484220" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#519484220">(May 20 2025 at 22:27)</a>:</h4>
<p>I say go for it</p>



<a name="519484232"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/519484232" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#519484232">(May 20 2025 at 22:28)</a>:</h4>
<p>Should be pretty minimal</p>



<a name="519484437"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/519484437" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#519484437">(May 20 2025 at 22:29)</a>:</h4>
<p>I'm happy to poke at it. I'll wait for <span class="user-mention" data-user-id="361169">@Anton</span> who may have ideas. I think we're just following the upgrade guide the toml file.</p>



<a name="519560765"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/519560765" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#519560765">(May 21 2025 at 09:06)</a>:</h4>
<p>In CI I remove rust-toolchain.toml before I install typos, that makes it work. Upgrading rust can come with some serious clippy work but with today's AI assistance that may go smooth, you're welcome to give it a try.</p>



<a name="519562342"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/519562342" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#519562342">(May 21 2025 at 09:14)</a>:</h4>
<p>You can also install typos outside nix (and outside the roc repo) locally , that may be the easiest way.</p>



<a name="520942158"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/520942158" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#520942158">(May 28 2025 at 17:26)</a>:</h4>
<p>It's nice that by encouraging code to be pure it is also easier and faster to test it <img alt=":roc:" class="emoji" src="https://avatars.zulip.com/22008/emoji/images/5f42d943.png" title="roc"></p>



<a name="520944620"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/520944620" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#520944620">(May 28 2025 at 17:41)</a>:</h4>
<p>I remember that my professor deducted me a ton of points on the exam for my first programming (java) college course. Not because my solution was incorrect, but because I didn't put stuff in classes. Ironically, now I am working on a programming language without any classes, full circle, haha :p</p>



<a name="520944740"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/520944740" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#520944740">(May 28 2025 at 17:42)</a>:</h4>
<p>He did also end up teaching me functional programming in a different course, so that's an acceptable redemption arc :)</p>



<a name="521387455"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/521387455" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#521387455">(May 30 2025 at 23:58)</a>:</h4>
<p><span class="user-mention" data-user-id="341568">@Jared Ramirez</span> I noticed your explanation about the occurs check and not using Mark, I thought that looked good. You're switching back to use Mark, why is that? I'm just curious.</p>



<a name="521398601"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/521398601" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jared Ramirez <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#521398601">(May 31 2025 at 02:34)</a>:</h4>
<p>Yeah, I kinda went back and forth on it. I think using Marks will have slight better performance (though it may be negligible), and I figured if it was done that way in the rust compiler, there was probably a reason.</p>



<a name="521398723"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/521398723" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jared Ramirez <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#521398723">(May 31 2025 at 02:36)</a>:</h4>
<p>I was also gonna see what Richard thought when he reviews it! I kept the “covert to use Marks” change isolated in a commit, which can easily be dropped if the original way sans Marks is preferred</p>



<a name="521406916"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/521406916" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#521406916">(May 31 2025 at 04:30)</a>:</h4>
<p>I have an idea, which I'm not sure has precedent - what if we counted the number of transitive unifications we'd done for a given type (e.g. we visit a canonical IR node and kick off a unification of it and some other type; all the unifications resulting from that original, before we move on to the next canonical IR node, would be "transitive" here) and if that count is under some threshold, then all occurs checks are no-ops</p>



<a name="521407000"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/521407000" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#521407000">(May 31 2025 at 04:31)</a>:</h4>
<p>so the idea there would be that the occurs checks are there to catch infinite types, which are a rare but very serious error case</p>



<a name="521407043"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/521407043" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#521407043">(May 31 2025 at 04:31)</a>:</h4>
<p>rare bc it's a very uncommon mistake to make, and serious bc it hangs the compiler by default (unless there's an occurs check to detect that we're stuck in an infinite loop)</p>



<a name="521407140"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/521407140" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#521407140">(May 31 2025 at 04:32)</a>:</h4>
<p>so the idea would be that if we're stuck in an infinite loop, our iteration count will exceed the threshold, and if we're not stuck in an infinite loop, then it very rarely will, and so it's much cheaper to skip the checks</p>



<a name="521407182"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/521407182" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#521407182">(May 31 2025 at 04:33)</a>:</h4>
<p>this would have a perf cost in the case where we do actually have an infinite type, but I think that's totally fine bc it comes up so rarely in practice</p>



<a name="521407246"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/521407246" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#521407246">(May 31 2025 at 04:34)</a>:</h4>
<p>(plus the perf cost would probably only be paid for that one type in the whole build, so likely still wouldn't be noticeable)</p>



<a name="521407249"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/521407249" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#521407249">(May 31 2025 at 04:34)</a>:</h4>
<p>thoughts?</p>



<a name="521407651"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/521407651" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jared Ramirez <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#521407651">(May 31 2025 at 04:40)</a>:</h4>
<p>So like we have a counter and every time we recurse in unify, we increment it, then if we exceed the threshold we do a full occurs check?</p>



<a name="521407944"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/521407944" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jared Ramirez <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#521407944">(May 31 2025 at 04:42)</a>:</h4>
<p>I think we’d have to reset/decrement the count for each recursive branch (eg if count = 1 at the start of a function, we recurse to unify args 1, we’d have to reset the count back to 1 before unifying args 2). This is how tracking seen variables in a regular occurs check works though, so I think that should be fine</p>



<a name="521410350"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/521410350" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jared Ramirez <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#521410350">(May 31 2025 at 05:19)</a>:</h4>
<p>Thinking more, I wonder if we couldn’t combine unify and occurs check. We could track seen variables in unification and check on each recursive call if we’ve already seen this var</p>



<a name="521432857"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/521432857" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#521432857">(May 31 2025 at 11:06)</a>:</h4>
<p>yeah, my thinking was just that we could avoid checking the variables at all in the very common case where there aren't any infinite types</p>



<a name="521432873"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/521432873" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#521432873">(May 31 2025 at 11:06)</a>:</h4>
<p>since incrementing a counter and checking if it's over a threshold is so cheap it's basically free</p>



<a name="521448454"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/521448454" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#521448454">(May 31 2025 at 14:44)</a>:</h4>
<p>One thing, to double check. Can we make sure that this checker allows infinite recursion through indirection? Also through non tag types. And multiple aliases</p>
<p>The old version had really annoying edge cases</p>



<a name="521448522"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/521448522" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#521448522">(May 31 2025 at 14:45)</a>:</h4>
<p>For example, a list or a box should break infinite recursion and be valid:</p>
<div class="codehilite"><pre><span></span><code>Node a: { data: a, children: List(Node(a)) }
</code></pre></div>



<a name="521448751"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/521448751" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#521448751">(May 31 2025 at 14:48)</a>:</h4>
<p>And by multiple type alias recursion, I mean things like:</p>
<div class="codehilite"><pre><span></span><code>Wrapper a : { data: a, next: Inner(a) }
Inner a : [ Next: Wrapper(a), None ]
</code></pre></div>



<a name="521448752"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/521448752" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#521448752">(May 31 2025 at 14:48)</a>:</h4>
<p>yeah definitely need to allow those cases!</p>



<a name="521448771"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/521448771" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#521448771">(May 31 2025 at 14:48)</a>:</h4>
<p>Yeah, just want to make sure they get thought about early in case it matters to design</p>



<a name="521448796"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/521448796" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#521448796">(May 31 2025 at 14:49)</a>:</h4>
<p>I know this is a common beginner trip currently</p>



<a name="521456654"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/521456654" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#521456654">(May 31 2025 at 16:29)</a>:</h4>
<p><span class="user-mention" data-user-id="341568">@Jared Ramirez</span> would be some good cases to add tests for! <span aria-label="smiley" class="emoji emoji-1f603" role="img" title="smiley">:smiley:</span></p>



<a name="521768952"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/521768952" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#521768952">(Jun 02 2025 at 14:58)</a>:</h4>
<p>Interesting approach to compiler backend construction: <a href="https://arxiv.org/pdf/2505.22610">https://arxiv.org/pdf/2505.22610</a></p>



<a name="522490692"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/522490692" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#522490692">(Jun 05 2025 at 03:28)</a>:</h4>
<p>Are we planning on limiting Roc source to ASCII? </p>
<p>Can I have idents or fields in records that are using a wider set of characters?</p>



<a name="522490908"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/522490908" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#522490908">(Jun 05 2025 at 03:30)</a>:</h4>
<p>For context I was looking at Richard's WIP PR </p>
<div class="codehilite" data-code-language="Zig"><pre><span></span><code><span class="c1">// Then sort by name (ascending)</span>
<span class="kr">const</span><span class="w"> </span><span class="n">lhs_str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ctx</span><span class="p">.</span><span class="n">env</span><span class="p">.</span><span class="n">idents</span><span class="p">.</span><span class="n">getText</span><span class="p">(</span><span class="n">lhs</span><span class="p">.</span><span class="n">name</span><span class="p">);</span>
<span class="kr">const</span><span class="w"> </span><span class="n">rhs_str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ctx</span><span class="p">.</span><span class="n">env</span><span class="p">.</span><span class="n">idents</span><span class="p">.</span><span class="n">getText</span><span class="p">(</span><span class="n">rhs</span><span class="p">.</span><span class="n">name</span><span class="p">);</span>
<span class="k">return</span><span class="w"> </span><span class="n">std</span><span class="p">.</span><span class="n">mem</span><span class="p">.</span><span class="n">order</span><span class="p">(</span><span class="kt">u8</span><span class="p">,</span><span class="w"> </span><span class="n">lhs_str</span><span class="p">,</span><span class="w"> </span><span class="n">rhs_str</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="p">.</span><span class="n">lt</span><span class="p">;</span>
</code></pre></div>



<a name="522490974"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/522490974" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#522490974">(Jun 05 2025 at 03:31)</a>:</h4>
<p>But I guess this wouldn't mind what encoding is used... it's just using the raw bytes.</p>



<a name="522491153"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/522491153" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#522491153">(Jun 05 2025 at 03:33)</a>:</h4>
<p>Idents are currently ascii-only in the new compiler, and I think the intent is to keep it that way unless/until there’s a strong signal otherwise</p>



<a name="522491434"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/522491434" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#522491434">(Jun 05 2025 at 03:36)</a>:</h4>
<p>I see the implementation in tokenize</p>
<div class="codehilite" data-code-language="Zig"><pre><span></span><code><span class="kr">pub</span><span class="w"> </span><span class="k">fn</span><span class="w"> </span><span class="n">chompIdentGeneral</span><span class="p">(</span><span class="n">self</span><span class="o">:</span><span class="w"> </span><span class="o">*</span><span class="n">Cursor</span><span class="p">)</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kr">var</span><span class="w"> </span><span class="n">valid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span>
<span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">pos</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">buf</span><span class="p">.</span><span class="n">len</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kr">const</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">buf</span><span class="p">[</span><span class="n">self</span><span class="p">.</span><span class="n">pos</span><span class="p">];</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">((</span><span class="n">c</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="s">'a'</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="s">'z'</span><span class="p">)</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="p">(</span><span class="n">c</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="s">'A'</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="s">'Z'</span><span class="p">)</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="p">(</span><span class="n">c</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="s">'0'</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="s">'9'</span><span class="p">)</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">'_'</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">'!'</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">self</span><span class="p">.</span><span class="n">pos</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">c</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mh">0x80</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">valid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
<span class="w">            </span><span class="n">self</span><span class="p">.</span><span class="n">pos</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">break</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">valid</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>



<a name="522493782"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/522493782" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#522493782">(Jun 05 2025 at 04:02)</a>:</h4>
<p>yeah I think it's reasonable to consider non-ASCII in the future, but even assuming we want to support it, it's enough of a project that I don't think we need it for 0.1.0</p>



<a name="522496699"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/522496699" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Hannes <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#522496699">(Jun 05 2025 at 04:35)</a>:</h4>
<p>My roc-math package has constants like π and function arguments like θ, but I think I'm the only one who's used them before <span aria-label="sweat smile" class="emoji emoji-1f605" role="img" title="sweat smile">:sweat_smile:</span></p>



<a name="522871865"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/522871865" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#522871865">(Jun 07 2025 at 04:37)</a>:</h4>
<p>I've been merging changes and generally going ham on our WIP Can PR <a href="https://github.com/roc-lang/roc/pull/7806">https://github.com/roc-lang/roc/pull/7806</a>. </p>
<p>It's back to compiling and tests passing now... but I've definitely missed a heap of things. I can already see things that I've missed between my "fixes" and merge conflicts.</p>
<p>I'm going to take my time going back through all changes and clean it up so we can merge it hopefully this weekend sometime.</p>



<a name="522887294"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/522887294" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#522887294">(Jun 07 2025 at 10:32)</a>:</h4>
<p>Random tip; merging multiple <code>Stdout.line</code> into one can drastically reduce your build times! So like this:</p>
<div class="codehilite" data-code-language="CoffeeScript"><pre><span></span><code><span class="w">    </span><span class="nx">Stdout</span><span class="p">.</span><span class="nx">line</span><span class="o">!</span><span class="p">(</span>
<span class="w">        </span><span class="s">"""</span>
<span class="s">        Testing Tcp module functions...</span>
<span class="s">        Note: These tests require a TCP server running on localhost:8085</span>
<span class="s">        You can start one with: ncat -e `which cat` -l 8085</span>

<span class="s">        """</span>
<span class="w">    </span><span class="p">)</span><span class="o">?</span>
</code></pre></div>
<p>Instead of</p>
<div class="codehilite" data-code-language="CoffeeScript"><pre><span></span><code><span class="w">    </span><span class="nx">Stdout</span><span class="p">.</span><span class="nx">line</span><span class="o">!</span><span class="p">(</span><span class="s">"Testing Tcp module functions..."</span><span class="p">)</span><span class="o">?</span>
<span class="w">    </span><span class="nx">Stdout</span><span class="p">.</span><span class="nx">line</span><span class="o">!</span><span class="p">(</span><span class="s">"Note: These tests require a TCP server running on localhost:8085"</span><span class="p">)</span><span class="o">?</span>
<span class="w">    </span><span class="nx">Stdout</span><span class="p">.</span><span class="nx">line</span><span class="o">!</span><span class="p">(</span><span class="s">"You can start one with: ncat -e `which cat` -l 8085"</span><span class="p">)</span><span class="o">?</span>
<span class="w">    </span><span class="nx">Stdout</span><span class="p">.</span><span class="nx">line</span><span class="o">!</span><span class="p">(</span><span class="s">""</span><span class="p">)</span><span class="o">?</span>
</code></pre></div>



<a name="522887355"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/522887355" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#522887355">(Jun 07 2025 at 10:33)</a>:</h4>
<p>Doing this for all subsequent <code>Stdout.line</code> in <a href="https://github.com/roc-lang/basic-cli/blob/main/tests/tcp.roc">tests/tcp.roc</a> reduced build time from 9315 ms to 728 ms!</p>



<a name="522888394"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/522888394" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#522888394">(Jun 07 2025 at 10:58)</a>:</h4>
<p>Splitting lots of <code>?</code> calls over multipe functions also helps a lot</p>



<a name="522900996"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/522900996" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#522900996">(Jun 07 2025 at 15:04)</a>:</h4>
<p>Makes sense</p>



<a name="522901012"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/522901012" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#522901012">(Jun 07 2025 at 15:05)</a>:</h4>
<p>Way less closures for llvm to deal with</p>



<a name="522901061"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/522901061" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#522901061">(Jun 07 2025 at 15:05)</a>:</h4>
<p>Or hmm....actually with the old tasks it makes sense.....surprising now that it makes much of a difference</p>



<a name="522901094"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/522901094" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#522901094">(Jun 07 2025 at 15:06)</a>:</h4>
<p>Would be great to see a profile of the compiler before and after</p>



<a name="522902504"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/522902504" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#522902504">(Jun 07 2025 at 15:35)</a>:</h4>
<p>Also</p>
<blockquote>
<p>from 9315 ms to 728 ms!</p>
</blockquote>
<p>Feels like a bug or file system caching or something else crazy....bug is my biggest guess.</p>



<a name="522902526"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/522902526" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#522902526">(Jun 07 2025 at 15:36)</a>:</h4>
<p>just too high of a delta</p>



<a name="522902530"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/522902530" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#522902530">(Jun 07 2025 at 15:36)</a>:</h4>
<p>so I'm curious</p>



<a name="522902564"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/522902564" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#522902564">(Jun 07 2025 at 15:36)</a>:</h4>
<p>I'll try to profile later today :)</p>



<a name="522911621"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/522911621" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#522911621">(Jun 07 2025 at 18:35)</a>:</h4>
<p>Hmm, addr2line is being used after recording the flamegraph and it's taking its time... it's also single threaded <span aria-label="graveyard" class="emoji emoji-1faa6" role="img" title="graveyard">:graveyard:</span> <br>
I've never had that before, could be caused by our perf issue <span aria-label="thinking" class="emoji emoji-1f914" role="img" title="thinking">:thinking:</span></p>



<a name="522911674"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/522911674" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#522911674">(Jun 07 2025 at 18:36)</a>:</h4>
<p>Addr2line, generally isn't fast, but it taking forever could mean essentially infinite recursion</p>



<a name="522914553"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/522914553" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#522914553">(Jun 07 2025 at 19:42)</a>:</h4>
<p>It's still going :p I'm just going to make a simpler reproducer on Monday</p>



<a name="522953173"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/522953173" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#522953173">(Jun 08 2025 at 07:56)</a>:</h4>
<p>I've been putting together as much as I can for this Can PR but I have some architectural questions.</p>



<a name="522953176"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/522953176" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#522953176">(Jun 08 2025 at 07:56)</a>:</h4>
<p>The type store currently holds a reference to the ModuleEnv, however I feel like  it should live in the ModuleEnv so we can make fresh variables in Can, and later solve them. </p>
<p>Where should the type store live?</p>



<a name="522967330"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/522967330" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#522967330">(Jun 08 2025 at 09:54)</a>:</h4>
<p>I have gone with Can IR owning the type store. It seems to be working ok for now.</p>



<a name="522967401"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/522967401" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#522967401">(Jun 08 2025 at 09:55)</a>:</h4>
<p>Type store in module env makes sense! Probably better than specifically can IR</p>



<a name="522967420"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/522967420" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#522967420">(Jun 08 2025 at 09:55)</a>:</h4>
<p>But not sure it matters too much</p>



<a name="522971582"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/522971582" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#522971582">(Jun 08 2025 at 11:19)</a>:</h4>
<p>yeah can should not be making fresh type variables in this design</p>



<a name="522971631"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/522971631" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#522971631">(Jun 08 2025 at 11:20)</a>:</h4>
<p>rather, we should reuse can idx to be var, and initialize the types store with a capacity of at least the highest can idx</p>



<a name="522973361"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/522973361" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#522973361">(Jun 08 2025 at 11:58)</a>:</h4>
<p><span class="user-mention silent" data-user-id="281383">Richard Feldman</span> <a href="#narrow/stream/395097-compiler-development/topic/casual.20conversation/near/522971631">said</a>:</p>
<blockquote>
<p>rather, we should reuse can idx to be var, and initialize the types store with a capacity of at least the highest can idx</p>
</blockquote>
<p>this was exactly what i was expecting</p>



<a name="522974455"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/522974455" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#522974455">(Jun 08 2025 at 12:20)</a>:</h4>
<p>I've been going ham on the Can PR <span class="user-mention" data-user-id="781658">@Anthony Bullard</span> </p>
<p>It's probably past the point where I should stop and get some feedback. Maybe even worth merging now (it's passed all the CI checks)??</p>
<p>I feel like most of my effort has been on the fringes and infrastructure like SExpr stuff that I understand, and I haven't really touched core Can implementation things, aside from copying Anthony's lead I think.</p>
<p>I've got another day tomorrow I can probably spend hacking on this, so if anyone is able to skim through and give me any pointers that would be appreciated.</p>



<a name="522974895"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/522974895" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#522974895">(Jun 08 2025 at 12:30)</a>:</h4>
<p>i will take a look today Luke</p>



<a name="522974904"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/522974904" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#522974904">(Jun 08 2025 at 12:30)</a>:</h4>
<p>sorry i've been so busy</p>



<a name="522975038"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/522975038" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#522975038">(Jun 08 2025 at 12:33)</a>:</h4>
<p>Thank you <span aria-label="grinning" class="emoji emoji-1f600" role="img" title="grinning">:grinning:</span></p>



<a name="523050202"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/523050202" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#523050202">(Jun 09 2025 at 08:52)</a>:</h4>
<p>I started refactoring Can a little now I'm getting my head around what is going on there. It's such a massive thing I feel like some module structure for the API will help in the long run. </p>
<p>I've been trying different things out, and I'm basically just rolling with what I think is nicest. I figure if there are any concerns I'm happy to change it back etc. </p>
<p>One change is instead of calling it <code>IR</code> I started calling it <code>CIR</code> short for Can IR. It just helps a lot to qualify things, particularly when we are mixing both Parser IR and Can IR in some places.</p>



<a name="523050373"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/523050373" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#523050373">(Jun 09 2025 at 08:54)</a>:</h4>
<p>I'm really tempted to refactor and update Parser in a similar way, move Node and NodeStore out into separate files and rename to <code>PIR</code>. But I can wait until I get some feedback on these Can changes.</p>



<a name="523189818"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/523189818" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jared Ramirez <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#523189818">(Jun 10 2025 at 00:52)</a>:</h4>
<p><span class="user-mention silent" data-user-id="281383">Richard Feldman</span> <a href="#narrow/channel/395097-compiler-development/topic/casual.20conversation/near/522971631">said</a>:</p>
<blockquote>
<p>rather, we should reuse can idx to be var, and initialize the types store with a capacity of at least the highest can idx</p>
</blockquote>
<p>I think we might need to initialize some fresh vars as well – for Can nodes that need more than 1 var. Like a <code>tag</code> needs the tag union var &amp; an extensibility var, and we can't use the Can Idx for both. Though very possible I'm missing something</p>



<a name="523190596"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/523190596" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#523190596">(Jun 10 2025 at 01:05)</a>:</h4>
<p><span class="user-mention silent" data-user-id="461444">Sam Mohr</span> <a href="#narrow/channel/395097-compiler-development/topic/casual.20conversation/near/522967401">said</a>:</p>
<blockquote>
<p>Type store in module env makes sense! Probably better than specifically can IR</p>
</blockquote>
<p>I just realised I misread this comment when you wrote it Sam, and understood it to mean the opposite. <span aria-label="sweat smile" class="emoji emoji-1f605" role="img" title="sweat smile">:sweat_smile:</span> </p>
<p>Thinking about this more, I agree it needs to live in the ModuleEnv as that is where things should be that outlive any particular compiler stage IR.</p>
<p>Hatching plans with <span class="user-mention" data-user-id="341568">@Jared Ramirez</span>  to move it, but needs some coordination to update the type_store a little as it currently holds a pointer to ModuleEnv.</p>



<a name="523191542"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/523191542" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#523191542">(Jun 10 2025 at 01:17)</a>:</h4>
<p><span class="user-mention silent" data-user-id="341568">Jared Ramirez</span> <a href="#narrow/channel/395097-compiler-development/topic/casual.20conversation/near/523189818">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="281383">Richard Feldman</span> <a href="#narrow/channel/395097-compiler-development/topic/casual.20conversation/near/522971631">said</a>:</p>
<blockquote>
<p>rather, we should reuse can idx to be var, and initialize the types store with a capacity of at least the highest can idx</p>
</blockquote>
<p>I think we might need to initialize some fresh vars as well – for Can nodes that need more than 1 var. Like a <code>tag</code> needs the tag union var &amp; an extensibility var, and we can't use the Can Idx for both. Though very possible I'm missing something</p>
</blockquote>
<p>ah, so my thinking there was that we just make empty can slots</p>



<a name="523191584"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/523191584" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#523191584">(Jun 10 2025 at 01:18)</a>:</h4>
<p>in other words, let's say we have a can node that needs 3 vars - instead of that can node getting 1 slot and then we make 2 extra vars for it, we just give it 3 can slots</p>



<a name="523191631"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/523191631" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#523191631">(Jun 10 2025 at 01:19)</a>:</h4>
<p>it might sound like it's wasting memory, but my thinking is that the alternative is to spend the same amount of memory writing down which type vars they need</p>



<a name="523191724"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/523191724" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#523191724">(Jun 10 2025 at 01:20)</a>:</h4>
<p>and the advantage of this is that if you zero out the empty can slots, it becomes bidirectional; not only can you go from any given Can Idx to a type var, you can also take any given type var and get back to the Can Idx where it came from</p>



<a name="523191775"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/523191775" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#523191775">(Jun 10 2025 at 01:21)</a>:</h4>
<p>which in turn means (I think) that we could avoid propagating region info through to type checking, and still get error messages that map back to source</p>



<a name="523191826"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/523191826" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#523191826">(Jun 10 2025 at 01:21)</a>:</h4>
<p>because you can go from the type var that had the mismatch back to the original source via the Can IR node</p>



<a name="523191838"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/523191838" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#523191838">(Jun 10 2025 at 01:22)</a>:</h4>
<p>(that might not turn out to work in all cases though, I'm not sure yet haha)</p>



<a name="523191912"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/523191912" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#523191912">(Jun 10 2025 at 01:23)</a>:</h4>
<p>aside -- should the Can IR nodes have region info? only some do at the moment, and it was something I was looking at yesterday. I've threaded things through for the sexpr to display that for those nodes that do.</p>



<a name="523192581"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/523192581" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#523192581">(Jun 10 2025 at 01:31)</a>:</h4>
<p>Everything all the way down the stack should have region info</p>



<a name="523192597"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/523192597" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#523192597">(Jun 10 2025 at 01:32)</a>:</h4>
<p>Important for debug info with llvm</p>



<a name="523192849"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/523192849" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#523192849">(Jun 10 2025 at 01:35)</a>:</h4>
<p>another aside -- what about desugured nodes? do they inherit region info</p>



<a name="523192906"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/523192906" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#523192906">(Jun 10 2025 at 01:36)</a>:</h4>
<p>Also Re desugaring... should we have a similar to rust, single pass that runs before Can, or should we be doing that desugaring as we go through the Parse IR</p>



<a name="523192927"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/523192927" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#523192927">(Jun 10 2025 at 01:36)</a>:</h4>
<p><span class="user-mention silent" data-user-id="515757">Luke Boswell</span> <a href="#narrow/stream/395097-compiler-development/topic/casual.20conversation/near/523192849">said</a>:</p>
<blockquote>
<p>another aside -- what about desugured nodes? do they inherit region info</p>
</blockquote>
<p>Yes</p>



<a name="523193023"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/523193023" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#523193023">(Jun 10 2025 at 01:37)</a>:</h4>
<p><span class="user-mention silent" data-user-id="515757">Luke Boswell</span> <a href="#narrow/stream/395097-compiler-development/topic/casual.20conversation/near/523192906">said</a>:</p>
<blockquote>
<p>Also Re desugaring... should we have a similar to rust, single pass that runs before Can, or should we be doing that desugaring as we go through the Parse IR</p>
</blockquote>
<p>I think this was discussed a bit, and the decision was likely we should just start with a new pass just for desugaring, but at the same time, if it is trivial to do on a different IR, that is also fine.</p>



<a name="523193171"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/523193171" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#523193171">(Jun 10 2025 at 01:40)</a>:</h4>
<p>I want to skip desugaring for now</p>



<a name="523193190"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/523193190" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#523193190">(Jun 10 2025 at 01:40)</a>:</h4>
<p>as in, don't desugar anything - just keep it around as a first-class thing for later passes to deal with separately</p>



<a name="523193284"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/523193284" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#523193284">(Jun 10 2025 at 01:41)</a>:</h4>
<p>How do we handle string interpolation then?</p>



<a name="523193336"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/523193336" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#523193336">(Jun 10 2025 at 01:42)</a>:</h4>
<p>Here is my naive attempt at that in Can...</p>
<div class="codehilite"><pre><span></span><code>description=Simple string interpolation
 type=expr
 ~~~SOURCE
 &quot;Hello ${name}!&quot;
 ~~~PROBLEMS
 NIL
 ~~~TOKENS
 StringStart(1:1-1:2),StringPart(1:2-1:8),OpenStringInterpolation(1:8-1:10),LowerIdent(1:10-1:14),CloseStringInterpolation(1:14-1:15),StringPart(1:15-1:16),StringEnd(1:16-1:17),EndOfFile(1:17-1:17),
 ~~~PARSE


 (string (1:1-1:17)
    (string_part (1:2-1:8) &quot;Hello &quot;)
    (ident (1:10-1:14) &quot;&quot; &quot;name&quot;)
    (string_part (1:15-1:16) &quot;!&quot;))
 ~~~FORMATTED
 NO CHANGE
 ~~~CANONICALIZE
 (call
    (lookup (ident &quot;Str.concat&quot;))
    (call
        (lookup (ident &quot;Str.concat&quot;))
        (str &quot;Hello &quot;)
        (lookup (ident &quot;name&quot;)))
    (str &quot;!&quot;))
 ~~~END
</code></pre></div>



<a name="523193393"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/523193393" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#523193393">(Jun 10 2025 at 01:43)</a>:</h4>
<p>Basically, de-sugared the interpolation into multiple <code>Str.concat</code> calls (that I imagine exist).</p>



<a name="523198291"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/523198291" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#523198291">(Jun 10 2025 at 03:00)</a>:</h4>
<p>we just make an "interpolated string" can IR node type</p>



<a name="523198358"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/523198358" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#523198358">(Jun 10 2025 at 03:01)</a>:</h4>
<p>one reason for doing that is so that if there's an error message later (e.g. a type mismatch) we can do better than referring to Str.concat calls that aren't in the code</p>



<a name="523198383"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/523198383" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#523198383">(Jun 10 2025 at 03:01)</a>:</h4>
<p>bc we'll still know it was interpolation, so we can just put that directly in the error message</p>



<a name="523523253"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/523523253" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#523523253">(Jun 11 2025 at 09:56)</a>:</h4>
<p>In the same vein as the above ^^ should we make a node for Binop instead of desugaring to a call to <code>Num.add</code> etc</p>



<a name="523586482"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/523586482" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#523586482">(Jun 11 2025 at 15:26)</a>:</h4>
<p>Yep</p>



<a name="523586668"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/523586668" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#523586668">(Jun 11 2025 at 15:27)</a>:</h4>
<p>Or maybe a node per binop type in the end cause tags are cheap</p>



<a name="523650329"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/523650329" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#523650329">(Jun 11 2025 at 22:54)</a>:</h4>
<p><span class="user-mention" data-user-id="453336">@Joshua Warner</span> <span class="user-mention" data-user-id="781658">@Anthony Bullard</span>  -- any objections to me refactoring the <code>Node</code> and <code>NodeStore</code> out of the parser IR and into their own files (in the <code>src/check/parse</code> directory). </p>
<p>I think it helps clarify the abstraction a little more, basically the Store is a lower level abstraction for good memory/cache efficiency etc, and the IR is the higher level representation of the AST with helpers for parsing.</p>



<a name="523650536"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/523650536" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#523650536">(Jun 11 2025 at 22:56)</a>:</h4>
<p>Also, we wen't back and forth a little over what to call the IR, but settled on IR instead of AST (I think because it's just another IR in the overall compiler pipeline)... </p>
<p>Does anyone have any objections to using <code>PIR</code> for Parser IR?</p>



<a name="523650620"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/523650620" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#523650620">(Jun 11 2025 at 22:57)</a>:</h4>
<p>Maybe it's a little OCD or something, but I like fully qualifying the types and having a short and clear distinction between the parser and can types is helpful.</p>



<a name="523650630"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/523650630" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#523650630">(Jun 11 2025 at 22:57)</a>:</h4>
<p>Err, why not just AST? That’s the much more standard name for this.</p>



<a name="523650712"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/523650712" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#523650712">(Jun 11 2025 at 22:58)</a>:</h4>
<p>Calling everything an IR does make things sound uniform, but that also heavily dilutes the meaning of that term.</p>



<a name="523650722"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/523650722" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#523650722">(Jun 11 2025 at 22:58)</a>:</h4>
<p>I don't mind using <code>AST</code></p>



<a name="523650772"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/523650772" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#523650772">(Jun 11 2025 at 22:59)</a>:</h4>
<p>It's literally our concrete syntax right?</p>



<a name="523650830"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/523650830" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#523650830">(Jun 11 2025 at 22:59)</a>:</h4>
<p>No, it is actually abstract(er)! (Than the old “ast” was)</p>



<a name="523651031"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/523651031" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#523651031">(Jun 11 2025 at 23:01)</a>:</h4>
<p>In the process of refacatoring the <code>NodeStore</code> out into it's own file... I'd like to ziggify the types a little using nesting... so instead of <code>PatternRecordFieldIdx</code> we have <code>Pattern.RecordField.Idx</code>, and <code>getPatternRecordField</code> becomes <code>Pattern.RecordField.get</code> etc</p>



<a name="523651497"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/523651497" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#523651497">(Jun 11 2025 at 23:06)</a>:</h4>
<p>I know what I'm proposing is a little like moving the deckchairs on the titanic, and kind of pointless ... but I'm really enjoying these features of Zig and I think it helps to establish the patterns we want to use elsewhere.</p>



<a name="523653071"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/523653071" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#523653071">(Jun 11 2025 at 23:24)</a>:</h4>
<p>Not sure I fully understand how Pattern.RecordField.get would work?</p>



<a name="523653100"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/523653100" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#523653100">(Jun 11 2025 at 23:24)</a>:</h4>
<p>I think I need to see that in context</p>



<a name="523663152"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/523663152" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#523663152">(Jun 12 2025 at 01:14)</a>:</h4>
<p>Is there a particular reason we are using a struct instead of an enum for index types in the parser? </p>
<p>e.g. <code>pub const BodyIdx = struct { id: u32 };</code> instead of <code>pub const BodyIdx = enum(u32) { _ };</code></p>
<p>We use both in different places. From what I can tell it seems the enum approach is preferable, but I'm not sure if there was a specific reason we did this. I assume it was just the first thing we thought of at the time and it would be ok to use the enum.</p>



<a name="523663231"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/523663231" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#523663231">(Jun 12 2025 at 01:15)</a>:</h4>
<p>i don't personally think it matters</p>



<a name="523663265"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/523663265" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#523663265">(Jun 12 2025 at 01:15)</a>:</h4>
<p>the size of it is what matters and the ergonomics</p>



<a name="523663466"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/523663466" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#523663466">(Jun 12 2025 at 01:18)</a>:</h4>
<p>Ok, thank you. As far as I can tell this is about the only difference.</p>
<div class="codehilite" data-code-language="Zig"><pre><span></span><code><span class="k">return</span><span class="w"> </span><span class="p">.{</span><span class="w"> </span><span class="p">.</span><span class="n">crash</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.{</span>
<span class="w">    </span><span class="c1">// using the struct approach</span>
<span class="w">    </span><span class="p">.</span><span class="n">expr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.{</span><span class="w"> </span><span class="p">.</span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">node</span><span class="p">.</span><span class="n">data</span><span class="p">.</span><span class="n">lhs</span><span class="w"> </span><span class="p">},</span>
<span class="w">    </span><span class="p">.</span><span class="n">region</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">node</span><span class="p">.</span><span class="n">region</span><span class="p">,</span>
<span class="p">}</span><span class="w"> </span><span class="p">};</span>

<span class="k">return</span><span class="w"> </span><span class="p">.{</span><span class="w"> </span><span class="p">.</span><span class="n">crash</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.{</span>
<span class="w">    </span><span class="c1">// using the enum approach</span>
<span class="w">    </span><span class="p">.</span><span class="n">expr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">@enumFromInt</span><span class="p">(</span><span class="n">node</span><span class="p">.</span><span class="n">data</span><span class="p">.</span><span class="n">lhs</span><span class="p">),</span>
<span class="w">    </span><span class="p">.</span><span class="n">region</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">node</span><span class="p">.</span><span class="n">region</span><span class="p">,</span>
<span class="p">}</span><span class="w"> </span><span class="p">};</span>
</code></pre></div>



<a name="523664925"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/523664925" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#523664925">(Jun 12 2025 at 01:39)</a>:</h4>
<p>yep</p>



<a name="523664939"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/523664939" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#523664939">(Jun 12 2025 at 01:39)</a>:</h4>
<p>i prefer the former, but don't care that much</p>



<a name="523671616"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/523671616" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#523671616">(Jun 12 2025 at 03:33)</a>:</h4>
<p>I've been making these changes, and have found many places where one would work better, and other places where the other works better. <span aria-label="shrug" class="emoji emoji-1f937" role="img" title="shrug">:shrug:</span> </p>
<p>I don't feel particularly strong about it either, but I'm a far way through making all the Idx's use the enum approach. I'll keep going and see how it looks.</p>



<a name="523861888"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/523861888" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#523861888">(Jun 13 2025 at 02:39)</a>:</h4>
<p><span class="user-mention" data-user-id="341568">@Jared Ramirez</span> mentioned he is ready to wire up the type vars properly in Can. </p>
<p>I think we should merge my gigantic Can PR that I've been working against so he has a more mature structure to work with.</p>
<p>I've been in a move fast and break things / refactor mode so theres a lot of improvements there, but all low technical risk as I'm mostly fleshing out the new Can stage and wiring everything up so we have snapshots with diagnostic errors and region info etc (along with some very primitive Can analysis).</p>



<a name="523892937"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/523892937" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#523892937">(Jun 13 2025 at 08:07)</a>:</h4>
<p>Brief update on progress with Can. </p>
<p>Improved the snapshots reporting so they should now display all the problems, and print out useful information. Haven't got region info, but for now just seeing the source is useful to understand where the issue is.</p>
<div class="codehilite"><pre><span></span><code>~~~SOURCE
app [main!] { pf: platform &quot;../basic-cli/platform.roc&quot; }

import pf.Stdout

main! = |_| Stdout.line!(&quot;Hello, world!&quot;)
~~~PROBLEMS
CANONICALIZE: ident_not_in_scope &quot;Stdout.line!&quot;
CANONICALIZE: can_lambda_not_implemented &quot;|_| Stdout.line!(...&quot;
</code></pre></div>
<p>For hello world we are almost there.. just need to figure out the final details on lambdas. I'm not sure if we should have a lambda <code>Expr</code> variant in the Can IR or if there is some analysis we should be doing here to make it something else. We could have just missed that variant when translating from rust.</p>
<div class="codehilite"><pre><span></span><code>~~~CANONICALIZE
(can_ir
    (top_level_defs
        (def
            &quot;let&quot;
            (pattern (5:1-5:6)
                (assign (5:1-5:6) (ident &quot;main!&quot;)))
            (expr (5:9-5:42) (runtime_error (5:9-5:42) &quot;can_lambda_not_implemented&quot;))
            &quot;#0&quot;)))
</code></pre></div>
<p>All the Can nodes have regions information now, and they display correctly in our SExpr snapshots. </p>
<p>I've implemented most of the <code>Expr</code>, <code>Pattern</code>, and <code>Statment</code> handling in the <code>NodeStore</code> now, theres a few nodes here and there that need to store things in <code>extra_data</code> but I figure we will do that as we get to them. It should be mush easier now to implement the analysis logic without thinking too much about the low-level store.</p>



<a name="523911930"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/523911930" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#523911930">(Jun 13 2025 at 09:58)</a>:</h4>
<p>We've discussed it before previously I think... but should we consider having a constants file somewhere where we keen magic hardcoded numbers that configure the compiler?</p>
<p>I was looking at <span class="user-mention" data-user-id="341568">@Jared Ramirez</span> PR's for unify and the <code>max_depth_before_occurs</code> variable made me think of it. </p>
<p><span class="user-mention" data-user-id="343810">@Brendan Hansknecht</span> can you remember talking about this<br>
?</p>



<a name="523954348"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/523954348" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#523954348">(Jun 13 2025 at 14:08)</a>:</h4>
<p>yes, I was thinking this too</p>



<a name="523954375"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/523954375" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#523954375">(Jun 13 2025 at 14:08)</a>:</h4>
<p>I like the name <code>limits.zig</code></p>



<a name="523954470"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/523954470" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#523954470">(Jun 13 2025 at 14:09)</a>:</h4>
<p>and putting it at the top level dir so everything can access it (and it shouldn't import anything)</p>



<a name="524318349"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/524318349" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#524318349">(Jun 16 2025 at 19:08)</a>:</h4>
<p>When debugging the rust compiler, note that you need to comment out <a href="https://github.com/roc-lang/roc/blob/bba2103882a8124f3887da6adaaa44cf2b728c3e/Cargo.toml#L240">this line</a> to see local vars with lldb or gdb</p>



<a name="524607796"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/524607796" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#524607796">(Jun 17 2025 at 22:56)</a>:</h4>
<p>I'm tracking the implementation of Scope is not quite correct. I discussed with Richard the intended design to accomodate <code>var</code> and shadowing and I intend on revisiting that next.</p>



<a name="524799678"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/524799678" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jared Ramirez <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#524799678">(Jun 19 2025 at 00:15)</a>:</h4>
<p>Heads up that I’m starting work on basic type solving, now that we have basic type variable generation in Can. Just positing for viz!</p>



<a name="525005586"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/525005586" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#525005586">(Jun 20 2025 at 09:13)</a>:</h4>
<p>I'm experimenting with some additions to my .rules file. I thought I'd made a PR to share. I might give it a week or so and see if I feel like tweaking it. </p>
<p><a href="https://github.com/roc-lang/roc/pull/7845">https://github.com/roc-lang/roc/pull/7845</a></p>
<p>So far it's been good. I find the agents are much quicker at finding the relevant information for a task.</p>



<a name="525005943"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/525005943" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#525005943">(Jun 20 2025 at 09:16)</a>:</h4>
<p>Cool stuff, can you try mentioning the Glossary.md file? It has a lot of links and Roc compiler specific terms too, I would expect it to be helpful.</p>



<a name="525006529"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/525006529" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#525006529">(Jun 20 2025 at 09:20)</a>:</h4>
<p>The Glossary is a very useful resource, and it's getting better all the time <span aria-label="smiley" class="emoji emoji-1f603" role="img" title="smiley">:smiley:</span></p>



<a name="525112209"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/525112209" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#525112209">(Jun 20 2025 at 22:50)</a>:</h4>
<p>Are type declarations only valid at the top-level? (I'm reasonably sure they are valid everywhere) but I figured I'd clarify. I'm going to leave the type_decl in statement positions as a TODO for now.</p>



<a name="525117834"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/525117834" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#525117834">(Jun 21 2025 at 00:44)</a>:</h4>
<p>they're valid everywhere, yeah</p>



<a name="525118840"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/525118840" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#525118840">(Jun 21 2025 at 01:09)</a>:</h4>
<p>type decls are valid everywhere??</p>



<a name="525118862"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/525118862" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#525118862">(Jun 21 2025 at 01:09)</a>:</h4>
<p>i've never seen that before outside the top level</p>



<a name="525119023"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/525119023" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#525119023">(Jun 21 2025 at 01:14)</a>:</h4>
<p>Define a type decl?</p>
<p>Do we mean:<br>
1</p>
<div class="codehilite" data-code-language="Ruby"><pre><span></span><code><span class="no">SomeType</span><span class="w"> </span><span class="p">:</span><span class="o">=</span><span class="w"> </span><span class="o">[</span><span class="no">InnerType</span><span class="o">]</span>
</code></pre></div>
<p>2</p>
<div class="codehilite" data-code-language="Ruby"><pre><span></span><code><span class="no">SomeAlias</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="o">[</span><span class="no">InnerType</span><span class="o">]</span>
</code></pre></div>
<p>3</p>
<div class="codehilite" data-code-language="Ruby"><pre><span></span><code><span class="n">x</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="no">SomeType</span>
<span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">InnerType</span>
</code></pre></div>



<a name="525119041"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/525119041" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#525119041">(Jun 21 2025 at 01:15)</a>:</h4>
<p>1 and 2</p>



<a name="525119112"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/525119112" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#525119112">(Jun 21 2025 at 01:16)</a>:</h4>
<p>I could see 2 being valid anywhere....though a bit strange.... 1 sounds pretty crazy given we anchor static dispatch to the module and it would just generally be odd to define a named type within a scope in roc.</p>



<a name="525119138"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/525119138" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#525119138">(Jun 21 2025 at 01:17)</a>:</h4>
<p>Why do we want the everywhere? I feel like that only makes sense if we allow nested modules or other more intense scoping of some form.</p>



<a name="525120041"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/525120041" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#525120041">(Jun 21 2025 at 01:42)</a>:</h4>
<p>it's mostly to avoid having an arbitrary restriction in the language</p>



<a name="525120047"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/525120047" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#525120047">(Jun 21 2025 at 01:42)</a>:</h4>
<p>like yeah you can just use them wherever, no special rules</p>



<a name="525120057"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/525120057" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#525120057">(Jun 21 2025 at 01:42)</a>:</h4>
<p>Fair enough</p>



<a name="525120074"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/525120074" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#525120074">(Jun 21 2025 at 01:43)</a>:</h4>
<p>I can't wait to see the use of an opaque type that is defined in a function and returned.</p>



<a name="525120088"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/525120088" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#525120088">(Jun 21 2025 at 01:43)</a>:</h4>
<p>i don't even know what that could do</p>



<a name="525120089"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/525120089" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#525120089">(Jun 21 2025 at 01:43)</a>:</h4>
<p>it would not be very useful <span aria-label="joy" class="emoji emoji-1f602" role="img" title="joy">:joy:</span></p>



<a name="525120102"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/525120102" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#525120102">(Jun 21 2025 at 01:44)</a>:</h4>
<p>seems like a footgun</p>



<a name="525120108"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/525120108" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#525120108">(Jun 21 2025 at 01:44)</a>:</h4>
<p>I think it literally could only be used if it also was returned with functions that can use the type</p>



<a name="525121558"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/525121558" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#525121558">(Jun 21 2025 at 02:25)</a>:</h4>
<p>wouldn't that mean that the type would have to live outside the scope of the function ?</p>



<a name="525121866"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/525121866" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#525121866">(Jun 21 2025 at 02:34)</a>:</h4>
<p>Not sure, but it does sound complicated to reason about at a minimum</p>



<a name="525123142"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/525123142" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#525123142">(Jun 21 2025 at 03:13)</a>:</h4>
<p>heh, these are fair points</p>



<a name="525123146"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/525123146" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#525123146">(Jun 21 2025 at 03:13)</a>:</h4>
<p>maybe we should just disallow it for 0.1.0 and revisit later</p>



<a name="525123244"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/525123244" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#525123244">(Jun 21 2025 at 03:16)</a>:</h4>
<p>Yeah, based on trying to implement it, my vote is to restrict to top level for now. It seems strange having type decls in Scope</p>



<a name="525125969"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/525125969" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#525125969">(Jun 21 2025 at 04:20)</a>:</h4>
<p>Type decls inside a function could be useful for making sure you understand the type of some intermediate variable - e.g. like a type assertion</p>



<a name="525126009"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/525126009" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#525126009">(Jun 21 2025 at 04:21)</a>:</h4>
<p>for that purpose, you'd need to use 1+3 or 2+3 (i.e. together with a value defined)</p>



<a name="525150300"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/525150300" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#525150300">(Jun 21 2025 at 10:19)</a>:</h4>
<p>3 is fine, it's 1 and 2 that are a problem, and more 1 than 2</p>



<a name="525391428"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/525391428" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kiryl Dziamura <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#525391428">(Jun 23 2025 at 18:55)</a>:</h4>
<p>is there a thread with the current work plan or smth like that for coordination? I'm trying to get into zig rewrite but don't understand current goals and workflow. just don't know where to start at. I see <code>src/README.md</code>, it implies loads of work to be done, but nothing really specific. maybe there are some shortcuts to avoid redundant job?<br>
e.g. I see records canonicalization isn't implemented yet. I assume there's a way to adapt rust implementation, but not sure if there an agreement on best practices. shortly, what's the rule of thumb for the rewrite?</p>



<a name="525419583"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/525419583" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#525419583">(Jun 23 2025 at 23:14)</a>:</h4>
<p>I would say the rule of thumb is to coordinate via zulip, let people know what you are up to by making Draft PRs etc.</p>
<p>I've been focussing on implementing more of Can along with the s-expressions for debugging and making nice error reports.</p>
<p>Anthony is currently looking at the Builtins I think. </p>
<p>Jared has been hooking the first parts of type unification.</p>
<p>Richard has been laying the foundation for runtime representations so we can evaluating things using the interpreter.</p>
<p>I was thinking about looking at either how do we fuzz Can or start using the cache for single modules, next.</p>
<p>There's a mountain of unimplemented or hacked together things though in Can. Records haven't been touched. When (now <code>match</code>) hasn't been touched. There's many error reports that we can bring across from the rust implementation.</p>
<p>I've been picking a snapshot that represents a real bit of roc code and seeing what I can do to get it working end to end, and letting that take me on a yak shaving adventure.  </p>
<p>I wouldn't recommend doing anything in the build (or later) stages yet. I think the immediate goal is getting a basic interpreter going that we have high confidence is working correctly.</p>



<a name="525441537"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/525441537" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#525441537">(Jun 24 2025 at 04:52)</a>:</h4>
<p>I've been noodling around with adding a secondary output file for snapshot tests - an html file with a more interactive version of the snapshot, with things like hovering over tokens or ranges in the snapshot output causing the corresponding source range in the input to be highlighted (and visa-versa). My thinking is that we'd always generate these .html files next to the existing snapshots but have them git-ignored to avoid bloating the repo. We can also start to integrate some of the debugging/visualization tools for various compiler passes into this html output. Thoughts?</p>



<a name="525442282"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/525442282" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#525442282">(Jun 24 2025 at 05:03)</a>:</h4>
<p>Love it</p>



<a name="525442498"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/525442498" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#525442498">(Jun 24 2025 at 05:06)</a>:</h4>
<p>One of the s-expression changes I've been thinking about, is should we be displaying the node_idx on each node? We have some nodes that reference other nodes (for example a pattern for a declaration). I could imagine hovering over a reference like that, and it highlights the s-expression node being referenced.</p>



<a name="525442523"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/525442523" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#525442523">(Jun 24 2025 at 05:07)</a>:</h4>
<p>Oooh, yeah!</p>



<a name="525442586"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/525442586" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#525442586">(Jun 24 2025 at 05:08)</a>:</h4>
<p>For this reason I've ben thinking of making all node_idx's use a common formatting like <code>#12</code> (I think this is similar to what we had in the rust debug IR formats)</p>



<a name="525443687"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/525443687" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#525443687">(Jun 24 2025 at 05:24)</a>:</h4>
<p>Initial version of that, only adding this new fanciness for the TOKENS section: <a href="https://github.com/roc-lang/roc/pull/7864">https://github.com/roc-lang/roc/pull/7864</a></p>



<a name="525444079"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/525444079" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#525444079">(Jun 24 2025 at 05:30)</a>:</h4>
<p><a href="/user_uploads/22008/2ie13F0Xpa3v-vNCY6M-6ArV/demo-html-snapshots.gif">demo-html-snapshots.gif</a></p>
<div class="message_inline_image"><a href="/user_uploads/22008/2ie13F0Xpa3v-vNCY6M-6ArV/demo-html-snapshots.gif" title="demo-html-snapshots.gif"><img data-animated="true" data-original-content-type="image/gif" data-original-dimensions="1254x700" src="/user_uploads/thumbnail/22008/2ie13F0Xpa3v-vNCY6M-6ArV/demo-html-snapshots.gif/840x560-anim.webp"></a></div>



<a name="525444435"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/525444435" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#525444435">(Jun 24 2025 at 05:36)</a>:</h4>
<p>We have flags on the snapshot tool like <code>--verbose</code> ... we could include others like <code>--html</code> or <code>--watch</code>.</p>
<p>Maybe that loads a single web app that then has all the snapshots</p>



<a name="525444476"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/525444476" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#525444476">(Jun 24 2025 at 05:36)</a>:</h4>
<p>The renderToHtml for Reports renders using the standardised css classes we want</p>



<a name="525444503"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/525444503" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#525444503">(Jun 24 2025 at 05:37)</a>:</h4>
<p>The s-expressions could have a <code>renderToHtml</code> helper too instead of the plain text version</p>



<a name="525444536"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/525444536" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#525444536">(Jun 24 2025 at 05:37)</a>:</h4>
<p>Anyway, there's a lot of different directions we could go with this. Great fun.</p>



<a name="525489363"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/525489363" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kiryl Dziamura <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#525489363">(Jun 24 2025 at 10:45)</a>:</h4>
<p>I'm going to work on binop tokens -&gt; CIR mapping if it's ok</p>



<a name="525557452"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/525557452" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#525557452">(Jun 24 2025 at 16:41)</a>:</h4>
<p>sounds good! We decided to have binops represented directly in CIR rather than desugaring them to function calls</p>



<a name="525557576"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/525557576" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#525557576">(Jun 24 2025 at 16:42)</a>:</h4>
<p>the idea is that it will simplify having error messages trace back to what was originally in the source code</p>



<a name="525557643"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/525557643" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kiryl Dziamura <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#525557643">(Jun 24 2025 at 16:42)</a>:</h4>
<p>nice! that's exactly what I was about to ask</p>



<a name="525557710"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/525557710" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#525557710">(Jun 24 2025 at 16:42)</a>:</h4>
<p>(as opposed to converting them to a Call node which then has to record "was I called via a binop, and if so which one?" which has the same information but with more redundancy and memory usage)</p>



<a name="525557905"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/525557905" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kiryl Dziamura <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#525557905">(Jun 24 2025 at 16:44)</a>:</h4>
<p>what's the key difference between ast and cir then?</p>



<a name="525558273"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/525558273" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#525558273">(Jun 24 2025 at 16:46)</a>:</h4>
<p>one critical difference is that lookups have all been resolved to other CIR indices instead of using strings</p>
<p>another important one is that we've organized everything so that type variables map 1-to-1 with CIR indices, whereas they certainly do not map 1-to-1 with AST nodes <span aria-label="smile" class="emoji emoji-1f604" role="img" title="smile">:smile:</span></p>



<a name="525558575"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/525558575" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#525558575">(Jun 24 2025 at 16:48)</a>:</h4>
<p>oh yeah we also have translated <code>=</code> into either declare or reassign, depending on whether there was a previous declaration under the same name made with <code>var</code></p>



<a name="525679024"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/525679024" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#525679024">(Jun 25 2025 at 10:12)</a>:</h4>
<p>Is this valid in 0.1 syntax?</p>
<div class="codehilite"><pre><span></span><code>checkNumber = |num| {
    if num &lt; 0 then
        &quot;negative&quot;
    else if num == 0 then
        &quot;zero&quot;
    else if num &gt; 100 then
        &quot;large&quot;
    else
        &quot;positive&quot;
}
</code></pre></div>



<a name="525680338"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/525680338" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#525680338">(Jun 25 2025 at 10:21)</a>:</h4>
<p>Figured it out ...</p>
<div class="codehilite"><pre><span></span><code>module [checkNumber]

checkNumber = |num| {
    if num &lt; 0 {
        &quot;negative&quot;
    } else if num == 0 {
        &quot;zero&quot;
    } else if num &gt; 100 {
        &quot;large&quot;
    } else {
        &quot;positive&quot;
    }
}
</code></pre></div>



<a name="525702704"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/525702704" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#525702704">(Jun 25 2025 at 12:34)</a>:</h4>
<p>i think we need to reevaluate this syntax a bit</p>



<a name="525702774"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/525702774" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#525702774">(Jun 25 2025 at 12:34)</a>:</h4>
<p>not when using blocks, but when using expressions after any condition</p>



<a name="525713748"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/525713748" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#525713748">(Jun 25 2025 at 13:31)</a>:</h4>
<p>I think it should be fine to omit the brackets there</p>



<a name="525713848"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/525713848" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#525713848">(Jun 25 2025 at 13:31)</a>:</h4>
<p>like this should work</p>
<div class="codehilite" data-code-language="Zig"><pre><span></span><code><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">num</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span>
<span class="w">        </span><span class="s">"negative"</span>
<span class="w">    </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">num</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span>
<span class="w">        </span><span class="s">"zero"</span>
<span class="w">    </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">num</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">100</span>
<span class="w">        </span><span class="s">"large"</span>
<span class="w">    </span><span class="k">else</span>
<span class="w">        </span><span class="s">"positive"</span>
</code></pre></div>



<a name="525713951"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/525713951" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#525713951">(Jun 25 2025 at 13:32)</a>:</h4>
<p>there's a separate question of whether the formatter should insert brackets</p>



<a name="525714006"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/525714006" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#525714006">(Jun 25 2025 at 13:32)</a>:</h4>
<p>but I think it simplifies the rules of the language to not require brackets there</p>



<a name="525714160"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/525714160" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#525714160">(Jun 25 2025 at 13:33)</a>:</h4>
<p>and I think it would actually be nice to be able to do like</p>
<div class="codehilite" data-code-language="Zig"><pre><span></span><code><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">things</span><span class="p">.</span><span class="n">is_empty</span><span class="p">()</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="mi">1</span>
</code></pre></div>



<a name="525715184"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/525715184" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#525715184">(Jun 25 2025 at 13:38)</a>:</h4>
<p>Yeah, I'd like to avoid brackets when possible</p>



<a name="525715187"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/525715187" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#525715187">(Jun 25 2025 at 13:38)</a>:</h4>
<p>I think in a lot of cases the squirly-less syntax is unreadable, especially without newline / indent</p>



<a name="525715545"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/525715545" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#525715545">(Jun 25 2025 at 13:40)</a>:</h4>
<p>Onelining is not a must for me, they do easily become hard to read</p>



<a name="525715573"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/525715573" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#525715573">(Jun 25 2025 at 13:40)</a>:</h4>
<p>I find myself wanting to put parens around the condition if I don't use squirlies</p>



<a name="525715653"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/525715653" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#525715653">(Jun 25 2025 at 13:40)</a>:</h4>
<p>And it's on oneline</p>



<a name="525716156"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/525716156" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#525716156">(Jun 25 2025 at 13:43)</a>:</h4>
<p>same here, except if there's already a closing paren from a function call</p>



<a name="525716207"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/525716207" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#525716207">(Jun 25 2025 at 13:43)</a>:</h4>
<p>e.g.</p>
<div class="codehilite" data-code-language="C"><pre><span></span><code><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">things</span><span class="p">.</span><span class="n">is_empty</span><span class="p">()</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="mi">1</span>
</code></pre></div>
<p>vs.</p>
<div class="codehilite" data-code-language="C"><pre><span></span><code><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">condition</span><span class="p">)</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="mi">1</span>
</code></pre></div>
<p>vs.</p>
<div class="codehilite" data-code-language="C"><pre><span></span><code><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">condition</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="mi">1</span>
</code></pre></div>



<a name="525716282"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/525716282" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#525716282">(Jun 25 2025 at 13:44)</a>:</h4>
<p>first 2 look fine to me, and I don't think this is necessary:</p>
<div class="codehilite" data-code-language="C"><pre><span></span><code><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">things</span><span class="p">.</span><span class="n">is_empty</span><span class="p">())</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="mi">1</span>
</code></pre></div>



<a name="525716420"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/525716420" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#525716420">(Jun 25 2025 at 13:44)</a>:</h4>
<p>as an aside, something I've wondered about is whether we  should use curly braces like we use trailing commas - as an indicator of whether the formatter should use newlines</p>



<a name="525716505"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/525716505" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#525716505">(Jun 25 2025 at 13:45)</a>:</h4>
<p>e.g.</p>
<div class="codehilite" data-code-language="Ruby"><pre><span></span><code><span class="n">fn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">|</span><span class="n">arg</span><span class="o">|</span><span class="w"> </span><span class="n">arg</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
</code></pre></div>
<div class="codehilite" data-code-language="Ruby"><pre><span></span><code><span class="n">fn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">|</span><span class="n">arg</span><span class="o">|</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">arg</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="p">}</span>
</code></pre></div>



<a name="525716539"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/525716539" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#525716539">(Jun 25 2025 at 13:45)</a>:</h4>
<p>if there are curlies we always do multiline</p>



<a name="525716618"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/525716618" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#525716618">(Jun 25 2025 at 13:45)</a>:</h4>
<div class="codehilite" data-code-language="Ruby"><pre><span></span><code><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">things</span><span class="o">.</span><span class="n">is_empty</span><span class="p">()</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="mi">1</span>
</code></pre></div>
<div class="codehilite" data-code-language="Ruby"><pre><span></span><code><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">things</span><span class="o">.</span><span class="n">is_empty</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="mi">0</span>
<span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="mi">1</span>
<span class="p">}</span>
</code></pre></div>



<a name="525716836"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/525716836" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#525716836">(Jun 25 2025 at 13:46)</a>:</h4>
<p>Seems reasonable</p>



<a name="525716845"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/525716845" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#525716845">(Jun 25 2025 at 13:46)</a>:</h4>
<p>I think blocks do always use multiline</p>



<a name="525716877"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/525716877" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#525716877">(Jun 25 2025 at 13:46)</a>:</h4>
<p>in the formatter in the zig compiler</p>



<a name="525716904"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/525716904" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#525716904">(Jun 25 2025 at 13:47)</a>:</h4>
<p>cool, TIL!</p>



<a name="525716999"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/525716999" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#525716999">(Jun 25 2025 at 13:47)</a>:</h4>
<p>I _think_, it's been a month or more since I worked on it</p>



<a name="525717088"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/525717088" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#525717088">(Jun 25 2025 at 13:47)</a>:</h4>
<p>let me check that out</p>



<a name="525717384"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/525717384" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#525717384">(Jun 25 2025 at 13:49)</a>:</h4>
<p>Oh, if the block is retained it's multiline, but it's usually elided in the formatter if not necessary</p>



<a name="525717598"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/525717598" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#525717598">(Jun 25 2025 at 13:49)</a>:</h4>
<p>I think that would be easy to change.  If I see a useless block that is single-line, keep it (it will naturally be multiline)</p>



<a name="525722000"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/525722000" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#525722000">(Jun 25 2025 at 14:09)</a>:</h4>
<p>yeah I like that idea!</p>



<a name="525722183"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/525722183" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#525722183">(Jun 25 2025 at 14:09)</a>:</h4>
<p>it would be really cool if we could get to a point where the author has control over single-line vs multiline, without needing the formatter to be aware of newlines</p>



<a name="525722242"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/525722242" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#525722242">(Jun 25 2025 at 14:10)</a>:</h4>
<p>using a combination of blocks vs no blocks and trailing comma vs no trailing comma, etc.</p>



<a name="525723712"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/525723712" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#525723712">(Jun 25 2025 at 14:17)</a>:</h4>
<p>I think we are already partly there</p>



<a name="525726077"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/525726077" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#525726077">(Jun 25 2025 at 14:28)</a>:</h4>
<p><span aria-label="thinking" class="emoji emoji-1f914" role="img" title="thinking">:thinking:</span>  what's remaining?</p>



<a name="525726164"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/525726164" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#525726164">(Jun 25 2025 at 14:29)</a>:</h4>
<p>assuming we adopted those rules for trailing commas and blocks</p>



<a name="525730959"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/525730959" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#525730959">(Jun 25 2025 at 14:51)</a>:</h4>
<p>just removing all checking for newlines</p>



<a name="525799358"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/525799358" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#525799358">(Jun 25 2025 at 22:35)</a>:</h4>
<p>I'm having a crack at Can for Records now.</p>



<a name="525996195"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/525996195" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#525996195">(Jun 27 2025 at 00:22)</a>:</h4>
<p>I'm working on de-structuring record patterns now. I've merged main in and just adding to my Records PR. Also addressing the review feedback. Thank you <span class="user-mention" data-user-id="341568">@Jared Ramirez</span>  and <span class="user-mention" data-user-id="781658">@Anthony Bullard</span></p>



<a name="526048949"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/526048949" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kiryl Dziamura <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#526048949">(Jun 27 2025 at 09:50)</a>:</h4>
<p>What do you think about format <code>@1.5-2.3</code> for regions in sexprs?</p>
<div class="codehilite" data-code-language="Clojure"><pre><span></span><code><span class="p">(</span><span class="nf">e-tuple</span><span class="w"> </span><span class="o">@</span><span class="mf">1.1-17.2</span>
<span class="w">    </span><span class="p">(</span><span class="nf">e-binop</span><span class="w"> </span><span class="o">@</span><span class="mf">2.5-2.11</span><span class="w"> </span><span class="p">(</span><span class="nf">op</span><span class="w"> </span><span class="s">"+"</span><span class="p">)</span>
<span class="w">        </span><span class="p">(</span><span class="nf">e-int</span><span class="w"> </span><span class="o">@</span><span class="mf">2.5-2.6</span><span class="w"> </span><span class="p">(</span><span class="nf">raw</span><span class="w"> </span><span class="s">"4"</span><span class="p">))</span>
<span class="w">        </span><span class="p">(</span><span class="nf">e-int</span><span class="w"> </span><span class="o">@</span><span class="mf">2.9-2.10</span><span class="w"> </span><span class="p">(</span><span class="nf">raw</span><span class="w"> </span><span class="s">"2"</span><span class="p">)))</span>
</code></pre></div>
<p>Right now:</p>
<div class="codehilite" data-code-language="Clojure"><pre><span></span><code><span class="p">(</span><span class="nf">e-tuple</span><span class="w"> </span><span class="o">@</span><span class="mi">1-1-17-2</span>
<span class="w">    </span><span class="p">(</span><span class="nf">e-binop</span><span class="w"> </span><span class="o">@</span><span class="mi">2-5-2-11</span><span class="w"> </span><span class="p">(</span><span class="nf">op</span><span class="w"> </span><span class="s">"+"</span><span class="p">)</span>
<span class="w">        </span><span class="p">(</span><span class="nf">e-int</span><span class="w"> </span><span class="o">@</span><span class="mi">2-5-2-6</span><span class="w"> </span><span class="p">(</span><span class="nf">raw</span><span class="w"> </span><span class="s">"4"</span><span class="p">))</span>
<span class="w">        </span><span class="p">(</span><span class="nf">e-int</span><span class="w"> </span><span class="o">@</span><span class="mi">2-9-2-10</span><span class="w"> </span><span class="p">(</span><span class="nf">raw</span><span class="w"> </span><span class="s">"2"</span><span class="p">)))</span>
</code></pre></div>



<a name="526105686"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/526105686" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Norbert Hajagos <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#526105686">(Jun 27 2025 at 15:13)</a>:</h4>
<p>Does anyone have something I can help with? Open for coding any area that is zig! Last time I made the txt -&gt; markdown conversion for our snapshots. I'm down to do something one step harder, or similar. Will be back later to read zulip.</p>



<a name="526176862"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/526176862" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#526176862">(Jun 28 2025 at 04:43)</a>:</h4>
<p>Random side-note: git does terrrrrrribly with rebasing (or merging, I think) changes when one of the sides does a case-only rename (e.g. sexpr.zig-&gt;SExpr.zig), and you're operating on a case insensitive filesystem (e.g. mac).</p>



<a name="526176882"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/526176882" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#526176882">(Jun 28 2025 at 04:44)</a>:</h4>
<p>Like... it seems to not be able to do it on its own</p>



<a name="526176897"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/526176897" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#526176897">(Jun 28 2025 at 04:44)</a>:</h4>
<div class="codehilite"><pre><span></span><code>error: Your local changes to the following files would be overwritten by merge:
    src/base/SExpr.zig
Please commit your changes or stash them before you merge.
Aborting
hint: Could not execute the todo command
hint:
hint:     squash bb9df942054bfb94f2a3d154e6a549ea510edfec Switch to two-column layout in snapshot html and jazz up parse output
hint:
hint: It has been rescheduled; To edit the command before continuing, please
hint: edit the todo list first:
hint:
hint:     git rebase --edit-todo
hint:     git rebase --continue
</code></pre></div>
<p>(note: I made no 'local changes' here - this was git rebase stepping on its own toes)</p>



<a name="526177019"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/526177019" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#526177019">(Jun 28 2025 at 04:48)</a>:</h4>
<p>Sigh. Going to have to stitch this back together manually...</p>



<a name="526177166"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/526177166" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#526177166">(Jun 28 2025 at 04:51)</a>:</h4>
<p>... which wasn't as bad as it could have been</p>



<a name="526177173"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/526177173" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#526177173">(Jun 28 2025 at 04:52)</a>:</h4>
<p>But, my goodness, I wouldn't have expected git to be this terrible</p>



<a name="526177182"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/526177182" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#526177182">(Jun 28 2025 at 04:52)</a>:</h4>
<p>(thanks for listening)</p>



<a name="526177191"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/526177191" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#526177191">(Jun 28 2025 at 04:52)</a>:</h4>
<p><a href="https://github.com/roc-lang/roc/pull/7889">https://github.com/roc-lang/roc/pull/7889</a></p>



<a name="526177389"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/526177389" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#526177389">(Jun 28 2025 at 04:58)</a>:</h4>
<p><a href="/user_uploads/22008/os9Y9iUgRrdxLgVTF9h5hwvq/Screen-Recording-2025-06-27-at-21.53.50.gif">Screen Recording 2025-06-27 at 21.53.50.gif</a></p>
<div class="message_inline_image"><a href="/user_uploads/22008/os9Y9iUgRrdxLgVTF9h5hwvq/Screen-Recording-2025-06-27-at-21.53.50.gif" title="Screen Recording 2025-06-27 at 21.53.50.gif"><img data-animated="true" data-original-content-type="image/gif" data-original-dimensions="640x352" src="/user_uploads/thumbnail/22008/os9Y9iUgRrdxLgVTF9h5hwvq/Screen-Recording-2025-06-27-at-21.53.50.gif/840x560-anim.webp"></a></div>



<a name="526177404"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/526177404" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#526177404">(Jun 28 2025 at 04:58)</a>:</h4>
<p>Now doing highlighting of tokens when mousing over the parse tree</p>



<a name="526177425"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/526177425" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#526177425">(Jun 28 2025 at 04:59)</a>:</h4>
<p>Already caught a few cases that look kinda fishy in terms of the token range we choose for various ast nodes</p>



<a name="526177437"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/526177437" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#526177437">(Jun 28 2025 at 04:59)</a>:</h4>
<p>Also added click-to-scroll to the token view</p>



<a name="526177465"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/526177465" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#526177465">(Jun 28 2025 at 05:00)</a>:</h4>
<p>And made things two column so that the click-to-scroll actually makes sense</p>



<a name="526177515"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/526177515" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#526177515">(Jun 28 2025 at 05:00)</a>:</h4>
<p>Side note: <span class="user-mention" data-user-id="584248">@Kiryl Dziamura</span> I think I'm starting to agree with your suggestion to not have the js and css embedded as zig strings; I'll fix that soon.</p>



<a name="526178279"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/526178279" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#526178279">(Jun 28 2025 at 05:18)</a>:</h4>
<p><span class="user-mention silent" data-user-id="453336">Joshua Warner</span> <a href="#narrow/channel/395097-compiler-development/topic/casual.20conversation/near/526177425">said</a>:</p>
<blockquote>
<p>Already caught a few cases that look kinda fishy in terms of the token range we choose for various ast nodes</p>
</blockquote>
<p>Yeah, I've picked up on that in a few places when going through a snapshot and manually verifying the regions... but haven't circled back to investigate yet.</p>



<a name="526183320"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/526183320" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#526183320">(Jun 28 2025 at 06:43)</a>:</h4>
<p><span class="user-mention silent" data-user-id="577599">Norbert Hajagos</span> <a href="#narrow/stream/395097-compiler-development/topic/casual.20conversation/near/526105686">said</a>:</p>
<blockquote>
<p>Does anyone have something I can help with? Open for coding any area that is zig! Last time I made the txt -&gt; markdown conversion for our snapshots. I'm down to do something one step harder, or similar. Will be back later to read zulip.</p>
</blockquote>
<p>If no one else has an answer, can also fix fuzzer bugs, but I bet someone has solid work that could use a hand</p>



<a name="526187022"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/526187022" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Norbert Hajagos <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#526187022">(Jun 28 2025 at 07:55)</a>:</h4>
<p>Okay, I'll go with fixing fuzz errors. Will start with <br>
zig build repro-tokenize -- -b XzD/ -v<br>
which is this input:<br>
_0�</p>



<a name="526301021"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/526301021" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#526301021">(Jun 29 2025 at 23:26)</a>:</h4>
<p>I'm thinking we rename <code>When</code> to <code>Match</code> in Can to avoid confusion in future... if we agree I'll save it for a later PR that just does that one change.</p>



<a name="526493347"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/526493347" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Notification Bot <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#526493347">(Jun 30 2025 at 22:07)</a>:</h4>
<p>10 messages were moved from this topic to <a class="stream-topic" data-stream-id="395097" href="/#narrow/channel/395097-compiler-development/topic/single.20quote.20parsing/with/526492138">#compiler development &gt; single quote parsing</a> by <span class="user-mention silent" data-user-id="515757">Luke Boswell</span>.</p>



<a name="526519463"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/526519463" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#526519463">(Jul 01 2025 at 03:48)</a>:</h4>
<p>Looking into fancy-ing up the html snapshot generation for canonicalization now, and one of the slight snags I've run into is that can regions are defined in terms of byte offsets rather than token indices - was that an intentional choice? Thoughts on just using token indices?</p>



<a name="526519528"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/526519528" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#526519528">(Jul 01 2025 at 03:49)</a>:</h4>
<p>Tokens are a bit easier to work out highlighting for in the markup (versus arbitrary byte ranges)</p>



<a name="526519540"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/526519540" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#526519540">(Jul 01 2025 at 03:49)</a>:</h4>
<p>I don't think it matters much for the internal representation. We can still convert that back to line/col pairs right?</p>



<a name="526519560"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/526519560" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#526519560">(Jul 01 2025 at 03:50)</a>:</h4>
<p>Yep</p>



<a name="526519570"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/526519570" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#526519570">(Jul 01 2025 at 03:50)</a>:</h4>
<p>Is it still easy to slice the original source to get what we need?</p>



<a name="526519634"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/526519634" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#526519634">(Jul 01 2025 at 03:51)</a>:</h4>
<p>You need to keep around the list of token offsets (or be okay with recomputing it if needed)</p>



<a name="526519659"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/526519659" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#526519659">(Jul 01 2025 at 03:51)</a>:</h4>
<p>That is a slight disadvantage</p>



<a name="526519694"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/526519694" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#526519694">(Jul 01 2025 at 03:52)</a>:</h4>
<p>We're keeping around a list of line_start offsets already</p>



<a name="526519801"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/526519801" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#526519801">(Jul 01 2025 at 03:53)</a>:</h4>
<p>I think Richard has ideas to pull Region information out of the IR's entirely</p>



<a name="526519852"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/526519852" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#526519852">(Jul 01 2025 at 03:54)</a>:</h4>
<p>I was talking with him the other day about a hypothesis that the AST and CIR nodes can map 1-1 and therefore we could have region information in a side array and just use the AST/CIR node index to get the region information back out.</p>



<a name="526520270"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/526520270" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#526520270">(Jul 01 2025 at 04:00)</a>:</h4>
<p>That feels like a relevant design consideration. </p>
<p>Also we need the line/col information for s-expressions and reporting only -- so it would be ok to calculate those as needed. I'm assuming we wouldn't need to re-read the file, but using information like line_starts etc. </p>
<p>Removing region from IR's would have the advantage of not polluting our IR and keeping the nodes much smaller, hopefully reducing cache misses etc.</p>



<a name="526521180"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/526521180" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#526521180">(Jul 01 2025 at 04:09)</a>:</h4>
<p>FWIW I'd actually like to get line/col out of sexpr's</p>



<a name="526521240"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/526521240" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#526521240">(Jul 01 2025 at 04:10)</a>:</h4>
<p>Maybe I should just bite the bullet (byte the bullet?) and implement arbitrary byte range selection in the source view</p>



<a name="526521254"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/526521254" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#526521254">(Jul 01 2025 at 04:10)</a>:</h4>
<p>Not super clear how tho <img alt=":think-smart:" class="emoji" src="https://avatars.zulip.com/22008/emoji/images/c22f7861.png" title="think-smart"></p>



<a name="526521308"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/526521308" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#526521308">(Jul 01 2025 at 04:11)</a>:</h4>
<p><span class="user-mention silent" data-user-id="453336">Joshua Warner</span> <a href="#narrow/channel/395097-compiler-development/topic/casual.20conversation/near/526521180">said</a>:</p>
<blockquote>
<p>FWIW I'd actually like to get line/col out of sexpr's</p>
</blockquote>
<p>Why? I find it really easy to manually validate using the line/col information my editor shows.</p>



<a name="526521418"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/526521418" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#526521418">(Jul 01 2025 at 04:12)</a>:</h4>
<p>Gotta start using the fancy html version <span aria-label="stuck out tongue wink" class="emoji emoji-1f61c" role="img" title="stuck out tongue wink">:stuck_out_tongue_wink:</span></p>



<a name="526521466"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/526521466" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#526521466">(Jul 01 2025 at 04:13)</a>:</h4>
<p>Anyway, snark aside, I want to have the conversion to line:col to happen in once place (probably at the point we're rendering the sexpr), rather than at 100 different callsites in the ast/can/etc.</p>



<a name="526521485"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/526521485" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#526521485">(Jul 01 2025 at 04:14)</a>:</h4>
<p>I think it is already like that -- only calculated when generating the s-expressions</p>



<a name="526521503"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/526521503" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#526521503">(Jul 01 2025 at 04:14)</a>:</h4>
<p>So the in-memory sexpr will always be either token indices or byte offsets</p>



<a name="526521543"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/526521543" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#526521543">(Jul 01 2025 at 04:14)</a>:</h4>
<p>It's calculated when _generating_ the sexpr. I want to move it to being calculated when _rendering_ the sexpr</p>



<a name="526623157"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/526623157" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#526623157">(Jul 01 2025 at 14:35)</a>:</h4>
<p>The image file of the new compiler dependency graph is now to large to be hosted on github :(</p>



<a name="526624181"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/526624181" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#526624181">(Jul 01 2025 at 14:40)</a>:</h4>
<p>I'll see if webp fits</p>



<a name="526624403"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/526624403" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kiryl Dziamura <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#526624403">(Jul 01 2025 at 14:41)</a>:</h4>
<p>I know mermaid charts work well on gh, maybe it will fit well</p>



<a name="526624633"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/526624633" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kiryl Dziamura <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#526624633">(Jul 01 2025 at 14:42)</a>:</h4>
<p><a href="https://github.com/mermaid-js/mermaid">https://github.com/mermaid-js/mermaid</a><br>
scroll the readme down to see an example of md embedded diagrams</p>



<a name="526626038"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/526626038" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#526626038">(Jul 01 2025 at 14:49)</a>:</h4>
<p>webp worked :)</p>



<a name="526628075"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/526628075" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kiryl Dziamura <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#526628075">(Jul 01 2025 at 14:57)</a>:</h4>
<p>where I can see the graph btw?</p>



<a name="526634251"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/526634251" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#526634251">(Jul 01 2025 at 15:26)</a>:</h4>
<p><a href="https://github.com/Anton-4/roc-compiler-vis">https://github.com/Anton-4/roc-compiler-vis</a></p>



<a name="526896352"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/526896352" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#526896352">(Jul 03 2025 at 00:02)</a>:</h4>
<p>Is this valid syntax -- can we use <code>as</code> in any pattern? </p>
<div class="codehilite"><pre><span></span><code>match shape {
    Rectangle({ width, height }) as rect =&gt; ..
}
</code></pre></div>



<a name="526897196"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/526897196" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#526897196">(Jul 03 2025 at 00:13)</a>:</h4>
<p>We have <code>f64_literal</code> in CIR.Pattern... what is this used for, we aren't matching on an exact float literal are we? we don't have <code>eq</code> for floats.</p>



<a name="526897477"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/526897477" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#526897477">(Jul 03 2025 at 00:18)</a>:</h4>
<p><span class="user-mention silent" data-user-id="515757">Luke Boswell</span> <a href="#narrow/channel/395097-compiler-development/topic/casual.20conversation/near/526896352">said</a>:</p>
<blockquote>
<p>Is this valid syntax -- can we use <code>as</code> in any pattern? </p>
<p><div class="codehilite"><pre><span></span><code>match shape {
    Rectangle({ width, height }) as rect =&gt; ..
}
</code></pre></div><br>
</p>
</blockquote>
<p>ideally yes</p>



<a name="526897525"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/526897525" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#526897525">(Jul 03 2025 at 00:18)</a>:</h4>
<p>Are we keeping the default/optional value thing? <code>{ name, age ? 0 } =&gt; ...</code> -- I understand this is being removed as it was confusing</p>



<a name="526897899"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/526897899" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#526897899">(Jul 03 2025 at 00:24)</a>:</h4>
<p>nope that's gone</p>



<a name="526897910"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/526897910" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#526897910">(Jul 03 2025 at 00:24)</a>:</h4>
<p>static dispatch is replacing it</p>



<a name="527015391"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/527015391" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kiryl Dziamura <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#527015391">(Jul 03 2025 at 14:46)</a>:</h4>
<p>I noticed <code>build.zig.zon</code> requires <code>zig 0.14</code>, but nix installs <code>0.13</code>. <code>0.14</code> seems to be required only for the fuzzer</p>
<p>looks like <code>nixpkgs.url</code> is outdated</p>



<a name="527066677"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/527066677" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#527066677">(Jul 03 2025 at 20:12)</a>:</h4>
<p>Nix setup is still for the rust compiler</p>



<a name="527082908"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/527082908" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#527082908">(Jul 03 2025 at 22:43)</a>:</h4>
<p><span class="user-mention" data-user-id="361169">@Anton</span> -- could we look at making the default nix for our zig compiler, and use a flag or something to get the devshell for the rust compiler?</p>



<a name="527085393"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/527085393" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#527085393">(Jul 03 2025 at 23:15)</a>:</h4>
<p>Do we need nix? Isn't our only explicit dependency of that sort zig?</p>



<a name="527091722"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/527091722" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jared Ramirez <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#527091722">(Jul 04 2025 at 00:56)</a>:</h4>
<p>fwiw i do not use the devshell and just do <code>nix shell 'github:mitchellh/zig-overlay#"0.14.0"'</code></p>



<a name="527091854"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/527091854" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#527091854">(Jul 04 2025 at 00:58)</a>:</h4>
<p>That might be nice to add to our <code>BUILDING_FROM_SOURCE.md</code> or <code>CONTRIBUTING.md</code> docs.</p>



<a name="527093332"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/527093332" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#527093332">(Jul 04 2025 at 01:20)</a>:</h4>
<p>Also, I have no real issue with a nix shell, just for now:</p>
<ol>
<li>I want to make sure rust still works and is easy to use</li>
<li>I like the friction we have for dependencies. Nix lowers that friction some. If possible, I want us to remain zig only for core compiler flows.</li>
</ol>



<a name="527093431"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/527093431" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#527093431">(Jul 04 2025 at 01:22)</a>:</h4>
<p>Aside, now that we have check working would be good to instrument it all with Tracy and look at some more detailed traces. See how perf looks and such.</p>



<a name="527093972"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/527093972" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#527093972">(Jul 04 2025 at 01:29)</a>:</h4>
<p><span class="user-mention silent" data-user-id="343810">Brendan Hansknecht</span> <a href="#narrow/channel/395097-compiler-development/topic/casual.20conversation/near/527093431">said</a>:</p>
<blockquote>
<p>Aside, now that we have check working would be good to instrument it all with Tracy and look at some more detailed traces. See how perf looks and such.</p>
</blockquote>
<p>Would love to see that</p>



<a name="527117811"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/527117811" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#527117811">(Jul 04 2025 at 06:53)</a>:</h4>
<p>General question, what should the limit be for numbers of errors printed by something like roc check?</p>



<a name="527119278"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/527119278" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#527119278">(Jul 04 2025 at 07:04)</a>:</h4>
<p>It's not something we've talked about... Maybe in the hundreds? Is it different in the TTY or LSP use case?</p>



<a name="527120341"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/527120341" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#527120341">(Jul 04 2025 at 07:14)</a>:</h4>
<p>My million line of code file, which is just repeated code (and thus has tons of repeated declaration errors), essentially just prints forever.</p>



<a name="527120383"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/527120383" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#527120383">(Jul 04 2025 at 07:14)</a>:</h4>
<p>That's less than ideal.</p>



<a name="527120398"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/527120398" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#527120398">(Jul 04 2025 at 07:14)</a>:</h4>
<p>Made me realize that maybe it isn't the right UX. Also, due to the extract lines perf issue, hangs for a while before it finally starts printing.</p>



<a name="527126647"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/527126647" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kiryl Dziamura <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#527126647">(Jul 04 2025 at 07:58)</a>:</h4>
<p>Is aggregation an option? How many distinct diagnostic messages we would have? It might be a message and a list of <code>file:line:column</code> grouped by the same kind of error</p>



<a name="527151311"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/527151311" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#527151311">(Jul 04 2025 at 10:22)</a>:</h4>
<p><span class="user-mention silent" data-user-id="343810">Brendan Hansknecht</span> <a href="#narrow/channel/395097-compiler-development/topic/casual.20conversation/near/527093332">said</a>:</p>
<blockquote>
<p>Also, I have no real issue with a nix shell, just for now:</p>
<ol>
<li>I want to make sure rust still works and is easy to use</li>
<li>I like the friction we have for dependencies. Nix lowers that friction some. If possible, I want us to remain zig only for core compiler flows.</li>
</ol>
</blockquote>
<p>For the future it's great to be able to jump between commits and immediately get the correct zig version, so a nix flake would be nice. To keep friction for adding dependencies, we can set it up with <a href="https://docs.github.com/en/repositories/managing-your-repositorys-settings-and-features/customizing-your-repository/about-code-owners">github code owners</a> so that changes to flake.nix require approval from a specific person. What do you think <span class="user-mention" data-user-id="343810">@Brendan Hansknecht</span>?</p>



<a name="527197167"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/527197167" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#527197167">(Jul 04 2025 at 15:06)</a>:</h4>
<p><span class="user-mention silent" data-user-id="584248">Kiryl Dziamura</span> <a href="#narrow/channel/395097-compiler-development/topic/casual.20conversation/near/527126647">said</a>:</p>
<blockquote>
<p>Is aggregation an option? How many distinct diagnostic messages we would have? It might be a message and a list of <code>file:line:column</code> grouped by the same kind of error</p>
</blockquote>
<p>Quite possibly. Though in this case, it generated 3.6 million lines of output. Even aggregated I think we want to cut that off.</p>



<a name="527197311"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/527197311" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kiryl Dziamura <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#527197311">(Jul 04 2025 at 15:07)</a>:</h4>
<p><code>...and 3.6M more errors. Use --flag to output to a file</code> ?</p>



<a name="527197322"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/527197322" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#527197322">(Jul 04 2025 at 15:07)</a>:</h4>
<p><span class="user-mention silent" data-user-id="361169">Anton</span> <a href="#narrow/channel/395097-compiler-development/topic/casual.20conversation/near/527151311">said</a>:</p>
<blockquote>
<p>For the future it's great to be able to jump between commits and immediately get the correct zig version, so a nix flake would be nice. To keep friction for adding dependencies, we can set it up with <a href="https://docs.github.com/en/repositories/managing-your-repositorys-settings-and-features/customizing-your-repository/about-code-owners">github code owners</a> so that changes to flake.nix require approval from a specific person. What do you think <span class="user-mention silent" data-user-id="343810">Brendan Hansknecht</span>?</p>
</blockquote>
<p>That's fair for auto updating the zig version. And I think as long as we have the right culture it shouldn't matter too much, but I think it could be reasonable to set code owners for build.zig and flake.nix</p>



<a name="527208220"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/527208220" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#527208220">(Jul 04 2025 at 16:27)</a>:</h4>
<p>For my million line of code file. We spend:<br>
0.4s -&gt; tokenize + parse<br>
9.8s -&gt; canonicalize<br>
56s -&gt; generating diagnostic from can (this is after my fix that made this part way way faster)<br>
0.6s -&gt; checkDefs<br>
1.5s -&gt; generating diagnostics from check defs.</p>
<hr>
<p>haha.... generating diagnostics is definitely really slow right now. Though I guess that isn't much of problem if we limit the number of diagnostics.</p>



<a name="527208438"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/527208438" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#527208438">(Jul 04 2025 at 16:29)</a>:</h4>
<p>We generate ~395,000 diagnostics</p>



<a name="527212228"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/527212228" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#527212228">(Jul 04 2025 at 16:50)</a>:</h4>
<p>I'm sure we can make diagnostics faster haha</p>



<a name="527212272"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/527212272" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#527212272">(Jul 04 2025 at 16:50)</a>:</h4>
<p>and canonicalize too</p>



<a name="527212389"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/527212389" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#527212389">(Jul 04 2025 at 16:51)</a>:</h4>
<p>obviously canonicalization should not be taking 20x as long as type checking, since it has astronomically less work to do <span aria-label="joy" class="emoji emoji-1f602" role="img" title="joy">:joy:</span></p>



<a name="527212578"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/527212578" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#527212578">(Jul 04 2025 at 16:52)</a>:</h4>
<p>but this is really cool to know! any chance we could automate this so we can see the number change over time as we make changes? <span aria-label="smiley" class="emoji emoji-1f603" role="img" title="smiley">:smiley:</span></p>



<a name="527214302"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/527214302" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#527214302">(Jul 04 2025 at 17:06)</a>:</h4>
<p>I can quickly set up something basic with the raspberry pi 4 CI server, to minimize power consumption long term. Can you share the file somewhere <span class="user-mention" data-user-id="343810">@Brendan Hansknecht</span>?</p>



<a name="527215431"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/527215431" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#527215431">(Jul 04 2025 at 17:16)</a>:</h4>
<p>Yeah, I can later. At a 4th of July parade now</p>



<a name="527215625"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/527215625" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#527215625">(Jul 04 2025 at 17:18)</a>:</h4>
<p>Also, we may want to switch it out for something more representive I don't think many users will run files that generated nearly 400k diagnostics</p>



<a name="527217964"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/527217964" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#527217964">(Jul 04 2025 at 17:45)</a>:</h4>
<p>Agreed :)</p>



<a name="527217987"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/527217987" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#527217987">(Jul 04 2025 at 17:45)</a>:</h4>
<p><span class="user-mention silent" data-user-id="343810">Brendan Hansknecht</span> <a href="#narrow/channel/395097-compiler-development/topic/casual.20conversation/near/527215431">said</a>:</p>
<blockquote>
<p>Yeah, I can later. At a 4th of July parade now</p>
</blockquote>
<p>Enjoy <span aria-label="fireworks" class="emoji emoji-1f386" role="img" title="fireworks">:fireworks:</span></p>



<a name="527222141"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/527222141" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#527222141">(Jul 04 2025 at 18:33)</a>:</h4>
<p><span class="user-mention silent" data-user-id="343810">Brendan Hansknecht</span> <a href="#narrow/stream/395097-compiler-development/topic/casual.20conversation/near/527215625">said</a>:</p>
<blockquote>
<p>Also, we may want to switch it out for something more representive I don't think many users will run files that generated nearly 400k diagnostics</p>
</blockquote>
<p>still, it's a fun one to have in the mix for exactly that reason! if everything is broken, we don't want the compiler to lock up your machine <span aria-label="joy" class="emoji emoji-1f602" role="img" title="joy">:joy:</span></p>



<a name="527222294"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/527222294" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#527222294">(Jul 04 2025 at 18:36)</a>:</h4>
<p>For sure. For example, streaming diagnostics here would at least show the user that something is happening instead of simply having a crazy long delay.</p>



<a name="527223309"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/527223309" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#527223309">(Jul 04 2025 at 18:50)</a>:</h4>
<p>Oh, and we use way to much memory collecting all the diagnostics. <del>I think this uses about a gig making diagnostics asts (which are old school allocating per node asts)</del> More like 400MB for diagnostics.</p>



<a name="527223714"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/527223714" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#527223714">(Jul 04 2025 at 18:57)</a>:</h4>
<p>So I have two giant files that I have used. One based on a now quite old copy of our syntax grab bag and one based on List.roc. <br>
<a href="/user_uploads/22008/tch9zMAveDr75R7o27n4FJZF/New-List.roc">New-List.roc</a><br>
<a href="/user_uploads/22008/eH30v653_wOeel4DMS8hKXdu/new.roc">new.roc</a></p>



<a name="527223732"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/527223732" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#527223732">(Jul 04 2025 at 18:57)</a>:</h4>
<p>My numbers above were from <code>new.roc</code> which is from they syntax grab bag</p>



<a name="527223768"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/527223768" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#527223768">(Jul 04 2025 at 18:57)</a>:</h4>
<p>Also, I guess we should add some form of the <code>--time</code> flag that counts time in each stage of the compiler and reports on it.</p>



<a name="527224255"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/527224255" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#527224255">(Jul 04 2025 at 19:04)</a>:</h4>
<p>For the list file (which if I recall is 1 million lines of code, but 1.6 million lines including comments), the breakdown is:<br>
0.9s -&gt; tokenize + parse<br>
75s -&gt; canonicalize<br>
60s -&gt; generating diagnostic from can (this is after my fix that made this part way way faster)<br>
2.7s -&gt; checkDefs<br>
0.01s -&gt; generating diagnostics from check defs.</p>
<p>900MB used to parse<br>
400MB added by can<br>
250MB added by diagnostics</p>



<a name="527224557"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/527224557" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#527224557">(Jul 04 2025 at 19:08)</a>:</h4>
<p>Of note, input source is 53MB. So roughly a 25:1 ratio from memory usage after can to original source memory size.</p>



<a name="527225329"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/527225329" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#527225329">(Jul 04 2025 at 19:19)</a>:</h4>
<p>added by can includes types I guess?</p>



<a name="527225658"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/527225658" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#527225658">(Jul 04 2025 at 19:23)</a>:</h4>
<p>I assume it is everything in CIR?</p>



<a name="527228657"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/527228657" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#527228657">(Jul 04 2025 at 20:17)</a>:</h4>
<p>Oh boy...we added in <code>usingnamespace</code> at some point</p>



<a name="527228671"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/527228671" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#527228671">(Jul 04 2025 at 20:17)</a>:</h4>
<p>That breaks incremental compilation</p>



<a name="527228745"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/527228745" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kiryl Dziamura <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#527228745">(Jul 04 2025 at 20:19)</a>:</h4>
<p>Breaking changes in zig writers<br>
<a href="https://github.com/ziglang/zig/pull/24329">https://github.com/ziglang/zig/pull/24329</a></p>



<a name="527228793"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/527228793" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#527228793">(Jul 04 2025 at 20:20)</a>:</h4>
<p>0.15.0 will be fun to migrate to</p>



<a name="527233471"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/527233471" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#527233471">(Jul 04 2025 at 21:37)</a>:</h4>
<p>Hmm....zls doesn't seem to work for me on macos anymore. I don't know what went wrong, but it always hits:</p>
<div class="codehilite"><pre><span></span><code>/Users/bren077s/vendor/zig-0.14.0/lib/std/posix.zig:4533:22: 0x102497013 in kevent (build)
            .BADF =&gt; unreachable, // Always a race condition.
</code></pre></div>
<p>This theoretically comes from the <code>--watch</code> flag, but I am not setting the <code>--watch</code> flag in zls.</p>



<a name="527233494"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/527233494" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#527233494">(Jul 04 2025 at 21:38)</a>:</h4>
<p>Does zls work for others on macos?</p>



<a name="527235130"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/527235130" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#527235130">(Jul 04 2025 at 22:10)</a>:</h4>
<p>It's  working for me, but I built from source a long time ago and haven't updated it since. I'm not sure if the 0.14.0 branch in zls repo gets updates</p>



<a name="527235194"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/527235194" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#527235194">(Jul 04 2025 at 22:11)</a>:</h4>
<p>Yeah, I haven't built it from source in a long time and I thought it was working last time I was working on roc, but I guess not anymore.</p>



<a name="527235203"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/527235203" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#527235203">(Jul 04 2025 at 22:11)</a>:</h4>
<p>What is your zls config?</p>



<a name="527236211"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/527236211" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#527236211">(Jul 04 2025 at 22:32)</a>:</h4>
<p>Also, I guess to clarify. I think the main issue is with diagnostics. I'm not getting build errors in roc currently.</p>



<a name="527236224"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/527236224" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#527236224">(Jul 04 2025 at 22:32)</a>:</h4>
<p>I can still go to defintion and what not.</p>



<a name="527264114"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/527264114" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#527264114">(Jul 05 2025 at 08:26)</a>:</h4>
<p>I just noticed this and thought I'd double check </p>
<div class="codehilite"><pre><span></span><code>**UNEXPECTED TOKEN IN EXPRESSION**
The token **crash &quot;** is not expected in an expression.
</code></pre></div>
<p><code>crash</code> is supported as both a statement and as an expression right?</p>



<a name="527275143"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/527275143" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#527275143">(Jul 05 2025 at 12:03)</a>:</h4>
<p>ideally should be! <span aria-label="+1" class="emoji emoji-1f44d" role="img" title="+1">:+1:</span></p>



<a name="527375364"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/527375364" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jared Ramirez <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#527375364">(Jul 06 2025 at 21:49)</a>:</h4>
<p>What do y'all think about the fact that <code>CIR</code> owns <code>ModuleEnv</code>? Having used it for a while it feels a little off, and I've been thinking like having <code>ModuleEnv</code> be a sibling of the IRs might make sense. Then, each stage could just have a pointer to it, plus the a pointer to last stage's IR and this stage's.  </p>
<p>So <code>canonicalize</code> would become:</p>
<div class="codehilite" data-code-language="Zig"><pre><span></span><code><span class="n">module_env</span><span class="o">:</span><span class="w"> </span><span class="o">*</span><span class="n">ModuleEnv</span>
<span class="n">can_ir</span><span class="o">:</span><span class="w"> </span><span class="o">*</span><span class="n">CIR</span><span class="p">,</span><span class="w"> </span><span class="c1">// already there</span>
<span class="n">parse_ir</span><span class="o">:</span><span class="w"> </span><span class="o">*</span><span class="n">AST</span><span class="p">,</span><span class="w"> </span><span class="c1">// already there</span>
</code></pre></div>
<p>Then <code>check_types</code> would become:</p>
<div class="codehilite" data-code-language="Zig"><pre><span></span><code><span class="n">module_env</span><span class="o">:</span><span class="w"> </span><span class="o">*</span><span class="n">ModuleEnv</span>
<span class="n">can_ir</span><span class="o">:</span><span class="w"> </span><span class="o">*</span><span class="n">CIR</span><span class="p">,</span><span class="w"> </span><span class="c1">// already there</span>
</code></pre></div>



<a name="527375797"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/527375797" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#527375797">(Jul 06 2025 at 21:59)</a>:</h4>
<p>CIR doesn't own the memory anymore. I had to change that to a pointer to avoid some hairy lifetime issues.</p>



<a name="527375904"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/527375904" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#527375904">(Jul 06 2025 at 22:01)</a>:</h4>
<p>I don't see any reason check_types can't hold a reference to the module env also</p>



<a name="527375941"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/527375941" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jared Ramirez <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#527375941">(Jul 06 2025 at 22:01)</a>:</h4>
<p>Oh cool! Didn't realize that. Yeah definitely!</p>



<a name="527377784"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/527377784" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#527377784">(Jul 06 2025 at 22:39)</a>:</h4>
<p>why do they need it at all?</p>



<a name="527377809"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/527377809" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#527377809">(Jul 06 2025 at 22:40)</a>:</h4>
<p>couldn't we pass in exactly the parts they need, e.g. the IR from the previous stage and <code>gpa</code>?</p>



<a name="527377851"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/527377851" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#527377851">(Jul 06 2025 at 22:41)</a>:</h4>
<p>Ident store, StringLiteral store for generating problem reports I think</p>



<a name="527378137"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/527378137" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#527378137">(Jul 06 2025 at 22:48)</a>:</h4>
<p>interesting, I think we could pass in <code>const*</code> pointers to those two after tokenization</p>



<a name="527378158"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/527378158" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#527378158">(Jul 06 2025 at 22:49)</a>:</h4>
<p>basically formalize which parts of our process should make changes to which parts of the module env</p>



<a name="527596421"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/527596421" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#527596421">(Jul 08 2025 at 03:06)</a>:</h4>
<p>Is this correct or are we wanting to require parens for these?</p>
<div class="codehilite"><pre><span></span><code>dbg x
crash &quot;msg&quot;
expect 1 == 1
return x
</code></pre></div>



<a name="527596485"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/527596485" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#527596485">(Jul 08 2025 at 03:07)</a>:</h4>
<p>I'm quite sure this is correct, that's how Anthony has it parsing by the look of things... so I'm going to proceed.</p>



<a name="527598373"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/527598373" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#527598373">(Jul 08 2025 at 03:37)</a>:</h4>
<p>I have a (more) data-oriented-design version of sexpr that I've been working on. It's not a complete slam dunk, but currently ~30% faster than the existing sexpr: <a href="https://github.com/roc-lang/roc/pull/7965">https://github.com/roc-lang/roc/pull/7965</a>.<br>
Usage is a bit more verbose, but hopefully not too bad. There's still some significant headroom for optimization.<br>
Would be curious on folks' thoughts.</p>



<a name="527602030"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/527602030" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#527602030">(Jul 08 2025 at 04:27)</a>:</h4>
<p>We require parens for return?</p>



<a name="527602053"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/527602053" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#527602053">(Jul 08 2025 at 04:28)</a>:</h4>
<p>And dod sexpr sound like a nice idea now that we are scaling up snapshots so much</p>



<a name="527602080"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/527602080" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#527602080">(Jul 08 2025 at 04:28)</a>:</h4>
<p>Originally it was avoided cause they aren't really play of the compiler and are reasonable to keep super simple</p>



<a name="527603901"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/527603901" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#527603901">(Jul 08 2025 at 04:52)</a>:</h4>
<blockquote>
<p>did sexpr sound like a nice idea</p>
</blockquote>
<p>I'm not sure what your asking here. </p>
<p>I think the SExpr's have been invaluable for validating behaviour, particularly between the stages TOKEN -&gt; PARSE -&gt; CAN -&gt; TYPES etc</p>



<a name="527605328"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/527605328" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#527605328">(Jul 08 2025 at 05:11)</a>:</h4>
<p>Is the question, should we have chosen another format/syntax rather than sexpr?</p>



<a name="527605500"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/527605500" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#527605500">(Jul 08 2025 at 05:14)</a>:</h4>
<p><span class="user-mention silent" data-user-id="343810">Brendan Hansknecht</span> <a href="#narrow/channel/395097-compiler-development/topic/casual.20conversation/near/527602030">said</a>:</p>
<blockquote>
<p>We require parens for return?</p>
</blockquote>
<p>The alternative I had in mind was a more PNC version of these... </p>
<div class="codehilite"><pre><span></span><code>dbg(x)
crash(&quot;msg&quot;)
expect(1 == 1)
return(x)
</code></pre></div>



<a name="527605807"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/527605807" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#527605807">(Jul 08 2025 at 05:18)</a>:</h4>
<p>Does this look like a valid use of the <code>return</code> keyword?</p>
<div class="codehilite"><pre><span></span><code>foo : U64 -&gt; Result(Str, [TooBig])
foo = |num| {
    str = if (num &gt; 10) {
        return Err(TooBig)
    } else {
        &quot;SMALL&quot;
    }
    Ok(str)
}
</code></pre></div>



<a name="527606197"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/527606197" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#527606197">(Jul 08 2025 at 05:24)</a>:</h4>
<p>And for <code>dbg</code></p>
<div class="codehilite"><pre><span></span><code>foo = |num| {
    # statement - prints out the value of num converted to a string
    dbg num.to_str()

    # expression - prints out the value of num and then returns it
    dbg(num)
}
</code></pre></div>



<a name="527606294"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/527606294" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#527606294">(Jul 08 2025 at 05:25)</a>:</h4>
<blockquote>
<p>I'm not sure what your asking here.</p>
</blockquote>
<p>Update my comment. Was just saying that DOD sexprs sound like a reasonable idea.</p>



<a name="527606394"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/527606394" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#527606394">(Jul 08 2025 at 05:27)</a>:</h4>
<blockquote>
<p>Is this correct or are we wanting to require parens for these?</p>
</blockquote>
<p>I just realized I parsed this wrong... Read it as:</p>
<blockquote>
<p>Is this correct? are we wanting to require parens for these?</p>
</blockquote>



<a name="527663528"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/527663528" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#527663528">(Jul 08 2025 at 11:27)</a>:</h4>
<p><span class="user-mention silent" data-user-id="343810">Brendan Hansknecht</span> <a href="#narrow/channel/395097-compiler-development/topic/casual.20conversation/near/527223714">said</a>:</p>
<blockquote>
<p>So I have two giant files that I have used. One based on a now quite old copy of our syntax grab bag and one based on List.roc. <br>
<a href="/user_uploads/22008/tch9zMAveDr75R7o27n4FJZF/New-List.roc">New-List.roc</a><br>
<a href="/user_uploads/22008/eH30v653_wOeel4DMS8hKXdu/new.roc">new.roc</a></p>
</blockquote>
<p>If I run <code>roc check New-List.roc</code> it kills my terminal after a while :p</p>



<a name="527667124"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/527667124" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#527667124">(Jul 08 2025 at 11:47)</a>:</h4>
<p>The fuzzer can find some really interesting bugs <code>{ i, Complete]</code> ... who would think of that!</p>



<a name="527670164"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/527670164" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#527670164">(Jul 08 2025 at 12:02)</a>:</h4>
<p>Ah, man... we really need to give the Parser NodeStore the same love we just did for the Can NodeStore and add a bunch of roundtrip unit tests. I've found a few hard to track down issues now stemming from us putting something in or getting something out that is different than we expect. </p>
<p><span class="user-mention" data-user-id="781658">@Anthony Bullard</span> -- After your refactor I'm happy to make this change. It was a bit mechanical but I got a pretty quick process down to implement it.</p>



<a name="527705478"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/527705478" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#527705478">(Jul 08 2025 at 14:31)</a>:</h4>
<p>In comments especially, I think we regularly use just "variable" when we're talking about a "type variable". Let's try to always use "type variable" to avoid confusion with a variable as in <code>var x = 0</code>.</p>



<a name="527777185"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/527777185" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#527777185">(Jul 08 2025 at 21:52)</a>:</h4>
<p>After sleeping on it, I realised adding unit tests roundtripping the AST NodeStore might actually help <span class="user-mention" data-user-id="781658">@Anthony Bullard</span> with the refactor. That scope of work is internal representation right?</p>



<a name="527851500"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/527851500" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kiryl Dziamura <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#527851500">(Jul 09 2025 at 10:00)</a>:</h4>
<p><a class="message-link" href="/#narrow/channel/231634-beginners/topic/Question.20from.20GH.20-.20Mutation.20in.20Roc/near/527844302">#beginners &gt; Question from GH - Mutation in Roc @ 💬</a> </p>
<p>I just realized that if nominal type encapsulates a list and its size never changes (e.g. <code>Matrix</code> or <code>Vector</code> types), it can be allocated and managed as a static array behind the scenes.<br>
Am I naive?</p>



<a name="527866530"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/527866530" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#527866530">(Jul 09 2025 at 11:26)</a>:</h4>
<p>I think it makes more sense to use tuples for that use case</p>



<a name="527866595"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/527866595" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#527866595">(Jul 09 2025 at 11:27)</a>:</h4>
<p>we don't track list length in the type system, but we do track tuple length</p>



<a name="527866951"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/527866951" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#527866951">(Jul 09 2025 at 11:29)</a>:</h4>
<p>also we can't offer a way to get list elements that doesn't return a Result, even if it's fixed-length and we know it can't fail</p>



<a name="527867106"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/527867106" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#527867106">(Jul 09 2025 at 11:30)</a>:</h4>
<p>whereas with tuples we do track length in the type system, they're already stack-allocated, we can already get their elements without Result, and with static dispatch we can automatically add <code>.iter()</code> and <code>.len()</code> to any tuple whose elements are all type-compatible</p>



<a name="527867366"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/527867366" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kiryl Dziamura <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#527867366">(Jul 09 2025 at 11:31)</a>:</h4>
<p>Yes, but what about MxN matrices?</p>



<a name="527867426"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/527867426" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#527867426">(Jul 09 2025 at 11:32)</a>:</h4>
<p>You can have an MxN sized tuple</p>



<a name="527867447"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/527867447" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#527867447">(Jul 09 2025 at 11:32)</a>:</h4>
<p>The tuple is just the backing storage.</p>



<a name="527867494"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/527867494" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#527867494">(Jul 09 2025 at 11:32)</a>:</h4>
<p>You would make helpers to help with using it</p>



<a name="527867507"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/527867507" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kiryl Dziamura <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#527867507">(Jul 09 2025 at 11:32)</a>:</h4>
<p>No warnings about tuple size?</p>



<a name="527867602"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/527867602" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#527867602">(Jul 09 2025 at 11:33)</a>:</h4>
<p>Shouldn't be a problem. I can imagine tools might code-gen larger tuples for MxN sizes someday</p>



<a name="527867617"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/527867617" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kiryl Dziamura <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#527867617">(Jul 09 2025 at 11:33)</a>:</h4>
<p>Like, "too many elements, you probably want struct"</p>



<a name="527873063"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/527873063" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#527873063">(Jul 09 2025 at 12:03)</a>:</h4>
<p>nah I don't think we should have warnings about tuple size</p>



<a name="527926004"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/527926004" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#527926004">(Jul 09 2025 at 16:31)</a>:</h4>
<p>I discovered last night that just switching the allocator in the snapshot generator can make the snapshot tests ~6x faster - from ~1400ms to 229ms.</p>
<div class="codehilite"><pre><span></span><code>joshw@Joshuas-MacBook-Air-3 ~/s/g/r/roc (main)&gt; zig build snapshot
info: processed 412 snapshots in 229 ms.
joshw@Joshuas-MacBook-Air-3 ~/s/g/r/roc (main)&gt; git diff
diff --git a/src/snapshot.zig b/src/snapshot.zig
index baa63fc905..6d0cf05212 100644
--- a/src/snapshot.zig
+++ b/src/snapshot.zig
@@ -96,7 +96,7 @@ pub fn main() !void {
     defer {
         _ = gpa_impl.deinit();
     }
-    const gpa = gpa_impl.allocator();
+    const gpa = std.heap.c_allocator;

     const args = try std.process.argsAlloc(gpa);
     defer std.process.argsFree(gpa, args);
</code></pre></div>
<p>Do we get anything from the GeneralPurposeAllocator (aka DebugAllocator, apparently), that's worth this 6x perf cost?</p>



<a name="527926562"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/527926562" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#527926562">(Jul 09 2025 at 16:34)</a>:</h4>
<p>gpa isn't really helpful here i think</p>



<a name="527926656"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/527926656" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#527926656">(Jul 09 2025 at 16:34)</a>:</h4>
<p>We could use the DebugAllocator for debugging only after valgrind finds something. But I'm not sure valgrind catches everything the DebugAllocator would.</p>



<a name="527927295"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/527927295" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#527927295">(Jul 09 2025 at 16:38)</a>:</h4>
<p>Would that be a compile time flag or a command line flag?</p>



<a name="527927384"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/527927384" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#527927384">(Jul 09 2025 at 16:39)</a>:</h4>
<p>I would think that would be a command line flag</p>



<a name="527927468"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/527927468" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#527927468">(Jul 09 2025 at 16:39)</a>:</h4>
<p>Unless we want to add a debug build for snapshots</p>



<a name="527927511"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/527927511" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#527927511">(Jul 09 2025 at 16:40)</a>:</h4>
<p>it probably wouldn't make much of a difference given how the tool is typically used</p>



<a name="527930757"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/527930757" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#527930757">(Jul 09 2025 at 16:58)</a>:</h4>
<p><a href="https://github.com/roc-lang/roc/pull/7983">https://github.com/roc-lang/roc/pull/7983</a></p>



<a name="527942037"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/527942037" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#527942037">(Jul 09 2025 at 18:15)</a>:</h4>
<p>it would be nice to use the testing allocator for snapshot generation on ci - that one is slower but it also detects memory leaks</p>



<a name="527942108"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/527942108" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#527942108">(Jul 09 2025 at 18:15)</a>:</h4>
<p>Yep yep, that's exactly what that PR does!</p>



<a name="527947049"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/527947049" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#527947049">(Jul 09 2025 at 18:47)</a>:</h4>
<p>With the c allocator and some simple multithreading, getting good numbers with html snapshot generation again:</p>
<div class="codehilite"><pre><span></span><code>$ zig build snapshot
info: collected 412 items in 1 ms, processed 412 snapshots in 50 ms.
$ zig build snapshot -- --html
info: collected 412 items in 1 ms, processed 412 snapshots in 167 ms.
</code></pre></div>



<a name="527947069"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/527947069" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#527947069">(Jul 09 2025 at 18:47)</a>:</h4>
<p>Thinking about turning that (back) on by default</p>



<a name="527947471"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/527947471" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#527947471">(Jul 09 2025 at 18:50)</a>:</h4>
<p>For comparison / completeness:</p>
<div class="codehilite"><pre><span></span><code>$ zig build snapshot -- --singlethread
info: collected 412 items in 1 ms, processed 412 snapshots in 196 ms.
$ zig build snapshot -- --singlethread --html
info: collected 412 items in 1 ms, processed 412 snapshots in 396 ms.
</code></pre></div>



<a name="527947514"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/527947514" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#527947514">(Jul 09 2025 at 18:50)</a>:</h4>
<p>So I'd say even without multithreading, html perf is acceptable</p>



<a name="527956372"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/527956372" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#527956372">(Jul 09 2025 at 19:57)</a>:</h4>
<p>Instead of the c allocator probably use the new zig allocator that is fast</p>



<a name="527956384"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/527956384" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#527956384">(Jul 09 2025 at 19:58)</a>:</h4>
<p>Gpa is the debug allocator</p>



<a name="527956597"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/527956597" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#527956597">(Jul 09 2025 at 19:59)</a>:</h4>
<p>Oh hmm...actually we use the c allocator in roc main, so I guess that is our default allocator currently</p>



<a name="527978403"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/527978403" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#527978403">(Jul 09 2025 at 23:10)</a>:</h4>
<p><a href="https://github.com/roc-lang/roc/pull/7987">https://github.com/roc-lang/roc/pull/7987</a><br>
(FWIW, I'm not super tied to this one if y'all think the complexity of multithreading is not worth it!)</p>



<a name="527979578"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/527979578" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#527979578">(Jul 09 2025 at 23:26)</a>:</h4>
<p>Oh cool, I'm keen to take a look in a bit</p>



<a name="528183851"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/528183851" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#528183851">(Jul 11 2025 at 01:50)</a>:</h4>
<p>Random side note - in the future I think it'll be really useful/helpful to minimize fuzz crashes at least a bit before checking them in</p>



<a name="528187793"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/528187793" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#528187793">(Jul 11 2025 at 02:49)</a>:</h4>
<p>We do</p>



<a name="528187820"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/528187820" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#528187820">(Jul 11 2025 at 02:50)</a>:</h4>
<p>Or I mean the fuzzer does. I guess a human might do better</p>



<a name="528187841"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/528187841" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#528187841">(Jul 11 2025 at 02:50)</a>:</h4>
<p>Not sure which part specifically you are calling out. snapshots of fuzz tests or what appears on the website.</p>



<a name="528187880"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/528187880" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#528187880">(Jul 11 2025 at 02:51)</a>:</h4>
<p>I have added quite a few snapshots <code>fuzz_crash</code> that I hadn't minimised. I'm not sure how we minimise them...</p>



<a name="528187900"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/528187900" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#528187900">(Jul 11 2025 at 02:51)</a>:</h4>
<p>afl-tmin</p>



<a name="528187928"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/528187928" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#528187928">(Jul 11 2025 at 02:52)</a>:</h4>
<p>Does that work on Mac?</p>



<a name="528187958"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/528187958" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#528187958">(Jul 11 2025 at 02:52)</a>:</h4>
<p>I don't think so</p>



<a name="528187985"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/528187985" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#528187985">(Jul 11 2025 at 02:52)</a>:</h4>
<p>I think they have afl-tmin.bash instead and it is missing features and so still doesn't work for our executables on mac</p>



<a name="528188000"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/528188000" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#528188000">(Jul 11 2025 at 02:53)</a>:</h4>
<p>I need to setup my linux machine... to support this and valgrind</p>



<a name="528188026"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/528188026" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#528188026">(Jul 11 2025 at 02:53)</a>:</h4>
<p>It's still sitting in a box. It doesn't have a wifi card installed and the router is up the other end of the house <span aria-label="sad" class="emoji emoji-2639" role="img" title="sad">:sad:</span></p>



<a name="528188047"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/528188047" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#528188047">(Jul 11 2025 at 02:54)</a>:</h4>
<p>Or maybe I can use a Digital Ocean droplet or something</p>



<a name="528188057"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/528188057" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#528188057">(Jul 11 2025 at 02:54)</a>:</h4>
<p>Would be nice to have a toolchain that supports Mac well</p>



<a name="528188094"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/528188094" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#528188094">(Jul 11 2025 at 02:55)</a>:</h4>
<p>Zig will have a builtin fuzzer soon <img alt=":pika-high-five:" class="emoji" src="https://avatars.zulip.com/22008/emoji/images/e8c51094.gif" title="pika-high-five"></p>



<a name="528188101"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/528188101" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#528188101">(Jul 11 2025 at 02:55)</a>:</h4>
<p>Also FWIW minimization is not a super hard algorithm. I have a version of it written up for the old compiler that we can easily port</p>



<a name="528188142"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/528188142" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#528188142">(Jul 11 2025 at 02:55)</a>:</h4>
<p>I'm more hyped about that than async ... am I crazy?</p>



<a name="528188205"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/528188205" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#528188205">(Jul 11 2025 at 02:57)</a>:</h4>
<p>I’d say the same!</p>



<a name="528189352"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/528189352" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#528189352">(Jul 11 2025 at 03:15)</a>:</h4>
<p>I hyped about it but super worried about the long tail of work.</p>



<a name="528189365"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/528189365" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#528189365">(Jul 11 2025 at 03:15)</a>:</h4>
<p>working is one thing. robust is another.</p>



<a name="528189447"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/528189447" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#528189447">(Jul 11 2025 at 03:16)</a>:</h4>
<p>Also, yeah, minimization is pretty simple in most systems. I think the main the afl-tmin does is delete various block sizes and test if it still repros. So like test deleting every 256 byte chunk one at a time and if any can be deleted with repro, remove it. Then try 128 then 64 then 32 then ... and see how small the repro gets.</p>



<a name="528189861"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/528189861" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#528189861">(Jul 11 2025 at 03:23)</a>:</h4>
<p><a href="https://www.perplexity.ai/search/explain-the-algorithm-of-afl-t-mweVuib0QsqF4vFI0axkMA">https://www.perplexity.ai/search/explain-the-algorithm-of-afl-t-mweVuib0QsqF4vFI0axkMA</a></p>



<a name="528382934"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/528382934" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#528382934">(Jul 11 2025 at 17:42)</a>:</h4>
<p>I'm debugging a segfault and I'd like to add some logging to print all the intermediate outputs. Just like the snapshots but live (as soon as the phase is done) , do you have any pointers before I start on this <span class="user-mention" data-user-id="515757">@Luke Boswell</span>?</p>



<a name="528383889"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/528383889" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#528383889">(Jul 11 2025 at 17:49)</a>:</h4>
<p>What's been working well for me is asking an LLM to isolate the bug using print debug statements. Basically tell it to drill down starting from this point and iterate. It usually find the bug very quickly, and gives me a nice summary of why it's occuring. </p>
<p>Maybe it's a bit lazy but it's been pretty quick and easy so far.</p>



<a name="528384072"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/528384072" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#528384072">(Jul 11 2025 at 17:51)</a>:</h4>
<p>Or are you thinking of a more permanent logging setup?</p>



<a name="528384109"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/528384109" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#528384109">(Jul 11 2025 at 17:51)</a>:</h4>
<p><span class="user-mention silent" data-user-id="515757">Luke Boswell</span> <a href="#narrow/channel/395097-compiler-development/topic/casual.20conversation/near/528384072">said</a>:</p>
<blockquote>
<p>Or are you thinking of a more permanent logging setup?</p>
</blockquote>
<p>Yes, exactly, it's something we should have regardless</p>



<a name="528384515"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/528384515" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#528384515">(Jul 11 2025 at 17:54)</a>:</h4>
<p>I've got ideas, but I'd put them in the experimental category. It's not something I have a lot of experience with.</p>



<a name="528384840"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/528384840" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#528384840">(Jul 11 2025 at 17:57)</a>:</h4>
<p>I mainly want to know if you think it's a good idea to re-use code from snapshot.zig or modify snapshot.zig to share code with the logging etc.</p>



<a name="528384911"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/528384911" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#528384911">(Jul 11 2025 at 17:57)</a>:</h4>
<p>I just watched a LamdbaConf video on Jai recently and he had some really nice debugging stuff for his compiler. Has put a lot of thought into how that is done. </p>
<p>I think we could definitely do some similar things. </p>
<p>In case your looking for ideas.</p>



<a name="528385059"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/528385059" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#528385059">(Jul 11 2025 at 17:58)</a>:</h4>
<p><span class="user-mention silent" data-user-id="361169">Anton</span> <a href="#narrow/channel/395097-compiler-development/topic/casual.20conversation/near/528384840">said</a>:</p>
<blockquote>
<p>I mainly want to know if you think it's a good idea to re-use code from snapshot.zig or modify snapshot.zig to share code with the logging etc.</p>
</blockquote>
<p>I think we should try and see how it feels.</p>



<a name="528404275"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/528404275" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jared Ramirez <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#528404275">(Jul 11 2025 at 20:48)</a>:</h4>
<p>does anyone else run into frequent crashes with passing <code>--watch</code> to <code>zig build &lt;cmd&gt;</code>?</p>



<a name="528404303"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/528404303" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#528404303">(Jul 11 2025 at 20:48)</a>:</h4>
<p>all the time</p>



<a name="528404317"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/528404317" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#528404317">(Jul 11 2025 at 20:48)</a>:</h4>
<p>especially if you have an error on the initial run</p>



<a name="528404337"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/528404337" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#528404337">(Jul 11 2025 at 20:48)</a>:</h4>
<p>i hope 14.1 or 15 fixes that</p>



<a name="528404466"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/528404466" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jared Ramirez <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#528404466">(Jul 11 2025 at 20:50)</a>:</h4>
<p>Yeah, I've been using <a href="https://github.com/watchexec/watchexec?tab=readme-ov-file"><code>watchexec</code></a> as a work around. Does anyone object to me adding that as a dep in <code>src/flake.nix</code>? (At least until we see if 14.1 or 15 fixes it)</p>



<a name="528405562"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/528405562" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#528405562">(Jul 11 2025 at 20:59)</a>:</h4>
<p><span class="user-mention" data-user-id="406911">@Andrew Kelley</span> would know if 14.1 or 15 has relevant changes there <span aria-label="smile" class="emoji emoji-1f604" role="img" title="smile">:smile:</span></p>



<a name="528409742"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/528409742" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#528409742">(Jul 11 2025 at 21:39)</a>:</h4>
<p>We already use 14.1 (at least in nix and ci, locally, you may still be running 14.0)</p>



<a name="528409781"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/528409781" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#528409781">(Jul 11 2025 at 21:39)</a>:</h4>
<p>And at least for Mac I think watch is still broken on main for zig</p>



<a name="528427949"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/528427949" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#528427949">(Jul 12 2025 at 03:11)</a>:</h4>
<p>What's the latest on the <code>foo.(local_func)(args)</code> calling style? Is that supposed to be parsed in the new compiler?</p>



<a name="528428557"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/528428557" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#528428557">(Jul 12 2025 at 03:27)</a>:</h4>
<p>we ended up settling on <code>foo-&gt;local_func</code> as the syntax and referring to them as "arrow calls" but I forget what their implementation status is in the new compiler</p>



<a name="528428693"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/528428693" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#528428693">(Jul 12 2025 at 03:31)</a>:</h4>
<p>Currently going thru my migration script to update my benchmarking corpus and ran into the <code>.(local_func)</code> syntax</p>



<a name="528428710"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/528428710" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#528428710">(Jul 12 2025 at 03:31)</a>:</h4>
<p>Turns out <code>-&gt;local_func</code> isn't implemented currently either</p>



<a name="528429268"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/528429268" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#528429268">(Jul 12 2025 at 03:43)</a>:</h4>
<p>of nore, the syntax <code>MyNominalType.(payload)</code> is planned to be a thing</p>



<a name="528429291"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/528429291" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#528429291">(Jul 12 2025 at 03:44)</a>:</h4>
<p>that works similarly to today's <code>@MyOpaqueType payload</code></p>



<a name="528444731"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/528444731" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#528444731">(Jul 12 2025 at 09:13)</a>:</h4>
<p><span class="user-mention silent" data-user-id="341568">Jared Ramirez</span> <a href="#narrow/channel/395097-compiler-development/topic/casual.20conversation/near/528404466">said</a>:</p>
<blockquote>
<p>Yeah, I've been using <a href="https://github.com/watchexec/watchexec?tab=readme-ov-file"><code>watchexec</code></a> as a work around. Does anyone object to me adding that as a dep in <code>src/flake.nix</code>? (At least until we see if 14.1 or 15 fixes it)</p>
</blockquote>
<p>Seems fine, maybe put it in a separate devDependencies like we do in the old flake <a href="https://github.com/roc-lang/roc/blob/d8fe19ad0032ed31718c3621cb5affde2179a5b3/flake.nix#L121">here</a>.</p>



<a name="528462392"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/528462392" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#528462392">(Jul 12 2025 at 14:26)</a>:</h4>
<p><span class="user-mention silent" data-user-id="515757">Luke Boswell</span> <a href="#narrow/channel/395097-compiler-development/topic/casual.20conversation/near/528384911">said</a>:</p>
<blockquote>
<p>I just watched a LamdbaConf video on Jai recently and he had some really nice debugging stuff for his compiler</p>
</blockquote>
<p>Seeing all the visualizations made me think; it would be nice to have anomaly detection set up for the snapshots, like in CI it would alert us if some metric for a Roc program is 100x higher than the average for all snapshots. I don't know if we should actually do that but it's a cool idea :p</p>



<a name="528466954"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/528466954" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#528466954">(Jul 12 2025 at 15:39)</a>:</h4>
<p>Is <code>import Foo.Bar</code> supposed to work? The new compiler doesn't parse that currently.</p>



<a name="528468480"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/528468480" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#528468480">(Jul 12 2025 at 16:07)</a>:</h4>
<p><span class="user-mention silent" data-user-id="361169">Anton</span> <a href="#narrow/stream/395097-compiler-development/topic/casual.20conversation/near/528462392">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="515757">Luke Boswell</span> <a href="#narrow/channel/395097-compiler-development/topic/casual.20conversation/near/528384911">said</a>:</p>
<blockquote>
<p>I just watched a LamdbaConf video on Jai recently and he had some really nice debugging stuff for his compiler</p>
</blockquote>
<p>Seeing all the visualizations made me think; it would be nice to have anomaly detection set up for the snapshots, like in CI it would alert us if some metric for a Roc program is 100x higher than the average for all snapshots. I don't know if we should actually do that but it's a cool idea :p</p>
</blockquote>
<p>Two thoughts:</p>
<ol>
<li>Everyone should watch this for the debug tooling inspiration <a href="https://youtu.be/IdpD5QIVOKQ?si=0qjQVNwXlTn0gbAj">https://youtu.be/IdpD5QIVOKQ?si=0qjQVNwXlTn0gbAj</a><div class="youtube-video message_inline_image"><a data-id="IdpD5QIVOKQ" href="https://youtu.be/IdpD5QIVOKQ?si=0qjQVNwXlTn0gbAj"><img src="https://uploads.zulipusercontent.net/967cbd7a7ef9c38eaa66f00dd9d79c9007726194/68747470733a2f2f692e7974696d672e636f6d2f76692f49647044355149564f4b512f6d7164656661756c742e6a7067"></a></div></li>
<li>I often find alerts like those are limited, but doing something like what jai is doing works well. Basically, thresholds are super nebulous and lead to churn and inconveniences. On the other hand, letting someone interested visualize and debug is super powerful. Also, tracking over time is super powerful. I guess I kinda put it in the same bucket as our fuzzing is right now. I don't want it in CI, but I absolutely want it available for someone interested to start improving the compiler more.</li>
</ol>



<a name="528476921"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/528476921" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#528476921">(Jul 12 2025 at 18:39)</a>:</h4>
<p>Thoughts on adding functionality for benchmarking the parser/tokenizer? Strawman: <a href="https://github.com/roc-lang/roc/pull/8013">https://github.com/roc-lang/roc/pull/8013</a></p>



<a name="528477072"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/528477072" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#528477072">(Jul 12 2025 at 18:42)</a>:</h4>
<p>I'd love that! <span aria-label="star struck" class="emoji emoji-1f929" role="img" title="star struck">:star_struck:</span></p>



<a name="528477428"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/528477428" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#528477428">(Jul 12 2025 at 18:48)</a>:</h4>
<p>Yeah, sounds great....</p>
<p>Why is parser a directory and tokenizer a file?</p>



<a name="528477447"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/528477447" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#528477447">(Jul 12 2025 at 18:49)</a>:</h4>
<p>Also, sounds like a great entry point to use with tracy</p>



<a name="528477607"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/528477607" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#528477607">(Jul 12 2025 at 18:50)</a>:</h4>
<blockquote>
<p>Why is parser a directory and tokenizer a file?</p>
</blockquote>
<p>My thinking is that it's really easy to just concat a bunch of random files, and that's actually a reasonable input to the tokenizer - but that's going to fail early in parsing.</p>



<a name="528477621"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/528477621" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#528477621">(Jul 12 2025 at 18:51)</a>:</h4>
<p>I suppose that may result in a somewhat less realistic benchmark</p>



<a name="528477631"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/528477631" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#528477631">(Jul 12 2025 at 18:51)</a>:</h4>
<p>I guess probably best to have them both be dirs</p>



<a name="528478028"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/528478028" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#528478028">(Jul 12 2025 at 18:58)</a>:</h4>
<p>I would make them both accept either</p>



<a name="528478043"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/528478043" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#528478043">(Jul 12 2025 at 18:58)</a>:</h4>
<p>Like if you pass a file it does just the file</p>



<a name="528478070"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/528478070" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#528478070">(Jul 12 2025 at 18:59)</a>:</h4>
<p>If you pass a directory it does the full dir</p>



<a name="528478320"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/528478320" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#528478320">(Jul 12 2025 at 19:04)</a>:</h4>
<blockquote>
<p>Also, sounds like a great entry point to use with tracy</p>
</blockquote>
<p><span class="user-mention" data-user-id="343810">@Brendan Hansknecht</span> do I need to do anything special to get this to work with Tracy?</p>



<a name="528478489"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/528478489" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#528478489">(Jul 12 2025 at 19:07)</a>:</h4>
<p>No</p>



<a name="528478497"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/528478497" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#528478497">(Jul 12 2025 at 19:07)</a>:</h4>
<p>At least not if this still goes through main</p>



<a name="528478524"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/528478524" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#528478524">(Jul 12 2025 at 19:08)</a>:</h4>
<p>The two pieces in code are the allocator wrapper: <a href="https://github.com/roc-lang/roc/blob/f76c2736128a703a44c8505bd52d53cf85ee5cb1/src/main.zig#L30-L36">https://github.com/roc-lang/roc/blob/f76c2736128a703a44c8505bd52d53cf85ee5cb1/src/main.zig#L30-L36</a></p>
<p>And the trace markers: <a href="https://github.com/roc-lang/roc/blob/f76c2736128a703a44c8505bd52d53cf85ee5cb1/src/main.zig#L52-L53">https://github.com/roc-lang/roc/blob/f76c2736128a703a44c8505bd52d53cf85ee5cb1/src/main.zig#L52-L53</a></p>



<a name="528478573"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/528478573" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#528478573">(Jul 12 2025 at 19:09)</a>:</h4>
<p>General question this got me thinking of. should <code>roc check</code> be able to run over a directory of files? I guess that might lead to a bunch of redundant work</p>



<a name="528478578"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/528478578" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#528478578">(Jul 12 2025 at 19:09)</a>:</h4>
<p>so maybe not</p>



<a name="528478625"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/528478625" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#528478625">(Jul 12 2025 at 19:09)</a>:</h4>
<p>But also could be useful for some benchmarking</p>



<a name="528480749"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/528480749" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#528480749">(Jul 12 2025 at 19:48)</a>:</h4>
<p>I think globs do that for you automatically as long as we accept multiple files</p>



<a name="528481088"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/528481088" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#528481088">(Jul 12 2025 at 19:54)</a>:</h4>
<p>You mean like <code>roc check dir/*.roc</code>? That doesn't deal with recursive roc files and directory structures. And not all shells support <code>**</code>. That is why I generally prefer direct support of passing in a dir</p>



<a name="528481600"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/528481600" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#528481600">(Jul 12 2025 at 20:03)</a>:</h4>
<p>fair, seems fine then <span aria-label="+1" class="emoji emoji-1f44d" role="img" title="+1">:+1:</span></p>



<a name="528485631"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/528485631" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#528485631">(Jul 12 2025 at 21:33)</a>:</h4>
<p>Also, there are limits on the length of a command line on some platforms. Eg 32kb on windows, IIRC. It’s easy to hit those by doing shell expansion of large directories.</p>



<a name="528490124"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/528490124" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#528490124">(Jul 12 2025 at 23:30)</a>:</h4>
<p>wow, I just successfully resolved a segfault in our snapshot testing system that only reproduced in one file, and only when running with the <code>--debug</code> flag - just by telling Claude to try to fix it and then being increasingly insistent that the bug had to be in our code somewhere and not a bug in zig's general purpose allocator.</p>



<a name="528490129"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/528490129" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#528490129">(Jul 12 2025 at 23:30)</a>:</h4>
<p>turned out we had a double-free</p>



<a name="528490169"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/528490169" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#528490169">(Jul 12 2025 at 23:31)</a>:</h4>
<p>nicest experience I've ever had fixing a double-free! <span aria-label="laughing" class="emoji emoji-1f606" role="img" title="laughing">:laughing:</span></p>



<a name="528519582"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/528519582" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#528519582">(Jul 13 2025 at 10:13)</a>:</h4>
<p>Yeah, it's really nice that they are getting decent at debugging now.</p>



<a name="528527587"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/528527587" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#528527587">(Jul 13 2025 at 12:44)</a>:</h4>
<p>At the same time, I have seen Claude:</p>
<ol>
<li>Comment out the body of a test</li>
<li>Turn code from a real implementation to a naive implementation to pass a test instead of fixing the real implementation</li>
<li>Add type ignore hints to python instead of fixing the type issue.</li>
</ol>



<a name="528527597"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/528527597" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#528527597">(Jul 13 2025 at 12:44)</a>:</h4>
<p>But yeah, nice they can help in some cases</p>



<a name="528528603"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/528528603" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#528528603">(Jul 13 2025 at 13:04)</a>:</h4>
<p>I have not had it cheat on me before, but I have heard it from others. I expect that these kinds of issues are temporary.</p>



<a name="528529681"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/528529681" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#528529681">(Jul 13 2025 at 13:25)</a>:</h4>
<p>Yeah, I bet some of the rl tuning is over optimized on getting some tasks done and doesn't check well enough on how it gets done</p>



<a name="528529942"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/528529942" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#528529942">(Jul 13 2025 at 13:30)</a>:</h4>
<p>Also, I have been messing around with it in a python + mojo project and that may confuse it more often.</p>



<a name="528529994"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/528529994" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#528529994">(Jul 13 2025 at 13:31)</a>:</h4>
<p>Uhu, it's probably overeager on trying to apply its regular python knowledge</p>



<a name="528530993"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/528530993" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#528530993">(Jul 13 2025 at 13:51)</a>:</h4>
<p><span class="user-mention silent" data-user-id="343810">Brendan Hansknecht</span> <a href="#narrow/stream/395097-compiler-development/topic/casual.20conversation/near/528527587">said</a>:</p>
<blockquote>
<p>At the same time, I have seen Claude:</p>
<ol>
<li>Comment out the body of a test</li>
<li>Turn code from a real implementation to a naive implementation to pass a test instead of fixing the real implementation</li>
<li>Add type ignore hints to python instead of fixing the type issue.</li>
</ol>
</blockquote>
<p>I've gotten used to these now. It used to be that I'd think "wow, how embarrassing for Claude" and now I'm just like "oh yeah, that happens, hey Claude do it right, moving on."</p>



<a name="528531066"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/528531066" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#528531066">(Jul 13 2025 at 13:52)</a>:</h4>
<p>it's also why I don't understand people who are like "I don't even read the code anymore" - I have never seen that be the optimal way to use these tools on a serious project</p>



<a name="528531119"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/528531119" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#528531119">(Jul 13 2025 at 13:53)</a>:</h4>
<p>if you don't read the code you have no idea when tests are being silently deleted etc</p>



<a name="528531314"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/528531314" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#528531314">(Jul 13 2025 at 13:57)</a>:</h4>
<p>Yeah, Ive only just started using Claude (cause my work is paying for it), and so far, I have been impressed for super short scripts and trivial edits to many files, but in general, I think it slows me down currently.</p>



<a name="528531336"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/528531336" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#528531336">(Jul 13 2025 at 13:57)</a>:</h4>
<p>But I'm finding the patterns it can deal with quickly that would be less fast for me to do</p>



<a name="528531559"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/528531559" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#528531559">(Jul 13 2025 at 14:01)</a>:</h4>
<p>yeah it took me awhile before it was a net speedup for me on complicated projects</p>



<a name="528531601"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/528531601" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#528531601">(Jul 13 2025 at 14:02)</a>:</h4>
<p>a lot of trial and error getting a feeling for failure modes, how to scope tasks for it, etc.</p>



<a name="528531616"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/528531616" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#528531616">(Jul 13 2025 at 14:02)</a>:</h4>
<p>now I'm definitely significantly faster with it than without it, but it took awhile for that to be true</p>



<a name="528533820"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/528533820" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#528533820">(Jul 13 2025 at 14:40)</a>:</h4>
<p>Yeah. Makes sense. And I bet it is more capable work things that have more examples documentation and tooling.... Mojo is a bit lacking</p>



<a name="528537436"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/528537436" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#528537436">(Jul 13 2025 at 15:40)</a>:</h4>
<p>Also, I bet that strong typing wpuld help it. I probably should add a claude.md and add an entry about type checking and ignoring things</p>



<a name="528538007"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/528538007" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#528538007">(Jul 13 2025 at 15:50)</a>:</h4>
<p>I think roc (once there are enough examples and the compiler is robust wnough) will be very llm friendly due to how the language works</p>



<a name="528538065"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/528538065" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kiryl Dziamura <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#528538065">(Jul 13 2025 at 15:51)</a>:</h4>
<p>Functional Fast LLM-Friendly</p>



<a name="528619816"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/528619816" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kiryl Dziamura <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#528619816">(Jul 14 2025 at 09:25)</a>:</h4>
<p><a href="/user_uploads/22008/XOYr_g1U0qzhP-0nC1fQWHPp/image.png">image.png</a><br>
when I call type information in zsl for a single quote, I get this nice table</p>
<div class="message_inline_image"><a href="/user_uploads/22008/XOYr_g1U0qzhP-0nC1fQWHPp/image.png" title="image.png"><img data-original-content-type="image/png" data-original-dimensions="612x452" src="/user_uploads/thumbnail/22008/XOYr_g1U0qzhP-0nC1fQWHPp/image.png/840x560.webp"></a></div>



<a name="528624233"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/528624233" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kiryl Dziamura <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#528624233">(Jul 14 2025 at 09:48)</a>:</h4>
<p>does roc want <code>\u(...)</code> escape or <code>\u{...}</code>? asking because string interpolation was <code>\(...)</code> initially and now it's <code>${...}</code></p>



<a name="528626159"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/528626159" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kiryl Dziamura <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#528626159">(Jul 14 2025 at 10:00)</a>:</h4>
<p>and another question: why not implementing utf8 escape with int num literals? like <code>\u{0x123}</code> or <code>\u{42}</code> (yeah, historically this format is for hex so it would be unexpected to have dec here) or <code>\u{0b1001}</code>? hex is absolutely enough. I'm just wondering if num literals can give any advantage here?</p>



<a name="528630119"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/528630119" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kiryl Dziamura <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#528630119">(Jul 14 2025 at 10:26)</a>:</h4>
<p>should escape seqs be processed during tokenization or during canonicalization? my thought is that it shouldn't hinder tokenization. the only case of escaping tokenizer should process is escape of double quote for strings (<code>"\""</code>) and single quote for single quote (<code>'\''</code>) so it knows where's the start and the end of the literal. and then process the literal at can time so the formatter can still format the code. but I'm likely missing smth.<br>
<span class="user-mention" data-user-id="453336">@Joshua Warner</span> I think you should know the answer</p>



<a name="528639242"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/528639242" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#528639242">(Jul 14 2025 at 11:24)</a>:</h4>
<p>during tokenization the bytes we need to traverse will for sure already be in cache, so I think that'll be the cheapest time to do it</p>



<a name="528639300"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/528639300" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#528639300">(Jul 14 2025 at 11:24)</a>:</h4>
<p>I'd also like to move the logic for turning number literals into actual numbers into tokenization for the same reason</p>



<a name="528639387"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/528639387" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#528639387">(Jul 14 2025 at 11:25)</a>:</h4>
<p>that said, it might make sense to have a flag that the formatter can pass in to say "don't bother doing this because it won't get used"</p>



<a name="528639638"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/528639638" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#528639638">(Jul 14 2025 at 11:26)</a>:</h4>
<p><span class="user-mention silent" data-user-id="584248">Kiryl Dziamura</span> <a href="#narrow/stream/395097-compiler-development/topic/casual.20conversation/near/528626159">said</a>:</p>
<blockquote>
<p>and another question: why not implementing utf8 escape with int num literals? like <code>\u{0x123}</code> or <code>\u{42}</code> (yeah, historically this format is for hex so it would be unexpected to have dec here) or <code>\u{0b1001}</code>? hex is absolutely enough. I'm just wondering if num literals can give any advantage here?</p>
</blockquote>
<p>I remember talking about this on Zulip years ago, and I think the conclusion was that Unicode escapes are a feature that will be used 99.99% of the time by copy/pasting from somewhere, so the most important thing is consistency, not flexibility</p>



<a name="528639768"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/528639768" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#528639768">(Jul 14 2025 at 11:27)</a>:</h4>
<p>that said, I think the main thing is that we don't want to change the syntax here; however it works in the old compiler is exactly how it should work in the new compiler <span aria-label="smile" class="emoji emoji-1f604" role="img" title="smile">:smile:</span></p>



<a name="528668162"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/528668162" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#528668162">(Jul 14 2025 at 13:53)</a>:</h4>
<p><span class="user-mention silent" data-user-id="281383">Richard Feldman</span> <a href="#narrow/stream/395097-compiler-development/topic/casual.20conversation/near/528639300">said</a>:</p>
<blockquote>
<p>I'd also like to move the logic for turning number literals into actual numbers into tokenization for the same reason</p>
</blockquote>
<p>Isn't this in the boat of so fast it is better to just recompute on they fly at the last minute instead of shooting somewhere and spending extra memory</p>



<a name="528668286"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/528668286" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#528668286">(Jul 14 2025 at 13:54)</a>:</h4>
<p>Not actually sure it's the case but I thought Andrew talked directly about this in a zig talk and it being a win to not do it until the last minute</p>



<a name="528668476"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/528668476" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#528668476">(Jul 14 2025 at 13:55)</a>:</h4>
<p>On specific thing to consider for the long term, if we switch to a simd tokenizer, I'm pretty sure this will put a non-simd loop in the middle of it...which likely will make it cost more.</p>



<a name="528670382"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/528670382" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#528670382">(Jul 14 2025 at 14:04)</a>:</h4>
<p>we need it during canonicalization to report "number literal too big for type" errors</p>



<a name="528670407"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/528670407" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#528670407">(Jul 14 2025 at 14:05)</a>:</h4>
<p>so canonicalization is the absolute last minute</p>



<a name="528670679"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/528670679" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#528670679">(Jul 14 2025 at 14:06)</a>:</h4>
<p>fair point about SIMD tokenization, but right now we're doing it in the middle of canonicalization and every time we hit a number literal we go load memory that hasn't been touched since tokenization and won't be touched again unless there's an error to report, so definitely seems like it would be better to do it earlier <span aria-label="sweat smile" class="emoji emoji-1f605" role="img" title="sweat smile">:sweat_smile:</span></p>



<a name="528672040"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/528672040" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#528672040">(Jul 14 2025 at 14:12)</a>:</h4>
<p>Ah, fair</p>



<a name="528672756"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/528672756" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#528672756">(Jul 14 2025 at 14:16)</a>:</h4>
<p>actually I think it would be fine in the SIMDjson style, because after processing each 64-byte chunk of source with a bunch of SIMD passes, there are a series of non-SIMD passes that have to happen afterwards before moving onto the next 64B chunk, and they're all loops</p>



<a name="528672776"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/528672776" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#528672776">(Jul 14 2025 at 14:16)</a>:</h4>
<p>so this could just be one more of those</p>



<a name="528673250"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/528673250" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#528673250">(Jul 14 2025 at 14:18)</a>:</h4>
<p>Yeah, the important part is the chunking there</p>



<a name="528673291"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/528673291" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#528673291">(Jul 14 2025 at 14:18)</a>:</h4>
<p>64bytes of happy Simd before falling into sad loops</p>



<a name="528673372"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/528673372" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#528673372">(Jul 14 2025 at 14:19)</a>:</h4>
<p>Just don't start doing it immediately on detecting a number</p>



<a name="528764683"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/528764683" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#528764683">(Jul 15 2025 at 01:13)</a>:</h4>
<p>Daniel Lemire doing experiments to see if using unaligned memory hurts perf on modern CPUs and...apparently it doesn't! <span aria-label="sweat smile" class="emoji emoji-1f605" role="img" title="sweat smile">:sweat_smile:</span> </p>
<p><a href="https://x.com/lemire/status/1944899756838305873">https://x.com/lemire/status/1944899756838305873</a></p>



<a name="528767489"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/528767489" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#528767489">(Jul 15 2025 at 01:54)</a>:</h4>
<p>Yeah, the only cost on modern machines should be around cache lines maybe not containing full data</p>



<a name="528767655"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/528767655" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#528767655">(Jul 15 2025 at 01:56)</a>:</h4>
<p>That obviously amortizes away</p>



<a name="528767695"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/528767695" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#528767695">(Jul 15 2025 at 01:57)</a>:</h4>
<p>So worst cost would be if it leads to loading two caches lines in a one off. Then that happens on repeat, but not linearly such that prefecthing helps</p>



<a name="528767946"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/528767946" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#528767946">(Jul 15 2025 at 02:00)</a>:</h4>
<p>Obviously don't want to do it anyway if you can avoid it cause it isn't a guarantee and your code may also run on less optimized architecture used for mobile or edge processors.</p>



<a name="528833834"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/528833834" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#528833834">(Jul 15 2025 at 11:04)</a>:</h4>
<p>I fixed some minor issues with backticks in our can diagnostics. I've noticed there are a bunch of things with our problem reports that aren't ideal, and we tend to be copy-pasting the last ones etc. </p>
<p>Whenever you're looking at a new Diagnostic (or the existing ones if you feel like helping clean this up a little) can you pay special attention to the helpers like <code>addCodeBlock</code> or <code>addInlineCode</code> or <code>addKeyword</code> or <code>addType</code> etc and try and use the right one. It will just help to keep our reports pretty in every context.</p>



<a name="528842890"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/528842890" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#528842890">(Jul 15 2025 at 11:58)</a>:</h4>
<p>I had Claude help me update our Diagnostics to use the correct methods. Looks like a nice improvement <a href="https://github.com/roc-lang/roc/pull/8048">https://github.com/roc-lang/roc/pull/8048</a></p>



<a name="528854432"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/528854432" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kiryl Dziamura <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#528854432">(Jul 15 2025 at 12:56)</a>:</h4>
<p>Yesterday I was thinking whether zig transforms switch by tokens to jmpifs or to a jumptable (I think it should but I haven't checked) and then started wondering if it's true for tokenizer itself (jump per character). So in place of a sequence of ifs we have a jumptable where offset is the character byte</p>
<p>And then today HN gave me this, which is exactly the thing I was thinking of: <a href="https://xnacly.me/posts/2025/fast-lexer-strategies/">https://xnacly.me/posts/2025/fast-lexer-strategies/</a> </p>
<p>Does it make sense to have this in roc? Maybe llvm already does it for us?</p>



<a name="528879805"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/528879805" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#528879805">(Jul 15 2025 at 14:51)</a>:</h4>
<p>You should by default assume that ifs manifest and hurt optimizations....of course they can be cmov</p>



<a name="528880018"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/528880018" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#528880018">(Jul 15 2025 at 14:52)</a>:</h4>
<p>Also, zig turns a while true loop with a switch in it to a jump table. I believe that is the pattern...I know there was a doc or changelog entry about the format here</p>



<a name="528880362"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/528880362" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#528880362">(Jul 15 2025 at 14:53)</a>:</h4>
<p>As for the roc tokenizer, I think the end goal is simdjson style</p>



<a name="528880453"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/528880453" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#528880453">(Jul 15 2025 at 14:53)</a>:</h4>
<p>But I'm sure some of these techniques will apply. I know we have also already shared a few zig specific blogs</p>



<a name="528880790"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/528880790" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kiryl Dziamura <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#528880790">(Jul 15 2025 at 14:55)</a>:</h4>
<p>there's also a comment about simd in the clickhouse lexer: <a href="https://news.ycombinator.com/item?id=44562278">https://news.ycombinator.com/item?id=44562278</a><br>
I heard a lot about simdjson, I guess it's time to finally look into it <span aria-label="smile" class="emoji emoji-1f604" role="img" title="smile">:smile:</span></p>



<a name="528882211"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/528882211" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#528882211">(Jul 15 2025 at 15:01)</a>:</h4>
<p>I only roughly know it. Also, I'm sure many incremental changes could be made to the current tokenizer to make it faster</p>



<a name="528882292"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/528882292" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#528882292">(Jul 15 2025 at 15:01)</a>:</h4>
<p>That said, of we want to improve compiler perf, we should focus on can and diagnostics</p>



<a name="528886885"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/528886885" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#528886885">(Jul 15 2025 at 15:24)</a>:</h4>
<p>One extra note...if tokenizer perf sounds fun (either tuning the current tokenizer or working on a more Simd version)....go for it....enjoy</p>



<a name="528887512"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/528887512" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#528887512">(Jul 15 2025 at 15:27)</a>:</h4>
<p>I've been wondering, when we introduce simd to the tokenizer, should we just keep two versions of the tokenizer:</p>
<ul>
<li>no simd, easy to understand, debug and edit</li>
<li>simd, crazy perf version :p</li>
</ul>



<a name="528887666"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/528887666" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kiryl Dziamura <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#528887666">(Jul 15 2025 at 15:28)</a>:</h4>
<p>Maybe next time <span aria-label="smile" class="emoji emoji-1f604" role="img" title="smile">:smile:</span>just verifying my thoughts. I already have what to do in the repo</p>



<a name="528907174"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/528907174" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#528907174">(Jul 15 2025 at 17:14)</a>:</h4>
<p>We keep it for fuzzing?</p>



<a name="528907236"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/528907236" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#528907236">(Jul 15 2025 at 17:14)</a>:</h4>
<p>Make sure they always agree?</p>



<a name="528922422"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/528922422" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#528922422">(Jul 15 2025 at 18:49)</a>:</h4>
<p><a href="https://simonklee.dk/labeled-switch">https://simonklee.dk/labeled-switch</a></p>



<a name="528926588"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/528926588" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#528926588">(Jul 15 2025 at 19:15)</a>:</h4>
<p>we're already using labeled switch in...layout I think?</p>



<a name="528948108"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/528948108" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#528948108">(Jul 15 2025 at 21:57)</a>:</h4>
<p>A casual attempt at applying labeled switch to the main switch in the tokenizer yields a ~15% perf regression :/</p>



<a name="528948872"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/528948872" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#528948872">(Jul 15 2025 at 22:04)</a>:</h4>
<p>The world is cruel</p>



<a name="529232664"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/529232664" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kiryl Dziamura <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#529232664">(Jul 17 2025 at 08:57)</a>:</h4>
<p>in <code>tokenize.zig</code>, there are malformed tokens and diagnostic messages. my intuition was that malformed token is a twin of a valid token or group of tokens (e.g. valid <code>Float, Int</code> and their malformed version <code>MalformedNumber</code>) and diagnostic messages clarify the malfunction (e.g. <code>NumberNoDigits, NumberBadSuffix, NumberNoExponentDigits</code>) but I see the things, that I would expect to be messages only, are actually tokens:</p>
<div class="codehilite"><pre><span></span><code>                .MalformedNumberBadSuffix,
                .MalformedNumberNoDigits,
                .MalformedNumberNoExponentDigits,
                .MalformedNumberUnicodeSuffix,
</code></pre></div>
<p>is there a reason for that?</p>



<a name="529281792"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/529281792" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kiryl Dziamura <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#529281792">(Jul 17 2025 at 13:39)</a>:</h4>
<p>I just realized that unicode escape in single quote literal is redundant since roc considers single quote as an int. to me, base16 via <code>0x...</code> is clearer than <code>\u{...}</code>:</p>
<div class="codehilite"><pre><span></span><code>&#39;\u{42}&#39; == 0x42
</code></pre></div>
<p>what's the reason of keeping both? to comply string literal and for historical reasons?</p>



<a name="529290276"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/529290276" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#529290276">(Jul 17 2025 at 14:17)</a>:</h4>
<p>Probably just for clarity of use...but yeah shouldn't technically be needed</p>



<a name="529303425"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/529303425" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#529303425">(Jul 17 2025 at 15:20)</a>:</h4>
<p><span class="user-mention" data-user-id="584248">@Kiryl Dziamura</span> </p>
<blockquote>
<p>diagnostic messages clarify the malfunction (e.g. <code>NumberNoDigits, NumberBadSuffix, NumberNoExponentDigits</code>) but I see the things, that I would expect to be messages only, are actually tokens</p>
</blockquote>
<p>The intent here was to communicate to the parser that there was a vaguely-number-like-thing here, and you should probably construct the syntax tree to be consistent with there being a number-like-thing here.</p>
<p>Contrast that with the situation where we just have the tokenizer message and no token, where it'll seem to the parser like there was nothing there at all - definitely leading to a redundant error message, and possibly leading to cascading parse errors because the tree is structurally wrong.</p>



<a name="529304088"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/529304088" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kiryl Dziamura <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#529304088">(Jul 17 2025 at 15:23)</a>:</h4>
<p>but number-like-thing can be just <code>MalformedNumber</code>. and tokenizer message has region. but I get what you mean. it sounds like it's better to ditch diagnostics during tokenization and generate unique malformed tokens instead. then push messages at canonicalization based on the tokens</p>



<a name="529304293"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/529304293" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kiryl Dziamura <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#529304293">(Jul 17 2025 at 15:24)</a>:</h4>
<p>diagnostics at can time can also provide better messages relying on the context</p>



<a name="529304531"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/529304531" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#529304531">(Jul 17 2025 at 15:26)</a>:</h4>
<p>There are som diagnostics that we don’t want to convert to malformed tokens, eg the one for having an uppercase base (0Xff)</p>



<a name="529602513"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/529602513" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#529602513">(Jul 19 2025 at 17:38)</a>:</h4>
<p>Why does the ModuleEnv own (and de-init) the source code?</p>



<a name="529602692"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/529602692" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#529602692">(Jul 19 2025 at 17:42)</a>:</h4>
<p>This seems to contradict how it's used: <a href="https://github.com/roc-lang/roc/blob/main/src/coordinate_simple.zig#L193">link</a></p>
<div class="codehilite"><pre><span></span><code>/// The source is always duplicated for the ModuleEnv, which owns the copy.
fn processSourceInternal(
</code></pre></div>



<a name="529603027"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/529603027" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#529603027">(Jul 19 2025 at 17:48)</a>:</h4>
<p>Ah of course and the higher-level function has a leak in the case of ~a cache hit~ the cache being disabled <span aria-label="sweat smile" class="emoji emoji-1f605" role="img" title="sweat smile">:sweat_smile:</span></p>



<a name="529608864"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/529608864" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#529608864">(Jul 19 2025 at 19:45)</a>:</h4>
<p>yeah my thinking there was that when the compiler is running in like a watch mode, it'll be common for files to change on disk and then we need to reload the source bytes as well as getting a new ModuleEnv, so it seemed like coupling those would be the least error-prone if we're going to be unloading ModuleEnvs at runtime</p>



<a name="529610338"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/529610338" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#529610338">(Jul 19 2025 at 20:19)</a>:</h4>
<p>Have it be in-memory, sure - but not de-allocated by the module env, IMO.</p>



<a name="529610360"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/529610360" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#529610360">(Jul 19 2025 at 20:19)</a>:</h4>
<p>I ought to be able to invoke the compiler on code I manage the allocation for, without duplicating it.</p>



<a name="529610420"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/529610420" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#529610420">(Jul 19 2025 at 20:21)</a>:</h4>
<p>Ran into this vis-à-vis benchmarking, where somehow I missed this and we were double-freeing all the sources because I wasn’t duping them every iteration.</p>



<a name="529612748"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/529612748" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#529612748">(Jul 19 2025 at 21:09)</a>:</h4>
<p>ahh hm</p>



<a name="529612768"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/529612768" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#529612768">(Jul 19 2025 at 21:10)</a>:</h4>
<p>ok feel free to change it so that module env owns everything else but the src <span aria-label="+1" class="emoji emoji-1f44d" role="img" title="+1">:+1:</span></p>



<a name="529613614"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/529613614" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#529613614">(Jul 19 2025 at 21:29)</a>:</h4>
<p>I really wish zig had a borrow checker <span aria-label="sweat smile" class="emoji emoji-1f605" role="img" title="sweat smile">:sweat_smile:</span></p>



<a name="529613627"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/529613627" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#529613627">(Jul 19 2025 at 21:29)</a>:</h4>
<p>Lifetime annotations for who owns what are so damn useful</p>



<a name="529613633"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/529613633" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#529613633">(Jul 19 2025 at 21:29)</a>:</h4>
<p>(especially checked ones!)</p>



<a name="529616940"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/529616940" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#529616940">(Jul 19 2025 at 22:53)</a>:</h4>
<p><a href="https://github.com/roc-lang/roc/pull/8081">https://github.com/roc-lang/roc/pull/8081</a></p>



<a name="529616967"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/529616967" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#529616967">(Jul 19 2025 at 22:54)</a>:</h4>
<p>Side note: issue <a href="https://github.com/roc-lang/roc/issues/8086">#8086</a> is fast approaching. Should try to get some sort of intel throwback in there <span aria-label="stuck out tongue" class="emoji emoji-1f61b" role="img" title="stuck out tongue">:stuck_out_tongue:</span></p>



<a name="529617504"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/529617504" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#529617504">(Jul 19 2025 at 23:08)</a>:</h4>
<p>I know this is a first world problem... but has anyone else ever had trouble with sub-millisecond precision measurements across different browsers?</p>



<a name="529617517"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/529617517" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#529617517">(Jul 19 2025 at 23:08)</a>:</h4>
<p>Chrome seems to be fine, but Safari struggles</p>



<a name="529617534"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/529617534" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#529617534">(Jul 19 2025 at 23:09)</a>:</h4>
<p>That’s a security feature</p>



<a name="529617620"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/529617620" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#529617620">(Jul 19 2025 at 23:11)</a>:</h4>
<p>It was that speculative execution thing a few years ago. It turns out if you can measure times really precisely, it becomes possible to exfiltrate secret data. Very hard to fully harden against, so a defense in depth is making sure you can measure super precisely.</p>



<a name="529617666"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/529617666" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#529617666">(Jul 19 2025 at 23:13)</a>:</h4>
<p>Cool</p>



<a name="529617728"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/529617728" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#529617728">(Jul 19 2025 at 23:15)</a>:</h4>
<p>I'm enjoying seeing the timing information for our compiler to type check some source <span aria-label="smiley" class="emoji emoji-1f603" role="img" title="smiley">:smiley:</span> </p>
<p><a href="/user_uploads/22008/Y4-SxO5A32vVqkMi1SzNdYD8/Screenshot-2025-07-20-at-09.14.25.png">Screenshot 2025-07-20 at 09.14.25.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/22008/Y4-SxO5A32vVqkMi1SzNdYD8/Screenshot-2025-07-20-at-09.14.25.png" title="Screenshot 2025-07-20 at 09.14.25.png"><img data-original-content-type="image/png" data-original-dimensions="1050x496" src="/user_uploads/thumbnail/22008/Y4-SxO5A32vVqkMi1SzNdYD8/Screenshot-2025-07-20-at-09.14.25.png/840x560.webp"></a></div>



<a name="529619742"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/529619742" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#529619742">(Jul 20 2025 at 00:08)</a>:</h4>
<p>Nice! 0.2ms is pretty fast indeed!</p>



<a name="529619761"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/529619761" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#529619761">(Jul 20 2025 at 00:09)</a>:</h4>
<p>If we could do wasm code emission and execution in anywhere close to that, that’d be awesome!</p>



<a name="529621889"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/529621889" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#529621889">(Jul 20 2025 at 01:10)</a>:</h4>
<p>Thats the time taken to load the source into the wasm compiler, tokenize-&gt;parse-&gt;canonicalize-&gt;type check-&gt;serialise diagnostics to HTML</p>



<a name="529621922"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/529621922" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#529621922">(Jul 20 2025 at 01:11)</a>:</h4>
<p>Definitely fastest when there are no diagnostics <span aria-label="sweat smile" class="emoji emoji-1f605" role="img" title="sweat smile">:sweat_smile:</span></p>



<a name="529622928"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/529622928" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#529622928">(Jul 20 2025 at 01:38)</a>:</h4>
<p>Is there something about diagnostics that makes them complicated/slow to generate?</p>



<a name="529622942"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/529622942" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#529622942">(Jul 20 2025 at 01:38)</a>:</h4>
<p>Or just that we haven’t optimized them (yet)</p>



<a name="529623063"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/529623063" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#529623063">(Jul 20 2025 at 01:42)</a>:</h4>
<p>Slow as in pushes us over the 1ms threshold</p>



<a name="529623086"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/529623086" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#529623086">(Jul 20 2025 at 01:43)</a>:</h4>
<p>But yeah, I haven't really looked at it. Just messing around with things. It's really cool how capable the compiler is already!</p>



<a name="529624382"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/529624382" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#529624382">(Jul 20 2025 at 02:17)</a>:</h4>
<blockquote>
<p>Is there something about diagnostics that makes them complicated/slow to generate?</p>
</blockquote>
<p>I think they currently just allocate like crazy</p>



<a name="529625358"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/529625358" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#529625358">(Jul 20 2025 at 02:47)</a>:</h4>
<p>This is a really interesting paper: <a href="https://arxiv.org/abs/2504.09246">https://arxiv.org/abs/2504.09246</a></p>
<p>Essentially, they have a system that can type-check a partially-written typescript file (i.e. a prefix of a file), such that it can determine whether or not any continuation of that prefix could possibly be well-typed.</p>
<p>I've been noodling on trying to do something similar with Roc. Thoughts?</p>



<a name="529625920"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/529625920" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#529625920">(Jul 20 2025 at 03:04)</a>:</h4>
<p>Roughly thinking of the following extensions:</p>
<ul>
<li>Add a special "Partial" token that we can inject in places of the code that may not be complete</li>
<li>Auto-close any open parens/etc</li>
<li>This partial token can be "split" in the parser as many times as necessary to generate a syntactically-valid expression. If in the context of a block, that block gets one final "Partial" statement indicating defs (and a return stmt) may be missing</li>
<li>Similarly, we can have partial type definitions/etc</li>
<li>We canonicalize as usual, but take note of whether it's possible for any symbols that we can't find to be defined in the future in one of these "Partial" statements (or maybe a whole block has a "partial" bool? anyway...)</li>
<li>Type checking I _think_ can proceed mostly as usual, assigning types to any as-yet-undefined symbols, etc.</li>
<li>I think under those restrictions we should mostly be able to rely on type checking to only give errors that  would also be an issue if the file were complete. Right?</li>
</ul>



<a name="529680234"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/529680234" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#529680234">(Jul 20 2025 at 11:05)</a>:</h4>
<p>so is the goal to be able to tell when someone is typing in an editor and the line they're currently writing is incomplete, and if we detect that it's definitely an error no matter what comes after it, then we can assume it's malformed and then continue trying to check the rest of the file as normal so you still get errors elsewhere?</p>



<a name="529695680"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/529695680" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#529695680">(Jul 20 2025 at 15:32)</a>:</h4>
<p>The goal is to distinguish errors that are purely due to the input being incomplete, and errors that won’t be fixed no matter what more is typed at the cursor (or cursors, I suppose).</p>



<a name="529695876"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/529695876" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#529695876">(Jul 20 2025 at 15:35)</a>:</h4>
<p>I think this is mostly useful in the context of providing some constraints during decoding for an llm (ie guaranteeing that the llm generates a well-typed program), but maybe there are some implications for what errors we immediately display in an editor vs which ones we wait for your cursor to move away before displaying.</p>



<a name="530085441"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/530085441" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kiryl Dziamura <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#530085441">(Jul 22 2025 at 07:38)</a>:</h4>
<p>Compiler fuzzing of Kotlin. High-level overview, but the resources list might be interesting: <a href="https://blog.jetbrains.com/research/2025/07/fuzzing-the-kotlin-compiler/">https://blog.jetbrains.com/research/2025/07/fuzzing-the-kotlin-compiler/</a></p>



<a name="530696217"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/530696217" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#530696217">(Jul 25 2025 at 05:37)</a>:</h4>
<p>What do you think about adding to our zig CI lint, that you cannot leave any <code>std.debug.print</code>'s in the codebase. These don't play nicely with WASM freestanding or anything that doesn't have stdio.</p>



<a name="530930520"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/530930520" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#530930520">(Jul 26 2025 at 11:05)</a>:</h4>
<p><span class="user-mention" data-user-id="664700">@Loris Cro</span> or any Zig folk... are there any mature TUI libraries we should consider for roc cli? </p>
<p>I was looking at <a href="https://github.com/rockorager/libvaxis">rockorager/libvaxis</a> which looks pretty cool. </p>
<p>Not sure it's the path we want to go down... but interested to explore the idea, particularly now we basically have things ready to build our REPL.</p>



<a name="530931280"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/530931280" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Loris Cro <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#530931280">(Jul 26 2025 at 11:11)</a>:</h4>
<p>yes libvaxis is the one I would recommend as well. just for completeness know that it has a high-level and a low-level API, so if you like the idea of having widgets and the whole runtime that manages them, then great, but if you decide you want direct control over everything, you can still do that, libvaxis will not fight you</p>



<a name="530931364"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/530931364" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Loris Cro <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#530931364">(Jul 26 2025 at 11:12)</a>:</h4>
<p>I use the low-level api in <a href="https://github.com/kristoff-it/bork">bork</a> because I wanted to have my own interaction system with UI elements</p>



<a name="530992077"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/530992077" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#530992077">(Jul 26 2025 at 19:31)</a>:</h4>
<p>Thank you <span class="user-mention" data-user-id="664700">@Loris Cro</span></p>



<a name="531245189"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/531245189" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#531245189">(Jul 28 2025 at 00:52)</a>:</h4>
<p>Instead of "Canonicalizer" what about shortening this and using "Czer" around the place?</p>
<p>I can't think of a nicer/shorter description. My issue with  "Canonicalizer" is just that it's long</p>



<a name="531246343"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/531246343" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#531246343">(Jul 28 2025 at 01:00)</a>:</h4>
<p>Found something nicer <code>Can</code></p>



<a name="531313866"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/531313866" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#531313866">(Jul 28 2025 at 09:04)</a>:</h4>
<p>I think I'm stuck on <a href="https://github.com/roc-lang/roc/pull/8124">https://github.com/roc-lang/roc/pull/8124</a></p>
<div class="codehilite"><pre><span></span><code>src/collections/safe_list.zig:587:17: error: Cannot serialize non-POD type problem.Problem
                @compileError(&quot;Cannot serialize non-POD type &quot; ++ @typeName(T));
                ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
src/collections/safe_list.zig:649:62: error: enum &#39;meta.FieldEnum(multi_array_list.MultiArrayList(problem.Problem).Elem__struct_41792)&#39; has no tag with value &#39;2&#39;
                    const field_ptr = slice.items(@as(Field, @enumFromInt(i))).ptr;
                                                             ^~~~~~~~~~~~~~~
</code></pre></div>
<p>What I cannot understand is how this PR makes changes that cause these compile errors. I have basically just lifted the files into a common zig module, I haven't touched the <code>Problem</code> store or anything like that.</p>



<a name="531314570"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/531314570" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#531314570">(Jul 28 2025 at 09:07)</a>:</h4>
<p>Could it be that this code was not previously compiled because it was not used and now the zig compiler does detect it as used?</p>



<a name="531319258"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/531319258" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#531319258">(Jul 28 2025 at 09:30)</a>:</h4>
<p>There's definitely something pretty broken. I've tried 5-6 different things, and I always eventually run into the same issue, a segfault.</p>
<div class="codehilite"><pre><span></span><code>$ zig build test
test
└─ run test failure
error: while executing test &#39;test.test_0&#39;, the following command terminated with signal 11 (expected exited with code 0):
/Users/luke/Documents/GitHub/roc/.zig-cache/o/f8df5afaa2c191041d7f6fca549b4f9d/test --seed=0x5014a196 --cache-dir=/Users/luke/Documents/GitHub/roc/.zig-cache --listen=-
Build Summary: 4/7 steps succeeded; 1 failed; 361/361 tests passed
</code></pre></div>



<a name="531319419"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/531319419" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#531319419">(Jul 28 2025 at 09:30)</a>:</h4>
<p>I'm definitely hitting pause on this... I pushed the broken commit to <a href="https://github.com/roc-lang/roc/pull/8124">https://github.com/roc-lang/roc/pull/8124</a></p>
<p>The latest approach I took was to replace the SafeMultiList altogether.</p>



<a name="531321724"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/531321724" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#531321724">(Jul 28 2025 at 09:42)</a>:</h4>
<p>I'll take a look</p>



<a name="531352433"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/531352433" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#531352433">(Jul 28 2025 at 12:10)</a>:</h4>
<p>Okidoki, the key to start debugging this is to run the command without the listen flag:</p>
<div class="codehilite"><pre><span></span><code>error: while executing test &#39;test.test_0&#39;, the following command terminated with signal 11 (expected exited with code 0):
/home/username/gitrepos/roc2/roc/.zig-cache/o/c001d6b7d92a5fb63e64be83c43d0d57/test --seed=0x8532821a --cache-dir=/home/username/gitrepos/roc2/roc/.zig-cache --listen=-
</code></pre></div>
<p>So:</p>
<div class="codehilite"><pre><span></span><code>/home/username/gitrepos/roc2/roc/.zig-cache/o/c001d6b7d92a5fb63e64be83c43d0d57/test --seed=0x8532821a --cache-dir=/home/username/gitrepos/roc2/roc/.zig-cache
</code></pre></div>
<p>After doing:</p>
<div class="codehilite"><pre><span></span><code>gdb --batch --ex run --ex bt --args /home/username/gitrepos/roc2/roc/.zig-cache/o/c001d6b7d92a5fb63e64be83c43d0d57/test --seed=0x8532821a --cache-dir=/home/username/gitrepos/roc2/roc/.zig-cache
</code></pre></div>
<p>We get this forever:</p>
<div class="codehilite"><pre><span></span><code>Thread 1 &quot;test&quot; received signal SIGSEGV, Segmentation fault.
testing.refAllDeclsRecursive__anon_13463 () at /home/username/Downloads/zig-x86_64-linux-0.14.1/lib/std/testing.zig:1158
1158                    .@&quot;struct&quot;, .@&quot;enum&quot;, .@&quot;union&quot;, .@&quot;opaque&quot; =&gt; refAllDeclsRecursive(@field(T, decl.name)),
#0  testing.refAllDeclsRecursive__anon_13463 () at /home/username/Downloads/zig-x86_64-linux-0.14.1/lib/std/testing.zig:1158
#1  0x0000000001206d71 in testing.refAllDeclsRecursive__anon_28897 () at /home/username/Downloads/zig-x86_64-linux-0.14.1/lib/std/testing.zig:1158
#2  0x00000000011505f1 in testing.refAllDeclsRecursive__anon_13463 () at /home/username/Downloads/zig-x86_64-linux-0.14.1/lib/std/testing.zig:1158
#3  0x0000000001206d71 in testing.refAllDeclsRecursive__anon_28897 () at /home/username/Downloads/zig-x86_64-linux-0.14.1/lib/std/testing.zig:1158
#4  0x00000000011505f1 in testing.refAllDeclsRecursive__anon_13463 () at /home/username/Downloads/zig-x86_64-linux-0.14.1/lib/std/testing.zig:1158
#5  0x0000000001206d71 in testing.refAllDeclsRecursive__anon_28897 () at /home/username/Downloads/zig-x86_64-linux-0.14.1/lib/std/testing.zig:1158
#6  0x00000000011505f1 in testing.refAllDeclsRecursive__anon_13463 () at /home/username/Downloads/zig-x86_64-linux-0.14.1/lib/std/testing.zig:1158
#7  0x0000000001206d71 in testing.refAllDeclsRecursive__anon_28897 () at /home/username/Downloads/zig-x86_64-linux-0.14.1/lib/std/testing.zig:1158
#8  0x00000000011505f1 in testing.refAllDeclsRecursive__anon_13463 () at /home/username/Downloads/zig-x86_64-linux-0.14.1/lib/std/testing.zig:1158
#9  0x0000000001206d71 in testing.refAllDeclsRecursive__anon_28897 () at /home/username/Downloads/zig-x86_64-linux-0.14.1/lib/std/testing.zig:1158
#10 0x00000000011505f1 in testing.refAllDeclsRecursive__anon_13463 () at /home/username/Downloads/zig-x86_64-linux-0.14.1/lib/std/testing.zig:1158
#11 0x0000000001206d71 in testing.refAllDeclsRecursive__anon_28897 () at /home/username/Downloads/zig-x86_64-linux-0.14.1/lib/std/testing.zig:1158
#12 0x00000000011505f1 in testing.refAllDeclsRecursive__anon_13463 () at /home/username/Downloads/zig-x86_64-linux-0.14.1/lib/std/testing.zig:1158
#13 0x0000000001206d71 in testing.refAllDeclsRecursive__anon_28897 () at /home/username/Downloads/zig-x86_64-linux-0.14.1/lib/std/testing.zig:1158
#14 0x00000000011505f1 in testing.refAllDeclsRecursive__anon_13463 () at /home/username/Downloads/zig-x86_64-linux-0.14.1/lib/std/testing.zig:1158
#15 0x0000000001206d71 in testing.refAllDeclsRecursive__anon_28897 () at /home/username/Downloads/zig-x86_64-linux-0.14.1/lib/std/testing.zig:1158
#16 0x00000000011505f1 in testing.refAllDeclsRecursive__anon_13463 () at /home/username/Downloads/zig-x86_64-linux-0.14.1/lib/std/testing.zig:1158
#17 0x0000000001206d71 in testing.refAllDeclsRecursive__anon_28897 () at /home/username/Downloads/zig-x86_64-linux-0.14.1/lib/std/testing.zig:1158
#18 0x00000000011505f1 in testing.refAllDeclsRecursive__anon_13463 () at /home/username/Downloads/zig-x86_64-linux-0.14.1/lib/std/testing.zig:1158
#19 0x0000000001206d71 in testing.refAllDeclsRecursive__anon_28897 () at /home/username/Downloads/zig-x86_64-linux-0.14.1/lib/std/testing.zig:1158
...
</code></pre></div>



<a name="531352523"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/531352523" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#531352523">(Jul 28 2025 at 12:10)</a>:</h4>
<p><code>refAllDeclsRecursive</code> true to its name :p</p>



<a name="531379992"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/531379992" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#531379992">(Jul 28 2025 at 14:06)</a>:</h4>
<p><code>testing.refAllDeclsRecursive(@import("check"));</code> in <code>src/test.zig</code> is causing a cycle through <code>check/Mod.zig</code></p>



<a name="531475519"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/531475519" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#531475519">(Jul 28 2025 at 22:47)</a>:</h4>
<p>Curious, I thought it was fine to make modules that reference themselves.</p>



<a name="531475941"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/531475941" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#531475941">(Jul 28 2025 at 22:51)</a>:</h4>
<p>I'm definitely not confident in how we should properly setup zig modules and tests, like the folder structure basics etc. I thought I had a reasonable grasp, but I don't want to set things up the wrong way. </p>
<p>I need to dig into this a bit more I think. I'll drop a message in the Zig discord and see if anyone there has some time to provide some guidance.</p>



<a name="531478467"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/531478467" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#531478467">(Jul 28 2025 at 23:14)</a>:</h4>
<p><span class="user-mention" data-user-id="361169">@Anton</span> thank you. I've got the tests all passing again now.</p>



<a name="531479565"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/531479565" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#531479565">(Jul 28 2025 at 23:24)</a>:</h4>
<p>I'm manually checking that all our tests are actually being ran with <code>zig build test</code> I've found a few places where they weren't.</p>



<a name="531479733"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/531479733" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#531479733">(Jul 28 2025 at 23:26)</a>:</h4>
<p>For example the builtins weren't being tested, so I've had to hack a few TODO's in there for now to get that passing. But we're not using these yet and they need a refactor so we can clean that up/resolve it then.</p>



<a name="531480475"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/531480475" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#531480475">(Jul 28 2025 at 23:32)</a>:</h4>
<p>The biggest problem is that the tests in our "base" module haven't been running <span aria-label="sweat smile" class="emoji emoji-1f605" role="img" title="sweat smile">:sweat_smile:</span></p>



<a name="531480603"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/531480603" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#531480603">(Jul 28 2025 at 23:33)</a>:</h4>
<p>If I make "base" use the <code>testing.refAllDeclsRecursive</code> we get this error... which I suspect means we need to upgrade our zig version because we aren't using <code>@fence</code> anywhere.</p>
<div class="codehilite"><pre><span></span><code>$ zig build test
test
└─ run echo
   └─ run test
      └─ zig test Debug native 1 errors
/Users/luke/zig-macos-aarch64-0.14.0/lib/std/atomic.zig:13:27: error: @fence is deprecated, use other atomics to establish ordering
        pub const fence = @compileError(&quot;@fence is deprecated, use other atomics to establish ordering&quot;);
                          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
</code></pre></div>



<a name="531482464"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/531482464" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#531482464">(Jul 28 2025 at 23:51)</a>:</h4>
<p>Tests for <code>src/serialization/CompactWriter.zig</code> were also not running...</p>



<a name="531487444"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/531487444" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#531487444">(Jul 29 2025 at 00:41)</a>:</h4>
<p>I've done the best I can restoring all the tests in <a href="https://github.com/roc-lang/roc/pull/8124">https://github.com/roc-lang/roc/pull/8124</a></p>



<a name="531487510"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/531487510" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#531487510">(Jul 29 2025 at 00:42)</a>:</h4>
<p>I'm not happy with how the tests are set up or that this happened or regressed in this way.</p>



<a name="531487578"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/531487578" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#531487578">(Jul 29 2025 at 00:42)</a>:</h4>
<p><span class="user-mention" data-user-id="281383">@Richard Feldman</span> I basically neutered CompactWriter so that will need to be fixed.</p>



<a name="531487618"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/531487618" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#531487618">(Jul 29 2025 at 00:43)</a>:</h4>
<p>To be fair, I pretty sure it was said that <code>testing.refAllDeclsRecursive</code> is not advised to be used at all. It is more a hack than something proper. I think in the actual zig codebase they just leave dead code dead. As long as you have actual usage of code it will stay live and tested.</p>



<a name="531487626"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/531487626" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#531487626">(Jul 29 2025 at 00:43)</a>:</h4>
<p>But yeah, it is a weird setup</p>



<a name="531487632"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/531487632" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#531487632">(Jul 29 2025 at 00:43)</a>:</h4>
<p>not sure what is best</p>



<a name="531487810"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/531487810" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#531487810">(Jul 29 2025 at 00:45)</a>:</h4>
<p>It definitely feels like a hack. </p>
<p>I'm not happy with Zig's approach to dead code -- given the strict nature everywhere else. I feel like the should at least be a way to flag or check for it.</p>



<a name="531488107"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/531488107" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#531488107">(Jul 29 2025 at 00:47)</a>:</h4>
<p>totally agree</p>



<a name="531720016"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/531720016" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jared Ramirez <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#531720016">(Jul 30 2025 at 00:06)</a>:</h4>
<p><span class="user-mention silent" data-user-id="515757">Luke Boswell</span> <a href="#narrow/stream/395097-compiler-development/topic/casual.20conversation/near/531245189">said</a>:</p>
<blockquote>
<p>Instead of "Canonicalizer" what about shortening this and using "Czer" around the place?</p>
<p>I can't think of a nicer/shorter description. My issue with  "Canonicalizer" is just that it's long</p>
</blockquote>
<p>In my head “czer” reads as “Caesar”</p>



<a name="531728888"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/531728888" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#531728888">(Jul 30 2025 at 01:41)</a>:</h4>
<p>I read it as Czar <span aria-label="royal" class="emoji emoji-1fac5" role="img" title="royal">:royal:</span></p>



<a name="531729414"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/531729414" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#531729414">(Jul 30 2025 at 01:47)</a>:</h4>
<p>CI looks to be broken <span aria-label="tear" class="emoji emoji-1f972" role="img" title="tear">:tear:</span></p>



<a name="531729506"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/531729506" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#531729506">(Jul 30 2025 at 01:48)</a>:</h4>
<p>I restarted CI for <a href="https://github.com/roc-lang/roc/pull/8124">https://github.com/roc-lang/roc/pull/8124</a> but it failed straight away</p>



<a name="531729566"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/531729566" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#531729566">(Jul 30 2025 at 01:48)</a>:</h4>
<p>I'll try updating it and see if that helps</p>



<a name="531729888"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/531729888" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jared Ramirez <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#531729888">(Jul 30 2025 at 01:52)</a>:</h4>
<p>The word Czar is derived from Caesar!</p>



<a name="531731116"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/531731116" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#531731116">(Jul 30 2025 at 02:05)</a>:</h4>
<p>Does anyone have a linux machine and can repro/fix the issue in <a href="https://github.com/roc-lang/roc/pull/8124">https://github.com/roc-lang/roc/pull/8124</a> please?</p>



<a name="531732468"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/531732468" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#531732468">(Jul 30 2025 at 02:19)</a>:</h4>
<p>I think I got it. Pushed a fix and we'll see if CI's happy</p>



<a name="531735677"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/531735677" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#531735677">(Jul 30 2025 at 02:54)</a>:</h4>
<p>Unsuccessful so far <span aria-label="tear" class="emoji emoji-1f972" role="img" title="tear">:tear:</span></p>



<a name="531746653"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/531746653" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#531746653">(Jul 30 2025 at 04:43)</a>:</h4>
<p>Got it... merged <span aria-label="tada" class="emoji emoji-1f389" role="img" title="tada">:tada:</span></p>



<a name="531890688"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/531890688" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kiryl Dziamura <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#531890688">(Jul 30 2025 at 17:09)</a>:</h4>
<p><span class="user-mention silent" data-user-id="515757">Luke Boswell</span> <a href="#narrow/stream/395097-compiler-development/topic/casual.20conversation/near/531245189">said</a>:</p>
<blockquote>
<p>Instead of "Canonicalizer" what about shortening this and using "Czer" around the place?</p>
<p>I can't think of a nicer/shorter description. My issue with  "Canonicalizer" is just that it's long</p>
</blockquote>
<p>Czer looks like valid Polish <span aria-label="sweat smile" class="emoji emoji-1f605" role="img" title="sweat smile">:sweat_smile:</span><br>
There's also another option: c14n (for Canonicalization), but <code>can</code> is the best</p>



<a name="532241798"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/532241798" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#532241798">(Aug 01 2025 at 07:15)</a>:</h4>
<p><strong>Problem</strong>: Numbers display with unnecessary scientific notation</p>
<ul>
<li><code>3.14f64</code> shows as <code>3.14e0</code> instead of <code>3.14</code></li>
<li><code>1.5dec</code> shows as <code>1.5e0</code> instead of <code>1.5</code></li>
</ul>
<p><strong>Root Cause</strong>: Zig's default float formatting includes <code>e0</code> for whole decimal values</p>
<p>How do we feel about formatting numbers with the <code>e</code> included for now like zig?</p>



<a name="532243972"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/532243972" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#532243972">(Aug 01 2025 at 07:28)</a>:</h4>
<p>I'm running with that for now. We can leave number formatting for a future PR</p>



<a name="532251801"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/532251801" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#532251801">(Aug 01 2025 at 08:08)</a>:</h4>
<p>What should <code>!(1 + 2)</code> evaluate to in the interpreter?</p>



<a name="532255505"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/532255505" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#532255505">(Aug 01 2025 at 08:28)</a>:</h4>
<blockquote>
<p>What should <code>!(1 + 2)</code> evaluate to in the interpreter?</p>
</blockquote>
<p>A type error? <code>!</code> is for booleans right?</p>



<a name="532255923"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/532255923" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#532255923">(Aug 01 2025 at 08:30)</a>:</h4>
<p>We represent booleans as a scalar 1 or 0 currently. So I thought maybe anything non-zero is truthy</p>



<a name="532257018"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/532257018" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#532257018">(Aug 01 2025 at 08:37)</a>:</h4>
<p>Hmm, I don't think we should represent booleans as 1 or 0 long term. It's not in the spirit of strict typing and many newer languages don't allow numbers for booleans anymore, I think it's pretty widely considered to be a mistake to do it like this, the way older languages did.</p>



<a name="532260090"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/532260090" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#532260090">(Aug 01 2025 at 08:55)</a>:</h4>
<p>Some reasons for this; if your program does calculations (addition, substraction...) with what you believe should be booleans, something is going wrong and you need to know about it. If a function that expects a boolean is given 7 something has gone wrong as well, etc.</p>



<a name="532269310"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/532269310" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#532269310">(Aug 01 2025 at 09:48)</a>:</h4>
<p>Yeah -- I feel the same. I've left them as "truthy" in my PR for now as it's working -- and I can move on to the next things. We can change the implementation easily enough.</p>



<a name="532272606"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/532272606" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#532272606">(Aug 01 2025 at 10:07)</a>:</h4>
<p>I think for the interpreter heap we will be using RocStr and RocList etc and just providing a zig allocator. I'm going to continue my refactor for <code>roc_alloc</code> and friends in the builtins in preparation to support strings and lists and other refcounted things in the interpreter.</p>



<a name="532275965"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/532275965" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#532275965">(Aug 01 2025 at 10:29)</a>:</h4>
<p>Seems reasonable</p>



<a name="532281723"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/532281723" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#532281723">(Aug 01 2025 at 11:04)</a>:</h4>
<p>yeah this is just a type checking issue. What should happen here is: </p>
<ul>
<li>type checker unifies <code>!</code> with a number and sees that it's a mismatch</li>
<li>a <code>Problem</code> gets appended for that and the Can node gets replaced with a crash</li>
<li>if you're running the program anyway despite the compile-time error, when the interpreter gets here it encounters the crash node and crashes</li>
</ul>



<a name="532470922"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/532470922" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#532470922">(Aug 02 2025 at 16:55)</a>:</h4>
<p>Should/does Roc do overflow checking? e.g. disallow <code>0u32 - 1u32</code>? Or should that just wrap?</p>



<a name="532471554"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/532471554" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#532471554">(Aug 02 2025 at 17:03)</a>:</h4>
<p>we crash on overflow</p>



<a name="532471586"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/532471586" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#532471586">(Aug 02 2025 at 17:04)</a>:</h4>
<p>We also have explicit num functions to wrap, saturate, or return a result</p>



<a name="532492194"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/532492194" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#532492194">(Aug 02 2025 at 22:13)</a>:</h4>
<p>If I write this in the REPL</p>
<div class="codehilite" data-code-language="repl"><pre><span></span><code>&gt;&gt; count = 42
&gt;&gt; "Count: ${count}"
</code></pre></div>
<p>Should we automatically call the number's <code>to_str</code> method under the hood and display <code>"Count: 42"</code> or would you expect a type mismatch?</p>



<a name="532493763"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/532493763" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#532493763">(Aug 02 2025 at 22:38)</a>:</h4>
<p>Personally, I've always wanted <code>to_str</code> though I know previously it was avoided cause we thought it best to force the user to explicitly pick formatting options and what not. Thus they need more control over the functional called...</p>
<p>For the repl, I think it should definitely match whatever we do for the langauge as a whole.</p>



<a name="532503927"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/532503927" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#532503927">(Aug 03 2025 at 01:24)</a>:</h4>
<p>I don't think we should do that automatic conversion</p>



<a name="532503935"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/532503935" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#532503935">(Aug 03 2025 at 01:25)</a>:</h4>
<p>we've talked about it before</p>



<a name="533073068"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/533073068" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#533073068">(Aug 06 2025 at 10:36)</a>:</h4>
<p>I've been battling with linking issues on Windows, I'm deep down a rabbit hole and I've just realised something and I'm looking for some clarity. </p>
<p>Is there any reason we aren't just compiling the host to a fully linked executable that just has the 1 undefined symbol for roc_entrypoint -- and then using LLD to link our roc_shim.a library that provides just that symbol? </p>
<p>Am I missing something obvious? this feels <em>way</em> simpler than what I have been trying</p>



<a name="533073129"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/533073129" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#533073129">(Aug 06 2025 at 10:36)</a>:</h4>
<p><span class="user-mention" data-user-id="281383">@Richard Feldman</span></p>



<a name="533073138"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/533073138" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#533073138">(Aug 06 2025 at 10:36)</a>:</h4>
<p><span class="user-mention" data-user-id="343810">@Brendan Hansknecht</span></p>



<a name="533078923"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/533078923" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#533078923">(Aug 06 2025 at 11:12)</a>:</h4>
<p><span class="user-mention silent" data-user-id="515757">Luke Boswell</span> <a href="#narrow/stream/395097-compiler-development/topic/casual.20conversation/near/533073068">said</a>:</p>
<blockquote>
<p>Is there any reason we aren't just compiling the host to a fully linked executable that just has the 1 undefined symbol for roc_entrypoint -- and then using LLD to link our roc_shim.a library that provides just that symbol? </p>
<p>Am I missing something obvious? this feels <em>way</em> simpler than what I have been trying</p>
</blockquote>
<p>yeah the short answer is that it doesn't work with lld</p>



<a name="533078958"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/533078958" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#533078958">(Aug 06 2025 at 11:13)</a>:</h4>
<p>or any general-purpose linker</p>



<a name="533079009"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/533079009" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#533079009">(Aug 06 2025 at 11:13)</a>:</h4>
<p>this was basically the approach the surgical linker used</p>



<a name="533080602"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/533080602" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#533080602">(Aug 06 2025 at 11:23)</a>:</h4>
<p>Ah that's a shame... for a moment there I was getting excited</p>



<a name="533081208"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/533081208" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#533081208">(Aug 06 2025 at 11:27)</a>:</h4>
<p>yeah I went through those stages of grief back in the day <span aria-label="laughing" class="emoji emoji-1f606" role="img" title="laughing">:laughing:</span></p>



<a name="533081371"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/533081371" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#533081371">(Aug 06 2025 at 11:28)</a>:</h4>
<p>what are the linking symptoms you're seeing?</p>



<a name="533083182"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/533083182" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#533083182">(Aug 06 2025 at 11:39)</a>:</h4>
<p>Getting zig to put the crt runtime setup stuff into a library so we dont have to tell LLD about a custom entrypoint when linking. </p>
<p>We can do it using a separate C file as a shim, but I feel like zig should be able to define the main entrypoint and have all the setup there even though it's a library.</p>
<p>The goal is to have a setup that will be ergonomic for platform authors, but also doesn't rquire anything but default libraries to link it all together. </p>
<p>I think I may have had a workable aolution before I went on a tangent trying to link an executable. I'll revisit tomorrow now I think.</p>



<a name="533099665"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/533099665" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#533099665">(Aug 06 2025 at 13:11)</a>:</h4>
<p>so Zig's first commit was 10 years ago yesterday! <span aria-label="tada" class="emoji emoji-1f389" role="img" title="tada">:tada:</span></p>



<a name="533099796"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/533099796" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#533099796">(Aug 06 2025 at 13:12)</a>:</h4>
<p>a nice reminder of how long it takes for a language to go from "exists, but unknown" to "exists, and obscure" to "exists, and niche" let alone mainstream <span aria-label="smile" class="emoji emoji-1f604" role="img" title="smile">:smile:</span></p>



<a name="533193610"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/533193610" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#533193610">(Aug 06 2025 at 23:45)</a>:</h4>
<p>Yeah, I think we previously got zig to put main and all the runtime things into a static library</p>



<a name="533193614"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/533193614" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#533193614">(Aug 06 2025 at 23:45)</a>:</h4>
<p>And that made linking simple</p>



<a name="533193623"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/533193623" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#533193623">(Aug 06 2025 at 23:45)</a>:</h4>
<p>I don't think we ever got rust to do it though</p>



<a name="533193634"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/533193634" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#533193634">(Aug 06 2025 at 23:45)</a>:</h4>
<p>Thus the c shim</p>



<a name="533193647"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/533193647" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#533193647">(Aug 06 2025 at 23:45)</a>:</h4>
<p>Can you remember where we did that? was it working on Windows?</p>



<a name="533193830"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/533193830" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#533193830">(Aug 06 2025 at 23:48)</a>:</h4>
<p>I don't think it was ever tested on Windows... Not sure though</p>



<a name="533213682"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/533213682" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#533213682">(Aug 07 2025 at 04:14)</a>:</h4>
<p><span class="user-mention silent" data-user-id="281383">Richard Feldman</span> <a href="#narrow/channel/395097-compiler-development/topic/casual.20conversation/near/533099665">said</a>:</p>
<blockquote>
<p>so Zig's first commit was 10 years ago yesterday! <span aria-label="tada" class="emoji emoji-1f389" role="img" title="tada">:tada:</span></p>
</blockquote>
<p>What's a Lizards favourite type of cake?. ...</p>



<a name="533213884"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/533213884" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#533213884">(Aug 07 2025 at 04:17)</a>:</h4>
<p>Ice cream cake... because lizards are cold-blooded <span aria-label="smiley" class="emoji emoji-1f603" role="img" title="smiley">:smiley:</span></p>



<a name="533220930"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/533220930" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#533220930">(Aug 07 2025 at 05:44)</a>:</h4>
<p><a href="/user_uploads/22008/YKooxPN5FmszI5_3_Z_9Lm_h/image.png">image.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/22008/YKooxPN5FmszI5_3_Z_9Lm_h/image.png" title="image.png"><img data-original-content-type="image/png" data-original-dimensions="561x344" src="/user_uploads/thumbnail/22008/YKooxPN5FmszI5_3_Z_9Lm_h/image.png/840x560.webp"></a></div>



<a name="533843582"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/533843582" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#533843582">(Aug 11 2025 at 18:11)</a>:</h4>
<p>I'm excited for the possibilities that the interpreter creates for improving the debugging experience :)<br>
It feels like debugging tools are an afterthought in every language I've used.</p>



<a name="533843631"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/533843631" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#533843631">(Aug 11 2025 at 18:12)</a>:</h4>
<p>yeah we can do some wild stuff</p>



<a name="533843690"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/533843690" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#533843690">(Aug 11 2025 at 18:12)</a>:</h4>
<p>should also be a lot easier to do stuff like this when <code>expect</code> fails - <a href="https://github.com/power-assert-js/power-assert">https://github.com/power-assert-js/power-assert</a></p>



<a name="533843798"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/533843798" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#533843798">(Aug 11 2025 at 18:13)</a>:</h4>
<p>I really want that "ASCII art diagram" sort of thing to be what the end user sees whenever an <code>expect</code> fails, where we show all the intermediate values on every part of the expression in the <code>expect</code> (or the final expression in the block, if <code>expect</code> was given a block)</p>



<a name="534814766"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/534814766" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#534814766">(Aug 17 2025 at 10:27)</a>:</h4>
<p>Anyone have thoughts on Microsoft not replacing the recently-resigned GitHub CEO and instead having GitHub report directly to their CoreAI division?</p>
<p>It seems to mean that they now think of GitHub as solely a repository for them to train CoPilot on.</p>



<a name="534842529"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/534842529" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jasper Woudenberg <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#534842529">(Aug 17 2025 at 19:36)</a>:</h4>
<p>I've started moving my personal repo's to sourcehut a couple months back, as a way to support one of the alternatives to Github. I think it'd be healthy if the code forge space moves to a place where there's no longer a single dominant player.</p>
<p>I haven't yet had the chance to collaborate on sourcehut with others using the the git/email flow they use. It's the thing that most turned me off from trying out sourcehut before, though I've kind of come to the point that I want to give it a serious try. One big advantage of the e-mail based collaboration approach is that it doesn't require contributors to a project to have accounts on the forge where the project is hosted, so e-mail based collaboration works well in a possible future where open source code is hosted across many forges.</p>



<a name="544353117"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/544353117" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#544353117">(Oct 11 2025 at 21:53)</a>:</h4>
<p>Does the zig compiler support multiline strings yet?</p>



<a name="544387794"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/544387794" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Fabian Schmalzried <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#544387794">(Oct 12 2025 at 10:09)</a>:</h4>
<p>Yes, I think so.</p>



<a name="544412914"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/544412914" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#544412914">(Oct 12 2025 at 16:28)</a>:</h4>
<p>Do you know what syntax we landed on?</p>



<a name="544414318"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/544414318" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#544414318">(Oct 12 2025 at 16:47)</a>:</h4>
<p><code>\\</code> just like Zig, although I think right now we have <code>"""</code></p>



<a name="544434235"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/544434235" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#544434235">(Oct 12 2025 at 22:53)</a>:</h4>
<p><a href="https://github.com/roc-lang/roc/pull/8289">https://github.com/roc-lang/roc/pull/8289</a></p>



<a name="544439733"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/544439733" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#544439733">(Oct 13 2025 at 00:48)</a>:</h4>
<p>awesome, thanks!</p>



<a name="545160757"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/545160757" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#545160757">(Oct 16 2025 at 03:28)</a>:</h4>
<p>Randomly spotted a small typo from <a href="https://github.com/roc-lang/roc/issues/8267">#8267</a> (fix in <a href="https://github.com/roc-lang/roc/issues/8298">#8298</a>).</p>
<p>I suspect a contributing factor to that not being noticed is the very large snapshot diff that got produced there lead to a lot of things to review - and so of course it's less likely issues will be caught.</p>
<p>The bulk of the snapshot diff there is coming from adjusting the line/col indicators in snapshots in the TOKENS and PARSE sections, and I'd contend that these are pretty low-value parts of the diff.</p>



<a name="545160826"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/545160826" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#545160826">(Oct 16 2025 at 03:29)</a>:</h4>
<p>I'd like to suggest that, by default at least, TOKENS and PARSE sections in snapshots should be without any line/col numbers</p>



<a name="545160869"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/545160869" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#545160869">(Oct 16 2025 at 03:30)</a>:</h4>
<p>This will remove a lot of snapshot churn and let us focus review effort on things that matter (more).</p>



<a name="545160871"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/545160871" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#545160871">(Oct 16 2025 at 03:30)</a>:</h4>
<p>Thoughts?</p>



<a name="545167818"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/545167818" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#545167818">(Oct 16 2025 at 04:32)</a>:</h4>
<p>Implemented here: <a href="https://github.com/roc-lang/roc/pull/8299">https://github.com/roc-lang/roc/pull/8299</a></p>



<a name="545681007"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/545681007" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jared Ramirez <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#545681007">(Oct 17 2025 at 20:06)</a>:</h4>
<p>this officially type checks in my static dispatch types branch <span aria-label="confetti" class="emoji emoji-1f38a" role="img" title="confetti">:confetti:</span></p>
<div class="codehilite"><pre><span></span><code>StaticDispatchBasic := [Val(Str)].{
  to_str : StaticDispatchBasic -&gt; Str
  to_str = |StaticDispatchBasic.Val(x)| x
}

helper : a -&gt; Str where [a.to_str : a -&gt; Str]
helper = |a| a.to_str()

main : Str
main = helper(StaticDispatchBasic.Val(&quot;hello&quot;))
</code></pre></div>



<a name="545819644"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/545819644" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Notification Bot <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#545819644">(Oct 19 2025 at 10:24)</a>:</h4>
<p><span class="user-mention silent" data-user-id="456814">Christian Dereck</span> has marked this topic as resolved.</p>



<a name="545824674"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/545824674" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Notification Bot <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#545824674">(Oct 19 2025 at 11:53)</a>:</h4>
<p><span class="user-mention silent" data-user-id="361169">Anton</span> has marked this topic as unresolved.</p>



<a name="545863638"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/545863638" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#545863638">(Oct 19 2025 at 23:19)</a>:</h4>
<p>So hyped seeing all these features rolling in... feels like we're getting close <img alt=":yay:" class="emoji" src="https://avatars.zulip.com/22008/emoji/images/e16c6dae.gif" title="yay"> :</p>



<a name="547167160"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/547167160" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#547167160">(Oct 26 2025 at 23:25)</a>:</h4>
<p>Random PSA on serialization and stability of structs.</p>
<p>We have some structs with labels like:</p>
<blockquote>
<p>/// NOTE: Field order matters for cross-platform compatibility! Keep <code>module_kind</code> at the end.</p>
</blockquote>
<p>In zig, this is meaningless. Zig reorders fields by default.<br>
The struct has to either be a <code>packed struct</code> or an <code>extern struct</code> to avoid re-ordering.<br>
If we have any serialization bugs, this could be why.</p>



<a name="547167188"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/547167188" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#547167188">(Oct 26 2025 at 23:26)</a>:</h4>
<p>Good pickup</p>



<a name="547168587"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/547168587" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#547168587">(Oct 26 2025 at 23:55)</a>:</h4>
<p>TIL, thanks! Feel free to change that comment <span aria-label="smile" class="emoji emoji-1f604" role="img" title="smile">:smile:</span></p>



<a name="547168723"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/547168723" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#547168723">(Oct 26 2025 at 23:58)</a>:</h4>
<p><a href="https://github.com/roc-lang/roc-playground/pull/20">roc-playground #20</a> &lt;-- FYI I updated the playground to latest main, everything looks to be working nicely <span aria-label="smiley" class="emoji emoji-1f603" role="img" title="smiley">:smiley:</span></p>



<a name="547471937"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/547471937" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Fabian Schmalzried <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#547471937">(Oct 28 2025 at 11:46)</a>:</h4>
<p><code>roc check iDoNotExist.roc</code> gives no errors. It's probably just missing a report for that case, but I assume that there are several errors that are just ignored. Should I try to add a generic error report to make it visible if the check fails but there are no reports?</p>



<a name="547472502"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/casual%20conversation/near/547472502" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/casual.20conversation.html#547472502">(Oct 28 2025 at 11:49)</a>:</h4>
<p>yeah would be great to have a dedicated error for that case!</p>



<hr><p>Last updated: Nov 01 2025 at 12:13 UTC</p>
</html>