<html>
<head><meta charset="utf-8"><title>zig compiler - parser diagnostics · compiler development · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/index.html">compiler development</a></h2>
<h3>Topic: <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20parser.20diagnostics.html">zig compiler - parser diagnostics</a></h3>

<hr>

<base href="https://roc.zulipchat.com">

<head><link href="https://roc-lang.github.io/zulip-export/style.css" rel="stylesheet"></head>

<a name="499146924"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20parser%20diagnostics/near/499146924" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20parser.20diagnostics.html#499146924">(Feb 12 2025 at 04:33)</a>:</h4>
<p>For the parser (and the tokenizer, really), I've been thinking about a couple things: (1) I'd like to force as-much-as-possible, for us to do tolerant-parsing: mark a node as malformed and move on, and (2) how to record diagnostics.</p>
<p>Those don't seem related on the surface, but I think they actually are.</p>
<p>Imagine, for a moment, that the parser didn't have a separate side channel to write diagnostic messages to. And, when we hit an error, we should probably be putting some kind of 'malformed' node in the tree.</p>
<p>Why don't we make those the same thing? i.e. make the _only_ way to report diagnostics be to put a 'malformed' node into the tree?</p>
<p>This way we can structurally guarantee that we're doing our best-effort at error recovery, and it also simplifies the interface.</p>
<p>We can do the same thing for the tokenizer - tokenizer diagnostics are simply error tokens inserted into that stream. When the parser sees one, it dutifully puts a malformed_token node into the tree and does its error recovery.</p>
<p>At the end of parsing we can quickly grab these back out by checking the list of nodes with SIMD instructions to fetch the list of diagnostics out of the associated data for each malformed/malformed_token node. If we simply store a bool for whether we encountered an error during parsing, we can skip this step in the happy path.</p>
<p>Thoughts? (<span class="user-mention" data-user-id="781658">@Anthony Bullard</span>?)</p>



<a name="499147853"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20parser%20diagnostics/near/499147853" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20parser.20diagnostics.html#499147853">(Feb 12 2025 at 04:44)</a>:</h4>
<p>this sounds rad</p>



<a name="499147906"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20parser%20diagnostics/near/499147906" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20parser.20diagnostics.html#499147906">(Feb 12 2025 at 04:45)</a>:</h4>
<p>the nodes in later stages might be too small for the amount of error context we'd want to include, but seems like it should work great in parsing!</p>



<a name="499147913"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20parser%20diagnostics/near/499147913" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20parser.20diagnostics.html#499147913">(Feb 12 2025 at 04:45)</a>:</h4>
<p>single source of truth <span aria-label="muscle" class="emoji emoji-1f4aa" role="img" title="muscle">:muscle:</span></p>



<a name="499148552"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20parser%20diagnostics/near/499148552" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20parser.20diagnostics.html#499148552">(Feb 12 2025 at 04:52)</a>:</h4>
<p>The same thing can probably work for canonicalization/desugaring</p>



<a name="499148568"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20parser%20diagnostics/near/499148568" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20parser.20diagnostics.html#499148568">(Feb 12 2025 at 04:52)</a>:</h4>
<p>Agree it gets messy as you get deeper into the compiler</p>



<a name="499149199"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20parser%20diagnostics/near/499149199" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20parser.20diagnostics.html#499149199">(Feb 12 2025 at 05:00)</a>:</h4>
<p>Looking thru the current tokenizer diagnostics, I think this works for most of them but not all</p>



<a name="499149227"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20parser%20diagnostics/near/499149227" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20parser.20diagnostics.html#499149227">(Feb 12 2025 at 05:00)</a>:</h4>
<p>For anything that's _actually_ malformed, we should do this</p>



<a name="499149717"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20parser%20diagnostics/near/499149717" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20parser.20diagnostics.html#499149717">(Feb 12 2025 at 05:02)</a>:</h4>
<p>There are some things where we could in principle let the parser ignore the problem and just make a "side-note" - e.g. MisplacedCarriageReturn, AsciiControl, LeadingZero, and UppercaseBase, all of which are really "warnings" rather than errors.</p>



<a name="499149807"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20parser%20diagnostics/near/499149807" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20parser.20diagnostics.html#499149807">(Feb 12 2025 at 05:03)</a>:</h4>
<p>"hey this looks funky but I'll let it slide"</p>



<a name="499150122"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20parser%20diagnostics/near/499150122" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20parser.20diagnostics.html#499150122">(Feb 12 2025 at 05:07)</a>:</h4>
<p>Actually - if the formatter is just going to fix something up (e.g. fix the misplaced carriage return), and someone has "format on save" hooked up, it feels kinda silly to be reporting those kind of warnings</p>



<a name="499219339"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20parser%20diagnostics/near/499219339" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20parser.20diagnostics.html#499219339">(Feb 12 2025 at 12:26)</a>:</h4>
<p>I think it's important for CI</p>



<a name="499219579"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20parser%20diagnostics/near/499219579" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20parser.20diagnostics.html#499219579">(Feb 12 2025 at 12:27)</a>:</h4>
<p>hm, actually I guess we could have <code>roc format --check</code> take care of reporting those? <span aria-label="thinking" class="emoji emoji-1f914" role="img" title="thinking">:thinking:</span></p>



<a name="499219845"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20parser%20diagnostics/near/499219845" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20parser.20diagnostics.html#499219845">(Feb 12 2025 at 12:28)</a>:</h4>
<p>eh, but those are actual mistakes, not stylistic choices, and <code>roc check</code> should tell you about mistakes</p>



<a name="499219972"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20parser%20diagnostics/near/499219972" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20parser.20diagnostics.html#499219972">(Feb 12 2025 at 12:29)</a>:</h4>
<p><code>roc format --check</code> should just tell you about when your code is off stylistically</p>



<a name="499350315"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20parser%20diagnostics/near/499350315" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20parser.20diagnostics.html#499350315">(Feb 12 2025 at 23:51)</a>:</h4>
<p>Can we make them malformed nodes that store the issue side band?</p>



<a name="499350345"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20parser%20diagnostics/near/499350345" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20parser.20diagnostics.html#499350345">(Feb 12 2025 at 23:51)</a>:</h4>
<p>That way, you still are required to have the node, but no fancy check or simd required</p>



<a name="499350372"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20parser%20diagnostics/near/499350372" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20parser.20diagnostics.html#499350372">(Feb 12 2025 at 23:51)</a>:</h4>
<p>Just look at the length of the sideband data structure</p>



<a name="499350443"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20parser%20diagnostics/near/499350443" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20parser.20diagnostics.html#499350443">(Feb 12 2025 at 23:52)</a>:</h4>
<p>Can literally make the only way to add something to the data structure is to generate a malformed node at the same time</p>



<a name="499350534"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20parser%20diagnostics/near/499350534" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20parser.20diagnostics.html#499350534">(Feb 12 2025 at 23:53)</a>:</h4>
<p>For later stages, I think we just have to map all of these nodes to the crash builtin. Then the build stage of the compiler literally doesn't need to know anything about the malformed nodes or concept</p>



<a name="499350585"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20parser%20diagnostics/near/499350585" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20parser.20diagnostics.html#499350585">(Feb 12 2025 at 23:53)</a>:</h4>
<p>So the mapping to crashes would be the final stage of check (or first stage of build)</p>



<a name="499350679"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20parser%20diagnostics/near/499350679" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20parser.20diagnostics.html#499350679">(Feb 12 2025 at 23:54)</a>:</h4>
<p>Might be nice to do that stage before running the interpreter anyway, but that is optional</p>



<a name="499351046"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20parser%20diagnostics/near/499351046" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20parser.20diagnostics.html#499351046">(Feb 12 2025 at 23:58)</a>:</h4>
<p>It'd be nice to show a message saying "you got 32 compiler problems, that's bad!"</p>



<a name="499351068"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20parser%20diagnostics/near/499351068" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20parser.20diagnostics.html#499351068">(Feb 12 2025 at 23:59)</a>:</h4>
<p>And I don't know how to do that if we immediately convert the CompilerProblem nodes into crashes</p>



<a name="499351236"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20parser%20diagnostics/near/499351236" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20parser.20diagnostics.html#499351236">(Feb 13 2025 at 00:00)</a>:</h4>
<p>Oh, this wouldn't be immediately. They would be malformed nodes through check and check can report all these things. The backend just doesn't care about frontend compiler problems that should turn into crashes so that roc can still run in a partially broken state.</p>



<a name="499351291"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20parser%20diagnostics/near/499351291" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20parser.20diagnostics.html#499351291">(Feb 13 2025 at 00:00)</a>:</h4>
<p>Also, I think the nodes above aren't compiler problems</p>



<a name="499351298"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20parser%20diagnostics/near/499351298" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20parser.20diagnostics.html#499351298">(Feb 13 2025 at 00:00)</a>:</h4>
<p>They are parse issues</p>



<a name="499351321"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20parser%20diagnostics/near/499351321" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20parser.20diagnostics.html#499351321">(Feb 13 2025 at 00:00)</a>:</h4>
<p>Aren't compiler problems things we plan to ban via fuzzing?</p>



<a name="499351344"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20parser%20diagnostics/near/499351344" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20parser.20diagnostics.html#499351344">(Feb 13 2025 at 00:01)</a>:</h4>
<p>They are the guaranteed failure cases</p>



<a name="499351882"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20parser%20diagnostics/near/499351882" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20parser.20diagnostics.html#499351882">(Feb 13 2025 at 00:05)</a>:</h4>
<p>Yes, earlier phase malformed nodes should get converted to crashes</p>



<a name="499351974"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20parser%20diagnostics/near/499351974" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20parser.20diagnostics.html#499351974">(Feb 13 2025 at 00:06)</a>:</h4>
<p><span class="user-mention silent" data-user-id="343810">Brendan Hansknecht</span> <a href="#narrow/channel/395097-compiler-development/topic/zig.20compiler.20-.20parser.20diagnostics/near/499351321">said</a>:</p>
<blockquote>
<p>Aren't compiler problems things we plan to ban via fuzzing?</p>
</blockquote>
<p>Ideally yes, but to plan for the worst, let's have good error messages anyway</p>



<a name="499356144"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20parser%20diagnostics/near/499356144" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20parser.20diagnostics.html#499356144">(Feb 13 2025 at 00:49)</a>:</h4>
<p>Yeah, for sure. But I don't see how that relates to this thread</p>



<a name="499356303"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20parser%20diagnostics/near/499356303" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20parser.20diagnostics.html#499356303">(Feb 13 2025 at 00:50)</a>:</h4>
<p>We easily could collect compiler problems after each stage and aggregate them up. Given they should be exceptionally rare, it is even fine if they have more costly handling.</p>



<a name="499763506"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20parser%20diagnostics/near/499763506" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20parser.20diagnostics.html#499763506">(Feb 14 2025 at 14:58)</a>:</h4>
<p>Hey y'all, I've been in bed with the flu for the past 4 days.  I apologize for not communicating better but it hit me suddenly and hard.</p>



<a name="499763604"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20parser%20diagnostics/near/499763604" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20parser.20diagnostics.html#499763604">(Feb 14 2025 at 14:59)</a>:</h4>
<p>I should have my conflicts resolved and my parser PR ready to merge sometime today.  But I also have a LOT of work to catch back up on today</p>



<a name="499778252"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20parser%20diagnostics/near/499778252" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20parser.20diagnostics.html#499778252">(Feb 14 2025 at 16:08)</a>:</h4>
<p>No worries! Sounds like you were doing what you should have been doing - resting!</p>



<a name="499780440"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20parser%20diagnostics/near/499780440" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20parser.20diagnostics.html#499780440">(Feb 14 2025 at 16:20)</a>:</h4>
<p>sorry to hear about the flu - hope you're feeling better, and don't worry about PRs. They can wait. <span aria-label="big smile" class="emoji emoji-1f604" role="img" title="big smile">:big_smile:</span></p>



<a name="499925016"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20parser%20diagnostics/near/499925016" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20parser.20diagnostics.html#499925016">(Feb 15 2025 at 15:51)</a>:</h4>
<p><a href="/user_uploads/22008/qZPxOsUeBDRhAM38-LnXvwKt/Screenshot-2025-02-15-at-9.49.31-AM.png">Screenshot 2025-02-15 at 9.49.31 AM.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/22008/qZPxOsUeBDRhAM38-LnXvwKt/Screenshot-2025-02-15-at-9.49.31-AM.png" title="Screenshot 2025-02-15 at 9.49.31 AM.png"><img data-original-content-type="image/png" data-original-dimensions="742x981" src="/user_uploads/thumbnail/22008/qZPxOsUeBDRhAM38-LnXvwKt/Screenshot-2025-02-15-at-9.49.31-AM.png/840x560.webp"></a></div><p>Has anyone ever seen GIt have behavior like this?  My editor has saved buffers for Parser.zig and IR.zig, and <code>git</code> knows about them, but they don't show up in my filesystem.  I don't think I've seen this in my 13 years of using Git.</p>



<a name="499925915"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20parser%20diagnostics/near/499925915" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20parser.20diagnostics.html#499925915">(Feb 15 2025 at 16:02)</a>:</h4>
<p>case sensitivity?</p>



<a name="499925989"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20parser%20diagnostics/near/499925989" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20parser.20diagnostics.html#499925989">(Feb 15 2025 at 16:02)</a>:</h4>
<p><code>ir.zig</code> and <code>IR.zig</code> are the same file on macOS, but not on Linux</p>



<a name="499926004"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20parser%20diagnostics/near/499926004" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20parser.20diagnostics.html#499926004">(Feb 15 2025 at 16:02)</a>:</h4>
<p>That's right</p>



<a name="499926028"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20parser%20diagnostics/near/499926028" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20parser.20diagnostics.html#499926028">(Feb 15 2025 at 16:03)</a>:</h4>
<p>I hit exactly that when I rebased your PR</p>



<a name="499926032"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20parser%20diagnostics/near/499926032" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20parser.20diagnostics.html#499926032">(Feb 15 2025 at 16:03)</a>:</h4>
<p>Well I'm trying to figure out what to do here...</p>



<a name="499926056"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20parser%20diagnostics/near/499926056" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20parser.20diagnostics.html#499926056">(Feb 15 2025 at 16:03)</a>:</h4>
<p>Oh, you already rebased it?</p>



<a name="499926110"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20parser%20diagnostics/near/499926110" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20parser.20diagnostics.html#499926110">(Feb 15 2025 at 16:04)</a>:</h4>
<p>I just saw your DM</p>



<a name="499926141"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20parser%20diagnostics/near/499926141" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20parser.20diagnostics.html#499926141">(Feb 15 2025 at 16:04)</a>:</h4>
<p>How did you fix this?</p>



<a name="499926143"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20parser%20diagnostics/near/499926143" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20parser.20diagnostics.html#499926143">(Feb 15 2025 at 16:04)</a>:</h4>
<p><a href="https://github.com/roc-lang/roc/pull/7609">https://github.com/roc-lang/roc/pull/7609</a></p>



<a name="499926164"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20parser%20diagnostics/near/499926164" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20parser.20diagnostics.html#499926164">(Feb 15 2025 at 16:04)</a>:</h4>
<p>To get past the casing rename thing I squashed the commits prior to rebase</p>



<a name="499926177"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20parser%20diagnostics/near/499926177" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20parser.20diagnostics.html#499926177">(Feb 15 2025 at 16:04)</a>:</h4>
<p>So this is already merged?</p>



<a name="499926197"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20parser%20diagnostics/near/499926197" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20parser.20diagnostics.html#499926197">(Feb 15 2025 at 16:05)</a>:</h4>
<p>Yep!</p>



<a name="499926212"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20parser%20diagnostics/near/499926212" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20parser.20diagnostics.html#499926212">(Feb 15 2025 at 16:05)</a>:</h4>
<p>So I can just do something useful then!</p>



<a name="499926221"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20parser%20diagnostics/near/499926221" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20parser.20diagnostics.html#499926221">(Feb 15 2025 at 16:05)</a>:</h4>
<p>Thank you!</p>



<a name="499926243"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20parser%20diagnostics/near/499926243" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20parser.20diagnostics.html#499926243">(Feb 15 2025 at 16:05)</a>:</h4>
<p>And thank you for making sure the commits were still mine, it means a lot to me</p>



<a name="499926332"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20parser%20diagnostics/near/499926332" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20parser.20diagnostics.html#499926332">(Feb 15 2025 at 16:06)</a>:</h4>
<p>Of course!</p>



<a name="499926376"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20parser%20diagnostics/near/499926376" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20parser.20diagnostics.html#499926376">(Feb 15 2025 at 16:06)</a>:</h4>
<p>Trying to figure out what to tackle next</p>



<a name="499926406"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20parser%20diagnostics/near/499926406" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20parser.20diagnostics.html#499926406">(Feb 15 2025 at 16:07)</a>:</h4>
<p>I'll probably keep working on some of the low hanging fruit since my brain is still only at 80% capacity at the moment</p>



<a name="499926496"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20parser%20diagnostics/near/499926496" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20parser.20diagnostics.html#499926496">(Feb 15 2025 at 16:08)</a>:</h4>
<p>Some of the feedback on your original PR is still outstanding</p>



<a name="499926532"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20parser%20diagnostics/near/499926532" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20parser.20diagnostics.html#499926532">(Feb 15 2025 at 16:08)</a>:</h4>
<p>(So that’s an option if you want)</p>



<a name="499926587"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20parser%20diagnostics/near/499926587" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20parser.20diagnostics.html#499926587">(Feb 15 2025 at 16:09)</a>:</h4>
<p>I have some partially complete local changes to start emitting diagnostics from the parser instead of panicking</p>



<a name="499926685"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20parser%20diagnostics/near/499926685" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20parser.20diagnostics.html#499926685">(Feb 15 2025 at 16:10)</a>:</h4>
<p>I think at this point the braces discussion has settled, so you could start converting the parser to that</p>



<a name="499926803"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20parser%20diagnostics/near/499926803" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20parser.20diagnostics.html#499926803">(Feb 15 2025 at 16:12)</a>:</h4>
<p><a href="#narrow/stream/304641-ideas/topic/braces.20syntax">https://roc.zulipchat.com/#narrow/stream/304641-ideas/topic/braces.20syntax</a></p>



<a name="499927046"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20parser%20diagnostics/near/499927046" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20parser.20diagnostics.html#499927046">(Feb 15 2025 at 16:15)</a>:</h4>
<p>Ok, yeah, let me do that.</p>



<a name="499927116"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20parser%20diagnostics/near/499927116" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20parser.20diagnostics.html#499927116">(Feb 15 2025 at 16:16)</a>:</h4>
<p>I need to look at what feedback I didn't address.  I thought I had addressed the last of Sam's feedback, but maybe that never made it in?</p>



<a name="499927129"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20parser%20diagnostics/near/499927129" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20parser.20diagnostics.html#499927129">(Feb 15 2025 at 16:16)</a>:</h4>
<p><a href="https://github.com/roc-lang/roc/pull/7597#discussion_r1953437310">https://github.com/roc-lang/roc/pull/7597#discussion_r1953437310</a> i think this is the last item</p>



<a name="499927171"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20parser%20diagnostics/near/499927171" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20parser.20diagnostics.html#499927171">(Feb 15 2025 at 16:17)</a>:</h4>
<p>That’s more of an FYI than concrete feedback tho</p>



<a name="499927237"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20parser%20diagnostics/near/499927237" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20parser.20diagnostics.html#499927237">(Feb 15 2025 at 16:18)</a>:</h4>
<p>And doesn’t apply directly in the parser currently anyway since we’re catching ooms and panicking at a lower level</p>



<a name="499927242"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20parser%20diagnostics/near/499927242" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20parser.20diagnostics.html#499927242">(Feb 15 2025 at 16:18)</a>:</h4>
<p>So <span aria-label="shrug" class="emoji emoji-1f937" role="img" title="shrug">:shrug:</span></p>



<a name="499927561"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20parser%20diagnostics/near/499927561" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20parser.20diagnostics.html#499927561">(Feb 15 2025 at 16:22)</a>:</h4>
<p>Yeah, just looked at it, hadn't seen the latest feedback after that</p>



<a name="499927577"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20parser%20diagnostics/near/499927577" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20parser.20diagnostics.html#499927577">(Feb 15 2025 at 16:23)</a>:</h4>
<p>There isn't a ton pressing there but I will work to address it when I can</p>



<a name="499927595"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20parser%20diagnostics/near/499927595" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20parser.20diagnostics.html#499927595">(Feb 15 2025 at 16:23)</a>:</h4>
<p>Makes sense</p>



<a name="499927604"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20parser%20diagnostics/near/499927604" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20parser.20diagnostics.html#499927604">(Feb 15 2025 at 16:23)</a>:</h4>
<p>I think planning out the move to braces is the most straightforward thing right now - and the most pressing</p>



<a name="499927657"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20parser%20diagnostics/near/499927657" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20parser.20diagnostics.html#499927657">(Feb 15 2025 at 16:24)</a>:</h4>
<p>The one thing I am pained about this change  is - I will not be able to use our existing corpus of snapshots for testing</p>



<a name="499927670"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20parser%20diagnostics/near/499927670" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20parser.20diagnostics.html#499927670">(Feb 15 2025 at 16:24)</a>:</h4>
<p>They will all have to be worked up to fit the new syntax</p>



<a name="499927718"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20parser%20diagnostics/near/499927718" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20parser.20diagnostics.html#499927718">(Feb 15 2025 at 16:25)</a>:</h4>
<p>Which makes me wonder if we should try to develop a new set of principles for adding snapshots while we are at it</p>



<a name="499927719"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20parser%20diagnostics/near/499927719" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20parser.20diagnostics.html#499927719">(Feb 15 2025 at 16:25)</a>:</h4>
<p>One thing that crossed my mind was to do a one-time formatter change to the old compiler, in order to spit out this new syntax</p>



<a name="499927742"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20parser%20diagnostics/near/499927742" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20parser.20diagnostics.html#499927742">(Feb 15 2025 at 16:25)</a>:</h4>
<p>Oh, that could work - would be a bit of work but not too bad</p>



<a name="499927748"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20parser%20diagnostics/near/499927748" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20parser.20diagnostics.html#499927748">(Feb 15 2025 at 16:25)</a>:</h4>
<p>Do you think you could work on that in parallel?</p>



<a name="499927756"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20parser%20diagnostics/near/499927756" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20parser.20diagnostics.html#499927756">(Feb 15 2025 at 16:25)</a>:</h4>
<p>With me continuing on this?</p>



<a name="499927839"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20parser%20diagnostics/near/499927839" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20parser.20diagnostics.html#499927839">(Feb 15 2025 at 16:26)</a>:</h4>
<p>Since you are the ParseFather of the Rust compiler <span aria-label="smile" class="emoji emoji-1f642" role="img" title="smile">:smile:</span></p>



<a name="499927856"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20parser%20diagnostics/near/499927856" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20parser.20diagnostics.html#499927856">(Feb 15 2025 at 16:26)</a>:</h4>
<p>Haha yeah</p>



<a name="499927896"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20parser%20diagnostics/near/499927896" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20parser.20diagnostics.html#499927896">(Feb 15 2025 at 16:26)</a>:</h4>
<p>Don't worry, I'm bogged down enough physically/mentally right now that I won't make TOO much progress while you do that</p>



<a name="499938932"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20parser%20diagnostics/near/499938932" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20parser.20diagnostics.html#499938932">(Feb 15 2025 at 18:17)</a>:</h4>
<p>Here's what I was thinking for malformed nodes + diagnostics in the parser: <a href="https://github.com/roc-lang/roc/pull/7611">https://github.com/roc-lang/roc/pull/7611</a></p>



<a name="499938951"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20parser%20diagnostics/near/499938951" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20parser.20diagnostics.html#499938951">(Feb 15 2025 at 18:17)</a>:</h4>
<p>Essentially, have a .malformed tag that is allowed to stand in for any other node kind</p>



<a name="499939056"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20parser%20diagnostics/near/499939056" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20parser.20diagnostics.html#499939056">(Feb 15 2025 at 18:18)</a>:</h4>
<p>I didn't implement this part yet, but when calling getStatement (for example), that'd return an error (or null?) if we're looking at a malformed node.</p>



<a name="500760054"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20parser%20diagnostics/near/500760054" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20parser.20diagnostics.html#500760054">(Feb 19 2025 at 23:05)</a>:</h4>
<p>That sounds good to me.</p>



<a name="500760183"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20parser%20diagnostics/near/500760183" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20parser.20diagnostics.html#500760183">(Feb 19 2025 at 23:06)</a>:</h4>
<p>My biggest issue with malformed is: "How do we decide that that we've included enough in the malformed node to make the continuation of the token stream resulting in a well-formed node?"</p>



<a name="500784819"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20parser%20diagnostics/near/500784819" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20parser.20diagnostics.html#500784819">(Feb 20 2025 at 03:07)</a>:</h4>
<p>A common heuristic is to consume tokens until the end of the line, and until all braces have been matched (supposing it’s not a braces problem)</p>



<a name="500785976"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20parser%20diagnostics/near/500785976" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20parser.20diagnostics.html#500785976">(Feb 20 2025 at 03:20)</a>:</h4>
<p>someone wrote an article about this in the context of Zig at some point</p>



<a name="500786012"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20parser%20diagnostics/near/500786012" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20parser.20diagnostics.html#500786012">(Feb 20 2025 at 03:20)</a>:</h4>
<p>like there are some "cutoff points" (or something - I forget what term they used) where you can tell it's definitely the end of <em>something</em></p>



<a name="500786023"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20parser%20diagnostics/near/500786023" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20parser.20diagnostics.html#500786023">(Feb 20 2025 at 03:20)</a>:</h4>
<p>an example was if you have an open <code>"</code> and you hit a newline</p>



<a name="500786050"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20parser%20diagnostics/near/500786050" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20parser.20diagnostics.html#500786050">(Feb 20 2025 at 03:21)</a>:</h4>
<p>you can say "ok, we don't know where it was <em>supposed</em> to end, but we can cut it off at the newline and go back to parsing normally so we don't have the rest of the file being treated as a string literal"</p>



<a name="500786152"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20parser%20diagnostics/near/500786152" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20parser.20diagnostics.html#500786152">(Feb 20 2025 at 03:22)</a>:</h4>
<p>we could do something similar with top-level declarations although maybe it's not worth it to detect that <span aria-label="big smile" class="emoji emoji-1f604" role="img" title="big smile">:big_smile:</span></p>



<a name="500786167"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20parser%20diagnostics/near/500786167" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20parser.20diagnostics.html#500786167">(Feb 20 2025 at 03:22)</a>:</h4>
<p>("that" being a newline followed immediately by an identifier)</p>



<a name="500786247"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20parser%20diagnostics/near/500786247" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20parser.20diagnostics.html#500786247">(Feb 20 2025 at 03:23)</a>:</h4>
<p>We also might be able to use indentation and/braces as guides. We can know whether braces are properly matched in the file (the tokenizer needs to compute this anyway). We can probably jump to the nearest closing brace.</p>



<a name="500825385"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/zig%20compiler%20-%20parser%20diagnostics/near/500825385" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Norbert Hajagos <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/zig.20compiler.20-.20parser.20diagnostics.html#500825385">(Feb 20 2025 at 08:55)</a>:</h4>
<p>A while back I was reading the source of rust-analyzer and they do the same there.  Let me try to dig it out from my memory: When expecting a specific token, they also provide a set of "recovery tokens" which could start a node, even though such node wouldn't be in the right place. </p>
<p>So for an input:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="k">fn</span><span class="w"> </span><span class="nf">struct</span><span class="w"> </span><span class="n">User</span>
</code></pre></div>
<p>tokens wouldn't be wrapped in an ErrorNode. <code>struct</code> would be included in the error recovery set when expecting an identifier of a function. When the parser sees a <code>struct</code>, an error would be reported that a function identifier was expected. Then it would start to parse a struct as normal.</p>
<p>On the other hand, in </p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="k">fn</span><span class="w"> </span><span class="mi">2</span>
</code></pre></div>
<p><code>2</code> would not be in the recovery set, since it isn't a start of a node they would want to parse for resilience. It would just get skipped in it's own (which means, wrap it in an ErrorNode).<br>
 I remember there was a rule specifically to never skip a <code>}</code> in such cases in order to keep the braces balanced. They'd end the malformed node before the brace and return from that specific parse function. The caller will probably expect a closing brace to be the next token. At worst, you are getting an unmatched closing brace error, which is very easy to fix.</p>



<hr><p>Last updated: Mar 01 2026 at 12:20 UTC</p>
</html>