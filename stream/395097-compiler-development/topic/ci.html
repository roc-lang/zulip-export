<html>
<head><meta charset="utf-8"><title>ci · compiler development · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/index.html">compiler development</a></h2>
<h3>Topic: <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/ci.html">ci</a></h3>

<hr>

<base href="https://roc.zulipchat.com">

<head><link href="https://roc-lang.github.io/zulip-export/style.css" rel="stylesheet"></head>

<a name="562110872"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/ci/near/562110872" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/ci.html#562110872">(Dec 05 2025 at 14:16)</a>:</h4>
<p><a href="https://github.com/roc-lang/roc/pull/8565">https://github.com/roc-lang/roc/pull/8565</a> failed on Nix checks only, but there's no error message and I'm not sure how to debug <span aria-label="sweat smile" class="emoji emoji-1f605" role="img" title="sweat smile">:sweat_smile:</span> </p>
<p>I'm going to merge because it has some important fixes and is prone to merge conflicts, plus I don't see why anything should have changed in terms of Nix <span aria-label="raised" class="emoji emoji-1f928" role="img" title="raised">:raised:</span> </p>
<p>can anyone who has Nix set up try to reproduce that locally?</p>



<a name="562117864"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/ci/near/562117864" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/ci.html#562117864">(Dec 05 2025 at 14:45)</a>:</h4>
<p>I'll take a quick look</p>



<a name="562122327"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/ci/near/562122327" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/ci.html#562122327">(Dec 05 2025 at 15:04)</a>:</h4>
<p>It passes now <a href="https://github.com/roc-lang/roc/pull/8575">https://github.com/roc-lang/roc/pull/8575</a> , I did not change anything :p <br>
There was also nothing in your failing check output that showed what was going wrong, I guess we'll see if it pops up again.</p>



<a name="562256120"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/ci/near/562256120" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/ci.html#562256120">(Dec 06 2025 at 18:05)</a>:</h4>
<p>I think I found a fix - <a href="https://github.com/roc-lang/roc/pull/8579">https://github.com/roc-lang/roc/pull/8579</a> - I believe the problem was that we were rebuilding the roc binary before each fx test, to prevent staleness, and this resulted in too much disk usage for the Nix environment, resulting in an error with no clear error message.</p>



<a name="562256165"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/ci/near/562256165" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/ci.html#562256165">(Dec 06 2025 at 18:06)</a>:</h4>
<p>however, that PR is now failing on a valgrind error that suggests maybe we install a non-stripped <a href="http://ld.so">ld.so</a> equivalent in that environment?</p>
<blockquote>
<p>debug: reported NIL problems</p>
<p>debug: processing snapshot file: /home/runner/work/roc/roc/test/snapshots/expr_no_space_dot_int.md</p>
<p>debug: Generating snapshot for: /home/runner/work/roc/roc/test/snapshots/expr_no_space_dot_int.md</p>
<p>debug: processing snapshot file: /home/runner/work/roc/roc/test/snapshots/can_import_exposing_types.md</p>
<p>debug: Generating snapshot for: /home/runner/work/roc/roc/test/snapshots/can_import_exposing_types.md</p>
<p>==6829==</p>
<p>==6829== HEAP SUMMARY:</p>
<p>==6829== in use at exit: 0 bytes in 0 blocks</p>
<p>==6829== total heap usage: 0 allocs, 0 frees, 0 bytes allocated</p>
<p>==6829==</p>
<p>==6829== All heap blocks were freed -- no leaks are possible</p>
<p>==6829==</p>
<p>==6829== For lists of detected and suppressed errors, rerun with: -s</p>
<p>==6829== ERROR SUMMARY: 0 errors from 0 contexts (suppressed: 0 from 0)</p>
<p>==6906== Memcheck, a memory error detector</p>
<p>==6906== Copyright (C) 2002-2024, and GNU GPL'd, by Julian Seward et al.</p>
<p>==6906== Using Valgrind-3.26.0 and LibVEX; rerun with -h for copyright info</p>
<p>==6906== Command: ./zig-out/bin/roc --no-cache test/str/app.roc</p>
<p>==6906==</p>
<p>valgrind: Fatal error at startup: a function redirection</p>
<p>valgrind: which is mandatory for this platform-tool combination</p>
<p>valgrind: cannot be set up. Details of the redirection are:</p>
<p>valgrind:</p>
<p>valgrind: A must-be-redirected function</p>
<p>valgrind: whose name matches the pattern: memcmp</p>
<p>valgrind: in an object with soname matching: ld-linux-x86-64.so.2</p>
<p>valgrind: was not found whilst processing</p>
<p>valgrind: symbols from the object with soname: ld-linux-x86-64.so.2</p>
<p>valgrind:</p>
<p>valgrind: Possible fixes: (1, short term): install glibc's debuginfo</p>
<p>valgrind: package on this machine. (2, longer term): ask the packagers</p>
<p>valgrind: for your Linux distribution to please in future ship a non-</p>
<p>valgrind: stripped <a href="http://ld.so">ld.so</a> (or whatever the dynamic linker .so is called)</p>
<p>valgrind: that exports the above-named function using the standard</p>
<p>valgrind: calling conventions for this platform. The package you need</p>
<p>valgrind: to install for fix (1) is called</p>
<p>valgrind:</p>
<p>valgrind: On Debian, Ubuntu: libc6-dbg</p>
<p>valgrind: On SuSE, openSuSE, Fedora, RHEL: glibc-debuginfo</p>
<p>valgrind:</p>
<p>valgrind: Note that if you are debugging a 32 bit process on a</p>
<p>valgrind: 64 bit system, you will need a corresponding 32 bit debuginfo</p>
<p>valgrind: package (e.g. libc6-dbg:i386).</p>
<p>valgrind:</p>
<p>valgrind: Cannot continue -- exiting now. Sorry</p>
</blockquote>



<a name="562434512"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/ci/near/562434512" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/ci.html#562434512">(Dec 08 2025 at 10:42)</a>:</h4>
<p>Looks like it's fixed :)</p>



<a name="562481472"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/395097-compiler%20development/topic/ci/near/562481472" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/395097-compiler-development/topic/ci.html#562481472">(Dec 08 2025 at 14:32)</a>:</h4>
<p>oh yeah Claude had a suggested fix in a recent PR, and it ended up resolving it</p>



<hr><p>Last updated: Mar 01 2026 at 12:20 UTC</p>
</html>