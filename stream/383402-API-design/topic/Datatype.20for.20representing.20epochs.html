<html>
<head><meta charset="utf-8"><title>Datatype for representing epochs · API design · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://roc-lang.github.io/zulip-export/stream/383402-API-design/index.html">API design</a></h2>
<h3>Topic: <a href="https://roc-lang.github.io/zulip-export/stream/383402-API-design/topic/Datatype.20for.20representing.20epochs.html">Datatype for representing epochs</a></h3>

<hr>

<base href="https://roc.zulipchat.com">

<head><link href="https://roc-lang.github.io/zulip-export/style.css" rel="stylesheet"></head>

<a name="491628518"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/383402-API%20design/topic/Datatype%20for%20representing%20epochs/near/491628518" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/383402-API-design/topic/Datatype.20for.20representing.20epochs.html#491628518">(Jan 02 2025 at 15:47)</a>:</h4>
<p>Brought up with the <a class="stream-topic" data-stream-id="304902" href="/#narrow/channel/304902-show-and-tell/topic/roc-realworld.20initial.20exploration">#show and tell &gt; roc-realworld initial exploration</a> discussion:</p>
<p>What's the best backing type for storing time epochs? From the <code>chrono</code> docs for <a href="https://docs.rs/chrono/latest/chrono/struct.DateTime.html#method.timestamp_nanos_opt">timestamp_nanos_opt</a>:</p>
<blockquote>
<p>An <code>i64</code> with nanosecond precision can span a range of ~584 years. This function returns <code>None</code> on an out of range <code>DateTime</code>.</p>
</blockquote>
<blockquote>
<p>The dates that can be represented as nanoseconds are between 1677-09-21T00:12:43.145224192 and 2262-04-11T23:47:16.854775807.</p>
</blockquote>
<p>So except for where you're trying to use a timestamp to represent dates in history, anything in the recent past/future is totally covered with <code>i64</code>. I personally think you could use <code>u64</code> because now and forward is what we care about for app dev, but I can see usage of either.</p>
<p>That being said, if <code>i64</code> covers almost 600 years, then using <code>i128</code> would cover any year in the past, present, or future that would ever need to be represented for anything. You'd _probably_ be safe using it to represent all datetime types and crashing on invalid years like 1 trillion BC (though even that would still be in range!).</p>



<a name="491629040"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/383402-API%20design/topic/Datatype%20for%20representing%20epochs/near/491629040" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/383402-API-design/topic/Datatype.20for.20representing.20epochs.html#491629040">(Jan 02 2025 at 15:51)</a>:</h4>
<p>So I'd say:</p>
<ul>
<li>U64 is a safe bet for any application managing timestamps for events in the modern day</li>
<li>I64 is a good way to halve the range of U64 but get a few hundred years of backwards history (probably not as likely to be needed)</li>
<li>I128 will cover basically all realistically representable time, so using I128 is always gonna work even if it's double the storage cost</li>
<li>U128 should only be used if you can't use a signed int like I128 for some reason</li>
</ul>



<a name="491629157"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/383402-API%20design/topic/Datatype%20for%20representing%20epochs/near/491629157" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/383402-API-design/topic/Datatype.20for.20representing.20epochs.html#491629157">(Jan 02 2025 at 15:52)</a>:</h4>
<p>I expect Roc should just use <code>I128</code> everywhere to be safe?</p>



<a name="491629179"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/383402-API%20design/topic/Datatype%20for%20representing%20epochs/near/491629179" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/383402-API-design/topic/Datatype.20for.20representing.20epochs.html#491629179">(Jan 02 2025 at 15:52)</a>:</h4>
<p><span class="user-mention" data-user-id="515757">@Luke Boswell</span> does this answer your question?</p>



<a name="491629193"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/383402-API%20design/topic/Datatype%20for%20representing%20epochs/near/491629193" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/383402-API-design/topic/Datatype.20for.20representing.20epochs.html#491629193">(Jan 02 2025 at 15:52)</a>:</h4>
<p>I think <code>I64/I128</code> is useful so you can do <code>a - b</code> without worrying about accidentally producing a negative</p>



<a name="491629274"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/383402-API%20design/topic/Datatype%20for%20representing%20epochs/near/491629274" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/383402-API-design/topic/Datatype.20for.20representing.20epochs.html#491629274">(Jan 02 2025 at 15:53)</a>:</h4>
<p>yeah I jut wonder about whether "negative duration" is a good concept to have or not</p>



<a name="491629302"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/383402-API%20design/topic/Datatype%20for%20representing%20epochs/near/491629302" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/383402-API-design/topic/Datatype.20for.20representing.20epochs.html#491629302">(Jan 02 2025 at 15:53)</a>:</h4>
<p>I assume it's fine, but maybe it's desirable to know it's nonnegative for some reason?</p>



<a name="491629376"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/383402-API%20design/topic/Datatype%20for%20representing%20epochs/near/491629376" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/383402-API-design/topic/Datatype.20for.20representing.20epochs.html#491629376">(Jan 02 2025 at 15:54)</a>:</h4>
<p>I feel like max efficiency isn't needed here so <code>I128</code> seams fine. Then it can be used datetimes and time measurements instead of splitting the ecosystem</p>



<a name="491629381"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/383402-API%20design/topic/Datatype%20for%20representing%20epochs/near/491629381" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/383402-API-design/topic/Datatype.20for.20representing.20epochs.html#491629381">(Jan 02 2025 at 15:54)</a>:</h4>
<p>I think we're already comfortable with "negative duration" because we don't measure from now, we measure from 54 years ago</p>



<a name="491629606"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/383402-API%20design/topic/Datatype%20for%20representing%20epochs/near/491629606" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/383402-API-design/topic/Datatype.20for.20representing.20epochs.html#491629606">(Jan 02 2025 at 15:56)</a>:</h4>
<blockquote>
<p>yeah I jut wonder about whether "negative duration" is a good concept to have or not</p>
</blockquote>
<p>That's totally fair.</p>
<p>If we want to use this type for datetimes, negative is needed anyway for before 1970.</p>
<p>If it is only for time measurements, I agree that unsigned makes more sense</p>



<a name="491630066"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/383402-API%20design/topic/Datatype%20for%20representing%20epochs/near/491630066" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/383402-API-design/topic/Datatype.20for.20representing.20epochs.html#491630066">(Jan 02 2025 at 16:00)</a>:</h4>
<p>I'm not sure I agree that you'd want unsigned unless you wanted to save space.</p>



<a name="491630169"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/383402-API%20design/topic/Datatype%20for%20representing%20epochs/near/491630169" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/383402-API-design/topic/Datatype.20for.20representing.20epochs.html#491630169">(Jan 02 2025 at 16:00)</a>:</h4>
<p>Signed adds more safety (but not perfect safety, of course!) around math on the underlying epoch</p>



<a name="491630362"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/383402-API%20design/topic/Datatype%20for%20representing%20epochs/near/491630362" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/383402-API-design/topic/Datatype.20for.20representing.20epochs.html#491630362">(Jan 02 2025 at 16:02)</a>:</h4>
<p>And I can't think of a situation where I'd want to limit the cardinality of my times to "1970 and later" at the type level instead of just having a proper constraint in the DB or something</p>



<a name="491631250"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/383402-API%20design/topic/Datatype%20for%20representing%20epochs/near/491631250" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/383402-API-design/topic/Datatype.20for.20representing.20epochs.html#491631250">(Jan 02 2025 at 16:08)</a>:</h4>
<p>well <code>Instant</code> and <code>Duration</code> can be different in that way</p>



<a name="491631256"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/383402-API%20design/topic/Datatype%20for%20representing%20epochs/near/491631256" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/383402-API-design/topic/Datatype.20for.20representing.20epochs.html#491631256">(Jan 02 2025 at 16:09)</a>:</h4>
<p><code>Instant</code> should certainly be signed</p>



<a name="491631265"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/383402-API%20design/topic/Datatype%20for%20representing%20epochs/near/491631265" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/383402-API-design/topic/Datatype.20for.20representing.20epochs.html#491631265">(Jan 02 2025 at 16:09)</a>:</h4>
<p><code>Duration</code> I can see arguments both ways for whether it should be signed</p>



<a name="491631283"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/383402-API%20design/topic/Datatype%20for%20representing%20epochs/near/491631283" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/383402-API-design/topic/Datatype.20for.20representing.20epochs.html#491631283">(Jan 02 2025 at 16:09)</a>:</h4>
<p>(semantically, not thinking about performance or anything like that)</p>



<a name="491631311"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/383402-API%20design/topic/Datatype%20for%20representing%20epochs/near/491631311" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/383402-API-design/topic/Datatype.20for.20representing.20epochs.html#491631311">(Jan 02 2025 at 16:09)</a>:</h4>
<p>Oh, good point! I was thinking of instant for both of those words</p>



<a name="491631340"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/383402-API%20design/topic/Datatype%20for%20representing%20epochs/near/491631340" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/383402-API-design/topic/Datatype.20for.20representing.20epochs.html#491631340">(Jan 02 2025 at 16:09)</a>:</h4>
<p><code>Duration</code>s probably should not be negative!</p>



<a name="491631463"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/383402-API%20design/topic/Datatype%20for%20representing%20epochs/near/491631463" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/383402-API-design/topic/Datatype.20for.20representing.20epochs.html#491631463">(Jan 02 2025 at 16:10)</a>:</h4>
<p>So yes, <code>I128</code> for <code>Instant</code> and <code>U64</code> or <code>U128</code> (probably the latter) for <code>Duration</code></p>



<a name="491634733"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/383402-API%20design/topic/Datatype%20for%20representing%20epochs/near/491634733" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/383402-API-design/topic/Datatype.20for.20representing.20epochs.html#491634733">(Jan 02 2025 at 16:37)</a>:</h4>
<p>I guess eventually <code>Instant</code> will be a nominal type. Then <code>instant.elapsed(other)</code> will return a <code>Duration</code> which is a <code>U128</code> (maybe also nominal for methods like <code>.to_ms()</code>.</p>



<a name="491634825"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/383402-API%20design/topic/Datatype%20for%20representing%20epochs/near/491634825" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/383402-API-design/topic/Datatype.20for.20representing.20epochs.html#491634825">(Jan 02 2025 at 16:37)</a>:</h4>
<p>In a world where <code>Instant</code> is just structural <code>Duration</code> will ultimately be the same type cause users will just do <code>instant - other</code></p>



<a name="491636287"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/383402-API%20design/topic/Datatype%20for%20representing%20epochs/near/491636287" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/383402-API-design/topic/Datatype.20for.20representing.20epochs.html#491636287">(Jan 02 2025 at 16:48)</a>:</h4>
<p>oh I definitely think both of them should be nominal</p>



<a name="491636315"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/383402-API%20design/topic/Datatype%20for%20representing%20epochs/near/491636315" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/383402-API-design/topic/Datatype.20for.20representing.20epochs.html#491636315">(Jan 02 2025 at 16:48)</a>:</h4>
<p>in general for things where units matter, nominal is great for avoiding mixing up your units</p>



<a name="491636354"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/383402-API%20design/topic/Datatype%20for%20representing%20epochs/near/491636354" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/383402-API-design/topic/Datatype.20for.20representing.20epochs.html#491636354">(Jan 02 2025 at 16:48)</a>:</h4>
<p>like accidentally adding together two <code>Instant</code>s, which is almost certainly never what you want <span aria-label="sweat smile" class="emoji emoji-1f605" role="img" title="sweat smile">:sweat_smile:</span></p>



<a name="491636611"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/383402-API%20design/topic/Datatype%20for%20representing%20epochs/near/491636611" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/383402-API-design/topic/Datatype.20for.20representing.20epochs.html#491636611">(Jan 02 2025 at 16:50)</a>:</h4>
<p>Ah yes, <code>Dec 3rd, 1994 + Jan 1st, 1970 == Dec 3rd, 1994</code></p>



<a name="491647971"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/383402-API%20design/topic/Datatype%20for%20representing%20epochs/near/491647971" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jasper Woudenberg <a href="https://roc-lang.github.io/zulip-export/stream/383402-API-design/topic/Datatype.20for.20representing.20epochs.html#491647971">(Jan 02 2025 at 18:21)</a>:</h4>
<p>If durations can't be negative, would<code>duration_a - duration_b</code> would always return a positive number?</p>
<p>If so, it creates a situation where the order of <code>+</code> and <code>-</code> operations with durations matters, as below.</p>
<div class="codehilite"><pre><span></span><code>a = Duration.from_ms 2
b = Duration.from_ms 8
c = Duration.from_ms 5

expect
    // Fails. LHS: 5, RHS: 11
    a + b - c == a - c + b
</code></pre></div>



<a name="491648313"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/383402-API%20design/topic/Datatype%20for%20representing%20epochs/near/491648313" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/383402-API-design/topic/Datatype.20for.20representing.20epochs.html#491648313">(Jan 02 2025 at 18:24)</a>:</h4>
<p>I'd expect it to do whatever <code>3 - 5</code> does which is presumably crash</p>



<a name="491648420"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/383402-API%20design/topic/Datatype%20for%20representing%20epochs/near/491648420" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/383402-API-design/topic/Datatype.20for.20representing.20epochs.html#491648420">(Jan 02 2025 at 18:25)</a>:</h4>
<p>math binops exist because doing <code>left.minus(right)</code> every time sucks, and <code>left.minus(right)?</code> every time isn't worth it either, so we just expect it to crash</p>



<a name="491648506"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/383402-API%20design/topic/Datatype%20for%20representing%20epochs/near/491648506" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/383402-API-design/topic/Datatype.20for.20representing.20epochs.html#491648506">(Jan 02 2025 at 18:26)</a>:</h4>
<p>But we have <code>minus_checked(...)</code> for those safety-aware cases</p>



<a name="491653242"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/383402-API%20design/topic/Datatype%20for%20representing%20epochs/near/491653242" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/383402-API-design/topic/Datatype.20for.20representing.20epochs.html#491653242">(Jan 02 2025 at 19:05)</a>:</h4>
<p>yeah this is true in general of unsigned integers, and it's a tradeoff that comes with the upside of guaranteeing that they're never negative</p>



<a name="491691480"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/383402-API%20design/topic/Datatype%20for%20representing%20epochs/near/491691480" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Isaac Van Doren <a href="https://roc-lang.github.io/zulip-export/stream/383402-API-design/topic/Datatype.20for.20representing.20epochs.html#491691480">(Jan 03 2025 at 01:42)</a>:</h4>
<p>I think durations should definitely be signed. It would be a very bad user experience to compare two durations and get a crash. It's more acceptable when subtracting raw unsigned integers because you know what type you're working with and that crashing is part of the game. With a custom type, you would have no reason to expect that <code>today.minus(tomorrow)</code> would explode without reading the docs.</p>
<p>To me a negative duration seems very intuitive and useful. It's just representing the distance and direction between two points in time.</p>



<a name="491691510"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/383402-API%20design/topic/Datatype%20for%20representing%20epochs/near/491691510" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/383402-API-design/topic/Datatype.20for.20representing.20epochs.html#491691510">(Jan 03 2025 at 01:42)</a>:</h4>
<p><code>today</code> and <code>tomorrow</code> would be <code>Instant</code>s, though, not <code>Duration</code>s <span aria-label="thinking" class="emoji emoji-1f914" role="img" title="thinking">:thinking:</span></p>



<a name="491691526"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/383402-API%20design/topic/Datatype%20for%20representing%20epochs/near/491691526" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/383402-API-design/topic/Datatype.20for.20representing.20epochs.html#491691526">(Jan 03 2025 at 01:43)</a>:</h4>
<p><span class="user-mention silent" data-user-id="611722">Isaac Van Doren</span> <a href="#narrow/channel/383402-API-design/topic/Datatype.20for.20representing.20epochs/near/491691480">said</a>:</p>
<blockquote>
<p>It would be a very bad user experience to compare two durations and get a crash. It's more acceptable when subtracting raw unsigned integers because you know what type you're working with and that crashing is part of the game.</p>
</blockquote>
<p>this is a good point</p>



<a name="491691559"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/383402-API%20design/topic/Datatype%20for%20representing%20epochs/near/491691559" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Isaac Van Doren <a href="https://roc-lang.github.io/zulip-export/stream/383402-API-design/topic/Datatype.20for.20representing.20epochs.html#491691559">(Jan 03 2025 at 01:43)</a>:</h4>
<p>Right, I was imagining that <code>today.minus(tomorrow)</code> would be a duration though</p>



<a name="491691574"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/383402-API%20design/topic/Datatype%20for%20representing%20epochs/near/491691574" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/383402-API-design/topic/Datatype.20for.20representing.20epochs.html#491691574">(Jan 03 2025 at 01:43)</a>:</h4>
<p>the downside of it being signed is that you can't guarantee it's nonnegative, so there might be some scenarios you have more difficulty ruling out</p>



<a name="491691578"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/383402-API%20design/topic/Datatype%20for%20representing%20epochs/near/491691578" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/383402-API-design/topic/Datatype.20for.20representing.20epochs.html#491691578">(Jan 03 2025 at 01:43)</a>:</h4>
<p>but the downside of it being unsigned is that it might crash if you use it wrong</p>



<a name="491691583"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/383402-API%20design/topic/Datatype%20for%20representing%20epochs/near/491691583" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/383402-API-design/topic/Datatype.20for.20representing.20epochs.html#491691583">(Jan 03 2025 at 01:43)</a>:</h4>
<p>which is a more serious downside</p>



<a name="491691585"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/383402-API%20design/topic/Datatype%20for%20representing%20epochs/near/491691585" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/383402-API-design/topic/Datatype.20for.20representing.20epochs.html#491691585">(Jan 03 2025 at 01:44)</a>:</h4>
<p>I think it'd be better to expose a <code>Instant.absolute_delta(Instant) -&gt; Duration</code> and maintain unsigned <code>Duration</code>s</p>



<a name="491691664"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/383402-API%20design/topic/Datatype%20for%20representing%20epochs/near/491691664" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Isaac Van Doren <a href="https://roc-lang.github.io/zulip-export/stream/383402-API-design/topic/Datatype.20for.20representing.20epochs.html#491691664">(Jan 03 2025 at 01:44)</a>:</h4>
<blockquote>
<p>the downside of it being signed is that you can't guarantee it's nonnegative, so there might be some scenarios you have more difficulty ruling out</p>
</blockquote>
<p>It seems fine to just have to check if the duration is positive if you need to</p>



<a name="491691729"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/383402-API%20design/topic/Datatype%20for%20representing%20epochs/near/491691729" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Isaac Van Doren <a href="https://roc-lang.github.io/zulip-export/stream/383402-API-design/topic/Datatype.20for.20representing.20epochs.html#491691729">(Jan 03 2025 at 01:45)</a>:</h4>
<blockquote>
<p>I think it'd be better to expose a <code>Instant.absolute_delta(Instant) -&gt; Duration</code> and maintain unsigned <code>Duration</code>s</p>
</blockquote>
<p>The trouble with this is that it will make adjusting dates really annoying if you actually do want a negative quantity</p>



<a name="491691843"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/383402-API%20design/topic/Datatype%20for%20representing%20epochs/near/491691843" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/383402-API-design/topic/Datatype.20for.20representing.20epochs.html#491691843">(Jan 03 2025 at 01:47)</a>:</h4>
<p>Why do you need a negative quantity? You can just do <code>Instant.move_forwards(Duration) -&gt; Instant</code> and <code>Instant.move_backwards(Duration) -&gt; Instant</code></p>



<a name="491691869"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/383402-API%20design/topic/Datatype%20for%20representing%20epochs/near/491691869" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/383402-API-design/topic/Datatype.20for.20representing.20epochs.html#491691869">(Jan 03 2025 at 01:47)</a>:</h4>
<p>I'm approaching this from a "cardinality first, API shape second" and negative durations don't fit into that first box for me</p>



<a name="491691926"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/383402-API%20design/topic/Datatype%20for%20representing%20epochs/near/491691926" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/383402-API-design/topic/Datatype.20for.20representing.20epochs.html#491691926">(Jan 03 2025 at 01:48)</a>:</h4>
<p>Elm is big on descriptive APIs, it seems totally prudent to have a descriptive API for this stuff</p>



<a name="491691945"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/383402-API%20design/topic/Datatype%20for%20representing%20epochs/near/491691945" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Isaac Van Doren <a href="https://roc-lang.github.io/zulip-export/stream/383402-API-design/topic/Datatype.20for.20representing.20epochs.html#491691945">(Jan 03 2025 at 01:48)</a>:</h4>
<p>Right I could do that, but that is a lot clunkier than <code>myInstant.adjust(myDuration)</code> which handles either direction</p>



<a name="491691964"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/383402-API%20design/topic/Datatype%20for%20representing%20epochs/near/491691964" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/383402-API-design/topic/Datatype.20for.20representing.20epochs.html#491691964">(Jan 03 2025 at 01:49)</a>:</h4>
<p>Sure</p>



<a name="491692038"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/383402-API%20design/topic/Datatype%20for%20representing%20epochs/near/491692038" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/383402-API-design/topic/Datatype.20for.20representing.20epochs.html#491692038">(Jan 03 2025 at 01:50)</a>:</h4>
<p>I don't have strong feelings on it. Not the way I'd do it, but that approach works, so it's okay with me</p>



<a name="491692194"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/383402-API%20design/topic/Datatype%20for%20representing%20epochs/near/491692194" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/383402-API-design/topic/Datatype.20for.20representing.20epochs.html#491692194">(Jan 03 2025 at 01:52)</a>:</h4>
<p>Warning, it is very important to know when durations are negative. It is a sign that the underlying clock changed. So you need to know to throw out that data.</p>



<a name="491692224"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/383402-API%20design/topic/Datatype%20for%20representing%20epochs/near/491692224" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Isaac Van Doren <a href="https://roc-lang.github.io/zulip-export/stream/383402-API-design/topic/Datatype.20for.20representing.20epochs.html#491692224">(Jan 03 2025 at 01:53)</a>:</h4>
<p>Yeah that's a good point</p>



<a name="491692259"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/383402-API%20design/topic/Datatype%20for%20representing%20epochs/near/491692259" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/383402-API-design/topic/Datatype.20for.20representing.20epochs.html#491692259">(Jan 03 2025 at 01:53)</a>:</h4>
<p>Cause there is no guarantee to that end comes after start when doing:</p>
<div class="codehilite"><pre><span></span><code>start = Instant.now!()
end = Instant.now!()
</code></pre></div>



<a name="491697009"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/383402-API%20design/topic/Datatype%20for%20representing%20epochs/near/491697009" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/383402-API-design/topic/Datatype.20for.20representing.20epochs.html#491697009">(Jan 03 2025 at 02:58)</a>:</h4>
<p>oh that's a great point</p>



<a name="491697021"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/383402-API%20design/topic/Datatype%20for%20representing%20epochs/near/491697021" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/383402-API-design/topic/Datatype.20for.20representing.20epochs.html#491697021">(Jan 03 2025 at 02:59)</a>:</h4>
<p>that's enough to convince me duration should be signed <span aria-label="+1" class="emoji emoji-1f44d" role="img" title="+1">:+1:</span></p>



<a name="491698205"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/383402-API%20design/topic/Datatype%20for%20representing%20epochs/near/491698205" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sky Rose <a href="https://roc-lang.github.io/zulip-export/stream/383402-API-design/topic/Datatype.20for.20representing.20epochs.html#491698205">(Jan 03 2025 at 03:14)</a>:</h4>
<p>I have a concrete use case for negative durations:<br>
In my work, I regularly deal with comparing multiple times, and seeing how close they are. (Specifically, "Did the train come on time?", comparing the scheduled time to the predicted arrival time to the time the train actually showed up.)</p>
<p>The train could either be early or late. This would be way easier to do with signed subtraction and negative durations, rather than having unsigned durations and having to maintain a separate "early or late" enum.</p>



<a name="491699059"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/383402-API%20design/topic/Datatype%20for%20representing%20epochs/near/491699059" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Isaac Van Doren <a href="https://roc-lang.github.io/zulip-export/stream/383402-API-design/topic/Datatype.20for.20representing.20epochs.html#491699059">(Jan 03 2025 at 03:27)</a>:</h4>
<p>That's a great example</p>



<a name="491699168"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/383402-API%20design/topic/Datatype%20for%20representing%20epochs/near/491699168" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Isaac Van Doren <a href="https://roc-lang.github.io/zulip-export/stream/383402-API-design/topic/Datatype.20for.20representing.20epochs.html#491699168">(Jan 03 2025 at 03:29)</a>:</h4>
<p>That reminds me that stage monitors (displays that only the people on stage can see) will often display the amount of time remaining for a particular segment and then switch negative once a segment starts going too long.</p>



<a name="491700102"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/383402-API%20design/topic/Datatype%20for%20representing%20epochs/near/491700102" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/383402-API-design/topic/Datatype.20for.20representing.20epochs.html#491700102">(Jan 03 2025 at 03:45)</a>:</h4>
<p>cool, ok it seems like Rust got this one wrong</p>



<a name="491700109"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/383402-API%20design/topic/Datatype%20for%20representing%20epochs/near/491700109" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/383402-API-design/topic/Datatype.20for.20representing.20epochs.html#491700109">(Jan 03 2025 at 03:45)</a>:</h4>
<p>so then the question is <code>I64</code> or <code>I128</code></p>



<a name="491700177"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/383402-API%20design/topic/Datatype%20for%20representing%20epochs/near/491700177" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/383402-API-design/topic/Datatype.20for.20representing.20epochs.html#491700177">(Jan 03 2025 at 03:46)</a>:</h4>
<p>If your <code>Instant</code> is <code>I128</code>, seems like the same for <code>Duration</code> only makes sense</p>



<a name="491700227"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/383402-API%20design/topic/Datatype%20for%20representing%20epochs/near/491700227" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/383402-API-design/topic/Datatype.20for.20representing.20epochs.html#491700227">(Jan 03 2025 at 03:47)</a>:</h4>
<p>If you don't know what to use for instant, then <code>I128</code> is 99.9999999% safe for any usage and <code>I64</code> is 99.9% safe</p>



<a name="491700338"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/383402-API%20design/topic/Datatype%20for%20representing%20epochs/near/491700338" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/383402-API-design/topic/Datatype.20for.20representing.20epochs.html#491700338">(Jan 03 2025 at 03:49)</a>:</h4>
<p>yeah there's always a performance argument for <code>I64</code>, which I think would mainly come up if you're storing a bunch of these in memory, like a time series or something</p>



<a name="491700351"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/383402-API%20design/topic/Datatype%20for%20representing%20epochs/near/491700351" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/383402-API-design/topic/Datatype.20for.20representing.20epochs.html#491700351">(Jan 03 2025 at 03:49)</a>:</h4>
<p>but maybe for use cases like that you're storing a plain integer anyway and just converting to <code>Instant</code> or <code>Duration</code> one at a time, briefly</p>



<a name="491700471"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/383402-API%20design/topic/Datatype%20for%20representing%20epochs/near/491700471" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/383402-API-design/topic/Datatype.20for.20representing.20epochs.html#491700471">(Jan 03 2025 at 03:51)</a>:</h4>
<p>A <code>Instant.to_i64() : Instant -&gt; Result I64 [Overflow]</code> method should be sufficient for those that want small storage, and <code>Instant.from_i64() : I64 -&gt; Instant</code> is infallible</p>



<a name="491700477"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/383402-API%20design/topic/Datatype%20for%20representing%20epochs/near/491700477" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/383402-API-design/topic/Datatype.20for.20representing.20epochs.html#491700477">(Jan 03 2025 at 03:51)</a>:</h4>
<p>We should default to safe unless there's a big cost</p>



<a name="491703221"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/383402-API%20design/topic/Datatype%20for%20representing%20epochs/near/491703221" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ayaz Hafiz <a href="https://roc-lang.github.io/zulip-export/stream/383402-API-design/topic/Datatype.20for.20representing.20epochs.html#491703221">(Jan 03 2025 at 04:35)</a>:</h4>
<p>for high performance time series (trading use case) my experience is you store offsets relative to some known time, and your TS is usually fixed an intervals, so you often elide explicit intervals anyway. I would think I128 is fine in general</p>



<a name="491947584"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/383402-API%20design/topic/Datatype%20for%20representing%20epochs/near/491947584" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pit Capitain <a href="https://roc-lang.github.io/zulip-export/stream/383402-API-design/topic/Datatype.20for.20representing.20epochs.html#491947584">(Jan 05 2025 at 08:13)</a>:</h4>
<p>Re negative Durations: maybe the name "Duration" isn't quite right? I think what we're talking about is an "InstantDifference"? For me, a "Duration" is never negative. I can't think of a better name for this concept, but the folks here are very good in proposing alternatives...</p>



<a name="492077564"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/383402-API%20design/topic/Datatype%20for%20representing%20epochs/near/492077564" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/383402-API-design/topic/Datatype.20for.20representing.20epochs.html#492077564">(Jan 06 2025 at 10:33)</a>:</h4>
<p>Interesting</p>



<hr><p>Last updated: Nov 01 2025 at 12:13 UTC</p>
</html>