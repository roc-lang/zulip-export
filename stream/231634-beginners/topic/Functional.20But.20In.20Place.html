<html>
<head><meta charset="utf-8"><title>Functional But In Place · beginners · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/index.html">beginners</a></h2>
<h3>Topic: <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Functional.20But.20In.20Place.html">Functional But In Place</a></h3>

<hr>

<base href="https://roc.zulipchat.com">

<head><link href="https://roc-lang.github.io/zulip-export/style.css" rel="stylesheet"></head>

<a name="339725407"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Functional%20But%20In%20Place/near/339725407" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Giacomo Cavalieri <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Functional.20But.20In.20Place.html#339725407">(Mar 05 2023 at 17:26)</a>:</h4>
<p>Hello! I finally managed to find some spare time to write some Roc, so far I really like it! One thing I'd love to try is to write Okasaki's functional pearl on RB trees</p>



<a name="339725468"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Functional%20But%20In%20Place/near/339725468" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Giacomo Cavalieri <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Functional.20But.20In.20Place.html#339725468">(Mar 05 2023 at 17:26)</a>:</h4>
<p>From what I can recall Roc uses Perceus which should allow functional-but-in-place algorithms, and I remember seeing an example on quicksort in one of Richard's talk on youtube, can I expect the same kind of optimization to be applied to a pure functional algorithm written on a custom datatype like an RB-tree node? Or is it something that is just available for lists for now?</p>



<a name="339725565"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Functional%20But%20In%20Place/near/339725565" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Functional.20But.20In.20Place.html#339725565">(Mar 05 2023 at 17:27)</a>:</h4>
<p>Yeah, should apply to custom types.</p>



<a name="339725631"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Functional%20But%20In%20Place/near/339725631" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Functional.20But.20In.20Place.html#339725631">(Mar 05 2023 at 17:28)</a>:</h4>
<p>Though of course depending on how things are written can have unintentional copies.</p>



<a name="339725743"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Functional%20But%20In%20Place/near/339725743" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Giacomo Cavalieri <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Functional.20But.20In.20Place.html#339725743">(Mar 05 2023 at 17:30)</a>:</h4>
<p>Thanks! I'll se what I can do :)</p>



<a name="339725803"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Functional%20But%20In%20Place/near/339725803" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Functional.20But.20In.20Place.html#339725803">(Mar 05 2023 at 17:30)</a>:</h4>
<p>we're also not quite using perceus, but its predecessor "counting immutable beans". That means RC is a bit less efficient in some cases. But in general yes, it should work, and if it doesn't, that would be valuable to know!</p>



<a name="339725977"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Functional%20But%20In%20Place/near/339725977" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Functional.20But.20In.20Place.html#339725977">(Mar 05 2023 at 17:32)</a>:</h4>
<p>After you write it up, if you want help debugging allocations, I have messed with that a lot.</p>



<a name="339730360"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Functional%20But%20In%20Place/near/339730360" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Giacomo Cavalieri <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Functional.20But.20In.20Place.html#339730360">(Mar 05 2023 at 18:15)</a>:</h4>
<p>Ok so I finished writing the code it's exactly as presented in Okasaki's pearl: <a href="https://gist.github.com/giacomocavalieri/1ea3836783a2668c9fb4852de13f313d">https://gist.github.com/giacomocavalieri/1ea3836783a2668c9fb4852de13f313d</a></p>



<a name="339730368"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Functional%20But%20In%20Place/near/339730368" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Giacomo Cavalieri <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Functional.20But.20In.20Place.html#339730368">(Mar 05 2023 at 18:15)</a>:</h4>
<p>Just to make sure I get the hang of how the reuse could work, for example in the <code>balance</code> function it should be able to reuse the <code>Tree</code> constructor instead of allocating a new one?</p>



<a name="339731449"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Functional%20But%20In%20Place/near/339731449" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Functional.20But.20In.20Place.html#339731449">(Mar 05 2023 at 18:26)</a>:</h4>
<p>assuming a unique input, yes</p>



<hr><p>Last updated: Mar 01 2026 at 12:20 UTC</p>
</html>