<html>
<head><meta charset="utf-8"><title>Iterator type with the new compiler Â· beginners Â· Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/index.html">beginners</a></h2>
<h3>Topic: <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Iterator.20type.20with.20the.20new.20compiler.html">Iterator type with the new compiler</a></h3>

<hr>

<base href="https://roc.zulipchat.com">

<head><link href="https://roc-lang.github.io/zulip-export/style.css" rel="stylesheet"></head>

<a name="563298946"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Iterator%20type%20with%20the%20new%20compiler/near/563298946" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Matthieu Pizenberg <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Iterator.20type.20with.20the.20new.20compiler.html#563298946">(Dec 11 2025 at 23:18)</a>:</h4>
<p>Iâ€™ve read that iterators are not yet part of the new compiler but Iâ€™m curious, if you had to define an <code>Iter</code> type with what exists today in the new compiler, how would you define it?</p>
<p>For example, in elm, Iâ€™d probably define the type like this:</p>
<div class="codehilite" data-code-language="Elm"><pre><span></span><code><span class="kr">type</span><span class="w"> </span><span class="kt">Iter</span><span class="w"> </span><span class="nv">a</span><span class="w"> </span><span class="nv">s</span>
<span class="w">    </span><span class="nf">=</span><span class="w"> </span><span class="kt">Iter</span>
<span class="w">        </span><span class="p">{</span><span class="w"> </span><span class="nv">state</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="nv">s</span>
<span class="w">        </span><span class="p">,</span><span class="w"> </span><span class="nv">next_</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Next</span><span class="w"> </span><span class="nv">a</span><span class="w"> </span><span class="nv">s</span>
<span class="w">        </span><span class="p">}</span>

<span class="kr">type</span><span class="w"> </span><span class="kr">alias</span><span class="w"> </span><span class="kt">Next</span><span class="w"> </span><span class="nv">a</span><span class="w"> </span><span class="nv">s</span><span class="w"> </span><span class="nf">=</span>
<span class="w">    </span><span class="nv">s</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Maybe</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nv">a</span><span class="p">,</span><span class="w"> </span><span class="nv">s</span><span class="w"> </span><span class="p">)</span>

<span class="nv">next</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Iter</span><span class="w"> </span><span class="nv">a</span><span class="w"> </span><span class="nv">s</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Maybe</span><span class="w"> </span><span class="nv">a</span>
<span class="nv">next</span><span class="w"> </span><span class="p">(</span><span class="kt">Iter</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nv">state</span><span class="p">,</span><span class="w"> </span><span class="nv">next_</span><span class="w"> </span><span class="p">})</span><span class="w"> </span><span class="nf">=</span>
<span class="w">    </span><span class="kt">Maybe</span><span class="nf">.</span><span class="nv">map</span><span class="w"> </span><span class="kt">Tuple</span><span class="nf">.</span><span class="nv">first</span><span class="w"> </span><span class="p">(</span><span class="nv">next_</span><span class="w"> </span><span class="nv">state</span><span class="p">)</span>

<span class="nv">step</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Iter</span><span class="w"> </span><span class="nv">a</span><span class="w"> </span><span class="nv">s</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="kt">Maybe</span><span class="w"> </span><span class="nv">a</span><span class="p">,</span><span class="w"> </span><span class="kt">Iter</span><span class="w"> </span><span class="nv">a</span><span class="w"> </span><span class="nv">s</span><span class="w"> </span><span class="p">)</span>
<span class="nv">step</span><span class="w"> </span><span class="p">((</span><span class="kt">Iter</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nv">state</span><span class="p">,</span><span class="w"> </span><span class="nv">next_</span><span class="w"> </span><span class="p">})</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="nv">iter</span><span class="p">)</span><span class="w"> </span><span class="nf">=</span>
<span class="w">    </span><span class="kr">case</span><span class="w"> </span><span class="nv">next_</span><span class="w"> </span><span class="nv">state</span><span class="w"> </span><span class="kr">of</span>
<span class="w">        </span><span class="kt">Just</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nv">a</span><span class="p">,</span><span class="w"> </span><span class="nv">newState</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">            </span><span class="p">(</span><span class="w"> </span><span class="kt">Just</span><span class="w"> </span><span class="nv">a</span><span class="p">,</span><span class="w"> </span><span class="kt">Iter</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nv">state</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nv">newState</span><span class="p">,</span><span class="w"> </span><span class="nv">next_</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nv">next_</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">)</span>

<span class="w">        </span><span class="kt">Nothing</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">            </span><span class="p">(</span><span class="w"> </span><span class="kt">Nothing</span><span class="p">,</span><span class="w"> </span><span class="nv">iter</span><span class="w"> </span><span class="p">)</span>
</code></pre></div>



<a name="563299042"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Iterator%20type%20with%20the%20new%20compiler/near/563299042" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Matthieu Pizenberg <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Iterator.20type.20with.20the.20new.20compiler.html#563299042">(Dec 11 2025 at 23:19)</a>:</h4>
<p>Iâ€™m asking because I wanted to experiment a bit with it, but struggling a bit with the type definitions ^^.</p>



<a name="563299759"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Iterator%20type%20with%20the%20new%20compiler/near/563299759" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Iterator.20type.20with.20the.20new.20compiler.html#563299759">(Dec 11 2025 at 23:28)</a>:</h4>
<p>You may find this older thread interesting <a class="message-link" href="/#narrow/channel/304641-ideas/topic/Iterators.20and.20fusion.20proposal/near/471140115">#ideas &gt; Iterators and fusion proposal @ ðŸ’¬</a></p>



<a name="563300166"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Iterator%20type%20with%20the%20new%20compiler/near/563300166" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Matthieu Pizenberg <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Iterator.20type.20with.20the.20new.20compiler.html#563300166">(Dec 11 2025 at 23:33)</a>:</h4>
<p>interesting, though it doesnâ€™t seem to be up-to-date with the current syntax. Do you have example codebases with lots of different type definitions? I donâ€™t think there are any records or type aliases in Builtin.roc for example.</p>



<a name="563300480"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Iterator%20type%20with%20the%20new%20compiler/near/563300480" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Iterator.20type.20with.20the.20new.20compiler.html#563300480">(Dec 11 2025 at 23:37)</a>:</h4>
<p>There are many examples in the <code>test/snapshots</code> directory which are using the current syntax</p>



<a name="563300530"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Iterator%20type%20with%20the%20new%20compiler/near/563300530" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Iterator.20type.20with.20the.20new.20compiler.html#563300530">(Dec 11 2025 at 23:38)</a>:</h4>
<p>Nothing on <code>Iter</code> specifically -- I'm not sure if static dispatch would change the semantics significantly, or if it's just updating the syntax to use parens and commas etc</p>



<a name="563302677"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Iterator%20type%20with%20the%20new%20compiler/near/563302677" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Matthieu Pizenberg <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Iterator.20type.20with.20the.20new.20compiler.html#563302677">(Dec 12 2025 at 00:04)</a>:</h4>
<p>For example, when I try this:</p>
<div class="codehilite" data-code-language="Ruby"><pre><span></span><code><span class="no">Iter</span><span class="p">(</span><span class="n">item</span><span class="p">,</span><span class="w"> </span><span class="n">s</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="o">=</span><span class="w"> </span><span class="o">[</span><span class="no">MyIter</span><span class="p">({</span><span class="w"> </span><span class="ss">state</span><span class="p">:</span><span class="w"> </span><span class="n">s</span><span class="p">,</span><span class="w"> </span><span class="k">next</span><span class="p">:</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="no">Try</span><span class="p">((</span><span class="n">item</span><span class="p">,</span><span class="w"> </span><span class="n">s</span><span class="p">),</span><span class="w"> </span><span class="o">[</span><span class="no">Empty</span><span class="o">]</span><span class="p">)</span><span class="w"> </span><span class="p">})</span><span class="o">].</span><span class="p">{</span>
<span class="w">    </span><span class="k">next</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">|</span><span class="no">MyIter</span><span class="p">(</span><span class="n">myiter</span><span class="p">)</span><span class="o">|</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">myiter</span><span class="o">.</span><span class="n">next</span><span class="p">(</span><span class="n">myiter</span><span class="o">.</span><span class="n">state</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>I get this error</p>
<div class="codehilite"><pre><span></span><code>-- MISSING METHOD --------------------------------

This next method is being called on a value whose type doesn&#39;t have that method:
    â”Œâ”€ day03.roc:111:16
    â”‚
111 â”‚         myiter.next(myiter.state)
    â”‚                ^^^^

The value&#39;s type, which does not have a method named next, is:

    { state: _field }
</code></pre></div>
<p>I havenâ€™t found much examples in the snapshots. If you have specific files in mind, let me know.</p>



<a name="563302996"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Iterator%20type%20with%20the%20new%20compiler/near/563302996" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Matthieu Pizenberg <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Iterator.20type.20with.20the.20new.20compiler.html#563302996">(Dec 12 2025 at 00:08)</a>:</h4>
<p>Ah I got this one!</p>
<div class="codehilite" data-code-language="Ruby"><pre><span></span><code><span class="no">Iter</span><span class="p">(</span><span class="n">item</span><span class="p">,</span><span class="w"> </span><span class="n">s</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="o">=</span><span class="w"> </span><span class="o">[</span><span class="no">MyIter</span><span class="p">({</span><span class="w"> </span><span class="ss">state</span><span class="p">:</span><span class="w"> </span><span class="n">s</span><span class="p">,</span><span class="w"> </span><span class="k">next</span><span class="p">:</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="no">Try</span><span class="p">((</span><span class="n">item</span><span class="p">,</span><span class="w"> </span><span class="n">s</span><span class="p">),</span><span class="w"> </span><span class="o">[</span><span class="no">Empty</span><span class="o">]</span><span class="p">)</span><span class="w"> </span><span class="p">})</span><span class="o">].</span><span class="p">{</span>
<span class="w">    </span><span class="k">next</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="no">Iter</span><span class="p">(</span><span class="n">item</span><span class="p">,</span><span class="w"> </span><span class="n">s</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="no">Try</span><span class="p">((</span><span class="n">item</span><span class="p">,</span><span class="w"> </span><span class="n">s</span><span class="p">),</span><span class="w"> </span><span class="o">[</span><span class="no">Empty</span><span class="o">]</span><span class="p">)</span>
<span class="w">    </span><span class="k">next</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">|</span><span class="no">MyIter</span><span class="p">(</span><span class="n">myiter</span><span class="p">)</span><span class="o">|</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="p">(</span><span class="n">myiter</span><span class="o">.</span><span class="n">next</span><span class="p">)(</span><span class="n">myiter</span><span class="o">.</span><span class="n">state</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>



<a name="563303169"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Iterator%20type%20with%20the%20new%20compiler/near/563303169" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Matthieu Pizenberg <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Iterator.20type.20with.20the.20new.20compiler.html#563303169">(Dec 12 2025 at 00:10)</a>:</h4>
<p>Is there a way to make a type opaque?</p>



<a name="563303696"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Iterator%20type%20with%20the%20new%20compiler/near/563303696" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Iterator.20type.20with.20the.20new.20compiler.html#563303696">(Dec 12 2025 at 00:14)</a>:</h4>
<p><code>::</code> instead of <code>:=</code></p>



<hr><p>Last updated: Mar 01 2026 at 12:20 UTC</p>
</html>