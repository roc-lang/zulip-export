<html>
<head><meta charset="utf-8"><title>Nix · beginners · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/index.html">beginners</a></h2>
<h3>Topic: <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Nix.html">Nix</a></h3>

<hr>

<base href="https://roc.zulipchat.com">

<head><link href="https://roc-lang.github.io/zulip-export/style.css" rel="stylesheet"></head>

<a name="259807220"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Nix/near/259807220" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luiz de Oliveira <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Nix.html#259807220">(Oct 31 2021 at 20:39)</a>:</h4>
<p>I can't run <code>nix-shell</code>. It runs if I use sudo, but is it suposed to need sudo to run?</p>
<p><a href="/user_uploads/22008/NkcDO4c4pe3fBff7--vWjgih/image.png">image.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/22008/NkcDO4c4pe3fBff7--vWjgih/image.png" title="image.png"><img src="/user_uploads/22008/NkcDO4c4pe3fBff7--vWjgih/image.png"></a></div>



<a name="259807377"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Nix/near/259807377" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luiz de Oliveira <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Nix.html#259807377">(Oct 31 2021 at 20:43)</a>:</h4>
<p>Can't run the editor:<br>
<a href="/user_uploads/22008/2tMrR1KkmRcqpt6oLx2G22c_/image.png">image.png</a> </p>
<div class="message_inline_image"><a href="/user_uploads/22008/2tMrR1KkmRcqpt6oLx2G22c_/image.png" title="image.png"><img src="/user_uploads/22008/2tMrR1KkmRcqpt6oLx2G22c_/image.png"></a></div><p>Can't install vulkan adapter:<br>
<a href="/user_uploads/22008/UtqAbG_1u1ZwHaHDNdcZfTcA/image.png">image.png</a><br>
<a href="/user_uploads/22008/6_iyh22h4LqzNlfzDXC30KKQ/image.png">image.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/22008/UtqAbG_1u1ZwHaHDNdcZfTcA/image.png" title="image.png"><img src="/user_uploads/22008/UtqAbG_1u1ZwHaHDNdcZfTcA/image.png"></a></div><div class="message_inline_image"><a href="/user_uploads/22008/6_iyh22h4LqzNlfzDXC30KKQ/image.png" title="image.png"><img src="/user_uploads/22008/6_iyh22h4LqzNlfzDXC30KKQ/image.png"></a></div>



<a name="259810499"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Nix/near/259810499" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Hicks <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Nix.html#259810499">(Oct 31 2021 at 22:00)</a>:</h4>
<p>You shouldn’t have to use sudo. How did you install Nix? It should have a nixpkgs definition be default too</p>



<a name="259837352"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Nix/near/259837352" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Nix.html#259837352">(Nov 01 2021 at 08:24)</a>:</h4>
<p>Yeah I'd recommend uninstalling nix and installing with:</p>
<div class="codehilite"><pre><span></span><code>curl -L https://nixos.org/nix/install | sh
</code></pre></div>
<p>The installer will ask for your sudo password when it needs it.</p>



<a name="259839602"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Nix/near/259839602" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Nix.html#259839602">(Nov 01 2021 at 08:54)</a>:</h4>
<p>I'll add a tip in the <code>Request adapter</code> error message on how to run the editor from nix.</p>



<a name="259865674"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Nix/near/259865674" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Locria Cyber <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Nix.html#259865674">(Nov 01 2021 at 13:51)</a>:</h4>
<p>I'm not familiar with Nix</p>



<a name="259865725"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Nix/near/259865725" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Locria Cyber <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Nix.html#259865725">(Nov 01 2021 at 13:52)</a>:</h4>
<p>how do I set the default linker for rust?</p>



<a name="259866012"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Nix/near/259866012" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Nix.html#259866012">(Nov 01 2021 at 13:55)</a>:</h4>
<p><a href="https://github.com/rtfeldman/roc/blob/trunk/BUILDING_FROM_SOURCE.md#use-lld-for-the-linker">https://github.com/rtfeldman/roc/blob/trunk/BUILDING_FROM_SOURCE.md#use-lld-for-the-linker</a></p>



<a name="259866211"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Nix/near/259866211" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Locria Cyber <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Nix.html#259866211">(Nov 01 2021 at 13:56)</a>:</h4>
<p>That's not for Nix</p>



<a name="259866327"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Nix/near/259866327" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Locria Cyber <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Nix.html#259866327">(Nov 01 2021 at 13:57)</a>:</h4>
<p>I found this tutorial<br>
<a href="https://www.boronine.com/2018/02/02/Nix/#case-study-hsluv">https://www.boronine.com/2018/02/02/Nix/#case-study-hsluv</a></p>



<a name="259867786"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Nix/near/259867786" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Locria Cyber <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Nix.html#259867786">(Nov 01 2021 at 14:09)</a>:</h4>
<p>Who designed this language?</p>



<a name="259868361"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Nix/near/259868361" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Locria Cyber <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Nix.html#259868361">(Nov 01 2021 at 14:13)</a>:</h4>
<p>I hate Nix</p>



<a name="259869111"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Nix/near/259869111" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Locria Cyber <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Nix.html#259869111">(Nov 01 2021 at 14:19)</a>:</h4>
<p>I give up</p>



<a name="259869202"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Nix/near/259869202" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Locria Cyber <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Nix.html#259869202">(Nov 01 2021 at 14:20)</a>:</h4>
<p>because <strong>obviously</strong> you can't create a folder whatsoever</p>



<a name="259869300"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Nix/near/259869300" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Locria Cyber <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Nix.html#259869300">(Nov 01 2021 at 14:20)</a>:</h4>
<div class="codehilite"><pre><span></span><code>in pkgs.mkShell {
  name = &quot;roc&quot;;
  buildInputs = inputs ++ darwinInputs ++ linuxInputs;

  # Additional Env vars
  LLVM_SYS_120_PREFIX = &quot;${llvmPkgs.llvm.dev}&quot;;
  LD_LIBRARY_PATH = with pkgs;
    lib.makeLibraryPath
    ([ pkg-config stdenv.cc.cc.lib libffi ncurses zlib ] ++ linuxInputs);
  NIX_GLIBC_PATH =
    if pkgs.stdenv.isLinux then &quot;${pkgs.glibc_multi.out}/lib&quot; else &quot;&quot;;

  shellHook = &#39;&#39;
    mkdir -p $out/bin  # permission denied
    ln -sf $mold/bin/mold $out/bin/ld
  &#39;&#39;;
}
</code></pre></div>



<a name="259869420"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Nix/near/259869420" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Locria Cyber <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Nix.html#259869420">(Nov 01 2021 at 14:21)</a>:</h4>
<p>the documentation of commands like <code>mkShell</code> is obscure. I'm not sure if the authors have written any</p>



<a name="259869540"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Nix/near/259869540" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Locria Cyber <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Nix.html#259869540">(Nov 01 2021 at 14:22)</a>:</h4>
<p>The official documentation of <code>nix-shell</code> mentions none of how to configure the shell in Nix.</p>



<a name="259869847"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Nix/near/259869847" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Nix.html#259869847">(Nov 01 2021 at 14:25)</a>:</h4>
<p>There already is a shell.nix file in the roc repo which is loaded when you execute <code>nix-shell</code>. From that shell you can execute cargo build, cargo test, cargo run repl... . Is there something else you are trying to configure?</p>



<a name="259870935"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Nix/near/259870935" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luiz de Oliveira <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Nix.html#259870935">(Nov 01 2021 at 14:33)</a>:</h4>
<p><span class="user-mention silent" data-user-id="419641">Brian Hicks</span> <a href="#narrow/stream/231634-beginners/topic/Nix/near/259810499">said</a>:</p>
<blockquote>
<p>You shouldn’t have to use sudo. How did you install Nix? It should have a nixpkgs definition be default too</p>
</blockquote>
<p>I just ran: <code>curl -L https://nixos.org/nix/install | sh</code><br>
From here: <a href="https://nixos.org/download.html">https://nixos.org/download.html</a></p>



<a name="259871072"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Nix/near/259871072" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Locria Cyber <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Nix.html#259871072">(Nov 01 2021 at 14:34)</a>:</h4>
<p>I want to symlink <code>mold</code> to <code>bin/ld</code>, and Nix says I don't have permission</p>



<a name="259871404"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Nix/near/259871404" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Locria Cyber <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Nix.html#259871404">(Nov 01 2021 at 14:37)</a>:</h4>
<p>The online documentation is useless: <a href="https://nixos.org/guides/dev-environment.html">https://nixos.org/guides/dev-environment.html</a></p>



<a name="259871814"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Nix/near/259871814" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Nix.html#259871814">(Nov 01 2021 at 14:40)</a>:</h4>
<p>I think <span class="user-mention" data-user-id="281543">@Folkert de Vries</span>  tested mold for roc a while ago and I think it was not faster in our case.</p>



<a name="259872076"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Nix/near/259872076" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Nix.html#259872076">(Nov 01 2021 at 14:43)</a>:</h4>
<p>can't hurt to try it again though. it really should be much faster ...</p>



<a name="259872323"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Nix/near/259872323" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Nix.html#259872323">(Nov 01 2021 at 14:44)</a>:</h4>
<p>Can you just set mold to be the linker with rustflags Folkert?</p>



<a name="259872898"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Nix/near/259872898" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Locria Cyber <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Nix.html#259872898">(Nov 01 2021 at 14:49)</a>:</h4>
<p>I already did. Nix doesn't respect that</p>



<a name="259874160"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Nix/near/259874160" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Nix.html#259874160">(Nov 01 2021 at 14:59)</a>:</h4>
<p>I think you'd need to set some environment variable</p>



<a name="259876014"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Nix/near/259876014" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Locria Cyber <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Nix.html#259876014">(Nov 01 2021 at 15:13)</a>:</h4>
<p>I give up</p>



<a name="259876070"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Nix/near/259876070" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Locria Cyber <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Nix.html#259876070">(Nov 01 2021 at 15:14)</a>:</h4>
<p>I'll try out <code>guix</code>, which has better documentation</p>



<a name="259878856"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Nix/near/259878856" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Hicks <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Nix.html#259878856">(Nov 01 2021 at 15:36)</a>:</h4>
<p>I think we might want to separate these two conversations. I'm going to proceed helping Luiz here since he opened the topic.</p>



<a name="259879085"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Nix/near/259879085" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Hicks <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Nix.html#259879085">(Nov 01 2021 at 15:38)</a>:</h4>
<p><span class="user-mention" data-user-id="441430">@Luiz de Oliveira</span> I'm guessing you're on Linux, right? I think the move here is going to be to remove Nix completely and reinstall it (unless you have built something precious that lives in the Nix store?) Lemme try and find you some up-to-date instructions for doing that.</p>



<a name="259879287"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Nix/near/259879287" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Hicks <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Nix.html#259879287">(Nov 01 2021 at 15:40)</a>:</h4>
<p>ah, <a href="https://nixos.org/download.html#nix-uninstall">https://nixos.org/download.html#nix-uninstall</a> says you just have to remove <code>/nix</code>. <em>However</em>, based on your screenshots I'm guessing that some part of your profile may also be set up to try and connect to a Nix daemon instead of using the single-user mode. Since that's the case, it may be helpful to remove dotfiles starting in <code>~</code>and <code>~/.config</code> that have "nix" in the name.</p>



<a name="259898291"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Nix/near/259898291" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Nix.html#259898291">(Nov 01 2021 at 18:04)</a>:</h4>
<p><span class="user-mention" data-user-id="441430">@Luiz de Oliveira</span> you may have ran a nix command with sudo once which could have altered permissions for some files/directories, causing you to no longer be able to execute the same command without sudo.</p>



<a name="260047848"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Nix/near/260047848" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Notification Bot <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Nix.html#260047848">(Nov 02 2021 at 19:46)</a>:</h4>
<p><span class="user-mention silent" data-user-id="441430">Luiz de Oliveira</span> has marked this topic as resolved.</p>



<a name="260047898"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Nix/near/260047898" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luiz de Oliveira <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Nix.html#260047898">(Nov 02 2021 at 19:47)</a>:</h4>
<p>Yeah, it worked. I had to do a full uninstall also deleting related config and other stuff from my home directory.</p>



<a name="260096032"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Nix/near/260096032" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Locria Cyber <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Nix.html#260096032">(Nov 03 2021 at 07:07)</a>:</h4>
<p>Nix is really poorly designed</p>



<a name="260096040"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Nix/near/260096040" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Locria Cyber <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Nix.html#260096040">(Nov 03 2021 at 07:07)</a>:</h4>
<p>In here <a href="https://medium.com/att-israel/how-nix-shell-saved-our-teams-sanity-a22fe6668d0e">https://medium.com/att-israel/how-nix-shell-saved-our-teams-sanity-a22fe6668d0e</a></p>



<a name="260096063"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Nix/near/260096063" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Locria Cyber <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Nix.html#260096063">(Nov 03 2021 at 07:07)</a>:</h4>
<p><a href="/user_uploads/22008/zFgp3muzhvay4bG8Ahr6La7a/image.png">image.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/22008/zFgp3muzhvay4bG8Ahr6La7a/image.png" title="image.png"><img src="/user_uploads/22008/zFgp3muzhvay4bG8Ahr6La7a/image.png"></a></div>



<a name="260096113"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Nix/near/260096113" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Locria Cyber <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Nix.html#260096113">(Nov 03 2021 at 07:08)</a>:</h4>
<div class="codehilite"><pre><span></span><code>{ lib
, stdenv
, fetchurl
, testVersion
, hello
}:

stdenv.mkDerivation rec {
  pname = &quot;hello&quot;;
  version = &quot;2.10&quot;;

  src = fetchurl {
    url = &quot;mirror://gnu/hello/${pname}-${version}.tar.gz&quot;;
    sha256 = &quot;0ssi1wpaf7plaswqqjwigppsg5fyh99vdlb9kzl7c9lng89ndq1i&quot;;
  };

  doCheck = true;

  passthru.tests.version =
    testVersion { package = hello; };

  meta = with lib; {
    description = &quot;A program that produces a familiar, friendly greeting&quot;;
    longDescription = &#39;&#39;
      GNU Hello is a program that prints &quot;Hello, world!&quot; when you run it.
      It is fully customizable.
    &#39;&#39;;
    homepage = &quot;https://www.gnu.org/software/hello/manual/&quot;;
    changelog = &quot;https://git.savannah.gnu.org/cgit/hello.git/plain/NEWS?h=v${version}&quot;;
    license = licenses.gpl3Plus;
    maintainers = [ maintainers.eelco ];
    platforms = platforms.all;
  };
}
</code></pre></div>



<a name="260096178"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Nix/near/260096178" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Locria Cyber <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Nix.html#260096178">(Nov 03 2021 at 07:09)</a>:</h4>
<p>Why the derivation description itself doesn't include how to build the derivation?</p>



<a name="260096298"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Nix/near/260096298" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Locria Cyber <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Nix.html#260096298">(Nov 03 2021 at 07:11)</a>:</h4>
<p>On the other hand, guix assumes you use bash because it only integrates with bash, and you have to specify all the dependencies <strong>as command line arguments</strong>.</p>



<a name="260200672"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Nix/near/260200672" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lucas Rosa <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Nix.html#260200672">(Nov 03 2021 at 21:33)</a>:</h4>
<p>It is tough at first but idk about poorly designed</p>



<a name="260200701"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Nix/near/260200701" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lucas Rosa <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Nix.html#260200701">(Nov 03 2021 at 21:33)</a>:</h4>
<p>It definitely lacks thorough documentation</p>



<a name="260200706"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Nix/near/260200706" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lucas Rosa <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Nix.html#260200706">(Nov 03 2021 at 21:33)</a>:</h4>
<p>Which is a pain</p>



<a name="260331081"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Nix/near/260331081" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nigel Thorne <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Nix.html#260331081">(Nov 04 2021 at 20:38)</a>:</h4>
<p>I've been trying to spin up the nix shell too. </p>
<p>On osx it gets stuck with 'zig-0.8.1 is broken' (not going to work any time soon).</p>
<p>On Ubuntu I get a 'glibc 2.33 not found ' error. Googling it tells me the system version has to match; so I upgrade Ubuntu to hairy hippo. Now the system version matches... same error. :(</p>



<a name="260333069"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Nix/near/260333069" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Nix.html#260333069">(Nov 04 2021 at 20:53)</a>:</h4>
<p>Is the glibc error when loading the nix shell or when trying to running certain roc tests?</p>



<a name="260376340"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Nix/near/260376340" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Nix.html#260376340">(Nov 05 2021 at 08:20)</a>:</h4>
<blockquote>
<p>On osx it gets stuck with 'zig-0.8.1 is broken'</p>
</blockquote>
<p>This should've been fixed a couple of days ago, make sure to use the latest trunk. I'm still working on making nix work on M1 macs but otherwise you should be good.</p>
<blockquote>
<p>On Ubuntu I get a 'glibc 2.33 not found ' error.</p>
</blockquote>
<p>Can you share the complete error? Some shells like zsh can produce this error because its dependencies were linked with a different version of glibc than what we use inside nix (I think).</p>



<a name="260397738"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Nix/near/260397738" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Nix.html#260397738">(Nov 05 2021 at 12:22)</a>:</h4>
<p><span class="user-mention silent" data-user-id="361169">Anton</span> <a href="#narrow/stream/231634-beginners/topic/.E2.9C.94.20Nix/near/260376340">said</a>:</p>
<blockquote>
<p>I'm still working on making nix work on M1 macs but otherwise you should be good.</p>
</blockquote>
<p>Fix for M1 macs is now available on the branch <code>nix_M1_fix_v2</code></p>



<a name="260401652"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Nix/near/260401652" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jakub Konka <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Nix.html#260401652">(Nov 05 2021 at 13:01)</a>:</h4>
<p>I actually have the same problem trying <code>nix-shell</code> on NixOS:</p>
<div class="codehilite"><pre><span></span><code>patching script interpreter paths in /nix/store/jb21sa8n3nhqmiscqg8cmi7xm8qs3yns-niv-0.2.19-data
checking for references to /build/ in /nix/store/jb21sa8n3nhqmiscqg8cmi7xm8qs3yns-niv-0.2.19-data...
bash: /nix/store/jsp3h3wpzc842j0rz61m5ly71ak6qgdn-glibc-2.32-54/lib/libc.so.6: version `GLIBC_2.33&#39; not found (required by /nix/store/jzjqfff4cldlm2wpld313a2s1v6r3ycb-ncurses-6.2/lib/libncursesw.so.6)
</code></pre></div>



<a name="260402457"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Nix/near/260402457" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lucas Rosa <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Nix.html#260402457">(Nov 05 2021 at 13:08)</a>:</h4>
<p>hm that’s odd</p>



<a name="260402525"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Nix/near/260402525" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lucas Rosa <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Nix.html#260402525">(Nov 05 2021 at 13:08)</a>:</h4>
<p>Maybe libncurses needs to be explicitly listed?</p>



<a name="260402875"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Nix/near/260402875" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jakub Konka <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Nix.html#260402875">(Nov 05 2021 at 13:12)</a>:</h4>
<p>Oh, I think I found the problem, at least on the NixOS: <a href="https://github.com/NixOS/nixpkgs/issues/141323">https://github.com/NixOS/nixpkgs/issues/141323</a></p>



<a name="260403435"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Nix/near/260403435" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Nix.html#260403435">(Nov 05 2021 at 13:17)</a>:</h4>
<p>We have this issue tracked as #1846.</p>



<a name="260403908"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Nix/near/260403908" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jakub Konka <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Nix.html#260403908">(Nov 05 2021 at 13:21)</a>:</h4>
<p><span class="user-mention silent" data-user-id="361169">Anton</span> <a href="#narrow/stream/231634-beginners/topic/.E2.9C.94.20Nix/near/260403435">said</a>:</p>
<blockquote>
<p>We have this issue tracked as #1846.</p>
</blockquote>
<p>Ah, nice, thanks! I somehow missed it while browsing Roc issues.</p>



<a name="260403969"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Nix/near/260403969" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Nix.html#260403969">(Nov 05 2021 at 13:21)</a>:</h4>
<p>Yeah, I improved the title just now :)</p>



<a name="260404212"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Nix/near/260404212" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lucas Rosa <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Nix.html#260404212">(Nov 05 2021 at 13:23)</a>:</h4>
<p>oh I see it’s because ncurses IS explicitly listed</p>



<a name="260405324"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Nix/near/260405324" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jakub Konka <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Nix.html#260405324">(Nov 05 2021 at 13:32)</a>:</h4>
<p>Yep, not sure if this breaks anything down the line for the linker, but not listing ncurses explicitly in <code>LD_LIBRARY_PATH</code> in <code>shell.nix</code> does make the error disappear. I'll try building REPL in the spawned shell and see if it trips up the linker and/or loader.</p>



<a name="260405454"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Nix/near/260405454" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jakub Konka <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Nix.html#260405454">(Nov 05 2021 at 13:34)</a>:</h4>
<p>REPL and the editor started just fine. How about the tests, let's see</p>



<a name="260405588"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Nix/near/260405588" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jakub Konka <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Nix.html#260405588">(Nov 05 2021 at 13:35)</a>:</h4>
<p>FYI, I love the look and feel of the editor!</p>



<a name="260405848"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Nix/near/260405848" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jakub Konka <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Nix.html#260405848">(Nov 05 2021 at 13:38)</a>:</h4>
<p>Haha, nvm, lack of ncurses in the ld path means I cannot spawn my dev tools like Vim for instance.</p>



<a name="260406566"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Nix/near/260406566" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lucas Rosa <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Nix.html#260406566">(Nov 05 2021 at 13:44)</a>:</h4>
<p>aahhh makes sense</p>



<a name="260406647"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Nix/near/260406647" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lucas Rosa <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Nix.html#260406647">(Nov 05 2021 at 13:45)</a>:</h4>
<p>btw if you want decent highlighting for now on roc files, setting it to coffeescript should work fine</p>



<a name="260428093"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Nix/near/260428093" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Nix.html#260428093">(Nov 05 2021 at 16:22)</a>:</h4>
<p><span class="user-mention silent" data-user-id="453721">Nigel Thorne</span> <a href="#narrow/stream/231634-beginners/topic/.E2.9C.94.20Nix/near/260331081">said</a>:</p>
<blockquote>
<p>On Ubuntu I get a 'glibc 2.33 not found ' error. Googling it tells me the system version has to match; so I upgrade Ubuntu to hairy hippo. Now the system version matches... same error. :(</p>
</blockquote>
<p>I actually just ran into this on my machine, not sure the exact cause, but it seems related to <code>direnv</code> and impure environments. Disabling <code>direnv</code>, and then running <code>nix-shell --pure</code> everything works on the latest trunk.</p>



<a name="260428950"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Nix/near/260428950" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Nix.html#260428950">(Nov 05 2021 at 16:28)</a>:</h4>
<p>Oh, actually <code>direnv</code> does still work, I had just accidentally tried to use <code>nix-shell</code> while in <code>direnv</code></p>



<a name="260429033"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Nix/near/260429033" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Nix.html#260429033">(Nov 05 2021 at 16:29)</a>:</h4>
<p>But either way, may relate to the issue listed here and errors like: <code>nix-shell: /nix/store/jsp3h3wpzc842j0rz61m5ly71ak6qgdn-glibc-2.32-54/lib/libc.so.6: version 'GLIBC_2.33' not found (required by /nix/store/7fv9v6mnlkb4ddf9kz1snknbvbfbcbx0-gcc-10.3.0-lib/lib/libstdc++.so.6)</code></p>



<a name="260502319"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Nix/near/260502319" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nigel Thorne <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Nix.html#260502319">(Nov 06 2021 at 09:10)</a>:</h4>
<p>I checked out <code>trunk</code> and <code>nix-shell</code> worked fine. Then <code>cargo run repl</code> also worked fine. :) very happy. -- on ubuntu (hippo)</p>



<a name="260527113"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Nix/near/260527113" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Leonardo Taglialegne <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Nix.html#260527113">(Nov 06 2021 at 17:49)</a>:</h4>
<p><del>I too found the <code>version 'GLIBC_2.33' not found</code> error, which is very surprising to me considering I'm on NixOS o.O</del> read backscroll better</p>



<a name="260618918"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Nix/near/260618918" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Locria Cyber <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Nix.html#260618918">(Nov 08 2021 at 06:20)</a>:</h4>
<p>Wow now I can't build with nix</p>
<div class="codehilite"><pre><span></span><code>&gt; nix-shell
warning: file &#39;nixpkgs&#39; was not found in the Nix search path (add it using $NIX_PATH or -I), at (string):1:9; will use bash from your environment
these derivations will be built:
  /nix/store/qkwcp87v5md9b61szs34sbcagmmp31n5-debugir.drv
these paths will be fetched (6.66 MiB download, 44.85 MiB unpacked):
  /nix/store/32r66ar7hxcc4a6hh26yx49w79bjhnw7-git-2.33.0
  /nix/store/qlhf7i79i8gqr3jm8ibf317q3v1l7wrb-openssh-8.7p1
copying path &#39;/nix/store/qlhf7i79i8gqr3jm8ibf317q3v1l7wrb-openssh-8.7p1&#39; from &#39;https://cache.nixos.org&#39;...
building &#39;/nix/store/qkwcp87v5md9b61szs34sbcagmmp31n5-debugir.drv&#39;...
unpacking sources
unpacking source archive /nix/store/07zhrxz5nwszhzclpff6acz4psciwfx5-source
source root is source
patching sources
configuring
fixing cmake files...
cmake flags: -DCMAKE_FIND_USE_SYSTEM_PACKAGE_REGISTRY=OFF -DCMAKE_FIND_USE_PACKAGE_REGISTRY=OFF -DCMAKE_EXPORT_NO_PACKAGE_REGISTRY=ON -DCMAKE_BUILD_TYPE=Release -DCMAKE_SKIP_BUILD_RPATH=ON -DBUILD_TESTING=OFF -DCMAKE_INSTALL_LOCALEDIR=/nix/store/da0k3xqppn4a3mkc1swb7sni4lk6nvak-debugir/share/locale -DCMAKE_INSTALL_LIBEXECDIR=/nix/store/da0k3xqppn4a3mkc1swb7sni4lk6nvak-debugir/libexec -DCMAKE_INSTALL_LIBDIR=/nix/store/da0k3xqppn4a3mkc1swb7sni4lk6nvak-debugir/lib -DCMAKE_INSTALL_DOCDIR=/nix/store/da0k3xqppn4a3mkc1swb7sni4lk6nvak-debugir/share/doc/DebugIR -DCMAKE_INSTALL_INFODIR=/nix/store/da0k3xqppn4a3mkc1swb7sni4lk6nvak-debugir/share/info -DCMAKE_INSTALL_MANDIR=/nix/store/da0k3xqppn4a3mkc1swb7sni4lk6nvak-debugir/share/man -DCMAKE_INSTALL_OLDINCLUDEDIR=/nix/store/da0k3xqppn4a3mkc1swb7sni4lk6nvak-debugir/include -DCMAKE_INSTALL_INCLUDEDIR=/nix/store/da0k3xqppn4a3mkc1swb7sni4lk6nvak-debugir/include -DCMAKE_INSTALL_SBINDIR=/nix/store/da0k3xqppn4a3mkc1swb7sni4lk6nvak-debugir/sbin -DCMAKE_INSTALL_BINDIR=/nix/store/da0k3xqppn4a3mkc1swb7sni4lk6nvak-debugir/bin -DCMAKE_INSTALL_NAME_DIR=/nix/store/da0k3xqppn4a3mkc1swb7sni4lk6nvak-debugir/lib -DCMAKE_POLICY_DEFAULT_CMP0025=NEW -DCMAKE_OSX_SYSROOT= -DCMAKE_FIND_FRAMEWORK=LAST -DCMAKE_STRIP=/nix/store/a4mmjm3bblxwp8h53bcfx3dly80ib0ba-binutils-2.35.1/bin/strip -DCMAKE_RANLIB=/nix/store/a4mmjm3bblxwp8h53bcfx3dly80ib0ba-binutils-2.35.1/bin/ranlib -DCMAKE_AR=/nix/store/a4mmjm3bblxwp8h53bcfx3dly80ib0ba-binutils-2.35.1/bin/ar -DCMAKE_C_COMPILER=gcc -DCMAKE_CXX_COMPILER=g++ -DCMAKE_INSTALL_PREFIX=/nix/store/da0k3xqppn4a3mkc1swb7sni4lk6nvak-debugir
-- The C compiler identification is GNU 10.3.0
-- The CXX compiler identification is GNU 10.3.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - failed
-- Check for working C compiler: /nix/store/s5hkav7whndbfz0szshpb46h4idqdq9a-gcc-wrapper-10.3.0/bin/gcc
-- Check for working C compiler: /nix/store/s5hkav7whndbfz0szshpb46h4idqdq9a-gcc-wrapper-10.3.0/bin/gcc - broken
CMake Error at /nix/store/m33sn6h5kgfbk3z4avwmgxam1dny07i0-cmake-3.21.2/share/cmake-3.21/Modules/CMakeTestCCompiler.cmake:69 (message):
  The C compiler

    &quot;/nix/store/s5hkav7whndbfz0szshpb46h4idqdq9a-gcc-wrapper-10.3.0/bin/gcc&quot;

  is not able to compile a simple test program.

  It fails with the following output:

    Change Dir: /build/source/build/CMakeFiles/CMakeTmp

    Run Build Command(s):/nix/store/xgp0bgw4rpnbc3vr2qdsdbixp3zy4v1l-gnumake-4.3/bin/make -f Makefile cmTC_9664f/fast &amp;&amp; /nix/store/xgp0bgw4rpnbc3vr2qdsdbixp3zy4v1l-gnumake-4.3/bin/make  -f CMakeFiles/cmTC_9664f.dir/build.make CMakeFiles/cmTC_9664f.dir/build
    make: /bin/sh: No such file or directory
    make: *** [Makefile:127: cmTC_9664f/fast] Error 127





  CMake will not be able to correctly generate this project.
Call Stack (most recent call first):
  CMakeLists.txt:3 (project)


-- Configuring incomplete, errors occurred!
See also &quot;/build/source/build/CMakeFiles/CMakeOutput.log&quot;.
See also &quot;/build/source/build/CMakeFiles/CMakeError.log&quot;.
builder for &#39;/nix/store/qkwcp87v5md9b61szs34sbcagmmp31n5-debugir.drv&#39; failed with exit code 1
error: build of &#39;/nix/store/gvwsn2qi4cqwk2xz79pmsdv4cpa0hkgn-git-2.33.0.drv&#39;, &#39;/nix/store/qkwcp87v5md9b61szs34sbcagmmp31n5-debugir.drv&#39; failed
</code></pre></div>



<a name="260618926"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Nix/near/260618926" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Locria Cyber <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Nix.html#260618926">(Nov 08 2021 at 06:21)</a>:</h4>
<p>pain</p>



<a name="260618931"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Nix/near/260618931" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Locria Cyber <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Nix.html#260618931">(Nov 08 2021 at 06:21)</a>:</h4>
<p>docker it is</p>



<a name="260632701"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Nix/near/260632701" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Nix.html#260632701">(Nov 08 2021 at 09:32)</a>:</h4>
<p>I did some searching, Archlinux does not allow unpriviliged user namespaces by default.<br>
Running <code>sudo sysctl kernel.unprivileged_userns_clone=1</code> and installing nix again <code>sh &lt;(curl -L https://nixos.org/nix/install) --daemon</code> should fix the issue.<br>
I'll add this tip to BUILDING_FROM_SOURCE.md</p>



<a name="260636071"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Nix/near/260636071" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jakub Konka <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Nix.html#260636071">(Nov 08 2021 at 10:03)</a>:</h4>
<p><span class="user-mention silent" data-user-id="453395">Locria Cyber</span> <a href="#narrow/stream/231634-beginners/topic/.E2.9C.94.20Nix/near/260618918">said</a>:</p>
<blockquote>
<p>Wow now I can't build with nix</p>
<p><div class="codehilite"><pre><span></span><code>&gt; nix-shell
warning: file &#39;nixpkgs&#39; was not found in the Nix search path (add it using $NIX_PATH or -I), at (string):1:9; will use bash from your environment
these derivations will be built:
  /nix/store/qkwcp87v5md9b61szs34sbcagmmp31n5-debugir.drv
these paths will be fetched (6.66 MiB download, 44.85 MiB unpacked):
  /nix/store/32r66ar7hxcc4a6hh26yx49w79bjhnw7-git-2.33.0
  /nix/store/qlhf7i79i8gqr3jm8ibf317q3v1l7wrb-openssh-8.7p1
copying path &#39;/nix/store/qlhf7i79i8gqr3jm8ibf317q3v1l7wrb-openssh-8.7p1&#39; from &#39;https://cache.nixos.org&#39;...
building &#39;/nix/store/qkwcp87v5md9b61szs34sbcagmmp31n5-debugir.drv&#39;...
unpacking sources
unpacking source archive /nix/store/07zhrxz5nwszhzclpff6acz4psciwfx5-source
source root is source
patching sources
configuring
fixing cmake files...
cmake flags: -DCMAKE_FIND_USE_SYSTEM_PACKAGE_REGISTRY=OFF -DCMAKE_FIND_USE_PACKAGE_REGISTRY=OFF -DCMAKE_EXPORT_NO_PACKAGE_REGISTRY=ON -DCMAKE_BUILD_TYPE=Release -DCMAKE_SKIP_BUILD_RPATH=ON -DBUILD_TESTING=OFF -DCMAKE_INSTALL_LOCALEDIR=/nix/store/da0k3xqppn4a3mkc1swb7sni4lk6nvak-debugir/share/locale -DCMAKE_INSTALL_LIBEXECDIR=/nix/store/da0k3xqppn4a3mkc1swb7sni4lk6nvak-debugir/libexec -DCMAKE_INSTALL_LIBDIR=/nix/store/da0k3xqppn4a3mkc1swb7sni4lk6nvak-debugir/lib -DCMAKE_INSTALL_DOCDIR=/nix/store/da0k3xqppn4a3mkc1swb7sni4lk6nvak-debugir/share/doc/DebugIR -DCMAKE_INSTALL_INFODIR=/nix/store/da0k3xqppn4a3mkc1swb7sni4lk6nvak-debugir/share/info -DCMAKE_INSTALL_MANDIR=/nix/store/da0k3xqppn4a3mkc1swb7sni4lk6nvak-debugir/share/man -DCMAKE_INSTALL_OLDINCLUDEDIR=/nix/store/da0k3xqppn4a3mkc1swb7sni4lk6nvak-debugir/include -DCMAKE_INSTALL_INCLUDEDIR=/nix/store/da0k3xqppn4a3mkc1swb7sni4lk6nvak-debugir/include -DCMAKE_INSTALL_SBINDIR=/nix/store/da0k3xqppn4a3mkc1swb7sni4lk6nvak-debugir/sbin -DCMAKE_INSTALL_BINDIR=/nix/store/da0k3xqppn4a3mkc1swb7sni4lk6nvak-debugir/bin -DCMAKE_INSTALL_NAME_DIR=/nix/store/da0k3xqppn4a3mkc1swb7sni4lk6nvak-debugir/lib -DCMAKE_POLICY_DEFAULT_CMP0025=NEW -DCMAKE_OSX_SYSROOT= -DCMAKE_FIND_FRAMEWORK=LAST -DCMAKE_STRIP=/nix/store/a4mmjm3bblxwp8h53bcfx3dly80ib0ba-binutils-2.35.1/bin/strip -DCMAKE_RANLIB=/nix/store/a4mmjm3bblxwp8h53bcfx3dly80ib0ba-binutils-2.35.1/bin/ranlib -DCMAKE_AR=/nix/store/a4mmjm3bblxwp8h53bcfx3dly80ib0ba-binutils-2.35.1/bin/ar -DCMAKE_C_COMPILER=gcc -DCMAKE_CXX_COMPILER=g++ -DCMAKE_INSTALL_PREFIX=/nix/store/da0k3xqppn4a3mkc1swb7sni4lk6nvak-debugir
-- The C compiler identification is GNU 10.3.0
-- The CXX compiler identification is GNU 10.3.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - failed
-- Check for working C compiler: /nix/store/s5hkav7whndbfz0szshpb46h4idqdq9a-gcc-wrapper-10.3.0/bin/gcc
-- Check for working C compiler: /nix/store/s5hkav7whndbfz0szshpb46h4idqdq9a-gcc-wrapper-10.3.0/bin/gcc - broken
CMake Error at /nix/store/m33sn6h5kgfbk3z4avwmgxam1dny07i0-cmake-3.21.2/share/cmake-3.21/Modules/CMakeTestCCompiler.cmake:69 (message):
  The C compiler

    &quot;/nix/store/s5hkav7whndbfz0szshpb46h4idqdq9a-gcc-wrapper-10.3.0/bin/gcc&quot;

  is not able to compile a simple test program.

  It fails with the following output:

    Change Dir: /build/source/build/CMakeFiles/CMakeTmp

    Run Build Command(s):/nix/store/xgp0bgw4rpnbc3vr2qdsdbixp3zy4v1l-gnumake-4.3/bin/make -f Makefile cmTC_9664f/fast &amp;&amp; /nix/store/xgp0bgw4rpnbc3vr2qdsdbixp3zy4v1l-gnumake-4.3/bin/make  -f CMakeFiles/cmTC_9664f.dir/build.make CMakeFiles/cmTC_9664f.dir/build
    make: /bin/sh: No such file or directory
    make: *** [Makefile:127: cmTC_9664f/fast] Error 127





  CMake will not be able to correctly generate this project.
Call Stack (most recent call first):
  CMakeLists.txt:3 (project)


-- Configuring incomplete, errors occurred!
See also &quot;/build/source/build/CMakeFiles/CMakeOutput.log&quot;.
See also &quot;/build/source/build/CMakeFiles/CMakeError.log&quot;.
builder for &#39;/nix/store/qkwcp87v5md9b61szs34sbcagmmp31n5-debugir.drv&#39; failed with exit code 1
error: build of &#39;/nix/store/gvwsn2qi4cqwk2xz79pmsdv4cpa0hkgn-git-2.33.0.drv&#39;, &#39;/nix/store/qkwcp87v5md9b61szs34sbcagmmp31n5-debugir.drv&#39; failed
</code></pre></div><br>
</p>
</blockquote>
<p>I had the same problem with Zig's stage2 compiler - we also use CMake and by virtue of deriving stdenv in NIxOS, we use gcc instead of clang as the default compiler. I wonder if this is a gcc regression in NixOS itself.</p>



<a name="260890464"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Nix/near/260890464" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luiz de Oliveira <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Nix.html#260890464">(Nov 10 2021 at 02:02)</a>:</h4>
<p><span class="user-mention" data-user-id="453395">@Locria Cyber</span>  I had the same errors you were talking about in <a class="stream" data-stream-id="304641" href="/#narrow/stream/304641-ideas">#ideas</a>  until I did this:</p>
<p>First, it only worked if when ran nix-shell for the first time on the project folder from Bash. I was using zsh and for some reason, it wouldn't work. So you might have to uninstall nix, install it again using bash, and then run nix-shell from bash from the project folder. If you're not using zsh then, of course, it doesn't apply.</p>
<p>Check these files, if they exist, try to uninstall nix and delete them too. </p>
<p><code>/var/lib/systemd/deb-systemd-helper-enabled/nix-daemon.socket.dsh-also</code><br>
<code>/var/lib/systemd/deb-systemd-helper-enabled/nix-daemon.service.dsh-also</code></p>
<p>To uninstall nix you will need to do the following things:</p>
<div class="codehilite"><pre><span></span><code>remove the . &quot;$HOME/.nix-profile/etc/profile.d/nix.sh&quot; line in your ~/.profile or ~/.bash_profile
rm -rf $HOME/{.nix-channels,.nix-defexpr,.nix-profile,.config/nixpkgs}
sudo rm -rf /nix
On a multi-user install, also remove all the nixbld[0-9] users
</code></pre></div>

<p>Sources: <a href="https://github.com/NixOS/nix/issues/1402">https://github.com/NixOS/nix/issues/1402</a><br>
<a href="https://github.com/NixOS/nix/issues/5485">https://github.com/NixOS/nix/issues/5485</a></p>



<a name="261110817"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Nix/near/261110817" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jarl André Hübenthal <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Nix.html#261110817">(Nov 11 2021 at 09:37)</a>:</h4>
<p>Shouldnt we use flakes <span aria-label="innocent" class="emoji emoji-1f607" role="img" title="innocent">:innocent:</span> instead of nix Shell which is not fully Isolated</p>



<a name="261126468"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Nix/near/261126468" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Nix.html#261126468">(Nov 11 2021 at 12:24)</a>:</h4>
<p>Flakes sound cool! It's something I'm willing to try. There are quite a few people here with more nix experience than me, I'd love to hear their take on it!</p>



<a name="261129807"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Nix/near/261129807" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Hicks <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Nix.html#261129807">(Nov 11 2021 at 12:56)</a>:</h4>
<p>Flakes are very cool but are not fully released yet. You have to install a different Nix command and enable experimental features.</p>



<a name="261129886"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Nix/near/261129886" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Hicks <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Nix.html#261129886">(Nov 11 2021 at 12:57)</a>:</h4>
<p>as soon as they’re stable we should switch, though. I’ve been impressed with them so far and have switched all my machine configs to flakes.</p>



<a name="261129912"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Nix/near/261129912" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Hicks <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Nix.html#261129912">(Nov 11 2021 at 12:57)</a>:</h4>
<p>it’s just too much of a hurdle yet though for a big shared project IMO</p>



<a name="261137264"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Nix/near/261137264" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Nix.html#261137264">(Nov 11 2021 at 14:02)</a>:</h4>
<p>Thanks for the advice <span class="user-mention" data-user-id="419641">@Brian Hicks</span>!</p>



<a name="261177706"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Nix/near/261177706" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lucas Rosa <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Nix.html#261177706">(Nov 11 2021 at 19:52)</a>:</h4>
<p>Sounds cool</p>



<a name="263841682"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Nix/near/263841682" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ju Liu <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Nix.html#263841682">(Dec 06 2021 at 12:20)</a>:</h4>
<p>haven't pulled the repo in a while. <code>git pull</code>, wait for nix to do its stuff, code is working. what's not to love??? :D</p>



<a name="273786559"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Nix/near/273786559" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mostlyvoid <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Nix.html#273786559">(Mar 02 2022 at 10:42)</a>:</h4>
<p>Hey all, how do I build the project on NixOS?<br>
I tried git cloning it and launching <code>nix-shell</code> but getting this error.</p>
<div class="codehilite"><pre><span></span><code>bash: /nix/store/jsp3h3wpzc842j0rz61m5ly71ak6qgdn-glibc-2.32-54/lib/libc.so.6: version `GLIBC_2.33&#39; not found (required by /nix/store/wvh786yaz4pms5g46d74zyaxx0xamm4m-ncurses
-6.2/lib/libncursesw.so.6)
</code></pre></div>
<p>I am on a flake configured machine, if that is relevant.</p>



<a name="273786620"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Nix/near/273786620" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Notification Bot <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Nix.html#273786620">(Mar 02 2022 at 10:43)</a>:</h4>
<p><span class="user-mention silent" data-user-id="482782">mostlyvoid</span> has marked this topic as unresolved.</p>



<a name="273794844"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Nix/near/273794844" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Nix.html#273794844">(Mar 02 2022 at 11:52)</a>:</h4>
<p>I get that error as well using nix from Ubuntu but the shell does successfully launch for me and I can run <code>cargo run repl</code>/<code>cargo build</code>/<code>cargo run examples/hello-world/Hello.roc</code> without problems.</p>



<a name="273800843"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Nix/near/273800843" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Loric Brevet <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Nix.html#273800843">(Mar 02 2022 at 12:48)</a>:</h4>
<p>Hey, I think your problem relates to the error raised in this issue: <a href="https://github.com/rtfeldman/roc/issues/1846">https://github.com/rtfeldman/roc/issues/1846</a></p>
<p>I also have it on Nix installed on Ubuntu. Does it prevent you from entering the shell?</p>



<a name="273812490"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Nix/near/273812490" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mostlyvoid <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Nix.html#273812490">(Mar 02 2022 at 14:12)</a>:</h4>
<p>The shell does not launch for me. If impurity is the cause of this error (as somebody pointed out in the Github issue), maybe we can have an alternative <code>flake.nix</code> for  Nix Flakes based development? Though still marked experimental, it is kind of agreed upon that flakes are going to be part of Nix.</p>



<a name="273820198"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Nix/near/273820198" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Loric Brevet <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Nix.html#273820198">(Mar 02 2022 at 15:06)</a>:</h4>
<p>I am not sure what the solution could be because I don’t fully understand the problem ^^. Like why some parts of the shell.nix rely on (or fallback to) something from the underlying system? Or said differently, why do we have to bring impurities for this use case? I would have guessed that the glibc version could be fixed from within the shell.</p>
<p>Maybe this can be discussed more thoroughly on the issue. Especially if you think that flakes can fill the gap of this impurity</p>



<a name="273823543"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Nix/near/273823543" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Nix.html#273823543">(Mar 02 2022 at 15:28)</a>:</h4>
<p>I'm good with trying out flakes. I can look at it this or next week, unless someone else wants to give it a try?</p>



<a name="275559472"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Nix/near/275559472" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Nix.html#275559472">(Mar 16 2022 at 18:42)</a>:</h4>
<p>The nix flake is ready on the nix-flake branch, there is only support for Linux X86_64 for now.<br>
I tested this on Ubuntu 20.04 and NixOS 21.11 .<br>
Running <code>cargo build</code> does spam an ncurses versioning issue (#2735) but this does not appear to break anything.<br>
Before trying this, make sure to <a href="https://nixos.wiki/wiki/Flakes">install flakes</a> if you have not yet done so.</p>



<a name="275559586"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Nix/near/275559586" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Nix.html#275559586">(Mar 16 2022 at 18:43)</a>:</h4>
<p>Also, when using flakes you should start a shell with <code>nix develop</code> not <code>nix shell</code>.</p>



<hr><p>Last updated: Nov 01 2025 at 12:13 UTC</p>
</html>