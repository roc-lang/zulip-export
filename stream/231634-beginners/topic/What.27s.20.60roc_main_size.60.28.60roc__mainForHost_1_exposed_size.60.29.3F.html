<html>
<head><meta charset="utf-8"><title>What&#x27;s `roc_main_size`(`roc__mainForHost_1_exposed_size`)? · beginners · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/index.html">beginners</a></h2>
<h3>Topic: <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/What.27s.20.60roc_main_size.60.28.60roc__mainForHost_1_exposed_size.60.29.3F.html">What&#x27;s `roc_main_size`(`roc__mainForHost_1_exposed_size`)?</a></h3>

<hr>

<base href="https://roc.zulipchat.com">

<head><link href="https://roc-lang.github.io/zulip-export/style.css" rel="stylesheet"></head>

<a name="473525979"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/What%27s%20%60roc_main_size%60%28%60roc__mainForHost_1_exposed_size%60%29%3F/near/473525979" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jared Cone <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/What.27s.20.60roc_main_size.60.28.60roc__mainForHost_1_exposed_size.60.29.3F.html#473525979">(Sep 30 2024 at 02:06)</a>:</h4>
<p>Per topic, I was curious what the return value of  <code>roc_main_size</code>/<code>roc__mainForHost_1_exposed_size</code> represents.</p>



<a name="473529933"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/What%27s%20%60roc_main_size%60%28%60roc__mainForHost_1_exposed_size%60%29%3F/near/473529933" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/What.27s.20.60roc_main_size.60.28.60roc__mainForHost_1_exposed_size.60.29.3F.html#473529933">(Sep 30 2024 at 02:17)</a>:</h4>
<p>It is the size in bytes of the data returned by the related function</p>



<a name="473530104"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/What%27s%20%60roc_main_size%60%28%60roc__mainForHost_1_exposed_size%60%29%3F/near/473530104" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/What.27s.20.60roc_main_size.60.28.60roc__mainForHost_1_exposed_size.60.29.3F.html#473530104">(Sep 30 2024 at 02:18)</a>:</h4>
<p>This is necessary for dealing with tasks and lambda captures.</p>



<a name="473530330"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/What%27s%20%60roc_main_size%60%28%60roc__mainForHost_1_exposed_size%60%29%3F/near/473530330" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/What.27s.20.60roc_main_size.60.28.60roc__mainForHost_1_exposed_size.60.29.3F.html#473530330">(Sep 30 2024 at 02:18)</a>:</h4>
<p>At least it is needed today. Long term, we may instead do boxing for this. It is just a lot simpler for a mix of issues.</p>



<a name="473531066"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/What%27s%20%60roc_main_size%60%28%60roc__mainForHost_1_exposed_size%60%29%3F/near/473531066" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/What.27s.20.60roc_main_size.60.28.60roc__mainForHost_1_exposed_size.60.29.3F.html#473531066">(Sep 30 2024 at 02:20)</a>:</h4>
<p>Example use: <a href="https://github.com/roc-lang/roc/blob/587d0afd462994edc15fcceb8514bc0d2662b12b/examples/cli/false-interpreter/platform/src/lib.rs#L120-L133">https://github.com/roc-lang/roc/blob/587d0afd462994edc15fcceb8514bc0d2662b12b/examples/cli/false-interpreter/platform/src/lib.rs#L120-L133</a></p>



<a name="473531338"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/What%27s%20%60roc_main_size%60%28%60roc__mainForHost_1_exposed_size%60%29%3F/near/473531338" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/What.27s.20.60roc_main_size.60.28.60roc__mainForHost_1_exposed_size.60.29.3F.html#473531338">(Sep 30 2024 at 02:21)</a>:</h4>
<p>Essentially grab the size. Alloc a block of memory of that size (could theoretically be on the stack instead of a new alloc). let roc store to it. Then call the returned closure with those as capture data.</p>



<a name="473531531"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/What%27s%20%60roc_main_size%60%28%60roc__mainForHost_1_exposed_size%60%29%3F/near/473531531" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jared Cone <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/What.27s.20.60roc_main_size.60.28.60roc__mainForHost_1_exposed_size.60.29.3F.html#473531531">(Sep 30 2024 at 02:21)</a>:</h4>
<p>oh it's the data for the closure?</p>



<a name="473531850"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/What%27s%20%60roc_main_size%60%28%60roc__mainForHost_1_exposed_size%60%29%3F/near/473531850" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jared Cone <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/What.27s.20.60roc_main_size.60.28.60roc__mainForHost_1_exposed_size.60.29.3F.html#473531850">(Sep 30 2024 at 02:22)</a>:</h4>
<p>not the return value of the function, but anything the closure captures?</p>



<a name="473533999"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/What%27s%20%60roc_main_size%60%28%60roc__mainForHost_1_exposed_size%60%29%3F/near/473533999" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/What.27s.20.60roc_main_size.60.28.60roc__mainForHost_1_exposed_size.60.29.3F.html#473533999">(Sep 30 2024 at 02:28)</a>:</h4>
<p>It is the size of the data being returned. If the function is returning a closure (which a task is). It really is just returning the closure captures. That is how a closure is represented in memory. A closure capture does not have a known size until the final roc application is compiled</p>



<a name="473539469"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/What%27s%20%60roc_main_size%60%28%60roc__mainForHost_1_exposed_size%60%29%3F/near/473539469" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/What.27s.20.60roc_main_size.60.28.60roc__mainForHost_1_exposed_size.60.29.3F.html#473539469">(Sep 30 2024 at 02:44)</a>:</h4>
<blockquote>
<p>A closure capture does not have a known size until the final roc application is compiled</p>
</blockquote>
<p>.. and the platform host is compiled into a binary ahead of time. It's only linked with the roc app later.</p>



<a name="473599775"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/What%27s%20%60roc_main_size%60%28%60roc__mainForHost_1_exposed_size%60%29%3F/near/473599775" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Shaiden Spreitzer <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/What.27s.20.60roc_main_size.60.28.60roc__mainForHost_1_exposed_size.60.29.3F.html#473599775">(Sep 30 2024 at 06:18)</a>:</h4>
<p><span class="user-mention silent" data-user-id="343810">Brendan Hansknecht</span> <a href="#narrow/stream/231634-beginners/topic/What's.20.60roc_main_size.60.28.60roc__mainForHost_1_exposed_size.60.29.3F/near/473530330">said</a>:</p>
<blockquote>
<p>At least it is needed today. Long term, we may instead do boxing for this. It is just a lot simpler for a mix of issues.</p>
</blockquote>
<p>Are there any breaking changes planned? If I code a platform with these functions today, do I have to expect a rewrite in the future?* Will these be depreciated at one point?</p>
<ul>
<li>Neutral question. I dont mind a rewrite or not either way. Just want to know.</li>
</ul>



<a name="473652108"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/What%27s%20%60roc_main_size%60%28%60roc__mainForHost_1_exposed_size%60%29%3F/near/473652108" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/What.27s.20.60roc_main_size.60.28.60roc__mainForHost_1_exposed_size.60.29.3F.html#473652108">(Sep 30 2024 at 09:00)</a>:</h4>
<p>There are definitely breaking changes planed for platform authors. Some of these are described here <a href="https://www.roc-lang.org/plans#planned-breaking-changes">https://www.roc-lang.org/plans#planned-breaking-changes</a></p>



<a name="473652411"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/What%27s%20%60roc_main_size%60%28%60roc__mainForHost_1_exposed_size%60%29%3F/near/473652411" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/What.27s.20.60roc_main_size.60.28.60roc__mainForHost_1_exposed_size.60.29.3F.html#473652411">(Sep 30 2024 at 09:01)</a>:</h4>
<p>There has been some discussion recently that possibly modifies these plans, but it's basically the same (we expect changes in future).</p>



<hr><p>Last updated: Nov 01 2025 at 12:13 UTC</p>
</html>