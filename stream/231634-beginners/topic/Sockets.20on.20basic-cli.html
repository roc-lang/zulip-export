<html>
<head><meta charset="utf-8"><title>Sockets on basic-cli · beginners · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/index.html">beginners</a></h2>
<h3>Topic: <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Sockets.20on.20basic-cli.html">Sockets on basic-cli</a></h3>

<hr>

<base href="https://roc.zulipchat.com">

<head><link href="https://roc-lang.github.io/zulip-export/style.css" rel="stylesheet"></head>

<a name="338479643"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Sockets%20on%20basic-cli/near/338479643" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Agus Zubiaga <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Sockets.20on.20basic-cli.html#338479643">(Feb 28 2023 at 00:44)</a>:</h4>
<p>Are there any platforms out there with some basic sockets support or do I have to make my own currently?</p>



<a name="338479772"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Sockets%20on%20basic-cli/near/338479772" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Sockets.20on.20basic-cli.html#338479772">(Feb 28 2023 at 00:45)</a>:</h4>
<p>none that I know of, but if you're interested in adding them to an existing platform (e.g. <a href="https://github.com/roc-lang/basic-cli">basic-cli</a>) I'd be happy to help!</p>



<a name="338480012"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Sockets%20on%20basic-cli/near/338480012" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Agus Zubiaga <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Sockets.20on.20basic-cli.html#338480012">(Feb 28 2023 at 00:47)</a>:</h4>
<p>That’d be fun! I’ll clone basic-cli and get comfy with it</p>



<a name="338482422"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Sockets%20on%20basic-cli/near/338482422" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Sockets.20on.20basic-cli.html#338482422">(Feb 28 2023 at 01:08)</a>:</h4>
<p>feel free to post any questions here!</p>



<a name="338486004"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Sockets%20on%20basic-cli/near/338486004" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Agus Zubiaga <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Sockets.20on.20basic-cli.html#338486004">(Feb 28 2023 at 01:44)</a>:</h4>
<p>Very hardcoded but it's a start! <a href="/user_uploads/22008/j2HxRHJmJzmEy92lmhehj8eP/CleanShot-2023-02-27-at-22.43.45.gif">client.gif</a></p>
<div class="message_inline_image"><a href="/user_uploads/22008/j2HxRHJmJzmEy92lmhehj8eP/CleanShot-2023-02-27-at-22.43.45.gif" title="client.gif"><img src="/user_uploads/22008/j2HxRHJmJzmEy92lmhehj8eP/CleanShot-2023-02-27-at-22.43.45.gif"></a></div>



<a name="338486672"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Sockets%20on%20basic-cli/near/338486672" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Sockets.20on.20basic-cli.html#338486672">(Feb 28 2023 at 01:53)</a>:</h4>
<p>haha! I love how specific the function is.</p>



<a name="338486686"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Sockets%20on%20basic-cli/near/338486686" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Sockets.20on.20basic-cli.html#338486686">(Feb 28 2023 at 01:53)</a>:</h4>
<p>glad it wasn't to hard to figure the base out</p>



<a name="338486967"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Sockets%20on%20basic-cli/near/338486967" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Agus Zubiaga <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Sockets.20on.20basic-cli.html#338486967">(Feb 28 2023 at 01:56)</a>:</h4>
<p>Yeah, it felt so intuitive!</p>



<a name="338487115"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Sockets%20on%20basic-cli/near/338487115" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Agus Zubiaga <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Sockets.20on.20basic-cli.html#338487115">(Feb 28 2023 at 01:58)</a>:</h4>
<p>Now I need to return a pointer to the stream so I can read and write later. Not sure what type I need to use for that.</p>



<a name="338487330"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Sockets%20on%20basic-cli/near/338487330" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Sockets.20on.20basic-cli.html#338487330">(Feb 28 2023 at 02:00)</a>:</h4>
<p>Likely you want an opaque type that simply wraps a <code>Nat</code> or a <code>Box {}</code></p>



<a name="338487349"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Sockets%20on%20basic-cli/near/338487349" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Sockets.20on.20basic-cli.html#338487349">(Feb 28 2023 at 02:00)</a>:</h4>
<p>That way userland Roc code won't be able to do anything with it, but it can still be passed around as a pointer.</p>



<a name="338487410"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Sockets%20on%20basic-cli/near/338487410" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Sockets.20on.20basic-cli.html#338487410">(Feb 28 2023 at 02:01)</a>:</h4>
<p>You can look at what was done here for a file: <a href="https://github.com/roc-lang/roc/blob/main/examples/cli/false-interpreter/platform/File.roc">https://github.com/roc-lang/roc/blob/main/examples/cli/false-interpreter/platform/File.roc</a></p>



<a name="338487526"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Sockets%20on%20basic-cli/near/338487526" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Sockets.20on.20basic-cli.html#338487526">(Feb 28 2023 at 02:02)</a>:</h4>
<p>In this case, I also managed the lifetime of the file to make sure the handle got closed. Only exposing a function that took a lambda for what to do with the file.</p>



<a name="338487560"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Sockets%20on%20basic-cli/near/338487560" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Sockets.20on.20basic-cli.html#338487560">(Feb 28 2023 at 02:02)</a>:</h4>
<p>Oh, though I used <code>U64</code>, which is wrong on 32bit platforms, so I wouldn't copy that.</p>



<a name="338487605"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Sockets%20on%20basic-cli/near/338487605" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Agus Zubiaga <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Sockets.20on.20basic-cli.html#338487605">(Feb 28 2023 at 02:03)</a>:</h4>
<p>I see</p>



<a name="338487685"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Sockets%20on%20basic-cli/near/338487685" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Agus Zubiaga <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Sockets.20on.20basic-cli.html#338487685">(Feb 28 2023 at 02:04)</a>:</h4>
<p>So <code>Nat</code> is like <code>usize</code>?</p>



<a name="338487720"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Sockets%20on%20basic-cli/near/338487720" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Sockets.20on.20basic-cli.html#338487720">(Feb 28 2023 at 02:04)</a>:</h4>
<p>Yep</p>



<a name="338487754"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Sockets%20on%20basic-cli/near/338487754" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Agus Zubiaga <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Sockets.20on.20basic-cli.html#338487754">(Feb 28 2023 at 02:05)</a>:</h4>
<p>Alright, on it! Thank you :)</p>



<a name="338496269"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Sockets%20on%20basic-cli/near/338496269" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Agus Zubiaga <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Sockets.20on.20basic-cli.html#338496269">(Feb 28 2023 at 03:58)</a>:</h4>
<p>It's getting more interesting <a href="/user_uploads/22008/5a-P9OnSpyT3rJLC4yWg6maq/CleanShot-2023-02-28-at-00.53.34.gif">chat.gif</a></p>
<div class="message_inline_image"><a href="/user_uploads/22008/5a-P9OnSpyT3rJLC4yWg6maq/CleanShot-2023-02-28-at-00.53.34.gif" title="chat.gif"><img src="/user_uploads/22008/5a-P9OnSpyT3rJLC4yWg6maq/CleanShot-2023-02-28-at-00.53.34.gif"></a></div>



<a name="338496310"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Sockets%20on%20basic-cli/near/338496310" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ayaz Hafiz <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Sockets.20on.20basic-cli.html#338496310">(Feb 28 2023 at 03:59)</a>:</h4>
<p>This is pretty fire, nice Agus!</p>



<a name="338498469"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Sockets%20on%20basic-cli/near/338498469" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Sockets.20on.20basic-cli.html#338498469">(Feb 28 2023 at 04:29)</a>:</h4>
<p>I love the gif. Really cool to see.</p>



<a name="338510768"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Sockets%20on%20basic-cli/near/338510768" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Carroll <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Sockets.20on.20basic-cli.html#338510768">(Feb 28 2023 at 06:54)</a>:</h4>
<p>Oh wow, so cool! <span aria-label="tada" class="emoji emoji-1f389" role="img" title="tada">:tada:</span></p>



<a name="338579514"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Sockets%20on%20basic-cli/near/338579514" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Sockets.20on.20basic-cli.html#338579514">(Feb 28 2023 at 12:55)</a>:</h4>
<p>wow, that's awesome!!! <span aria-label="heart eyes" class="emoji emoji-1f60d" role="img" title="heart eyes">:heart_eyes:</span></p>



<a name="338579575"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Sockets%20on%20basic-cli/near/338579575" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Sockets.20on.20basic-cli.html#338579575">(Feb 28 2023 at 12:55)</a>:</h4>
<p><span class="user-mention" data-user-id="489294">@Agus Zubiaga</span> was this all on your first day getting into Platform development?</p>



<a name="338579866"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Sockets%20on%20basic-cli/near/338579866" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Agus Zubiaga <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Sockets.20on.20basic-cli.html#338579866">(Feb 28 2023 at 12:56)</a>:</h4>
<p>I did cross midnight but yeah <span aria-label="grinning" class="emoji emoji-1f600" role="img" title="grinning">:grinning:</span></p>



<a name="338580353"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Sockets%20on%20basic-cli/near/338580353" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Agus Zubiaga <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Sockets.20on.20basic-cli.html#338580353">(Feb 28 2023 at 12:58)</a>:</h4>
<p>It was my first day actually using Roc at all. I had only seen some talks before.</p>



<a name="338580527"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Sockets%20on%20basic-cli/near/338580527" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Agus Zubiaga <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Sockets.20on.20basic-cli.html#338580527">(Feb 28 2023 at 12:59)</a>:</h4>
<p>Props to you folks for making it so straightforward!</p>



<a name="338580609"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Sockets%20on%20basic-cli/near/338580609" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Sockets.20on.20basic-cli.html#338580609">(Feb 28 2023 at 12:59)</a>:</h4>
<p>wow, amazing! <span aria-label="heart eyes cat" class="emoji emoji-1f63b" role="img" title="heart eyes cat">:heart_eyes_cat:</span></p>



<a name="338582409"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Sockets%20on%20basic-cli/near/338582409" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Agus Zubiaga <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Sockets.20on.20basic-cli.html#338582409">(Feb 28 2023 at 13:09)</a>:</h4>
<p>It's been fun! I'll play with the API when I get some more free time. I have to make some things fail at the <code>Task</code> level instead of panicking in the platform, and figure out how to read arbitrary bytes.</p>



<a name="338582476"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Sockets%20on%20basic-cli/near/338582476" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Agus Zubiaga <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Sockets.20on.20basic-cli.html#338582476">(Feb 28 2023 at 13:09)</a>:</h4>
<p>If everything goes well I can probably make a PR later in the week!</p>



<a name="338960959"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Sockets%20on%20basic-cli/near/338960959" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Agus Zubiaga <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Sockets.20on.20basic-cli.html#338960959">(Mar 01 2023 at 21:33)</a>:</h4>
<p>Got the API to a pretty good state I think: <a href="https://github.com/agu-z/roc-basic-cli/blob/sockets-support/src/Tcp.roc">https://github.com/agu-z/roc-basic-cli/blob/sockets-support/src/Tcp.roc</a><br>
Example: <a href="https://github.com/agu-z/roc-basic-cli/blob/sockets-support/examples/tcp-client.roc">https://github.com/agu-z/roc-basic-cli/blob/sockets-support/examples/tcp-client.roc</a></p>



<a name="338961361"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Sockets%20on%20basic-cli/near/338961361" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Agus Zubiaga <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Sockets.20on.20basic-cli.html#338961361">(Mar 01 2023 at 21:35)</a>:</h4>
<p>It can now read all data in the stream (was reading into a fixed buffer before). Also, you can read/write raw bytes if you want to.</p>



<a name="338961683"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Sockets%20on%20basic-cli/near/338961683" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Agus Zubiaga <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Sockets.20on.20basic-cli.html#338961683">(Mar 01 2023 at 21:38)</a>:</h4>
<p>Replaced <code>Tcp.connect</code> with <code>Tcp.withConnect</code> which manages the lifetime of the connection so you can't forget to close, similar to: <a href="https://github.com/roc-lang/roc/blob/main/examples/cli/false-interpreter/platform/File.roc">https://github.com/roc-lang/roc/blob/main/examples/cli/false-interpreter/platform/File.roc</a></p>



<a name="338962037"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Sockets%20on%20basic-cli/near/338962037" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Agus Zubiaga <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Sockets.20on.20basic-cli.html#338962037">(Mar 01 2023 at 21:40)</a>:</h4>
<p>I think the only missing part for a PR is error handling. I wrote the types but glue doesn't work so I can't return them from Rust.</p>



<a name="338962091"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Sockets%20on%20basic-cli/near/338962091" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Agus Zubiaga <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Sockets.20on.20basic-cli.html#338962091">(Mar 01 2023 at 21:41)</a>:</h4>
<p>I'll look into how much code per type we need, maybe I can just write them by hand</p>



<a name="338966857"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Sockets%20on%20basic-cli/near/338966857" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Agus Zubiaga <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Sockets.20on.20basic-cli.html#338966857">(Mar 01 2023 at 22:14)</a>:</h4>
<p>Yeah, maybe not lol</p>



<a name="338967026"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Sockets%20on%20basic-cli/near/338967026" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Agus Zubiaga <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Sockets.20on.20basic-cli.html#338967026">(Mar 01 2023 at 22:16)</a>:</h4>
<p>I'd rather spend the time investigating why glue doesn't work in the first place. Gotta run now but I might do that later or tomorrow.</p>



<a name="338967210"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Sockets%20on%20basic-cli/near/338967210" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Sockets.20on.20basic-cli.html#338967210">(Mar 01 2023 at 22:17)</a>:</h4>
<p>I'd love to have someone else get involved with glue, so if you want to look into it that would be awesome! I'd be happy to help with answering any questions <span aria-label="smiley" class="emoji emoji-1f603" role="img" title="smiley">:smiley:</span></p>



<a name="338967862"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Sockets%20on%20basic-cli/near/338967862" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Agus Zubiaga <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Sockets.20on.20basic-cli.html#338967862">(Mar 01 2023 at 22:22)</a>:</h4>
<p>Yeah, it’ll probably take me a while to get familiar with the compiler internals but happy to!</p>



<a name="339600427"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Sockets%20on%20basic-cli/near/339600427" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Agus Zubiaga <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Sockets.20on.20basic-cli.html#339600427">(Mar 04 2023 at 18:54)</a>:</h4>
<p>I managed to generate the glue code for my errors with this trick: <a href="#narrow/stream/316715-contributing/topic/Broken.20glue/near/339383878">https://roc.zulipchat.com/#narrow/stream/316715-contributing/topic/Broken.20glue/near/339383878</a></p>
<p>However, even if a I return a <code>RocResult::ok</code> from the rust, when I pattern match on the Roc side it always matches the <code>Err</code> case. Even if the platform is never creating <code>RocResult::err</code> at all.</p>



<a name="339600571"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Sockets%20on%20basic-cli/near/339600571" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Sockets.20on.20basic-cli.html#339600571">(Mar 04 2023 at 18:55)</a>:</h4>
<p>and neither of the a and x in <code>Result a x</code> are the <code>[]</code> type?</p>



<a name="339600724"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Sockets%20on%20basic-cli/near/339600724" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Agus Zubiaga <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Sockets.20on.20basic-cli.html#339600724">(Mar 04 2023 at 18:56)</a>:</h4>
<p>Not in the <code>Effect</code> module or my <code>Tcp</code> module</p>



<a name="339600762"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Sockets%20on%20basic-cli/near/339600762" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Agus Zubiaga <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Sockets.20on.20basic-cli.html#339600762">(Mar 04 2023 at 18:56)</a>:</h4>
<p>Only the main function because it needs to be <code>Task _ []</code></p>



<a name="339600764"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Sockets%20on%20basic-cli/near/339600764" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Sockets.20on.20basic-cli.html#339600764">(Mar 04 2023 at 18:56)</a>:</h4>
<p>yeah so not in relevant code paths.</p>



<a name="339600798"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Sockets%20on%20basic-cli/near/339600798" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Sockets.20on.20basic-cli.html#339600798">(Mar 04 2023 at 18:56)</a>:</h4>
<p>ok, well this sounds like just a mismatch between where glue is storing and roc is reading the bytes</p>



<a name="339600882"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Sockets%20on%20basic-cli/near/339600882" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Agus Zubiaga <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Sockets.20on.20basic-cli.html#339600882">(Mar 04 2023 at 18:57)</a>:</h4>
<p>Yeah, that's what I thought. Lemme try something like a <code>RocStr</code> from <code>roc_std</code> an error.</p>



<a name="339600960"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Sockets%20on%20basic-cli/near/339600960" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Agus Zubiaga <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Sockets.20on.20basic-cli.html#339600960">(Mar 04 2023 at 18:58)</a>:</h4>
<p>Well, I guess that wouldn't matter because I'm never generating an error yet</p>



<a name="339601265"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Sockets%20on%20basic-cli/near/339601265" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nick Hallstrom <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Sockets.20on.20basic-cli.html#339601265">(Mar 04 2023 at 19:00)</a>:</h4>
<p>Is that the same issue as this? Folkert’s response from the Roc Clock thread (can’t seem to copy the link from mobile):</p>
<p>well. this is interesting and frustrating: rust will send a <code>RocResult&lt;u8, ()&gt;</code> over to roc as a <code>u16</code>. we "receive" it as <code>{ [0 x i8], [1 x i8], i8, [0 x i8] }</code>, which is reasonable (if you've seen LLVM IR before), but it is _not_ valid according to the C ABI</p>



<a name="339601337"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Sockets%20on%20basic-cli/near/339601337" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nick Hallstrom <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Sockets.20on.20basic-cli.html#339601337">(Mar 04 2023 at 19:01)</a>:</h4>
<p>I was having the same issue where RocResult would always be Err</p>



<a name="339601550"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Sockets%20on%20basic-cli/near/339601550" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Agus Zubiaga <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Sockets.20on.20basic-cli.html#339601550">(Mar 04 2023 at 19:03)</a>:</h4>
<p>I see. Yeah, I guess that'd make sense</p>



<a name="339603304"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Sockets%20on%20basic-cli/near/339603304" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Agus Zubiaga <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Sockets.20on.20basic-cli.html#339603304">(Mar 04 2023 at 19:20)</a>:</h4>
<p>Ok yeah, I tried the other examples and it looks like Roc thinks all <code>Result</code> are <code>Err</code> in general</p>



<a name="339603526"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Sockets%20on%20basic-cli/near/339603526" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Sockets.20on.20basic-cli.html#339603526">(Mar 04 2023 at 19:23)</a>:</h4>
<p>Hmm. I wonder when that broke. It definitely has not always been the case.</p>



<a name="339603545"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Sockets%20on%20basic-cli/near/339603545" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Agus Zubiaga <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Sockets.20on.20basic-cli.html#339603545">(Mar 04 2023 at 19:23)</a>:</h4>
<p>I mean all <code>Result</code> coming from rust to be clear</p>



<a name="339603643"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Sockets%20on%20basic-cli/near/339603643" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Sockets.20on.20basic-cli.html#339603643">(Mar 04 2023 at 19:24)</a>:</h4>
<p>I think it depends on the size of the type that is in a result</p>



<a name="339603650"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Sockets%20on%20basic-cli/near/339603650" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Sockets.20on.20basic-cli.html#339603650">(Mar 04 2023 at 19:24)</a>:</h4>
<p>I'd guess it works for <code>i64</code>/<code>usize</code></p>



<a name="339603658"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Sockets%20on%20basic-cli/near/339603658" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Sockets.20on.20basic-cli.html#339603658">(Mar 04 2023 at 19:24)</a>:</h4>
<p>but not for most other things</p>



<a name="339604084"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Sockets%20on%20basic-cli/near/339604084" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Agus Zubiaga <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Sockets.20on.20basic-cli.html#339604084">(Mar 04 2023 at 19:28)</a>:</h4>
<p>In my case I have a raw pointer in the <code>Ok</code> case and a glue generated enum in the <code>Err</code> case.</p>



<a name="339604623"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Sockets%20on%20basic-cli/near/339604623" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Agus Zubiaga <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Sockets.20on.20basic-cli.html#339604623">(Mar 04 2023 at 19:32)</a>:</h4>
<p>Should this be fixed in <code>roc_std</code> or in the compiler?</p>



<a name="339605104"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Sockets%20on%20basic-cli/near/339605104" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Sockets.20on.20basic-cli.html#339605104">(Mar 04 2023 at 19:37)</a>:</h4>
<p>this is a compiler thing</p>



<hr><p>Last updated: Nov 01 2025 at 12:13 UTC</p>
</html>