<html>
<head><meta charset="utf-8"><title>Platform from src debug · beginners · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/index.html">beginners</a></h2>
<h3>Topic: <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Platform.20from.20src.20debug.html">Platform from src debug</a></h3>

<hr>

<base href="https://roc.zulipchat.com">

<head><link href="https://roc-lang.github.io/zulip-export/style.css" rel="stylesheet"></head>

<a name="367757093"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Platform%20from%20src%20debug/near/367757093" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Platform.20from.20src.20debug.html#367757093">(Jun 19 2023 at 22:00)</a>:</h4>
<p>Is there a way to instruct roc cli to build a rust platform and use debug instead of release? I am trying to debug some things using <code>dbg!</code> macros and not sure how to do this when using <code>roc dev myapp.roc</code> which rebuilds the platform.</p>



<a name="367757290"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Platform%20from%20src%20debug/near/367757290" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Platform.20from.20src.20debug.html#367757290">(Jun 19 2023 at 22:02)</a>:</h4>
<p>If you don't pass <code>--optimize</code> it should build a rust platform in debug mode.</p>



<a name="367757320"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Platform%20from%20src%20debug/near/367757320" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Platform.20from.20src.20debug.html#367757320">(Jun 19 2023 at 22:02)</a>:</h4>
<p>As long as you have a local platform of course that is getting built from source</p>



<a name="367757414"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Platform%20from%20src%20debug/near/367757414" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Platform.20from.20src.20debug.html#367757414">(Jun 19 2023 at 22:03)</a>:</h4>
<p>So, <code>packages { pf: "../src/main.roc" }</code> should be building and running in debug then?</p>



<a name="367757573"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Platform%20from%20src%20debug/near/367757573" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Platform.20from.20src.20debug.html#367757573">(Jun 19 2023 at 22:05)</a>:</h4>
<p>hmm, I think there is something else going on here. Thanks <span class="user-mention" data-user-id="343810">@Brendan Hansknecht</span></p>



<a name="367757600"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Platform%20from%20src%20debug/near/367757600" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Platform.20from.20src.20debug.html#367757600">(Jun 19 2023 at 22:05)</a>:</h4>
<p>yeah, should be. You should see roc saying rebuilding host.</p>



<a name="367757702"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Platform%20from%20src%20debug/near/367757702" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Platform.20from.20src.20debug.html#367757702">(Jun 19 2023 at 22:06)</a>:</h4>
<p>also, you should be able to delete <code>target/release</code> and it should still run without recompile. Cause it will use the rust debug build</p>



<a name="367757730"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Platform%20from%20src%20debug/near/367757730" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Platform.20from.20src.20debug.html#367757730">(Jun 19 2023 at 22:07)</a>:</h4>
<p>It looks like bdg is working. I think the issue is something about my "glue" types and passing values between Roc and rust</p>



<a name="367757760"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Platform%20from%20src%20debug/near/367757760" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Platform.20from.20src.20debug.html#367757760">(Jun 19 2023 at 22:07)</a>:</h4>
<p>dbg*</p>



<a name="367758836"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Platform%20from%20src%20debug/near/367758836" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Platform.20from.20src.20debug.html#367758836">(Jun 19 2023 at 22:18)</a>:</h4>
<p><span class="user-mention" data-user-id="343810">@Brendan Hansknecht</span> can you please have a look at this? Am I missing something obvious here? I feel like maybe I can't just pass a <code>command_glue::Command</code> straight into the <code>roc_fx_commandStatus</code>?</p>
<div class="codehilite" data-code-language="CoffeeScript"><pre><span></span><code><span class="c1"># Effect.roc</span>
<span class="nv">commandStatus</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="nx">InternalCommand</span><span class="p">.</span><span class="nx">Command</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="nx">Effect</span><span class="w"> </span><span class="nx">U8</span>

<span class="c1"># InternalCommand.roc</span>
<span class="nv">Command</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nv">program</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="nx">Str</span><span class="p">,</span>
<span class="w">    </span><span class="nv">args</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="nx">List</span><span class="w"> </span><span class="nx">Str</span><span class="p">,</span><span class="w"> </span><span class="c1"># [arg0, arg1, arg2, arg3, ...]</span>
<span class="w">    </span><span class="nv">envs</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="nx">List</span><span class="w"> </span><span class="nx">Str</span><span class="p">,</span><span class="w"> </span><span class="c1"># [key0, value0, key1, value1, key2, value2, ...]</span>
<span class="p">}</span>
</code></pre></div>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="c1">// command_glue.rs</span>
<span class="cp">#[derive(Clone, Default, Debug, PartialEq, PartialOrd, Eq, Ord, Hash, )]</span>
<span class="cp">#[repr(C)]</span>
<span class="k">pub</span><span class="w"> </span><span class="k">struct</span> <span class="nc">Command</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">pub</span><span class="w"> </span><span class="n">args</span>: <span class="nc">roc_std</span>::<span class="n">RocList</span><span class="o">&lt;</span><span class="n">roc_std</span>::<span class="n">RocStr</span><span class="o">&gt;</span><span class="p">,</span>
<span class="w">    </span><span class="k">pub</span><span class="w"> </span><span class="n">envs</span>: <span class="nc">roc_std</span>::<span class="n">RocList</span><span class="o">&lt;</span><span class="n">roc_std</span>::<span class="n">RocStr</span><span class="o">&gt;</span><span class="p">,</span>
<span class="w">    </span><span class="k">pub</span><span class="w"> </span><span class="n">program</span>: <span class="nc">roc_std</span>::<span class="n">RocStr</span><span class="p">,</span>
<span class="p">}</span>
</code></pre></div>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code>#<span class="w"> </span><span class="n">lib</span><span class="p">.</span><span class="n">rs</span>
<span class="k">pub</span><span class="w"> </span><span class="k">extern</span><span class="w"> </span><span class="s">"C"</span><span class="w"> </span><span class="k">fn</span> <span class="nf">roc_fx_commandStatus</span><span class="p">(</span><span class="n">cmd</span>: <span class="kp">&amp;</span><span class="nc">command_glue</span>::<span class="n">Command</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="kt">u8</span>
</code></pre></div>



<a name="367759151"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Platform%20from%20src%20debug/near/367759151" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Platform.20from.20src.20debug.html#367759151">(Jun 19 2023 at 22:21)</a>:</h4>
<p>That looks like it should be correct to me</p>



<a name="367759164"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Platform%20from%20src%20debug/near/367759164" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Platform.20from.20src.20debug.html#367759164">(Jun 19 2023 at 22:21)</a>:</h4>
<p>I had it working fine just passing in a <code>RocStr</code> but recently changed it to the struct <code>Command</code></p>



<a name="367759206"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Platform%20from%20src%20debug/near/367759206" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Platform.20from.20src.20debug.html#367759206">(Jun 19 2023 at 22:22)</a>:</h4>
<p>One guess, maybe it explicitly needs to be a pointer instead of <code>&amp;</code></p>



<a name="367759279"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Platform%20from%20src%20debug/near/367759279" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Platform.20from.20src.20debug.html#367759279">(Jun 19 2023 at 22:22)</a>:</h4>
<p>Does it work if you remove one of the fields?</p>



<a name="367759476"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Platform%20from%20src%20debug/near/367759476" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Platform.20from.20src.20debug.html#367759476">(Jun 19 2023 at 22:24)</a>:</h4>
<p>I've just pushed my WIP to <a href="https://github.com/roc-lang/basic-cli/pull/55">#55</a></p>



<a name="367759507"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Platform%20from%20src%20debug/near/367759507" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Platform.20from.20src.20debug.html#367759507">(Jun 19 2023 at 22:24)</a>:</h4>
<p>I'll try removing all the fields except the RocStr</p>



<a name="367759659"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Platform%20from%20src%20debug/near/367759659" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Platform.20from.20src.20debug.html#367759659">(Jun 19 2023 at 22:26)</a>:</h4>
<p>Yeah, it works ok removing the <code>args</code> and <code>envs</code> fields from <code>command_glue::Command</code></p>



<a name="367759698"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Platform%20from%20src%20debug/near/367759698" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Platform.20from.20src.20debug.html#367759698">(Jun 19 2023 at 22:26)</a>:</h4>
<p>My current guess is that is is related to <a href="https://github.com/roc-lang/roc/issues/5544">#5544</a> and since the size is 72 bytes (which is over 64 bytes) it becomes a pointer.</p>



<a name="367759715"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Platform%20from%20src%20debug/near/367759715" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Platform.20from.20src.20debug.html#367759715">(Jun 19 2023 at 22:26)</a>:</h4>
<p>So it should work with 2 fields, but fail with 3</p>



<a name="367759750"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Platform%20from%20src%20debug/near/367759750" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Platform.20from.20src.20debug.html#367759750">(Jun 19 2023 at 22:27)</a>:</h4>
<p>With 3 probably just need to change the input type to a pointer.</p>



<a name="367759755"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Platform%20from%20src%20debug/near/367759755" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Platform.20from.20src.20debug.html#367759755">(Jun 19 2023 at 22:27)</a>:</h4>
<p>but maybe something more complex is needed</p>



<a name="367759860"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Platform%20from%20src%20debug/near/367759860" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Platform.20from.20src.20debug.html#367759860">(Jun 19 2023 at 22:28)</a>:</h4>
<p>Ok, thanks. It doesn't work with two or three fields.</p>



<a name="367759891"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Platform%20from%20src%20debug/near/367759891" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Platform.20from.20src.20debug.html#367759891">(Jun 19 2023 at 22:28)</a>:</h4>
<p>To change to a pointer, I need to use a Box type right?</p>



<a name="367760191"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Platform%20from%20src%20debug/near/367760191" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Platform.20from.20src.20debug.html#367760191">(Jun 19 2023 at 22:31)</a>:</h4>
<p>Hmm. breaks with 2. Maybe it is something else, not sure. Anyway, I would test with a <code>*const command_glue::Command</code></p>



<a name="367760332"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Platform%20from%20src%20debug/near/367760332" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Platform.20from.20src.20debug.html#367760332">(Jun 19 2023 at 22:32)</a>:</h4>
<p>Works!! <span aria-label="tada" class="emoji emoji-1f389" role="img" title="tada">:tada:</span></p>



<a name="367760352"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Platform%20from%20src%20debug/near/367760352" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Platform.20from.20src.20debug.html#367760352">(Jun 19 2023 at 22:33)</a>:</h4>
<p>Thank you</p>



<a name="367760580"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Platform%20from%20src%20debug/near/367760580" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Platform.20from.20src.20debug.html#367760580">(Jun 19 2023 at 22:35)</a>:</h4>
<p>Pushed to <a href="https://github.com/roc-lang/basic-cli/commit/3625eeea0a5c6a2af8102f29444a7a84a526a7fc">this commit</a> in case anyone finds this thread in future and wants to know how to use Box as a workaround here.</p>



<a name="367760738"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Platform%20from%20src%20debug/near/367760738" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Platform.20from.20src.20debug.html#367760738">(Jun 19 2023 at 22:37)</a>:</h4>
<p>Hmm. that isn't what I meant, but is a patch I guess. Pretty wasteful to just box for that. Though it is always a workaround to any glue issues.</p>
<p>My suggestion would not use box on the roc side at all. It would just use the pointer on the rust side.</p>



<a name="367760841"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Platform%20from%20src%20debug/near/367760841" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Platform.20from.20src.20debug.html#367760841">(Jun 19 2023 at 22:38)</a>:</h4>
<p>Not saying my suggestion would work, but this api definitely should work without any box on the roc side.</p>



<a name="367761969"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Platform%20from%20src%20debug/near/367761969" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Platform.20from.20src.20debug.html#367761969">(Jun 19 2023 at 22:49)</a>:</h4>
<p>Hmm. I just tested your code on my m1 mac and I think your original code works just fine. Like without any changes....hmm</p>



<hr><p>Last updated: Mar 01 2026 at 12:20 UTC</p>
</html>