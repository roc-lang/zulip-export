<html>
<head><meta charset="utf-8"><title>testing with expect · beginners · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/index.html">beginners</a></h2>
<h3>Topic: <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/testing.20with.20expect.html">testing with expect</a></h3>

<hr>

<base href="https://roc.zulipchat.com">

<head><link href="https://roc-lang.github.io/zulip-export/style.css" rel="stylesheet"></head>

<a name="569100308"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/testing%20with%20expect/near/569100308" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rick Hull <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/testing.20with.20expect.html#569100308">(Jan 20 2026 at 18:24)</a>:</h4>
<p>here is how I run tests, via <code>just test</code> <a href="https://gist.github.com/rickhull/ad4af8984a40d538ea1e1999af613492">https://gist.github.com/rickhull/ad4af8984a40d538ea1e1999af613492</a></p>
<p>This is the within-block usage of <code>expect</code>, not a "unit test" (as I understand these terms).  Is this the right way to do the accounting, or am I misusing or under-utilizing Roc / expect features?</p>



<a name="569100570"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/testing%20with%20expect/near/569100570" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/testing.20with.20expect.html#569100570">(Jan 20 2026 at 18:26)</a>:</h4>
<p>We have typically been using top level expects defined in the same file as the source for testing.</p>



<a name="569101584"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/testing%20with%20expect/near/569101584" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rick Hull <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/testing.20with.20expect.html#569101584">(Jan 20 2026 at 18:32)</a>:</h4>
<p>then you would issue <code>roc test</code> right?   how do you perform a comprehensive run across multiple files?</p>



<a name="569102047"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/testing%20with%20expect/near/569102047" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/testing.20with.20expect.html#569102047">(Jan 20 2026 at 18:34)</a>:</h4>
<blockquote>
<p>then you would issue <code>roc test</code> right?</p>
</blockquote>
<p>Yes</p>
<blockquote>
<p>how do you perform a comprehensive run across multiple files?</p>
</blockquote>
<p>In the past with a bash script although I would like (as a new feature) the roc binary to auto-discover all tests in a project.</p>



<a name="569102382"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/testing%20with%20expect/near/569102382" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rick Hull <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/testing.20with.20expect.html#569102382">(Jan 20 2026 at 18:36)</a>:</h4>
<p>you could allow <code>roc test PATH</code> where PATH is like a subdir.  for a dir, recursive search all .roc files?</p>



<a name="569102481"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/testing%20with%20expect/near/569102481" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/testing.20with.20expect.html#569102481">(Jan 20 2026 at 18:37)</a>:</h4>
<p>Sounds good to me :)</p>



<a name="569120085"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/testing%20with%20expect/near/569120085" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rick Hull <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/testing.20with.20expect.html#569120085">(Jan 20 2026 at 20:19)</a>:</h4>
<p>because I am doing platform development, and host functions are impure, then I cannot use toplevel <code>expect</code> for these functions right?   i think I need the <code>justfile</code> runner</p>



<a name="569121184"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/testing%20with%20expect/near/569121184" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rick Hull <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/testing.20with.20expect.html#569121184">(Jan 20 2026 at 20:26)</a>:</h4>
<p>it's a little confusing about the different <code>expect</code> behaviors in different contexts (toplevel vs not, pure vs impure, <code>roc test</code> vs <code>roc</code>).  I wonder if there is a way to unify the behaviors. </p>
<p><span class="user-mention" data-user-id="281383">@Richard Feldman</span> said:</p>
<blockquote>
<p>the number one rule of <code>expect</code> is that it never affects control flow in any way<br>
no matter where it is used<br>
it is a harmless report<br>
maybe a better way to think of it is "debug print that an expectation was false, and then mark this test as 'must fail' when it finishes running"</p>
</blockquote>



<a name="569126395"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/testing%20with%20expect/near/569126395" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/testing.20with.20expect.html#569126395">(Jan 20 2026 at 20:58)</a>:</h4>
<p>Keep in mind that it's possible that things aren't yet implemented, or if they are it's a first pass and needs polish. I have been slow rolling the platform development and fixings bugs as I find them. Almost everything I've worked on has had a few significant bugs, and most of my time was spent trying to understand what the behaviour should be so I could properly isolate and describe the bug. If you find any issues it would be helpful to investigate, it's probably not you but just something is broken.</p>



<a name="569126809"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/testing%20with%20expect/near/569126809" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rick Hull <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/testing.20with.20expect.html#569126809">(Jan 20 2026 at 21:01)</a>:</h4>
<p>Thanks Luke; to answer my own question a bit, I keep all my "host functions" in <code>platform/Host.roc</code>, though it's not necessary to do it this way.  I have now isolated all my impure function testing to <code>test/host.roc</code>, which only calls functions from <code>platform/Host.roc</code>; thus I don't need a "test runner" at this point as I only have a single <code>test/*.roc</code> file</p>
<p>I migrated all other <code>test/*.roc</code> tests to "unit tests" at the toplevel within the source-file-under-test</p>



<a name="569130532"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/testing%20with%20expect/near/569130532" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rick Hull <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/testing.20with.20expect.html#569130532">(Jan 20 2026 at 21:25)</a>:</h4>
<p><code>roc test DIR</code>: <a href="https://github.com/roc-lang/roc/issues/9057">https://github.com/roc-lang/roc/issues/9057</a></p>



<hr><p>Last updated: Mar 01 2026 at 12:20 UTC</p>
</html>