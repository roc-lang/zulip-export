<html>
<head><meta charset="utf-8"><title>✔ Bug in List.reverse? · beginners · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/index.html">beginners</a></h2>
<h3>Topic: <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/.E2.9C.94.20Bug.20in.20List.2Ereverse.3F.html">✔ Bug in List.reverse?</a></h3>

<hr>

<base href="https://roc.zulipchat.com">

<head><link href="https://roc-lang.github.io/zulip-export/style.css" rel="stylesheet"></head>

<a name="412616862"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/%E2%9C%94%20Bug%20in%20List.reverse%3F/near/412616862" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> njlr <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/.E2.9C.94.20Bug.20in.20List.2Ereverse.3F.html#412616862">(Jan 12 2024 at 20:38)</a>:</h4>
<p>Here is my program:</p>
<div class="codehilite" data-code-language="Elm"><pre><span></span><code><span class="nv">app</span><span class="w"> </span><span class="s">"automatons"</span>
<span class="w">    </span><span class="nv">packages</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nv">pf</span><span class="nf">:</span><span class="w"> </span><span class="s">"https://github.com/roc-lang/basic-cli/releases/download/0.7.1/Icc3xJoIixF3hCcfXrDwLCu4wQHtNdPyoJkEbkgIElA.tar.br"</span><span class="w"> </span><span class="p">}</span>
<span class="w">    </span><span class="nv">imports</span><span class="w"> </span><span class="p">[</span><span class="nv">pf</span><span class="nf">.</span><span class="kt">Stdout</span><span class="p">]</span>
<span class="w">    </span><span class="nv">provides</span><span class="w"> </span><span class="p">[</span><span class="nv">main</span><span class="p">]</span><span class="w"> </span><span class="nv">to</span><span class="w"> </span><span class="nv">pf</span>

<span class="kt">Automaton</span><span class="w"> </span><span class="nv">i</span><span class="w"> </span><span class="nv">o</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="kt">Arrow</span><span class="w"> </span><span class="p">(</span><span class="nv">i</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="nv">o</span><span class="p">),</span><span class="w"> </span><span class="kt">Step</span><span class="w"> </span><span class="p">(</span><span class="nv">i</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="p">(</span><span class="kt">Automaton</span><span class="w"> </span><span class="nv">i</span><span class="w"> </span><span class="nv">o</span><span class="p">,</span><span class="w"> </span><span class="nv">o</span><span class="p">))</span><span class="w"> </span><span class="p">]</span>

<span class="err">#</span><span class="w"> </span><span class="kt">Get</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">output</span><span class="w"> </span><span class="nv">and</span><span class="w"> </span><span class="nv">next</span><span class="w"> </span><span class="kt">Automaton</span><span class="w"> </span><span class="nv">for</span><span class="w"> </span><span class="nv">a</span><span class="w"> </span><span class="nv">given</span><span class="w"> </span><span class="nv">input</span>
<span class="nv">step</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="nv">i</span><span class="p">,</span><span class="w"> </span><span class="kt">Automaton</span><span class="w"> </span><span class="nv">i</span><span class="w"> </span><span class="nv">o</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="p">(</span><span class="kt">Automaton</span><span class="w"> </span><span class="nv">i</span><span class="w"> </span><span class="nv">o</span><span class="p">,</span><span class="w"> </span><span class="nv">o</span><span class="p">)</span>
<span class="nv">step</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nf">\</span><span class="nv">input</span><span class="p">,</span><span class="w"> </span><span class="nv">automaton</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">    </span><span class="nv">when</span><span class="w"> </span><span class="nv">automaton</span><span class="w"> </span><span class="nv">is</span>
<span class="w">        </span><span class="kt">Arrow</span><span class="w"> </span><span class="nv">f</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="p">(</span><span class="nv">automaton</span><span class="p">,</span><span class="w"> </span><span class="nv">f</span><span class="w"> </span><span class="nv">input</span><span class="p">)</span>
<span class="w">        </span><span class="kt">Step</span><span class="w"> </span><span class="nv">f</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="nv">f</span><span class="w"> </span><span class="nv">input</span>

<span class="err">#</span><span class="w"> </span><span class="kt">Run</span><span class="w"> </span><span class="nv">an</span><span class="w"> </span><span class="kt">Automaton</span><span class="w"> </span><span class="nv">on</span><span class="w"> </span><span class="nv">a</span><span class="w"> </span><span class="nv">list</span><span class="w"> </span><span class="kr">of</span><span class="w"> </span><span class="nv">inputs</span><span class="w"> </span><span class="nv">till</span><span class="w"> </span><span class="nv">completion</span>
<span class="nv">run</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">List</span><span class="w"> </span><span class="nv">i</span><span class="p">,</span><span class="w"> </span><span class="kt">Automaton</span><span class="w"> </span><span class="nv">i</span><span class="w"> </span><span class="nv">o</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">List</span><span class="w"> </span><span class="nv">o</span>
<span class="nv">run</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nf">\</span><span class="nv">inputs</span><span class="p">,</span><span class="w"> </span><span class="nv">automaton</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">    </span><span class="nv">loop</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nf">\</span><span class="nv">remaining</span><span class="p">,</span><span class="w"> </span><span class="nv">current</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">        </span><span class="nv">when</span><span class="w"> </span><span class="nv">remaining</span><span class="w"> </span><span class="nv">is</span>
<span class="w">            </span><span class="p">[]</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="p">[]</span>
<span class="w">            </span><span class="p">[</span><span class="nv">x</span><span class="p">,</span><span class="w"> </span><span class="nf">..</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="nv">xs</span><span class="p">]</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">                </span><span class="p">(</span><span class="nv">next</span><span class="p">,</span><span class="w"> </span><span class="nv">output</span><span class="p">)</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nv">step</span><span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="nv">current</span>
<span class="w">                </span><span class="kt">List</span><span class="nf">.</span><span class="nv">append</span><span class="w"> </span><span class="p">(</span><span class="nv">run</span><span class="w"> </span><span class="nv">xs</span><span class="w"> </span><span class="nv">next</span><span class="p">)</span><span class="w"> </span><span class="nv">output</span>

<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="nv">loop</span><span class="w"> </span><span class="nv">inputs</span><span class="w"> </span><span class="nv">automaton</span>
<span class="w">    </span><span class="kt">List</span><span class="nf">.</span><span class="nv">reverse</span><span class="w"> </span><span class="p">(</span><span class="nv">loop</span><span class="w"> </span><span class="nv">inputs</span><span class="w"> </span><span class="nv">automaton</span><span class="p">)</span>


<span class="err">#</span><span class="w"> </span><span class="kt">Automaton</span><span class="w"> </span><span class="nv">that</span><span class="w"> </span><span class="nv">doubles</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">input</span>
<span class="nv">doubler</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="kt">Arrow</span><span class="w"> </span><span class="p">(</span><span class="nf">\</span><span class="nv">x</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="nf">*</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span>

<span class="kr">main </span><span class="nf">=</span>
<span class="w">    </span><span class="nv">inputs</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="p">]</span>
<span class="w">    </span><span class="nv">output</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nv">run</span><span class="w"> </span><span class="nv">inputs</span><span class="w"> </span><span class="nv">doubler</span>
<span class="w">    </span><span class="nv">outputStr</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nv">output</span><span class="w"> </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">List</span><span class="nf">.</span><span class="nv">map</span><span class="w"> </span><span class="kt">Num</span><span class="nf">.</span><span class="nv">toStr</span><span class="w"> </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">Str</span><span class="nf">.</span><span class="nv">joinWith</span><span class="w"> </span><span class="s">", "</span>
<span class="w">    </span><span class="kt">Stdout</span><span class="nf">.</span><span class="nv">line</span><span class="w"> </span><span class="nv">outputStr</span>


<span class="err">#</span><span class="w"> </span><span class="kt">Without</span><span class="w"> </span><span class="kt">List</span><span class="nf">.</span><span class="nv">reverse</span>
<span class="err">#</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span>

<span class="err">#</span><span class="w"> </span><span class="kt">With</span><span class="w"> </span><span class="kt">List</span><span class="nf">.</span><span class="nv">reverse</span>
<span class="err">#</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span>

<span class="err">#</span><span class="w"> </span><span class="kt">I</span><span class="w"> </span><span class="nv">would</span><span class="w"> </span><span class="nv">expect</span>
<span class="err">#</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span>
</code></pre></div>
<p>Expected and actual in the comments at the end.<br>
Removing <code>List.reverse</code> gets rid of the weirdness, although is not correct implementation-wise.</p>



<a name="412617047"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/%E2%9C%94%20Bug%20in%20List.reverse%3F/near/412617047" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> njlr <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/.E2.9C.94.20Bug.20in.20List.2Ereverse.3F.html#412617047">(Jan 12 2024 at 20:40)</a>:</h4>
<p>Unless I'm missing something stupid I can file on GitHub</p>



<a name="412642590"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/%E2%9C%94%20Bug%20in%20List.reverse%3F/near/412642590" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/.E2.9C.94.20Bug.20in.20List.2Ereverse.3F.html#412642590">(Jan 13 2024 at 00:23)</a>:</h4>
<p>I think it is working correctly:</p>
<div class="codehilite"><pre><span></span><code>[/tmp/test.roc:50] list = []
[/tmp/test.roc:52] out = []
[/tmp/test.roc:50] list = [10]
[/tmp/test.roc:52] out = [10]
[/tmp/test.roc:50] list = [10, 8]
[/tmp/test.roc:52] out = [8, 10]
[/tmp/test.roc:50] list = [8, 10, 6]
[/tmp/test.roc:52] out = [6, 10, 8]
[/tmp/test.roc:50] list = [6, 10, 8, 4]
[/tmp/test.roc:52] out = [4, 8, 10, 6]
[/tmp/test.roc:50] list = [4, 8, 10, 6, 2]
[/tmp/test.roc:52] out = [2, 6, 10, 8, 4]
</code></pre></div>



<a name="412642616"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/%E2%9C%94%20Bug%20in%20List.reverse%3F/near/412642616" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/.E2.9C.94.20Bug.20in.20List.2Ereverse.3F.html#412642616">(Jan 13 2024 at 00:23)</a>:</h4>
<p>looks like an impl bug for your code</p>



<a name="412642630"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/%E2%9C%94%20Bug%20in%20List.reverse%3F/near/412642630" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/.E2.9C.94.20Bug.20in.20List.2Ereverse.3F.html#412642630">(Jan 13 2024 at 00:23)</a>:</h4>
<p>probably reversing more than you want</p>



<a name="412689571"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/%E2%9C%94%20Bug%20in%20List.reverse%3F/near/412689571" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> njlr <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/.E2.9C.94.20Bug.20in.20List.2Ereverse.3F.html#412689571">(Jan 13 2024 at 08:49)</a>:</h4>
<p>In my code above, if I swap these two lines (in the <code>run</code> function):</p>
<div class="codehilite" data-code-language="Elm"><pre><span></span><code><span class="kt">List</span><span class="nf">.</span><span class="nv">reverse</span><span class="w"> </span><span class="p">(</span><span class="nv">loop</span><span class="w"> </span><span class="nv">inputs</span><span class="w"> </span><span class="nv">automaton</span><span class="p">)</span>
<span class="err">#</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span>
</code></pre></div>
<div class="codehilite" data-code-language="Elm"><pre><span></span><code><span class="nv">loop</span><span class="w"> </span><span class="nv">inputs</span><span class="w"> </span><span class="nv">automaton</span>
<span class="err">#</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span>
</code></pre></div>
<p>Then the final output is <em>not</em> the reverse of the other, which I think is odd. <br>
Maybe I'm missing something?</p>



<a name="412695145"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/%E2%9C%94%20Bug%20in%20List.reverse%3F/near/412695145" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Hannes Nevalainen <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/.E2.9C.94.20Bug.20in.20List.2Ereverse.3F.html#412695145">(Jan 13 2024 at 10:08)</a>:</h4>
<p>You are recursively calling your “run” function, so you are doing a lot of reversing. <br>
Not just on the final list as I think you intended.</p>
<p>Try putting the reverse inside <br>
 main instead.</p>



<a name="412695661"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/%E2%9C%94%20Bug%20in%20List.reverse%3F/near/412695661" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> njlr <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/.E2.9C.94.20Bug.20in.20List.2Ereverse.3F.html#412695661">(Jan 13 2024 at 10:16)</a>:</h4>
<p>Ah yes! Thank you</p>
<p>I was recursively calling <code>run</code> where I should have been calling <code>loop</code></p>
<p>This works:</p>
<div class="codehilite" data-code-language="Elm"><pre><span></span><code><span class="nv">run</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">List</span><span class="w"> </span><span class="nv">i</span><span class="p">,</span><span class="w"> </span><span class="kt">Automaton</span><span class="w"> </span><span class="nv">i</span><span class="w"> </span><span class="nv">o</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">List</span><span class="w"> </span><span class="nv">o</span>
<span class="nv">run</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nf">\</span><span class="nv">inputs</span><span class="p">,</span><span class="w"> </span><span class="nv">automaton</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">    </span><span class="nv">loop</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nf">\</span><span class="nv">remaining</span><span class="p">,</span><span class="w"> </span><span class="nv">current</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">        </span><span class="nv">when</span><span class="w"> </span><span class="nv">remaining</span><span class="w"> </span><span class="nv">is</span>
<span class="w">            </span><span class="p">[]</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="p">[]</span>
<span class="w">            </span><span class="p">[</span><span class="nv">x</span><span class="p">,</span><span class="w"> </span><span class="nf">..</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="nv">xs</span><span class="p">]</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">                </span><span class="p">(</span><span class="nv">next</span><span class="p">,</span><span class="w"> </span><span class="nv">output</span><span class="p">)</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nv">step</span><span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="nv">current</span>
<span class="w">                </span><span class="kt">List</span><span class="nf">.</span><span class="nv">append</span><span class="w"> </span><span class="p">(</span><span class="nv">loop</span><span class="w"> </span><span class="nv">xs</span><span class="w"> </span><span class="nv">next</span><span class="p">)</span><span class="w"> </span><span class="nv">output</span>

<span class="w">    </span><span class="nv">loop</span><span class="w"> </span><span class="nv">inputs</span><span class="w"> </span><span class="nv">automaton</span>
<span class="w">    </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">List</span><span class="nf">.</span><span class="nv">reverse</span>
</code></pre></div>



<a name="412695709"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/%E2%9C%94%20Bug%20in%20List.reverse%3F/near/412695709" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Notification Bot <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/.E2.9C.94.20Bug.20in.20List.2Ereverse.3F.html#412695709">(Jan 13 2024 at 10:16)</a>:</h4>
<p><span class="user-mention silent" data-user-id="680630">njlr</span> has marked this topic as resolved.</p>



<hr><p>Last updated: Mar 01 2026 at 12:20 UTC</p>
</html>