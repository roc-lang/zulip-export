<html>
<head><meta charset="utf-8"><title>Algebraic Effects · beginners · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/index.html">beginners</a></h2>
<h3>Topic: <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Algebraic.20Effects.html">Algebraic Effects</a></h3>

<hr>

<base href="https://roc.zulipchat.com">

<head><link href="https://roc-lang.github.io/zulip-export/style.css" rel="stylesheet"></head>

<a name="432620127"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Algebraic%20Effects/near/432620127" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aurora <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Algebraic.20Effects.html#432620127">(Apr 11 2024 at 03:03)</a>:</h4>
<p>so I remember seeing Richard's talk on using algebraic effects,, which was really exciting to see in a non-research language, I thought it was a really elegant way to incorporate this capabilities based paradigm with functional ideas.. but looking at the docs as they stand today it seems like that was moved away from? or that the task system is more opaque now? and proposals linked on the docs page seem to break the promises of the platform based architecture... if y'all did indeed move away from algebraic effects, what was the rationale behind that decision? what were the pain points of that API?</p>



<a name="432620409"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Algebraic%20Effects/near/432620409" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Algebraic.20Effects.html#432620409">(Apr 11 2024 at 03:06)</a>:</h4>
<p>You're talking about the 3 parameter version of <code>Task</code> that has a 3rd arg that tracks what effects can be run?</p>
<p><code>Task okType errType [Stdout, Stdin, EtcIO]</code></p>



<a name="432621111"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Algebraic%20Effects/near/432621111" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Algebraic.20Effects.html#432621111">(Apr 11 2024 at 03:17)</a>:</h4>
<p>The spiritual successor proposal to that is the <a href="https://docs.google.com/document/d/110MwQi7Dpo1Y69ECFXyyvDWzF4OYv1BLojIm08qDTvg">module params proposal</a>. Less verbose, though also less precise, but still affords many similar benefits. It is currently being implemented, but is not complete yet.</p>



<a name="432622402"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Algebraic%20Effects/near/432622402" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aurora <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Algebraic.20Effects.html#432622402">(Apr 11 2024 at 03:33)</a>:</h4>
<p>I guess I was asking why module params is the choice over 3 param tasks, to me 3 param tasks (or 2 params with a return type that can be a result) are exactly what I want from an effect system, I want Effectful functions to be explicit, I want that verbosity (although that verbosity isn't mandatory with full type inference). I want the compiler to tell me "you're using IO in this function so your type signature is wrong". I'm sure y'all have probably been over these discussions hundreds of times already which is why I'm sure y'all have a reason for picking the module params option, but from an outsider perspective it seems like a much less elegant and expressive API?</p>



<a name="432706450"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Algebraic%20Effects/near/432706450" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Algebraic.20Effects.html#432706450">(Apr 11 2024 at 13:30)</a>:</h4>
<p>a few thoughts!</p>



<a name="432706497"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Algebraic%20Effects/near/432706497" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Algebraic.20Effects.html#432706497">(Apr 11 2024 at 13:30)</a>:</h4>
<p>we've never done algebraic effects in Roc - <a href="https://www.unison-lang.org/docs/fundamentals/abilities/">Unison does them</a> but we've always used <code>Task</code> instead</p>



<a name="432706805"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Algebraic%20Effects/near/432706805" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Algebraic.20Effects.html#432706805">(Apr 11 2024 at 13:32)</a>:</h4>
<p><span class="user-mention silent" data-user-id="709244">Aurora</span> <a href="#narrow/stream/231634-beginners/topic/Algebraic.20Effects/near/432622402">said</a>:</p>
<blockquote>
<p>I want the compiler to tell me "you're using IO in this function so your type signature is wrong".</p>
</blockquote>
<p><code>Task</code> accomplishes this; there's no way to do I/O in Roc, other than to have a function return a <code>Task</code> - so there are no side effects in Roc  (with the exception of the <code>dbg</code> and <code>expect</code> keywords, which can potentially print things out), just managed effects</p>



<a name="432707143"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Algebraic%20Effects/near/432707143" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Algebraic.20Effects.html#432707143">(Apr 11 2024 at 13:33)</a>:</h4>
<p>an example of 2-arg <code>Task</code> is something like <a href="https://www.roc-lang.org/packages/basic-cli/File#readBytes"><code>File.readBytes</code></a>; its 2 type parameters are the type the <code>Task</code> gives you if it succeeds (<code>List U8</code> in the case of <code>File.readBytes</code>) and the type it gives you if the task fails (<code>[FileReadErr Path ReadErr]</code> in the case of <code>File.readBytes</code>)</p>



<a name="432707282"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Algebraic%20Effects/near/432707282" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Algebraic.20Effects.html#432707282">(Apr 11 2024 at 13:34)</a>:</h4>
<p>3-arg <code>Task</code> was something we tried out where we had a third type parameter which was just for tracking separate information about what specifically the effect was doing</p>



<a name="432707481"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Algebraic%20Effects/near/432707481" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Algebraic.20Effects.html#432707481">(Apr 11 2024 at 13:35)</a>:</h4>
<p>for example, instead of <code>File.readBytes</code> returning a <code>Task (List U8) ReadErr</code> (2-arg design) it might instead return <code>Task (List U8) ReadErr [FilesystemRead]</code> (3-arg design)</p>



<a name="432707823"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Algebraic%20Effects/near/432707823" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Algebraic.20Effects.html#432707823">(Apr 11 2024 at 13:37)</a>:</h4>
<p>so then if you made a HTTP request task return <code>[NetworkAccess]</code> instead of <code>[FilesystemRead]</code>, then if you did both a HTTP request as well as a filesystem read, you'd end up with a <code>Task</code> whose third argument included both of those: <code>[NetworkAccess, FilesystemRead]</code> and that way you'd be able to see in the type that "this task is both accessing the network and also reading from the filesystem"</p>



<a name="432707938"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Algebraic%20Effects/near/432707938" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Algebraic.20Effects.html#432707938">(Apr 11 2024 at 13:37)</a>:</h4>
<p>and you'd also know that the task is <em>not</em> writing to the filesystem, because if it were, then <code>FilesystemWrite</code> would have been a part of that type</p>



<a name="432707976"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Algebraic%20Effects/near/432707976" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Algebraic.20Effects.html#432707976">(Apr 11 2024 at 13:38)</a>:</h4>
<p>so that's the upside of that design</p>



<a name="432708069"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Algebraic%20Effects/near/432708069" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Algebraic.20Effects.html#432708069">(Apr 11 2024 at 13:38)</a>:</h4>
<p>a downside is that you end up having to thread that information through everywhere, even in places where you don't really care</p>



<a name="432708406"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Algebraic%20Effects/near/432708406" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Algebraic.20Effects.html#432708406">(Apr 11 2024 at 13:40)</a>:</h4>
<p>it's easy to think "I want that everywhere!" but then in practice if you end up with a bunch of little helper funcions that are now returning <code>Task Str [] [FilesystemRead, FilesystemWrite, NetworkAccess, Stdout, Stderr, Stdin]</code> then pretty quickly you either start wanting to make a type alias or else just write <code>Task Str [] _</code> so you don't have to see all that in the source code (although whenever you write <code>_</code> the compiler keeps tracking the type, it's just hidden in that particular annotation)</p>



<a name="432708459"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Algebraic%20Effects/near/432708459" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Algebraic.20Effects.html#432708459">(Apr 11 2024 at 13:40)</a>:</h4>
<p>another downside is that it has limited expressivity</p>



<a name="432708570"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Algebraic%20Effects/near/432708570" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Algebraic.20Effects.html#432708570">(Apr 11 2024 at 13:41)</a>:</h4>
<p>for example, there's no way to say "this task only writes to subdirectories of <code>./some/path/blah</code> on the filesystem"</p>



<a name="432708743"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Algebraic%20Effects/near/432708743" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Algebraic.20Effects.html#432708743">(Apr 11 2024 at 13:42)</a>:</h4>
<p>or "this task only connects to the database I've named <code>foo</code>" or "this task only does network requests to <code>my-error-reporting-service.com</code> and <code>my-analytics-service.com</code> but it doesn't do network requests to any other domain"</p>



<a name="432708897"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Algebraic%20Effects/near/432708897" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Algebraic.20Effects.html#432708897">(Apr 11 2024 at 13:43)</a>:</h4>
<p>the design we're moving towards gives us the ability to express those more granular constraints, but not using <code>Task</code> itself (which is why it no longer needs the third argument)</p>



<a name="432709439"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Algebraic%20Effects/near/432709439" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Algebraic.20Effects.html#432709439">(Apr 11 2024 at 13:46)</a>:</h4>
<p>so first I'll explain the design without module parameters, and then explain how module parameters make the design nicer</p>



<a name="432710347"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Algebraic%20Effects/near/432710347" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Algebraic.20Effects.html#432710347">(Apr 11 2024 at 13:50)</a>:</h4>
<p>the basic idea is to express all I/O operations (e.g. <code>Http.getUtf8</code>) in terms of some low-level I/O primitive (e.g. <code>Http.getUtf8</code> is a wrapper around <code>Http.request</code>), <em>and</em> that functions like <code>Http.getUtf8</code> don't actually internally know what that low-level operation is. Instead, wrapper functions like <code>Http.getUtf8</code> all get an additional argument - so when you call <code>Http.getUtf8</code> you have to pass in <code>Http.request</code> as an argument to it, because it doesn't actually know how to do a HTTP request otherwise; it just knows how to call the <code>Http.request</code> function you're providing it to configure it for UTF-8 and doing a HTTP GET</p>



<a name="432710415"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Algebraic%20Effects/near/432710415" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Algebraic.20Effects.html#432710415">(Apr 11 2024 at 13:50)</a>:</h4>
<p>(that probably sounds very un-ergonomic, which it would be! Module params solve that ergonomics problem, as we'll see)</p>



<a name="432710650"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Algebraic%20Effects/near/432710650" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Algebraic.20Effects.html#432710650">(Apr 11 2024 at 13:52)</a>:</h4>
<p>importantly, in the new design, the way you get access to I/O primitives is that the lowest-level ones essentially get passed in from the platform to the application's <code>main</code> as arguments</p>



<a name="432710731"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Algebraic%20Effects/near/432710731" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Algebraic.20Effects.html#432710731">(Apr 11 2024 at 13:52)</a>:</h4>
<p>so like <code>main</code> actually receives the low-level <code>Http.request</code> (and other I/O primitives) as arguments at runtime</p>



<a name="432710785"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Algebraic%20Effects/near/432710785" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Algebraic.20Effects.html#432710785">(Apr 11 2024 at 13:52)</a>:</h4>
<p>and - this is also very important - there is no way to just <code>import Http.request</code> directly</p>



<a name="432710866"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Algebraic%20Effects/near/432710866" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Algebraic.20Effects.html#432710866">(Apr 11 2024 at 13:53)</a>:</h4>
<p>the only possible way to get access to any function that actually returns a <code>Task</code> is by asking for it as an argument</p>



<a name="432710888"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Algebraic%20Effects/near/432710888" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Algebraic.20Effects.html#432710888">(Apr 11 2024 at 13:53)</a>:</h4>
<p>and then threading it through by argument passing</p>



<a name="432710925"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Algebraic%20Effects/near/432710925" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Algebraic.20Effects.html#432710925">(Apr 11 2024 at 13:53)</a>:</h4>
<p>(again, the ergonomics sound terrible without module params!)</p>



<a name="432710959"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Algebraic%20Effects/near/432710959" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Algebraic.20Effects.html#432710959">(Apr 11 2024 at 13:53)</a>:</h4>
<p>this has several nonobvious benefits</p>



<a name="432711083"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Algebraic%20Effects/near/432711083" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Algebraic.20Effects.html#432711083">(Apr 11 2024 at 13:53)</a>:</h4>
<p>one is that, since all I/O operations are now threaded through the whole program as functions being passed as arguments, you are always free to pass different functions</p>



<a name="432711253"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Algebraic%20Effects/near/432711253" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Algebraic.20Effects.html#432711253">(Apr 11 2024 at 13:54)</a>:</h4>
<p>for example, instead of passing a <em>real</em> <code>Http.request</code>, in a test I can pass in a fake one that simulates whatever I want it to simulate - e.g. that the server timed out, or returned a 500, etc. My test doesn't need to run any real I/O, try to contact a real server, etc.</p>



<a name="432711554"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Algebraic%20Effects/near/432711554" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Algebraic.20Effects.html#432711554">(Apr 11 2024 at 13:56)</a>:</h4>
<p>and since all effects in the code base are necessarily being passed around as arguments (again, in this design there is <em>no way</em>, at a language level to directly <code>import</code> a real <code>Task</code> in an application - literally the only possible way to obtain one is by having it passed into <code>main</code> as an argument and then threaded through everything else, and the same is true of packages)</p>



<a name="432711657"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Algebraic%20Effects/near/432711657" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Algebraic.20Effects.html#432711657">(Apr 11 2024 at 13:56)</a>:</h4>
<p>...we know that the simulation will work everywhere, and there will never be any real HTTP done in that test</p>



<a name="432711724"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Algebraic%20Effects/near/432711724" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Algebraic.20Effects.html#432711724">(Apr 11 2024 at 13:56)</a>:</h4>
<p>(this is a difference between this design and, say, mocking/monkey patching in other languages)</p>



<a name="432711785"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Algebraic%20Effects/near/432711785" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Algebraic.20Effects.html#432711785">(Apr 11 2024 at 13:56)</a>:</h4>
<p>another thing we get is that platform-agnostic packages become very straightforward</p>



<a name="432711855"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Algebraic%20Effects/near/432711855" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Algebraic.20Effects.html#432711855">(Apr 11 2024 at 13:57)</a>:</h4>
<p>since packages all need to say "pass me in a <code>Http.request</code> function because otherwise I have no possible way to do HTTP"</p>



<a name="432712046"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Algebraic%20Effects/near/432712046" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Algebraic.20Effects.html#432712046">(Apr 11 2024 at 13:58)</a>:</h4>
<p>you can have different platforms implement that function completely differently under the hood, but as long as they have the same type and work the same way, your application can pass them along to packages and the package neither knows nor cares that the particular <code>Http.request</code> it's receiving came from a different platform</p>



<a name="432712159"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Algebraic%20Effects/near/432712159" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Algebraic.20Effects.html#432712159">(Apr 11 2024 at 13:58)</a>:</h4>
<p>I said earlier that 3-arg task design couldn't do this:</p>
<p><span class="user-mention silent" data-user-id="281383">Richard Feldman</span> <a href="#narrow/stream/231634-beginners/topic/Algebraic.20Effects/near/432708743">said</a>:</p>
<blockquote>
<p>or "this task only connects to the database I've named <code>foo</code>" or "this task only does network requests to <code>my-error-reporting-service.com</code> and <code>my-analytics-service.com</code> but it doesn't do network requests to any other domain"</p>
</blockquote>



<a name="432712180"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Algebraic%20Effects/near/432712180" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Algebraic.20Effects.html#432712180">(Apr 11 2024 at 13:58)</a>:</h4>
<p>this design can absolutely do that!</p>



<a name="432712383"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Algebraic%20Effects/near/432712383" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Algebraic.20Effects.html#432712383">(Apr 11 2024 at 13:59)</a>:</h4>
<p>the way it works is, if I have a function which asks for <code>Http.request</code> as an argument (which tells me at the type level that the function does HTTP, just like how <code>[NetworkAccess]</code> did in 3-arg task, except in a different part of the type)</p>



<a name="432712409"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Algebraic%20Effects/near/432712409" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Algebraic.20Effects.html#432712409">(Apr 11 2024 at 13:59)</a>:</h4>
<p>I don't have to give that function a real <code>Http.request</code></p>



<a name="432712549"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Algebraic%20Effects/near/432712549" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Algebraic.20Effects.html#432712549">(Apr 11 2024 at 14:00)</a>:</h4>
<p>I can give it a wrapper around <code>Http.request</code> which only permits contacting a particular domain - essentially, I'm giving it "sandboxed access" to the network</p>



<a name="432713010"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Algebraic%20Effects/near/432713010" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Algebraic.20Effects.html#432713010">(Apr 11 2024 at 14:02)</a>:</h4>
<p>so now if I'm using a 3rd-party error logging package for <a href="http://bugsnag.com">bugsnag.com</a>, which requests <code>Http.request</code> so that it can do HTTP, I can give it a sandboxed function which only ever accepts URLs to <a href="http://bugsnag.com">bugsnag.com</a>, which means that if someone malicious compromises that package and publishes a new release which sends data to <a href="http://stealyourdata.com">stealyourdata.com</a> instead of <a href="http://bugsnag.com">bugsnag.com</a>, my data won't end up going there because the package has literally no way to do HTTP other than the wrapped <code>Http.request</code> I gave it which refuses to talk to anything but <a href="http://bugsnag.com">bugsnag.com</a></p>



<a name="432713178"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Algebraic%20Effects/near/432713178" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Algebraic.20Effects.html#432713178">(Apr 11 2024 at 14:03)</a>:</h4>
<p>anyway, I gotta run, but - the linked doc from earlier explains how module params preserve all of these benefits without the ergonomics downside of having to pass these through as arguments to functions (instead they get passed through module imports and the functions themselves don't look like they're getting extra arguments)</p>



<a name="432713274"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Algebraic%20Effects/near/432713274" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Algebraic.20Effects.html#432713274">(Apr 11 2024 at 14:03)</a>:</h4>
<p>but if you really wanted that granularity, you could choose to do it at the function level like I've described here - although personally I think it would be more ergonomic to use module params <span aria-label="big smile" class="emoji emoji-1f604" role="img" title="big smile">:big_smile:</span></p>



<a name="432720251"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Algebraic%20Effects/near/432720251" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Algebraic.20Effects.html#432720251">(Apr 11 2024 at 14:34)</a>:</h4>
<p><span aria-label="point up" class="emoji emoji-1f446" role="img" title="point up">:point_up:</span> this is a really detailed explanation. We should capture it somewhere for future reference.</p>



<a name="432778475"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Algebraic%20Effects/near/432778475" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Isaac Van Doren <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Algebraic.20Effects.html#432778475">(Apr 11 2024 at 20:01)</a>:</h4>
<p>Yes this was a great read!</p>



<a name="432815314"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Algebraic%20Effects/near/432815314" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aurora <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Algebraic.20Effects.html#432815314">(Apr 12 2024 at 01:50)</a>:</h4>
<p>thanks! this explains the design decision in a very clear way for someone who's not familiar with the details of the implementation or the development history! :)</p>



<a name="432815740"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Algebraic%20Effects/near/432815740" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Algebraic.20Effects.html#432815740">(Apr 12 2024 at 01:57)</a>:</h4>
<p>One interesting side note:</p>
<p>Technically speaking, you could have both. You could have 3 arg tasks and still use module params. That said, we plan to make task a builtin module eventual and decouple it from individual platforms. When that happens, we will almost certainly lock in on 2 arg tasks, so the ecosystem would follow. A platform would have to roll their own task type to get 3 arg tasks (which a very security focused platform might).</p>



<a name="435075298"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Algebraic%20Effects/near/435075298" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eli Dowling <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Algebraic.20Effects.html#435075298">(Apr 23 2024 at 22:08)</a>:</h4>
<p>I would love to hear a further look into the benifits and drawbacks of this system as opposed to an effects system like ocaml(once types effects arrives) or unison that you linked to? </p>
<p>A few basic arguments for I can think of:</p>
<p>To me it seems like you could implement the same pattern of http request limiting using: </p>
<div class="codehilite" data-code-language="OCaml"><pre><span></span><code><span class="k">let</span> <span class="n">constrain_http</span> <span class="n">func</span> <span class="n">domain</span>
<span class="k">try</span>
<span class="n">func</span><span class="bp">()</span>
<span class="k">with</span>
<span class="o">|(</span><span class="nc">HttpRequest</span> <span class="n">destination</span><span class="o">)</span> <span class="k">as</span> <span class="n">httpEfffect</span> <span class="o">-&gt;</span>
   <span class="k">if</span> <span class="n">destination</span><span class="o">|&gt;</span> <span class="nn">Str</span><span class="p">.</span><span class="n">startswith</span> <span class="n">domain</span> <span class="k">then</span>
       <span class="n">reraise</span> <span class="nc">HttpRequest</span> <span class="n">httpEffect</span>
</code></pre></div>
<p>(Wrote on my phone, syntax is probably slightly wrong but you get the idea)</p>
<p>It's also a lot more general than Task, meaning you can build your own amazing things on-top of effects systems like implementing a concurrency system as a library author rather than a compiler dev. (Eio and riot for Ocaml are both pretty wild examples of this.), or the dotnet Json parsing thing we discussed, recently where they halt and then resume parsing when more data is available. Dotnet does some manic storing and resuming  a stack frame, but effects enable that easily. </p>
<p>It doesn't give you coloured functions. You don't have to constantly write async everywhere. This is largely solved by type inference for task, but it's even nicer because you don't even need Task.await or anything, you just call functions. </p>
<p>Effects allow embedding of stack traces in debug mode. </p>
<p><strong>Some arguments for Task I can think of :</strong></p>
<p>You can run simple functions on the errors like t|&gt;Task.mapErr, whereas in an effect system you need a proper <code>try with</code> block around your statement.</p>
<p>I imagine it's easier to implement</p>
<p>As I said I'd love to hear some more reasons for Task .While I don't have a huge preference effect systems do seem slightly more powerful and ergonomic from my own (limited) useage.</p>



<a name="435415435"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Algebraic%20Effects/near/435415435" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Algebraic.20Effects.html#435415435">(Apr 25 2024 at 15:29)</a>:</h4>
<p>I have various unstructured thoughts on this topic, but overall it pretty much boils down to:</p>
<p>algebraic effects are a new idea that's only very recently gone from research-only to being implemented in non-research languages, and unlike research-y behind the scenes optimizations (like how Roc compiles lambdas etc.) if it turns out to have practical problems that make it undesirable, taking it out of the language after the fact is a gigantic breaking change for every code base - whereas if a research-y behind-the-scenes optimization doesn't end up working out, you can always switch to a different optimization strategy (e.g. one that's not as fast but which is more battle-tested) without requiring a rewrite of the whole ecosystem</p>



<a name="435415683"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Algebraic%20Effects/near/435415683" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Algebraic.20Effects.html#435415683">(Apr 25 2024 at 15:30)</a>:</h4>
<p>so basically, there might be benefits, but nobody knows what the unexpected surprises will be when you build an ecosystem on top of them, because they're so new that it has literally never happened before - there's no precedent to point at to say "that's what it looks like when an ecosystem is built on algebraic effects"</p>



<a name="435415706"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Algebraic%20Effects/near/435415706" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Algebraic.20Effects.html#435415706">(Apr 25 2024 at 15:30)</a>:</h4>
<p>Unison's is the biggest in the world, by far</p>



<a name="435415836"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Algebraic%20Effects/near/435415836" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Algebraic.20Effects.html#435415836">(Apr 25 2024 at 15:31)</a>:</h4>
<p>a second reason not to is that in general I have a strong preference for keeping the number of semantic primitives in Roc as small as possible.</p>



<a name="435416448"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Algebraic%20Effects/near/435416448" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Algebraic.20Effects.html#435416448">(Apr 25 2024 at 15:34)</a>:</h4>
<p>the bar for introducing things that are effectively sugar for other things that already exist in the language (e.g. string interpolation, <code>!</code>, record builders, and module params are all language features that can be desugared into Roc code that compiles to the same thing; they improve ergonomics but don't fundamentally let you do something that couldn't be done before) is much lower than the bar for introducing things that are impossible to express in terms of something else</p>



<a name="435416544"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Algebraic%20Effects/near/435416544" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Algebraic.20Effects.html#435416544">(Apr 25 2024 at 15:34)</a>:</h4>
<p>for example, Abilities were a new language primitive that couldn't be desugared into existing primitives, and the bar was really high for adding them to the language. We thought there would be enough benefits (e.g. automatic encoding/decoding, function equality becoming a compile-time error, <code>Eq</code> for custom data structures, more control over what opaque types do and don't support) to meet that bar</p>



<a name="435416635"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Algebraic%20Effects/near/435416635" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Algebraic.20Effects.html#435416635">(Apr 25 2024 at 15:35)</a>:</h4>
<p>it seems like especially given <code>!</code> the potential benefits of algebraic effects compared to <code>Task</code> are a lot less clear to me</p>



<a name="435416751"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Algebraic%20Effects/near/435416751" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Algebraic.20Effects.html#435416751">(Apr 25 2024 at 15:36)</a>:</h4>
<p><span class="user-mention silent" data-user-id="651372">Eli Dowling</span> <a href="#narrow/stream/231634-beginners/topic/Algebraic.20Effects/near/435075298">said</a>:</p>
<blockquote>
<p>It's also a lot more general than Task, meaning you can build your own amazing things on-top of effects systems like implementing a concurrency system as a library author rather than a compiler dev. (Eio and riot for Ocaml are both pretty wild examples of this.)</p>
</blockquote>
<p>I don't think it's safe to assume this is a good thing <span aria-label="big smile" class="emoji emoji-1f604" role="img" title="big smile">:big_smile:</span></p>



<a name="435416921"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Algebraic%20Effects/near/435416921" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Algebraic.20Effects.html#435416921">(Apr 25 2024 at 15:36)</a>:</h4>
<p>I don't have much familiarity with the OCaml ecosystem, but even before algebraic effects, a common complaint I'd heard is that there were multiple competing ways to do concurrency, and there's an ecosystem split around which ways to represent libraries which want concurrency. Same with Scala.</p>



<a name="435417088"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Algebraic%20Effects/near/435417088" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Algebraic.20Effects.html#435417088">(Apr 25 2024 at 15:37)</a>:</h4>
<p>having one <code>Task</code> type that everyone uses, and where platform authors can implement domain-specific concurrency systems behind the scenes (as <em>opposed to</em> library authors doing the same) seems like it can get the performance benefits of the domain-specific concurrency system without the drawback of the ecosystem split. Or at least that's the theory! We'll see how it works out in practice.</p>



<a name="435418009"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Algebraic%20Effects/near/435418009" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Algebraic.20Effects.html#435418009">(Apr 25 2024 at 15:43)</a>:</h4>
<p><span class="user-mention silent" data-user-id="651372">Eli Dowling</span> <a href="#narrow/stream/231634-beginners/topic/Algebraic.20Effects/near/435075298">said</a>:</p>
<blockquote>
<p>You don't have to constantly write async everywhere. This is largely solved by type inference for task, but it's even nicer because you don't even need Task.await or anything, you just call functions. </p>
</blockquote>
<p>when writing things like quick scripts without type annotations, I think having to write <code>Stdout.line!</code> compared to <code>Stdout.line</code> is an insignificant cost, and I actually like that it adds a visual marker of where all the effects are happening in that code!</p>



<a name="435419243"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Algebraic%20Effects/near/435419243" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Algebraic.20Effects.html#435419243">(Apr 25 2024 at 15:50)</a>:</h4>
<p>another thing that falls under the category of "I'm not sure if that power is actually good" is that <a href="https://www.unison-lang.org/docs/fundamentals/abilities/error-handling/">algebraic effects let you implement <code>try</code>/<code>catch</code> in userspace</a></p>



<a name="435419443"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Algebraic%20Effects/near/435419443" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Algebraic.20Effects.html#435419443">(Apr 25 2024 at 15:51)</a>:</h4>
<p>which in turn means that now you can use algebraic effects for handling errors, or sum types (e.g. <code>Result</code>) and you may end up with a mix of them</p>



<a name="435419621"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Algebraic%20Effects/near/435419621" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Algebraic.20Effects.html#435419621">(Apr 25 2024 at 15:52)</a>:</h4>
<p>at the end of that page, the Unison docs have a stylistic suggestion about how to resolve that:</p>
<blockquote>
<p>As a rule of thumb we suggest you use the [algebraic effects] based approach for error handling</p>
</blockquote>
<p>this seems like a reasonable stylistic guideline, but personally I don't like that it makes errors feel like effects</p>



<a name="435419715"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Algebraic%20Effects/near/435419715" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Algebraic.20Effects.html#435419715">(Apr 25 2024 at 15:53)</a>:</h4>
<p>I personally prefer <code>Result</code> because it's not treated as an effect or exceptional, it's just "this operation can potentially fail, and we represent that using plain old data"</p>



<a name="435419882"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Algebraic%20Effects/near/435419882" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Algebraic.20Effects.html#435419882">(Apr 25 2024 at 15:54)</a>:</h4>
<p>(I also like that <code>Task</code> is an opaque type just like <code>Parser</code> or <code>Random.Generator</code>, with the main difference between those and <code>Result</code> being that it's normal for them to store functions inside them whereas for <code>Result</code> that would be very uncommon)</p>



<a name="435420995"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Algebraic%20Effects/near/435420995" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Algebraic.20Effects.html#435420995">(Apr 25 2024 at 16:00)</a>:</h4>
<p>anyway, to summarize these various thoughts:</p>
<ul>
<li>It's true that they let you do more things, but I think it's important to note that this power has both upsides and downsides, and algebraic effects haven't existed outside research languages for long enough that anyone can confidently know how those manifest in practice across an ecosystem (also worth noting that the upsides compared to <code>Task</code> seem mostly speculative - e.g. "____ is now possible, isn't that cool?" and less "here is a very specific thing that would definitely be an overall improvement")</li>
<li>it would be a big risk for Roc to use them instead of <code>Task</code> because if we wanted to change that decision later, it would be a massive breaking change</li>
<li>stylistically, I think it fits better with the "small number of simple language primitives" to set a high bar for features like this (ones which can't be expressed as sugar for existing features) and I don't think algebraic effects meet that bar</li>
</ul>



<a name="436371379"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Algebraic%20Effects/near/436371379" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eli Dowling <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Algebraic.20Effects.html#436371379">(Apr 30 2024 at 23:46)</a>:</h4>
<p>Thanks for writing out your ideas. I feel like that completes most of the common questions around "what is a task, and how does it relate to similar concepts" :).</p>
<p>A couple notes:<br>
The reason I cited riot from Ocaml is that it implements the Erlang actor model which I'm unsure would be easily model-able with roc (though it would be interesting to try and would obviously be its own platform.) </p>
<p>Ocaml is very likely a much larger effects codebase than unison. They are used pretty widely, and I believe they were in janestreet's internal compiler for a long time.</p>



<hr><p>Last updated: Nov 01 2025 at 12:13 UTC</p>
</html>