<html>
<head><meta charset="utf-8"><title>Example for using as a embedded language. · beginners · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/index.html">beginners</a></h2>
<h3>Topic: <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Example.20for.20using.20as.20a.20embedded.20language.2E.html">Example for using as a embedded language.</a></h3>

<hr>

<base href="https://roc.zulipchat.com">

<head><link href="https://roc-lang.github.io/zulip-export/style.css" rel="stylesheet"></head>

<a name="516017650"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Example%20for%20using%20as%20a%20embedded%20language./near/516017650" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> swoorup joshi <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Example.20for.20using.20as.20a.20embedded.20language.2E.html#516017650">(May 04 2025 at 10:59)</a>:</h4>
<p>I would like to use ROC as an embedded language in both web and desktop targets (wasmtime?) under sandbox environments. The scripting language has to export functions which will then be called by host. Is this possible? What is a good example to follow? (My host language is Rust). Or is this not a good usecase for roc?</p>



<a name="516147534"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Example%20for%20using%20as%20a%20embedded%20language./near/516147534" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Example.20for.20using.20as.20a.20embedded.20language.2E.html#516147534">(May 05 2025 at 09:23)</a>:</h4>
<p>Hi <span class="user-mention" data-user-id="907450">@swoorup joshi</span>,<br>
This is our <a href="https://github.com/roc-lang/roc/tree/main/crates/cli/tests/platform-switching/web-assembly-platform">wasm example</a>. Unfortunately we made a mistake in testing it, so it silently broke, see also <a href="https://github.com/roc-lang/roc/issues/7756">#7756</a>. <span class="user-mention" data-user-id="343810">@Brendan Hansknecht</span> <span class="user-mention" data-user-id="515757">@Luke Boswell</span> do you know what happened to the glue.zig file required by <a href="https://github.com/roc-lang/roc/blob/main/crates/cli/tests/platform-switching/web-assembly-platform/host.zig">web-assembly-platform/host.zig</a>?</p>



<a name="516150534"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Example%20for%20using%20as%20a%20embedded%20language./near/516150534" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Example.20for.20using.20as.20a.20embedded.20language.2E.html#516150534">(May 05 2025 at 09:39)</a>:</h4>
<p>This <a href="https://github.com/lukewilliamboswell/roc-wasm4">roc wasm project</a> may still work though</p>



<a name="516150686"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Example%20for%20using%20as%20a%20embedded%20language./near/516150686" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> swoorup joshi <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Example.20for.20using.20as.20a.20embedded.20language.2E.html#516150686">(May 05 2025 at 09:40)</a>:</h4>
<p>hmm, is there an example for rust? I am not familiar with zig <span aria-label="sweat smile" class="emoji emoji-1f605" role="img" title="sweat smile">:sweat_smile:</span>. I am also wondering if it is somehow possible to embed the compiler into the host language.</p>



<a name="516150968"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Example%20for%20using%20as%20a%20embedded%20language./near/516150968" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> swoorup joshi <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Example.20for.20using.20as.20a.20embedded.20language.2E.html#516150968">(May 05 2025 at 09:41)</a>:</h4>
<p>I saw some old chats about using it with other host like bevy, but it was quite a while back. I am unsure if roc is still suitable for such embedded usecase?</p>



<a name="516158424"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Example%20for%20using%20as%20a%20embedded%20language./near/516158424" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Example.20for.20using.20as.20a.20embedded.20language.2E.html#516158424">(May 05 2025 at 10:22)</a>:</h4>
<blockquote>
<p>hmm, is there an example for rust?<br>
embed the compiler into the host language.</p>
</blockquote>
<p>The <a href="https://github.com/roc-lang/roc/tree/main/crates/repl_wasm">wasm repl</a> may be the example you want, it's available for use <a href="https://www.roc-lang.org/repl">here</a>. <a href="https://github.com/roc-lang/roc/blob/main/crates/repl_wasm/architecture.png">This is a nice image</a> of how it works.</p>
<div class="message_inline_image"><a href="https://github.com/roc-lang/roc/blob/main/crates/repl_wasm/architecture.png" title="This is a nice image"><img src="https://uploads.zulipusercontent.net/4746c554050fab2035828de2de96f81040b72b6a/68747470733a2f2f7261772e67697468756275736572636f6e74656e742e636f6d2f726f632d6c616e672f726f632f6d61696e2f6372617465732f7265706c5f7761736d2f6172636869746563747572652e706e67"></a></div>



<a name="516168923"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Example%20for%20using%20as%20a%20embedded%20language./near/516168923" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> swoorup joshi <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Example.20for.20using.20as.20a.20embedded.20language.2E.html#516168923">(May 05 2025 at 11:25)</a>:</h4>
<p>Interesting, I'll take a look.</p>



<a name="516311904"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Example%20for%20using%20as%20a%20embedded%20language./near/516311904" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Example.20for.20using.20as.20a.20embedded.20language.2E.html#516311904">(May 05 2025 at 22:59)</a>:</h4>
<p>Here's an example of using Roc for the front-end <a href="https://github.com/niclas-ahden/joy">https://github.com/niclas-ahden/joy</a></p>



<a name="516311936"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Example%20for%20using%20as%20a%20embedded%20language./near/516311936" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Example.20for.20using.20as.20a.20embedded.20language.2E.html#516311936">(May 05 2025 at 22:59)</a>:</h4>
<p>I believe <span class="user-mention" data-user-id="524503">@Niclas Ahden</span> is using this currently.</p>



<a name="516312042"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Example%20for%20using%20as%20a%20embedded%20language./near/516312042" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Example.20for.20using.20as.20a.20embedded.20language.2E.html#516312042">(May 05 2025 at 23:00)</a>:</h4>
<p>The story will be much nicer in future with the new zig compiler I think, as there's a few workarounds and challenges to do this using the current rust compiler design.</p>



<a name="516389234"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Example%20for%20using%20as%20a%20embedded%20language./near/516389234" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Example.20for.20using.20as.20a.20embedded.20language.2E.html#516389234">(May 06 2025 at 09:03)</a>:</h4>
<p>Oh interesting, I didn't know joy was using wasm.</p>



<a name="516458668"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Example%20for%20using%20as%20a%20embedded%20language./near/516458668" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> swoorup joshi <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Example.20for.20using.20as.20a.20embedded.20language.2E.html#516458668">(May 06 2025 at 14:23)</a>:</h4>
<p>I hope it will still be easier with Rust. <span aria-label="stuck out tongue wink" class="emoji emoji-1f61c" role="img" title="stuck out tongue wink">:stuck_out_tongue_wink:</span> </p>
<p><span class="user-mention silent" data-user-id="515757">Luke Boswell</span> <a href="#narrow/channel/231634-beginners/topic/Example.20for.20using.20as.20a.20embedded.20language.2E/near/516312042">said</a>:</p>
<blockquote>
<p>The story will be much nicer in future with the new zig compiler I think, as there's a few workarounds and challenges to do this using the current rust compiler design.</p>
</blockquote>



<a name="516468059"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Example%20for%20using%20as%20a%20embedded%20language./near/516468059" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> swoorup joshi <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Example.20for.20using.20as.20a.20embedded.20language.2E.html#516468059">(May 06 2025 at 15:01)</a>:</h4>
<p>Unrelated, does zig compile to C or is able to directly compile to native code or wasm. I see some reference to c code, not sure what they are meant for.</p>



<a name="516469630"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Example%20for%20using%20as%20a%20embedded%20language./near/516469630" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Example.20for.20using.20as.20a.20embedded.20language.2E.html#516469630">(May 06 2025 at 15:08)</a>:</h4>
<p>It can do all 3</p>



<a name="516469703"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Example%20for%20using%20as%20a%20embedded%20language./near/516469703" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Example.20for.20using.20as.20a.20embedded.20language.2E.html#516469703">(May 06 2025 at 15:08)</a>:</h4>
<p>To c, native, and wasm</p>



<a name="516469803"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Example%20for%20using%20as%20a%20embedded%20language./near/516469803" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Example.20for.20using.20as.20a.20embedded.20language.2E.html#516469803">(May 06 2025 at 15:08)</a>:</h4>
<p>To c is pretty rare, but is used as part of the zig compiler bootstrapping, so it is well tested.</p>



<a name="516497619"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Example%20for%20using%20as%20a%20embedded%20language./near/516497619" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> swoorup joshi <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Example.20for.20using.20as.20a.20embedded.20language.2E.html#516497619">(May 06 2025 at 17:25)</a>:</h4>
<p>thanks, still playing around with examples, One thing isn't clear to me. Can roc compiler be itself be embedded as a wasm binary? So that it compiles roc files into other wasm files? So the compiler can be called from either browser directly or via wasmtime.</p>



<a name="516498418"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Example%20for%20using%20as%20a%20embedded%20language./near/516498418" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Example.20for.20using.20as.20a.20embedded.20language.2E.html#516498418">(May 06 2025 at 17:29)</a>:</h4>
<blockquote>
<p>compiler be itself be embedded as a wasm binary? So that it compiles roc files into other wasm files?</p>
</blockquote>
<p>Yes, I believe that is how the wasm repl works.</p>



<a name="516498712"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Example%20for%20using%20as%20a%20embedded%20language./near/516498712" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> swoorup joshi <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Example.20for.20using.20as.20a.20embedded.20language.2E.html#516498712">(May 06 2025 at 17:31)</a>:</h4>
<p>Oh right, that makes sense. Somehow looking at the architecture image I was thinking it was compiled on the server. (Still lot to digest)</p>



<a name="516498728"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Example%20for%20using%20as%20a%20embedded%20language./near/516498728" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Example.20for.20using.20as.20a.20embedded.20language.2E.html#516498728">(May 06 2025 at 17:31)</a>:</h4>
<p>The wasm repl archive may be useful to clarify things:<br>
<a href="/user_uploads/22008/Yc_q1n7vrjn7a4kjLSVSeyPH/roc_repl_wasm.tar.gz">roc_repl_wasm.tar.gz</a></p>



<a name="516498933"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Example%20for%20using%20as%20a%20embedded%20language./near/516498933" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Example.20for.20using.20as.20a.20embedded.20language.2E.html#516498933">(May 06 2025 at 17:32)</a>:</h4>
<blockquote>
<p>thinking it was compiled on the server.</p>
</blockquote>
<p>No, it's all wasm and a bit of js</p>



<a name="516500715"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Example%20for%20using%20as%20a%20embedded%20language./near/516500715" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> swoorup joshi <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Example.20for.20using.20as.20a.20embedded.20language.2E.html#516500715">(May 06 2025 at 17:42)</a>:</h4>
<p>I think I need a index.html file to load those wasm files as well?</p>



<a name="516501730"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Example%20for%20using%20as%20a%20embedded%20language./near/516501730" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Example.20for.20using.20as.20a.20embedded.20language.2E.html#516501730">(May 06 2025 at 17:47)</a>:</h4>
<p>Yes, that archive is not standalone, see:</p>
<p><a href="https://github.com/roc-lang/roc/blob/main/www/public/site.js">https://github.com/roc-lang/roc/blob/main/www/public/site.js</a><br>
view-source:<a href="https://www.roc-lang.org/repl">https://www.roc-lang.org/repl</a><br>
<a href="https://github.com/roc-lang/roc/blob/c320a1bca567b5bcafa8f31f472120b6b5977e0b/www/content/repl/index.md">https://github.com/roc-lang/roc/blob/c320a1bca567b5bcafa8f31f472120b6b5977e0b/www/content/repl/index.md</a></p>
<p>The build procure is described in <a href="https://github.com/roc-lang/roc/blob/c320a1bca567b5bcafa8f31f472120b6b5977e0b/crates/repl_wasm/README.md">https://github.com/roc-lang/roc/blob/c320a1bca567b5bcafa8f31f472120b6b5977e0b/crates/repl_wasm/README.md</a> and <a href="https://github.com/roc-lang/roc/blob/c320a1bca567b5bcafa8f31f472120b6b5977e0b/www/README.md">https://github.com/roc-lang/roc/blob/c320a1bca567b5bcafa8f31f472120b6b5977e0b/www/README.md</a> (builds the full roc website).</p>



<a name="516506130"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Example%20for%20using%20as%20a%20embedded%20language./near/516506130" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> swoorup joshi <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Example.20for.20using.20as.20a.20embedded.20language.2E.html#516506130">(May 06 2025 at 18:09)</a>:</h4>
<p>Thank you, does roc has any guidelines for interoping with rust types like algebraic data types? enums?<br>
<a href="https://flinect.com/blog/rust-wasm-with-typescript-serde">https://flinect.com/blog/rust-wasm-with-typescript-serde</a></p>



<a name="516507290"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Example%20for%20using%20as%20a%20embedded%20language./near/516507290" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Example.20for.20using.20as.20a.20embedded.20language.2E.html#516507290">(May 06 2025 at 18:16)</a>:</h4>
<p>We commonly refer to that interop code as glue.<br>
We have a <a href="https://github.com/niclas-ahden/joy/blob/main/glue.sh">command to generate it</a> but that generated code requires some manual fixing up. <a href="https://github.com/search?q=repo%3Aniclas-ahden%2Fjoy%20glue&amp;type=code">joy</a> code probably provides the best guidance for you.</p>



<a name="516546150"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Example%20for%20using%20as%20a%20embedded%20language./near/516546150" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Example.20for.20using.20as.20a.20embedded.20language.2E.html#516546150">(May 06 2025 at 22:58)</a>:</h4>
<p><span class="user-mention silent" data-user-id="907450">swoorup joshi</span> <a href="#narrow/channel/231634-beginners/topic/Example.20for.20using.20as.20a.20embedded.20language.2E/near/516458668">said</a>:</p>
<blockquote>
<p>I hope it will still be easier with Rust. <span aria-label="stuck out tongue wink" class="emoji emoji-1f61c" role="img" title="stuck out tongue wink">:stuck_out_tongue_wink:</span> </p>
<p><span class="user-mention silent" data-user-id="515757">Luke Boswell</span> <a href="#narrow/channel/231634-beginners/topic/Example.20for.20using.20as.20a.20embedded.20language.2E/near/516312042">said</a>:</p>
<blockquote>
<p>The story will be much nicer in future with the new zig compiler I think, as there's a few workarounds and challenges to do this using the current rust compiler design.<br>
</p>
</blockquote>
</blockquote>
<p>I don't mean building the platform in Rust (as compared to Zig) .. but the new compiler that is being re-written in Zig (as opposed to the current one that is written in Rust).</p>
<p>:D</p>



<a name="516714957"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Example%20for%20using%20as%20a%20embedded%20language./near/516714957" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> swoorup joshi <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Example.20for.20using.20as.20a.20embedded.20language.2E.html#516714957">(May 07 2025 at 15:59)</a>:</h4>
<p>Tried building repl_wasm from main branch. Got errors building :/</p>
<div class="codehilite"><pre><span></span><code>error: failed to run custom build command for `roc_bitcode v0.0.1 (/Users/swoorup.joshi/github/roc-programming/roc/crates/compiler/builtins/bitcode)`

Caused by:
  process didn&#39;t exit successfully: `/Users/swoorup.joshi/github/roc-programming/roc/target/release/build/roc_bitcode-1b9319928098b482/build-script-build` (exit status: 1)
  --- stdout
  cargo:rerun-if-changed=build.rs
  Compiling zig object `object` to: /Users/swoorup.joshi/github/roc-programming/roc/crates/compiler/builtins/bitcode/zig-out/builtins-host.o

  --- stderr
  An internal compiler expectation was broken.
  This is definitely a compiler bug.
  Please file an issue here: &lt;https://github.com/roc-lang/roc/issues/new/choose&gt;
  zig build object -Drelease=true failed 10 times in a row. The following error is unlikely to be a flaky error: object
  +- install generated to builtins-host.o
     +- zig build-obj builtins-host ReleaseFast native-macos 5 errors
  src/main.zig:385:13: error: expected pointer type, found &#39;fn (dec.RocDec) callconv(.c) i128&#39;
      @export(func, .{ .name = &quot;roc_builtins.&quot; ++ func_name, .linkage = .strong });
              ^~~~
  src/main.zig:400:20: note: called from here
      exportBuiltinFn(func, &quot;dec.&quot; ++ func_name);
</code></pre></div>



<a name="516717218"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Example%20for%20using%20as%20a%20embedded%20language./near/516717218" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Example.20for.20using.20as.20a.20embedded.20language.2E.html#516717218">(May 07 2025 at 16:08)</a>:</h4>
<p>Did you use <code>nix develop</code> to set up the dependencies?</p>



<a name="516717432"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Example%20for%20using%20as%20a%20embedded%20language./near/516717432" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> swoorup joshi <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Example.20for.20using.20as.20a.20embedded.20language.2E.html#516717432">(May 07 2025 at 16:09)</a>:</h4>
<p>Now trying to use nix develop, previously was using directly from system install zig and rust.</p>



<a name="516717715"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Example%20for%20using%20as%20a%20embedded%20language./near/516717715" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Example.20for.20using.20as.20a.20embedded.20language.2E.html#516717715">(May 07 2025 at 16:11)</a>:</h4>
<p>Yeah, your error seems to come from a wrong zig version. It's best to use nix develop because you need more than just zig and rust.</p>



<a name="516718137"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Example%20for%20using%20as%20a%20embedded%20language./near/516718137" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> swoorup joshi <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Example.20for.20using.20as.20a.20embedded.20language.2E.html#516718137">(May 07 2025 at 16:13)</a>:</h4>
<p>Looks like its compiling. </p>
<p>Although Kinda prefer devenv to nix develop, because that's all I used before, and doesn't drop me to bash from my fish shell. <span aria-label="sweat smile" class="emoji emoji-1f605" role="img" title="sweat smile">:sweat_smile:</span></p>



<a name="516718589"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Example%20for%20using%20as%20a%20embedded%20language./near/516718589" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> swoorup joshi <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Example.20for.20using.20as.20a.20embedded.20language.2E.html#516718589">(May 07 2025 at 16:15)</a>:</h4>
<p>nvm, looks like I just use fish from the bash shell</p>



<a name="516719960"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Example%20for%20using%20as%20a%20embedded%20language./near/516719960" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Example.20for.20using.20as.20a.20embedded.20language.2E.html#516719960">(May 07 2025 at 16:22)</a>:</h4>
<p>This is actually the first time I heard about devenv, it looks interesting <span aria-label="eyes" class="emoji emoji-1f440" role="img" title="eyes">:eyes:</span></p>



<a name="516720654"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Example%20for%20using%20as%20a%20embedded%20language./near/516720654" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> swoorup joshi <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Example.20for.20using.20as.20a.20embedded.20language.2E.html#516720654">(May 07 2025 at 16:26)</a>:</h4>
<p>its built atop of nix, and think covers most of the develop use-cases with extra few bells and whistles.</p>



<a name="516736317"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Example%20for%20using%20as%20a%20embedded%20language./near/516736317" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> swoorup joshi <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Example.20for.20using.20as.20a.20embedded.20language.2E.html#516736317">(May 07 2025 at 17:52)</a>:</h4>
<p>Does roc support WIT <a href="https://component-model.bytecodealliance.org/design/wit.html#enums">https://component-model.bytecodealliance.org/design/wit.html#enums</a>  by any chance?</p>



<a name="516736985"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Example%20for%20using%20as%20a%20embedded%20language./near/516736985" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Example.20for.20using.20as.20a.20embedded.20language.2E.html#516736985">(May 07 2025 at 17:57)</a>:</h4>
<p>I've never heard of WIT before, If anyone knows, it's <span class="user-mention" data-user-id="431893">@Brian Carroll</span></p>



<a name="516737261"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Example%20for%20using%20as%20a%20embedded%20language./near/516737261" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> swoorup joshi <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Example.20for.20using.20as.20a.20embedded.20language.2E.html#516737261">(May 07 2025 at 17:58)</a>:</h4>
<p>I was following along with how zed created their extension model in this blog <a href="https://zed.dev/blog/zed-decoded-extensions">https://zed.dev/blog/zed-decoded-extensions</a> and came across it. Having a common IDL would make life so much easier.</p>



<a name="516767367"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Example%20for%20using%20as%20a%20embedded%20language./near/516767367" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Carroll <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Example.20for.20using.20as.20a.20embedded.20language.2E.html#516767367">(May 07 2025 at 21:16)</a>:</h4>
<p>Hey Anton! We never did anything for WIT and I'm not super familiar with it. Looking at the link, I think you could write a "Roc glue" plugin for it if you wanted to. That would make the most sense.</p>



<a name="516781899"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Example%20for%20using%20as%20a%20embedded%20language./near/516781899" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Hannes <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Example.20for.20using.20as.20a.20embedded.20language.2E.html#516781899">(May 07 2025 at 23:26)</a>:</h4>
<p>By the way <span class="user-mention" data-user-id="907450">@swoorup joshi</span>, if you want to use your existing shell with a nix flake you can use <a href="https://direnv.net/">direnv</a> and optionally add <a href="https://github.com/nix-community/nix-direnv">nix-direnv</a>. Then, in the repo, run <code>direnv allow</code> and it'll add the devshell packages to your current shell.</p>



<a name="516936980"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Example%20for%20using%20as%20a%20embedded%20language./near/516936980" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> swoorup joshi <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Example.20for.20using.20as.20a.20embedded.20language.2E.html#516936980">(May 08 2025 at 16:30)</a>:</h4>
<p>hello again, I am starting to get a feel and play with roc code, and trying to basically get the repl_wasm running using wasmtime instead of js</p>
<p>But I am currently running into a crash, which I am not sure how to address.</p>



<a name="516937126"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Example%20for%20using%20as%20a%20embedded%20language./near/516937126" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> swoorup joshi <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Example.20for.20using.20as.20a.20embedded.20language.2E.html#516937126">(May 08 2025 at 16:31)</a>:</h4>
<p>I replace all js runner/functions with WastimeApp like so: <a href="https://github.com/Swoorup/roc-wasm-playground/blob/main/src/wasm_runner.rs">https://github.com/Swoorup/roc-wasm-playground/blob/main/src/wasm_runner.rs</a></p>
<p>Running it gives</p>
<div class="codehilite" data-code-language="Bash"><pre><span></span><code>Enter<span class="w"> </span>an<span class="w"> </span>expression<span class="w"> </span>to<span class="w"> </span>evaluate,<span class="w"> </span>or<span class="w"> </span>a<span class="w"> </span>definition<span class="w"> </span><span class="o">(</span>like<span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="o">)</span><span class="w"> </span>to<span class="w"> </span>use<span class="w"> </span>later.

<span class="w">  </span>-<span class="w"> </span>ctrl-v<span class="w"> </span>+<span class="w"> </span>ctrl-j<span class="w"> </span>makes<span class="w"> </span>a<span class="w"> </span>newline
<span class="w">  </span>-<span class="w"> </span>:q<span class="w"> </span>quits
<span class="w">  </span>-<span class="w"> </span>:help<span class="w"> </span>shows<span class="w"> </span>this<span class="w"> </span>text<span class="w"> </span>again
&gt;
thread<span class="w"> </span><span class="s1">'main'</span><span class="w"> </span>panicked<span class="w"> </span>at<span class="w"> </span>library/core/src/panicking.rs:226:5:
unsafe<span class="w"> </span>precondition<span class="o">(</span>s<span class="o">)</span><span class="w"> </span>violated:<span class="w"> </span>slice::from_raw_parts<span class="w"> </span>requires<span class="w"> </span>the<span class="w"> </span>pointer<span class="w"> </span>to<span class="w"> </span>be<span class="w"> </span>aligned<span class="w"> </span>and<span class="w"> </span>non-null,<span class="w"> </span>and<span class="w"> </span>the<span class="w"> </span>total<span class="w"> </span>size<span class="w"> </span>of<span class="w"> </span>the<span class="w"> </span>slice<span class="w"> </span>not<span class="w"> </span>to<span class="w"> </span>exceed<span class="w"> </span><span class="sb">`</span>isize::MAX<span class="sb">`</span>

This<span class="w"> </span>indicates<span class="w"> </span>a<span class="w"> </span>bug<span class="w"> </span><span class="k">in</span><span class="w"> </span>the<span class="w"> </span>program.<span class="w"> </span>This<span class="w"> </span>Undefined<span class="w"> </span>Behavior<span class="w"> </span>check<span class="w"> </span>is<span class="w"> </span>optional,<span class="w"> </span>and<span class="w"> </span>cannot<span class="w"> </span>be<span class="w"> </span>relied<span class="w"> </span>on<span class="w"> </span><span class="k">for</span><span class="w"> </span>safety.
stack<span class="w"> </span>backtrace:
<span class="w">   </span><span class="m">0</span>:<span class="w"> </span>__rustc::rust_begin_unwind
<span class="w">             </span>at<span class="w"> </span>/rustc/27d6200a70601f6fcf419bf2f9e37989f3624ca4/library/std/src/panicking.rs:697:5
<span class="w">   </span><span class="m">1</span>:<span class="w"> </span>core::panicking::panic_nounwind_fmt::runtime
<span class="w">             </span>at<span class="w"> </span>/rustc/27d6200a70601f6fcf419bf2f9e37989f3624ca4/library/core/src/panicking.rs:117:22
<span class="w">   </span><span class="m">2</span>:<span class="w"> </span>core::panicking::panic_nounwind_fmt
<span class="w">             </span>at<span class="w"> </span>/rustc/27d6200a70601f6fcf419bf2f9e37989f3624ca4/library/core/src/intrinsics/mod.rs:3196:9
<span class="w">   </span><span class="m">3</span>:<span class="w"> </span>core::panicking::panic_nounwind
<span class="w">             </span>at<span class="w"> </span>/rustc/27d6200a70601f6fcf419bf2f9e37989f3624ca4/library/core/src/panicking.rs:226:5
<span class="w">   </span><span class="m">4</span>:<span class="w"> </span>core::slice::raw::from_raw_parts::precondition_check
<span class="w">             </span>at<span class="w"> </span>/Users/swoorup.joshi/.rustup/toolchains/nightly-aarch64-apple-darwin/lib/rustlib/src/rust/library/core/src/ub_checks.rs:68:21
<span class="w">   </span><span class="m">5</span>:<span class="w"> </span>core::slice::raw::from_raw_parts
<span class="w">             </span>at<span class="w"> </span>/Users/swoorup.joshi/.rustup/toolchains/nightly-aarch64-apple-darwin/lib/rustlib/src/rust/library/core/src/ub_checks.rs:75:17
<span class="w">   </span><span class="m">6</span>:<span class="w"> </span>roc_serialize::bytes::deserialize_slice
<span class="w">             </span>at<span class="w"> </span>/Users/swoorup.joshi/.cargo/git/checkouts/roc-5d067ed4e211e472/b552466/crates/compiler/serialize/src/bytes.rs:35:26
<span class="w">   </span><span class="m">7</span>:<span class="w"> </span>roc_can::abilities::serialize::deserialize_solved_implementations
<span class="w">             </span>at<span class="w"> </span>/Users/swoorup.joshi/.cargo/git/checkouts/roc-5d067ed4e211e472/b552466/crates/compiler/can/src/abilities.rs:1197:35
<span class="w">   </span><span class="m">8</span>:<span class="w"> </span>roc_can::module::TypeState::deserialize
<span class="w">             </span>at<span class="w"> </span>/Users/swoorup.joshi/.cargo/git/checkouts/roc-5d067ed4e211e472/b552466/crates/compiler/can/src/module.rs:1212:13
<span class="w">   </span><span class="m">9</span>:<span class="w"> </span>roc_load::deserialize_help
<span class="w">             </span>at<span class="w"> </span>/Users/swoorup.joshi/.cargo/git/checkouts/roc-5d067ed4e211e472/b552466/crates/compiler/load/src/lib.rs:240:28
<span class="w">  </span><span class="m">10</span>:<span class="w"> </span>roc_load::read_cached_types
<span class="w">             </span>at<span class="w"> </span>/Users/swoorup.joshi/.cargo/git/checkouts/roc-5d067ed4e211e472/b552466/crates/compiler/load/src/lib.rs:265:39
<span class="w">  </span><span class="m">11</span>:<span class="w"> </span>roc_load::load
<span class="w">             </span>at<span class="w"> </span>/Users/swoorup.joshi/.cargo/git/checkouts/roc-5d067ed4e211e472/b552466/crates/compiler/load/src/lib.rs:37:24
<span class="w">  </span><span class="m">12</span>:<span class="w"> </span>roc_load::load_and_monomorphize_from_str
<span class="w">             </span>at<span class="w"> </span>/Users/swoorup.joshi/.cargo/git/checkouts/roc-5d067ed4e211e472/b552466/crates/compiler/load/src/lib.rs:117:11
<span class="w">  </span><span class="m">13</span>:<span class="w"> </span>roc_repl_eval::gen::compile_to_mono
<span class="w">             </span>at<span class="w"> </span>/Users/swoorup.joshi/.cargo/git/checkouts/roc-5d067ed4e211e472/b552466/crates/repl_eval/src/gen.rs:64:18
<span class="w">  </span><span class="m">14</span>:<span class="w"> </span>roc_repl_ui::repl_state::ReplState::step
<span class="w">             </span>at<span class="w"> </span>/Users/swoorup.joshi/.cargo/git/checkouts/roc-5d067ed4e211e472/b552466/crates/repl_ui/src/repl_state.rs:260:36
<span class="w">  </span><span class="m">15</span>:<span class="w"> </span>test_roc_playground::repl::entrypoint_from_wasmtime::<span class="o">{{</span>closure<span class="o">}}</span>::<span class="o">{{</span>closure<span class="o">}}</span>
<span class="w">             </span>at<span class="w"> </span>./src/repl.rs:201:9
<span class="w">  </span><span class="m">16</span>:<span class="w"> </span>std::thread::local::LocalKey&lt;T&gt;::try_with
<span class="w">             </span>at<span class="w"> </span>/Users/swoorup.joshi/.rustup/toolchains/nightly-aarch64-apple-darwin/lib/rustlib/src/rust/library/std/src/thread/local.rs:315:12
<span class="w">  </span><span class="m">17</span>:<span class="w"> </span>std::thread::local::LocalKey&lt;T&gt;::with
<span class="w">             </span>at<span class="w"> </span>/Users/swoorup.joshi/.rustup/toolchains/nightly-aarch64-apple-darwin/lib/rustlib/src/rust/library/std/src/thread/local.rs:279:15
<span class="w">  </span><span class="m">18</span>:<span class="w"> </span>test_roc_playground::repl::entrypoint_from_wasmtime::<span class="o">{{</span>closure<span class="o">}}</span>
<span class="w">             </span>at<span class="w"> </span>./src/repl.rs:199:18
<span class="w">  </span><span class="m">19</span>:<span class="w"> </span>test_roc_playground::stdin_runner::stdin_to_entrypoint::<span class="o">{{</span>closure<span class="o">}}</span>
<span class="w">             </span>at<span class="w"> </span>./src/stdin_runner.rs:60:62
<span class="w">  </span><span class="m">20</span>:<span class="w"> </span>test_roc_playground::main::<span class="o">{{</span>closure<span class="o">}}</span>
<span class="w">             </span>at<span class="w"> </span>./src/main.rs:44:65
<span class="w">  </span><span class="m">21</span>:<span class="w"> </span>&lt;core::pin::Pin&lt;P&gt;<span class="w"> </span>as<span class="w"> </span>core::future::future::Future&gt;::poll
<span class="w">             </span>at<span class="w"> </span>/Users/swoorup.joshi/.rustup/toolchains/nightly-aarch64-apple-darwin/lib/rustlib/src/rust/library/core/src/future/future.rs:124:9
<span class="w">  </span><span class="m">22</span>:<span class="w"> </span>tokio::runtime::park::CachedParkThread::block_on::<span class="o">{{</span>closure<span class="o">}}</span>
<span class="w">             </span>at<span class="w"> </span>/Users/swoorup.joshi/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/tokio-1.45.0/src/runtime/park.rs:284:60
<span class="w">  </span><span class="m">23</span>:<span class="w"> </span>tokio::task::coop::with_budget
<span class="w">             </span>at<span class="w"> </span>/Users/swoorup.joshi/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/tokio-1.45.0/src/task/coop/mod.rs:167:5
<span class="w">  </span><span class="m">24</span>:<span class="w"> </span>tokio::task::coop::budget
<span class="w">             </span>at<span class="w"> </span>/Users/swoorup.joshi/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/tokio-1.45.0/src/task/coop/mod.rs:133:5
<span class="w">  </span><span class="m">25</span>:<span class="w"> </span>tokio::runtime::park::CachedParkThread::block_on
<span class="w">             </span>at<span class="w"> </span>/Users/swoorup.joshi/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/tokio-1.45.0/src/runtime/park.rs:284:31
<span class="w">  </span><span class="m">26</span>:<span class="w"> </span>tokio::runtime::context::blocking::BlockingRegionGuard::block_on
<span class="w">             </span>at<span class="w"> </span>/Users/swoorup.joshi/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/tokio-1.45.0/src/runtime/context/blocking.rs:66:9
<span class="w">  </span><span class="m">27</span>:<span class="w"> </span>tokio::runtime::scheduler::multi_thread::MultiThread::block_on::<span class="o">{{</span>closure<span class="o">}}</span>
<span class="w">             </span>at<span class="w"> </span>/Users/swoorup.joshi/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/tokio-1.45.0/src/runtime/scheduler/multi_thread/mod.rs:87:13
<span class="w">  </span><span class="m">28</span>:<span class="w"> </span>tokio::runtime::context::runtime::enter_runtime
<span class="w">             </span>at<span class="w"> </span>/Users/swoorup.joshi/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/tokio-1.45.0/src/runtime/context/runtime.rs:65:16
<span class="w">  </span><span class="m">29</span>:<span class="w"> </span>tokio::runtime::scheduler::multi_thread::MultiThread::block_on
<span class="w">             </span>at<span class="w"> </span>/Users/swoorup.joshi/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/tokio-1.45.0/src/runtime/scheduler/multi_thread/mod.rs:86:9
<span class="w">  </span><span class="m">30</span>:<span class="w"> </span>tokio::runtime::runtime::Runtime::block_on_inner
<span class="w">             </span>at<span class="w"> </span>/Users/swoorup.joshi/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/tokio-1.45.0/src/runtime/runtime.rs:358:45
<span class="w">  </span><span class="m">31</span>:<span class="w"> </span>tokio::runtime::runtime::Runtime::block_on
<span class="w">             </span>at<span class="w"> </span>/Users/swoorup.joshi/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/tokio-1.45.0/src/runtime/runtime.rs:328:13
<span class="w">  </span><span class="m">32</span>:<span class="w"> </span>test_roc_playground::main
<span class="w">             </span>at<span class="w"> </span>./src/main.rs:40:5
<span class="w">  </span><span class="m">33</span>:<span class="w"> </span>core::ops::function::FnOnce::call_once
<span class="w">             </span>at<span class="w"> </span>/Users/swoorup.joshi/.rustup/toolchains/nightly-aarch64-apple-darwin/lib/rustlib/src/rust/library/core/src/ops/function.rs:250:5
note:<span class="w"> </span>Some<span class="w"> </span>details<span class="w"> </span>are<span class="w"> </span>omitted,<span class="w"> </span>run<span class="w"> </span>with<span class="w"> </span><span class="sb">`</span><span class="nv">RUST_BACKTRACE</span><span class="o">=</span>full<span class="sb">`</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>a<span class="w"> </span>verbose<span class="w"> </span>backtrace.
thread<span class="w"> </span>caused<span class="w"> </span>non-unwinding<span class="w"> </span>panic.<span class="w"> </span>aborting.
fish:<span class="w"> </span>Job<span class="w"> </span><span class="m">1</span>,<span class="w"> </span><span class="s1">'echo 1 + 1 | RUST_BACKTRACE=1 c…'</span><span class="w"> </span>terminated<span class="w"> </span>by<span class="w"> </span>signal<span class="w"> </span>SIGABRT<span class="w"> </span><span class="o">(</span>Abort<span class="o">)</span>
</code></pre></div>



<a name="516937164"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Example%20for%20using%20as%20a%20embedded%20language./near/516937164" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> swoorup joshi <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Example.20for.20using.20as.20a.20embedded.20language.2E.html#516937164">(May 08 2025 at 16:31)</a>:</h4>
<p>Any ideas?</p>



<a name="516937982"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Example%20for%20using%20as%20a%20embedded%20language./near/516937982" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Example.20for.20using.20as.20a.20embedded.20language.2E.html#516937982">(May 08 2025 at 16:36)</a>:</h4>
<p>My only guess is that wasm has a different alignment to CPUs. As such, this fails. I would try just running without the undefined behaviour check (might just need to run in release build).</p>



<a name="516938036"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Example%20for%20using%20as%20a%20embedded%20language./near/516938036" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Example.20for.20using.20as.20a.20embedded.20language.2E.html#516938036">(May 08 2025 at 16:36)</a>:</h4>
<p>But otherwise debugging probably means checking pointers and alignment.</p>



<a name="516938089"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Example%20for%20using%20as%20a%20embedded%20language./near/516938089" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Example.20for.20using.20as.20a.20embedded.20language.2E.html#516938089">(May 08 2025 at 16:36)</a>:</h4>
<p>I wonder if wasmtime aligns differently from browsers</p>



<a name="516938394"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Example%20for%20using%20as%20a%20embedded%20language./near/516938394" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> swoorup joshi <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Example.20for.20using.20as.20a.20embedded.20language.2E.html#516938394">(May 08 2025 at 16:38)</a>:</h4>
<p>Goodpoint, will try running in release. Trying to grok much information as I can, since i am new to using wasm in general xD</p>



<a name="516939266"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Example%20for%20using%20as%20a%20embedded%20language./near/516939266" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> swoorup joshi <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Example.20for.20using.20as.20a.20embedded.20language.2E.html#516939266">(May 08 2025 at 16:43)</a>:</h4>
<p>Damn that worked lol. Feels cool.</p>
<div class="codehilite" data-code-language="Bash"><pre><span></span><code>test-roc-playground<span class="w"> </span>on<span class="w"> </span><span class="w"> </span>main<span class="w"> </span><span class="o">[</span>!<span class="o">]</span><span class="w"> </span>is<span class="w"> </span>📦<span class="w"> </span>v0.1.0<span class="w"> </span>via<span class="w"> </span>🦀<span class="w"> </span>v1.88.0-nightly<span class="w"> </span>via<span class="w"> </span>❄️<span class="w">  </span>impure<span class="w"> </span><span class="o">(</span>devenv-shell-env<span class="o">)</span><span class="w"> </span>took<span class="w"> </span>4s
❯<span class="w"> </span>./target/release/test-roc-playground<span class="w"> </span>--stdin
&gt;

Enter<span class="w"> </span>an<span class="w"> </span>expression<span class="w"> </span>to<span class="w"> </span>evaluate,<span class="w"> </span>or<span class="w"> </span>a<span class="w"> </span>definition<span class="w"> </span><span class="o">(</span>like<span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="o">)</span><span class="w"> </span>to<span class="w"> </span>use<span class="w"> </span>later.

<span class="w">  </span>-<span class="w"> </span>ctrl-v<span class="w"> </span>+<span class="w"> </span>ctrl-j<span class="w"> </span>makes<span class="w"> </span>a<span class="w"> </span>newline
<span class="w">  </span>-<span class="w"> </span>:q<span class="w"> </span>quits
<span class="w">  </span>-<span class="w"> </span>:help<span class="w"> </span>shows<span class="w"> </span>this<span class="w"> </span>text<span class="w"> </span>again

&gt;<span class="w"> </span><span class="m">1</span><span class="w"> </span>+<span class="w"> </span><span class="m">1</span>

<span class="m">2</span>&lt;span<span class="w"> </span><span class="nv">class</span><span class="o">=</span><span class="s1">'color-green'</span>&gt;<span class="w"> </span>:<span class="w"> </span>&lt;/span&gt;Num<span class="w"> </span>*
&gt;
</code></pre></div>



<hr><p>Last updated: Mar 01 2026 at 12:20 UTC</p>
</html>