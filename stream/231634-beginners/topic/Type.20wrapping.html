<html>
<head><meta charset="utf-8"><title>Type wrapping · beginners · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/index.html">beginners</a></h2>
<h3>Topic: <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Type.20wrapping.html">Type wrapping</a></h3>

<hr>

<base href="https://roc.zulipchat.com">

<head><link href="https://roc-lang.github.io/zulip-export/style.css" rel="stylesheet"></head>

<a name="568707118"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Type%20wrapping/near/568707118" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rick Hull <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Type.20wrapping.html#568707118">(Jan 19 2026 at 01:10)</a>:</h4>
<p>I am not sure what to call this, other than type wrapping.  I am new to Roc and no more than intermediate level experience with strong (functional) types.  My goal, which is possibly misguided, is to take a List(U8) and specialize it with a known length and intended usage.  e.g. 32-byte sk, 32-byte pk, 64-byte sig</p>
<p>Under roc-alpha-4, I used opaque types with some success for this.  But my focus is now roc-nightly.  With the resources I've gathered for how roc-nightly works, I did a lot of exploratory testing with LLMs to determine how to solve this problem.  Here are my findings: </p>
<p><a href="https://gist.github.com/rickhull/733e6020e1995c0997016559e291b0cc">https://gist.github.com/rickhull/733e6020e1995c0997016559e291b0cc</a></p>
<blockquote>
<h2>Single-variant tag unions - open type</h2>
<p>PublicKey := [PublicKeyBytes(List(U8)), ..]<br>
SecretKey := [SecretKeyBytes(List(U8)), ..]</p>
<h2>Simple constructors - just wrap the bytes, no validation yet</h2>
<p>make_public_key = |bytes| PublicKeyBytes(bytes)<br>
make_secret_key = |bytes| SecretKeyBytes(bytes)</p>
</blockquote>
<blockquote>
<p>Single-variant tag unions are the <strong>idiomatic and working solution</strong> for type-safe wrappers in Roc. The pattern:</p>
<ol>
<li><strong>Use open tag unions</strong> with <code>..</code> for compatibility with Try.Ok</li>
<li><strong>Use pattern matching</strong> for extraction (verbose but type-safe)</li>
<li><strong>Get compile-time type safety</strong> - PublicKey ≠ SecretKey</li>
</ol>
<p>This is how core types like <code>Bool</code> and <code>Try</code> work in Builtin.roc.</p>
</blockquote>
<p>As to whether these findings are accurate, this is an open question for me.  I am not here to burden the channel with fixing my LLM dalliances, but I would like some validation, positive or negative, if I am barking up the right tree.  Thanks!</p>



<a name="568777019"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Type%20wrapping/near/568777019" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Type.20wrapping.html#568777019">(Jan 19 2026 at 11:16)</a>:</h4>
<p>Do you want to be able to hide the internal bytes so that e.g. only some functions of a specific module can access the raw bytes?</p>



<a name="568780401"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Type%20wrapping/near/568780401" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rick Hull <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Type.20wrapping.html#568780401">(Jan 19 2026 at 11:36)</a>:</h4>
<p>it's a chunk of data, but I want to associate a type with this chunk of data.  the type says: it is Red, not Blue.  it has this size.  So now I have Red32, Red64, Blue32, Blue64.  and the compiler can enforce that make_orange only takes Red32 and not any chunk of data.</p>
<p>e.g. At runtime, the user provides some user input.  This could be the chunk of data.  The roc program takes the user input and constructs a Red32 according to some validation rules.  This can fail, and the user might be reprompted.</p>
<p>Is there something flawed or wrongheaded about this idea?</p>



<a name="568786319"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Type%20wrapping/near/568786319" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rick Hull <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Type.20wrapping.html#568786319">(Jan 19 2026 at 12:11)</a>:</h4>
<p>from what I understand, a nominal tag union with a method <code>bytes</code> that returns List(U8) would be nice.  I struggled to make this work.</p>



<a name="568792079"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Type%20wrapping/near/568792079" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rick Hull <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Type.20wrapping.html#568792079">(Jan 19 2026 at 12:43)</a>:</h4>
<p>it's actually working great now.  Currently I have a Signature, with methods <code>create</code> and <code>bytes</code>.  there is only a single internal representation, List(U8), so I don't want to use from/to in the method names.  I was thinking of <code>create</code> / <code>resolve</code> as a more generic interface.  thoughts on method names?</p>



<a name="568800544"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Type%20wrapping/near/568800544" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Type.20wrapping.html#568800544">(Jan 19 2026 at 13:25)</a>:</h4>
<blockquote>
<p>Is there something flawed or wrongheaded about this idea?</p>
</blockquote>
<p>Nope, you're good, it's a relatively common pattern. See also <a href="https://lexi-lambda.github.io/blog/2019/11/05/parse-don-t-validate/">https://lexi-lambda.github.io/blog/2019/11/05/parse-don-t-validate/</a></p>



<a name="568801325"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Type%20wrapping/near/568801325" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Type.20wrapping.html#568801325">(Jan 19 2026 at 13:29)</a>:</h4>
<blockquote>
<p>thoughts on method names?</p>
</blockquote>
<p>I do not think that we have really built conventions around this</p>



<a name="568806414"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Type%20wrapping/near/568806414" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rick Hull <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Type.20wrapping.html#568806414">(Jan 19 2026 at 13:52)</a>:</h4>
<p>i don't want to use <code>unwrap</code> as that feels overloaded.  Signature "resolves" to a List(U8)[64] (my notation).  but i think <code>create</code> and <code>bytes</code> reads naturally and intuitively</p>



<a name="568807821"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Type%20wrapping/near/568807821" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rick Hull <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Type.20wrapping.html#568807821">(Jan 19 2026 at 13:58)</a>:</h4>
<p>I completely agree with "shotgun parsing" as an antipattern.  have a defined "filter layer" at the front of the data pipeline that only lets "well formed objects" through.</p>



<a name="568814193"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Type%20wrapping/near/568814193" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dan G Knutson <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Type.20wrapping.html#568814193">(Jan 19 2026 at 14:26)</a>:</h4>
<p>I've seen people use 'pack' and 'unpack' as the pair of names for this kind of thing</p>



<a name="568820220"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Type%20wrapping/near/568820220" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rick Hull <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Type.20wrapping.html#568820220">(Jan 19 2026 at 14:51)</a>:</h4>
<p>ooh, that's a good one, kind of like wrap/unwrap but without overloading those terms.  in ruby and perl (C?), pack and unpack are quite sophisticated in terms of constructing binary data, whereas I am just doing simple validation.  interesting</p>



<a name="569336058"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Type%20wrapping/near/569336058" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rachael Sexton <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Type.20wrapping.html#569336058">(Jan 21 2026 at 19:17)</a>:</h4>
<p>not sure if this is the right place... I'm working through Exercism and working on the Collatz one, and suddenly realized... I'm not sure how to fmap easily in Roc? </p>
<p>I'm doing this recursively, so in a <code>when...is...</code> block, i'm pattern matching on whether it's odd/even, and adding 1 to the recursive <code>steps</code> function call. In Haskell I might `even n = succ &lt;$&gt; steps (3*n+1)</p>
<p>But how can I add 1 to Ok(1) easily without changing the signature of <code>steps</code> to be <code>Result U64 -&gt; Result U64</code> to enable pattern matching, when I don't have <code>fmap</code>?</p>



<a name="569336233"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Type%20wrapping/near/569336233" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rachael Sexton <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Type.20wrapping.html#569336233">(Jan 21 2026 at 19:18)</a>:</h4>
<p>(This is wrong, I know, but it should get the idea of what I'm trying to do) </p>
<div class="codehilite" data-code-language="roc"><pre><span></span><code>steps : U64 -&gt; Result U64 _
steps = |x|
    when x is
        0 -&gt; Err
        1 -&gt; Ok(0)
        _ if Num.is_even(x) -&gt; steps(x/2) + 1
        _ -&gt; steps(3*x + 1) + 1
</code></pre></div>



<a name="569378806"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Type%20wrapping/near/569378806" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rick Hull <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Type.20wrapping.html#569378806">(Jan 21 2026 at 23:37)</a>:</h4>
<p>Hi Rachael, I wish I could help more.  I can't tell at a glance, but are you on the new compiler or old compiler?</p>



<a name="569396735"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Type%20wrapping/near/569396735" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Claude Précourt <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Type.20wrapping.html#569396735">(Jan 22 2026 at 02:35)</a>:</h4>
<p>The Exercism track is still using the old compiler, isn’t it?</p>



<a name="569399489"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Type%20wrapping/near/569399489" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rachael Sexton <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Type.20wrapping.html#569399489">(Jan 22 2026 at 03:07)</a>:</h4>
<p>Not sure, this is the roc-cli version it's unit tests are depending on <br>
<code>pf: platform "https://github.com/roc-lang/basic-cli/releases/download/0.20.0/X73hGh05nNTkDHU06FHC0YfFaQB1pimX7gncRcao5mU.tar.br",</code></p>



<a name="569400960"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Type%20wrapping/near/569400960" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rick Hull <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Type.20wrapping.html#569400960">(Jan 22 2026 at 03:25)</a>:</h4>
<p>Yes, almost certainly the stable Roc version documented on the website.  Outside of my very limited comfort zone.</p>



<a name="569856246"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Type%20wrapping/near/569856246" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Type.20wrapping.html#569856246">(Jan 24 2026 at 10:52)</a>:</h4>
<p>Hi <span class="user-mention" data-user-id="1017059">@Rachael Sexton</span>,<br>
You can use the <a href="https://www.roc-lang.org/examples/TryOperatorDesugaring/README"><code>?</code> operator</a> or <a href="https://roc-lang.org/builtins/main/Result/#map_ok">Result.map_ok</a></p>



<hr><p>Last updated: Mar 01 2026 at 12:20 UTC</p>
</html>