<html>
<head><meta charset="utf-8"><title>How would I implement “best-effort” pretty rendering in roc? · beginners · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/index.html">beginners</a></h2>
<h3>Topic: <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/How.20would.20I.20implement.20.E2.80.9Cbest-effort.E2.80.9D.20pretty.20rendering.20in.20roc.3F.html">How would I implement “best-effort” pretty rendering in roc?</a></h3>

<hr>

<base href="https://roc.zulipchat.com">

<head><link href="https://roc-lang.github.io/zulip-export/style.css" rel="stylesheet"></head>

<a name="569955294"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/How%20would%20I%20implement%20%E2%80%9Cbest-effort%E2%80%9D%20pretty%20rendering%20in%20roc%3F/near/569955294" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lukas Juhrich <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/How.20would.20I.20implement.20.E2.80.9Cbest-effort.E2.80.9D.20pretty.20rendering.20in.20roc.3F.html#569955294">(Jan 25 2026 at 13:41)</a>:</h4>
<p>Hi,</p>
<p>I may well have some basic misunderstandings about roc's abilities and design philosophy, but let me elaborate.</p>
<p>I've been thinking how one would build colorful pretty-printing like the <code>rich</code> library in python provides, which has become the de-facto standard for nice human readable output. It features reasonable defaults but its behavior can also be extended for user-defined types.</p>
<p>As far as I undrestand, <code>pprint</code> renders some piece of data like this:</p>
<ul>
<li>If it  has a <code>__rich_repr__()</code> method, use its value to build up the repr</li>
<li>otherwise, fall back to a reasonable default defined for e.g. lists, dictionaries or dataclasses (which would be records in roc)</li>
</ul>
<p>roc does not have python's dynamic introspection, so I figured I had to choose between this:</p>
<ol>
<li>build a giant function which switches based on the argument type, and continue to add special cases. but since there is neither ad-hoc polymorphism nor an „any“ type, this can't be done.</li>
<li>try to associate a function <code>rich_repr</code> to existing types. Since, in contrast to e.g. rust, we cannot associate functions to a type outside the original type definition, we'd need a wrapper type, say <code>Rich</code>, providing <code>rich_repr()</code>. But then we essentially just moved the problem: how do we define a <code>to_rich</code> function which, depending on the type, returns a different instance of <code>Rich</code>containing the information about how to format?</li>
</ol>
<p>Is roc missing some kind of overloading (rust's „trait X can be implemented from various sources“ compile-time-lookup of what a method may mean would also count as overloading in a broad sense), or am I just lacking a smart idea?</p>
<p><em>(edit: I'm talking about the new compiler, and specifically not about “abilities”)</em></p>



<a name="569956827"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/How%20would%20I%20implement%20%E2%80%9Cbest-effort%E2%80%9D%20pretty%20rendering%20in%20roc%3F/near/569956827" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dan G Knutson <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/How.20would.20I.20implement.20.E2.80.9Cbest-effort.E2.80.9D.20pretty.20rendering.20in.20roc.3F.html#569956827">(Jan 25 2026 at 14:06)</a>:</h4>
<p>I think you could implement this kind of pretty-printing in terms of 'encode', at least in the fully built-out version of encode that's planned. If you did it this way, 'RichRepr' would be an encoding format (kind of fitting into the same slot as 'json' or 'cbor').<br>
Brendan also said that a pattern like this was how <code>dbg</code> statements and the associated Inspect module was implemented in the old rust compiler.<br>
<a class="stream-topic" data-stream-id="304641" href="/#narrow/channel/304641-ideas/topic/Encode.2FDecode.20and.20reflection.20use-cases/with/567410751">#ideas &gt; Encode/Decode and reflection use-cases</a></p>



<a name="569956976"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/How%20would%20I%20implement%20%E2%80%9Cbest-effort%E2%80%9D%20pretty%20rendering%20in%20roc%3F/near/569956976" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lukas Juhrich <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/How.20would.20I.20implement.20.E2.80.9Cbest-effort.E2.80.9D.20pretty.20rendering.20in.20roc.3F.html#569956976">(Jan 25 2026 at 14:09)</a>:</h4>
<p>I haven't come around to a full understanding of encode yet, so I will take this opportunity to think about it more deeply. Thank you for the pointer!</p>



<hr><p>Last updated: Mar 01 2026 at 12:20 UTC</p>
</html>