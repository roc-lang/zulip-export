<html>
<head><meta charset="utf-8"><title>✔ Concise syntax to extract payload from a tag? · beginners · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/index.html">beginners</a></h2>
<h3>Topic: <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/.E2.9C.94.20Concise.20syntax.20to.20extract.20payload.20from.20a.20tag.3F.html">✔ Concise syntax to extract payload from a tag?</a></h3>

<hr>

<base href="https://roc.zulipchat.com">

<head><link href="https://roc-lang.github.io/zulip-export/style.css" rel="stylesheet"></head>

<a name="412181290"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/%E2%9C%94%20Concise%20syntax%20to%20extract%20payload%20from%20a%20tag%3F/near/412181290" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ian McLerran <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/.E2.9C.94.20Concise.20syntax.20to.20extract.20payload.20from.20a.20tag.3F.html#412181290">(Jan 10 2024 at 16:44)</a>:</h4>
<p>Is there a concise way to extract a payload from a tag result?</p>
<p>For example, suppose I have the following code:</p>
<div class="codehilite" data-code-language="CoffeeScript"><pre><span></span><code><span class="c1">## Convert a list of string represented values (ordered by level) into a binary tree</span>
<span class="c1">## values may be a string represented integer, or "null"</span>
<span class="nv">listToTree</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="nx">List</span><span class="w"> </span><span class="nx">Str</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="nx">NodeOrNull</span>
<span class="nv">listToTree</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">\</span><span class="nx">lst</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="nx">listToTreeRecur</span><span class="w"> </span><span class="nx">lst</span><span class="w"> </span><span class="mi">0</span>

<span class="nv">listToTreeRecur</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="nx">List</span><span class="w"> </span><span class="nx">Str</span><span class="p">,</span><span class="w"> </span><span class="nx">U32</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="nx">NodeOrNull</span>
<span class="nv">listToTreeRecur</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">\</span><span class="nx">lst</span><span class="p">,</span><span class="w"> </span><span class="nx">index</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">List</span><span class="p">.</span><span class="nx">len</span><span class="w"> </span><span class="nx">lst</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="nx">index</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="nx">Null</span>
<span class="w">    </span><span class="k">else</span>
<span class="w">        </span><span class="nv">strVal</span><span class="w"> </span><span class="o">=</span>
<span class="w">            </span><span class="k">when</span><span class="w"> </span><span class="nx">List</span><span class="p">.</span><span class="nx">get</span><span class="w"> </span><span class="nx">lst</span><span class="w"> </span><span class="nx">index</span><span class="w"> </span><span class="o">is</span>
<span class="w">                </span><span class="nx">Ok</span><span class="w"> </span><span class="nx">str</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="nx">str</span>
<span class="w">                </span><span class="nx">Err</span><span class="w"> </span><span class="nx">_</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="s">""</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="nx">strVal</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">"null"</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nx">strVal</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">""</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="nx">Null</span>
<span class="w">        </span><span class="k">else</span>
<span class="w">            </span><span class="nv">val</span><span class="w"> </span><span class="o">=</span>
<span class="w">                </span><span class="k">when</span><span class="w"> </span><span class="nx">Str</span><span class="p">.</span><span class="nx">toI64</span><span class="w"> </span><span class="p">(</span><span class="nx">strVal</span><span class="p">)</span><span class="w"> </span><span class="o">is</span>
<span class="w">                    </span><span class="nx">Ok</span><span class="w"> </span><span class="nx">num</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="nx">num</span>
<span class="w">                    </span><span class="nx">Err</span><span class="w"> </span><span class="nx">InvalidNumStr</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="mi">0</span>
<span class="w">            </span><span class="nv">rhs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">listToTreeRecur</span><span class="w"> </span><span class="nx">lst</span><span class="w"> </span><span class="p">(</span><span class="nx">index</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>
<span class="w">            </span><span class="nv">lhs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">listToTreeRecur</span><span class="w"> </span><span class="nx">lst</span><span class="w"> </span><span class="p">(</span><span class="nx">index</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span>
<span class="w">            </span><span class="nx">Child</span><span class="w"> </span><span class="p">{</span><span class="nx">val</span><span class="p">,</span><span class="w"> </span><span class="nx">rhs</span><span class="p">,</span><span class="w"> </span><span class="nx">lhs</span><span class="p">}</span>
</code></pre></div>
<p>I would like to do something like <code>val = Str.toI64 (List.get lst index)</code> but of course both <code>Str.toI64</code> and <code>List.get</code> return their values as payloads in a tag union.</p>
<p>Is there a more concise way to express this so I can chain functions together, instead of having to create temporary variables to store values?</p>



<a name="412181664"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/%E2%9C%94%20Concise%20syntax%20to%20extract%20payload%20from%20a%20tag%3F/near/412181664" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/.E2.9C.94.20Concise.20syntax.20to.20extract.20payload.20from.20a.20tag.3F.html#412181664">(Jan 10 2024 at 16:46)</a>:</h4>
<p>Generally checking length explicitly leads to extra branching/more explicit code :<code>if (List.len lst) &lt;= index then</code></p>
<p>Instead, just use the result of <code>List.get</code> for checking that</p>



<a name="412181790"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/%E2%9C%94%20Concise%20syntax%20to%20extract%20payload%20from%20a%20tag%3F/near/412181790" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/.E2.9C.94.20Concise.20syntax.20to.20extract.20payload.20from.20a.20tag.3F.html#412181790">(Jan 10 2024 at 16:47)</a>:</h4>
<div class="codehilite" data-code-language="Haskell"><pre><span></span><code><span class="nf">listToTreeRecur</span><span class="w"> </span><span class="kt">:</span><span class="w"> </span><span class="kt">List</span><span class="w"> </span><span class="kt">Str</span><span class="p">,</span><span class="w"> </span><span class="kt">U32</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="kt">NodeOrNull</span>
<span class="nf">listToTreeRecur</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="nf">\</span><span class="n">lst</span><span class="p">,</span><span class="w"> </span><span class="n">index</span><span class="w"> </span><span class="ow">-&gt;</span>
<span class="w">    </span><span class="n">when</span><span class="w"> </span><span class="kt">List</span><span class="o">.</span><span class="n">get</span><span class="w"> </span><span class="n">lst</span><span class="w"> </span><span class="n">index</span><span class="w"> </span><span class="n">is</span>
<span class="w">        </span><span class="kt">Ok</span><span class="w"> </span><span class="n">str</span><span class="w"> </span><span class="ow">-&gt;</span>
<span class="w">            </span><span class="kr">if</span><span class="w"> </span><span class="n">str</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">"null"</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">str</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">""</span><span class="w"> </span><span class="kr">then</span><span class="w"> </span><span class="kt">Null</span>
<span class="w">            </span><span class="kr">else</span>
<span class="w">                </span><span class="n">val</span><span class="w"> </span><span class="ow">=</span>
<span class="w">                    </span><span class="n">when</span><span class="w"> </span><span class="kt">Str</span><span class="o">.</span><span class="n">toI64</span><span class="w"> </span><span class="p">(</span><span class="n">str</span><span class="p">)</span><span class="w"> </span><span class="n">is</span>
<span class="w">                        </span><span class="kt">Ok</span><span class="w"> </span><span class="n">num</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="n">num</span>
<span class="w">                        </span><span class="kt">Err</span><span class="w"> </span><span class="kt">InvalidNumStr</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="mi">0</span>
<span class="w">                </span><span class="n">rhs</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="n">listToTreeRecur</span><span class="w"> </span><span class="n">lst</span><span class="w"> </span><span class="p">(</span><span class="n">index</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>
<span class="w">                </span><span class="n">lhs</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="n">listToTreeRecur</span><span class="w"> </span><span class="n">lst</span><span class="w"> </span><span class="p">(</span><span class="n">index</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span>
<span class="w">                </span><span class="kt">Child</span><span class="w"> </span><span class="p">{</span><span class="n">val</span><span class="p">,</span><span class="w"> </span><span class="n">rhs</span><span class="p">,</span><span class="w"> </span><span class="n">lhs</span><span class="p">}</span>
<span class="w">        </span><span class="kt">Err</span><span class="w"> </span><span class="kr">_</span><span class="w"> </span><span class="ow">-&gt;</span>
<span class="w">            </span><span class="kt">Null</span>
</code></pre></div>



<a name="412182103"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/%E2%9C%94%20Concise%20syntax%20to%20extract%20payload%20from%20a%20tag%3F/near/412182103" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/.E2.9C.94.20Concise.20syntax.20to.20extract.20payload.20from.20a.20tag.3F.html#412182103">(Jan 10 2024 at 16:49)</a>:</h4>
<p>Next, you can use the <a href="https://www.roc-lang.org/builtins/Result">Result helpers</a> here.</p>
<p>For example:</p>
<div class="codehilite" data-code-language="Haskell"><pre><span></span><code><span class="nf">listToTreeRecur</span><span class="w"> </span><span class="kt">:</span><span class="w"> </span><span class="kt">List</span><span class="w"> </span><span class="kt">Str</span><span class="p">,</span><span class="w"> </span><span class="kt">U32</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="kt">NodeOrNull</span>
<span class="nf">listToTreeRecur</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="nf">\</span><span class="n">lst</span><span class="p">,</span><span class="w"> </span><span class="n">index</span><span class="w"> </span><span class="ow">-&gt;</span>
<span class="w">    </span><span class="n">when</span><span class="w"> </span><span class="kt">List</span><span class="o">.</span><span class="n">get</span><span class="w"> </span><span class="n">lst</span><span class="w"> </span><span class="n">index</span><span class="w"> </span><span class="n">is</span>
<span class="w">        </span><span class="kt">Ok</span><span class="w"> </span><span class="n">str</span><span class="w"> </span><span class="ow">-&gt;</span>
<span class="w">            </span><span class="kr">if</span><span class="w"> </span><span class="n">str</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">"null"</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">str</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">""</span><span class="w"> </span><span class="kr">then</span><span class="w"> </span><span class="kt">Null</span>
<span class="w">            </span><span class="kr">else</span>
<span class="w">                </span><span class="n">val</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="kt">Str</span><span class="o">.</span><span class="n">toI64</span><span class="w"> </span><span class="n">str</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="kt">Result</span><span class="o">.</span><span class="n">withDefault</span><span class="w"> </span><span class="mi">0</span>
<span class="w">                </span><span class="n">rhs</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="n">listToTreeRecur</span><span class="w"> </span><span class="n">lst</span><span class="w"> </span><span class="p">(</span><span class="n">index</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>
<span class="w">                </span><span class="n">lhs</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="n">listToTreeRecur</span><span class="w"> </span><span class="n">lst</span><span class="w"> </span><span class="p">(</span><span class="n">index</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span>
<span class="w">                </span><span class="kt">Child</span><span class="w"> </span><span class="p">{</span><span class="n">val</span><span class="p">,</span><span class="w"> </span><span class="n">rhs</span><span class="p">,</span><span class="w"> </span><span class="n">lhs</span><span class="p">}</span>
<span class="w">        </span><span class="kt">Err</span><span class="w"> </span><span class="kr">_</span><span class="w"> </span><span class="ow">-&gt;</span>
<span class="w">            </span><span class="kt">Null</span>
</code></pre></div>



<a name="412182458"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/%E2%9C%94%20Concise%20syntax%20to%20extract%20payload%20from%20a%20tag%3F/near/412182458" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/.E2.9C.94.20Concise.20syntax.20to.20extract.20payload.20from.20a.20tag.3F.html#412182458">(Jan 10 2024 at 16:51)</a>:</h4>
<p>You also can use guards in when blocks:</p>
<div class="codehilite" data-code-language="Haskell"><pre><span></span><code><span class="nf">listToTreeRecur</span><span class="w"> </span><span class="kt">:</span><span class="w"> </span><span class="kt">List</span><span class="w"> </span><span class="kt">Str</span><span class="p">,</span><span class="w"> </span><span class="kt">U32</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="kt">NodeOrNull</span>
<span class="nf">listToTreeRecur</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="nf">\</span><span class="n">lst</span><span class="p">,</span><span class="w"> </span><span class="n">index</span><span class="w"> </span><span class="ow">-&gt;</span>
<span class="w">    </span><span class="n">when</span><span class="w"> </span><span class="kt">List</span><span class="o">.</span><span class="n">get</span><span class="w"> </span><span class="n">lst</span><span class="w"> </span><span class="n">index</span><span class="w"> </span><span class="n">is</span>
<span class="w">        </span><span class="kt">Ok</span><span class="w"> </span><span class="n">str</span><span class="w"> </span><span class="kr">if</span><span class="w"> </span><span class="n">str</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="s">"null"</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">str</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="s">""</span><span class="w"> </span><span class="ow">-&gt;</span>
<span class="w">            </span><span class="n">val</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="kt">Str</span><span class="o">.</span><span class="n">toI64</span><span class="w"> </span><span class="n">str</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="kt">Result</span><span class="o">.</span><span class="n">withDefault</span><span class="w"> </span><span class="mi">0</span>
<span class="w">            </span><span class="n">rhs</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="n">listToTreeRecur</span><span class="w"> </span><span class="n">lst</span><span class="w"> </span><span class="p">(</span><span class="n">index</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>
<span class="w">            </span><span class="n">lhs</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="n">listToTreeRecur</span><span class="w"> </span><span class="n">lst</span><span class="w"> </span><span class="p">(</span><span class="n">index</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span>
<span class="w">            </span><span class="kt">Child</span><span class="w"> </span><span class="p">{</span><span class="n">val</span><span class="p">,</span><span class="w"> </span><span class="n">rhs</span><span class="p">,</span><span class="w"> </span><span class="n">lhs</span><span class="p">}</span>
<span class="w">        </span><span class="kr">_</span><span class="w"> </span><span class="ow">-&gt;</span>
<span class="w">            </span><span class="kt">Null</span>
</code></pre></div>



<a name="412183580"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/%E2%9C%94%20Concise%20syntax%20to%20extract%20payload%20from%20a%20tag%3F/near/412183580" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/.E2.9C.94.20Concise.20syntax.20to.20extract.20payload.20from.20a.20tag.3F.html#412183580">(Jan 10 2024 at 16:58)</a>:</h4>
<p>A general note:</p>
<p>If you have multiple results functions in a row and don't want to check each and every one, that is what <a href="https://www.roc-lang.org/builtins/Result#try">Result.try</a> and <a href="https://www.roc-lang.org/builtins/Result#map">Result.map</a> are for. It would enable chaining multiple result functions together. You could instead write something like:</p>
<div class="codehilite" data-code-language="Haskell"><pre><span></span><code><span class="nf">listToTreeRecur</span><span class="w"> </span><span class="kt">:</span><span class="w"> </span><span class="kt">List</span><span class="w"> </span><span class="kt">Str</span><span class="p">,</span><span class="w"> </span><span class="kt">U32</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="kt">NodeOrNull</span>
<span class="nf">listToTreeRecur</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="nf">\</span><span class="n">lst</span><span class="p">,</span><span class="w"> </span><span class="n">index</span><span class="w"> </span><span class="ow">-&gt;</span>
<span class="w">    </span><span class="n">nodeRes</span><span class="w"> </span><span class="ow">=</span>
<span class="w">        </span><span class="n">str</span><span class="w"> </span><span class="ow">&lt;-</span><span class="w"> </span><span class="kt">List</span><span class="o">.</span><span class="n">get</span><span class="w"> </span><span class="n">lst</span><span class="w"> </span><span class="n">index</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="kt">Result</span><span class="o">.</span><span class="n">try</span>

<span class="w">        </span><span class="o">#</span><span class="w"> </span><span class="kt">Note</span><span class="p">,</span><span class="w"> </span><span class="kt">Str</span><span class="o">.</span><span class="n">toI64</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">reject</span><span class="w"> </span><span class="s">"null"</span><span class="w"> </span><span class="n">and</span><span class="w"> </span><span class="s">""</span><span class="p">,</span><span class="w"> </span><span class="n">so</span><span class="w"> </span><span class="kt">I</span><span class="w"> </span><span class="n">am</span><span class="w"> </span><span class="n">just</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">here</span><span class="p">,</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">not</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">ok</span><span class="w"> </span><span class="kr">in</span><span class="w"> </span><span class="n">general</span>
<span class="w">        </span><span class="n">val</span><span class="w"> </span><span class="ow">&lt;-</span><span class="w"> </span><span class="kt">Str</span><span class="o">.</span><span class="n">toI64</span><span class="w"> </span><span class="n">str</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="kt">Result</span><span class="o">.</span><span class="n">map</span>
<span class="w">        </span><span class="n">rhs</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="n">listToTreeRecur</span><span class="w"> </span><span class="n">lst</span><span class="w"> </span><span class="p">(</span><span class="n">index</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>
<span class="w">        </span><span class="n">lhs</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="n">listToTreeRecur</span><span class="w"> </span><span class="n">lst</span><span class="w"> </span><span class="p">(</span><span class="n">index</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span>
<span class="w">        </span><span class="kt">Child</span><span class="w"> </span><span class="p">{</span><span class="n">val</span><span class="p">,</span><span class="w"> </span><span class="n">rhs</span><span class="p">,</span><span class="w"> </span><span class="n">lhs</span><span class="p">}</span>

<span class="w">    </span><span class="kt">Result</span><span class="o">.</span><span class="n">withDefault</span><span class="w"> </span><span class="n">nodeRes</span><span class="w"> </span><span class="kt">Null</span>
</code></pre></div>



<a name="412212205"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/%E2%9C%94%20Concise%20syntax%20to%20extract%20payload%20from%20a%20tag%3F/near/412212205" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ian McLerran <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/.E2.9C.94.20Concise.20syntax.20to.20extract.20payload.20from.20a.20tag.3F.html#412212205">(Jan 10 2024 at 20:11)</a>:</h4>
<p>Wow, this is great. I'm still in progress learning language features and syntax, so your code examples here are a huge help in fleshing out some of these ideas. Really appreciate your answers here.</p>
<p>Everything here makes sense up to the last example using Result.try -- I've been trying to understand the back passing syntax, but the more I puzzle over the tutorial section on back passing, the more confused I get. </p>
<p>As I understand it, <code>str &lt;-</code> defines an anonymous function with an argument named <code>str</code>, much like <code>\str -&gt;</code> would. But where is the body of the function written? </p>
<p>Also the <code>|&gt;</code> operator will pass the return of one function on to the following function. It makes sense that Since Result.try expects a Result and a function to transform the Result as arguments, and that since <code>List.get</code> returns a result, this result could be passed on as the first argument to <code>Result.try</code>, but how does the <code>&lt;-</code> operator interact with <code>|&gt;</code>? Where is the body of the function being passed to Result.try? I assume that this function is also the same as the body of the function defined by <code>str &lt;-</code>...</p>
<p>Why not:</p>
<div class="codehilite" data-code-language="CoffeeScript"><pre><span></span><code><span class="c1"># return val from `List.get` piped to `Result.try `as first argument, anon func `str &lt;- some code` passed as second arg:</span>
<span class="nx">List</span><span class="p">.</span><span class="nx">get</span><span class="w"> </span><span class="nx">lst</span><span class="w"> </span><span class="nx">index</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="nx">Result</span><span class="p">.</span><span class="nx">try</span><span class="w"> </span><span class="nx">str</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nx">some</span><span class="p">.</span><span class="nx">func</span><span class="w"> </span><span class="nx">body</span><span class="w"> </span><span class="nx">code</span><span class="w"> </span><span class="nx">which</span><span class="w"> </span><span class="nx">operates</span><span class="w"> </span><span class="kc">on</span><span class="w"> </span><span class="nx">str</span>
</code></pre></div>
<p>Not sure why this back passing is seeming so incomprehensible to me... seems like I should be able to figure out the syntax just from your code snippet here.</p>



<a name="412213115"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/%E2%9C%94%20Concise%20syntax%20to%20extract%20payload%20from%20a%20tag%3F/near/412213115" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/.E2.9C.94.20Concise.20syntax.20to.20extract.20payload.20from.20a.20tag.3F.html#412213115">(Jan 10 2024 at 20:19)</a>:</h4>
<p>backpassing fundamentally removes indentation</p>



<a name="412213138"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/%E2%9C%94%20Concise%20syntax%20to%20extract%20payload%20from%20a%20tag%3F/near/412213138" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/.E2.9C.94.20Concise.20syntax.20to.20extract.20payload.20from.20a.20tag.3F.html#412213138">(Jan 10 2024 at 20:19)</a>:</h4>
<p>The body of the function is all of the lines of the code after that line on the same indentation level</p>



<a name="412213273"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/%E2%9C%94%20Concise%20syntax%20to%20extract%20payload%20from%20a%20tag%3F/near/412213273" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/.E2.9C.94.20Concise.20syntax.20to.20extract.20payload.20from.20a.20tag.3F.html#412213273">(Jan 10 2024 at 20:20)</a>:</h4>
<p>Without backpassing it would be:</p>
<div class="codehilite" data-code-language="Haskell"><pre><span></span><code><span class="nf">listToTreeRecur</span><span class="w"> </span><span class="kt">:</span><span class="w"> </span><span class="kt">List</span><span class="w"> </span><span class="kt">Str</span><span class="p">,</span><span class="w"> </span><span class="kt">U32</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="kt">NodeOrNull</span>
<span class="nf">listToTreeRecur</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="nf">\</span><span class="n">lst</span><span class="p">,</span><span class="w"> </span><span class="n">index</span><span class="w"> </span><span class="ow">-&gt;</span>
<span class="w">    </span><span class="n">nodeRes</span><span class="w"> </span><span class="ow">=</span>
<span class="w">        </span><span class="kt">List</span><span class="o">.</span><span class="n">get</span><span class="w"> </span><span class="n">lst</span><span class="w"> </span><span class="n">index</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="kt">Result</span><span class="o">.</span><span class="n">try</span><span class="w"> </span><span class="nf">\</span><span class="n">str</span><span class="w"> </span><span class="ow">-&gt;</span>

<span class="w">            </span><span class="o">#</span><span class="w"> </span><span class="kt">Note</span><span class="p">,</span><span class="w"> </span><span class="kt">Str</span><span class="o">.</span><span class="n">toI64</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">reject</span><span class="w"> </span><span class="s">"null"</span><span class="w"> </span><span class="n">and</span><span class="w"> </span><span class="s">""</span><span class="p">,</span><span class="w"> </span><span class="n">so</span><span class="w"> </span><span class="kt">I</span><span class="w"> </span><span class="n">am</span><span class="w"> </span><span class="n">just</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">here</span><span class="p">,</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">not</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">ok</span><span class="w"> </span><span class="kr">in</span><span class="w"> </span><span class="n">general</span>
<span class="w">            </span><span class="kt">Str</span><span class="o">.</span><span class="n">toI64</span><span class="w"> </span><span class="n">str</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="kt">Result</span><span class="o">.</span><span class="n">map</span><span class="w"> </span><span class="nf">\</span><span class="n">val</span><span class="w"> </span><span class="ow">-&gt;</span>
<span class="w">                </span><span class="n">rhs</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="n">listToTreeRecur</span><span class="w"> </span><span class="n">lst</span><span class="w"> </span><span class="p">(</span><span class="n">index</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>
<span class="w">                </span><span class="n">lhs</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="n">listToTreeRecur</span><span class="w"> </span><span class="n">lst</span><span class="w"> </span><span class="p">(</span><span class="n">index</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span>
<span class="w">                </span><span class="kt">Child</span><span class="w"> </span><span class="p">{</span><span class="n">val</span><span class="p">,</span><span class="w"> </span><span class="n">rhs</span><span class="p">,</span><span class="w"> </span><span class="n">lhs</span><span class="p">}</span>

<span class="w">    </span><span class="kt">Result</span><span class="o">.</span><span class="n">withDefault</span><span class="w"> </span><span class="n">nodeRes</span><span class="w"> </span><span class="kt">Null</span>
</code></pre></div>



<a name="412216311"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/%E2%9C%94%20Concise%20syntax%20to%20extract%20payload%20from%20a%20tag%3F/near/412216311" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ian McLerran <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/.E2.9C.94.20Concise.20syntax.20to.20extract.20payload.20from.20a.20tag.3F.html#412216311">(Jan 10 2024 at 20:42)</a>:</h4>
<p>Okay, this makes sense. Seems counterintuitive based on my understanding of the pipe <code>|&gt;</code> operator passing everything preceding the pipe as the first argument to the function after the pipe. Thanks again though. That does straighten out the confusion. <span aria-label="saluting face" class="emoji emoji-1fae1" role="img" title="saluting face">:saluting_face:</span></p>



<a name="412216721"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/%E2%9C%94%20Concise%20syntax%20to%20extract%20payload%20from%20a%20tag%3F/near/412216721" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/.E2.9C.94.20Concise.20syntax.20to.20extract.20payload.20from.20a.20tag.3F.html#412216721">(Jan 10 2024 at 20:45)</a>:</h4>
<p>It is doing that. If you desugar the pipe as well:</p>
<div class="codehilite" data-code-language="Haskell"><pre><span></span><code><span class="nf">listToTreeRecur</span><span class="w"> </span><span class="kt">:</span><span class="w"> </span><span class="kt">List</span><span class="w"> </span><span class="kt">Str</span><span class="p">,</span><span class="w"> </span><span class="kt">U32</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="kt">NodeOrNull</span>
<span class="nf">listToTreeRecur</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="nf">\</span><span class="n">lst</span><span class="p">,</span><span class="w"> </span><span class="n">index</span><span class="w"> </span><span class="ow">-&gt;</span>
<span class="w">    </span><span class="n">nodeRes</span><span class="w"> </span><span class="ow">=</span>
<span class="w">        </span><span class="kt">Result</span><span class="o">.</span><span class="n">try</span><span class="w"> </span><span class="p">(</span><span class="kt">List</span><span class="o">.</span><span class="n">get</span><span class="w"> </span><span class="n">lst</span><span class="w"> </span><span class="n">index</span><span class="p">)</span><span class="w"> </span><span class="nf">\</span><span class="n">str</span><span class="w"> </span><span class="ow">-&gt;</span>

<span class="w">            </span><span class="o">#</span><span class="w"> </span><span class="kt">Note</span><span class="p">,</span><span class="w"> </span><span class="kt">Str</span><span class="o">.</span><span class="n">toI64</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">reject</span><span class="w"> </span><span class="s">"null"</span><span class="w"> </span><span class="n">and</span><span class="w"> </span><span class="s">""</span><span class="p">,</span><span class="w"> </span><span class="n">so</span><span class="w"> </span><span class="kt">I</span><span class="w"> </span><span class="n">am</span><span class="w"> </span><span class="n">just</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">here</span><span class="p">,</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">not</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">ok</span><span class="w"> </span><span class="kr">in</span><span class="w"> </span><span class="n">general</span>
<span class="w">            </span><span class="kt">Result</span><span class="o">.</span><span class="n">map</span><span class="w"> </span><span class="p">(</span><span class="kt">Str</span><span class="o">.</span><span class="n">toI64</span><span class="w"> </span><span class="n">str</span><span class="p">)</span><span class="w"> </span><span class="nf">\</span><span class="n">val</span><span class="w"> </span><span class="ow">-&gt;</span>
<span class="w">                </span><span class="n">rhs</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="n">listToTreeRecur</span><span class="w"> </span><span class="n">lst</span><span class="w"> </span><span class="p">(</span><span class="n">index</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>
<span class="w">                </span><span class="n">lhs</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="n">listToTreeRecur</span><span class="w"> </span><span class="n">lst</span><span class="w"> </span><span class="p">(</span><span class="n">index</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span>
<span class="w">                </span><span class="kt">Child</span><span class="w"> </span><span class="p">{</span><span class="n">val</span><span class="p">,</span><span class="w"> </span><span class="n">rhs</span><span class="p">,</span><span class="w"> </span><span class="n">lhs</span><span class="p">}</span>

<span class="w">    </span><span class="kt">Result</span><span class="o">.</span><span class="n">withDefault</span><span class="w"> </span><span class="n">nodeRes</span><span class="w"> </span><span class="kt">Null</span>
</code></pre></div>



<a name="412217082"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/%E2%9C%94%20Concise%20syntax%20to%20extract%20payload%20from%20a%20tag%3F/near/412217082" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ian McLerran <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/.E2.9C.94.20Concise.20syntax.20to.20extract.20payload.20from.20a.20tag.3F.html#412217082">(Jan 10 2024 at 20:48)</a>:</h4>
<p>Yeah, I see that... just throws me off that the <code>str &lt;-</code> precedes the <code>|&gt;</code> even though the function it is defining will be the <em>second</em> argument to <code>Result.try</code> or the <code>val &lt;-</code> function will be the <em>second</em> argument to <code>Result.map</code>.</p>
<p>Seems like the <code>&lt;-</code> operator modifies the expected behavior of <code>|&gt;</code>. This is something one can learn and remember, just a little annoying that it <em>appears</em> to break the rules.</p>



<a name="412217976"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/%E2%9C%94%20Concise%20syntax%20to%20extract%20payload%20from%20a%20tag%3F/near/412217976" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/.E2.9C.94.20Concise.20syntax.20to.20extract.20payload.20from.20a.20tag.3F.html#412217976">(Jan 10 2024 at 20:55)</a>:</h4>
<p>Yeah, desugaring has an order, so makes sense that it can be a bit confusing.</p>



<a name="412218180"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/%E2%9C%94%20Concise%20syntax%20to%20extract%20payload%20from%20a%20tag%3F/near/412218180" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ian McLerran <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/.E2.9C.94.20Concise.20syntax.20to.20extract.20payload.20from.20a.20tag.3F.html#412218180">(Jan 10 2024 at 20:57)</a>:</h4>
<p>Yeah, guess you're right, that's what it boils down to.</p>



<a name="412218225"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/%E2%9C%94%20Concise%20syntax%20to%20extract%20payload%20from%20a%20tag%3F/near/412218225" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Notification Bot <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/.E2.9C.94.20Concise.20syntax.20to.20extract.20payload.20from.20a.20tag.3F.html#412218225">(Jan 10 2024 at 20:57)</a>:</h4>
<p><span class="user-mention silent" data-user-id="518883">Ian McLerran</span> has marked this topic as resolved.</p>



<hr><p>Last updated: Nov 01 2025 at 12:13 UTC</p>
</html>