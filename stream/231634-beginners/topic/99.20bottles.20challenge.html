<html>
<head><meta charset="utf-8"><title>99 bottles challenge · beginners · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/index.html">beginners</a></h2>
<h3>Topic: <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/99.20bottles.20challenge.html">99 bottles challenge</a></h3>

<hr>

<base href="https://roc.zulipchat.com">

<head><link href="https://roc-lang.github.io/zulip-export/style.css" rel="stylesheet"></head>

<a name="288307598"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/99%20bottles%20challenge/near/288307598" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jan kili <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/99.20bottles.20challenge.html#288307598">(Jul 03 2022 at 04:50)</a>:</h4>
<div class="codehilite" data-code-language="Python"><pre><span></span><code><span class="c1"># "99 Bottles of Beer" in Roc, by Jan Van Bruggen</span>
<span class="c1">#</span>
<span class="c1"># For https://99-bottles-of-beer.net</span>

<span class="n">app</span> <span class="s2">"sing"</span>
    <span class="n">packages</span> <span class="p">{</span> <span class="n">pf</span><span class="p">:</span> <span class="s2">"../roc/examples/hello-world/platform/main.roc"</span> <span class="p">}</span>
    <span class="n">imports</span> <span class="p">[]</span>
    <span class="n">provides</span> <span class="p">[</span><span class="n">main</span><span class="p">]</span> <span class="n">to</span> <span class="n">pf</span>

<span class="n">main</span> <span class="o">=</span> <span class="n">List</span><span class="o">.</span><span class="n">range</span> <span class="mi">0</span> <span class="mi">100</span>
    <span class="o">|&gt;</span> <span class="n">List</span><span class="o">.</span><span class="n">reverse</span>
    <span class="o">|&gt;</span> <span class="n">List</span><span class="o">.</span><span class="n">map</span> \<span class="n">count</span> <span class="o">-&gt;</span>
        <span class="n">before</span> <span class="o">=</span> <span class="n">Num</span><span class="o">.</span><span class="n">toStr</span> <span class="n">count</span>
        <span class="n">after</span> <span class="o">=</span> <span class="n">Num</span><span class="o">.</span><span class="n">toStr</span> <span class="p">(</span><span class="n">count</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">when</span> <span class="n">count</span> <span class="ow">is</span>
            <span class="mi">0</span> <span class="o">-&gt;</span> <span class="s2">"No more bottles of beer on the wall, no more bottles of beer.</span><span class="se">\n</span><span class="s2">Go to the store and buy some more, 99 bottles of beer on the wall."</span>
            <span class="mi">1</span> <span class="o">-&gt;</span> <span class="s2">"1 bottle of beer on the wall, 1 bottle of beer.</span><span class="se">\n</span><span class="s2">Take one down and pass it around, no more bottles of beer on the wall."</span>
            <span class="mi">2</span> <span class="o">-&gt;</span> <span class="s2">"2 bottles of beer on the wall, 2 bottles of beer.</span><span class="se">\n</span><span class="s2">Take one down and pass it around, 1 bottle of beer on the wall."</span>
            <span class="n">_</span> <span class="o">-&gt;</span> <span class="s2">"\(before) bottles of beer on the wall, \(before) bottles of beer.</span><span class="se">\n</span><span class="s2">Take one down and pass it around, \(after) bottles of beer on the wall."</span>
    <span class="o">|&gt;</span> <span class="n">Str</span><span class="o">.</span><span class="n">joinWith</span> <span class="s2">"</span><span class="se">\n\n</span><span class="s2">"</span>
    <span class="o">|&gt;</span> <span class="n">Str</span><span class="o">.</span><span class="n">concat</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span>
</code></pre></div>
<p>Any other approaches? :)</p>



<a name="288325762"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/99%20bottles%20challenge/near/288325762" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/99.20bottles.20challenge.html#288325762">(Jul 03 2022 at 12:43)</a>:</h4>
<p>maybe <code>List.range 100 0</code> should Just Work here</p>



<a name="288325768"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/99%20bottles%20challenge/near/288325768" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/99.20bottles.20challenge.html#288325768">(Jul 03 2022 at 12:43)</a>:</h4>
<p>would be a lot more efficient than reversing in place!</p>



<a name="288325819"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/99%20bottles%20challenge/near/288325819" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Qqwy / Marten <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/99.20bottles.20challenge.html#288325819">(Jul 03 2022 at 12:44)</a>:</h4>
<p><code>List.range 0 100 |&gt; List.map (\x -&gt; 100 - x) |&gt; ...</code> <span aria-label="sunglasses" class="emoji emoji-1f60e" role="img" title="sunglasses">:sunglasses:</span></p>



<a name="288325827"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/99%20bottles%20challenge/near/288325827" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/99.20bottles.20challenge.html#288325827">(Jul 03 2022 at 12:44)</a>:</h4>
<p>you could also do a <code>List.walkBackwards</code> and build up the answer list one <code>List.append</code> at a time</p>



<a name="288325907"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/99%20bottles%20challenge/near/288325907" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Qqwy / Marten <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/99.20bottles.20challenge.html#288325907">(Jul 03 2022 at 12:46)</a>:</h4>
<p>We should benchmark this against using <code>Task.await (Stdout.line ...)</code></p>



<a name="288326303"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/99%20bottles%20challenge/near/288326303" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/99.20bottles.20challenge.html#288326303">(Jul 03 2022 at 12:55)</a>:</h4>
<p>I'd expect the <code>List</code> version to be faster - fewer syscalls, and Stdout is usually buffered (on a line boundary too), so probably fewer array writes too <span aria-label="big smile" class="emoji emoji-1f604" role="img" title="big smile">:big_smile:</span></p>



<a name="288326313"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/99%20bottles%20challenge/near/288326313" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/99.20bottles.20challenge.html#288326313">(Jul 03 2022 at 12:56)</a>:</h4>
<p>but then again, performance is often surprising in practice!</p>



<a name="290649550"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/99%20bottles%20challenge/near/290649550" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jan kili <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/99.20bottles.20challenge.html#290649550">(Jul 24 2022 at 03:41)</a>:</h4>
<p>I refactored my script to make it more <code>s  c  a  l  a  b  l  e</code> - any ideas for how to gracefully merge <code>before1</code> and <code>before2</code>?</p>
<div class="codehilite" data-code-language="Python"><pre><span></span><code><span class="c1"># "99 Bottles of Beer" in Roc, by Jan Van Bruggen</span>
<span class="c1">#</span>
<span class="c1"># For https://99-bottles-of-beer.net</span>

<span class="n">app</span> <span class="s2">"sing"</span>
    <span class="n">packages</span> <span class="p">{</span> <span class="n">pf</span><span class="p">:</span> <span class="s2">"../roc/examples/hello-world/platform/main.roc"</span> <span class="p">}</span>
    <span class="n">imports</span> <span class="p">[]</span>
    <span class="n">provides</span> <span class="p">[</span><span class="n">main</span><span class="p">]</span> <span class="n">to</span> <span class="n">pf</span>

<span class="n">main</span> <span class="o">=</span> <span class="n">List</span><span class="o">.</span><span class="n">range</span> <span class="mi">0</span> <span class="mi">100</span>
    <span class="o">|&gt;</span> <span class="n">List</span><span class="o">.</span><span class="n">reverse</span>
    <span class="o">|&gt;</span> <span class="n">List</span><span class="o">.</span><span class="n">map</span> <span class="n">verse</span>
    <span class="o">|&gt;</span> <span class="n">Str</span><span class="o">.</span><span class="n">joinWith</span> <span class="s2">"</span><span class="se">\n\n</span><span class="s2">"</span>
    <span class="o">|&gt;</span> <span class="n">Str</span><span class="o">.</span><span class="n">concat</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span>

<span class="n">verse</span> <span class="o">=</span> \<span class="n">count</span> <span class="o">-&gt;</span>
    <span class="n">take</span> <span class="o">=</span> <span class="s2">"Take one down and pass it around"</span>
    <span class="n">more</span> <span class="o">=</span> <span class="s2">"Go to the store and buy some more"</span>
    <span class="n">when</span> <span class="n">count</span> <span class="ow">is</span>
        <span class="mi">0</span> <span class="o">-&gt;</span> <span class="nb">format</span> <span class="s2">"No more bottles"</span> <span class="s2">"no more bottles"</span> <span class="n">more</span> <span class="s2">"99 bottles"</span>
        <span class="mi">1</span> <span class="o">-&gt;</span> <span class="nb">format</span> <span class="s2">"1 bottle"</span> <span class="s2">"1 bottle"</span> <span class="n">take</span> <span class="s2">"No more bottles"</span>
        <span class="mi">2</span> <span class="o">-&gt;</span> <span class="nb">format</span> <span class="s2">"2 bottles"</span> <span class="s2">"2 bottles"</span> <span class="n">take</span> <span class="s2">"1 bottle"</span>
        <span class="n">_</span> <span class="o">-&gt;</span>
            <span class="n">stringify</span> <span class="o">=</span> \<span class="n">n</span> <span class="o">-&gt;</span> <span class="n">n</span> <span class="o">|&gt;</span> <span class="n">Num</span><span class="o">.</span><span class="n">toStr</span> <span class="o">|&gt;</span> <span class="n">Str</span><span class="o">.</span><span class="n">concat</span> <span class="s2">" bottles"</span>
            <span class="nb">format</span> <span class="p">(</span><span class="n">stringify</span> <span class="n">count</span><span class="p">)</span> <span class="p">(</span><span class="n">stringify</span> <span class="n">count</span><span class="p">)</span> <span class="n">take</span> <span class="p">(</span><span class="n">stringify</span> <span class="p">(</span><span class="n">count</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>

<span class="nb">format</span> <span class="o">=</span> \<span class="n">before1</span><span class="p">,</span> <span class="n">before2</span><span class="p">,</span> <span class="n">action</span><span class="p">,</span> <span class="n">after</span> <span class="o">-&gt;</span>
    <span class="s2">"\(before1) of beer on the wall, \(before2) of beer.</span><span class="se">\n</span><span class="s2">\(action), \(after) of beer on the wall."</span>
</code></pre></div>



<a name="290649606"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/99%20bottles%20challenge/near/290649606" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jan kili <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/99.20bottles.20challenge.html#290649606">(Jul 24 2022 at 03:42)</a>:</h4>
<p>(the only reason for the split is <code>No more</code> vs. <code>no more</code> <span aria-label="distraught" class="emoji emoji-1f629" role="img" title="distraught">:distraught:</span>)</p>



<a name="290649653"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/99%20bottles%20challenge/near/290649653" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jan kili <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/99.20bottles.20challenge.html#290649653">(Jul 24 2022 at 03:43)</a>:</h4>
<p>... or a bigger idea for how to do dynamic verse formatting more gracefully in general?</p>



<a name="290659365"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/99%20bottles%20challenge/near/290659365" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Thomas Dwyer <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/99.20bottles.20challenge.html#290659365">(Jul 24 2022 at 07:57)</a>:</h4>
<p>You could pass a function on how to transform a capitalized string "No more bottles" into the non-capitalized form, which gives the caller a similar level of freedom.<br>
A bigger idea could be defining functions like <code>format</code> for specific uses (like this one) but a record with transformations on a string inside of it. Functions that format strings could then require specific formatting functions and make the rest optional (or enable defaulting, as it's entirely possible to default some of these operations). This reduces the number of arguments and enables modular formatting functions with similar design elements. Just an idea though, no idea how ergonomic that would be</p>



<a name="290660393"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/99%20bottles%20challenge/near/290660393" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Thomas Dwyer <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/99.20bottles.20challenge.html#290660393">(Jul 24 2022 at 08:25)</a>:</h4>
<p>I imagine something like the following:</p>
<div class="codehilite"><pre><span></span><code>format :
    {
        toLowerPhr : Str -&gt; Str,
        toUpperPhr : Str -&gt; Str,
        replace : Map [Action, After] Str -&gt; [Action, After] -&gt; Str ,
        # ^ The idea behind this is to mitigate the action and after
               arguments and instead enable ad hoc replacements
        replacements : Map [Action, After] Str
    }*,
    # ^ This whole record would be a Formatter and all formatting functions would use it.
    Str -&gt; Str
format = \{ toLowerPhr, toUpperPhr, replace, replacements}, str -&gt;
    &quot;\(toUpperPhr str) of beer on the wall, \(toLowerPhr str) of beer.\n\(replace replacements Action), \(replace replacements After) of beer on the wall&quot;
</code></pre></div>
<p>This means you pick and choose which formatting functions you want and throw out the rest. The caller provides the formatters they want and the formatter applies them where necessary. Hope this makes sense, also note I haven't done much Roc coding aside from browsing discussions here so I'm unsure how ergonomic this may or may not be. One thing i don't know how to do is enable picking and choosing of record fields from an established record (<code>Formatter</code>) in the Type declaration so new formatting functions can't add new functions not present in <code>Formatter</code> to the record; it may be difficult to have <em>a la carte</em> Open Records, if that makes sense. (Apologies for the several edits, its way too late at night lol)</p>



<a name="290664808"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/99%20bottles%20challenge/near/290664808" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Qqwy / Marten <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/99.20bottles.20challenge.html#290664808">(Jul 24 2022 at 10:22)</a>:</h4>
<p>Is the 'No more bottles...' thing required? There seem to be many implementations that just use `0 bottles...'</p>



<a name="290669394"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/99%20bottles%20challenge/near/290669394" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jan kili <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/99.20bottles.20challenge.html#290669394">(Jul 24 2022 at 12:14)</a>:</h4>
<p>I agree, that website probably would accept <code>0 bottles</code>, but I embrace this string formatting challenge!</p>



<a name="290669554"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/99%20bottles%20challenge/near/290669554" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jan kili <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/99.20bottles.20challenge.html#290669554">(Jul 24 2022 at 12:19)</a>:</h4>
<p><span class="user-mention" data-user-id="484835">@Thomas Dwyer</span> interesting, I want to try that and see how it feels!</p>



<hr><p>Last updated: Mar 01 2026 at 12:20 UTC</p>
</html>