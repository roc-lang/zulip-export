<html>
<head><meta charset="utf-8"><title>Floating point arithmetic · beginners · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/index.html">beginners</a></h2>
<h3>Topic: <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Floating.20point.20arithmetic.html">Floating point arithmetic</a></h3>

<hr>

<base href="https://roc.zulipchat.com">

<head><link href="https://roc-lang.github.io/zulip-export/style.css" rel="stylesheet"></head>

<a name="436699040"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Floating%20point%20arithmetic/near/436699040" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Andy Ferris <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Floating.20point.20arithmetic.html#436699040">(May 02 2024 at 13:50)</a>:</h4>
<p>I'm new to Roc with a numerics background. I'm used to things like 1.0 / 0.0 being Infinity and 0.0 / 0.0 being NaN. Does Roc use IEEE754 floating point arithmetic? Is it defaulting to the decimal type? (And is the decimal type supposed to be a floating-point value with decimal digits (mantissa) instead of binary digits? Or an integer with fixed point semantics?)</p>



<a name="436708561"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Floating%20point%20arithmetic/near/436708561" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Floating.20point.20arithmetic.html#436708561">(May 02 2024 at 14:33)</a>:</h4>
<p>Default fractional type is a fixed point decimal</p>



<a name="436708670"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Floating%20point%20arithmetic/near/436708670" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Floating.20point.20arithmetic.html#436708670">(May 02 2024 at 14:34)</a>:</h4>
<p>Can just specify the type to get a float though</p>



<a name="436708729"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Floating%20point%20arithmetic/near/436708729" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Floating.20point.20arithmetic.html#436708729">(May 02 2024 at 14:34)</a>:</h4>
<p><code>1.0f32 / 0.0</code></p>



<a name="436713419"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Floating%20point%20arithmetic/near/436713419" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Floating.20point.20arithmetic.html#436713419">(May 02 2024 at 14:57)</a>:</h4>
<p>also type inference takes care of that automatically; if you have a function that expects a  <code>F64</code> or <code>F32</code>, you can pass it <code>1.0</code> or even just <code>1</code> and it will use the appropriate representation</p>



<a name="436787322"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Floating%20point%20arithmetic/near/436787322" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Andy Ferris <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Floating.20point.20arithmetic.html#436787322">(May 02 2024 at 22:34)</a>:</h4>
<p>Awesome - thanks, that makes a lot of sense.</p>
<p>Is there any syntax (i.e. literals) for Infinity, -Infinity and NaN of F32 and F64? The printing of these values at the REPL isn't round-trippable.</p>



<a name="436787496"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Floating%20point%20arithmetic/near/436787496" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Floating.20point.20arithmetic.html#436787496">(May 02 2024 at 22:36)</a>:</h4>
<p>I don't there is. I'm interested to know what round-trippable means?</p>



<a name="436789277"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Floating%20point%20arithmetic/near/436789277" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Floating.20point.20arithmetic.html#436789277">(May 02 2024 at 22:56)</a>:</h4>
<p>I assume as in what the repl prints out can't be put back into the program</p>



<a name="436789379"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Floating%20point%20arithmetic/near/436789379" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Floating.20point.20arithmetic.html#436789379">(May 02 2024 at 22:57)</a>:</h4>
<p>we should probably make <code>Num.infinityF32</code> and <code>Num.infinityF64</code> and same for <code>nan</code></p>



<a name="436789407"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Floating%20point%20arithmetic/near/436789407" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Floating.20point.20arithmetic.html#436789407">(May 02 2024 at 22:57)</a>:</h4>
<p>we can't give them the type <code>Frac *</code> because <code>Dec</code> doesn't have infinity and nan</p>



<a name="436789496"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Floating%20point%20arithmetic/near/436789496" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Floating.20point.20arithmetic.html#436789496">(May 02 2024 at 22:58)</a>:</h4>
<p>also probably don't need a negative infinity because e.g. <code>-Num.infinityF64</code> would compile to that anyway</p>



<a name="436791815"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Floating%20point%20arithmetic/near/436791815" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Andy Ferris <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Floating.20point.20arithmetic.html#436791815">(May 02 2024 at 23:24)</a>:</h4>
<p>Yes I meant what printed in the REPL for at least built-in primitive types like F64 and F32 should be valid syntax for the same value. (In fact, for a functional language it should be possible to ensure this for basically all values, though you might not want to print everything in full at the REPL by default).</p>



<a name="436791817"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Floating%20point%20arithmetic/near/436791817" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Andy Ferris <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Floating.20point.20arithmetic.html#436791817">(May 02 2024 at 23:24)</a>:</h4>
<p>Note that being round-trippable for finite floating-point numbers is also pretty big deal. Back in the 2000's, say, a lot of languages would not give the exact same float when you print it and then parse it again, which causes trouble for really basic interchange like saving and loading a CSV or trying to debug a problem or whatever. Nowadays there exist fast and robust techniques for printing and parsing floats, so that shouldn't be a problem, but I didn't look into how Roc does this yet.</p>



<a name="436792009"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Floating%20point%20arithmetic/near/436792009" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Andy Ferris <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Floating.20point.20arithmetic.html#436792009">(May 02 2024 at 23:27)</a>:</h4>
<p><span class="user-mention silent" data-user-id="281383">Richard Feldman</span> <a href="#narrow/stream/231634-beginners/topic/Floating.20point.20arithmetic/near/436789496">said</a>:</p>
<blockquote>
<p>also probably don't need a negative infinity because e.g. <code>-Num.infinityF64</code> would compile to that anyway</p>
</blockquote>
<p>I'd suggest following whatever Roc does for -1.0. Is that evaluated as -(1.0) or parsed as a single literal?</p>



<a name="436793202"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Floating%20point%20arithmetic/near/436793202" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Floating.20point.20arithmetic.html#436793202">(May 02 2024 at 23:40)</a>:</h4>
<p>made an issue! <a href="https://github.com/roc-lang/roc/issues/6709">https://github.com/roc-lang/roc/issues/6709</a></p>



<a name="436793307"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Floating%20point%20arithmetic/near/436793307" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Floating.20point.20arithmetic.html#436793307">(May 02 2024 at 23:41)</a>:</h4>
<p><span class="user-mention silent" data-user-id="714854">Andy Ferris</span> <a href="#narrow/stream/231634-beginners/topic/Floating.20point.20arithmetic/near/436791815">said</a>:</p>
<blockquote>
<p>Yes I meant what printed in the REPL for at least built-in primitive types like F64 and F32 should be valid syntax for the same value. (In fact, for a functional language it should be possible to ensure this for basically all values, though you might not want to print everything in full at the REPL by default).</p>
</blockquote>
<p>in the case of opaque types it's very important that this property not hold, and for functions it's probably more annoying than helpful (especially long functions), but yeah for structural types other than functions I agree!</p>



<a name="439218965"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Floating%20point%20arithmetic/near/439218965" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Andy Ferris <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Floating.20point.20arithmetic.html#439218965">(May 17 2024 at 13:07)</a>:</h4>
<p>I've made a little bit more progress on this at <a href="https://github.com/roc-lang/roc/pull/6755">https://github.com/roc-lang/roc/pull/6755</a>, but am a little stuck.</p>
<p>Part of my problem is now <code>cargo build</code> isn't working (on WSL2) as it is complaining about the <code>llvm-sys</code> crate not being able to find LLVM. I tried apt installing <code>llvm-dev</code> but that wasn't helpful. The end result is I haven't been able to run my changes locally.</p>



<a name="439572765"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Floating%20point%20arithmetic/near/439572765" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Floating.20point.20arithmetic.html#439572765">(May 20 2024 at 13:21)</a>:</h4>
<p>This may help:</p>
<div class="codehilite"><pre><span></span><code>wget https://apt.llvm.org/llvm.sh
chmod +x llvm.sh
./llvm.sh 16
</code></pre></div>
<p>Add <code>export LLVM_SYS_160_PREFIX=/usr/lib/llvm-16</code> to your <code>~/.bashrc</code> or equivalent file for your shell.</p>
<p>Although I would recommend using nix with <code>nix develop</code> as that will set up everything for you.</p>



<a name="439802200"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Floating%20point%20arithmetic/near/439802200" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Andy Ferris <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Floating.20point.20arithmetic.html#439802200">(May 21 2024 at 12:06)</a>:</h4>
<p>Thanks that helps. I also had to install libpolly-16-dev and libzstd-dev.</p>
<p>I tried <code>nix develop</code> and it originally worked (a couple of weeks ago) but now it isn't, not sure what I've done differently.</p>



<a name="439807811"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Floating%20point%20arithmetic/near/439807811" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Floating.20point.20arithmetic.html#439807811">(May 21 2024 at 12:39)</a>:</h4>
<blockquote>
<p>I tried <code>nix develop</code> and it originally worked (a couple of weeks ago) but now it isn't, not sure what I've done differently.</p>
</blockquote>
<p>You may need to do <code>cargo clean</code> because problems arise when rust tries to combine old cached build artifacts (outside nix) with new ones built inside nix.</p>



<hr><p>Last updated: Nov 01 2025 at 12:13 UTC</p>
</html>