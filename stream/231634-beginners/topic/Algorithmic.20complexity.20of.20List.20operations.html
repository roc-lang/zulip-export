<html>
<head><meta charset="utf-8"><title>Algorithmic complexity of List operations · beginners · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/index.html">beginners</a></h2>
<h3>Topic: <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Algorithmic.20complexity.20of.20List.20operations.html">Algorithmic complexity of List operations</a></h3>

<hr>

<base href="https://roc.zulipchat.com">

<head><link href="https://roc-lang.github.io/zulip-export/style.css" rel="stylesheet"></head>

<a name="438162794"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Algorithmic%20complexity%20of%20List%20operations/near/438162794" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Abhinav Sarkar <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Algorithmic.20complexity.20of.20List.20operations.html#438162794">(May 12 2024 at 06:42)</a>:</h4>
<p>Hi. I could not find the algorithmic complexity of List operations like append, prepend, concat etc mentioned in the docs. I tried going through the code but I was unable to find the implementations. Can someone tell me what they are?</p>



<a name="438162823"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Algorithmic%20complexity%20of%20List%20operations/near/438162823" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Abhinav Sarkar <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Algorithmic.20complexity.20of.20List.20operations.html#438162823">(May 12 2024 at 06:43)</a>:</h4>
<p>It'll be great if it is mentioned in the docs. Specifically, I'm wondering if List prepend and append are O(1) or O(n).</p>



<a name="438164026"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Algorithmic%20complexity%20of%20List%20operations/near/438164026" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Abhinav Sarkar <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Algorithmic.20complexity.20of.20List.20operations.html#438164026">(May 12 2024 at 07:06)</a>:</h4>
<p>After some digging, I found the implementation at <a href="https://github.com/roc-lang/roc/blob/main/crates/compiler/builtins/bitcode/src/list.zig">https://github.com/roc-lang/roc/blob/main/crates/compiler/builtins/bitcode/src/list.zig</a>. IIUC, append and prepend at O(n) and concat is O(m+n). Please correct me if I'm wrong.</p>



<a name="438175252"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Algorithmic%20complexity%20of%20List%20operations/near/438175252" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Algorithmic.20complexity.20of.20List.20operations.html#438175252">(May 12 2024 at 10:30)</a>:</h4>
<p>List is a flat array</p>



<a name="438175307"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Algorithmic%20complexity%20of%20List%20operations/near/438175307" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Algorithmic.20complexity.20of.20List.20operations.html#438175307">(May 12 2024 at 10:30)</a>:</h4>
<p>So same as a c++ vector or java arraylist</p>



<a name="438175345"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Algorithmic%20complexity%20of%20List%20operations/near/438175345" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Algorithmic.20complexity.20of.20List.20operations.html#438175345">(May 12 2024 at 10:32)</a>:</h4>
<p>Append 1<br>
Prepend n<br>
Concat of m and n list is n</p>



<a name="438175432"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Algorithmic%20complexity%20of%20List%20operations/near/438175432" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Algorithmic.20complexity.20of.20List.20operations.html#438175432">(May 12 2024 at 10:33)</a>:</h4>
<p>The big caveat is uniqueness. Due to immutability requirements, can lead to O(n) coping</p>



<a name="438175460"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Algorithmic%20complexity%20of%20List%20operations/near/438175460" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Algorithmic.20complexity.20of.20List.20operations.html#438175460">(May 12 2024 at 10:33)</a>:</h4>
<p>Get is 1<br>
slicing/sublist is 1</p>



<a name="438175750"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Algorithmic%20complexity%20of%20List%20operations/near/438175750" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Norbert Hajagos <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Algorithmic.20complexity.20of.20List.20operations.html#438175750">(May 12 2024 at 10:38)</a>:</h4>
<p>I haven't written any Zig, but I get why you would think that, glancing at the code you linked. </p>
<div class="codehilite" data-code-language="Zig"><pre><span></span><code><span class="kr">pub</span><span class="w"> </span><span class="k">fn</span><span class="w"> </span><span class="n">listAppendUnsafe</span><span class="p">(</span>
<span class="w">    </span><span class="n">list</span><span class="o">:</span><span class="w"> </span><span class="n">RocList</span><span class="p">,</span>
<span class="w">    </span><span class="n">element</span><span class="o">:</span><span class="w"> </span><span class="n">Opaque</span><span class="p">,</span>
<span class="w">    </span><span class="n">element_width</span><span class="o">:</span><span class="w"> </span><span class="kt">usize</span><span class="p">,</span>
<span class="p">)</span><span class="w"> </span><span class="n">callconv</span><span class="p">(.</span><span class="n">C</span><span class="p">)</span><span class="w"> </span><span class="n">RocList</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kr">const</span><span class="w"> </span><span class="n">old_length</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">list</span><span class="p">.</span><span class="n">len</span><span class="p">();</span>
<span class="w">    </span><span class="kr">var</span><span class="w"> </span><span class="n">output</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">list</span><span class="p">;</span>
<span class="w">    </span><span class="n">output</span><span class="p">.</span><span class="n">length</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">output</span><span class="p">.</span><span class="n">bytes</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="n">bytes</span><span class="o">|</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">element</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="n">source</span><span class="o">|</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="kr">const</span><span class="w"> </span><span class="n">target</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bytes</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">old_length</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">element_width</span><span class="p">;</span>
<span class="w">            </span><span class="nb">@memcpy</span><span class="p">(</span><span class="n">target</span><span class="p">[</span><span class="mi">0</span><span class="p">..</span><span class="n">element_width</span><span class="p">],</span><span class="w"> </span><span class="n">source</span><span class="p">[</span><span class="mi">0</span><span class="p">..</span><span class="n">element_width</span><span class="p">]);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">output</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<p>IIUC, the memcpy only copies 1 element-width worth of bytes into the list which has reserved space for it, not a whole list, even though I associate memcpy with copying big regions.</p>



<a name="438175902"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Algorithmic%20complexity%20of%20List%20operations/near/438175902" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Algorithmic.20complexity.20of.20List.20operations.html#438175902">(May 12 2024 at 10:41)</a>:</h4>
<p>Yep</p>



<a name="438175940"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Algorithmic%20complexity%20of%20List%20operations/near/438175940" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Algorithmic.20complexity.20of.20List.20operations.html#438175940">(May 12 2024 at 10:42)</a>:</h4>
<p>Though we actually should change this interface some for more perf....but that is a micro benchmark detail.</p>



<a name="438177757"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Algorithmic%20complexity%20of%20List%20operations/near/438177757" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Abhinav Sarkar <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Algorithmic.20complexity.20of.20List.20operations.html#438177757">(May 12 2024 at 11:15)</a>:</h4>
<p>Thanks. Is it possible to add this information to the docs?</p>



<a name="438189683"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Algorithmic%20complexity%20of%20List%20operations/near/438189683" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Norbert Hajagos <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Algorithmic.20complexity.20of.20List.20operations.html#438189683">(May 12 2024 at 14:49)</a>:</h4>
<p>I think it would be useful if the docs for the builtins would have information on Lists being represented as arrays that resize when needed, not linked lists. (This would imply having an O(1) append and O(n) prepend) . This would be useful, to someone coming from another functional language, since they likely assume the implementation to be a linked list, making their code have a lot of prepending. It could go to the begining of the docs, similarly how Str has a section on utf8 there.</p>



<a name="438189843"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Algorithmic%20complexity%20of%20List%20operations/near/438189843" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Abhinav Sarkar <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Algorithmic.20complexity.20of.20List.20operations.html#438189843">(May 12 2024 at 14:51)</a>:</h4>
<p>Is there a plan for a linked list data structure?</p>



<a name="438190188"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Algorithmic%20complexity%20of%20List%20operations/near/438190188" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Algorithmic.20complexity.20of.20List.20operations.html#438190188">(May 12 2024 at 14:56)</a>:</h4>
<p>Nope</p>



<a name="438190195"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Algorithmic%20complexity%20of%20List%20operations/near/438190195" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Algorithmic.20complexity.20of.20List.20operations.html#438190195">(May 12 2024 at 14:56)</a>:</h4>
<p>Though it is easy to make with tags</p>



<a name="438190217"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Algorithmic%20complexity%20of%20List%20operations/near/438190217" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Algorithmic.20complexity.20of.20List.20operations.html#438190217">(May 12 2024 at 14:57)</a>:</h4>
<p>Generally linked lists are quite bad for performance even when they win on time complexity.</p>



<a name="438190237"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Algorithmic%20complexity%20of%20List%20operations/near/438190237" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Algorithmic.20complexity.20of.20List.20operations.html#438190237">(May 12 2024 at 14:57)</a>:</h4>
<p>They are exceptional pessimistic on modern hardware unlike flat arrays</p>



<a name="438190255"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Algorithmic%20complexity%20of%20List%20operations/near/438190255" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Abhinav Sarkar <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Algorithmic.20complexity.20of.20List.20operations.html#438190255">(May 12 2024 at 14:57)</a>:</h4>
<p>Isn't O(n) prepend too slow for some cases?</p>



<a name="438190341"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Algorithmic%20complexity%20of%20List%20operations/near/438190341" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Algorithmic.20complexity.20of.20List.20operations.html#438190341">(May 12 2024 at 14:59)</a>:</h4>
<p>For sure. Though often the right answer isn't a linked list but some alternative solution built on flat arrays. Not saying never use linked lists, but often time with small to medium size lists, arrays are still way faster even with the O(n) prepend</p>



<a name="438190367"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Algorithmic%20complexity%20of%20List%20operations/near/438190367" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Algorithmic.20complexity.20of.20List.20operations.html#438190367">(May 12 2024 at 14:59)</a>:</h4>
<p>But highly depends on the exact use case</p>



<a name="438190395"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Algorithmic%20complexity%20of%20List%20operations/near/438190395" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Abhinav Sarkar <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Algorithmic.20complexity.20of.20List.20operations.html#438190395">(May 12 2024 at 15:00)</a>:</h4>
<p>Is Roc List boxed or unboxed?</p>



<a name="438190443"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Algorithmic%20complexity%20of%20List%20operations/near/438190443" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Abhinav Sarkar <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Algorithmic.20complexity.20of.20List.20operations.html#438190443">(May 12 2024 at 15:00)</a>:</h4>
<p>The docs do not mention anything</p>



<a name="438190781"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Algorithmic%20complexity%20of%20List%20operations/near/438190781" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Abhinav Sarkar <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Algorithmic.20complexity.20of.20List.20operations.html#438190781">(May 12 2024 at 15:05)</a>:</h4>
<p>Interestingly, in OCaml, list prepend is O(1) and append is O(n).</p>



<a name="438190798"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Algorithmic%20complexity%20of%20List%20operations/near/438190798" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Algorithmic.20complexity.20of.20List.20operations.html#438190798">(May 12 2024 at 15:05)</a>:</h4>
<p>Data in a list is stored on the heap.</p>



<a name="438190880"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Algorithmic%20complexity%20of%20List%20operations/near/438190880" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Norbert Hajagos <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Algorithmic.20complexity.20of.20List.20operations.html#438190880">(May 12 2024 at 15:06)</a>:</h4>
<p>The values of a list are Unboxed, but yeah, it is on the heap. They are like Rust / C++ vectors. As I understand, anything that can be not boxed isn't. So tuples, structs, closures, numbers. They are not boxed, just nicely sitting next to eachother in a list</p>



<a name="438190932"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Algorithmic%20complexity%20of%20List%20operations/near/438190932" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Algorithmic.20complexity.20of.20List.20operations.html#438190932">(May 12 2024 at 15:07)</a>:</h4>
<p>Ocaml uses a linked list so it has to scan the entire pointer chain across memory to reach the last element and append.</p>
<p>Roc is a contiguous block of memory and has to move all elements to prepend.</p>



<a name="438190934"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Algorithmic%20complexity%20of%20List%20operations/near/438190934" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Abhinav Sarkar <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Algorithmic.20complexity.20of.20List.20operations.html#438190934">(May 12 2024 at 15:07)</a>:</h4>
<p>That'll be another good thing to mention in the docs.</p>



<a name="438191041"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Algorithmic%20complexity%20of%20List%20operations/near/438191041" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Norbert Hajagos <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Algorithmic.20complexity.20of.20List.20operations.html#438191041">(May 12 2024 at 15:09)</a>:</h4>
<p>Even tag unions are on the stack, unboxed if they are not recursive (Like not defined as a Linked list such as <code>LinkedList a : [End, Node a]</code></p>



<a name="438191056"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Algorithmic%20complexity%20of%20List%20operations/near/438191056" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Norbert Hajagos <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Algorithmic.20complexity.20of.20List.20operations.html#438191056">(May 12 2024 at 15:09)</a>:</h4>
<p>Ups, not that</p>



<a name="438191175"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Algorithmic%20complexity%20of%20List%20operations/near/438191175" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Norbert Hajagos <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Algorithmic.20complexity.20of.20List.20operations.html#438191175">(May 12 2024 at 15:11)</a>:</h4>
<p>I think this would be the correct type alias <code>LinkedList a : [Nil, Cons a (LinkedList a)]</code></p>



<a name="438191332"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Algorithmic%20complexity%20of%20List%20operations/near/438191332" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Hristo <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Algorithmic.20complexity.20of.20List.20operations.html#438191332">(May 12 2024 at 15:14)</a>:</h4>
<p><span class="user-mention silent" data-user-id="343810">Brendan Hansknecht</span> <a href="#narrow/stream/231634-beginners/topic/Algorithmic.20complexity.20of.20List.20operations/near/438190932">said</a>:</p>
<blockquote>
<p>Ocaml uses a linked list so it has to scan the entire pointer chain across memory to reach the last element and append.</p>
</blockquote>
<p>Not an Ocaml-specific question, and also apologies if it may be going a tiny bit off-topic:</p>
<ul>
<li>Is there a good reason (besides memory savings, however tiny they might be in modern times) for not additionally storing a pointer to the end of the list in such implementations?</li>
</ul>



<a name="438191460"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Algorithmic%20complexity%20of%20List%20operations/near/438191460" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Algorithmic.20complexity.20of.20List.20operations.html#438191460">(May 12 2024 at 15:16)</a>:</h4>
<p>Really is only common with doubly linked lists where you can traverse in reverse. Just having the end is fine, but then someone will want end - 1 or end - 2. So it is only a partial patch. Generally better to just not store the end and educate users on how to properly use linked lists. Like what kinds of algorithm to avoid with them.</p>



<a name="438191507"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Algorithmic%20complexity%20of%20List%20operations/near/438191507" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Algorithmic.20complexity.20of.20List.20operations.html#438191507">(May 12 2024 at 15:17)</a>:</h4>
<p>That said, modern hardware really hates linked lists. So they generally are a bad idea unless you have an extreme or required use case.</p>



<a name="438191803"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Algorithmic%20complexity%20of%20List%20operations/near/438191803" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Abhinav Sarkar <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Algorithmic.20complexity.20of.20List.20operations.html#438191803">(May 12 2024 at 15:22)</a>:</h4>
<p>In absence of linked lists in Roc, what is the right way to write a recursive function that goes over a sequence of items and produces a sequence of zero or more items for each original item, and finally returns a flattened sequence containing all output items?</p>



<a name="438191874"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Algorithmic%20complexity%20of%20List%20operations/near/438191874" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Abhinav Sarkar <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Algorithmic.20complexity.20of.20List.20operations.html#438191874">(May 12 2024 at 15:23)</a>:</h4>
<p>With linked list, this would be O(n). With Roc lists, this would be O(n²).</p>



<a name="438192190"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Algorithmic%20complexity%20of%20List%20operations/near/438192190" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Algorithmic.20complexity.20of.20List.20operations.html#438192190">(May 12 2024 at 15:29)</a>:</h4>
<p>that's true in the worst case, yeah</p>



<a name="438192196"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Algorithmic%20complexity%20of%20List%20operations/near/438192196" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Algorithmic.20complexity.20of.20List.20operations.html#438192196">(May 12 2024 at 15:29)</a>:</h4>
<p>the bet is that the Roc version will also be faster in practice</p>



<a name="438192263"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Algorithmic%20complexity%20of%20List%20operations/near/438192263" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Algorithmic.20complexity.20of.20List.20operations.html#438192263">(May 12 2024 at 15:30)</a>:</h4>
<p>in other words, that it will have worse worst-case asymptotic performance but better runtime performance in practice, because reallocations won't be that common, and the cost of things like extra allocations and pointer chasing in the linked list will be more impactful in practice</p>



<a name="438192281"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Algorithmic%20complexity%20of%20List%20operations/near/438192281" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Algorithmic.20complexity.20of.20List.20operations.html#438192281">(May 12 2024 at 15:30)</a>:</h4>
<p>I wouldn't use recursion for that btw, I'd do it like this:</p>
<div class="codehilite" data-code-language="Elm"><pre><span></span><code><span class="nv">flatMap</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">List</span><span class="w"> </span><span class="nv">a</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="nv">a</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">List</span><span class="w"> </span><span class="nv">a</span><span class="p">)</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">List</span><span class="w"> </span><span class="nv">a</span>
<span class="nv">flatMap</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nf">\</span><span class="nv">items</span><span class="p">,</span><span class="w"> </span><span class="nv">fn</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">    </span><span class="kt">List</span><span class="nf">.</span><span class="nv">walk</span><span class="w"> </span><span class="nv">items</span><span class="w"> </span><span class="p">[]</span><span class="w"> </span><span class="nf">\</span><span class="nv">answer</span><span class="p">,</span><span class="w"> </span><span class="nv">item</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">        </span><span class="kt">List</span><span class="nf">.</span><span class="nv">concat</span><span class="w"> </span><span class="nv">answer</span><span class="w"> </span><span class="p">(</span><span class="nv">fn</span><span class="w"> </span><span class="nv">item</span><span class="p">)</span>
</code></pre></div>



<a name="438192323"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Algorithmic%20complexity%20of%20List%20operations/near/438192323" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Algorithmic.20complexity.20of.20List.20operations.html#438192323">(May 12 2024 at 15:31)</a>:</h4>
<p>I call it a bet because we can't really know until we've seen it in use in non-contrived programs <span aria-label="big smile" class="emoji emoji-1f604" role="img" title="big smile">:big_smile:</span></p>



<a name="438192375"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Algorithmic%20complexity%20of%20List%20operations/near/438192375" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Algorithmic.20complexity.20of.20List.20operations.html#438192375">(May 12 2024 at 15:32)</a>:</h4>
<p>so far the bet has been working out well I'd say!</p>



<a name="438192862"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Algorithmic%20complexity%20of%20List%20operations/near/438192862" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Algorithmic.20complexity.20of.20List.20operations.html#438192862">(May 12 2024 at 15:41)</a>:</h4>
<p>just to clarify, linked lists would be O(n) but <span aria-label="point up" class="emoji emoji-1f446" role="img" title="point up">:point_up:</span> this implementation (or a recursive one) would only be O(n²) in the worst case where every <code>List</code> that gets appended is so big that it requires a reallocation</p>



<a name="438192868"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Algorithmic%20complexity%20of%20List%20operations/near/438192868" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Algorithmic.20complexity.20of.20List.20operations.html#438192868">(May 12 2024 at 15:41)</a>:</h4>
<p>because the <code>answer</code> list will be mutated in-place</p>



<a name="438193103"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Algorithmic%20complexity%20of%20List%20operations/near/438193103" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Algorithmic.20complexity.20of.20List.20operations.html#438193103">(May 12 2024 at 15:45)</a>:</h4>
<p>in contrast, if the lists are small enough in practice that reallocations are rarely needed, then it's more like O(n + m) where n is the number of input elements and m is the number of elements in the <code>List</code> returned in the given function</p>



<a name="438193176"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Algorithmic%20complexity%20of%20List%20operations/near/438193176" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Algorithmic.20complexity.20of.20List.20operations.html#438193176">(May 12 2024 at 15:46)</a>:</h4>
<p>(and the same would be true of the linked list version)</p>



<a name="438193383"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Algorithmic%20complexity%20of%20List%20operations/near/438193383" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Algorithmic.20complexity.20of.20List.20operations.html#438193383">(May 12 2024 at 15:50)</a>:</h4>
<p>also worth noting that you could reduce the chances of reallocation by starting with a <code>List.withCapacity</code> instead of <code>[]</code></p>



<a name="438197564"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Algorithmic%20complexity%20of%20List%20operations/near/438197564" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Algorithmic.20complexity.20of.20List.20operations.html#438197564">(May 12 2024 at 17:00)</a>:</h4>
<p>Yeah using withCapacity, that is O(n) with no reallocations or extra data movement</p>



<a name="438197926"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Algorithmic%20complexity%20of%20List%20operations/near/438197926" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Algorithmic.20complexity.20of.20List.20operations.html#438197926">(May 12 2024 at 17:06)</a>:</h4>
<p>A linked list is O(n), but also requires n separate allocations. Calling malloc n times is essentially always bad.</p>



<a name="438208101"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Algorithmic%20complexity%20of%20List%20operations/near/438208101" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Hristo <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Algorithmic.20complexity.20of.20List.20operations.html#438208101">(May 12 2024 at 19:55)</a>:</h4>
<p><span class="user-mention silent" data-user-id="343810">Brendan Hansknecht</span> <a href="#narrow/stream/231634-beginners/topic/Algorithmic.20complexity.20of.20List.20operations/near/438191460">said</a>:</p>
<blockquote>
<p>Really is only common with doubly linked lists where you can traverse in reverse. Just having the end is fine, but then someone will want end - 1 or end - 2. So it is only a partial patch. Generally better to just not store the end and educate users on how to properly use linked lists. Like what kinds of algorithm to avoid with them.</p>
</blockquote>
<p>Apologies for not having been clear enough. I should've specified that I wasn't referring to doubly-linked lists.</p>
<p>I was referring to enabling append and prepend to both be <em>O(1)</em>. This is in the context of an arbitrary linked-list implementation (of a real-world programming language). I'd like to emphasise that I'm not proposing that Roc's <code>List</code>s become linked lists.</p>



<a name="438235345"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Algorithmic%20complexity%20of%20List%20operations/near/438235345" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Karakatiza <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Algorithmic.20complexity.20of.20List.20operations.html#438235345">(May 13 2024 at 03:17)</a>:</h4>
<p>Wondered the same today while trying to build an algorithm with lists.<br>
Not only big O time complexity is important to know, but also reallocations, and when they happen (e.g. does it happen when doing a sublist on a value that goes out of scope in a tail-end-recursive function?)</p>
<p>I tried to write a simple dirty CSV parser (not using roc-parser), and it's difficult to know what route to take to optimize without more information.</p>



<a name="438235852"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Algorithmic%20complexity%20of%20List%20operations/near/438235852" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Abhinav Sarkar <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Algorithmic.20complexity.20of.20List.20operations.html#438235852">(May 13 2024 at 03:23)</a>:</h4>
<p><span class="user-mention silent" data-user-id="654587">Karakatiza</span> <a href="#narrow/stream/231634-beginners/topic/Algorithmic.20complexity.20of.20List.20operations/near/438235345">said</a>:</p>
<blockquote>
<p>it's difficult to know what route to take to optimize without more information.</p>
</blockquote>
<p>I have the exact same problem.</p>



<a name="438249049"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Algorithmic%20complexity%20of%20List%20operations/near/438249049" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Algorithmic.20complexity.20of.20List.20operations.html#438249049">(May 13 2024 at 05:57)</a>:</h4>
<p>Yeah, we definitely want to build some tooling around this (and more docs), but it is still early days. We also have a number of optimizations that are not in yet that create very sharp edges.</p>



<a name="438249113"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Algorithmic%20complexity%20of%20List%20operations/near/438249113" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Algorithmic.20complexity.20of.20List.20operations.html#438249113">(May 13 2024 at 05:58)</a>:</h4>
<p>Currently the best way to learn is to chat here and share code.</p>



<a name="438249131"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Algorithmic%20complexity%20of%20List%20operations/near/438249131" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Algorithmic.20complexity.20of.20List.20operations.html#438249131">(May 13 2024 at 05:58)</a>:</h4>
<p>That and profile things</p>



<a name="438250178"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Algorithmic%20complexity%20of%20List%20operations/near/438250178" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Algorithmic.20complexity.20of.20List.20operations.html#438250178">(May 13 2024 at 06:05)</a>:</h4>
<p><span class="user-mention silent" data-user-id="693045">Hristo</span> <a href="#narrow/stream/231634-beginners/topic/Algorithmic.20complexity.20of.20List.20operations/near/438208101">said</a>:</p>
<blockquote>
<p>Apologies for not having been clear enough. I should've specified that I wasn't referring to doubly-linked lists.</p>
</blockquote>
<p>My reply wasn't clear enough either it seems (note, I added some extra context to the quotes in parens). Only the first sentence is about doubly linked lists:</p>
<blockquote>
<p>Really (a pointer to the end of a linked list list) is only common with doubly linked lists where you can traverse in reverse.</p>
</blockquote>
<p>The following sentences are about the common implementations of singly linked lists in many programming languages (especially ml related ones):</p>
<blockquote>
<p>Just having the end is fine, but then someone will want "end - 1" or "end - 2". So it is only a partial patch (to add a pointer to the end element). Generally better to just not store the end and educate users on how to properly use linked lists (append heavy algorithms are an anti pattern. Especially because they make it seem like patterning matching the end or otherwise accessing other tail elements should be fast, but only the very last element would be special). (Education should be on) what kinds of algorithms to avoid with them (most append heavy algorithms on linked lists should be reversed to be prepend heavy or have other tricks to avoid the costs).</p>
</blockquote>



<hr><p>Last updated: Mar 01 2026 at 12:20 UTC</p>
</html>