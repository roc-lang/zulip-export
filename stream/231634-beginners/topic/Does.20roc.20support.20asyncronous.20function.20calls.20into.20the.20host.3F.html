<html>
<head><meta charset="utf-8"><title>Does roc support asyncronous function calls into the host? · beginners · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/index.html">beginners</a></h2>
<h3>Topic: <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Does.20roc.20support.20asyncronous.20function.20calls.20into.20the.20host.3F.html">Does roc support asyncronous function calls into the host?</a></h3>

<hr>

<base href="https://roc.zulipchat.com">

<head><link href="https://roc-lang.github.io/zulip-export/style.css" rel="stylesheet"></head>

<a name="537990032"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Does%20roc%20support%20asyncronous%20function%20calls%20into%20the%20host%3F/near/537990032" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mainrs <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Does.20roc.20support.20asyncronous.20function.20calls.20into.20the.20host.3F.html#537990032">(Sep 06 2025 at 09:38)</a>:</h4>
<p>I had the idea of creating a web crawler platform 2y ago. At that time, there was no way for crawlers to call into the host in parallel. This can be useful while processing the response of a website. The crawler could ask the host to parse and fetch elements according to css or xpath selectors. This can be done using a list and map, but the call would happen synchronous on the host side. It would receive every map call one after the other.</p>
<p>There was discussion about Task.map2, but I've read the changelogs and couldn't find map2 nor Task in general. It seems that it has been removed. </p>
<p>Would be great if someone with a little bit more knowledge than me could quickly chime in and answer this. At least I couldn't find any references to async/await.</p>



<a name="537990376"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Does%20roc%20support%20asyncronous%20function%20calls%20into%20the%20host%3F/near/537990376" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Does.20roc.20support.20asyncronous.20function.20calls.20into.20the.20host.3F.html#537990376">(Sep 06 2025 at 09:44)</a>:</h4>
<p><span class="user-mention" data-user-id="281383">@Richard Feldman</span></p>



<a name="537996733"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Does%20roc%20support%20asyncronous%20function%20calls%20into%20the%20host%3F/near/537996733" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Does.20roc.20support.20asyncronous.20function.20calls.20into.20the.20host.3F.html#537996733">(Sep 06 2025 at 11:42)</a>:</h4>
<p>short answer is that this should be very ergonomic once the new compiler gets there! I have a WIP design doc for it. Can you remind me what some of the code would look like in a different language? I can translate it into what it'll look like in the upcoming design <span aria-label="smiley" class="emoji emoji-1f603" role="img" title="smiley">:smiley:</span></p>



<a name="538064314"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Does%20roc%20support%20asyncronous%20function%20calls%20into%20the%20host%3F/near/538064314" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mainrs <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Does.20roc.20support.20asyncronous.20function.20calls.20into.20the.20host.3F.html#538064314">(Sep 07 2025 at 09:00)</a>:</h4>
<p><span class="user-mention silent" data-user-id="281383">Richard Feldman</span> <a href="#narrow/channel/231634-beginners/topic/Does.20roc.20support.20asyncronous.20function.20calls.20into.20the.20host.3F/near/537996733">said</a>:</p>
<blockquote>
<p>[...]. Can you remind me what some of the code would look like in a different language? I can translate it into what it'll look like in the upcoming design <span aria-label="smiley" class="emoji emoji-1f603" role="img" title="smiley">:smiley:</span></p>
</blockquote>
<p>I am looking for two types of parallel processing. One would be async/await for I/O-heavy operations like file reading, networking etc.. </p>
<p>The other one would be parallel CPU intensive tasks, usually done on thread pools. In Rust, the first would be done using tokio, the second using rayon. </p>
<p>This is already possible in roc right now, but one has to sacrifice ergonomics for it. I can simply introduce platform-provided methods that take a list of arguments. And return a list of results. One can introduce custom types to bundle the arguments, but it makes working with the result types and arguments cumbersome in a functional way...</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="k">fn</span><span class="w"> </span><span class="nf">get_requests</span><span class="p">(</span><span class="n">urls</span><span class="p">:</span><span class="w"> </span><span class="nb">Vec</span><span class="o">&lt;</span><span class="nb">String</span><span class="o">&gt;</span><span class="p">,</span><span class="w"> </span><span class="n">bodies</span><span class="p">:</span><span class="w"> </span><span class="nb">Vec</span><span class="o">&lt;</span><span class="nb">Vec</span><span class="o">&lt;</span><span class="kt">u8</span><span class="o">&gt;&gt;</span><span class="p">,</span><span class="w">  </span><span class="n">headers</span><span class="p">:</span><span class="w"> </span><span class="o">....</span><span class="p">);</span>
<span class="k">fn</span><span class="w"> </span><span class="nf">process_xpath</span><span class="p">(</span><span class="n">requests</span><span class="p">:</span><span class="w"> </span><span class="nb">Vec</span><span class="o">&lt;</span><span class="n">Requests</span><span class="o">&gt;</span><span class="p">,</span><span class="w"> </span><span class="n">xpaths</span><span class="p">:</span><span class="w"> </span><span class="nb">Vec</span><span class="o">&lt;</span><span class="nb">String</span><span class="o">&gt;</span><span class="p">,</span><span class="w"> </span><span class="o">....</span><span class="p">);</span>
</code></pre></div>
<p>I think it would be nice to have the parallelism inside of roc itself instead of having to delegate it to the host.</p>



<a name="538078923"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Does%20roc%20support%20asyncronous%20function%20calls%20into%20the%20host%3F/near/538078923" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Does.20roc.20support.20asyncronous.20function.20calls.20into.20the.20host.3F.html#538078923">(Sep 07 2025 at 13:23)</a>:</h4>
<p>some hosts can't support parallelism, but my goal is to make it easy to say "these can run in any order" so that it will run in parallel if the host supports it</p>



<a name="538082562"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Does%20roc%20support%20asyncronous%20function%20calls%20into%20the%20host%3F/near/538082562" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mainrs <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Does.20roc.20support.20asyncronous.20function.20calls.20into.20the.20host.3F.html#538082562">(Sep 07 2025 at 14:15)</a>:</h4>
<p><span class="user-mention silent" data-user-id="281383">Richard Feldman</span> <a href="#narrow/channel/231634-beginners/topic/Does.20roc.20support.20asyncronous.20function.20calls.20into.20the.20host.3F/near/538078923">said</a>:</p>
<blockquote>
<p>some hosts can't support parallelism, but my goal is to make it easy to say "these can run in any order" so that it will run in parallel if the host supports it</p>
</blockquote>
<p>Thanks for letting me know! Are there any issues / resources I can keep an eye on to stay up-to-date? :)</p>



<a name="538083721"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Does%20roc%20support%20asyncronous%20function%20calls%20into%20the%20host%3F/near/538083721" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Does.20roc.20support.20asyncronous.20function.20calls.20into.20the.20host.3F.html#538083721">(Sep 07 2025 at 14:37)</a>:</h4>
<p>I still need to finish writing it up, but I'll definitely post about it once it's done!</p>



<a name="542687098"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Does%20roc%20support%20asyncronous%20function%20calls%20into%20the%20host%3F/near/542687098" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Krzysztof Skowronek <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Does.20roc.20support.20asyncronous.20function.20calls.20into.20the.20host.3F.html#542687098">(Oct 02 2025 at 08:46)</a>:</h4>
<p><span class="user-mention silent" data-user-id="281383">Richard Feldman</span> <a href="#narrow/channel/231634-beginners/topic/Does.20roc.20support.20asyncronous.20function.20calls.20into.20the.20host.3F/near/538078923">said</a>:</p>
<blockquote>
<p>some hosts can't support parallelism, but my goal is to make it easy to say "these can run in any order" so that it will run in parallel if the host supports it</p>
</blockquote>
<p>So it's going into the same direction as Zig and its IO async interface? </p>
<p>Meaning I would create a "runtime" (so some platforms would only offer a single threaded event loop) and use that runtime to run the standard set of async operations?</p>



<hr><p>Last updated: Nov 01 2025 at 12:13 UTC</p>
</html>