<html>
<head><meta charset="utf-8"><title>Any tips resolving this roc run error? · beginners · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/index.html">beginners</a></h2>
<h3>Topic: <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Any.20tips.20resolving.20this.20roc.20run.20error.3F.html">Any tips resolving this roc run error?</a></h3>

<hr>

<base href="https://roc.zulipchat.com">

<head><link href="https://roc-lang.github.io/zulip-export/style.css" rel="stylesheet"></head>

<a name="456681539"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Any%20tips%20resolving%20this%20roc%20run%20error%3F/near/456681539" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Vouga <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Any.20tips.20resolving.20this.20roc.20run.20error.3F.html#456681539">(Aug 05 2024 at 19:11)</a>:</h4>
<p>Hi all, I've been really enjoying using roc but I'm getting stuck on this error. Any tips would be appreciated.</p>
<p>Sms auth abstraction<br>
<a href="https://github.com/crvouga/moviefinder.app/blob/main/src/Auth/VerifySms.roc">https://github.com/crvouga/moviefinder.app/blob/main/src/Auth/VerifySms.roc</a></p>
<div class="codehilite" data-code-language="Haskell"><pre><span></span><code><span class="kr">module</span><span class="w"> </span><span class="err">[</span><span class="nn">VerifySms</span><span class="p">,</span><span class="w"> </span><span class="kt">SendCode</span><span class="p">,</span><span class="w"> </span><span class="kt">VerifyCode</span><span class="p">]</span>

<span class="kr">import</span><span class="w"> </span><span class="nn">pf.Task</span><span class="w"> </span><span class="n">exposing</span><span class="w"> </span><span class="p">[</span><span class="kt">Task</span><span class="p">]</span>
<span class="kr">import</span><span class="w"> </span><span class="nn">PhoneNumber</span><span class="w"> </span><span class="n">exposing</span><span class="w"> </span><span class="p">[</span><span class="kt">PhoneNumber</span><span class="p">]</span>

<span class="kt">SendCode</span><span class="w"> </span><span class="kt">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">phoneNumber</span><span class="w"> </span><span class="kt">:</span><span class="w"> </span><span class="kt">PhoneNumber</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="kt">Task</span><span class="w"> </span><span class="p">{}</span><span class="w"> </span><span class="kt">[]</span>

<span class="o">#</span><span class="w"> </span><span class="kt">Works</span>
<span class="kt">VerifyCode</span><span class="w"> </span><span class="kt">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">phoneNumber</span><span class="w"> </span><span class="kt">:</span><span class="w"> </span><span class="kt">PhoneNumber</span><span class="p">,</span><span class="w"> </span><span class="n">code</span><span class="w"> </span><span class="kt">:</span><span class="w"> </span><span class="kt">Str</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="kt">Task</span><span class="w"> </span><span class="p">{}</span><span class="w"> </span><span class="kt">[]</span>

<span class="o">#</span><span class="w"> </span><span class="n">roc</span><span class="w"> </span><span class="n">check</span><span class="w"> </span><span class="n">works</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="n">roc</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="n">errors</span>
<span class="o">#</span><span class="w"> </span><span class="kt">VerifyCode</span><span class="w"> </span><span class="kt">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">phoneNumber</span><span class="w"> </span><span class="kt">:</span><span class="w"> </span><span class="kt">PhoneNumber</span><span class="p">,</span><span class="w"> </span><span class="n">code</span><span class="w"> </span><span class="kt">:</span><span class="w"> </span><span class="kt">Str</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="kt">Task</span><span class="w"> </span><span class="p">{}</span><span class="w"> </span><span class="p">[</span><span class="kt">WrongCode</span><span class="p">]</span>

<span class="kt">VerifySms</span><span class="w"> </span><span class="kt">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">sendCode</span><span class="w"> </span><span class="kt">:</span><span class="w"> </span><span class="kt">SendCode</span><span class="p">,</span>
<span class="w">    </span><span class="n">verifyCode</span><span class="w"> </span><span class="kt">:</span><span class="w"> </span><span class="kt">VerifyCode</span><span class="p">,</span>
<span class="p">}</span>
</code></pre></div>
<p>Shared Ctx module for dependency injection<br>
<a href="https://github.com/crvouga/moviefinder.app/blob/main/src/Ctx.roc">https://github.com/crvouga/moviefinder.app/blob/main/src/Ctx.roc</a></p>
<div class="codehilite" data-code-language="Haskell"><pre><span></span><code><span class="kr">module</span><span class="w"> </span><span class="err">[</span><span class="nn">Ctx</span><span class="p">]</span>

<span class="kr">import</span><span class="w"> </span><span class="nn">Auth.VerifySms</span>
<span class="kr">import</span><span class="w"> </span><span class="nn">Media.MediaDb</span>
<span class="kr">import</span><span class="w"> </span><span class="nn">Logger</span>
<span class="kr">import</span><span class="w"> </span><span class="nn">Request</span>

<span class="kt">Ctx</span><span class="w"> </span><span class="kt">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">verifySms</span><span class="w"> </span><span class="kt">:</span><span class="w"> </span><span class="kt">Auth</span><span class="o">.</span><span class="kt">VerifySms</span><span class="o">.</span><span class="kt">VerifySms</span><span class="p">,</span>
<span class="w">    </span><span class="n">mediaDb</span><span class="w"> </span><span class="kt">:</span><span class="w"> </span><span class="kt">Media</span><span class="o">.</span><span class="kt">MediaDb</span><span class="o">.</span><span class="kt">MediaDb</span><span class="p">,</span>
<span class="w">    </span><span class="n">logger</span><span class="w"> </span><span class="kt">:</span><span class="w"> </span><span class="kt">Logger</span><span class="o">.</span><span class="kt">Logger</span><span class="p">,</span>
<span class="w">    </span><span class="n">req</span><span class="w"> </span><span class="kt">:</span><span class="w"> </span><span class="kt">Request</span><span class="o">.</span><span class="kt">Request</span><span class="p">,</span>
<span class="p">}</span>
</code></pre></div>
<p>Usage<br>
<a href="https://github.com/crvouga/moviefinder.app/blob/main/src/Auth/Login.roc#L35">https://github.com/crvouga/moviefinder.app/blob/main/src/Auth/Login.roc#L35</a></p>
<div class="codehilite" data-code-language="Haskell"><pre><span></span><code><span class="nf">clickedVerifyCode</span><span class="w"> </span><span class="kt">:</span><span class="w"> </span><span class="kt">Ctx</span><span class="o">.</span><span class="kt">Ctx</span><span class="p">,</span><span class="w"> </span><span class="kt">PhoneNumber</span><span class="o">.</span><span class="kt">PhoneNumber</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="kt">Task</span><span class="o">.</span><span class="kt">Task</span><span class="w"> </span><span class="kt">Response</span><span class="o">.</span><span class="kt">Response</span><span class="w"> </span><span class="kt">[]</span>
<span class="nf">clickedVerifyCode</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="nf">\</span><span class="n">ctx</span><span class="p">,</span><span class="w"> </span><span class="n">phoneNumber</span><span class="w"> </span><span class="ow">-&gt;</span>
<span class="w">    </span><span class="n">verifiedCode</span><span class="w"> </span><span class="ow">&lt;-</span><span class="w"> </span><span class="n">ctx</span><span class="o">.</span><span class="n">verifySms</span><span class="o">.</span><span class="n">verifyCode</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">phoneNumber</span><span class="p">,</span><span class="w"> </span><span class="n">code</span><span class="kt">:</span><span class="w"> </span><span class="s">"123"</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="kt">Task</span><span class="o">.</span><span class="n">attempt</span>

<span class="w">    </span><span class="n">when</span><span class="w"> </span><span class="n">verifiedCode</span><span class="w"> </span><span class="n">is</span>
<span class="w">        </span><span class="kt">Ok</span><span class="w"> </span><span class="kr">_</span><span class="w"> </span><span class="ow">-&gt;</span>
<span class="w">            </span><span class="kt">Login</span><span class="w"> </span><span class="kt">VerifiedCode</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="kt">Response</span><span class="o">.</span><span class="n">redirect</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="kt">Task</span><span class="o">.</span><span class="n">ok</span>

<span class="w">        </span><span class="kt">Err</span><span class="w"> </span><span class="kr">_</span><span class="w"> </span><span class="ow">-&gt;</span>
<span class="w">            </span><span class="p">(</span><span class="kt">Login</span><span class="w"> </span><span class="p">(</span><span class="kt">VerifyCode</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">phoneNumber</span><span class="p">,</span><span class="w"> </span><span class="ne">error</span><span class="kt">:</span><span class="w"> </span><span class="s">"Something went wrong"</span><span class="w"> </span><span class="p">}))</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="kt">Response</span><span class="o">.</span><span class="n">redirect</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="kt">Task</span><span class="o">.</span><span class="n">ok</span>
</code></pre></div>
<p>The problem is that when I change the type alias for VerifyCode from</p>
<div class="codehilite"><pre><span></span><code>VerifyCode : { phoneNumber : PhoneNumber, code : Str } -&gt; Task {} []
</code></pre></div>
<p>to</p>
<div class="codehilite"><pre><span></span><code>VerifyCode : { phoneNumber : PhoneNumber, code : Str } -&gt; Task {} [WrongCode]
</code></pre></div>
<p>I get this error when running the app.</p>
<div class="codehilite"><pre><span></span><code>thread &#39;main&#39; panicked at crates/compiler/gen_llvm/src/llvm/build.rs:5764:19:
Error in alias analysis: error in module ModName(&quot;UserApp&quot;), function definition FuncName(&quot;6\x00\x00\x00\x0c\x00\x00\x00*\x0c\xe1\x82i\x99\x93m&quot;): expected type &#39;union { ((),), ((),) }&#39;, found type &#39;()&#39;
note: run with `RUST_BACKTRACE=1` environment variable to display a backtrace
</code></pre></div>
<p>When I remove the usage of the ctx.verifySms.verifyCode function then this error goes away. I've tried a couple things like removing the dependency injection and adding more type annotations.</p>
<p>I'm sure I can get this to eventually work but does anyone have any tips to debug this or fix this? Thanks</p>
<p>Here's a link to the full code: <a href="https://github.com/crvouga/moviefinder.app">https://github.com/crvouga/moviefinder.app</a></p>



<a name="456698130"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Any%20tips%20resolving%20this%20roc%20run%20error%3F/near/456698130" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Any.20tips.20resolving.20this.20roc.20run.20error.3F.html#456698130">(Aug 05 2024 at 20:23)</a>:</h4>
<p>I've hit something similar recently, but don't have a fix/workaround.</p>



<a name="456698407"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Any%20tips%20resolving%20this%20roc%20run%20error%3F/near/456698407" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Any.20tips.20resolving.20this.20roc.20run.20error.3F.html#456698407">(Aug 05 2024 at 20:25)</a>:</h4>
<p>I think we have a type simplification bug. Cause, if I understand correctly, a union of empty tuples is the same thing as an empty tuple.</p>



<a name="456698473"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Any%20tips%20resolving%20this%20roc%20run%20error%3F/near/456698473" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Any.20tips.20resolving.20this.20roc.20run.20error.3F.html#456698473">(Aug 05 2024 at 20:25)</a>:</h4>
<p>So those types actually should be considered the same.</p>



<a name="456698848"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Any%20tips%20resolving%20this%20roc%20run%20error%3F/near/456698848" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Any.20tips.20resolving.20this.20roc.20run.20error.3F.html#456698848">(Aug 05 2024 at 20:26)</a>:</h4>
<p>Gives me an idea of something to test in the compiler for fixing, but I'm not sure I'll have access to try anything until at least Friday.</p>



<a name="456722289"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Any%20tips%20resolving%20this%20roc%20run%20error%3F/near/456722289" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Any.20tips.20resolving.20this.20roc.20run.20error.3F.html#456722289">(Aug 05 2024 at 22:48)</a>:</h4>
<p>Does adding a <code>_</code> after the return error type help?  </p>
<div class="codehilite"><pre><span></span><code>VerifyCode : { phoneNumber : PhoneNumber, code : Str } -&gt; Task {} [WrongCode]_
</code></pre></div>



<a name="456722442"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Any%20tips%20resolving%20this%20roc%20run%20error%3F/near/456722442" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Any.20tips.20resolving.20this.20roc.20run.20error.3F.html#456722442">(Aug 05 2024 at 22:50)</a>:</h4>
<p>It's not pretty, but maybe you could use just a <code>Str</code> as the error type.</p>



<a name="456722755"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Any%20tips%20resolving%20this%20roc%20run%20error%3F/near/456722755" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Any.20tips.20resolving.20this.20roc.20run.20error.3F.html#456722755">(Aug 05 2024 at 22:52)</a>:</h4>
<p>Or a <code>*</code> or an empty record <code>{}</code> as the error type</p>



<a name="456723194"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Any%20tips%20resolving%20this%20roc%20run%20error%3F/near/456723194" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Any.20tips.20resolving.20this.20roc.20run.20error.3F.html#456723194">(Aug 05 2024 at 22:56)</a>:</h4>
<p>Just some ideas to try different things. Ideally we could minimise and resolve the type bug.</p>



<a name="456733500"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Any%20tips%20resolving%20this%20roc%20run%20error%3F/near/456733500" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Vouga <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Any.20tips.20resolving.20this.20roc.20run.20error.3F.html#456733500">(Aug 06 2024 at 00:24)</a>:</h4>
<p><span class="user-mention" data-user-id="515757">@Luke Boswell</span> I've tried using <code>_</code>, <code>*</code>, <code>Str</code>, and <code>{}</code>. All (if I remember correctly) having the same or similar <br>
 error. I haven't tried <code>[WrongCode]_ </code> yet. I'll report back here if that works.  If all else fails I'll definitely  make minimal example</p>



<a name="457020446"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Any%20tips%20resolving%20this%20roc%20run%20error%3F/near/457020446" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Vouga <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Any.20tips.20resolving.20this.20roc.20run.20error.3F.html#457020446">(Aug 07 2024 at 06:23)</a>:</h4>
<p>I'm gonna be procrastinating on this bug for awhile while I'm buildin other things in the app. I'll be sure to post here if I solve it.</p>



<a name="459764788"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Any%20tips%20resolving%20this%20roc%20run%20error%3F/near/459764788" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Vouga <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Any.20tips.20resolving.20this.20roc.20run.20error.3F.html#459764788">(Aug 10 2024 at 21:37)</a>:</h4>
<p>I found what was causing the bug. It looks like roc wasn't liking calling function with a return type of <code>Task.Task {} *</code> in middle of the verifySms function after adding the WrongCode error.</p>
<p>So when the verifySms alias is <code>VerifyCode : { phoneNumber : PhoneNumber, code : Str } -&gt; Task {} [WrongCode]</code><br>
Removing these functions <code>Logger.info</code> and <code>Sleep.millis</code> within the verifySms implementation resolved the error.</p>
<p>When the verifySms alias is <code>VerifyCode : { phoneNumber : PhoneNumber, code : Str } -&gt; Task {} []</code> calling the <br>
<code>Logger.info</code> and <code>Sleep.millis</code> within the verifySms implementation works</p>
<p>VerifySms implementation:</p>
<div class="codehilite" data-code-language="Haskell"><pre><span></span><code><span class="kr">module</span><span class="w"> </span><span class="err">[</span><span class="nn">Config</span><span class="p">,</span><span class="w"> </span><span class="n">init</span><span class="p">]</span>

<span class="kr">import</span><span class="w"> </span><span class="nn">pf.Task</span><span class="w"> </span><span class="n">exposing</span><span class="w"> </span><span class="p">[</span><span class="kt">Task</span><span class="p">]</span>
<span class="kr">import</span><span class="w"> </span><span class="nn">pf.Sleep</span>
<span class="kr">import</span><span class="w"> </span><span class="nn">Logger</span>
<span class="kr">import</span><span class="w"> </span><span class="nn">PhoneNumber</span>
<span class="kr">import</span><span class="w"> </span><span class="nn">Auth.VerifySms</span>

<span class="kt">Config</span><span class="w"> </span><span class="kt">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">code</span><span class="w"> </span><span class="kt">:</span><span class="w"> </span><span class="kt">Str</span><span class="p">,</span>
<span class="w">    </span><span class="n">logger</span><span class="w"> </span><span class="kt">:</span><span class="w"> </span><span class="kt">Logger</span><span class="o">.</span><span class="kt">Logger</span><span class="p">,</span>
<span class="p">}</span>

<span class="nf">sendCode</span><span class="w"> </span><span class="kt">:</span><span class="w"> </span><span class="kt">Config</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="kt">Auth</span><span class="o">.</span><span class="kt">VerifySms</span><span class="o">.</span><span class="kt">SendCode</span>
<span class="nf">sendCode</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="nf">\</span><span class="n">config</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="nf">\</span><span class="p">{</span><span class="w"> </span><span class="n">phoneNumber</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="ow">-&gt;</span>
<span class="w">        </span><span class="kt">Logger</span><span class="o">.</span><span class="n">info</span><span class="o">!</span><span class="w"> </span><span class="n">config</span><span class="o">.</span><span class="n">logger</span><span class="w"> </span><span class="s">"Sending code $(config.code) to phone number $(PhoneNumber.toStr phoneNumber)"</span>
<span class="w">        </span><span class="kt">Sleep</span><span class="o">.</span><span class="n">millis</span><span class="o">!</span><span class="w"> </span><span class="mi">1000</span>
<span class="w">        </span><span class="kt">Task</span><span class="o">.</span><span class="n">ok</span><span class="w"> </span><span class="p">{}</span>

<span class="nf">verifyCode</span><span class="w"> </span><span class="kt">:</span><span class="w"> </span><span class="kt">Config</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="kt">Auth</span><span class="o">.</span><span class="kt">VerifySms</span><span class="o">.</span><span class="kt">VerifyCode</span>
<span class="nf">verifyCode</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="nf">\</span><span class="n">config</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="nf">\</span><span class="n">input</span><span class="w"> </span><span class="ow">-&gt;</span>
<span class="w">        </span><span class="o">#</span><span class="w"> </span><span class="kt">Commenting</span><span class="w"> </span><span class="n">out</span><span class="w"> </span><span class="n">these</span><span class="w"> </span><span class="n">two</span><span class="w"> </span><span class="n">lines</span><span class="w"> </span><span class="n">resolved</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="ne">error</span>
<span class="w">        </span><span class="o">#</span><span class="w"> </span><span class="kt">Logger</span><span class="o">.</span><span class="n">info</span><span class="o">!</span><span class="w"> </span><span class="n">config</span><span class="o">.</span><span class="n">logger</span><span class="w"> </span><span class="s">"Verifying code $(input.code) for phone number $(PhoneNumber.toStr input.phoneNumber)"</span>
<span class="w">        </span><span class="o">#</span><span class="w"> </span><span class="kt">Sleep</span><span class="o">.</span><span class="n">millis</span><span class="o">!</span><span class="w"> </span><span class="mi">1000</span>
<span class="w">        </span><span class="kr">if</span><span class="w"> </span><span class="n">input</span><span class="o">.</span><span class="n">code</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">config</span><span class="o">.</span><span class="n">code</span><span class="w"> </span><span class="kr">then</span>
<span class="w">            </span><span class="kt">Task</span><span class="o">.</span><span class="n">ok</span><span class="w"> </span><span class="p">{}</span>
<span class="w">        </span><span class="kr">else</span>
<span class="w">            </span><span class="kt">Task</span><span class="o">.</span><span class="n">ok</span><span class="w"> </span><span class="p">{}</span>

<span class="nf">init</span><span class="w"> </span><span class="kt">:</span><span class="w"> </span><span class="kt">Config</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="kt">Auth</span><span class="o">.</span><span class="kt">VerifySms</span><span class="o">.</span><span class="kt">VerifySms</span>
<span class="nf">init</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="nf">\</span><span class="n">config</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">sendCode</span><span class="kt">:</span><span class="w"> </span><span class="n">sendCode</span><span class="w"> </span><span class="n">config</span><span class="p">,</span>
<span class="w">    </span><span class="n">verifyCode</span><span class="kt">:</span><span class="w"> </span><span class="n">verifyCode</span><span class="w"> </span><span class="n">config</span><span class="p">,</span>
<span class="p">}</span>
</code></pre></div>



<hr><p>Last updated: Mar 01 2026 at 12:20 UTC</p>
</html>