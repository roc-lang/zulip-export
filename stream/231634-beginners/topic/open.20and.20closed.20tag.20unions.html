<html>
<head><meta charset="utf-8"><title>open and closed tag unions · beginners · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/index.html">beginners</a></h2>
<h3>Topic: <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html">open and closed tag unions</a></h3>

<hr>

<base href="https://roc.zulipchat.com">

<head><link href="https://roc-lang.github.io/zulip-export/style.css" rel="stylesheet"></head>

<a name="272773361"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272773361" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Loric Brevet <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272773361">(Feb 22 2022 at 08:39)</a>:</h4>
<p>Hey, this is my first message here, so first congrats for making Roc, I am having a really good time digging the project!</p>
<p>I however have some difficulties really grasping the difference between open and closed tag unions. If I send this piece of code to the REPL, I am expecting that the return type would be inferred to a closed tag as the pattern matching in the definition states all the possible return tags (and no "_"), but it infers an open tag instead. Is there a reason why?</p>
<div class="codehilite"><pre><span></span><code>» something = 0
…
… stoplightColor =
…     if something &gt; 0 then
…         Red
…     else if something == 0 then
…         Yellow
…     else
…         Green
…
… stoplightColor

Yellow : [ Green, Red, Yellow ]*
</code></pre></div>
<p>Thanks</p>



<a name="272776225"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272776225" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272776225">(Feb 22 2022 at 09:07)</a>:</h4>
<p>So I could be wrong cause I don't intimately know the details of tags, but to my understand this is an open tag union, because it could be other values. There is a chance your color tag might also have <code>Purple</code> or <code>Grey</code>, but that can't be inferred from your code sample. All because the result can only be 1 of 3 possible values does not mean a color must be one of those 3 possible values.</p>



<a name="272776370"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272776370" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272776370">(Feb 22 2022 at 09:09)</a>:</h4>
<p>If instead you were matching on a color like this:</p>
<div class="codehilite"><pre><span></span><code>when color is
    Red -&gt; #do something
    Yellow -&gt; #another thing
    Green -&gt; # last thing
</code></pre></div>
<p>That would limit to a closed union. In the <code>when</code> statement, you must deal with all the cases. Therefore, no other cases can exist in your color union</p>



<a name="272776581"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272776581" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272776581">(Feb 22 2022 at 09:11)</a>:</h4>
<p>Of course, you could just add:<br>
<code>stoplightColor : [ Green, Red, Yellow]</code><br>
and that would also tell the compiler the type and force it to be a closed union. (not sure if that works in the repl though)</p>



<a name="272785411"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272785411" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Loric Brevet <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272785411">(Feb 22 2022 at 10:40)</a>:</h4>
<p>Thanks for your help, I have tried to adapt my example to use a <code>when</code> <code>is</code>, but the inferred tag is also open.</p>
<div class="codehilite"><pre><span></span><code>» something = Positive
…
… stoplightColor =
…     when something is
…         Positive -&gt; Red
…         Negative -&gt; Yellow
…         Equal -&gt; Green
…
… stoplightColor

Red : [ Green, Red, Yellow ]*
</code></pre></div>
<p>Of course, if I change my implementation, there "could" be other tags introduced, but with that specific definition, I am not sure to understand why Roc does not report a closed tag union, as all the return values are explicited.</p>



<a name="272833086"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272833086" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272833086">(Feb 22 2022 at 16:58)</a>:</h4>
<p>So with that example if you look at the type of <code>something</code>, it should be a closed tag for <code>[ Positive, Negative, Equal ]</code>, but <code>stoplightColor</code> is still in the same situation as before. Since it is only a result of an expressions there is no guarantee those are all of the possible values. So it is still open. The big difference is being the result of a when vs being used as the variable being matched by the when.</p>



<a name="272841269"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272841269" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jan kili <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272841269">(Feb 22 2022 at 17:53)</a>:</h4>
<p>I've been using Roc for a few months now, and I still don't really understand open vs closed tag unions. I think that inferred openness is a default behavior in order to make a def more usable (by default) as an argument to a later function that accepts a superset of those tags.</p>



<a name="272841708"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272841708" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jan kili <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272841708">(Feb 22 2022 at 17:56)</a>:</h4>
<p>Essentially, I think closed tag unions <del>are kind of useless as currently implemented :/</del> are rarely preferable to open ones, for values that you're passing around (unless their implementation for function arguments is different than I remember) but I don't want to hijack this topic lol</p>



<a name="272843308"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272843308" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272843308">(Feb 22 2022 at 18:06)</a>:</h4>
<p>yeah I think I need to iterate on how to teach this; I don't think I've found a great way to teach it yet</p>



<a name="272843322"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272843322" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jan kili <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272843322">(Feb 22 2022 at 18:07)</a>:</h4>
<p>For example (building on your last example), if <code>stringify : [ Blue, Green, Red, Yellow ] -&gt; Str</code> then I think you can't do the function call <code>stringify stoplightColor</code> if stoplightColor was closed. However, you can do it since stoplightColor is open.</p>



<a name="272843379"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272843379" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272843379">(Feb 22 2022 at 18:07)</a>:</h4>
<p>so if we didn't have closed unions, we couldn't have exhaustiveness checking</p>



<a name="272843402"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272843402" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272843402">(Feb 22 2022 at 18:07)</a>:</h4>
<p>in other words, if we didn't have closed unions, all <code>when</code>s would need a <code>_ -&gt;</code> branch</p>



<a name="272843646"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272843646" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jan kili <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272843646">(Feb 22 2022 at 18:09)</a>:</h4>
<p><span class="user-mention" data-user-id="281383">@Richard Feldman</span> In <span class="user-mention" data-user-id="479004">@Loric Brevet</span>'s last example, why is <code>stoplightColor</code> inferred to be open?</p>



<a name="272843832"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272843832" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272843832">(Feb 22 2022 at 18:11)</a>:</h4>
<p>one way to think of the answer to that question:</p>



<a name="272843850"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272843850" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272843850">(Feb 22 2022 at 18:11)</a>:</h4>
<p>if I wrote <code>stoplightColor = Red</code>, then it would be open</p>



<a name="272843915"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272843915" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jan kili <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272843915">(Feb 22 2022 at 18:11)</a>:</h4>
<p>(yeah, good reduction, that confuses me equally haha)</p>



<a name="272843963"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272843963" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272843963">(Feb 22 2022 at 18:12)</a>:</h4>
<p>if I write <code>stoplightColor =</code> and then either <code>Red</code> or <code>Green</code>, then both <code>Red</code> and <code>Green</code> are open, so no matter what, I'm still assigning it to an open union</p>



<a name="272844101"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272844101" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272844101">(Feb 22 2022 at 18:13)</a>:</h4>
<p>also, if I wrote this:</p>
<div class="codehilite"><pre><span></span><code>stoplightColor =
    when something is
        Positive -&gt;
            closedRed : [ Red ]
            closedRed = Red

            closedRed

        Negative -&gt; Yellow
        Equal -&gt; Green
</code></pre></div>



<a name="272844123"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272844123" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272844123">(Feb 22 2022 at 18:13)</a>:</h4>
<p>I'd get a type mismatch</p>



<a name="272844147"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272844147" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272844147">(Feb 22 2022 at 18:13)</a>:</h4>
<p>because closed unions can't grow (they're closed!)</p>



<a name="272844176"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272844176" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272844176">(Feb 22 2022 at 18:13)</a>:</h4>
<p>and all branches of a conditional have to be type-compatible</p>



<a name="272844250"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272844250" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272844250">(Feb 22 2022 at 18:14)</a>:</h4>
<p>so when you have multiple branches of a conditional that are all open unions, it's ok - they all union together to be a bigger open union</p>



<a name="272844266"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272844266" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272844266">(Feb 22 2022 at 18:14)</a>:</h4>
<p>but if any branch is a closed union, then all branches have to be exactly that closed union</p>



<a name="272844272"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272844272" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272844272">(Feb 22 2022 at 18:14)</a>:</h4>
<p>otherwise type mismatch</p>



<a name="272844277"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272844277" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jan kili <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272844277">(Feb 22 2022 at 18:14)</a>:</h4>
<p>(dang, going into dentist, this is more fun, bye)</p>



<a name="272847089"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272847089" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tommy Graves <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272847089">(Feb 22 2022 at 18:33)</a>:</h4>
<p>I think what doesn't make sense is that a function which takes a closed record can't accept an open record, but a function that takes a closed tag union can seemingly accept an open tag union value, right?</p>
<p>Intuitively if I have a value of type <code>[Red]*</code> that means it could be <code>Red</code> or it could be any other tag at all. So how can I pass that into a function which takes <code>[Red]</code> -- if my value is <code>Blue</code> then it's incompatible with <code>[Red]</code>! Somehow this compiles:</p>
<div class="codehilite"><pre><span></span><code>main =
  f : [Red] -&gt; Str
  f = \a -&gt;
    when a is
      Red -&gt; &quot;something&quot;

  x = Red

  f x
</code></pre></div>
<p>even though x is an open union?</p>
<p>In my head the explanation is "the compiler knows <code>x</code> is only ever Red even though its type is an open union" but I'm not sure what other parts of the type system work this way -- where just from looking at the types I can give an example where exhaustiveness checking would fail, but from looking at the actual implementation I know that can't happen?</p>



<a name="272847514"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272847514" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272847514">(Feb 22 2022 at 18:36)</a>:</h4>
<p>yeah, I wonder if the name "open union" is part of the problem <span aria-label="thinking" class="emoji emoji-1f914" role="img" title="thinking">:thinking:</span></p>



<a name="272847533"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272847533" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272847533">(Feb 22 2022 at 18:36)</a>:</h4>
<p>I wonder if there's a better name that might help</p>



<a name="272847650"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272847650" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272847650">(Feb 22 2022 at 18:37)</a>:</h4>
<p>like really the way the system works is that it has some very nice properties:</p>
<ul>
<li>soundness</li>
<li>complete (decidable, principal) type inference</li>
<li>compiles very fast</li>
<li>open unions compose in a nice way with errors in particular</li>
</ul>



<a name="272847763"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272847763" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272847763">(Feb 22 2022 at 18:38)</a>:</h4>
<p>but the way it has those nice properties requires this concept that doesn't seem to map neatly onto something that appears elsewhere in programming</p>



<a name="272847808"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272847808" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272847808">(Feb 22 2022 at 18:38)</a>:</h4>
<p>there's no "open unions are basically like ______" because they're not basically like anything I can think of <span aria-label="sweat smile" class="emoji emoji-1f605" role="img" title="sweat smile">:sweat_smile:</span></p>



<a name="272847843"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272847843" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272847843">(Feb 22 2022 at 18:38)</a>:</h4>
<p>they're a unique concept, as far as I'm aware</p>



<a name="272847901"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272847901" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272847901">(Feb 22 2022 at 18:39)</a>:</h4>
<p>I have this feeling that there's a good way to teach them that gives a good intuition for how they work - I'm just not sure what that is yet! <span aria-label="big smile" class="emoji emoji-1f604" role="img" title="big smile">:big_smile:</span></p>



<a name="272848354"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272848354" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tommy Graves <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272848354">(Feb 22 2022 at 18:42)</a>:</h4>
<p>The good news is that <em>what</em> happens is actually intuitive (looking from the code snippet I gave before, I think it would be very surprising if it did not compile!). It's just when you actually inspect the type of a value that it gets confusing. I wonder if the type for <code>x</code> when <code>x = Red</code> should be displayed or formatted differently than <code>[ Red ]*</code> -- it's almost like there are three concepts (closed tag union, open tag union as a type annotation for a function parameter, and open tag union as the type of a value)</p>



<a name="272848951"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272848951" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272848951">(Feb 22 2022 at 18:47)</a>:</h4>
<p>yeah as long as you don't include any type annotations or talk about types, everything feels intuitive <span aria-label="laughing" class="emoji emoji-1f606" role="img" title="laughing">:laughing:</span></p>



<a name="272849051"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272849051" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272849051">(Feb 22 2022 at 18:48)</a>:</h4>
<p>which, to be fair, is another nice property of the system!</p>



<a name="272849159"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272849159" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jan kili <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272849159">(Feb 22 2022 at 18:49)</a>:</h4>
<p>I return with clean teeth to find my own views expressed better than I could express them! Wonderful.</p>



<a name="272849331"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272849331" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jan kili <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272849331">(Feb 22 2022 at 18:50)</a>:</h4>
<p>I also don't get what "growing" means in the context of "closed can't grow"</p>



<a name="272849399"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272849399" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tommy Graves <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272849399">(Feb 22 2022 at 18:51)</a>:</h4>
<p>Yeah, I think words like "grow"and "accumulate" are tricky to understand in a language without mutation</p>



<a name="272849717"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272849717" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272849717">(Feb 22 2022 at 18:53)</a>:</h4>
<p>hrm yeah, what I mean is that the union can't combine with other unions</p>



<a name="272849844"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272849844" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272849844">(Feb 22 2022 at 18:54)</a>:</h4>
<p>like how in that conditional we have the tag unions <code>[ Red ]*</code>,  <code>[ Yellow ]*</code> and <code>[ Green ]*</code>, and because they're each used in a different branch of the conditional, they combine to make the entire conditional be <code>[ Red, Yellow, Green ]*</code></p>



<a name="272849864"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272849864" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272849864">(Feb 22 2022 at 18:54)</a>:</h4>
<p>but closed unions in conditionals don't do that, they just give type mismatches</p>



<a name="272850653"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272850653" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jan kili <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272850653">(Feb 22 2022 at 18:59)</a>:</h4>
<p>I think we should reimagine the syntax and terminology from a script author's perspective, since it currently feels oriented toward compiler developers</p>



<a name="272851122"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272851122" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jan kili <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272851122">(Feb 22 2022 at 19:02)</a>:</h4>
<p>For example, maybe we'd find that the open/closed distinction is not useful in scripts, and then we could just let it be an under-the-hood compiler inferencing/checking implementation detail</p>



<a name="272851330"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272851330" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jan kili <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272851330">(Feb 22 2022 at 19:03)</a>:</h4>
<p>What problems in developer space were the concepts/features around open/closed tag unions created to solve?</p>



<a name="272853513"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272853513" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272853513">(Feb 22 2022 at 19:19)</a>:</h4>
<p>Yeah, from a user perspective, I feel like they are something like "restricted" and "expandable" unions.</p>



<a name="272853597"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272853597" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272853597">(Feb 22 2022 at 19:20)</a>:</h4>
<p>One with a restricted list of exact values, the other that could expand to contain anything.</p>



<a name="272853963"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272853963" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Emi <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272853963">(Feb 22 2022 at 19:22)</a>:</h4>
<p>exhaustive / nonexhaustive might work too, which is similar to language Rust uses for marking enums?</p>



<a name="272858140"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272858140" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jan kili <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272858140">(Feb 22 2022 at 19:56)</a>:</h4>
<p>(Should we move this reimagination discussion to another topic? Perhaps there is a parallel how-to discussion to be had here.)</p>



<a name="272858341"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272858341" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272858341">(Feb 22 2022 at 19:58)</a>:</h4>
<p>I think it's fine to discuss here <span aria-label="shrug" class="emoji emoji-1f937" role="img" title="shrug">:shrug:</span></p>



<a name="272858369"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272858369" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272858369">(Feb 22 2022 at 19:58)</a>:</h4>
<p><span class="user-mention silent" data-user-id="462053">JanCVanB</span> <a href="#narrow/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions/near/272851122">said</a>:</p>
<blockquote>
<p>maybe we'd find that the open/closed distinction is not useful in scripts, and then we could just let it be an under-the-hood compiler inferencing/checking implementation detail</p>
</blockquote>
<p>we talked about this at some point, and I don't think it really works</p>



<a name="272858385"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272858385" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272858385">(Feb 22 2022 at 19:58)</a>:</h4>
<p>or at least, not the way we'd been talking about it</p>



<a name="272858450"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272858450" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272858450">(Feb 22 2022 at 19:59)</a>:</h4>
<p>there has to be a type variable there - that's really important</p>



<a name="272858460"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272858460" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272858460">(Feb 22 2022 at 19:59)</a>:</h4>
<p>and sometimes it's not <code>*</code></p>



<a name="272858471"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272858471" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272858471">(Feb 22 2022 at 19:59)</a>:</h4>
<p>(although to be fair, that's pretty rare)</p>



<a name="272858548"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272858548" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272858548">(Feb 22 2022 at 19:59)</a>:</h4>
<p>I don't think we should have language syntax or semantics vary by platform</p>



<a name="272858640"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272858640" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272858640">(Feb 22 2022 at 20:00)</a>:</h4>
<p>Haskell has per-project syntax/semantics and it's a big pain point in the ecosystem</p>



<a name="272859122"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272859122" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272859122">(Feb 22 2022 at 20:03)</a>:</h4>
<p>one problem with hiding it syntactically in the type - that is, making there be no observable distinction between the type signature of an open or closed tag union, except in the specific and rare case that there has to be a named type variable - is that you'd sometimes get surprising type mismatches</p>



<a name="272859178"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272859178" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jan kili <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272859178">(Feb 22 2022 at 20:04)</a>:</h4>
<p>Observations:</p>
<ul>
<li>Tags are great</li>
<li>Writing <code>_ -&gt; ...</code> in every <code>when</code> could be annoying or noisy (sometimes illogical?)</li>
<li><code>_ -&gt; ...</code> requires "openness" as it's currently called</li>
</ul>



<a name="272859231"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272859231" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272859231">(Feb 22 2022 at 20:04)</a>:</h4>
<p>like a type rendered as <code>[ A, B, C ]</code> would sometimes be type-compatible with another type rendered as <code>[ A, B ]</code> and other times not, depending on whether they were secretly open or closed under the hood</p>



<a name="272859257"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272859257" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272859257">(Feb 22 2022 at 20:04)</a>:</h4>
<p>that seems like it would be less confusing when it works, but <em>super</em> confusing when it didn't work</p>



<a name="272859349"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272859349" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272859349">(Feb 22 2022 at 20:05)</a>:</h4>
<p><code>_ -&gt; ...</code> isn't just noisy and sometimes illogical, but also having it means you lose out on a great feature of tags</p>



<a name="272859371"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272859371" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272859371">(Feb 22 2022 at 20:05)</a>:</h4>
<p>namely that if you add a new tag, you get type mismatches everywhere you need to account for it</p>



<a name="272859451"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272859451" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272859451">(Feb 22 2022 at 20:06)</a>:</h4>
<p>that's a wonderful feature, and if you had <code>_ -&gt;</code> everywhere, you wouldn't get that</p>



<a name="272859600"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272859600" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jan kili <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272859600">(Feb 22 2022 at 20:07)</a>:</h4>
<p>Could removing <code>_ -&gt; ...</code> from Roc actually be a good thing?</p>



<a name="272860068"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272860068" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272860068">(Feb 22 2022 at 20:11)</a>:</h4>
<p>good luck matching on all the integers  exhaustively</p>



<a name="272860082"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272860082" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272860082">(Feb 22 2022 at 20:11)</a>:</h4>
<p>or worse, strings</p>



<a name="272860166"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272860166" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tommy Graves <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272860166">(Feb 22 2022 at 20:12)</a>:</h4>
<p>I was toying around with alternative type renderings, like:<br>
for a parameter's type signature, display it as <code>[ A, B, _ ]</code> instead of <code>[ A, B ]*</code><br>
for a value's type, render it as <code>[ A, B ]+</code> instead of <code>[ A, B ]*</code></p>
<p>Those obscure that the * is a type variable, though, which I suppose is probably relevant?</p>



<a name="272860255"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272860255" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tommy Graves <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272860255">(Feb 22 2022 at 20:13)</a>:</h4>
<p><code>[ A, B, _ ]</code> has some intriguing value to me because it matches how you would pattern match the options but I'm not sure it actually helps with the conceptual problem we are talking about</p>



<a name="272860393"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272860393" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jan kili <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272860393">(Feb 22 2022 at 20:14)</a>:</h4>
<p><span class="user-mention" data-user-id="281543">@Folkert de Vries</span> </p>
<blockquote>
<p>Could removing <code>_ -&gt; ...</code> from Roc actually be a good thing?</p>
</blockquote>
<p>... for tags only? Idk if that's possible...</p>



<a name="272860508"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272860508" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272860508">(Feb 22 2022 at 20:15)</a>:</h4>
<p>in theory, but in practice that will just be very annoying I think. Having a catch-all is very convenient</p>



<a name="272865124"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272865124" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jan kili <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272865124">(Feb 22 2022 at 20:55)</a>:</h4>
<p>New observation: <code>_ -&gt; ...</code> in a tag-parsing <code>when</code> block only requires "openness" if the tag union isn't otherwise constrained.<br>
Example of using a catch-all without requiring "openness":</p>
<div class="codehilite" data-code-language="Haskell"><pre><span></span><code><span class="nf">light</span><span class="w"> </span><span class="kt">:</span><span class="w"> </span><span class="p">[</span><span class="kt">Red</span><span class="p">,</span><span class="w"> </span><span class="kt">Yellow</span><span class="p">,</span><span class="w"> </span><span class="kt">Green</span><span class="p">]</span><span class="w"></span>
<span class="nf">when</span><span class="w"> </span><span class="n">light</span><span class="w"> </span><span class="n">is</span><span class="w"></span>
<span class="w">    </span><span class="kt">Red</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">    </span><span class="kr">_</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="mi">2</span><span class="w"></span>
</code></pre></div>



<a name="272865288"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272865288" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jan kili <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272865288">(Feb 22 2022 at 20:56)</a>:</h4>
<p>What if using a tag catch-all for an unconstrained tag type was disallowed? Are there any use cases that would be hindered by that?</p>



<a name="272866268"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272866268" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jan kili <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272866268">(Feb 22 2022 at 21:01)</a>:</h4>
<div class="codehilite"><pre><span></span><code>lightParser = \light -&gt;
    when light is
        Green -&gt; &quot;good&quot;
        _ -&gt; &quot;oh no&quot;
lightParser Yellow
</code></pre></div>
<p><code>Error: Unconstrained Tag Union: lightParser must have an annotation or drop its catch-all case.</code><br>
This might make sense to me as a developer, but I it would be a blemish on Roc's stellar type inference claims :/</p>



<a name="272866410"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272866410" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jan kili <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272866410">(Feb 22 2022 at 21:02)</a>:</h4>
<p>I want something to change, but I'll stop prematurely jumping to solutions now <span aria-label="stuck out tongue wink" class="emoji emoji-1f61c" role="img" title="stuck out tongue wink">:stuck_out_tongue_wink:</span></p>



<a name="272867644"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272867644" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272867644">(Feb 22 2022 at 21:13)</a>:</h4>
<p>honestly, I don't think removing catch-all would help here</p>



<a name="272867697"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272867697" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272867697">(Feb 22 2022 at 21:13)</a>:</h4>
<p>whether or not there's a catch-all branch, it's still the case that we very much want (and indeed need) it to be possible to return different tags from different branches of a conditional</p>



<a name="272867719"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272867719" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272867719">(Feb 22 2022 at 21:13)</a>:</h4>
<p>for example, this has to work:</p>
<div class="codehilite"><pre><span></span><code>if blah then
    True
else
    False
</code></pre></div>



<a name="272867792"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272867792" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272867792">(Feb 22 2022 at 21:14)</a>:</h4>
<p><code>else</code> has the same semantics as <code>_ -&gt;</code> in <code>when</code>, and obviously we're not removing <code>else</code> <span aria-label="big smile" class="emoji emoji-1f604" role="img" title="big smile">:big_smile:</span></p>



<a name="272867818"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272867818" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272867818">(Feb 22 2022 at 21:14)</a>:</h4>
<p>for that conditional to work, it has to be possible to have different tags in different branches</p>



<a name="272867833"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272867833" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272867833">(Feb 22 2022 at 21:14)</a>:</h4>
<p>which in turn means those can't be inferred as <code>[ True ]</code> and <code>[ False ]</code></p>



<a name="272867840"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272867840" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272867840">(Feb 22 2022 at 21:14)</a>:</h4>
<p>or else that would be a type mismatch</p>



<a name="272868844"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272868844" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nicholas Cahill <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272868844">(Feb 22 2022 at 21:25)</a>:</h4>
<p>I still feel kind of confused by this, in terms of types. It feels like [ Red ]* is treated like a subtype of [ Red ] and [ Red, Green ] while working out what returns from a branching statement, but we're telling the compiler to pretend [ Red ] isn't a subtype of [ Red, Green ] when trying to figure out what the return type of a branching thing is?</p>



<a name="272869179"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272869179" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jan kili <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272869179">(Feb 22 2022 at 21:28)</a>:</h4>
<p>Here's a weird train of thought, coming from someone who doesn't know type theory, set theory, category theory, or FP:</p>
<ul>
<li>A type is a quantized space of possible values.</li>
<li>A value is a point in its type's space.</li>
<li>The <code>I8</code> type is a 1-dimensional finite space of possible <code>I8</code> values.</li>
<li>An <code>I8</code> value is a point in <code>I8</code> space.</li>
<li>A <code>p2 : { x : I8, y : I8 }</code> type is a 2-dimensional finite space of possible <code>p2</code> values.</li>
<li>A <code>p2</code> value is a point in <code>p2</code> space.</li>
<li>The <code>Str</code> type is a 1-dimensional infinite space of possible <code>Str</code> values.</li>
<li>An <code>Str</code> value is a point in <code>Str</code> space.</li>
<li>The tag type is a 1-dimensional infinite space of possible tag values.</li>
<li>A tag value is a point in tag space.</li>
<li>An open tag union is a 1-dimensional infinite discontinuous subspace of tag space?</li>
<li>A closed tag union is a 1-dimensional finite discontinuous subspace of tag space?</li>
<li>These type mismatches are a result of it being impossible/irresponsible (for some reason) to union non-identical finite subspaces?</li>
<li>The tag type is the only type with subspaces, and confusion about open/closed is actually just confusion about subspaces?<br>
<em>Alternatively, records and tags are a special "super-"/"meta-" type/space, and the aforementioned subtypes/subspaces are just normal types/spaces? My brain is hitting a theory wall... <span aria-label="stuck out tongue" class="emoji emoji-1f61b" role="img" title="stuck out tongue">:stuck_out_tongue:</span></em></li>
</ul>



<a name="272870336"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272870336" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nicholas Cahill <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272870336">(Feb 22 2022 at 21:39)</a>:</h4>
<p>Also the idea that I can pass a [ Red ]* value to a function that needs [ Red ]</p>



<a name="272873174"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272873174" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272873174">(Feb 22 2022 at 22:06)</a>:</h4>
<p>thinking of this as subtyping is misleading I think. Our types work with unification, basically the idea that 2 types are the same if I can substitute variables in the one type to get to the other type</p>



<a name="272873212"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272873212" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272873212">(Feb 22 2022 at 22:06)</a>:</h4>
<p>so in the case of <code>[ Red ]*</code>, I can substitute <code>* = []</code> to get to <code>[ Red ]</code></p>



<a name="272873233"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272873233" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272873233">(Feb 22 2022 at 22:07)</a>:</h4>
<p>but in the case of <code>[ Red ]</code>, there are no substitutions I can make to turn that into <code>[ Red, Green ]</code></p>



<a name="272876182"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272876182" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272876182">(Feb 22 2022 at 22:32)</a>:</h4>
<p>yeah the way the compiler works is: whenever more than one type needs to get "unified" into a single type (for example, the types of each branch of a conditional must get unified into a single type, because the conditional expression as a whole needs to have a single type), there are rules for how unification works</p>



<a name="272876244"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272876244" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272876244">(Feb 22 2022 at 22:33)</a>:</h4>
<p>one of the rules is that if an open tag union unifies with another open tag union, you get a new open tag union containing all the tags of both</p>



<a name="272876323"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272876323" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272876323">(Feb 22 2022 at 22:34)</a>:</h4>
<p>another of the rules is that if a closed tag union unifies with a closed tag union, they must have identical type mismatch or else unification fails (which is what we call a type mismatch)</p>



<a name="272876420"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272876420" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272876420">(Feb 22 2022 at 22:35)</a>:</h4>
<p>and one last rule is that whenever an open union and a closed union unify together, if the closed union contains all the tags in the open union, then they unify to the closed union...but if the open union has any tags the closed union doesn't have, then unification fails and it's a type mismatch</p>



<a name="272876460"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272876460" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272876460">(Feb 22 2022 at 22:35)</a>:</h4>
<p>so those are the rules</p>



<a name="272876482"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272876482" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272876482">(Feb 22 2022 at 22:35)</a>:</h4>
<p>the question is, is there a better way to explain them than just to lay them out like that?</p>



<a name="272876498"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272876498" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272876498">(Feb 22 2022 at 22:35)</a>:</h4>
<p>(maybe there isn't!)</p>



<a name="272877295"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272877295" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jan kili <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272877295">(Feb 22 2022 at 22:43)</a>:</h4>
<p>Wow, those are super direct+clear explanations, which greatly help my understanding of the system implementation. Thanks, F&amp;R!</p>



<a name="272877496"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272877496" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jan kili <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272877496">(Feb 22 2022 at 22:46)</a>:</h4>
<p>I think a lot of the confusion around tag unions, therefore, boils down to dissatisfaction with the unifier's level of pessimism/caution - for example, why can't two different closed tag unions be unified as a union of the two? The "uni-" (unify, union, union) vocabulary also reinforces that expectation.</p>



<a name="272878254"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272878254" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272878254">(Feb 22 2022 at 22:54)</a>:</h4>
<p>unification has a precise technical meaning here. If you can give me a substitution, then 2 types are "equal up to unification" which for us means they have an equivalent type</p>



<a name="272878285"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272878285" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272878285">(Feb 22 2022 at 22:54)</a>:</h4>
<p>there is just no substitution to give between <code>[ Red ]</code> and <code>[ Red, Green ]</code> because there are no variables to even substitute</p>



<a name="272878365"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272878365" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jan kili <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272878365">(Feb 22 2022 at 22:55)</a>:</h4>
<p>I imagine that union-y/optimistic unification might a be a bad thing to do in some situations? I feel like this pessimistic unification is shifting some kind of complexity onto developers, leading them to make every tag union open, for fear of mismatches. If that's a good practice, then we should make it a syntactically (and terminologically) simpler choice.</p>



<a name="272878488"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272878488" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272878488">(Feb 22 2022 at 22:56)</a>:</h4>
<p>there is no real thought or value judgement in these rules: this is just how the formalism works. It's a bit like why 1 + 1 is not 11. That's just not what <code>+</code> does, even though it has its own logic</p>



<a name="272878697"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272878697" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jan kili <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272878697">(Feb 22 2022 at 22:58)</a>:</h4>
<p>We might be talking past each other here: I'm sure that tag unions are implemented in a theoretically sound manner with respect to compilers and type systems, but to Roc app developers they are marketed as a tool for domain modeling. They don't work as expected for domain modeling.</p>



<a name="272878868"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272878868" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272878868">(Feb 22 2022 at 22:59)</a>:</h4>
<p>sure, it's just that any system you come up with ultimately should work within this framework of substitutions</p>



<a name="272879035"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272879035" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272879035">(Feb 22 2022 at 23:00)</a>:</h4>
<p>also a more restrictive version of this (sum types) seems to work fine in elm/haskell/ocaml/...</p>



<a name="272879072"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272879072" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272879072">(Feb 22 2022 at 23:01)</a>:</h4>
<p>we already provide a bunch more  flexibility</p>



<a name="272879293"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272879293" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272879293">(Feb 22 2022 at 23:03)</a>:</h4>
<p>I feel like with domain modeling you essentially always want closed unions. You are trying to capture all of the possibilities of each piece of your domain. As such, to merge two unions, you have to make a wrapper union</p>
<div class="codehilite"><pre><span></span><code>A : [ Foo, Bar ]
B : [ Baz, Bump ]
AorB : [ SomeA A, SomeB B ]
</code></pre></div>
<p>That would be merging A and B. It wouldn't make sense to do it otherwise.</p>



<a name="272879344"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272879344" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272879344">(Feb 22 2022 at 23:04)</a>:</h4>
<p>I don't think you want the super union of <code>AB : [ Foo, Bar Baz, Bump ]</code></p>



<a name="272879398"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272879398" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272879398">(Feb 22 2022 at 23:04)</a>:</h4>
<p>That elides information about the orginal unions they came from.</p>



<a name="272879461"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272879461" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272879461">(Feb 22 2022 at 23:05)</a>:</h4>
<p>right, and if that is what you want then you can write the functions to make it happen</p>



<a name="272880114"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272880114" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jan kili <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272880114">(Feb 22 2022 at 23:12)</a>:</h4>
<p>What should be done here? (Genuinely asking, as I'm still learning DDD.)</p>
<div class="codehilite"><pre><span></span><code>Animal : [ Cat, Dog, Lion, Tiger ]
Pet : [ Cat, Dog ]
breed : Animal, Animal -&gt; List Animal
dog1 : [ Dog ]
dog2 : [ Dog ]
</code></pre></div>
<p>I want to do <code>puppies = breed dog1 dog2</code>, but I think that would generate a type mismatch because Pet can't be unified with Animal.</p>



<a name="272880267"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272880267" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272880267">(Feb 22 2022 at 23:14)</a>:</h4>
<p>yes</p>



<a name="272880274"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272880274" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272880274">(Feb 22 2022 at 23:14)</a>:</h4>
<p>you're trying to do subtyping</p>



<a name="272880276"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272880276" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272880276">(Feb 22 2022 at 23:14)</a>:</h4>
<p>why?</p>



<a name="272880330"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272880330" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272880330">(Feb 22 2022 at 23:15)</a>:</h4>
<p>One option:</p>
<div class="codehilite"><pre><span></span><code>Animal : [ Pet Pet, Wild Wild ]
Pet : [ Cat, Dog ]
Wild : [ Lion, Tiger ]
</code></pre></div>
<p>Another :</p>
<div class="codehilite"><pre><span></span><code>Animal : [ Cat, Dog, Lion, Tiger ]
isPet : Animal -&gt; Bool
</code></pre></div>



<a name="272880563"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272880563" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272880563">(Feb 22 2022 at 23:18)</a>:</h4>
<p>Specifically, for the function:</p>
<div class="codehilite"><pre><span></span><code>dog1 : Animal
dog1  = Pet (Dog &quot;whatever properties&quot;)
</code></pre></div>
<p>Then with the  breed you would just match on the union. It will fail on an animal type mismatch. Returning a result with an error</p>



<a name="272880608"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272880608" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272880608">(Feb 22 2022 at 23:19)</a>:</h4>
<p>for a bit more context: this example looks exactly like the sort of thing you'd as the first example of class hierarchies in object-oriented programming and coming from the FP tradition that just does not make sense to me</p>



<a name="272880736"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272880736" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272880736">(Feb 22 2022 at 23:20)</a>:</h4>
<p>That's 100% true, but we still have to enable a way to model it. That model may 100% throw out the hierarchy or do thing very different, but if someone wants to solve a problem like this, there still needs to be a solution.</p>



<a name="272880930"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272880930" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272880930">(Feb 22 2022 at 23:22)</a>:</h4>
<p>yeah but then my question is what the shared behavior actually is here</p>



<a name="272881493"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272881493" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jan kili <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272881493">(Feb 22 2022 at 23:29)</a>:</h4>
<p>Side note, I'm unsure how to proceed because:</p>
<ol>
<li>I accidentally picked an OOP-like example, but my real point was that I think it's weird that tag functions reject inputs for being too-specific</li>
<li>I want to learn FP and ditch my problematic OOP tendencies</li>
<li>I want Roc to be welcoming to emigrants from OOP</li>
</ol>
<p><span aria-label="laughing" class="emoji emoji-1f606" role="img" title="laughing">:laughing:</span> <span aria-label="shrug" class="emoji emoji-1f937" role="img" title="shrug">:shrug:</span></p>



<a name="272882864"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272882864" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272882864">(Feb 22 2022 at 23:44)</a>:</h4>
<p>I guess my question is why is <code>dog1</code> a <code>[ Dog ]</code> in your example? Just make it a <code>[ Dog ]*</code> or <code>Animal</code> and everything  works.</p>



<a name="272883033"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272883033" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272883033">(Feb 22 2022 at 23:46)</a>:</h4>
<p>Also, I am totally for trying to take a few full baked OOP examples and then trying to convert them into idiomatic Roc. That would probably be a good mini tutorial repo.</p>



<a name="272889004"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272889004" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jan kili <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272889004">(Feb 23 2022 at 00:57)</a>:</h4>
<p><span class="user-mention" data-user-id="343810">@Brendan Hansknecht</span></p>
<blockquote>
<p>I guess my question is why is <code>dog1</code> a <code>[ Dog ]</code> in your example? Just make it a <code>[ Dog ]*</code> or <code>Animal</code> and everything  works.</p>
</blockquote>
<p>In the context of domain modeling, is it always best to use closed tag unions for all type aliases and open tag unions for all value annotations? It seems that way, to maximize flexibility.</p>



<a name="272889176"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272889176" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272889176">(Feb 23 2022 at 00:59)</a>:</h4>
<p>I'd hesitate to say "always" whenever it comes to domain modeling, but off the top of my head I can't think of a situation where it would be a good idea to use an open tag union for domain modeling <span aria-label="thinking" class="emoji emoji-1f914" role="img" title="thinking">:thinking:</span></p>



<a name="272889238"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272889238" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272889238">(Feb 23 2022 at 01:00)</a>:</h4>
<p>that said, I think it's fine to annotate values as closed unions if you know that's how they're going to be used</p>



<a name="272889334"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272889334" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272889334">(Feb 23 2022 at 01:00)</a>:</h4>
<p>for example, I think annotating something as <code>Bool</code> (which is a type alias for <code>[ True, False ]</code>) is better than annotating it as <code>[ True ]*</code> even if that's technically more flexible <span aria-label="big smile" class="emoji emoji-1f604" role="img" title="big smile">:big_smile:</span></p>



<a name="272889357"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272889357" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272889357">(Feb 23 2022 at 01:01)</a>:</h4>
<p>I mean, let's be honest - you know that <code>[ True ]*</code> is gonna end up as a <code>Bool</code></p>



<a name="272889372"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272889372" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272889372">(Feb 23 2022 at 01:01)</a>:</h4>
<p>and if it doesn't, it's because I made a mistake and I'd rather the compiler told me about it!</p>



<a name="272894293"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272894293" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nicholas Cahill <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272894293">(Feb 23 2022 at 01:48)</a>:</h4>
<p>Okay yeah; I think describing these things as tag unions made me _really_ want to think of them as union types</p>



<a name="272894972"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272894972" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272894972">(Feb 23 2022 at 01:58)</a>:</h4>
<p>Are they somehow not union types? I am not sure I understand the comment. Can you define union types?</p>



<a name="272895219"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272895219" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jan kili <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272895219">(Feb 23 2022 at 02:00)</a>:</h4>
<p>They're unions with extra rules: closed unions can't be unioned further, and open unions are somewhat infinite</p>



<a name="272895255"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272895255" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nicholas Cahill <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272895255">(Feb 23 2022 at 02:01)</a>:</h4>
<p>A union type is a type that has its union members as subtypes, so you get variances in values and function constraints from them.</p>



<a name="272895373"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272895373" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jan kili <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272895373">(Feb 23 2022 at 02:02)</a>:</h4>
<p>Should the takeaway for app developers be "in your tag types, delete this asterisk to get stricter type checking by disallowing passage to more-general-purpose functions"? If so, maybe they should be renamed like this</p>
<ul>
<li>"open tag union" --&gt; "tag set" or "tag subset" or "tag subdomain"... to communicate their unionability and that their handlers can handle other things, too</li>
<li>"closed tag union" --&gt; "strict tag set" or "final/total tag set" or "tag domain"... to communicate their un-unionability and that their handlers must explicitly handle all of their (and only their) cases</li>
</ul>
<p>A complementary syntax change for <code>[ A, B, C ]*</code> / <code>[ A, B, C ]</code> might be <code>[ A, B, C ]</code> / <code>[[ A, B, C ]]</code> or <code>( A, B, C )</code> / <code>[ A, B, C ]</code>, to make the former simpler &amp; gentler. (This ignores <code>[ A, B ]c</code> because I don't grasp its intuitions yet.)</p>



<a name="272895530"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272895530" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nicholas Cahill <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272895530">(Feb 23 2022 at 02:05)</a>:</h4>
<p>Like, Result = [ Ok Str, Err Str ] isn't a union of an Ok type and an Err type. Conceptually anyway. It's just its own type, and Ok Str isn't a subtype of it</p>



<a name="272895628"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272895628" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nicholas Cahill <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272895628">(Feb 23 2022 at 02:07)</a>:</h4>
<p>Like when I say Ok "okay okay", I didn't instantiate an Ok, I instantiated a Result</p>



<a name="272895724"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272895724" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ayaz Hafiz <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272895724">(Feb 23 2022 at 02:08)</a>:</h4>
<p>It might be helpful to not try to think in terms of subtyping, because there is no subtyping in Roc</p>



<a name="272895752"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272895752" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272895752">(Feb 23 2022 at 02:09)</a>:</h4>
<p>Ok, so I get the result comment.<br>
What is an example of a proper union type?</p>



<a name="272897096"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272897096" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nicholas Cahill <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272897096">(Feb 23 2022 at 02:30)</a>:</h4>
<p>Let's see. So if I was writing Elixir, I could do something like</p>
<div class="codehilite" data-code-language="Elixir"><pre><span></span><code><span class="kd">def</span><span class="w"> </span><span class="n">magnitude</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">is_number</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="k">do</span><span class="w"></span>
<span class="w">   </span><span class="n">x</span><span class="w"></span>
<span class="k">end</span><span class="w"></span>
<span class="kd">def</span><span class="w"> </span><span class="n">magnitude</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">is_string</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="k">do</span><span class="w"></span>
<span class="w">   </span><span class="nc">String</span><span class="o">.</span><span class="n">length</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"></span>
<span class="k">end</span><span class="w"></span>
</code></pre></div>
<p>Then magnitude is a function that can take a string or an integer, no tags or anything like that.</p>



<a name="272897107"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272897107" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nicholas Cahill <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272897107">(Feb 23 2022 at 02:30)</a>:</h4>
<p>I really need to learn how to make things look nicer in Zulip...</p>



<a name="272897167"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272897167" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jan kili <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272897167">(Feb 23 2022 at 02:31)</a>:</h4>
<p>Replace these single-quotes with backticks:</p>
<div class="codehilite"><pre><span></span><code>&#39;&#39;&#39;
code
&#39;&#39;&#39;
</code></pre></div>



<a name="272897378"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272897378" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272897378">(Feb 23 2022 at 02:34)</a>:</h4>
<p>You also can add the language name after the first set of backticks to get syntax highlighting if the language is supported.</p>



<a name="272897415"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272897415" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272897415">(Feb 23 2022 at 02:35)</a>:</h4>
<p>And interesting example, that would have never crossed my mind as a union at all. More like an interesting for of overloading a function. But I guess my background in unions come from c/c++ and rust.</p>



<a name="272897484"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272897484" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272897484">(Feb 23 2022 at 02:36)</a>:</h4>
<p>I think the name "tag set" is interesting <span aria-label="thinking" class="emoji emoji-1f914" role="img" title="thinking">:thinking:</span></p>



<a name="272897491"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272897491" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nicholas Cahill <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272897491">(Feb 23 2022 at 02:36)</a>:</h4>
<p>Using these tagged types, it might look more like this:</p>
<div class="codehilite" data-code-language="Elixir"><pre><span></span><code><span class="kd">def</span><span class="w"> </span><span class="n">magnitude</span><span class="p">({</span><span class="ss">:int</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="k">do</span><span class="w"></span>
<span class="w">    </span><span class="n">i</span><span class="w"></span>
<span class="k">end</span><span class="w"></span>
<span class="kd">def</span><span class="w"> </span><span class="n">magnitude</span><span class="p">({</span><span class="ss">:string</span><span class="p">,</span><span class="w"> </span><span class="n">s</span><span class="p">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="k">do</span><span class="w"></span>
<span class="w">    </span><span class="nc">String</span><span class="o">.</span><span class="n">length</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="w"></span>
<span class="k">end</span><span class="w"></span>
</code></pre></div>
<p>This input type would be something like [Int Int, String String]</p>



<a name="272897500"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272897500" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nicholas Cahill <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272897500">(Feb 23 2022 at 02:37)</a>:</h4>
<p>Oh yeah, knowing how to format stuff rules</p>



<a name="272897605"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272897605" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nicholas Cahill <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272897605">(Feb 23 2022 at 02:39)</a>:</h4>
<p>That example isn't quite perfect either, you'd want to use a struct to make it pickier</p>



<a name="272897615"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272897615" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272897615">(Feb 23 2022 at 02:39)</a>:</h4>
<p>Yeah, and in roc, it would be something like:</p>
<div class="codehilite" data-code-language="CoffeeScript"><pre><span></span><code><span class="nv">magnitude : </span><span class="p">[</span> <span class="nx">Int</span> <span class="nx">I64</span><span class="p">,</span> <span class="nx">Str</span> <span class="nx">Str</span> <span class="p">]</span> <span class="nf">-&gt;</span> <span class="nx">I64</span>
<span class="nv">magnitude = </span><span class="err">\</span><span class="nx">x</span> <span class="nf">-&gt;</span>
    <span class="k">when</span> <span class="nx">x</span> <span class="o">is</span>
        <span class="nx">Int</span> <span class="nx">i</span> <span class="nf">-&gt;</span> <span class="nx">i</span>
        <span class="nx">Str</span> <span class="nx">s</span> <span class="nf">-&gt;</span> <span class="nx">Str</span><span class="p">.</span><span class="nx">len</span> <span class="nx">s</span>
</code></pre></div>



<a name="272897620"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272897620" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272897620">(Feb 23 2022 at 02:40)</a>:</h4>
<p>(incidentally, the reason they're called "tag unions" is in large part because in memory they are <a href="https://en.wikipedia.org/wiki/Tagged_union">tagged unions</a>)</p>



<a name="272897705"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272897705" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272897705">(Feb 23 2022 at 02:41)</a>:</h4>
<p>Definitely quite different from how the first example would actually compile and work, but similar to your second example, just with a single function and a match.</p>



<a name="272898352"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272898352" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nicholas Cahill <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272898352">(Feb 23 2022 at 02:52)</a>:</h4>
<p>Yeah. That Elixir example is maybe a bad one because it still IS kind of a union. I think in most languages you're forced to give something like [ Int I64, Str Str] a name and reference that name when instantiating it, so it's clearer that it doesn't necessarily have anything to do (in terms of not having any kind of subtype/supertype relationship ) with [ Int I64, Str Str, Bool Bool ]</p>



<a name="272898516"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/272898516" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nicholas Cahill <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#272898516">(Feb 23 2022 at 02:55)</a>:</h4>
<p>Like a Rust Result has Ok and Err in it, but Ok and Err don't mean anything outside of the context of Result. They're really Result::Ok and Result::Err</p>



<a name="273078515"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/273078515" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Johannes Maas <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#273078515">(Feb 24 2022 at 11:47)</a>:</h4>
<p>I get the feeling that there is a more defined question lurking beneath this discussion. I think it might be "open to whom?"</p>
<p>When returning tags from a function or a conditional, I know that no one can add additional tags. So while all the tags I use should combine, the result is a closed union.</p>
<p>When I use a tag union, I need to know if I am seeing all possible tags. If I own all the code, I'm good. What the compiler sees is all there is. But if I am exposing a function, I need to decide whether people can only use the tags I specified or whether I allow them to use additional ones.</p>
<p>So maybe there is some useful line to draw for internal and exposed types?</p>



<a name="273103783"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/273103783" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Loric Brevet <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#273103783">(Feb 24 2022 at 15:27)</a>:</h4>
<p>In the use case of a function, from a developer's point of view, I feel that we can also think differently depending on inputs/outputs.</p>
<p>To me, and as a true beginner in Roc (this topic was the first message I posted on Zulip after having dug Roc for a few days), I can see two different definitions of open/closed for inputs and outputs.</p>
<p>For inputs, it is rather understandable for someone new to the language.</p>
<p>Inputs of a function:</p>
<ul>
<li>A closed tag union means that the function only accepts a predefined (closed) set of tags and nothing else.</li>
<li>An open tag union means the function may accept more tags, and so it provides a "_" to handle a tag that does not belong to the expected ones.</li>
</ul>
<p>From what I read from this discussion, the way it works for outputs is more because of the implementation details. The compiler has to have a type that combines all the possible tags of a pattern matching, and this results in an open tag union. So the difference between a returned open tag union and a closed tag union is more difficult to understand out of the box.</p>
<p>If I try to define them.</p>
<p>Outputs of a function:</p>
<ul>
<li>A returned closed tag union represents the entire set of tags that the function can return (easy).</li>
<li>An returned open tag union is ??? It seems it also represents the entire set of tags that the function can return, but in a way that it can be expanded later on in the program?</li>
</ul>
<p>To me, this is the last one that is hard to comprehend easily.</p>



<a name="273104315"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/273104315" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#273104315">(Feb 24 2022 at 15:30)</a>:</h4>
<p>right its a tag union with at least the tags that this function can return, but others can add to it</p>



<a name="273104332"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/273104332" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#273104332">(Feb 24 2022 at 15:30)</a>:</h4>
<p>this happens often when dealing with errors</p>



<a name="273104387"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/273104387" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#273104387">(Feb 24 2022 at 15:31)</a>:</h4>
<p>a particular function can only return (say) 3 different errors, but then you combine it with another function that can return 2 different ones</p>



<a name="273107473"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/273107473" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Johannes Maas <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#273107473">(Feb 24 2022 at 15:52)</a>:</h4>
<p>Loric phrased it better than I did: Does it help to automatically manage the openness of outputs and only bother the developer with that for inputs?</p>



<a name="273107662"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/273107662" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Loric Brevet <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#273107662">(Feb 24 2022 at 15:53)</a>:</h4>
<p>This example for errors makes sense.</p>
<p>But on that occasion, wouldn’t it be better to have a type alias that aliases to the full set of available errors (so a closed tag union), so that the function can return this specifically?</p>
<div class="codehilite"><pre><span></span><code>HttpError : [ NotFound, BadGateway, Unauthorized ]

toHttpError : [ NothingHere, NotAuthenticated ]* -&gt; HttpError
toHttpError = \err -&gt;
    when err is
        NothingHere -&gt; NotFound
        NotAuthenticated -&gt; Unauthorized
        _ -&gt; NotFound
</code></pre></div>
<p>If <code>toHttpError</code> would not be annotated, the compiler would still infer that to <code>[ NotFound, Unauthorized ]*</code>, but from a design perspective, annotating with the alias could make more sense?</p>



<a name="273108086"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/273108086" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Johannes Maas <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#273108086">(Feb 24 2022 at 15:56)</a>:</h4>
<p>I think the advantage of open tag unions is that it is quite bothersome to manage that alias. In Rust I tend to have to create many different error types and adding a new error variant is tedious.</p>
<p>In that case implicitly declaring the variants using an open union is much more ergonomic without an obvious downside.</p>



<a name="273108250"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/273108250" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Johannes Maas <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#273108250">(Feb 24 2022 at 15:57)</a>:</h4>
<p>I'm wondering, what is a use case for accepting an open union in e. g. a function? Why would I want to handle external variants?</p>



<a name="273111994"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/273111994" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jan kili <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#273111994">(Feb 24 2022 at 16:21)</a>:</h4>
<p>I'm wondering the same thing. <del>Having a catch-all case (<code>_ -&gt;</code>) for tags requires that function accepting an open tag union, and this pattern is prevalent in the tutorial:</del></p>
<div class="codehilite" data-code-language="Haskell"><pre><span></span><code><span class="nf">stoplightStr</span><span class="w"> </span><span class="ow">=</span><span class="w"></span>
<span class="w">    </span><span class="n">when</span><span class="w"> </span><span class="n">stoplightColor</span><span class="w"> </span><span class="n">is</span><span class="w"></span>
<span class="w">        </span><span class="kt">Red</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="s">"red"</span><span class="w"></span>
<span class="w">        </span><span class="kr">_</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="s">"not red"</span><span class="w"></span>
</code></pre></div>



<a name="273112155"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/273112155" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jan kili <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#273112155">(Feb 24 2022 at 16:22)</a>:</h4>
<p><del>However, is this an anti-pattern? What are some real-world use cases where this convenience/flexibility leads to better code than explicitly handling every tag in the union?</del></p>



<a name="273112240"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/273112240" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jan kili <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#273112240">(Feb 24 2022 at 16:23)</a>:</h4>
<p>I started to come up with an example:</p>
<div class="codehilite" data-code-language="Haskell"><pre><span></span><code><span class="nf">format</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="nf">\</span><span class="ne">error</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"></span>
<span class="w">    </span><span class="n">when</span><span class="w"> </span><span class="ne">error</span><span class="w"> </span><span class="n">is</span><span class="w"></span>
<span class="w">        </span><span class="kt">Unauthorized</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">code</span><span class="kt">:</span><span class="w"> </span><span class="mi">401</span><span class="p">,</span><span class="w"> </span><span class="n">message</span><span class="kt">:</span><span class="w"> </span><span class="s">"Unauthorized"</span><span class="w"> </span><span class="p">}</span><span class="w"></span>
<span class="w">        </span><span class="kt">NotFound</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">code</span><span class="kt">:</span><span class="w"> </span><span class="mi">404</span><span class="p">,</span><span class="w"> </span><span class="n">message</span><span class="kt">:</span><span class="w"> </span><span class="s">"Not Found"</span><span class="w"> </span><span class="p">}</span><span class="w"></span>
<span class="w">        </span><span class="kt">BadGateway</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">code</span><span class="kt">:</span><span class="w"> </span><span class="mi">502</span><span class="p">,</span><span class="w"> </span><span class="n">message</span><span class="kt">:</span><span class="w"> </span><span class="s">"Bad Gateway"</span><span class="w"> </span><span class="p">}</span><span class="w"></span>
<span class="w">        </span><span class="kr">_</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">code</span><span class="kt">:</span><span class="w"> </span><span class="mi">500</span><span class="p">,</span><span class="w"> </span><span class="n">message</span><span class="kt">:</span><span class="w"> </span><span class="s">"Internal Server Error"</span><span class="w"> </span><span class="p">}</span><span class="w"></span>
</code></pre></div>
<p>but I don't see how this code wouldn't benefit from the addition of an <code>InternalServerError</code> or <code>Other</code> tag.</p>



<a name="273112347"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/273112347" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jan kili <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#273112347">(Feb 24 2022 at 16:24)</a>:</h4>
<p>Especially since handling multiple cases is concise:</p>
<div class="codehilite" data-code-language="Haskell"><pre><span></span><code><span class="nf">stoplightStr</span><span class="w"> </span><span class="ow">=</span><span class="w"></span>
<span class="w">    </span><span class="n">when</span><span class="w"> </span><span class="n">stoplightColor</span><span class="w"> </span><span class="n">is</span><span class="w"></span>
<span class="w">        </span><span class="kt">Red</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="s">"red"</span><span class="w"></span>
<span class="w">        </span><span class="kt">Yellow</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="kt">Green</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="s">"not red"</span><span class="w"></span>
</code></pre></div>



<a name="273112865"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/273112865" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jan kili <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#273112865">(Feb 24 2022 at 16:27)</a>:</h4>
<p>Actually, the catch-all case doesn't require open tag union input, nevermind:</p>
<div class="codehilite" data-code-language="Pan"><pre><span></span><code>»<span class="w"> </span>f<span class="w"> </span>:<span class="w"> </span><span class="o">[</span><span class="w"> </span>A,<span class="w"> </span>B,<span class="w"> </span>C<span class="w"> </span><span class="o">]</span><span class="w"> </span>-&gt;<span class="w"> </span>Str<span class="w"></span>
…<span class="w"> </span><span class="nv">f</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="se">\t</span><span class="w"> </span>-&gt;<span class="w"></span>
…<span class="w">     </span>when<span class="w"> </span>t<span class="w"> </span>is<span class="w"></span>
…<span class="w">         </span>A<span class="w"> </span>-&gt;<span class="w"> </span><span class="s2">"a"</span><span class="w"></span>
…<span class="w">         </span>_<span class="w"> </span>-&gt;<span class="w"> </span><span class="s2">"x"</span><span class="w"></span>
…<span class="w"> </span><span class="o">{</span><span class="w"> </span>a:<span class="w"> </span>f<span class="w"> </span>A,<span class="w"> </span>b:<span class="w"> </span>f<span class="w"> </span>B,<span class="w"> </span>c:<span class="w"> </span>f<span class="w"> </span>C<span class="w"> </span><span class="o">}</span><span class="w"></span>

<span class="o">{</span><span class="w"> </span>a:<span class="w"> </span><span class="s2">"a"</span>,<span class="w"> </span>b:<span class="w"> </span><span class="s2">"x"</span>,<span class="w"> </span>c:<span class="w"> </span><span class="s2">"x"</span><span class="w"> </span><span class="o">}</span><span class="w"> </span>:<span class="w"> </span><span class="o">{</span><span class="w"> </span>a<span class="w"> </span>:<span class="w"> </span>Str,<span class="w"> </span>b<span class="w"> </span>:<span class="w"> </span>Str,<span class="w"> </span>c<span class="w"> </span>:<span class="w"> </span>Str<span class="w"> </span><span class="o">}</span><span class="w"></span>

»<span class="w"></span>
</code></pre></div>



<a name="273113083"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/273113083" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jan kili <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#273113083">(Feb 24 2022 at 16:29)</a>:</h4>
<p>So, if <code>_ -&gt;</code> can still be used to handle all remaining tags in a closed tag union, the use case in question (for open tag unions as function inputs) seems to shrink to (a) some kind of polymorphism and (b) parsing tag unions defined outside your codebase. These seem like they could be useful in a library, but what are some real-world examples?</p>



<a name="273113247"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/273113247" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jan kili <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#273113247">(Feb 24 2022 at 16:30)</a>:</h4>
<p>On another note, after private messaging with <span class="user-mention" data-user-id="454654">@Ayaz Hafiz</span> the other night, I feel like I understand the ideas behind open/closed tag unions much better now. Thanks, Ayaz :)</p>



<a name="273113394"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/273113394" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jan kili <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#273113394">(Feb 24 2022 at 16:31)</a>:</h4>
<p>I'm happy to share, but I don't want to steal Ayaz's thunder if a big post is coming soon</p>



<a name="273113889"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/273113889" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jan kili <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#273113889">(Feb 24 2022 at 16:34)</a>:</h4>
<p>Each day I'm feeling less sure about how to improve tag unions, because as I learn more about them I'm less eager to downgrade/nerf/gut their powerful flexibility... but they're still so confusing...</p>



<a name="273114243"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/273114243" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jan kili <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#273114243">(Feb 24 2022 at 16:36)</a>:</h4>
<p>I feel like a rioting peasant who has been invited into the castle to dine with the king, and now that I've gotten to know him I'm unsure about beheading him... <span aria-label="laughing" class="emoji emoji-1f606" role="img" title="laughing">:laughing:</span></p>



<a name="273116135"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/273116135" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#273116135">(Feb 24 2022 at 16:49)</a>:</h4>
<p>Frankly, I essentially just see open tag unions as a way to make type checking simpler, and to make more dynamic roc program easier to write.</p>
<p>If I was writing a large production grade app, I would probably use closed tag unions almost all of the time. Even with error types, if you use an open union you may end up getting multiple essentially identical variants. It's better to control and centralize that list and share an alias than to generate it from merging unions.</p>



<a name="273116672"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/273116672" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#273116672">(Feb 24 2022 at 16:52)</a>:</h4>
<p>Of course I can think of exceptions. For example, maybe an error returned from a library should be an open union so that it can be used more flexibly and get merged into the applications error type. But it also wouldn't harm an application much if it wasn't open. The application would just have to wrap or transform the libraries union.</p>



<a name="273119569"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/273119569" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Loric Brevet <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#273119569">(Feb 24 2022 at 17:11)</a>:</h4>
<p>I think I have the same feeling <span class="user-mention" data-user-id="462053">@JanCVanB</span> about understanding those tags better each day, and accepting this design as being correct. And yes there will be exceptions where open unions will make more sense. And maybe this will lead to some patterns that could become "idiomatic" in Roc in the future.</p>
<p>The real problem with all of that is the learning curve for beginners. I am sure plenty of people will have the same questioning and so the answer might be to "simply" find the correct way to teach them, as <span class="user-mention" data-user-id="281383">@Richard Feldman</span> told in a previous comment. But I am sure that explained slowly and iteratively, it could become rapidly at hand for newcomers.</p>
<p>I would look forward to reading a good blog post about it if anyone decides to take the plunge!</p>



<a name="273119913"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/273119913" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tommy Graves <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#273119913">(Feb 24 2022 at 17:13)</a>:</h4>
<p>The good news is that we've recognized early on that this is a major point of confusion. I think by the time the language "goes public" there will be a very well rehearsed, compelling, and sensible way to explain them -- and I am pretty confident the terminology of open/closed will get replaced with something much more illuminating.</p>



<a name="273121142"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/273121142" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ayaz Hafiz <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#273121142">(Feb 24 2022 at 17:22)</a>:</h4>
<p>I intend to write a more full description of why these kinds of tag unions (and extensible records) are useful and give intuitions for their behavior at some point. I think we have a few good partial explanations floating around, and there are good external resources too, they just need to be aggregated and exposed in a more accessible way.</p>
<p>In the meantime, here is a short note I wrote to try to help explain the difference between how Roc's tag unions work and how subtyping works, that I shared with <span class="user-mention" data-user-id="462053">@JanCVanB</span>. It's not polished and may not be the most helpful in the world, but I hope someone can get something out of it, if they are wondering. <a href="https://gist.github.com/ayazhafiz/bfeb59736e746d150678bdabfb5226cd">https://gist.github.com/ayazhafiz/bfeb59736e746d150678bdabfb5226cd</a></p>



<a name="273127315"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/273127315" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jan kili <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#273127315">(Feb 24 2022 at 18:06)</a>:</h4>
<p>Thanks for that gist, Ayaz, it's great</p>



<a name="273127444"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/273127444" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jan kili <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#273127444">(Feb 24 2022 at 18:07)</a>:</h4>
<p>Making connections between <code>[ A ]*</code> and <code>Int *</code> is helpful</p>



<a name="273127690"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/273127690" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jan kili <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#273127690">(Feb 24 2022 at 18:09)</a>:</h4>
<p>I'm finding that there is no common app-level intuition for what <code>*</code> means - it means something different in tags vs records vs numbers. However, it always means the same thing from a compiler perspective - specialization.</p>



<a name="273127951"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/273127951" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tommy Graves <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#273127951">(Feb 24 2022 at 18:11)</a>:</h4>
<p>That is an excellent explanation Ayaz!</p>



<a name="273553464"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/open%20and%20closed%20tag%20unions/near/273553464" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Johannes Maas <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/open.20and.20closed.20tag.20unions.html#273553464">(Feb 28 2022 at 21:02)</a>:</h4>
<p>I had some fun gathering my thoughts and working out a document. I think I managed to lay out a slight modification (allowing composition of closed tag unions) that might help with this problem: <a href="https://gist.github.com/j-maas/ed3d2811d808d0fa1386478575df928d">https://gist.github.com/j-maas/ed3d2811d808d0fa1386478575df928d</a></p>
<p>Feel free to point out any mistakes in that argumentation! :)</p>



<hr><p>Last updated: Mar 01 2026 at 12:20 UTC</p>
</html>