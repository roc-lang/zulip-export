<html>
<head><meta charset="utf-8"><title>Building from source · beginners · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/index.html">beginners</a></h2>
<h3>Topic: <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html">Building from source</a></h3>

<hr>

<base href="https://roc.zulipchat.com">

<head><link href="https://roc-lang.github.io/zulip-export/style.css" rel="stylesheet"></head>

<a name="210073903"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/210073903" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bob Shelline <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#210073903">(Sep 14 2020 at 23:13)</a>:</h4>
<p>I'm having trouble getting llvm set up on Windows, getting this error:</p>
<div class="codehilite"><pre><span></span><code>error: failed to run custom build command for `llvm-sys v100.2.0`
</code></pre></div>


<p>I've run through the Building from Source guide a few times, building llvm in different ways. Does anyone have some insight on what I need to do to fix this? Thanks!</p>



<a name="210076715"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/210076715" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#210076715">(Sep 14 2020 at 23:51)</a>:</h4>
<p>not a windows user, but this seems like a good windows-specific guide <a href="https://github.com/ziglang/zig/wiki/How-to-build-LLVM,-libclang,-and-liblld-from-source#windows">https://github.com/ziglang/zig/wiki/How-to-build-LLVM,-libclang,-and-liblld-from-source#windows</a> if you want to do it from source</p>



<a name="210077986"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/210077986" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#210077986">(Sep 15 2020 at 00:11)</a>:</h4>
<p><span class="user-mention" data-user-id="282726">@Ian Mackenzie</span> was very helpful in getting me set up!</p>



<a name="210133722"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/210133722" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bob Shelline <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#210133722">(Sep 15 2020 at 14:05)</a>:</h4>
<p>Got it working and successfully ran the repl!</p>



<a name="210134084"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/210134084" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#210134084">(Sep 15 2020 at 14:08)</a>:</h4>
<p>nice!!!</p>



<a name="210134235"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/210134235" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#210134235">(Sep 15 2020 at 14:09)</a>:</h4>
<p>if you have any edits to the instructions that might help the next person get up and running on Windows, a PR would be great!</p>



<a name="210134585"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/210134585" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bob Shelline <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#210134585">(Sep 15 2020 at 14:12)</a>:</h4>
<p>Haha, that's the trick. I'm not sure what I was doing wrong. It may be that I was missing the Python or CMake dependencies that I installed while trying the Zig guide that Folkert linked. Ultimately I went through the steps in the Roc guide again with nmake and it worked.</p>



<a name="210134924"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/210134924" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bob Shelline <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#210134924">(Sep 15 2020 at 14:14)</a>:</h4>
<p>I'll make a PR to add those possible dependencies though.</p>



<a name="210135175"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/210135175" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bob Shelline <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#210135175">(Sep 15 2020 at 14:16)</a>:</h4>
<p>Oh, you know what, the <a href="https://llvm.org/docs/GettingStarted.html">https://llvm.org/docs/GettingStarted.html</a> guide does list those dependencies further below. I hadn't read the rest of that guide.</p>



<a name="231955665"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/231955665" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ju Liu <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#231955665">(Mar 26 2021 at 12:30)</a>:</h4>
<p>I was looking at this section and couldn't find the recommended version to install on Mac OS X <a href="https://github.com/rtfeldman/roc/blob/trunk/BUILDING_FROM_SOURCE.md#llvm">https://github.com/rtfeldman/roc/blob/trunk/BUILDING_FROM_SOURCE.md#llvm</a></p>



<a name="231955698"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/231955698" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ju Liu <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#231955698">(Mar 26 2021 at 12:30)</a>:</h4>
<p>so I'm trying with the latest and greatest. Will report if it works fine or not</p>



<a name="231956158"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/231956158" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#231956158">(Mar 26 2021 at 12:35)</a>:</h4>
<p>What version do you see on <code>brew info llvm</code>? It might be llvm 11 and I'm confident that version will not work. I'm currently using 10.0.1.</p>



<a name="231956436"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/231956436" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ju Liu <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#231956436">(Mar 26 2021 at 12:37)</a>:</h4>
<p>yep, can confirm it doesn't. the readme above suggests using 10.0.0_3 which is what I'm trying</p>



<a name="231957644"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/231957644" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ju Liu <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#231957644">(Mar 26 2021 at 12:47)</a>:</h4>
<p>there's still something wrong :(</p>
<div class="codehilite"><pre><span></span><code>$ brew info llvm
llvm: stable 10.0.0 (bottled), HEAD [keg-only]
Next-gen compiler infrastructure
https://llvm.org/
/usr/local/Cellar/llvm/10.0.0_3 (7,055 files, 1GB)
  Poured from bottle on 2021-03-26 at 12:36:37
From: https://github.com/Homebrew/homebrew-core/blob/HEAD/Formula/llvm.rb
==&gt; Dependencies
Build: cmake ✘, python@3.8 ✘
Required: libffi ✔
==&gt; Requirements
Build: Xcode ✔
==&gt; Options
--HEAD
    Install HEAD version
==&gt; Caveats
To use the bundled libc++ please add the following LDFLAGS:
  LDFLAGS=&quot;-L/usr/local/opt/llvm/lib -Wl,-rpath,/usr/local/opt/llvm/lib&quot;

llvm is keg-only, which means it was not symlinked into /usr/local,
because macOS already provides this software and installing another version in
parallel can cause all kinds of trouble.

If you need to have llvm first in your PATH, run:
  echo &#39;export PATH=&quot;/usr/local/opt/llvm/bin:$PATH&quot;&#39; &gt;&gt; /Users/arkham/.bash_profile

For compilers to find llvm you may need to set:
  export LDFLAGS=&quot;-L/usr/local/opt/llvm/lib&quot;
  export CPPFLAGS=&quot;-I/usr/local/opt/llvm/include&quot;

==&gt; Analytics
install: 18,593 (30 days), 68,307 (90 days), 234,327 (365 days)
install-on-request: 15,100 (30 days), 54,439 (90 days), 185,622 (365 days)
build-error: 0 (30 days)
</code></pre></div>



<a name="231957671"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/231957671" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ju Liu <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#231957671">(Mar 26 2021 at 12:47)</a>:</h4>
<p>and the error I get is:</p>
<div class="codehilite"><pre><span></span><code>$ cargo run repl
   Compiling roc_builtins v0.1.0 (/Users/arkham/code/roc/compiler/builtins)
   Compiling cc v1.0.67
   Compiling rand_core v0.6.2
   Compiling directories-next v2.0.0
   Compiling colored v2.0.0
   Compiling dirs-next v2.0.0
   Compiling petgraph v0.5.1
   Compiling backtrace v0.3.56
   Compiling spirv_headers v1.5.0
error: failed to run custom build command for `roc_builtins v0.1.0 (/Users/arkham/code/roc/compiler/builtins)`

Caused by:
  process didn&#39;t exit successfully: `/Users/arkham/code/roc/target/debug/build/roc_builtins-abe28cf79a8a01a1/build-script-build` (exit code: 101)
  --- stdout
  Compiling zig object to: /Users/arkham/code/roc/compiler/builtins/bitcode/builtins.o
  Moving zig object to: /Users/arkham/code/roc/target/debug/build/roc_builtins-8a0ab0a538352427/out/builtins.o
  Compiling ir to: /Users/arkham/code/roc/compiler/builtins/bitcode/builtins.ll
  Compiling bitcode to: /Users/arkham/code/roc/target/debug/build/roc_builtins-8a0ab0a538352427/out/builtins.bc

  --- stderr
  thread &#39;main&#39; panicked at &#39;llvm-as-10 failed: No such file or directory (os error 2)&#39;, compiler/builtins/build.rs:78:24
  note: run with `RUST_BACKTRACE=1` environment variable to display a backtrace
warning: build failed, waiting for other jobs to finish...
error: build failed
</code></pre></div>



<a name="231957756"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/231957756" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ju Liu <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#231957756">(Mar 26 2021 at 12:48)</a>:</h4>
<p>I've exported <code>LDFLAGS</code> and <code>CPPFLAGS</code> as brew suggested</p>



<a name="231957873"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/231957873" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ju Liu <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#231957873">(Mar 26 2021 at 12:49)</a>:</h4>
<p>oh, is it because it's trying to run <code>llvm-as-10</code>, while the locally installed version is just <code>llvm-as</code>?</p>



<a name="231958145"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/231958145" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ju Liu <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#231958145">(Mar 26 2021 at 12:51)</a>:</h4>
<p>yup, that was it :)</p>



<a name="231958583"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/231958583" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ju Liu <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#231958583">(Mar 26 2021 at 12:54)</a>:</h4>
<div class="codehilite"><pre><span></span><code>    Finished dev [unoptimized + debuginfo] target(s) in 2m 18s
     Running `target/debug/roc repl`
  The rockin&#39; roc repl
────────────────────────
Enter an expression, or :help, or :exit/:q.
» 1 + 100
101 : Num *
</code></pre></div>
<p>oh yeahh</p>



<a name="231960291"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/231960291" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ju Liu <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#231960291">(Mar 26 2021 at 13:06)</a>:</h4>
<p>updated instructions here: <a href="https://github.com/rtfeldman/roc/pull/1113">https://github.com/rtfeldman/roc/pull/1113</a></p>



<a name="231961809"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/231961809" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#231961809">(Mar 26 2021 at 13:16)</a>:</h4>
<p><span aria-label="+1" class="emoji emoji-1f44d" role="img" title="+1">:+1:</span> I think the CI error could be because we're not using the latest rust version on CI yet, I'll check it out.</p>



<a name="231963189"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/231963189" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#231963189">(Mar 26 2021 at 13:25)</a>:</h4>
<p>Looks like Richard  was already working on it :)</p>



<a name="231963233"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/231963233" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#231963233">(Mar 26 2021 at 13:25)</a>:</h4>
<p><a href="https://github.com/rtfeldman/roc/pull/1112">https://github.com/rtfeldman/roc/pull/1112</a></p>



<a name="232088226"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/232088226" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Peter Fields <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#232088226">(Mar 27 2021 at 12:53)</a>:</h4>
<p>I am getting errors when building from source. I am on MacOS and I've tried the steps in the troubleshooting section. Can someone help me?<br>
╰─ cargo run repl  <br>
 Compiling roc_builtins v0.1.0 (/Users/motionstatic/ws/dev/roc/compiler/builtins)<br>
Compiling cgmath v0.18.0<br>
Compiling im-rc v14.3.0<br>
Compiling im v14.3.0<br>
Compiling crossbeam-deque v0.7.3<br>
Compiling im v15.0.0<br>
Compiling im-rc v15.0.0<br>
Compiling thiserror v1.0.24<br>
Compiling rand v0.7.3<br>
Compiling serde v1.0.124<br>
error: failed to run custom build command for <code>roc_builtins v0.1.0 (/Users/motionstatic/ws/dev/roc/compiler/builtins)</code></p>
<p>Caused by:<br>
process didn't exit successfully: <code>/Users/motionstatic/ws/dev/roc/target/debug/build/roc_builtins-7f77b815e7e30688/build-script-build</code> (exit code: 101)<br>
--- stdout<br>
Compiling zig object to: /Users/motionstatic/ws/dev/roc/compiler/builtins/bitcode/builtins.o</p>
<p>--- stderr<br>
thread 'main' panicked at 'zig failed: Unable to create builtin.zig: file not found<br>
', compiler/builtins/build.rs:75:17<br>
note: run with <code>RUST_BACKTRACE=1</code> environment variable to display a backtrace<br>
warning: build failed, waiting for other jobs to finish...<br>
error: build failed</p>



<a name="232090083"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/232090083" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Zeljko Nesic <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#232090083">(Mar 27 2021 at 13:23)</a>:</h4>
<p>Do you have Zig installed?</p>



<a name="232097516"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/232097516" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Peter Fields <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#232097516">(Mar 27 2021 at 15:30)</a>:</h4>
<p><span class="user-mention silent" data-user-id="341959">Zeljko Nesic</span> <a href="#narrow/stream/231634-beginners/topic/building.20from.20source/near/232090083">said</a>:</p>
<blockquote>
<p>Do you have Zig installed?</p>
</blockquote>
<p>Yes.<br>
─ zig version = 0.6.0</p>
<p>I used brew install zig</p>



<a name="232098134"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/232098134" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#232098134">(Mar 27 2021 at 15:39)</a>:</h4>
<p>Hi Peter, we're currently using zig 0.7.1, I'll make sure to add that to the zig section of BUILDING_FROM_SOURCE.</p>



<a name="232165211"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/232165211" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#232165211">(Mar 28 2021 at 12:54)</a>:</h4>
<p>apparently the install instructions give you llvm 11 now on macos at least. Can we find instructions to get a specific version?</p>



<a name="232165230"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/232165230" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#232165230">(Mar 28 2021 at 12:55)</a>:</h4>
<p>we use llvm 10 for the moment; also need to upgrade that at some point but that'll cause a bunch of breakage/frustration probably</p>



<a name="232165434"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/232165434" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ju Liu <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#232165434">(Mar 28 2021 at 12:58)</a>:</h4>
<p>I've recently updated the instructions for mac os! <a href="https://github.com/rtfeldman/roc/blob/trunk/BUILDING_FROM_SOURCE.md#llvm-installation-on-macos">https://github.com/rtfeldman/roc/blob/trunk/BUILDING_FROM_SOURCE.md#llvm-installation-on-macos</a></p>



<a name="232165462"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/232165462" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#232165462">(Mar 28 2021 at 13:00)</a>:</h4>
<p>ah, excellent, <span class="user-mention" data-user-id="400181">@Peter Fields</span> maybe the updated version gives better results</p>



<a name="232172659"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/232172659" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lucas Rosa <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#232172659">(Mar 28 2021 at 15:10)</a>:</h4>
<p><span class="user-mention" data-user-id="400181">@Peter Fields</span> pre-built binaries also work well but it's not as elegant</p>



<a name="232174066"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/232174066" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#232174066">(Mar 28 2021 at 15:36)</a>:</h4>
<p>Inkwell supports LLVM 11 now, so  in theory we could update our fork to take advantage of that</p>



<a name="234577965"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/234577965" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mario <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#234577965">(Apr 14 2021 at 21:15)</a>:</h4>
<p>So it's like 6 hours later and the nix build still seems to be going... is this normal? <span aria-label="thinking" class="emoji emoji-1f914" role="img" title="thinking">:thinking:</span> </p>
<p>Seems to have selected an awfully large number of packages which appear to all be building from scratch?</p>
<p><a href="/user_uploads/22008/X-KUzJPUaVZga2qt7eIWGIWX/direnv-init.txt">direnv-init.txt</a></p>



<a name="234582681"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/234582681" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lucas Rosa <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#234582681">(Apr 14 2021 at 21:53)</a>:</h4>
<p>kind of, LLVM takes super super long to build. depends on how much power your machine has, so hard to say if 6hrs itself is normal</p>



<a name="234582761"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/234582761" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lucas Rosa <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#234582761">(Apr 14 2021 at 21:54)</a>:</h4>
<p>I'm going throw the pain now cause I just switched to linux, also I think the nix setup is broken at the moment</p>



<a name="234588904"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/234588904" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mario <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#234588904">(Apr 14 2021 at 22:52)</a>:</h4>
<p>Seems it's given up here:</p>
<div class="codehilite"><pre><span></span><code>trying https://ziglang.org/builds/zig-macos-x86_64-0.7.1.tar.xz
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
curl: (22) The requested URL returned error: 403
error: cannot download zig-macos-x86_64-0.7.1.tar.xz from any mirror
builder for &#39;/nix/store/m4a7fps28v1qh7v12dyfgx96899j7h97-zig-macos-x86_64-0.7.1.tar.xz.drv&#39; failed with exit code 1
building &#39;/nix/store/zmlxwgfzagln7yqg14c00g6xd0mq1gjj-python-2.7.18.drv&#39;...
cannot build derivation &#39;/nix/store/2y7qyxdlgg9qmbwcclylmd9myqac4c2a-zig-0.7.1.drv&#39;: 1 dependencies couldn&#39;t be built
</code></pre></div>



<a name="234591935"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/234591935" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lucas Rosa <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#234591935">(Apr 14 2021 at 23:21)</a>:</h4>
<p>oofff. for macOS I just downloaded a pre-built llvm and mapped some ENV vars myself</p>



<a name="234592870"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/234592870" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lucas Rosa <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#234592870">(Apr 14 2021 at 23:32)</a>:</h4>
<p>the error that made think nix was messed up is happening to me without nix, so forget what I said</p>



<a name="234598803"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/234598803" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#234598803">(Apr 15 2021 at 00:39)</a>:</h4>
<p><span class="user-mention" data-user-id="281566">@Mario</span> great to see you! <span aria-label="wave" class="emoji emoji-1f44b" role="img" title="wave">:wave:</span></p>



<a name="234598825"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/234598825" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#234598825">(Apr 15 2021 at 00:40)</a>:</h4>
<p>I think you might be the first one to try building Roc on M1 hardware, so I have no idea what to expect there, on Nix or otherwise <span aria-label="laughing" class="emoji emoji-1f606" role="img" title="laughing">:laughing:</span></p>



<a name="234598893"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/234598893" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#234598893">(Apr 15 2021 at 00:40)</a>:</h4>
<p>I think <span class="user-mention" data-user-id="343810">@Brendan Hansknecht</span> has built it successfully on a Raspberry Pi though, which also runs on ARM, but that was awhile ago and I don't think it was on Nix <span aria-label="thinking" class="emoji emoji-1f914" role="img" title="thinking">:thinking:</span></p>



<a name="234599177"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/234599177" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#234599177">(Apr 15 2021 at 00:44)</a>:</h4>
<blockquote>
<p>cannot download zig-macos-x86_64-0.7.1.tar.xz</p>
</blockquote>
<p>seems like it's missing from the Nix store - Roc's standard library is written in <a href="https://ziglang.org/">https://ziglang.org/</a> so the <code>zig</code> executable needs to be on your <code>PATH</code> to build Roc - I forget if there's a way to add mirrors to Nix derivations, but the file it's looking for is hosted here on the Zig website: <a href="https://ziglang.org/download/0.7.1/zig-macos-x86_64-0.7.1.tar.xz">https://ziglang.org/download/0.7.1/zig-macos-x86_64-0.7.1.tar.xz</a></p>



<a name="234609868"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/234609868" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#234609868">(Apr 15 2021 at 03:10)</a>:</h4>
<p>ha, perfect timing - here's a fix for Nix on aarch64! <a href="https://github.com/rtfeldman/roc/pull/1198#issuecomment-820021740">https://github.com/rtfeldman/roc/pull/1198#issuecomment-820021740</a></p>
<p>cc <span class="user-mention" data-user-id="281566">@Mario</span></p>



<a name="234620302"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/234620302" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lucas Rosa <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#234620302">(Apr 15 2021 at 05:43)</a>:</h4>
<p>I just got everything working really smooth on fedora</p>



<a name="234764600"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/234764600" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mario <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#234764600">(Apr 15 2021 at 22:31)</a>:</h4>
<p><span class="user-mention silent" data-user-id="281383">Richard Feldman</span> <a href="#narrow/stream/231634-beginners/topic/building.20from.20source/near/234598825">said</a>:</p>
<blockquote>
<p>I think you might be the first one to try building Roc on M1 hardware, so I have no idea what to expect there, on Nix or otherwise <span aria-label="laughing" class="emoji emoji-1f606" role="img" title="laughing">:laughing:</span></p>
</blockquote>
<p>Awesome! <span aria-label="tada" class="emoji emoji-1f389" role="img" title="tada">:tada:</span> Continuing the build... will report back... eventually? :D</p>



<a name="234884924"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/234884924" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mario <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#234884924">(Apr 16 2021 at 16:36)</a>:</h4>
<p>I'm _kind of_ making progress on the M1 nix build! I've started a PR with details here: any help/tips appreciated! <a href="https://github.com/rtfeldman/roc/pull/1204">https://github.com/rtfeldman/roc/pull/1204</a></p>



<a name="238639306"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/238639306" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tarjei Skjærset <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#238639306">(May 13 2021 at 15:44)</a>:</h4>
<p>I'm struggling to get anywhere on macOS, I've been trying since yesterday to get llvm installed. Not really sure which direction I need to be going in. Some things I have tried: </p>
<ul>
<li>Following the guide and editing the brew install script to pin it to version 10, but that gives an HTTP 404 Not Found.</li>
<li>Dowloading llvm binaries manually, but with the new security restrictions I'm not really sure how that is even supposed to work.</li>
<li>After clearing some space on my disk to be able to install XCode, I tried building llvm from source through brew, but that, unsurprisingly perhaps, isn't going to happen. Probably not even worth investigating why that one is failing.</li>
</ul>
<p>So I'm not really sure what my next step here is. Am I missing something obvious, or do I need to set up a Linux environment?</p>



<a name="238640310"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/238640310" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lucas Rosa <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#238640310">(May 13 2021 at 15:52)</a>:</h4>
<p><span class="user-mention" data-user-id="411497">@Tarjei Skjærset</span> on macos I never managed to even build LLVM from source, not even with <code>llvmenv</code> (which is what I use on linux)</p>
<p>I recommend two options:<br>
1) use nix and nix-shell which should be working<br>
2) download a pre-built llvm for macos and add this function to your .bashrc/.zshrc</p>
<div class="codehilite"><pre><span></span><code>llvminit() {
  export LLVM_SYS_100_PREFIX=$HOME/Downloads/llvm
  export PATH=$PATH:$HOME/PATH_TO_ROC_REPO/nix/bin:$HOME/Downloads/llvm:$HOME/Downloads/llvm/bin
}
</code></pre></div>



<a name="238640633"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/238640633" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lucas Rosa <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#238640633">(May 13 2021 at 15:54)</a>:</h4>
<p>then everytime I start a new terminal session and switch to the roc folder I run <code>llvminit</code> first and everything should work</p>



<a name="238640716"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/238640716" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lucas Rosa <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#238640716">(May 13 2021 at 15:55)</a>:</h4>
<p>make sure your Rust version is up to date as well</p>



<a name="238640859"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/238640859" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lucas Rosa <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#238640859">(May 13 2021 at 15:56)</a>:</h4>
<p>I'm happy to jump on a call and get you started let me know</p>



<a name="238641148"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/238641148" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tarjei Skjærset <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#238641148">(May 13 2021 at 15:59)</a>:</h4>
<p>Is the nix-shell supposed to be working without llvm explicitly installed? I tried running <code>cargo run repl</code> earlier, but assumed the reason it didn't work was because I hadn't gotten the llvm installation working. As for 2), I'm guessing that's essentially what I was doing when I tried downloading the binaries, but the issue I ran into there was with macOS' security model where it just won't run stuff unless you allow it in the privacy &amp; security thingy - which I tried, but there are just so many executables.</p>
<p>What Rust version am I supposed to be on, and how do I check?</p>



<a name="238641166"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/238641166" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lucas Rosa <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#238641166">(May 13 2021 at 15:59)</a>:</h4>
<p>nix shell pulls llvm for you so yes</p>



<a name="238641200"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/238641200" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lucas Rosa <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#238641200">(May 13 2021 at 16:00)</a>:</h4>
<p>it could be that the nix setup on mac is broken, it didn't work for me over a month ago suddenly and I gave up on it</p>



<a name="238641254"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/238641254" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tarjei Skjærset <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#238641254">(May 13 2021 at 16:00)</a>:</h4>
<p>Ohh okay, well I'm happy to rely on nix-shell (although hadn't heard about it before), so that's a separate problem then</p>



<a name="238641325"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/238641325" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lucas Rosa <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#238641325">(May 13 2021 at 16:00)</a>:</h4>
<p>so to allow the binaries to run, you just quickly open system preferences and hit allow</p>



<a name="238641387"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/238641387" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lucas Rosa <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#238641387">(May 13 2021 at 16:01)</a>:</h4>
<p>it should show up in the Security &amp; Privacy section of system preferences after you try to run it the first time</p>



<a name="238641626"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/238641626" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tarjei Skjærset <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#238641626">(May 13 2021 at 16:02)</a>:</h4>
<p>Yeah I did try that , but there were literally tens of them. I didn't get it to work, so I scrapped it and tried other stuff, but I'm happy to try that again. Give me a second to uninstall everything else, and I'll give the prebuilt binaries a go again</p>



<a name="238642137"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/238642137" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lucas Rosa <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#238642137">(May 13 2021 at 16:04)</a>:</h4>
<p>oh I see gotcha, I was only prompted for like 2 of them, I wonder if you can enable them via the CLI and do it all in one go</p>



<a name="238642279"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/238642279" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lucas Rosa <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#238642279">(May 13 2021 at 16:05)</a>:</h4>
<p>for the rust version, you probably have rustup installed (hopefully), so just rustup update and you're good</p>



<a name="238642348"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/238642348" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lucas Rosa <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#238642348">(May 13 2021 at 16:05)</a>:</h4>
<p>to check versions you can do <code>rustup show</code></p>



<a name="238642427"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/238642427" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lucas Rosa <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#238642427">(May 13 2021 at 16:06)</a>:</h4>
<p>I'm here all day so just ping here again with an update</p>



<a name="238642466"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/238642466" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tarjei Skjærset <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#238642466">(May 13 2021 at 16:06)</a>:</h4>
<p>So have you just left your llvm binaries in your Downloads folder? I tried copying them around to where I thought they were supposed to go, but I was doing that blind.</p>



<a name="238642601"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/238642601" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lucas Rosa <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#238642601">(May 13 2021 at 16:08)</a>:</h4>
<p>I left it in downloads, <span aria-label="shrug" class="emoji emoji-1f937" role="img" title="shrug">:shrug:</span></p>



<a name="238642655"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/238642655" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tarjei Skjærset <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#238642655">(May 13 2021 at 16:08)</a>:</h4>
<p>Ah, rustup says rustc 1.52.1</p>



<a name="238642693"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/238642693" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lucas Rosa <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#238642693">(May 13 2021 at 16:08)</a>:</h4>
<p>and I only bring them into the path when in the roc folder via the <code>llvminit</code> function</p>



<a name="238642735"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/238642735" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lucas Rosa <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#238642735">(May 13 2021 at 16:08)</a>:</h4>
<p>cause mac has it's own version anyways</p>



<a name="238642773"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/238642773" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lucas Rosa <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#238642773">(May 13 2021 at 16:09)</a>:</h4>
<p>it's just newer than the one we need for inkwell</p>



<a name="238642810"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/238642810" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lucas Rosa <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#238642810">(May 13 2021 at 16:09)</a>:</h4>
<p>you might have luck with llvmenv</p>



<a name="238642833"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/238642833" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lucas Rosa <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#238642833">(May 13 2021 at 16:09)</a>:</h4>
<p>oh actually no, it has no clue where <code>-lSystem</code> is on Big Sur</p>



<a name="238642951"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/238642951" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tarjei Skjærset <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#238642951">(May 13 2021 at 16:10)</a>:</h4>
<p>Okay that's fine by me. Is it just supposed to work now?</p>



<a name="238642981"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/238642981" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lucas Rosa <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#238642981">(May 13 2021 at 16:10)</a>:</h4>
<p>you got llvm locally ?</p>



<a name="238643002"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/238643002" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lucas Rosa <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#238643002">(May 13 2021 at 16:10)</a>:</h4>
<p>and everything in your path?</p>



<a name="238643040"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/238643040" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lucas Rosa <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#238643040">(May 13 2021 at 16:11)</a>:</h4>
<p>try <code>cargo run repl</code> and see what happens</p>



<a name="238643060"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/238643060" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tarjei Skjærset <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#238643060">(May 13 2021 at 16:11)</a>:</h4>
<p>Seems to be compiling fine when I run <code>cargo run repl</code> in regular zsh. Maybe I got tripped up trying to run nix-shell yesterday and thought the llvm binaries weren't working.</p>



<a name="238643071"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/238643071" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lucas Rosa <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#238643071">(May 13 2021 at 16:11)</a>:</h4>
<p>perfect</p>



<a name="238643103"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/238643103" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lucas Rosa <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#238643103">(May 13 2021 at 16:11)</a>:</h4>
<p>if LLVM_AS_SYS doesn't scream right away you're in the clear I think</p>



<a name="238643200"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/238643200" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tarjei Skjærset <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#238643200">(May 13 2021 at 16:12)</a>:</h4>
<p>It's still going! How long is it supposed to take? Are there incremental builds?</p>



<a name="238643274"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/238643274" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lucas Rosa <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#238643274">(May 13 2021 at 16:13)</a>:</h4>
<p>fresh one will take a few seconds maybe a minute, not sure what your specs are but the rust compiler is just slower on mac in general from what I noticed</p>



<a name="238643317"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/238643317" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lucas Rosa <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#238643317">(May 13 2021 at 16:13)</a>:</h4>
<p>incremental builds, not sure, whatever rust does</p>



<a name="238643361"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/238643361" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lucas Rosa <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#238643361">(May 13 2021 at 16:13)</a>:</h4>
<p>I think because we have a mono repo of crates yes</p>



<a name="238643449"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/238643449" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tarjei Skjærset <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#238643449">(May 13 2021 at 16:14)</a>:</h4>
<p>I got a repl! Man, so excited</p>



<a name="238643466"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/238643466" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tarjei Skjærset <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#238643466">(May 13 2021 at 16:14)</a>:</h4>
<p>Well it crashed</p>



<a name="238643484"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/238643484" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lucas Rosa <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#238643484">(May 13 2021 at 16:14)</a>:</h4>
<p>for sure probably Security?</p>



<a name="238643485"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/238643485" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tarjei Skjærset <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#238643485">(May 13 2021 at 16:14)</a>:</h4>
<p>But that's progress, thanks man!</p>



<a name="238643507"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/238643507" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lucas Rosa <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#238643507">(May 13 2021 at 16:14)</a>:</h4>
<p>was it a linker error?</p>



<a name="238643579"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/238643579" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tarjei Skjærset <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#238643579">(May 13 2021 at 16:15)</a>:</h4>
<p>Yeah, ld: framework not found Security</p>



<a name="238643597"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/238643597" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lucas Rosa <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#238643597">(May 13 2021 at 16:15)</a>:</h4>
<p>you can just comment out the -framework Security thing in <a href="http://link.rs">link.rs</a></p>



<a name="238643612"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/238643612" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lucas Rosa <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#238643612">(May 13 2021 at 16:15)</a>:</h4>
<p>or <a href="http://linking.rs">linking.rs</a></p>



<a name="238643645"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/238643645" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lucas Rosa <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#238643645">(May 13 2021 at 16:15)</a>:</h4>
<p>just global search the project for <code>Security</code> and comment out that and the line above it</p>



<a name="238643679"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/238643679" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lucas Rosa <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#238643679">(May 13 2021 at 16:15)</a>:</h4>
<p>it's mostly just for running a single example and won't be there long term anyways</p>



<a name="238643751"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/238643751" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lucas Rosa <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#238643751">(May 13 2021 at 16:16)</a>:</h4>
<p>I do that everytime if I'm on mac lol</p>



<a name="238643810"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/238643810" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tarjei Skjærset <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#238643810">(May 13 2021 at 16:16)</a>:</h4>
<p>Oh god</p>



<a name="238643840"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/238643840" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lucas Rosa <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#238643840">(May 13 2021 at 16:16)</a>:</h4>
<p><a href="http://link.rs">link.rs</a> line 469 &amp; 470</p>



<a name="238643877"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/238643877" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tarjei Skjærset <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#238643877">(May 13 2021 at 16:17)</a>:</h4>
<p>Yeah I found it! I just worried about the thought of doing that every time I pull trunk</p>



<a name="238643902"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/238643902" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lucas Rosa <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#238643902">(May 13 2021 at 16:17)</a>:</h4>
<p>it's fine, you can probably figure out how to make that framework available</p>



<a name="238643909"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/238643909" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lucas Rosa <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#238643909">(May 13 2021 at 16:17)</a>:</h4>
<p>I just didn't care</p>



<a name="238643930"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/238643930" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tarjei Skjærset <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#238643930">(May 13 2021 at 16:17)</a>:</h4>
<p>Heey there we go, my first Roc expression! <a href="/user_uploads/22008/xReMRybRU2Z5R2APh3MM03P6/image.png">image.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/22008/xReMRybRU2Z5R2APh3MM03P6/image.png" title="image.png"><img src="/user_uploads/22008/xReMRybRU2Z5R2APh3MM03P6/image.png"></a></div>



<a name="238643949"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/238643949" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lucas Rosa <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#238643949">(May 13 2021 at 16:17)</a>:</h4>
<p><a href="http://List.map">List.map</a> [ 1, 2, 3, 4 ] \x -&gt; x + 1</p>



<a name="238644117"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/238644117" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tarjei Skjærset <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#238644117">(May 13 2021 at 16:19)</a>:</h4>
<p>Thanks so much for the help! I'll play around for a bit, but I would really love to pair some time <span aria-label="smiley" class="emoji emoji-1f603" role="img" title="smiley">:smiley:</span></p>



<a name="238645033"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/238645033" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lucas Rosa <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#238645033">(May 13 2021 at 16:27)</a>:</h4>
<p>I'm good any day and in Miami, FL usually awake by 7-9AM</p>



<a name="238662571"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/238662571" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#238662571">(May 13 2021 at 18:44)</a>:</h4>
<p>yeah, you can see why we're all about the "not ready for a release yet!" in how we talk about Roc publicly <span aria-label="joy" class="emoji emoji-1f602" role="img" title="joy">:joy:</span></p>



<a name="238662602"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/238662602" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#238662602">(May 13 2021 at 18:44)</a>:</h4>
<p>long-term goal is that there's a single <code>roc</code> executable to download and that's it - it has the editor, no external libraries to install, etc</p>



<a name="238662695"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/238662695" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#238662695">(May 13 2021 at 18:45)</a>:</h4>
<p>but that will take some doing <span aria-label="big smile" class="emoji emoji-1f604" role="img" title="big smile">:big_smile:</span></p>



<a name="238663328"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/238663328" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#238663328">(May 13 2021 at 18:50)</a>:</h4>
<p>thanks for being patient with it, and thanks <span class="user-mention" data-user-id="357305">@Lucas Rosa</span> for helping out!</p>



<a name="243285557"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/243285557" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chen Yu <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#243285557">(Jun 20 2021 at 04:28)</a>:</h4>
<p>Following <a href="https://github.com/rtfeldman/roc/issues/1418">https://github.com/rtfeldman/roc/issues/1418</a>, I still get the error using nix installation. <code>examples/hello-world/hello-world: symbol lookup error: /nix/store/sbbifs2ykc05inws26203h0xwcadnf0l-glibc-2.32-46/lib/libc.so.6: undefined symbol: _dl_fatal_printf, version GLIBC_PRIVATE</code> <span aria-label="sweat smile" class="emoji emoji-1f605" role="img" title="sweat smile">:sweat_smile:</span></p>



<a name="243297788"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/243297788" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#243297788">(Jun 20 2021 at 10:53)</a>:</h4>
<p>hm, any ideas <span class="user-mention" data-user-id="341568">@Jared Ramirez</span>? <span aria-label="thinking" class="emoji emoji-1f914" role="img" title="thinking">:thinking:</span></p>



<a name="243326619"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/243326619" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jared Ramirez <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#243326619">(Jun 20 2021 at 23:18)</a>:</h4>
<p>I'm not sure. I just ran <code>cargo run run examples/hello-world/Hello.roc</code> on the latest <code>trunk</code> on macos with everything installed via nix and it worked for me. My guess is that there's a difference on Ubuntu</p>



<a name="243332646"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/243332646" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#243332646">(Jun 21 2021 at 02:03)</a>:</h4>
<p><span class="user-mention" data-user-id="421664">@Chen Yu</span> one alternate idea is to run the manual instructions in <code>BUILDING_FROM_SOURCE.md</code> - both <span class="user-mention" data-user-id="281543">@Folkert de Vries</span> and I run that setup on Ubuntu without Nix, and it's entirely possible that currently there's nobody else trying to build Roc from Nix on Ubuntu <span aria-label="sweat smile" class="emoji emoji-1f605" role="img" title="sweat smile">:sweat_smile:</span></p>



<a name="243332860"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/243332860" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chen Yu <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#243332860">(Jun 21 2021 at 02:09)</a>:</h4>
<p>OK, thanks~ If I figure it out I will inform you folks~</p>



<a name="243333009"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/243333009" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lucas Rosa <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#243333009">(Jun 21 2021 at 02:13)</a>:</h4>
<p>I build from source on fedora without nix using llvmenv to manage multiple llvm versions, feel free to bother me as well</p>



<a name="248719192"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/248719192" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jan Wirth <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#248719192">(Aug 07 2021 at 14:35)</a>:</h4>
<p>Sorry for the silly questions - is it possible to output wasm somehow?</p>



<a name="248719198"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/248719198" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lucas Rosa <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#248719198">(Aug 07 2021 at 14:35)</a>:</h4>
<p>I think LLVM can yes</p>



<a name="248719204"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/248719204" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lucas Rosa <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#248719204">(Aug 07 2021 at 14:35)</a>:</h4>
<p>but not sure anyone has bothered yet</p>



<a name="248719214"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/248719214" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#248719214">(Aug 07 2021 at 14:35)</a>:</h4>
<p>well in theory we allow 32-bit pointers but nobody has tested that yet</p>



<a name="248719229"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/248719229" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jan Wirth <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#248719229">(Aug 07 2021 at 14:36)</a>:</h4>
<p>Which command would I need to run<br>
I am not very experienced with this lower-level deelopment</p>



<a name="248719247"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/248719247" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#248719247">(Aug 07 2021 at 14:36)</a>:</h4>
<p>so everything is built to allow it, but it's untested</p>



<a name="248719266"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/248719266" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#248719266">(Aug 07 2021 at 14:36)</a>:</h4>
<p>hmm, no idea actually</p>



<a name="248719269"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/248719269" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lucas Rosa <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#248719269">(Aug 07 2021 at 14:36)</a>:</h4>
<p>I’m not sure there is one single command at the moment</p>



<a name="248719273"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/248719273" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lucas Rosa <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#248719273">(Aug 07 2021 at 14:37)</a>:</h4>
<p>might have to dig in the code and pass some flags to LLVM at code gen?</p>



<a name="248719280"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/248719280" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#248719280">(Aug 07 2021 at 14:37)</a>:</h4>
<p>my assumption is that you'd need to get a hold of the LLVM IR (this is not hard, but not exposed in a friendly way) and then convert that to wasm</p>



<a name="248719282"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/248719282" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jan Wirth <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#248719282">(Aug 07 2021 at 14:37)</a>:</h4>
<p>Ah I see</p>



<a name="248719288"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/248719288" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#248719288">(Aug 07 2021 at 14:37)</a>:</h4>
<p>but also you'd need to then also compile the host to wasm, and then link stuff together</p>



<a name="248719295"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/248719295" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#248719295">(Aug 07 2021 at 14:37)</a>:</h4>
<p>and we have some external dependencies too right now</p>



<a name="248719343"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/248719343" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#248719343">(Aug 07 2021 at 14:38)</a>:</h4>
<p>so, yea, it's not easy, might not totally work, but things are in place to make it possible at some point</p>



<a name="248719364"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/248719364" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jan Wirth <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#248719364">(Aug 07 2021 at 14:38)</a>:</h4>
<p>I see that there is compiler/build/src/target and there is a lot of llvm going on :D</p>



<a name="248719366"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/248719366" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lucas Rosa <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#248719366">(Aug 07 2021 at 14:38)</a>:</h4>
<p><a href="https://gist.github.com/yurydelendik/4eeff8248aeb14ce763e">https://gist.github.com/yurydelendik/4eeff8248aeb14ce763e</a></p>
<p>seems informative</p>



<a name="248719373"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/248719373" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lucas Rosa <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#248719373">(Aug 07 2021 at 14:39)</a>:</h4>
<p>meh nvm, not so much, forget that link lol</p>



<a name="248719430"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/248719430" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#248719430">(Aug 07 2021 at 14:40)</a>:</h4>
<p>there sure is a lot of llvm going on. Now in theory we could also directly emit wasm bytecode</p>



<a name="248719432"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/248719432" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#248719432">(Aug 07 2021 at 14:40)</a>:</h4>
<p>for debug builds</p>



<a name="248719435"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/248719435" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jan Wirth <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#248719435">(Aug 07 2021 at 14:40)</a>:</h4>
<p>I was hoping maybe I can convert the dylib C code to wasm but that seems to not be the right way to go. Again I have next to no experience with compilers. I only compiled my beloved kakoune from source and managed to compile roc now, but I'm more an end-user than a direct user.</p>



<a name="248719436"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/248719436" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#248719436">(Aug 07 2021 at 14:40)</a>:</h4>
<p>because LLVM is slow</p>



<a name="248719449"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/248719449" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#248719449">(Aug 07 2021 at 14:41)</a>:</h4>
<p>may I suggest zig to import the C source an emit wasm?</p>



<a name="248719452"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/248719452" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jan Wirth <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#248719452">(Aug 07 2021 at 14:41)</a>:</h4>
<p>How would emitting wasm bytecode hook into the compiler arch?</p>
<p>I'm going to take a look at zig.</p>



<a name="248719455"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/248719455" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#248719455">(Aug 07 2021 at 14:41)</a>:</h4>
<p>not sure what dylib you mean btw, but in general if you have C code and want wasm then I think zig is basicallythe easiest approach</p>



<a name="248719498"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/248719498" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#248719498">(Aug 07 2021 at 14:42)</a>:</h4>
<p>we already have <code>gen_llvm</code> and <code>gen_dev</code></p>



<a name="248719501"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/248719501" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#248719501">(Aug 07 2021 at 14:42)</a>:</h4>
<p>we could quite easily have a <code>gen_wasm</code></p>



<a name="248719508"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/248719508" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#248719508">(Aug 07 2021 at 14:42)</a>:</h4>
<p>it takes our intermediate representation and emits the bytecode</p>



<a name="248719514"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/248719514" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#248719514">(Aug 07 2021 at 14:43)</a>:</h4>
<p>I mean there's more to it than that, but at a high level</p>



<a name="248719609"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/248719609" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jan Wirth <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#248719609">(Aug 07 2021 at 14:45)</a>:</h4>
<p>I mean the dylib I can compile to with the --lib option. But that's not C code I just saw.</p>



<a name="248719665"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/248719665" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lucas Rosa <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#248719665">(Aug 07 2021 at 14:46)</a>:</h4>
<p>Yea using zig to build C code and cross compiling to wasm is smooth</p>



<a name="248719681"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/248719681" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lucas Rosa <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#248719681">(Aug 07 2021 at 14:46)</a>:</h4>
<p>gen_wasm <span aria-label="drooling" class="emoji emoji-1f924" role="img" title="drooling">:drooling:</span></p>



<a name="248719694"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/248719694" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lucas Rosa <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#248719694">(Aug 07 2021 at 14:47)</a>:</h4>
<p>one day for sure</p>



<a name="248719747"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/248719747" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jan Wirth <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#248719747">(Aug 07 2021 at 14:48)</a>:</h4>
<p>Do you have a good starting point to read about how to build a compiler?</p>



<a name="248719828"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/248719828" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#248719828">(Aug 07 2021 at 14:50)</a>:</h4>
<p>not really, interestingly. It's such a broad topic, and there is a lot of space between "technically working" and what you should do if you write a real production-grade compiler</p>



<a name="248719849"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/248719849" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#248719849">(Aug 07 2021 at 14:51)</a>:</h4>
<p>but in general, there are 4 big phases: parsing, canonicalization (make sure names are defined and such), type checking, and code generation</p>



<a name="248719857"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/248719857" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#248719857">(Aug 07 2021 at 14:51)</a>:</h4>
<p>in practice there is also optimization as a part of code gen</p>



<a name="248719898"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/248719898" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jan Wirth <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#248719898">(Aug 07 2021 at 14:52)</a>:</h4>
<p>So the gen_wasm is only the last step, right? Are there guides on generator design? Or is it essentially learning how wasm bytecode works and then building a big ol module that outputs it with whatever means necessary?</p>



<a name="248719917"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/248719917" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#248719917">(Aug 07 2021 at 14:53)</a>:</h4>
<p><span class="user-mention" data-user-id="431336">@Jan Wirth</span> are you interested in working on adding wasm generation support to the Roc compiler? if so, I'd be happy to help via pair programming and such!</p>



<a name="248719925"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/248719925" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#248719925">(Aug 07 2021 at 14:53)</a>:</h4>
<p>yes it's only the last step</p>



<a name="248719926"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/248719926" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#248719926">(Aug 07 2021 at 14:53)</a>:</h4>
<p>we do a lot of collaboration that way around here <span aria-label="big smile" class="emoji emoji-1f604" role="img" title="big smile">:big_smile:</span></p>



<a name="248719927"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/248719927" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#248719927">(Aug 07 2021 at 14:53)</a>:</h4>
<p>idem on the pairing btw</p>



<a name="248719937"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/248719937" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#248719937">(Aug 07 2021 at 14:53)</a>:</h4>
<p>idem? <span aria-label="thinking" class="emoji emoji-1f914" role="img" title="thinking">:thinking:</span></p>



<a name="248719946"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/248719946" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#248719946">(Aug 07 2021 at 14:53)</a>:</h4>
<p>it should mean "the same" or "likewise" in latin?</p>



<a name="248719986"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/248719986" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jan Wirth <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#248719986">(Aug 07 2021 at 14:54)</a>:</h4>
<p>I would be very pleased to do that but I would need to carve out some time / energy.</p>



<a name="248719991"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/248719991" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#248719991">(Aug 07 2021 at 14:54)</a>:</h4>
<p>oh! TIL <span aria-label="big smile" class="emoji emoji-1f604" role="img" title="big smile">:big_smile:</span></p>



<a name="248719994"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/248719994" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#248719994">(Aug 07 2021 at 14:54)</a>:</h4>
<p>and yea it's in essence converting our intermediate representation to the right  sequence of wasm bytecode instructions</p>



<a name="248720001"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/248720001" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#248720001">(Aug 07 2021 at 14:54)</a>:</h4>
<p><span class="user-mention" data-user-id="431336">@Jan Wirth</span> cool! No pressure or anything, but feel free to hit me up anytime if you decide you want to dive into it!</p>



<a name="248720004"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/248720004" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#248720004">(Aug 07 2021 at 14:55)</a>:</h4>
<p>but there are some design issues there with regards to how we use external code</p>



<a name="248720014"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/248720014" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#248720014">(Aug 07 2021 at 14:55)</a>:</h4>
<p>for sure</p>



<a name="248720017"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/248720017" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#248720017">(Aug 07 2021 at 14:55)</a>:</h4>
<p>e.g. the host or some libc bits that we use</p>



<a name="248720022"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/248720022" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jan Wirth <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#248720022">(Aug 07 2021 at 14:55)</a>:</h4>
<p>I go on vacay in a week because I really need it and then I think I can decide if I can take it on and to what extend. I have an elm frontend to ship :)</p>



<a name="248720025"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/248720025" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#248720025">(Aug 07 2021 at 14:55)</a>:</h4>
<p>cool cool! <span aria-label="thumbs up" class="emoji emoji-1f44d" role="img" title="thumbs up">:thumbs_up:</span></p>



<a name="248720026"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/248720026" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#248720026">(Aug 07 2021 at 14:55)</a>:</h4>
<p>enjoy the vacation! <span aria-label="smiley" class="emoji emoji-1f603" role="img" title="smiley">:smiley:</span></p>



<a name="248720027"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/248720027" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#248720027">(Aug 07 2021 at 14:55)</a>:</h4>
<p>so that makes me think maybe taking the LLVM IR we already make and try to turn that into a working wasm app may be an easier starting point</p>



<a name="248720030"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/248720030" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#248720030">(Aug 07 2021 at 14:56)</a>:</h4>
<p>could be, yeah</p>



<a name="248720069"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/248720069" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#248720069">(Aug 07 2021 at 14:56)</a>:</h4>
<p>as a proof of concept</p>



<a name="248720070"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/248720070" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jan Wirth <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#248720070">(Aug 07 2021 at 14:56)</a>:</h4>
<p>I'm happy and keen to put some stuff on my kindle though, so if you have a nice guide to pair-programming or compilers etc. please share :)</p>



<a name="248720158"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/248720158" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jan Wirth <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#248720158">(Aug 07 2021 at 14:59)</a>:</h4>
<p>idem - as the first part of idempotence :)</p>



<a name="248720237"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/248720237" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#248720237">(Aug 07 2021 at 15:00)</a>:</h4>
<p>not very kindle-friendly but I think elm's compiler source code is kind of the best thing to read (if you appreciate haskell, of course)</p>



<a name="248720255"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/248720255" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#248720255">(Aug 07 2021 at 15:00)</a>:</h4>
<p>I was already planning to write some <code>Str</code> docs today, so I'll see about adding some overall compiler docs in there</p>



<a name="248720481"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/248720481" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jan Wirth <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#248720481">(Aug 07 2021 at 15:07)</a>:</h4>
<p>We would be targeting wat rather than wasm right?</p>



<a name="248720505"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/248720505" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jan Wirth <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#248720505">(Aug 07 2021 at 15:07)</a>:</h4>
<p>I think wasm bytecode would break my brain <span aria-label="joy" class="emoji emoji-1f602" role="img" title="joy">:joy:</span></p>



<a name="248720587"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/248720587" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#248720587">(Aug 07 2021 at 15:10)</a>:</h4>
<p>for speed you should really target the bytecode</p>



<a name="248720634"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/248720634" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#248720634">(Aug 07 2021 at 15:10)</a>:</h4>
<p>but you can always decompile that right to the text-based representation</p>



<a name="248720642"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/248720642" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#248720642">(Aug 07 2021 at 15:10)</a>:</h4>
<p>also doing the text-based one first is totally an option</p>



<a name="248720651"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/248720651" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#248720651">(Aug 07 2021 at 15:11)</a>:</h4>
<p>just to build up the experience of what the WASM format looks like</p>



<a name="248721019"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/248721019" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lucas Rosa <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#248721019">(Aug 07 2021 at 15:19)</a>:</h4>
<p><span class="user-mention" data-user-id="431336">@Jan Wirth</span> the <a href="http://craftinginterpreters.com">craftinginterpreters.com</a> book is awesome, new, and beginner friendly. There is a web version available for free</p>



<a name="248721092"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/248721092" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#248721092">(Aug 07 2021 at 15:20)</a>:</h4>
<p>I'd imagine that also does a bunch with bytecode ?</p>



<a name="248721191"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/248721191" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lucas Rosa <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#248721191">(Aug 07 2021 at 15:22)</a>:</h4>
<p>so part 2 is a tree walk interpreter and just traverses the AST for evaluation. Part 3 he redoes everything in C, makes a VM, bytecode from AST, and even a GC</p>



<a name="248721203"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/248721203" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lucas Rosa <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#248721203">(Aug 07 2021 at 15:23)</a>:</h4>
<p>Part 2 is in Java but I’ve been translating it to rust as I go. Part 3 will be in zig for me</p>



<a name="248721411"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/248721411" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lucas Rosa <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#248721411">(Aug 07 2021 at 15:26)</a>:</h4>
<p>oh and this new video is fun: <a href="https://youtu.be/Zkd3mZYOOvw">https://youtu.be/Zkd3mZYOOvw</a></p>
<div class="youtube-video message_inline_image"><a data-id="Zkd3mZYOOvw" href="https://youtu.be/Zkd3mZYOOvw"><img src="https://uploads.zulipusercontent.net/5c72d8fcd2b5b335a2c70d77c438dc1a85cfe623/68747470733a2f2f692e7974696d672e636f6d2f76692f5a6b64336d5a594f4f76772f64656661756c742e6a7067"></a></div>



<a name="248721423"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/248721423" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lucas Rosa <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#248721423">(Aug 07 2021 at 15:27)</a>:</h4>
<p>JT worked on typescript, currently does nushell, and was on the same episode of zig showtime as me :D</p>



<a name="256979187"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/256979187" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Carroll <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#256979187">(Oct 10 2021 at 19:42)</a>:</h4>
<p>I just pulled the latest trunk and <code>cargo build</code> is throwing an error. Looks like a new package got added maybe? Anyone know how to fix it? I'm pretty new to Rust so it's probably something silly.</p>
<div class="codehilite"><pre><span></span><code>error: failed to run custom build command for `alsa-sys v0.3.1`

thread &#39;main&#39; panicked at &#39;Failed to run `&quot;pkg-config&quot; &quot;--libs&quot; &quot;--cflags&quot; &quot;alsa&quot;`: No such file or directory (os error 2)&#39;, /home/brian/.cargo/registry/src/github.com-1ecc6299db9ec823/alsa-sys-0.3.1/build.rs:13:18
</code></pre></div>



<a name="256981083"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/256981083" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#256981083">(Oct 10 2021 at 20:12)</a>:</h4>
<p>if you're on Linux, the mention of <code>alsa</code> might mean it's related to audio - which we recently introduced to the editor</p>



<a name="256981134"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/256981134" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#256981134">(Oct 10 2021 at 20:13)</a>:</h4>
<p>specifically the error seems to be coming from this crate: <a href="https://github.com/diwic/alsa-sys">https://github.com/diwic/alsa-sys</a></p>



<a name="256981341"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/256981341" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#256981341">(Oct 10 2021 at 20:16)</a>:</h4>
<p>it looks like the alsa-sys crate is using pkg-config to build something when the crate gets installed, but it's missing something</p>



<a name="256981404"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/256981404" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#256981404">(Oct 10 2021 at 20:17)</a>:</h4>
<p>oh I bet it's this: <a href="https://github.com/diwic/alsa-sys/issues/9">https://github.com/diwic/alsa-sys/issues/9</a></p>



<a name="256981433"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/256981433" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#256981433">(Oct 10 2021 at 20:17)</a>:</h4>
<p>so maybe you need to have pkg-config installed? (And if so, maybe we need to add that to the building from source instructions)</p>



<a name="256989684"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/256989684" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Carroll <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#256989684">(Oct 10 2021 at 22:22)</a>:</h4>
<p>Aha! <code>sudo apt-get install pkg-config</code> seems to have solved it. Thanks Richard!</p>



<a name="257025235"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/257025235" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#257025235">(Oct 11 2021 at 07:41)</a>:</h4>
<p>I added <code>pkg-config</code> to building from source. I think I'll make a script to install everything required to build from source starting with Ubuntu/Debian.</p>



<a name="257129397"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/257129397" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wolfgang Schuster <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#257129397">(Oct 11 2021 at 23:41)</a>:</h4>
<p>Trying to build locally for the first time on WSL and getting</p>
<div class="codehilite"><pre><span></span><code>&gt; cargo run repl
   Compiling roc_builtins v0.1.0 (/home/wolfadex/Development/roc/compiler/builtins)
   Compiling pulldown-cmark v0.8.0
   Compiling nix v0.17.0
   Compiling dlib v0.5.0
   Compiling ash v0.33.3+1.2.191
   Compiling dlib v0.4.2
   Compiling libc v0.2.101
   Compiling proc-macro2 v1.0.29
error: failed to run custom build command for `roc_builtins v0.1.0 (/home/wolfadex/Development/roc/compiler/builtins)`
Caused by:
  process didn&#39;t exit successfully: `/home/wolfadex/Development/roc/target/debug/build/roc_builtins-9e4973e4a864c4ee/build-script-build` (exit status: 101)
  --- stdout
  cargo:rerun-if-changed=build.rs
  cargo:rustc-env=BUILTINS_O=/home/wolfadex/Development/roc/target/debug/build/roc_builtins-00366df05b0327aa/out/builtins.o
  Compiling zig object to: /home/wolfadex/Development/roc/compiler/builtins/bitcode/builtins-host.o

  --- stderr
  thread &#39;main&#39; panicked at &#39;zig failed: error: unable to find zig installation directory: FileNotFound
  &#39;, compiler/builtins/build.rs:124:17
  note: run with `RUST_BACKTRACE=1` environment variable to display a backtrace
warning: build failed, waiting for other jobs to finish...
error: build failed
</code></pre></div>
<p>Seems to be something Zig specific. Dug a little and saw that it's trying to do a <code>zig build ...</code> from <code>/compiler/builtins</code> and notice that if I run <code>zig build</code> I get the same error</p>
<div class="codehilite"><pre><span></span><code>&gt; zig build
error: unable to find zig installation directory: FileNotFound
</code></pre></div>
<p>Wanted to see if anyone had seen similar before I go digging more</p>



<a name="257130226"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/257130226" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lucas Rosa <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#257130226">(Oct 11 2021 at 23:52)</a>:</h4>
<p>how did you install zig?</p>



<a name="257130332"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/257130332" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lucas Rosa <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#257130332">(Oct 11 2021 at 23:54)</a>:</h4>
<p>It might not know where the source for zig std is</p>



<a name="257131098"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/257131098" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wolfgang Schuster <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#257131098">(Oct 12 2021 at 00:03)</a>:</h4>
<p>I don't actually remember because I installed it many, many months ago. I'll try re-installing though, thanks!</p>



<a name="257133831"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/257133831" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wolfgang Schuster <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#257133831">(Oct 12 2021 at 00:44)</a>:</h4>
<p>Thank you! That got me further</p>



<a name="257134150"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/257134150" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lucas Rosa <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#257134150">(Oct 12 2021 at 00:48)</a>:</h4>
<p>no problem</p>



<a name="258940543"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/258940543" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nathan Kramer <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#258940543">(Oct 25 2021 at 10:28)</a>:</h4>
<p>Hi all, silly question :)<br>
when I run <code>cargo build --release</code>, should I see a roc CLI binary in <code>./target/release</code>?<br>
I can see <code>roc</code>, but that's the editor right?<br>
I was imagining I would build a binary executable and then add it to my PATH so that I can use roc in any arbitrary directory. <span aria-label="sweat smile" class="emoji emoji-1f605" role="img" title="sweat smile">:sweat_smile:</span></p>



<a name="258947043"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/258947043" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Shritesh Bhattarai <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#258947043">(Oct 25 2021 at 11:42)</a>:</h4>
<p>If you use roc without any arguments, it opens the editor. You can also do<code>roc repl</code>, <code>roc FILENAME</code> or <code>roc --help</code>.</p>



<a name="258947864"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/258947864" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nathan Kramer <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#258947864">(Oct 25 2021 at 11:52)</a>:</h4>
<p>ohhh! that makes a lot of sense. Thank you!</p>



<a name="258947872"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/258947872" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Notification Bot <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#258947872">(Oct 25 2021 at 11:52)</a>:</h4>
<p><span class="user-mention silent" data-user-id="452796">Nathan Kramer</span> has marked this topic as resolved.</p>



<a name="259190051"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/259190051" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Locria Cyber <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#259190051">(Oct 27 2021 at 03:49)</a>:</h4>
<div class="codehilite" data-code-language="Fish"><pre><span></span><code><span class="o">&gt;</span> cargo run --release examples/hello-world/Hello.roc
    Finished release <span class="o">[</span>optimized<span class="o">]</span> target<span class="o">(</span>s<span class="o">)</span> <span class="k">in</span> 0.23s
     Running <span class="err">`</span>target/release/roc examples/hello-world/Hello.roc<span class="err">`</span>
<span class="nb">fish</span>: Job 1, <span class="s1">'cargo run --release examples/he…'</span> terminated by signal SIGILL <span class="o">(</span>Illegal instruction<span class="o">)</span>
</code></pre></div>



<a name="259190059"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/259190059" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Locria Cyber <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#259190059">(Oct 27 2021 at 03:49)</a>:</h4>
<p>I can't run any example code</p>



<a name="259192544"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/259192544" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#259192544">(Oct 27 2021 at 04:41)</a>:</h4>
<p>What system are you running on? Also, if you run <code>cargo test</code>, which ones pass/fail?</p>



<a name="259198890"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/259198890" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Locria Cyber <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#259198890">(Oct 27 2021 at 06:50)</a>:</h4>
<div class="codehilite"><pre><span></span><code>running 22 tests
test cli_run::effect ... FAILED
test cli_run::closure ... FAILED
test cli_run::cli ... FAILED
test cli_run::hello_web ... ok
test cli_run::fib ... FAILED
test cli_run::cfold ... FAILED
test cli_run::hello_rust ... FAILED
test cli_run::astar ... FAILED
test cli_run::quicksort_app ... ok
test cli_run::hello_world ... FAILED
test cli_run::hello_zig ... FAILED
test cli_run::quicksort ... FAILED
test cli_run::run_multi_dep_str_optimized ... FAILED
test cli_run::nqueens ... FAILED
test cli_run::base64 ... FAILED
test cli_run::rbtree_insert ... FAILED
test cli_run::rbtree_ck ... FAILED
test cli_run::run_multi_dep_str_unoptimized ... FAILED
test cli_run::run_multi_dep_thunk_optimized ... FAILED
test cli_run::run_multi_dep_thunk_unoptimized ... FAILED
test cli_run::deriv ... FAILED
test cli_run::false_interpreter ... FAILED
</code></pre></div>



<a name="259198903"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/259198903" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Locria Cyber <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#259198903">(Oct 27 2021 at 06:51)</a>:</h4>
<p>Linux</p>



<a name="259201302"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/259201302" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#259201302">(Oct 27 2021 at 07:23)</a>:</h4>
<p>is this still with zig 9? because that just does not work</p>



<a name="259201306"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/259201306" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#259201306">(Oct 27 2021 at 07:23)</a>:</h4>
<p>the llvm versions are not compatible</p>



<a name="259201740"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/259201740" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Locria Cyber <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#259201740">(Oct 27 2021 at 07:28)</a>:</h4>
<p>zig 0.8</p>



<a name="259202510"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/259202510" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#259202510">(Oct 27 2021 at 07:38)</a>:</h4>
<p>interesting. does <code>cargo run -- build --release examples/hello-world/Hello.roc</code> work?</p>



<a name="259202517"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/259202517" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#259202517">(Oct 27 2021 at 07:38)</a>:</h4>
<p>that just makes the executable, but does not yet run it</p>



<a name="259202827"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/259202827" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Locria Cyber <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#259202827">(Oct 27 2021 at 07:43)</a>:</h4>
<p>No</p>



<a name="259202946"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/259202946" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Locria Cyber <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#259202946">(Oct 27 2021 at 07:44)</a>:</h4>
<div class="codehilite"><pre><span></span><code>Thread 1 &quot;roc&quot; received signal SIGILL, Illegal instruction.
&lt;some location&gt; in llvm::getTimeTraceProfilerInstance() ()
</code></pre></div>
<p>from gdb</p>



<a name="259202989"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/259202989" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Locria Cyber <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#259202989">(Oct 27 2021 at 07:45)</a>:</h4>
<p>That just seem like LLVM's fault</p>



<a name="259203179"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/259203179" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#259203179">(Oct 27 2021 at 07:47)</a>:</h4>
<p>which llvm version do you have?</p>



<a name="259203773"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/259203773" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Locria Cyber <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#259203773">(Oct 27 2021 at 07:55)</a>:</h4>
<p>12.0.1-4</p>



<a name="259203879"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/259203879" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Locria Cyber <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#259203879">(Oct 27 2021 at 07:56)</a>:</h4>
<p>is there a way to build within a container with all the dependencies required?</p>



<a name="259203939"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/259203939" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#259203939">(Oct 27 2021 at 07:57)</a>:</h4>
<p>there is a nix recipe, and also our CI script is like a container specification</p>



<a name="259204043"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/259204043" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#259204043">(Oct 27 2021 at 07:58)</a>:</h4>
<p>my guess would be that llvm 12.0.1 is not fully compatible with llvm 12.0</p>



<a name="259206501"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/259206501" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Locria Cyber <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#259206501">(Oct 27 2021 at 08:25)</a>:</h4>
<p>will check out tomorrow</p>



<a name="259235200"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/259235200" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#259235200">(Oct 27 2021 at 13:07)</a>:</h4>
<p><span class="user-mention" data-user-id="453395">@Locria Cyber</span> if you want to try running roc, there is a nightly release available from a couple of days ago <a href="https://github.com/rtfeldman/roc/releases">here</a>. If you want to change any source code there is a <a href="https://github.com/rtfeldman/roc/blob/install-script/developer_install.sh">developer_install.sh script</a>(Debian/Ubuntu) that I still need to double check but should work as is. I also made you a docker container, I'll post a link when it is finished uploading. If you want to use nix, make sure to apply matthiasbeyer's fix, see PR #1831.</p>



<a name="259235890"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/259235890" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#259235890">(Oct 27 2021 at 13:13)</a>:</h4>
<p><a href="https://www.dropbox.com/s/xhflg72q686l43y/rocdeps_docker.tar.gz?dl=0">docker image download link</a></p>
<div class="message_inline_ref"><a href="https://www.dropbox.com/s/xhflg72q686l43y/rocdeps_docker.tar.gz?dl=0" title="rocdeps_docker.tar.gz"><img src="https://uploads.zulipusercontent.net/74b727dd00743da5547e0bcad41df666979ace9d/68747470733a2f2f7777772e64726f70626f782e636f6d2f7374617469632f696d616765732f737065637472756d2d69636f6e732f67656e6572617465642f636f6e74656e742f636f6e74656e742d7a69702d6c617267652e706e67"></a><div><div class="message_inline_image_title">rocdeps_docker.tar.gz</div><desc class="message_inline_image_desc"></desc></div></div>



<a name="259243914"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/259243914" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Oliver Schöning <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#259243914">(Oct 27 2021 at 14:06)</a>:</h4>
<p><span class="user-mention" data-user-id="361169">@Anton</span> omg I did not know this was an option to use roc like that without all the install steps!</p>



<a name="259253920"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/259253920" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#259253920">(Oct 27 2021 at 15:06)</a>:</h4>
<p>It's a very recent addition :) I was planning on adding it to the docs once the release runs automatically every night, which should be soon.</p>



<a name="259255132"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/259255132" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Oliver Schöning <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#259255132">(Oct 27 2021 at 15:13)</a>:</h4>
<p><span class="user-mention" data-user-id="361169">@Anton</span> speaking of docs. If I want to see the docs do I need to run <code>cargo run docs</code> ?<br>
Coz I tried that and got this on the latest master branch:</p>
<div class="codehilite"><pre><span></span><code>oliverschoning@pop-os:~/Projects/roc$ cargo run docs
    Finished dev [unoptimized + debuginfo] target(s) in 0.18s
     Running `target/debug/roc docs`
── FILE NOT FOUND ──────────────────────────────────────────────────────────────

I am looking for this file, but it&#39;s not there:

    ./compiler/load/tests/fixtures/build/no_deps/ThisFileIsMissing.roc

Is the file supposed to be there? Maybe there is a typo in the file
name?
thread &#39;main&#39; panicked at &#39;explicit panic&#39;, docs/src/lib.rs:436:17
note: run with `RUST_BACKTRACE=1` environment variable to display a backtrace
</code></pre></div>



<a name="259255558"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/259255558" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Oliver Schöning <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#259255558">(Oct 27 2021 at 15:16)</a>:</h4>
<p>I dunno what "Docs" entails tbh. So far I am just looking at the examples folder and trying to see if I can manage to build something myself <span aria-label="big smile" class="emoji emoji-1f604" role="img" title="big smile">:big_smile:</span></p>



<a name="259257282"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/259257282" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#259257282">(Oct 27 2021 at 15:27)</a>:</h4>
<p>With docs I was referring to the repo README.<br>
I suppose for making or changing examples, it is best to use these resources:</p>
<ul>
<li><a href="https://github.com/rtfeldman/roc/tree/trunk/compiler/builtins/docs">builtin docs</a></li>
<li><a href="https://github.com/rtfeldman/roc/blob/trunk/roc-for-elm-programmers.md">roc-for-elm-programmers</a></li>
<li><a href="https://www.youtube.com/watch?v=6qzWm_eoUXM">intro to roc video by Richard</a><div class="youtube-video message_inline_image"><a data-id="6qzWm_eoUXM" href="https://www.youtube.com/watch?v=6qzWm_eoUXM"><img src="https://uploads.zulipusercontent.net/c3a925ed18fe1016e197f6abdd6cd3ed6c8f1858/68747470733a2f2f692e7974696d672e636f6d2f76692f36717a576d5f656f55584d2f64656661756c742e6a7067"></a></div></li>
</ul>



<a name="259257501"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/259257501" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Oliver Schöning <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#259257501">(Oct 27 2021 at 15:28)</a>:</h4>
<p>Ok thanks!</p>



<a name="259257577"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/259257577" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#259257577">(Oct 27 2021 at 15:29)</a>:</h4>
<p><code>cargo run  docs</code> generates documentation for roc files/projects, we're still working on docs syntax highlighting so I'm not sure how much the <code>cargo run docs</code> command does yet.</p>



<a name="259257689"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/259257689" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Oliver Schöning <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#259257689">(Oct 27 2021 at 15:30)</a>:</h4>
<p>Ok, yeah I have never been this early to a project I suppose <span aria-label="smiley" class="emoji emoji-1f603" role="img" title="smiley">:smiley:</span></p>



<a name="259316070"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/259316070" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Locria Cyber <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#259316070">(Oct 27 2021 at 22:31)</a>:</h4>
<p><span class="user-mention silent" data-user-id="361169">Anton</span> <a href="#narrow/stream/231634-beginners/topic/.E2.9C.94.20building.20from.20source/near/259235200">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="453395">Locria Cyber</span> if you want to try running roc, there is a nightly release available from a couple of days ago <a href="https://github.com/rtfeldman/roc/releases">here</a>. If you want to change any source code there is a <a href="https://github.com/rtfeldman/roc/blob/install-script/developer_install.sh">developer_install.sh script</a>(Debian/Ubuntu) that I still need to double check but should work as is. I also made you a docker container, I'll post a link when it is finished uploading. If you want to use nix, make sure to apply matthiasbeyer's fix, see PR #1831.</p>
</blockquote>
<p>Can't use nightly release because of  <a href="https://github.com/rtfeldman/roc/issues/1811">https://github.com/rtfeldman/roc/issues/1811</a></p>



<a name="259323980"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/259323980" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#259323980">(Oct 28 2021 at 00:10)</a>:</h4>
<p>Can you try using the <code>--roc-linker</code> flag if you are on Linux?</p>



<a name="259586940"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/259586940" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Logan Lowder <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#259586940">(Oct 29 2021 at 21:44)</a>:</h4>
<p>Hopefully this is the right forum for this, if not please advise!</p>
<p>I'm trying to build from source on macOS Big Sur (11.6) and getting an error about llvm:</p>
<p>I installed <code>llvm</code> with <code>brew install llvm@12</code> and then added <code>/usr/local/opt/llvm/bin</code> to my path, but noticed that no path by that name exists on my system, but <code>/usr/local/opt/llvm@12/bin</code> does, so I added that to my path and afterwards running <code>llc --version</code> generates output starting with <code>Homebrew LLVM version 12.0.1</code> as <code>BUILDING_FROM_SOURCE.md</code> mentions.</p>
<p>Here's the output I get from running <code>cargo run repl</code>:</p>
<div class="codehilite"><pre><span></span><code>cargo run repl
   Compiling llvm-sys v120.2.1
   Compiling snafu v0.6.10
   Compiling parking_lot_core v0.8.5
   Compiling wasmer-vm v2.0.0
   Compiling wasmer-wasi-types v2.0.0
   Compiling cranelift-frontend v0.74.0
   Compiling rodio v0.14.0
error: No suitable version of LLVM was found system-wide or pointed
       to by LLVM_SYS_120_PREFIX.

       Consider using `llvmenv` to compile an appropriate copy of LLVM, and
       refer to the llvm-sys documentation for more information.

       llvm-sys: https://crates.io/crates/llvm-sys
       llvmenv: https://crates.io/crates/llvmenv
   --&gt; /Users/llowder/.cargo/registry/src/github.com-1ecc6299db9ec823/llvm-sys-120.2.1/src/lib.rs:486:1
    |
486 | / std::compile_error!(concat!(
487 | |     &quot;No suitable version of LLVM was found system-wide or pointed
488 | |        to by LLVM_SYS_&quot;,
489 | |     env!(&quot;CARGO_PKG_VERSION_MAJOR&quot;),
...   |
496 | |        llvmenv: https://crates.io/crates/llvmenv&quot;
497 | | ));
    | |___^

error: could not compile `llvm-sys` due to previous error
warning: build failed, waiting for other jobs to finish...
error: build failed
</code></pre></div>



<a name="259587501"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/259587501" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Logan Lowder <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#259587501">(Oct 29 2021 at 21:52)</a>:</h4>
<p>Went ahead and opened an issue for posterity: <a href="https://github.com/rtfeldman/roc/issues/1843">https://github.com/rtfeldman/roc/issues/1843</a></p>



<a name="259587597"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/259587597" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#259587597">(Oct 29 2021 at 21:53)</a>:</h4>
<p>you can set that environment variable explicitly, I have this in </p>
<div class="codehilite"><pre><span></span><code>set -x LLVM_SYS_120_PREFIX &quot;/home/folkertdev/Downloads/clang+llvm-12.0.0-x86_64-linux-gnu-ubuntu-20.04&quot;
</code></pre></div>



<a name="259587652"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/259587652" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#259587652">(Oct 29 2021 at 21:54)</a>:</h4>
<p>the fish shell equivalent of <code>.bashrc</code></p>



<a name="259588557"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/259588557" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Logan Lowder <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#259588557">(Oct 29 2021 at 22:04)</a>:</h4>
<p>Thanks! Let me noodle on this see if I can get it working</p>



<a name="259588744"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/259588744" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Logan Lowder <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#259588744">(Oct 29 2021 at 22:06)</a>:</h4>
<p>Hmm wondering where I can find the path of that file on my system <span aria-label="thinking" class="emoji emoji-1f914" role="img" title="thinking">:thinking:</span></p>



<a name="259588787"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/259588787" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#259588787">(Oct 29 2021 at 22:07)</a>:</h4>
<p>it might be easier to install Nix and do things that way <span aria-label="sweat smile" class="emoji emoji-1f605" role="img" title="sweat smile">:sweat_smile:</span></p>



<a name="259588805"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/259588805" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Logan Lowder <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#259588805">(Oct 29 2021 at 22:07)</a>:</h4>
<p>ha maybe I should</p>



<a name="259588977"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/259588977" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Logan Lowder <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#259588977">(Oct 29 2021 at 22:09)</a>:</h4>
<p>I think I was over thinking it! <code>export LLVM_SYS_120_PREFIX=/usr/local/opt/llvm@12</code> seems to make it happier</p>



<a name="259589061"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/259589061" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Logan Lowder <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#259589061">(Oct 29 2021 at 22:10)</a>:</h4>
<p>I was thinking the prefix was supposed to be a specific executable rather than the dir where llvm lives</p>



<a name="259589084"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/259589084" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Logan Lowder <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#259589084">(Oct 29 2021 at 22:10)</a>:</h4>
<blockquote>
<p>The rockin’ roc repl</p>
</blockquote>
<p>HUZZAH</p>



<a name="259589133"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/259589133" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Logan Lowder <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#259589133">(Oct 29 2021 at 22:11)</a>:</h4>
<p>Perhaps I should open a PR to update BUILDING_FROM_SOURCE.md</p>



<a name="259589669"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/259589669" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#259589669">(Oct 29 2021 at 22:16)</a>:</h4>
<p>awesome, please do! <span aria-label="tada" class="emoji emoji-1f389" role="img" title="tada">:tada:</span></p>



<a name="259744603"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/259744603" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Logan Lowder <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#259744603">(Oct 30 2021 at 18:24)</a>:</h4>
<p><a href="https://github.com/rtfeldman/roc/pull/1850">https://github.com/rtfeldman/roc/pull/1850</a></p>



<a name="259771047"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/259771047" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Locria Cyber <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#259771047">(Oct 31 2021 at 06:03)</a>:</h4>
<p>I tried to use Nix for building Roc.</p>



<a name="259771049"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/259771049" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Locria Cyber <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#259771049">(Oct 31 2021 at 06:03)</a>:</h4>
<div class="codehilite"><pre><span></span><code>thread &#39;main&#39; panicked at &#39;Request adapter&#39;, editor/src/editor/main.rs:82:14
</code></pre></div>



<a name="259771053"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/259771053" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Locria Cyber <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#259771053">(Oct 31 2021 at 06:03)</a>:</h4>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="p">(</span><span class="n">gpu_device</span><span class="p">,</span><span class="w"> </span><span class="n">cmd_queue</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">futures</span>::<span class="n">executor</span>::<span class="n">block_on</span><span class="p">(</span><span class="k">async</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="n">adapter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">instance</span><span class="w"></span>
<span class="w">            </span><span class="p">.</span><span class="n">request_adapter</span><span class="p">(</span><span class="o">&amp;</span><span class="n">wgpu</span>::<span class="n">RequestAdapterOptions</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                </span><span class="n">power_preference</span>: <span class="nc">wgpu</span>::<span class="n">PowerPreference</span>::<span class="n">HighPerformance</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="n">compatible_surface</span>: <span class="nb">Some</span><span class="p">(</span><span class="o">&amp;</span><span class="n">surface</span><span class="p">),</span><span class="w"></span>
<span class="w">            </span><span class="p">})</span><span class="w"></span>
<span class="w">            </span><span class="p">.</span><span class="k">await</span><span class="w"></span>
<span class="w">            </span><span class="p">.</span><span class="n">expect</span><span class="p">(</span><span class="s">"Request adapter"</span><span class="p">);</span><span class="w"></span>
</code></pre></div>



<a name="259771165"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/259771165" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Locria Cyber <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#259771165">(Oct 31 2021 at 06:06)</a>:</h4>
<div class="codehilite"><pre><span></span><code>[nix-shell:~/computing/roc]$ glxgears
glxgears: symbol lookup error: /nix/store/mij848h2x5wiqkwhg027byvmf9x3gx7y-glibc-2.33-50/lib/libdl.so.2: undefined symbol: _dl_catch_error_ptr, version GLIBC_PRIVATE

[nix-shell:~/computing/roc]$ vulkaninfo
ERROR: [Loader Message] Code 0 : libdrm.so.2: cannot open shared object file: No such file or directory
ERROR: [Loader Message] Code 0 : libLLVM-12.so: cannot open shared object file: No such file or directory
ERROR: [Loader Message] Code 0 : libGLX_nvidia.so.0: cannot open shared object file: No such file or directory
Cannot create Vulkan instance.
This problem is often caused by a faulty installation of the Vulkan driver or attempting to use a GPU that does not support Vulkan.
ERROR at /build/source/vulkaninfo/vulkaninfo.h:687:vkCreateInstance failed with ERROR_INCOMPATIBLE_DRIVER

[nix-shell:~/computing/roc]$ which vulkaninfo
/nix/store/9bn3gwiw64bdxi7k9a2h39974c39cs89-vulkan-tools-1.2.189.1/bin/vulkaninfo
</code></pre></div>



<a name="259771173"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/259771173" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Locria Cyber <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#259771173">(Oct 31 2021 at 06:06)</a>:</h4>
<p>totally not working</p>



<a name="259771664"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/259771664" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Locria Cyber <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#259771664">(Oct 31 2021 at 06:21)</a>:</h4>
<p>At least hello world works now</p>



<a name="259772150"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/259772150" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Locria Cyber <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#259772150">(Oct 31 2021 at 06:35)</a>:</h4>
<p>Installed nixGL, and now another library panics. I think I'll not use roc-editor then.</p>



<a name="259783023"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/259783023" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#259783023">(Oct 31 2021 at 11:18)</a>:</h4>
<p>Hi Locria, sorry about this, it sounds very frustrating.<br>
The roc editor is still a WIP and not ready yet to replace your favorite editor, I'll make sure to mention this in the BUILDING_FROM_SOURCE file.<br>
The editor installation process will be much improved in the near future.<br>
I was able to reproduce this error locally and will look at it soon.</p>



<a name="259787898"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/259787898" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#259787898">(Oct 31 2021 at 13:27)</a>:</h4>
<p>This is the fix for when you have a Nvidia GPU:</p>
<div class="codehilite"><pre><span></span><code># outside of nix shell:
nix-channel --add https://github.com/guibou/nixGL/archive/main.tar.gz nixgl &amp;&amp; nix-channel --update
nix-env -iA nixgl.auto.nixVulkanNvidia
# does not work with nix-shell --pure
nix-shell
# 460.91.03 may be different for you, type nixVulkanNvidia and press tab to autocomplete for your version
nixVulkanNvidia-460.91.03 cargo run edit
</code></pre></div>
<p>I'll post a fix for integrated intel graphics soon (after I verified it).</p>



<a name="259791711"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/259791711" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#259791711">(Oct 31 2021 at 15:02)</a>:</h4>
<p>Fixing nixGL with integrated intel graphics is going to take some time.</p>



<a name="260121250"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/260121250" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kevin Hovsäter <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#260121250">(Nov 03 2021 at 11:42)</a>:</h4>
<p>I've had no problems in running the tests while writing builtins, but I just tried the REPL on macOS and it just fail upon evaluating any Roc code. Seems like it can't find a given dylib. Any ideas?</p>
<p><a href="/user_uploads/22008/Ck1LP6SUxAworTF8n7U_Vgve/Screenshot-2021-11-03-at-12.41.57.png">Screenshot-2021-11-03-at-12.41.57.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/22008/Ck1LP6SUxAworTF8n7U_Vgve/Screenshot-2021-11-03-at-12.41.57.png" title="Screenshot-2021-11-03-at-12.41.57.png"><img src="/user_uploads/22008/Ck1LP6SUxAworTF8n7U_Vgve/Screenshot-2021-11-03-at-12.41.57.png"></a></div>



<a name="260121882"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/260121882" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kevin Hovsäter <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#260121882">(Nov 03 2021 at 11:49)</a>:</h4>
<p>Hmm something else must be going on. All tests are failing since I updated my branch with latest <code>trunk</code>.</p>



<a name="260121916"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/260121916" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kevin Hovsäter <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#260121916">(Nov 03 2021 at 11:49)</a>:</h4>
<p><a href="/user_uploads/22008/A-0BZ1bi1skrQlu_KrmUnKKn/Screenshot-2021-11-03-at-12.49.52.png">Screenshot-2021-11-03-at-12.49.52.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/22008/A-0BZ1bi1skrQlu_KrmUnKKn/Screenshot-2021-11-03-at-12.49.52.png" title="Screenshot-2021-11-03-at-12.49.52.png"><img src="/user_uploads/22008/A-0BZ1bi1skrQlu_KrmUnKKn/Screenshot-2021-11-03-at-12.49.52.png"></a></div>



<a name="260123067"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/260123067" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kevin Hovsäter <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#260123067">(Nov 03 2021 at 12:01)</a>:</h4>
<p>Problems averted. Turns out I had to upgrade my CLT since upgrading to macOS Monterey. All good now. <span aria-label="smile" class="emoji emoji-1f642" role="img" title="smile">:smile:</span></p>



<a name="260124303"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/260124303" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kevin Hovsäter <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#260124303">(Nov 03 2021 at 12:12)</a>:</h4>
<p>Looks like I get a failing test case though when running <code>cargo test</code>. This is on macOS 12.0.1, running Rust 1.56.0 and Zig 0.8.1.</p>
<p><a href="/user_uploads/22008/BuNOlQ4_ntomQTuDvu7uXC9l/Screenshot-2021-11-03-at-13.11.34.png">Screenshot-2021-11-03-at-13.11.34.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/22008/BuNOlQ4_ntomQTuDvu7uXC9l/Screenshot-2021-11-03-at-13.11.34.png" title="Screenshot-2021-11-03-at-13.11.34.png"><img src="/user_uploads/22008/BuNOlQ4_ntomQTuDvu7uXC9l/Screenshot-2021-11-03-at-13.11.34.png"></a></div>



<a name="260127668"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/260127668" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kevin Hovsäter <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#260127668">(Nov 03 2021 at 12:40)</a>:</h4>
<p>Rerunning the tests using <code>cargo test -p test_gen --lib</code> gave me the following error:</p>
<p><a href="/user_uploads/22008/Gv6SIqxd_iI2D8SVyWzQtRpl/Screenshot-2021-11-03-at-13.39.39.png">Screenshot-2021-11-03-at-13.39.39.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/22008/Gv6SIqxd_iI2D8SVyWzQtRpl/Screenshot-2021-11-03-at-13.39.39.png" title="Screenshot-2021-11-03-at-13.39.39.png"><img src="/user_uploads/22008/Gv6SIqxd_iI2D8SVyWzQtRpl/Screenshot-2021-11-03-at-13.39.39.png"></a></div>



<a name="260128072"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/260128072" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kevin Hovsäter <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#260128072">(Nov 03 2021 at 12:44)</a>:</h4>
<p>Rerunning the tests inside of <code>lldb</code> breaks on <code>gen_primitives::lambda_set_enum_byte_byte</code>, but running the test in isolation doesn't cause any issues.</p>



<a name="260128301"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/260128301" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kevin Hovsäter <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#260128301">(Nov 03 2021 at 12:46)</a>:</h4>
<p>I've never used tools such as <code>gdb</code>, <code>lldb</code> and <code>valgrind</code>, so I'm not really sure how to debug this. I'd love to pair on it if someone wants to.</p>



<a name="260158236"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/260158236" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kevin Hovsäter <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#260158236">(Nov 03 2021 at 16:17)</a>:</h4>
<p>Not sure if this helps or not, but running <code>cargo test --release -p test_gen --lib</code> also cause the same issue. So it's persistent in both debug and release builds.</p>



<a name="260158404"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/260158404" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#260158404">(Nov 03 2021 at 16:18)</a>:</h4>
<p>probably another case of macos being more strict, let me run this with valgrind</p>



<a name="260160245"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/260160245" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#260160245">(Nov 03 2021 at 16:32)</a>:</h4>
<p>and for you to follow along, I put the test into its own file (I pick <code>examples/benchmarks/Scratchpad.roc</code> for this</p>
<div class="codehilite"><pre><span></span><code>app &quot;scratchpad&quot;
     packages { base: &quot;platform&quot; }
     imports [base.Task]
     provides [ main ] to base


main : Task.Task {} []
main =
    r : [ Red, Green, Blue ]
    r = Red

    g : [ Red, Green, Blue ]
    g = Green

    p1 = (\u -&gt; r == u)
    p2 = (\u -&gt; g == u)
    oneOfResult = List.map [p1, p2] (\p -&gt; p Green)

    when List.len oneOfResult is
        n -&gt; Task.putLine (Str.fromInt n)
</code></pre></div>

<p>Now we can compile this. I use the <code>--debug</code> flag, which will give extra info like line numbers. It requires you install <code>debugir</code>. If you haven't, just run this and the error message will point you to where to get it from:</p>
<div class="codehilite"><pre><span></span><code>cargo run -- --debug examples/benchmarks/Scratchpad.roc
</code></pre></div>

<p>Now, from <code>examples/benchmarks</code>, we can run valgrind</p>
<div class="codehilite"><pre><span></span><code>valgrind --leak-check=full --track-origins=yes ./scratchpad
</code></pre></div>

<p>Which gives a bunch of errors</p>
<div class="codehilite"><pre><span></span><code>==346834== Memcheck, a memory error detector
==346834== Copyright (C) 2002-2017, and GNU GPL&#39;d, by Julian Seward et al.
==346834== Using Valgrind-3.15.0 and LibVEX; rerun with -h for copyright info
==346834== Command: ./scratchpad
==346834== 
==346834== Invalid write of size 8
==346834==    at 0x152714: ??? (Scratchpad.ll:1665)
==346834==    by 0x152628: roc__mainForHost_1_exposed_generic (Scratchpad.ll:1593)
==346834==    by 0x1112A0: main (host.zig:103)
==346834==  Address 0x4c05060 is 6 bytes after a block of size 26 alloc&#39;d
==346834==    at 0x483B7F3: malloc (in /usr/lib/x86_64-linux-gnu/valgrind/vgpreload_memcheck-amd64-linux.so)
==346834==    by 0x110D57: roc_alloc (host.zig:48)
==346834==    by 0x1526F2: ??? (Scratchpad.ll:1651)
==346834==    by 0x152628: roc__mainForHost_1_exposed_generic (Scratchpad.ll:1593)
==346834==    by 0x1112A0: main (host.zig:103)
==346834== 
==346834== Invalid read of size 8
==346834==    at 0x152850: ??? (Scratchpad.ll:1764)
==346834==    by 0x152725: ??? (Scratchpad.ll:1668)
==346834==    by 0x152628: roc__mainForHost_1_exposed_generic (Scratchpad.ll:1593)
==346834==    by 0x1112A0: main (host.zig:103)
==346834==  Address 0x4c05059 is 25 bytes inside a block of size 26 alloc&#39;d
==346834==    at 0x483B7F3: malloc (in /usr/lib/x86_64-linux-gnu/valgrind/vgpreload_memcheck-amd64-linux.so)
==346834==    by 0x110D57: roc_alloc (host.zig:48)
==346834==    by 0x1526F2: ??? (Scratchpad.ll:1651)
==346834==    by 0x152628: roc__mainForHost_1_exposed_generic (Scratchpad.ll:1593)
==346834==    by 0x1112A0: main (host.zig:103)
==346834== 
==346834== Conditional jump or move depends on uninitialised value(s)
==346834==    at 0x152766: ??? (Scratchpad.ll:1681)
==346834==    by 0x15285A: ??? (Scratchpad.ll:1765)
==346834==    by 0x152725: ??? (Scratchpad.ll:1668)
==346834==    by 0x152628: roc__mainForHost_1_exposed_generic (Scratchpad.ll:1593)
==346834==    by 0x1112A0: main (host.zig:103)
==346834==  Uninitialised value was created by a heap allocation
==346834==    at 0x483B7F3: malloc (in /usr/lib/x86_64-linux-gnu/valgrind/vgpreload_memcheck-amd64-linux.so)
==346834==    by 0x110D57: roc_alloc (host.zig:48)
==346834==    by 0x1526F2: ??? (Scratchpad.ll:1651)
==346834==    by 0x152628: roc__mainForHost_1_exposed_generic (Scratchpad.ll:1593)
==346834==    by 0x1112A0: main (host.zig:103)
==346834== 
2
runtime: 17.481ms
==346834== 
==346834== HEAP SUMMARY:
==346834==     in use at exit: 0 bytes in 0 blocks
==346834==   total heap usage: 2 allocs, 2 frees, 36 bytes allocated
==346834== 
==346834== All heap blocks were freed -- no leaks are possible
==346834== 
==346834== For lists of detected and suppressed errors, rerun with: -s
==346834== ERROR SUMMARY: 3 errors from 3 contexts (suppressed: 0 from 0)
</code></pre></div>

<p>That <code>--debug</code> flag also make sure the LLVM IR is written to <code>Scratchpad.ll</code>, so we can inspect it. Usually it makes most sense to work from the top error downward. In this case, that line points us to this LLVM IR</p>
<div class="codehilite"><pre><span></span><code>%roc_alloc = tail call i8* @roc_alloc(i64 26, i32 1)
...
%.repack22 = getelementptr inbounds i8, i8* %roc_alloc, i64 32
</code></pre></div>

<p>where we allocate something that is 26 bytes, but then get a pointer to its 32th byte. That's an out of bounds access, and definitely a bug</p>



<a name="260160705"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/260160705" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#260160705">(Nov 03 2021 at 16:34)</a>:</h4>
<p><span class="user-mention silent" data-user-id="452574">Kevin Sjöberg</span> <a href="#narrow/stream/231634-beginners/topic/.E2.9C.94.20building.20from.20source/near/260128301">said</a>:</p>
<blockquote>
<p>I've never used tools such as <code>gdb</code>, <code>lldb</code> and <code>valgrind</code>, so I'm not really sure how to debug this. I'd love to pair on it if someone wants to.</p>
</blockquote>
<p>If your ever interested in learning more about these tools, I am willing to pair. Just DM me. I have used them quite a bit, especially since I tend to deal with low level stuff within roc.</p>



<a name="260161977"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/260161977" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kevin Hovsäter <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#260161977">(Nov 03 2021 at 16:43)</a>:</h4>
<p><span class="user-mention silent" data-user-id="281543">Folkert de Vries</span> <a href="#narrow/stream/231634-beginners/topic/.E2.9C.94.20building.20from.20source/near/260160245">said</a>:</p>
<blockquote>
<p>and for you to follow along, I put the test into its own file (I pick <code>examples/benchmarks/Scratchpad.roc</code> for this</p>
<div class="codehilite"><pre><span></span><code>app &quot;scratchpad&quot;
     packages { base: &quot;platform&quot; }
     imports [base.Task]
     provides [ main ] to base


main : Task.Task {} []
main =
    r : [ Red, Green, Blue ]
    r = Red

    g : [ Red, Green, Blue ]
    g = Green

    p1 = (\u -&gt; r == u)
    p2 = (\u -&gt; g == u)
    oneOfResult = List.map [p1, p2] (\p -&gt; p Green)

    when List.len oneOfResult is
        n -&gt; Task.putLine (Str.fromInt n)
</code></pre></div>

<p>Now we can compile this. I use the <code>--debug</code> flag, which will give extra info like line numbers. It requires you install <code>debugir</code>. If you haven't, just run this and the error message will point you to where to get it from:</p>
<div class="codehilite"><pre><span></span><code>cargo run -- --debug examples/benchmarks/Scratchpad.roc
</code></pre></div>

<p>Now, from <code>examples/benchmarks</code>, we can run valgrind</p>
<div class="codehilite"><pre><span></span><code>valgrind --leak-check=full --track-origins=yes ./scratchpad
</code></pre></div>

<p>Which gives a bunch of errors</p>
<div class="codehilite"><pre><span></span><code>==346834== Memcheck, a memory error detector
==346834== Copyright (C) 2002-2017, and GNU GPL&#39;d, by Julian Seward et al.
==346834== Using Valgrind-3.15.0 and LibVEX; rerun with -h for copyright info
==346834== Command: ./scratchpad
==346834== 
==346834== Invalid write of size 8
==346834==    at 0x152714: ??? (Scratchpad.ll:1665)
==346834==    by 0x152628: roc__mainForHost_1_exposed_generic (Scratchpad.ll:1593)
==346834==    by 0x1112A0: main (host.zig:103)
==346834==  Address 0x4c05060 is 6 bytes after a block of size 26 alloc&#39;d
==346834==    at 0x483B7F3: malloc (in /usr/lib/x86_64-linux-gnu/valgrind/vgpreload_memcheck-amd64-linux.so)
==346834==    by 0x110D57: roc_alloc (host.zig:48)
==346834==    by 0x1526F2: ??? (Scratchpad.ll:1651)
==346834==    by 0x152628: roc__mainForHost_1_exposed_generic (Scratchpad.ll:1593)
==346834==    by 0x1112A0: main (host.zig:103)
==346834== 
==346834== Invalid read of size 8
==346834==    at 0x152850: ??? (Scratchpad.ll:1764)
==346834==    by 0x152725: ??? (Scratchpad.ll:1668)
==346834==    by 0x152628: roc__mainForHost_1_exposed_generic (Scratchpad.ll:1593)
==346834==    by 0x1112A0: main (host.zig:103)
==346834==  Address 0x4c05059 is 25 bytes inside a block of size 26 alloc&#39;d
==346834==    at 0x483B7F3: malloc (in /usr/lib/x86_64-linux-gnu/valgrind/vgpreload_memcheck-amd64-linux.so)
==346834==    by 0x110D57: roc_alloc (host.zig:48)
==346834==    by 0x1526F2: ??? (Scratchpad.ll:1651)
==346834==    by 0x152628: roc__mainForHost_1_exposed_generic (Scratchpad.ll:1593)
==346834==    by 0x1112A0: main (host.zig:103)
==346834== 
==346834== Conditional jump or move depends on uninitialised value(s)
==346834==    at 0x152766: ??? (Scratchpad.ll:1681)
==346834==    by 0x15285A: ??? (Scratchpad.ll:1765)
==346834==    by 0x152725: ??? (Scratchpad.ll:1668)
==346834==    by 0x152628: roc__mainForHost_1_exposed_generic (Scratchpad.ll:1593)
==346834==    by 0x1112A0: main (host.zig:103)
==346834==  Uninitialised value was created by a heap allocation
==346834==    at 0x483B7F3: malloc (in /usr/lib/x86_64-linux-gnu/valgrind/vgpreload_memcheck-amd64-linux.so)
==346834==    by 0x110D57: roc_alloc (host.zig:48)
==346834==    by 0x1526F2: ??? (Scratchpad.ll:1651)
==346834==    by 0x152628: roc__mainForHost_1_exposed_generic (Scratchpad.ll:1593)
==346834==    by 0x1112A0: main (host.zig:103)
==346834== 
2
runtime: 17.481ms
==346834== 
==346834== HEAP SUMMARY:
==346834==     in use at exit: 0 bytes in 0 blocks
==346834==   total heap usage: 2 allocs, 2 frees, 36 bytes allocated
==346834== 
==346834== All heap blocks were freed -- no leaks are possible
==346834== 
==346834== For lists of detected and suppressed errors, rerun with: -s
==346834== ERROR SUMMARY: 3 errors from 3 contexts (suppressed: 0 from 0)
</code></pre></div>

<p>That <code>--debug</code> flag also make sure the LLVM IR is written to <code>Scratchpad.ll</code>, so we can inspect it. Usually it makes most sense to work from the top error downward. In this case, that line points us to this LLVM IR</p>
<div class="codehilite"><pre><span></span><code>%roc_alloc = tail call i8* @roc_alloc(i64 26, i32 1)
...
%.repack22 = getelementptr inbounds i8, i8* %roc_alloc, i64 32
</code></pre></div>

<p>where we allocate something that is 26 bytes, but then get a pointer to its 32th byte. That's an out of bounds access, and definitely a bug</p>
</blockquote>
<p>This was super helpful! How did you know which test to use? To me it looked like it was failing randomly on different test cases.</p>



<a name="260162145"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/260162145" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#260162145">(Nov 03 2021 at 16:44)</a>:</h4>
<p>this was the one that you said failed. I'd usually use lldb to find out where the segfault happens</p>



<a name="260162656"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/260162656" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kevin Hovsäter <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#260162656">(Nov 03 2021 at 16:48)</a>:</h4>
<p>I see. Are you looking into it now or should I give it a shot myself?</p>



<a name="260162950"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/260162950" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#260162950">(Nov 03 2021 at 16:50)</a>:</h4>
<p>I'm looking at it, you can give it a go too. My theory is that we're allocating too little memory here, likely not taking alignment into account</p>



<a name="260164311"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/260164311" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#260164311">(Nov 03 2021 at 16:58)</a>:</h4>
<p>I got it</p>



<a name="260167844"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/260167844" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#260167844">(Nov 03 2021 at 17:23)</a>:</h4>
<p>can you check the tests with this PR <a href="https://github.com/rtfeldman/roc/pull/1885">https://github.com/rtfeldman/roc/pull/1885</a></p>



<a name="260168315"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/260168315" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kevin Hovsäter <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#260168315">(Nov 03 2021 at 17:26)</a>:</h4>
<p>Sure. I’ll try it out. Really impressed with your debugging skills. Would love to know more about how you ended up finding where the problem was. 🙂</p>



<a name="260172372"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/260172372" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kevin Hovsäter <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#260172372">(Nov 03 2021 at 17:57)</a>:</h4>
<p><span class="user-mention" data-user-id="281543">@Folkert de Vries</span> seems to have fixed it! Get another failure, but I think it's unrelated. It's the hello_swift one.</p>



<a name="260174255"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/260174255" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#260174255">(Nov 03 2021 at 18:09)</a>:</h4>
<p>hm, <code>gen_tags</code> fails for me on that branch on x64 macOS</p>
<div class="codehilite"><pre><span></span><code>test gen_tags::false_is_false ... ok
test gen_tags::applied_tag_just_enum ... ok
test gen_tags::alignment_in_multi_tag_construction_two ... ok
test_gen-ef19d83dce25afb6(25024,0x700007630000) malloc: *** error for object 0x7fee1a1705d0: pointer being freed was not allocated
test_gen-ef19d83dce25afb6(25024,0x700007630000) malloc: *** set a breakpoint in malloc_error_break to debug
</code></pre></div>



<a name="260175276"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/260175276" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kevin Hovsäter <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#260175276">(Nov 03 2021 at 18:16)</a>:</h4>
<p>I'm also on x64. I had a failure initially, but after running <code>cargo clean</code> and then <code>cargo test</code> they all seem to pass consistently.</p>



<a name="260176334"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/260176334" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#260176334">(Nov 03 2021 at 18:24)</a>:</h4>
<p>interesting - I ran <code>cargo clean</code> and now <code>hello_swift</code> is failing, but <code>gen_tags</code> is still failing <span aria-label="laughing" class="emoji emoji-1f606" role="img" title="laughing">:laughing:</span></p>



<a name="260176416"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/260176416" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#260176416">(Nov 03 2021 at 18:24)</a>:</h4>
<div class="codehilite"><pre><span></span><code>$ cargo test --lib gen_tags

running 54 tests
test gen_tags::applied_tag_just_enum ... ok
test gen_tags::alignment_in_multi_tag_construction_two ... ok
test gen_tags::applied_tag_just_ir ... ok
test gen_tags::applied_tag_just ... ok
error: test failed, to rerun pass &#39;-p test_gen --lib&#39;

Caused by:
  process didn&#39;t exit successfully: `/Users/rtfeldman/code/roc/target/debug/deps/test_gen-ef19d83dce25afb6 gen_tags` (signal: 11, SIGSEGV: invalid memory reference)
</code></pre></div>



<a name="260176492"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/260176492" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#260176492">(Nov 03 2021 at 18:25)</a>:</h4>
<p>can you run<code>lldb /Users/rtfeldman/code/roc/target/debug/deps/test_gen-ef19d83dce25afb6 -- gen_tags</code></p>



<a name="260176538"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/260176538" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#260176538">(Nov 03 2021 at 18:25)</a>:</h4>
<p>that opens up a repl thing, then run <code>run</code> and then <code>bt</code> and that should show you which test case is responsible</p>



<a name="260176617"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/260176617" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#260176617">(Nov 03 2021 at 18:26)</a>:</h4>
<div class="codehilite"><pre><span></span><code>running 54 tests
test gen_tags::applied_tag_just ... ok
test gen_tags::applied_tag_just_ir ... ok
test_gen-ef19d83dce25afb6(28983,0x700007235000) malloc: *** error for object 0x113057d00: pointer being freed was not allocated
test_gen-ef19d83dce25afb6(28983,0x700007235000) malloc: *** set a breakpoint in malloc_error_break to debug
Process 28983 stopped
* thread #9, name = &#39;gen_tags::applied_tag_function_result&#39;, stop reason = signal SIGABRT
    frame #0: 0x00007fff202e492e libsystem_kernel.dylib`__pthread_kill + 10
libsystem_kernel.dylib`__pthread_kill:
-&gt;  0x7fff202e492e &lt;+10&gt;: jae    0x7fff202e4938            ; &lt;+20&gt;
    0x7fff202e4930 &lt;+12&gt;: movq   %rax, %rdi
    0x7fff202e4933 &lt;+15&gt;: jmp    0x7fff202dead9            ; cerror_nocancel
    0x7fff202e4938 &lt;+20&gt;: retq
</code></pre></div>



<a name="260176946"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/260176946" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#260176946">(Nov 03 2021 at 18:29)</a>:</h4>
<p>yup valgrind shows some issues for that one too</p>



<a name="260176996"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/260176996" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#260176996">(Nov 03 2021 at 18:29)</a>:</h4>
<p>looks like that macos CI machine would be really valuable</p>



<a name="260177200"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/260177200" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#260177200">(Nov 03 2021 at 18:30)</a>:</h4>
<p>for sure <span aria-label="big smile" class="emoji emoji-1f604" role="img" title="big smile">:big_smile:</span></p>



<a name="260177282"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/260177282" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#260177282">(Nov 03 2021 at 18:31)</a>:</h4>
<p>I can spend some more time on that after next week's conferences</p>



<a name="260197702"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/260197702" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#260197702">(Nov 03 2021 at 21:07)</a>:</h4>
<p><span class="user-mention" data-user-id="281383">@Richard Feldman</span> do you remember when this worked last? because I think we're hitting a more fundamental problem with our RC insertion here</p>



<a name="260197743"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/260197743" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#260197743">(Nov 03 2021 at 21:08)</a>:</h4>
<p>and I don't see why it would be recently introduced</p>



<a name="260198046"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/260198046" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#260198046">(Nov 03 2021 at 21:10)</a>:</h4>
<p>I'll git bisect it!</p>



<a name="260202334"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/260202334" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#260202334">(Nov 03 2021 at 21:49)</a>:</h4>
<p>bisect says 5cb7dbd3cccf4b4af6b949a4e2d06485cbf49289 is the first bad commit</p>



<a name="260203215"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/260203215" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lucas Rosa <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#260203215">(Nov 03 2021 at 21:57)</a>:</h4>
<p>I love a good git bisect</p>



<a name="260203273"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/260203273" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lucas Rosa <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#260203273">(Nov 03 2021 at 21:58)</a>:</h4>
<p>I’m gonna try to get a build today on my M1 Max, finally done configuring it</p>



<a name="260203824"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/260203824" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#260203824">(Nov 03 2021 at 22:03)</a>:</h4>
<p><span class="user-mention silent" data-user-id="281383">Richard Feldman</span> <a href="#narrow/stream/231634-beginners/topic/.E2.9C.94.20building.20from.20source/near/260202334">said</a>:</p>
<blockquote>
<p>bisect says 5cb7dbd3cccf4b4af6b949a4e2d06485cbf49289 is the first bad commit</p>
</blockquote>
<p>hmm well maybe it does not crash but it still gives valgrind errors before that commit</p>



<a name="260210693"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/260210693" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#260210693">(Nov 03 2021 at 23:17)</a>:</h4>
<p>does it still give valgrind errors even if you <code>cherry-pick</code> the fix from the branch? <span aria-label="thinking" class="emoji emoji-1f914" role="img" title="thinking">:thinking:</span></p>



<a name="260232284"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/260232284" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Locria Cyber <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#260232284">(Nov 04 2021 at 05:59)</a>:</h4>
<p>Roc still can't run on Arch Linux with official packages from <code>pacman</code>.</p>
<p>How's how to reproduce it in Vagrant:<br>
<a href="#narrow/stream/304641-ideas/topic/Faster.20builds.20and.20reproducible.20development.20environment/near/260232240">https://roc.zulipchat.com/#narrow/stream/304641-ideas/topic/Faster.20builds.20and.20reproducible.20development.20environment/near/260232240</a></p>



<a name="260232631"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/260232631" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#260232631">(Nov 04 2021 at 06:04)</a>:</h4>
<blockquote>
<p>Roc still can't run on Arch Linux with official packages from <code>pacman</code>.</p>
</blockquote>
<p>What specifically is causing an issue for that? I have had roc running on arch before.</p>



<a name="260232656"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/260232656" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#260232656">(Nov 04 2021 at 06:05)</a>:</h4>
<p>Is it specifically an issue of needing software from the <code>aur</code> or something different like versioning issues?</p>



<a name="260232819"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/260232819" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Locria Cyber <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#260232819">(Nov 04 2021 at 06:08)</a>:</h4>
<p>inkwell</p>



<a name="260232899"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/260232899" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#260232899">(Nov 04 2021 at 06:10)</a>:</h4>
<p>What about it? Issues with llvm version/dev build to use with inkwell?</p>



<a name="260241064"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/260241064" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kevin Hovsäter <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#260241064">(Nov 04 2021 at 08:34)</a>:</h4>
<p><span class="user-mention silent" data-user-id="281383">Richard Feldman</span> <a href="#narrow/stream/231634-beginners/topic/.E2.9C.94.20building.20from.20source/near/260174255">said</a>:</p>
<blockquote>
<p>hm, <code>gen_tags</code> fails for me on that branch on x64 macOS</p>
<p><div class="codehilite"><pre><span></span><code>test gen_tags::false_is_false ... ok
test gen_tags::applied_tag_just_enum ... ok
test gen_tags::alignment_in_multi_tag_construction_two ... ok
test_gen-ef19d83dce25afb6(25024,0x700007630000) malloc: *** error for object 0x7fee1a1705d0: pointer being freed was not allocated
test_gen-ef19d83dce25afb6(25024,0x700007630000) malloc: *** set a breakpoint in malloc_error_break to debug
</code></pre></div><br>
</p>
</blockquote>
<p>It's now failing for me as well. So yeah, still an issue.</p>



<a name="260243381"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/260243381" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#260243381">(Nov 04 2021 at 08:59)</a>:</h4>
<p><span class="user-mention silent" data-user-id="357305">Lucas Rosa</span> <a href="#narrow/stream/231634-beginners/topic/.E2.9C.94.20building.20from.20source/near/260203273">said</a>:</p>
<blockquote>
<p>I’m gonna try to get a build today on my M1 Max, finally done configuring it</p>
</blockquote>
<p><span class="user-mention" data-user-id="357305">@Lucas Rosa</span>  I almost have a build with nix working on my M1 mac mini.</p>



<a name="260248492"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/260248492" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#260248492">(Nov 04 2021 at 09:56)</a>:</h4>
<p><span class="user-mention silent" data-user-id="281383">Richard Feldman</span> <a href="#narrow/stream/231634-beginners/topic/.E2.9C.94.20building.20from.20source/near/260210693">said</a>:</p>
<blockquote>
<p>does it still give valgrind errors even if you <code>cherry-pick</code> the fix from the branch? <span aria-label="thinking" class="emoji emoji-1f914" role="img" title="thinking">:thinking:</span></p>
</blockquote>
<p>yes, it makes sense that this is a problem</p>
<p>What we do is we infer a borrow signature first for <code>List.map</code> (or any lowlevel that takes a function argument), and only later for the function that we pass in practice. That means in this case that <code>List.map</code> thinks that the passed function borrows the element, while in practice it owns it.</p>



<a name="260248530"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/260248530" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#260248530">(Nov 04 2021 at 09:57)</a>:</h4>
<p>and therefore it's freed twice</p>



<a name="260255489"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/260255489" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#260255489">(Nov 04 2021 at 11:10)</a>:</h4>
<p>ahh gotcha</p>



<a name="260256332"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/260256332" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kevin Hovsäter <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#260256332">(Nov 04 2021 at 11:21)</a>:</h4>
<p>I guess I don't need to look into it then?</p>



<a name="260268388"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/260268388" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lucas Rosa <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#260268388">(Nov 04 2021 at 13:23)</a>:</h4>
<p>ok here we go, finally running the tests on the M1 Max</p>



<a name="260268661"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/260268661" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lucas Rosa <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#260268661">(Nov 04 2021 at 13:26)</a>:</h4>
<p>some failing tests, probably my fault, gonna try the repl now</p>



<a name="260268714"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/260268714" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lucas Rosa <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#260268714">(Nov 04 2021 at 13:26)</a>:</h4>
<p>repl works fine :p</p>



<a name="260268926"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/260268926" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lucas Rosa <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#260268926">(Nov 04 2021 at 13:28)</a>:</h4>
<p>ok this is good enough for me to start getting some work done, I'll sort out why I have failing tests later</p>



<a name="260269033"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/260269033" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lucas Rosa <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#260269033">(Nov 04 2021 at 13:29)</a>:</h4>
<p><span class="user-mention silent" data-user-id="361169">Anton</span> <a href="#narrow/stream/231634-beginners/topic/.E2.9C.94.20building.20from.20source/near/260243381">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="357305">Lucas Rosa</span> <a href="#narrow/stream/231634-beginners/topic/.E2.9C.94.20building.20from.20source/near/260203273">said</a>:</p>
<blockquote>
<p>I’m gonna try to get a build today on my M1 Max, finally done configuring it</p>
</blockquote>
<p><span class="user-mention silent" data-user-id="357305">Lucas Rosa</span>  I almost have a build with nix working on my M1 mac mini.</p>
</blockquote>
<p>oh super nice, I'll give it a try as well :)</p>



<a name="260269467"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/260269467" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lucas Rosa <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#260269467">(Nov 04 2021 at 13:32)</a>:</h4>
<p>but yo, this builds super fast lol, it's almost scary <span aria-label="laughter tears" class="emoji emoji-1f602" role="img" title="laughter tears">:laughter_tears:</span></p>



<a name="260269908"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/260269908" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lucas Rosa <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#260269908">(Nov 04 2021 at 13:35)</a>:</h4>
<div class="codehilite"><pre><span></span><code>rm -rf target

time cargo test -p test_gen gen_dict

223.99s user 18.11s system 549% cpu 44.097 total
</code></pre></div>



<a name="260269990"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/260269990" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lucas Rosa <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#260269990">(Nov 04 2021 at 13:36)</a>:</h4>
<p><span class="user-mention" data-user-id="281543">@Folkert de Vries</span> good numbers or na? ^</p>



<a name="260270109"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/260270109" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#260270109">(Nov 04 2021 at 13:37)</a>:</h4>
<p>which time is the relevant here? I always forget</p>



<a name="260270142"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/260270142" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#260270142">(Nov 04 2021 at 13:37)</a>:</h4>
<p>if it's the 18 seconds then that's very good</p>



<a name="260270149"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/260270149" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lucas Rosa <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#260270149">(Nov 04 2021 at 13:37)</a>:</h4>
<p>system I think</p>



<a name="260270162"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/260270162" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lucas Rosa <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#260270162">(Nov 04 2021 at 13:38)</a>:</h4>
<p>I forget too lol</p>



<a name="260270275"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/260270275" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lucas Rosa <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#260270275">(Nov 04 2021 at 13:38)</a>:</h4>
<p>although 223s is still pretty fast considering it had to compile most of the crates before running the tests</p>



<a name="260270608"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/260270608" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#260270608">(Nov 04 2021 at 13:41)</a>:</h4>
<p>true</p>



<a name="260270993"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/260270993" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Oleksii Skidan <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#260270993">(Nov 04 2021 at 13:45)</a>:</h4>
<p>Is there a guide somewhere about how to enable M1 support? Mabye a specific branch?</p>



<a name="260271247"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/260271247" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lucas Rosa <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#260271247">(Nov 04 2021 at 13:47)</a>:</h4>
<p>I didn't really do much outside of <code>brew install llvm@12</code>, but I've only ran a few tests and the repl which is usually enough for me to get some work done. What command did you run or what code did you try that is giving you trouble?</p>



<a name="260331933"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/260331933" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Oleksii Skidan <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#260331933">(Nov 04 2021 at 20:45)</a>:</h4>
<p>I finally nailed it. Roc builds and runs on my MacBook Pro just fine. <span aria-label="tada" class="emoji emoji-1f389" role="img" title="tada">:tada:</span><br>
According to CONTRIBUTING.md I have to talk to an existing contributor about the pull request that I want to make. Who shall I talk to?</p>



<a name="260332398"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/260332398" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Oleksii Skidan <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#260332398">(Nov 04 2021 at 20:48)</a>:</h4>
<p>A bit of a problem as well for me, my Mac is running low on disk space (30GB left out of 256GB). There's nothing I can do to clean up some space. That guide is telling me to run tests in Earthly prior to making a PR. Unfortunately, I won't be able to run them now. :( Not until I have access to my home PC where I can run Linux. The fun part is that Earthly won't exercise any of the macOS-specific stuff  then as far as I can tell, will it?</p>



<a name="260332525"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/260332525" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Shritesh Bhattarai <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#260332525">(Nov 04 2021 at 20:49)</a>:</h4>
<p>I've never installed Earthly or used it and I think that's fine</p>



<a name="260333279"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/260333279" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#260333279">(Nov 04 2021 at 20:55)</a>:</h4>
<p>I wouldn't worry about earthly. It is what CI runs and is nice if you really want to make sure a pr is good, but doesn't matter a ton for local testing.</p>



<a name="260333300"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/260333300" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#260333300">(Nov 04 2021 at 20:55)</a>:</h4>
<p>Go ahead and just make a branch and then create a PR.</p>



<a name="260333573"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/260333573" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#260333573">(Nov 04 2021 at 20:57)</a>:</h4>
<p>The main thing about talking to existing contributors is probably for if you are going to make larger changes. Don't want to waste effort when multiple people work on the same thing or someone adds features in a way that fundamentally Roc doesn't want. But for bug fixes and getting the programming working on a new system, just opening a PR should be great.</p>



<a name="260334652"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/260334652" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Oleksii Skidan <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#260334652">(Nov 04 2021 at 21:05)</a>:</h4>
<p>OK, what's the procedure then? Shall I push a new branch with the fix, if so is there any specific format for how to name it?</p>



<a name="260334856"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/260334856" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#260334856">(Nov 04 2021 at 21:07)</a>:</h4>
<p>yes make a branch. There is no naming format, pick something descriptive and you should be good</p>



<a name="260337017"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/260337017" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Oleksii Skidan <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#260337017">(Nov 04 2021 at 21:25)</a>:</h4>
<p>Who to add into reviewers of this PR? <a href="https://github.com/rtfeldman/roc/pull/1890">https://github.com/rtfeldman/roc/pull/1890</a></p>



<a name="263357543"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/263357543" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Johannes Hoff <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#263357543">(Dec 01 2021 at 21:04)</a>:</h4>
<p>Trying Roc for the first time (for advent of code; not sure I should post there instead), but getting this while trying <code>cargo build</code>:</p>
<div class="codehilite"><pre><span></span><code>  thread &#39;main&#39; panicked at &#39;zig failed: error: AccessDenied
  &#39;, compiler/builtins/build.rs:150:17
</code></pre></div>
<p>Does that look familiar to anyone? Fresh install of zig 0.8.0.</p>



<a name="263357695"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/263357695" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lucas Rosa <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#263357695">(Dec 01 2021 at 21:05)</a>:</h4>
<p>interesting</p>



<a name="263357711"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/263357711" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lucas Rosa <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#263357711">(Dec 01 2021 at 21:06)</a>:</h4>
<p>how did you install zig?</p>



<a name="263357781"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/263357781" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Johannes Hoff <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#263357781">(Dec 01 2021 at 21:06)</a>:</h4>
<p>Downloaded the 0.8.0 binary from here: <a href="https://ziglang.org/download/">https://ziglang.org/download/</a></p>



<a name="263357788"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/263357788" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Johannes Hoff <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#263357788">(Dec 01 2021 at 21:06)</a>:</h4>
<p>I managed to build and run hello world in zig, so at least the installation isn't completely broken</p>



<a name="263358379"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/263358379" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#263358379">(Dec 01 2021 at 21:12)</a>:</h4>
<p>what os are you on?</p>



<a name="263358427"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/263358427" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#263358427">(Dec 01 2021 at 21:12)</a>:</h4>
<p>I think that happens when you run the compiler in the wrong directory</p>



<a name="263358445"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/263358445" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#263358445">(Dec 01 2021 at 21:13)</a>:</h4>
<p>and then some path does not work</p>



<a name="263358501"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/263358501" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#263358501">(Dec 01 2021 at 21:13)</a>:</h4>
<p>all commands should be executed from the top directory</p>



<a name="263359009"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/263359009" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Johannes Hoff <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#263359009">(Dec 01 2021 at 21:18)</a>:</h4>
<p>I'm on MacOS/aarch64. I'm running cargo build from the project root (i.e. the folder with <code>.git</code>)</p>



<a name="263359056"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/263359056" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#263359056">(Dec 01 2021 at 21:18)</a>:</h4>
<p>using nix or direct install of everything?</p>



<a name="263359268"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/263359268" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Johannes Hoff <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#263359268">(Dec 01 2021 at 21:20)</a>:</h4>
<p>Direct installed everything. Rust, zig, llvm</p>



<a name="263359278"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/263359278" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Johannes Hoff <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#263359278">(Dec 01 2021 at 21:20)</a>:</h4>
<p>Maybe I should give nix a try</p>



<a name="263359301"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/263359301" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#263359301">(Dec 01 2021 at 21:21)</a>:</h4>
<p>maybe just chmod that whole builtins directory?</p>



<a name="263359317"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/263359317" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#263359317">(Dec 01 2021 at 21:21)</a>:</h4>
<p>it does seem vaguely familiar, but I don't remember any details</p>



<a name="263359429"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/263359429" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#263359429">(Dec 01 2021 at 21:22)</a>:</h4>
<p>Otherwise, it is possible an issue with cache dir resolution for some reason, like is mentioned here: <a href="https://github.com/ziglang/zig/issues/6810">https://github.com/ziglang/zig/issues/6810</a><br>
Though, not nix specific as in the linked issue</p>



<a name="263359810"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/263359810" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Johannes Hoff <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#263359810">(Dec 01 2021 at 21:25)</a>:</h4>
<p>Oh, I see what the problem is. I totally created this problem myself. Had copied something from another user and had to <code>chown</code> it. Sorry for the trouble; should have caught it myself</p>



<a name="263359878"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/263359878" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lucas Rosa <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#263359878">(Dec 01 2021 at 21:26)</a>:</h4>
<p>makes sense, all good :)</p>



<a name="264514978"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/264514978" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Taylor Allred <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#264514978">(Dec 10 2021 at 22:04)</a>:</h4>
<p>Anyone know what to do about this? </p>
<div class="codehilite"><pre><span></span><code>error: failed to run custom build command for `roc_builtins v0.1.0 (C:\Users\taylo\Documents\Projects\roc\compiler\builtins)`

Caused by:
  process didn&#39;t exit successfully: `C:\Users\path\to\roc\target\debug\build\roc_builtins-f32964a2162d4b2f\build-script-build` (exit code: 101)
  --- stdout
  cargo:rerun-if-changed=build.rs
  Compiling host ir to: \\?\C:\Users\path\to\roc\compiler\builtins\bitcode\builtins-host.ll

  --- stderr
  thread &#39;main&#39; panicked at &#39;zig failed:
  Unhandled Exception: System.ArgumentException: Illegal characters in path.
     at System.Security.Permissions.FileIOPermission.EmulateFileIOPermissionChecks(String fullPath)
     at System.IO.Directory.InternalGetCurrentDirectory(Boolean checkHost)
     at shim.ShimProgram.Main(String[] args)
  &#39;, compiler\builtins\build.rs:150:17
  note: run with `RUST_BACKTRACE=1` environment variable to display a backtrace
</code></pre></div>



<a name="264551988"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/264551988" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#264551988">(Dec 11 2021 at 09:20)</a>:</h4>
<p>Hi <span class="user-mention" data-user-id="458687">@Taylor Allred</span>,<br>
I notice the <code>C:\</code> in your path, are you using windows or perhaps the Windows Subsystem for Linux?</p>



<a name="264617300"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/264617300" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luuk de Gram <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#264617300">(Dec 12 2021 at 11:10)</a>:</h4>
<p>Hi all! Is there a way to specify the install path of Zig?<br>
I mainly develop using Zig so the one installed in my $PATH is the master version.<br>
So in short, I'd like to overwrite what's in my $PATH and specify the installation directory of zig 0.8.0 when building the Roc compiler from source.</p>



<a name="264618757"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/264618757" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#264618757">(Dec 12 2021 at 11:45)</a>:</h4>
<p>Hi Luuk,<br>
I've made issue #2189 to provide a nice solution for this, until that is done you can either:</p>
<ul>
<li>build the compiler from source <a href="https://github.com/rtfeldman/roc/blob/trunk/BUILDING_FROM_SOURCE.md#using-nix">using nix</a></li>
<li>Or replace every mention in the source code of <code>Command::new("zig")</code> with say <code>Command::new("zig8")</code>. This replacement may not cover all cases. You could temporarily rename your <code>zig</code> command to <code>notzig</code> and see where errors occur and then replace the use of zig there with zig8.</li>
</ul>



<a name="264619129"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/264619129" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luuk de Gram <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#264619129">(Dec 12 2021 at 11:55)</a>:</h4>
<p>Thanks Anton!<br>
As all I have to do is test some changes, I'll just use option 2 for now :)<br>
(Also thank you for making the issue).</p>



<a name="264638345"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/264638345" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lucas Rosa <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#264638345">(Dec 12 2021 at 19:02)</a>:</h4>
<p>Hi LuuK :)</p>



<a name="271746409"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/271746409" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yonatan Reicher <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#271746409">(Feb 13 2022 at 13:34)</a>:</h4>
<p>Hi! I'm trying to build roc rn for the first time.<br>
I just installed zig, and when I'm running cargo build I get the following error:</p>
<div class="codehilite"><pre><span></span><code>error: failed to run custom build command for `roc_builtins v0.1.0 (G:\Projects\roc\compiler\builtins)`

Caused by:
  process didn&#39;t exit successfully: `G:\Projects\roc\target\debug\build\roc_builtins-4fc5c156ddb0b51a\build-script-build` (exit code: 101)
  --- stdout
  cargo:rerun-if-changed=build.rs
  Compiling host ir to: \\?\G:\Projects\roc\compiler\builtins\bitcode\builtins-host.ll

  --- stderr
  thread &#39;main&#39; panicked at &#39;zig failed:
  Unhandled Exception: System.ArgumentException: Illegal characters in path.
     at System.Security.Permissions.FileIOPermission.EmulateFileIOPermissionChecks(String fullPath)
     at System.IO.Directory.InternalGetCurrentDirectory(Boolean checkHost)
     at shim.ShimProgram.Main(String[] args)
  &#39;, compiler\builtins\build.rs:157:17
  note: run with `RUST_BACKTRACE=1` environment variable to display a backtrace
</code></pre></div>
<p>I am on windows.<br>
My windows user does have hebrew characters, but I don't know what it could be trying to access under user.<br>
Maybe somebody knows what's up?</p>



<a name="271746895"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/271746895" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jan kili <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#271746895">(Feb 13 2022 at 13:45)</a>:</h4>
<p>What version of Zig did you install? I believe Roc requires Zig <del>v0.8.0</del> v0.8.1<br>
I'm on macOS using Nix, so all I know about Roc+Windows is <a href="https://github.com/rtfeldman/roc/blob/trunk/getting_started/windows.md">this warning</a></p>



<a name="271747052"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/271747052" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jan kili <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#271747052">(Feb 13 2022 at 13:49)</a>:</h4>
<p>I'm not the right one to help you with this, but for more info on Roc's dependencies you could skim <a href="https://github.com/rtfeldman/roc/blob/trunk/shell.nix">this</a> and <a href="https://github.com/rtfeldman/roc/tree/trunk/nix">these</a></p>



<a name="271747194"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/271747194" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yonatan Reicher <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#271747194">(Feb 13 2022 at 13:53)</a>:</h4>
<p>Thank you for responding, I downloaded zig 0.9, should I get 0.8.1?<br>
I think I saw in another thread that you can build on windows but linking wont work</p>



<a name="271747433"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/271747433" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jan kili <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#271747433">(Feb 13 2022 at 13:58)</a>:</h4>
<p>Yes, sorry, that's part of what I meant - Zig v0.9.0 support is coming soon</p>



<a name="271747590"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/271747590" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yonatan Reicher <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#271747590">(Feb 13 2022 at 14:01)</a>:</h4>
<p>Ok, thx!</p>



<a name="275029431"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/275029431" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Taylor Allred <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#275029431">(Mar 11 2022 at 20:26)</a>:</h4>
<p><span class="user-mention silent" data-user-id="361169">Anton</span> <a href="#narrow/stream/231634-beginners/topic/.E2.9C.94.20building.20from.20source/near/264551988">said</a>:</p>
<blockquote>
<p>Hi <span class="user-mention silent" data-user-id="458687">Taylor Allred</span>,<br>
I notice the <code>C:\</code> in your path, are you using windows or perhaps the Windows Subsystem for Linux?</p>
</blockquote>
<p>Hi <span class="user-mention" data-user-id="361169">@Anton</span>. Sorry for not responding way back when. I believe I was running on windows not in WSL. I'll try this again in both and see how it goes.</p>



<a name="275084126"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/275084126" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Notification Bot <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#275084126">(Mar 12 2022 at 08:07)</a>:</h4>
<p><span class="user-mention silent" data-user-id="361169">Anton</span> has marked this topic as unresolved.</p>



<a name="275084187"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/275084187" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#275084187">(Mar 12 2022 at 08:09)</a>:</h4>
<p><span class="user-mention" data-user-id="458687">@Taylor Allred</span> we did get building on windows working but running roc programs will not work because linking on windows still has to be implemented. Using WSL should work though.</p>



<a name="276700818"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/276700818" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jake <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#276700818">(Mar 26 2022 at 02:40)</a>:</h4>
<p>Hi! I'm trying to build from source on an <code>aarch64</code> Debian GNU/Linux system, using the latest in the trunk.  I get the following error during the cargo build</p>
<div class="codehilite" data-code-language="Bash"><pre><span></span><code>$ cargo build
   Compiling roc_linker v0.1.0 <span class="o">(</span>/path-to/roc/linker<span class="o">)</span>
error<span class="o">[</span>E0308<span class="o">]</span>: mismatched types
   --&gt; linker/src/lib.rs:676:40
    <span class="p">|</span>
<span class="m">676</span> <span class="p">|</span>             <span class="nb">let</span> c_buf: *const <span class="nv">c_char</span> <span class="o">=</span> dynstr_data<span class="o">[</span>dynstr_off..<span class="o">]</span>.as_ptr<span class="o">()</span> as *const i8<span class="p">;</span>
    <span class="p">|</span>                        -------------   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ expected <span class="sb">`</span>u8<span class="sb">`</span>, found <span class="sb">`</span>i8<span class="sb">`</span>
    <span class="p">|</span>                        <span class="p">|</span>
    <span class="p">|</span>                        expected due to this
    <span class="p">|</span>
    <span class="o">=</span> note: expected raw pointer <span class="sb">`</span>*const u8<span class="sb">`</span>
               found raw pointer <span class="sb">`</span>*const i8<span class="sb">`</span>

For more information about this error, try <span class="sb">`</span>rustc --explain E0308<span class="sb">`</span>.
error: could not compile <span class="sb">`</span>roc_linker<span class="sb">`</span> due to previous error
</code></pre></div>
<p>I can get the build to succeed by changing from <code>i8</code> to <code>c_char</code>, as hinted by the error, but I'm not sure the implications of that... Has anybody encountered this before? I'm brand new to all of this but trying to learn <span aria-label="smile" class="emoji emoji-1f642" role="img" title="smile">:smile:</span></p>



<a name="276700974"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/276700974" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jake <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#276700974">(Mar 26 2022 at 02:45)</a>:</h4>
<p>even after getting past that error with that naive change, I cannot get many of the cli_run tests to pass. Lots of this error</p>
<div class="codehilite" data-code-language="Bash"><pre><span></span><code>---- cli_run::cfold stdout ----
thread <span class="s1">'cli_run::cfold'</span> panicked at <span class="s1">'roc build had stderr: thread '</span>&lt;unnamed&gt;<span class="s1">' panicked at '</span>Failed to rebuild host.zig - stderr of the <span class="sb">`</span>zig<span class="sb">`</span> <span class="nb">command</span> was:
error: UnknownOperatingSystem
<span class="s1">', compiler/build/src/link.rs:1111:27</span>
<span class="s1">note: run with `RUST_BACKTRACE=1` environment variable to display a backtrace</span>
<span class="s1">thread '</span>main<span class="s1">' panicked at '</span>called <span class="sb">`</span>Result::unwrap<span class="o">()</span><span class="sb">`</span> on an <span class="sb">`</span>Err<span class="sb">`</span> value: Any <span class="o">{</span> .. <span class="o">}</span><span class="s1">', cli/src/build.rs:233:50</span>
<span class="s1">'</span>, cli/tests/cli_run.rs:87:13
note: run with <span class="sb">`</span><span class="nv">RUST_BACKTRACE</span><span class="o">=</span><span class="m">1</span><span class="sb">`</span> environment variable to display a backtrace
</code></pre></div>
<p>Any thoughts on how to proceed from here?</p>



<a name="276701025"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/276701025" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ayaz Hafiz <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#276701025">(Mar 26 2022 at 02:46)</a>:</h4>
<p>Regarding the first error, what version of rustc are you using?</p>



<a name="276701120"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/276701120" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#276701120">(Mar 26 2022 at 02:49)</a>:</h4>
<p>The first change looks to be a bug on our part. No matter the rust version, we should be converting that to a <code>c_char</code> instead of the exact numeric type. That should be a safe change.</p>



<a name="276701126"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/276701126" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ayaz Hafiz <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#276701126">(Mar 26 2022 at 02:49)</a>:</h4>
<p>Regarding the second, are you able to run “zig build” in examples/hello-world/zig-platform? the error message indicates it may be a zig problem</p>



<a name="276701194"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/276701194" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ayaz Hafiz <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#276701194">(Mar 26 2022 at 02:51)</a>:</h4>
<p>yeah, the first one is our bug - it looks like c_char is target-dependent <a href="https://doc.rust-lang.org/src/std/os/raw/mod.rs.html#92-135">https://doc.rust-lang.org/src/std/os/raw/mod.rs.html#92-135</a></p>



<a name="276701240"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/276701240" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jake <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#276701240">(Mar 26 2022 at 02:52)</a>:</h4>
<p>Yes, I guess my system treats c_char as a u8 instead of an i8</p>



<a name="276701335"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/276701335" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jake <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#276701335">(Mar 26 2022 at 02:55)</a>:</h4>
<p>I'm happy to open a PR for the first issue once I can get all my test failures fixed.</p>
<p><span class="user-mention" data-user-id="454654">@Ayaz Hafiz</span> I was able to get a successful <code>zig build</code> in that directory you mentioned. I had to <code>zig init-exe</code> first though? Sorry, I'm brand new to Rust, Zig, Roc, the works <span aria-label="smile" class="emoji emoji-1f642" role="img" title="smile">:smile:</span> . I appreciate the help!</p>



<a name="276701704"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/276701704" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jake <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#276701704">(Mar 26 2022 at 03:05)</a>:</h4>
<p>ah, this gives me the same zig <code>UnknownOperatingSystem</code> error as above</p>
<div class="codehilite" data-code-language="Bash"><pre><span></span><code>$ cargo run examples/hello-world/zig-platform/helloZig.roc
</code></pre></div>
<p>I'll take another look through the docs to make sure I didn't miss something in all the installation steps</p>



<a name="276701846"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/276701846" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ayaz Hafiz <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#276701846">(Mar 26 2022 at 03:08)</a>:</h4>
<p>sorry, i have to hop off to work but i will try to take a deeper look tomorrow morning if you or another helpful friend are unable to resolve this by then!</p>



<a name="276701866"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/276701866" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jake <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#276701866">(Mar 26 2022 at 03:09)</a>:</h4>
<p>no worries! I appreciate the help so far and will try to do my best to figure it out in the meantime</p>



<a name="276702309"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/276702309" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#276702309">(Mar 26 2022 at 03:22)</a>:</h4>
<p>So <code>zig biuld</code> was actually the wrong command here. We manually build the host with a more complex form of <code>zig build-obj</code> with a solid number of flags</p>



<a name="276702327"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/276702327" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#276702327">(Mar 26 2022 at 03:23)</a>:</h4>
<p>To start simpler and check if the compiler is working in general, can you try:<br>
<code>cargo run examples/hello-world/rust-platform/helloRust.roc</code></p>



<a name="276702369"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/276702369" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#276702369">(Mar 26 2022 at 03:24)</a>:</h4>
<p>Since we know rust is installed and running happily.</p>



<a name="276702533"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/276702533" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jake <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#276702533">(Mar 26 2022 at 03:29)</a>:</h4>
<p><span class="user-mention silent" data-user-id="343810">Brendan Hansknecht</span> <a href="#narrow/stream/231634-beginners/topic/building.20from.20source/near/276702327">said</a>:</p>
<blockquote>
<p>To start simpler and check if the compiler is working in general, can you try:<br>
<code>cargo run examples/hello-world/rust-platform/helloRust.roc</code></p>
</blockquote>
<p>Yes, this works fine! I was testing that and several other examples that are using Rust platforms and they seem fine.</p>



<a name="276702633"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/276702633" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#276702633">(Mar 26 2022 at 03:31)</a>:</h4>
<p>Good to know. So definitely a zig related issue. Can you try and run a zig hello world program on your computer, unrelated to roc.</p>



<a name="276702692"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/276702692" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#276702692">(Mar 26 2022 at 03:32)</a>:</h4>
<p>Should just be:</p>
<div class="codehilite"><pre><span></span><code>mkdir hello-world
cd hello-world
zig init-exe
zig build run
</code></pre></div>



<a name="276702767"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/276702767" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jake <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#276702767">(Mar 26 2022 at 03:34)</a>:</h4>
<p>yep that works, as does a more typical hello-world like the one quoted here <a href="https://ziglearn.org/#hello-world">https://ziglearn.org/#hello-world</a></p>



<a name="276703368"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/276703368" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#276703368">(Mar 26 2022 at 03:52)</a>:</h4>
<p>just to double check, what does <code>zig version</code> print?</p>



<a name="276703514"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/276703514" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jake <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#276703514">(Mar 26 2022 at 03:57)</a>:</h4>
<p>0.8.1</p>



<a name="276703593"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/276703593" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#276703593">(Mar 26 2022 at 03:59)</a>:</h4>
<p>Can you change <code>compiler/build/link.rs:131</code> from <code>        target,</code> to <code>        dbg!(target),</code>?</p>



<a name="276703596"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/276703596" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#276703596">(Mar 26 2022 at 03:59)</a>:</h4>
<p>I want to see what OS we are telling zig to compiler for.</p>



<a name="276703601"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/276703601" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#276703601">(Mar 26 2022 at 03:59)</a>:</h4>
<p>Since that is apparently the issue</p>



<a name="276703770"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/276703770" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#276703770">(Mar 26 2022 at 04:02)</a>:</h4>
<p>Side note, good change that commenting out that line and the line above it will fix the issue.</p>



<a name="276703982"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/276703982" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jake <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#276703982">(Mar 26 2022 at 04:06)</a>:</h4>
<div class="codehilite" data-code-language="Bash"><pre><span></span><code><span class="o">[</span>compiler/build/src/link.rs:131<span class="o">]</span> <span class="nv">target</span> <span class="o">=</span> <span class="s2">"aarch64-unknown-linux-gnu"</span>
</code></pre></div>



<a name="276704056"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/276704056" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jake <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#276704056">(Mar 26 2022 at 04:09)</a>:</h4>
<p><span class="user-mention silent" data-user-id="343810">Brendan Hansknecht</span> <a href="#narrow/stream/231634-beginners/topic/building.20from.20source/near/276703770">said</a>:</p>
<blockquote>
<p>Side note, good change that commenting out that line and the line above it will fix the issue.</p>
</blockquote>
<p>yes, commenting out those two lines did allow me to successfully run the helloZig.roc file!</p>



<a name="276704241"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/276704241" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#276704241">(Mar 26 2022 at 04:14)</a>:</h4>
<p>How is <code>linux-gnu</code> an unknown operating system.</p>



<a name="276704245"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/276704245" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#276704245">(Mar 26 2022 at 04:15)</a>:</h4>
<p>...zig bug?</p>



<a name="276704931"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/276704931" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jake <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#276704931">(Mar 26 2022 at 04:33)</a>:</h4>
<p>based on the pattern I see hardcoded elsewhere in the file, it seems that the <code>-unknown-</code> piece maybe shouldn't be present?<br>
For example, we don't have that piece here <a href="https://github.com/rtfeldman/roc/blob/trunk/compiler/build/src/link.rs#L445">https://github.com/rtfeldman/roc/blob/trunk/compiler/build/src/link.rs#L445</a></p>



<a name="276705056"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/276705056" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jake <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#276705056">(Mar 26 2022 at 04:36)</a>:</h4>
<p>I think this might be what we're aiming to match? <a href="https://github.com/ziglang/zig/blob/88e98a0611b9fb41c1da026febac2467548bb129/tools/process_headers.zig#L63">https://github.com/ziglang/zig/blob/88e98a0611b9fb41c1da026febac2467548bb129/tools/process_headers.zig#L63</a><br>
so it should just be <code>aarch64-linux-gnu</code> in my case</p>
<p>I will test that hardcoded to see if it solves my issue</p>



<a name="276705630"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/276705630" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jake <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#276705630">(Mar 26 2022 at 04:53)</a>:</h4>
<p>yes, confirmed that hardcoding <code>aarch64-linux-gnu</code> as the target lets me run the zig platform example locally. Seems like there's some synchronization that needs to be done with the <a href="https://github.com/rtfeldman/roc/blob/d91df421476a5f599efafefcfe1cf8e0aa87a8fa/compiler/build/src/target.rs#L10"><code>target_triple_str</code> function</a> and how it relates to the zig <code>-target</code> mappings</p>



<a name="276705704"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/276705704" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#276705704">(Mar 26 2022 at 04:54)</a>:</h4>
<p>The unknown should be part of the triple. It is the vendor. So on Macos it is apple.</p>



<a name="276705709"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/276705709" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#276705709">(Mar 26 2022 at 04:55)</a>:</h4>
<p>On most things it is unknown.</p>



<a name="276705729"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/276705729" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#276705729">(Mar 26 2022 at 04:55)</a>:</h4>
<p>Maybe zig just removed it cause it generally isn't useful even if it is part of the triple</p>



<a name="276706305"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/276706305" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jake <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#276706305">(Mar 26 2022 at 05:06)</a>:</h4>
<p>these seem like relevant zig issues</p>
<ul>
<li><a href="https://github.com/ziglang/zig/issues/7360">https://github.com/ziglang/zig/issues/7360</a></li>
<li><a href="https://github.com/ziglang/zig/issues/4911">https://github.com/ziglang/zig/issues/4911</a></li>
</ul>



<a name="276706465"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/276706465" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jake <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#276706465">(Mar 26 2022 at 05:10)</a>:</h4>
<p>the zig wiki also mentions some about how these targets are updated in that repo</p>
<ul>
<li><a href="https://github.com/ziglang/zig/wiki/Updating-libc">https://github.com/ziglang/zig/wiki/Updating-libc</a></li>
</ul>



<a name="276707239"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/276707239" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#276707239">(Mar 26 2022 at 05:32)</a>:</h4>
<p>Wow, so it actually is a zig issue...kinda</p>



<a name="276707324"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/276707324" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#276707324">(Mar 26 2022 at 05:34)</a>:</h4>
<p>Feel free to add a special exceptions. Probably add a comment with a link to the issue.</p>



<a name="276707388"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/276707388" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jake <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#276707388">(Mar 26 2022 at 05:36)</a>:</h4>
<p>Okay. I've gotta go for the night but am happy to work on this later this weekend</p>



<a name="276707391"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/276707391" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jake <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#276707391">(Mar 26 2022 at 05:36)</a>:</h4>
<p>Thanks, all, for the assistance!</p>



<a name="276707393"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/276707393" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#276707393">(Mar 26 2022 at 05:36)</a>:</h4>
<p>Yep. No rush</p>



<a name="276722327"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/276722327" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jurek Breuninger <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#276722327">(Mar 26 2022 at 11:57)</a>:</h4>
<p><span class="user-mention" data-user-id="361169">@Anton</span> Hi, I ran into the same issue you did with nixGL. nixVulkanIntel cannot be installed from nix-channel. But when I clone the repo and try <code>nix-env -f ./ -iA nixgl.auto.nixVulkanIntel</code> I still get <code>error: attribute 'nixgl' in selection path 'nixgl.auto.nixVulkanIntel' not found</code>. What did you do? (or anybody else that got nixVulkanIntel to work)</p>



<a name="276728817"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/276728817" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#276728817">(Mar 26 2022 at 14:30)</a>:</h4>
<p>What OS?</p>



<a name="276729272"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/276729272" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#276729272">(Mar 26 2022 at 14:42)</a>:</h4>
<p>If actual nix os, I know their is s nix flakes PR rn due to it running into some bugs. Not sure if it is the solution though.</p>



<a name="276729287"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/276729287" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#276729287">(Mar 26 2022 at 14:43)</a>:</h4>
<p><a href="https://github.com/rtfeldman/roc/pull/2732">https://github.com/rtfeldman/roc/pull/2732</a></p>



<a name="276738356"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/276738356" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#276738356">(Mar 26 2022 at 18:10)</a>:</h4>
<p>Hi Jurek, I'll take a look on Monday.</p>



<a name="276740704"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/276740704" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jurek Breuninger <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#276740704">(Mar 26 2022 at 19:06)</a>:</h4>
<p><span class="user-mention silent" data-user-id="343810">Brendan Hansknecht</span> <a href="#narrow/stream/231634-beginners/topic/building.20from.20source/near/276728817">said</a>:</p>
<blockquote>
<p>What OS?</p>
</blockquote>
<p>Arch Linux</p>



<a name="276807840"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/276807840" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jake <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#276807840">(Mar 27 2022 at 21:06)</a>:</h4>
<p>I've opened a PR for my GNU/Linux + ARM build issues, though I still have a few tests which I have not been able to have succeed on my system (more details in the PR)<br>
<a href="https://github.com/rtfeldman/roc/pull/2774">https://github.com/rtfeldman/roc/pull/2774</a><br>
I'm just feeling my way through all of this so happy to have suggestions</p>



<a name="276808493"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/276808493" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#276808493">(Mar 27 2022 at 21:20)</a>:</h4>
<p>Oh, extra note, some tests may not pass without much more work. I know that on M1 we have some bugs. Might affect you too.</p>



<a name="276808912"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/276808912" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#276808912">(Mar 27 2022 at 21:29)</a>:</h4>
<p><code>gui</code> is very slow to build, so it may just need a bit longer (it can take, idk maybe up to 5/10 min the first time)</p>



<a name="276808937"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/276808937" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#276808937">(Mar 27 2022 at 21:29)</a>:</h4>
<p>for <code>astar</code> it would be interesting to see the valgrind output, that is <code>valgrind valgrind --leak-check=full --track-origins=yes ./test-astar</code> in the <code>examples/benchmarks</code> folder</p>



<a name="277005599"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/277005599" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#277005599">(Mar 29 2022 at 13:38)</a>:</h4>
<p><span class="user-mention" data-user-id="485476">@Jurek Breuninger</span> I created an issue on the nixGL repo, resolving that should make it easy to fix things for your case.</p>



<a name="277225084"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/277225084" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jake <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#277225084">(Mar 31 2022 at 02:13)</a>:</h4>
<p><span class="user-mention silent" data-user-id="281543">Folkert de Vries</span> <a href="#narrow/stream/231634-beginners/topic/building.20from.20source/near/276808912">said</a>:</p>
<blockquote>
<p><code>gui</code> is very slow to build, so it may just need a bit longer (it can take, idk maybe up to 5/10 min the first time)</p>
</blockquote>
<p>you were right, it just took a while to build. However, I still can't run it successfully. I'll share the output here in case it help, but I haven't spent any time digging into it yet:</p>
<div class="codehilite" data-code-language="Bash"><pre><span></span><code>---- cli_run::gui stdout ----
thread <span class="s1">'cli_run::gui'</span> panicked at <span class="s1">'roc build had stderr: ld: /home/jake/roc/examples/gui/platform/host.o:(.data..L_MergedGlobals+0x18): undefined reference to `__dso_handle'</span>
ld: /usr/lib/aarch64-linux-gnu/libc_nonshared.a<span class="o">(</span>pthread_atfork.oS<span class="o">)</span>: <span class="k">in</span> <span class="k">function</span> <span class="sb">`</span>__pthread_atfork<span class="s1">':</span>
<span class="s1">(.text+0x0): undefined reference to `__dso_handle'</span>
ld: <span class="o">(</span>.text+0x4<span class="o">)</span>: undefined reference to <span class="sb">`</span>__dso_handle<span class="s1">'</span>
<span class="s1">ld: /home/jake/roc/examples/gui/hello-gui: hidden symbol `__dso_handle'</span> isn<span class="s1">'t defined</span>
<span class="s1">ld: final link failed: bad value</span>
<span class="s1">'</span>, cli/tests/cli_run.rs:87:13
</code></pre></div>



<a name="277225172"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/277225172" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jake <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#277225172">(Mar 31 2022 at 02:15)</a>:</h4>
<p><span class="user-mention silent" data-user-id="281543">Folkert de Vries</span> <a href="#narrow/stream/231634-beginners/topic/building.20from.20source/near/276808937">said</a>:</p>
<blockquote>
<p>for <code>astar</code> it would be interesting to see the valgrind output, that is <code>valgrind valgrind --leak-check=full --track-origins=yes ./test-astar</code> in the <code>examples/benchmarks</code> folder</p>
</blockquote>
<p>I'm not familiar with valgrind or how to use it yet, but here's the output (in a gist since it's so long) in case it helps you:<br>
<a href="https://gist.github.com/SylvanSign/64d23f9c72e65359c0db4f0566bb0296">https://gist.github.com/SylvanSign/64d23f9c72e65359c0db4f0566bb0296</a></p>



<a name="278095201"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/278095201" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nikita Mounier <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#278095201">(Apr 06 2022 at 22:33)</a>:</h4>
<p>Hi, I'm sorry if messages in this thread are getting a bit repetitive with people getting some variation of the same error when building from source...<br>
When I run <code>cargo build</code>, I get this error:</p>
<div class="codehilite" data-code-language="Fish"><pre><span></span><code>error: failed to run custom build <span class="nb">command </span><span class="k">for</span> <span class="err">`</span>roc_builtins v0.1.0 <span class="o">(</span>/Users/nikitamounier/Desktop/roc/compiler/builtins<span class="o">)</span><span class="err">`</span>

Caused by:
  process didn<span class="s1">'t exit successfully: `/Users/nikitamounier/Desktop/roc/target/debug/build/roc_builtins-4cc28b6b1e39ca55/build-script-build` (exit status: 101)</span>
<span class="s1">  --- stdout</span>
<span class="s1">  cargo:rerun-if-changed=build.rs</span>
<span class="s1">  Compiling host ir to: /Users/nikitamounier/Desktop/roc/compiler/builtins/bitcode/builtins-host.ll</span>

<span class="s1">  --- stderr</span>
<span class="s1">  thread '</span>main<span class="s1">' panicked at '</span>zig failed: error: unable to create compilation: FileNotFound
  <span class="err">'</span>, compiler/builtins/build.rs:170:17
  note: run with <span class="err">`</span><span class="nv">RUST_BACKTRACE</span><span class="o">=</span>1<span class="err">`</span> environment variable to display a backtrace
warning: build failed, waiting <span class="k">for</span> other <span class="nb">jobs </span>to finish...
error: build failed
</code></pre></div>
<p>I'm running macOS Monterey on an M1 with the nix-shell. According to <code>llvm-config --version</code>, I'm on LLVM 12.01, and according to <code>zig version</code> I'm on zig 0.8.1. I'm able to run <code>zig build run</code> on a simple hello-world zig project. </p>
<p>Any idea what I could be doing wrong?</p>



<a name="278095872"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/278095872" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#278095872">(Apr 06 2022 at 22:41)</a>:</h4>
<p>Sometimes that just flakily fails on my M1 mac and I simply have to run cargo build twice. So try running it again before anything else</p>



<a name="278096471"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/278096471" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nikita Mounier <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#278096471">(Apr 06 2022 at 22:49)</a>:</h4>
<p>Hi! Yeah I've tried running cargo build a couple times now, quit my terminal session in between sometimes and all. No luck for me yet, still getting the same error message</p>



<a name="278097341"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/278097341" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#278097341">(Apr 06 2022 at 22:59)</a>:</h4>
<p>Just a note, one general option is just to use nix and it should auto-magically work. Otherwise, I'll try to look into this more in a bit to figure out what is going on.</p>



<a name="278098234"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/278098234" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nikita Mounier <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#278098234">(Apr 06 2022 at 23:07)</a>:</h4>
<p>That's just the thing --- I am using nix (that's what I meant when I said I'm on an M1 with nix-shell), which makes it all the more perplexing...</p>



<a name="278104515"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/278104515" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#278104515">(Apr 07 2022 at 00:32)</a>:</h4>
<p>Sorry, I missed the nix line. Can you run with <code>RUST_BACKTRACE=1</code> I want to see which specific zig command is failing</p>



<a name="278105862"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/278105862" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#278105862">(Apr 07 2022 at 00:56)</a>:</h4>
<p>Actually, I am able to reproduce in a pure shell. Let me debug.</p>



<a name="278107138"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/278107138" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nikita Mounier <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#278107138">(Apr 07 2022 at 01:18)</a>:</h4>
<p>Sure! Here's the stacktrace when I run with <code>RUST_BACKTRACE=1</code>:</p>
<div class="codehilite" data-code-language="Swift"><pre><span></span><code><span class="n">stack</span> <span class="n">backtrace</span><span class="p">:</span>
     <span class="mi">0</span><span class="p">:</span> <span class="n">rust_begin_unwind</span>
               <span class="n">at</span> <span class="o">/</span><span class="n">rustc</span><span class="o">/</span><span class="mi">02072</span><span class="n">b482a8b5357f7fb5e5637444ae30e423c40</span><span class="o">/</span><span class="n">library</span><span class="o">/</span><span class="n">std</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">panicking</span><span class="p">.</span><span class="n">rs</span><span class="p">:</span><span class="mi">498</span><span class="p">:</span><span class="mi">5</span>
     <span class="mi">1</span><span class="p">:</span> <span class="n">core</span><span class="p">::</span><span class="n">panicking</span><span class="p">::</span><span class="n">panic_fmt</span>
               <span class="n">at</span> <span class="o">/</span><span class="n">rustc</span><span class="o">/</span><span class="mi">02072</span><span class="n">b482a8b5357f7fb5e5637444ae30e423c40</span><span class="o">/</span><span class="n">library</span><span class="o">/</span><span class="n">core</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">panicking</span><span class="p">.</span><span class="n">rs</span><span class="p">:</span><span class="mi">107</span><span class="p">:</span><span class="mi">14</span>
     <span class="mi">2</span><span class="p">:</span> <span class="n">build_script_build</span><span class="p">::</span><span class="n">run_command</span>
               <span class="n">at</span> <span class="p">.</span><span class="o">/</span><span class="n">build</span><span class="p">.</span><span class="n">rs</span><span class="p">:</span><span class="mi">170</span><span class="p">:</span><span class="mi">17</span>
     <span class="mi">3</span><span class="p">:</span> <span class="n">build_script_build</span><span class="p">::</span><span class="n">generate_bc_file</span>
               <span class="n">at</span> <span class="p">.</span><span class="o">/</span><span class="n">build</span><span class="p">.</span><span class="n">rs</span><span class="p">:</span><span class="mi">134</span><span class="p">:</span><span class="mi">5</span>
     <span class="mi">4</span><span class="p">:</span> <span class="n">build_script_build</span><span class="p">::</span><span class="n">main</span>
               <span class="n">at</span> <span class="p">.</span><span class="o">/</span><span class="n">build</span><span class="p">.</span><span class="n">rs</span><span class="p">:</span><span class="mi">39</span><span class="p">:</span><span class="mi">5</span>
     <span class="mi">5</span><span class="p">:</span> <span class="n">core</span><span class="p">::</span><span class="n">ops</span><span class="p">::</span><span class="n">function</span><span class="p">::</span><span class="n">FnOnce</span><span class="p">::</span><span class="n">call_once</span>
               <span class="n">at</span> <span class="o">/</span><span class="n">rustc</span><span class="o">/</span><span class="mi">02072</span><span class="n">b482a8b5357f7fb5e5637444ae30e423c40</span><span class="o">/</span><span class="n">library</span><span class="o">/</span><span class="n">core</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">ops</span><span class="o">/</span><span class="n">function</span><span class="p">.</span><span class="n">rs</span><span class="p">:</span><span class="mi">227</span><span class="p">:</span><span class="mi">5</span>
  <span class="n">note</span><span class="p">:</span> <span class="n">Some</span> <span class="n">details</span> <span class="n">are</span> <span class="n">omitted</span><span class="p">,</span> <span class="n">run</span> <span class="n">with</span> <span class="p">`</span><span class="n">RUST_BACKTRACE</span><span class="p">=</span><span class="n">full</span><span class="p">`</span> <span class="k">for</span> <span class="n">a</span> <span class="n">verbose</span> <span class="n">backtrace</span><span class="p">.</span>
</code></pre></div>
<p>Let me know if you'd like the <code>RUST_BACKTRACE=full</code> version!</p>



<a name="278111655"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/278111655" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#278111655">(Apr 07 2022 at 02:50)</a>:</h4>
<p>So I think something is likely messed up with how we setup zig with nix. In a pure nix shell we have some interesting behaviour:</p>
<div class="codehilite" data-code-language="Bash Session"><pre><span></span><code><span class="gp">[nix-shell:~/Projects/roc]$ </span>mkdir <span class="nb">test</span>

<span class="gp">[nix-shell:~/Projects/roc]$ </span><span class="nb">cd</span> <span class="nb">test</span>

<span class="gp">[nix-shell:~/Projects/roc/test]$ </span>zig init-exe
<span class="go">info: Created build.zig</span>
<span class="go">info: Created src/main.zig</span>
<span class="go">info: Next, try `zig build --help` or `zig build run`</span>

<span class="gp">[nix-shell:~/Projects/roc/test]$ </span>zig build --help
<span class="go">error: unable to create compilation: FileNotFound</span>
</code></pre></div>



<a name="278111674"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/278111674" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#278111674">(Apr 07 2022 at 02:50)</a>:</h4>
<p>I think the files that are failing to compile are the zig build cache for the standard library or something of that nature. I think nix may be restricting file writing permissions. That is at least my first guess.</p>



<a name="278111773"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/278111773" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#278111773">(Apr 07 2022 at 02:52)</a>:</h4>
<p>Potentially a work around is just making sure that people never use pure nix shells or use tools like direnv/lorri, but I am not sure if they would still run into the issue either way.</p>



<a name="278111962"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/278111962" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jan kili <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#278111962">(Apr 07 2022 at 02:57)</a>:</h4>
<p>I <span aria-label="heart" class="emoji emoji-2764" role="img" title="heart">:heart:</span>️ Nix</p>



<a name="278113117"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/278113117" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#278113117">(Apr 07 2022 at 03:22)</a>:</h4>
<p>I have been poking at this for a bit, and at least for now, I am unsure what specifically is going on. Though I did learn that <code>gimmeMoreOfThoseSweetSweetFileDescriptors()</code> is a function in the zig compiler.</p>



<a name="278113225"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/278113225" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#278113225">(Apr 07 2022 at 03:25)</a>:</h4>
<p>Oh, good news, this issue looks to be fixed with zig 0.9.1</p>



<a name="278113228"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/278113228" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#278113228">(Apr 07 2022 at 03:25)</a>:</h4>
<p>Since the compiler is about to update zig versions, this should be fixed very soon.</p>



<a name="278113579"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/278113579" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#278113579">(Apr 07 2022 at 03:32)</a>:</h4>
<p>The zig 0.9.1 branch isn't fully working, but <span class="user-mention" data-user-id="492598">@Nikita Mounier</span>  can you check if you can at least build the compiler on the <code>update_zig_09</code> branch? (please <code>git pull</code> I just pushed a change to it)</p>



<a name="278148087"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/278148087" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nikita Mounier <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#278148087">(Apr 07 2022 at 11:19)</a>:</h4>
<p>Sure, I'll give it a shot!</p>



<a name="278150900"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/278150900" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nikita Mounier <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#278150900">(Apr 07 2022 at 11:44)</a>:</h4>
<p>Building the compiler works!</p>



<a name="278150990"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/278150990" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nikita Mounier <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#278150990">(Apr 07 2022 at 11:45)</a>:</h4>
<blockquote>
<p>The zig 0.9.1 branch isn't fully working</p>
</blockquote>
<p>What should I look out for that isn't fully working for now?</p>



<a name="278151070"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/278151070" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#278151070">(Apr 07 2022 at 11:46)</a>:</h4>
<p>some functions for strings &lt;-&gt; number conversion</p>



<a name="278151079"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/278151079" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#278151079">(Apr 07 2022 at 11:46)</a>:</h4>
<p>and the tests fail because of memory errors</p>



<a name="278151096"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/278151096" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#278151096">(Apr 07 2022 at 11:46)</a>:</h4>
<p>macos is rather strict in going out of bounds so if you see random segfaults, that might be it</p>



<a name="278151125"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/278151125" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#278151125">(Apr 07 2022 at 11:47)</a>:</h4>
<p>I'll continue work on it tonight/over the weekend, so it should all be fixed soon</p>



<a name="278151129"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/278151129" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nikita Mounier <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#278151129">(Apr 07 2022 at 11:47)</a>:</h4>
<p>I see, thanks for the info. Should be fine for now for me to hack around a little with Roc</p>



<a name="278151141"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/278151141" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nikita Mounier <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#278151141">(Apr 07 2022 at 11:47)</a>:</h4>
<p>Sounds good, thanks a lot!</p>



<a name="278152811"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/278152811" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nikita Mounier <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#278152811">(Apr 07 2022 at 12:01)</a>:</h4>
<p>Ok actually although I'm able to build the compiler, I'm not able to compile a Roc file. When doing <code>cargo run examples/hello-world/helloWorld.roc</code>, I get this error with this stacktrace:</p>
<div class="codehilite" data-code-language="Swift"><pre><span></span><code><span class="err">🔨</span> <span class="n">Rebuilding</span> <span class="n">host</span><span class="p">...</span> <span class="n">Done</span><span class="p">!</span>
<span class="n">thread</span> <span class="err">'</span><span class="n">main</span><span class="err">'</span> <span class="n">panicked</span> <span class="n">at</span> <span class="err">'</span><span class="n">Failed</span> <span class="n">to</span> <span class="n">execute</span> <span class="n">command</span> <span class="err">'</span><span class="n">sw_vers</span> <span class="o">-</span><span class="n">productVersion</span><span class="err">'</span><span class="p">:</span> <span class="n">Os</span> <span class="p">{</span> <span class="n">code</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="n">kind</span><span class="p">:</span> <span class="n">NotFound</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="s">"No such file or directory"</span> <span class="p">}</span><span class="err">'</span><span class="p">,</span> <span class="n">compiler</span><span class="o">/</span><span class="n">build</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">link</span><span class="p">.</span><span class="n">rs</span><span class="p">:</span><span class="mi">1006</span><span class="p">:</span><span class="mi">10</span>
<span class="n">stack</span> <span class="n">backtrace</span><span class="p">:</span>
   <span class="mi">0</span><span class="p">:</span> <span class="n">rust_begin_unwind</span>
             <span class="n">at</span> <span class="o">/</span><span class="n">rustc</span><span class="o">/</span><span class="mi">02072</span><span class="n">b482a8b5357f7fb5e5637444ae30e423c40</span><span class="o">/</span><span class="n">library</span><span class="o">/</span><span class="n">std</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">panicking</span><span class="p">.</span><span class="n">rs</span><span class="p">:</span><span class="mi">498</span><span class="p">:</span><span class="mi">5</span>
   <span class="mi">1</span><span class="p">:</span> <span class="n">core</span><span class="p">::</span><span class="n">panicking</span><span class="p">::</span><span class="n">panic_fmt</span>
             <span class="n">at</span> <span class="o">/</span><span class="n">rustc</span><span class="o">/</span><span class="mi">02072</span><span class="n">b482a8b5357f7fb5e5637444ae30e423c40</span><span class="o">/</span><span class="n">library</span><span class="o">/</span><span class="n">core</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">panicking</span><span class="p">.</span><span class="n">rs</span><span class="p">:</span><span class="mi">107</span><span class="p">:</span><span class="mi">14</span>
   <span class="mi">2</span><span class="p">:</span> <span class="n">core</span><span class="p">::</span><span class="n">result</span><span class="p">::</span><span class="n">unwrap_failed</span>
             <span class="n">at</span> <span class="o">/</span><span class="n">rustc</span><span class="o">/</span><span class="mi">02072</span><span class="n">b482a8b5357f7fb5e5637444ae30e423c40</span><span class="o">/</span><span class="n">library</span><span class="o">/</span><span class="n">core</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">result</span><span class="p">.</span><span class="n">rs</span><span class="p">:</span><span class="mi">1613</span><span class="p">:</span><span class="mi">5</span>
   <span class="mi">3</span><span class="p">:</span> <span class="n">core</span><span class="p">::</span><span class="n">result</span><span class="p">::</span><span class="n">Result</span><span class="p">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">E</span><span class="p">&gt;::</span><span class="n">expect</span>
             <span class="n">at</span> <span class="o">/</span><span class="n">rustc</span><span class="o">/</span><span class="mi">02072</span><span class="n">b482a8b5357f7fb5e5637444ae30e423c40</span><span class="o">/</span><span class="n">library</span><span class="o">/</span><span class="n">core</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">result</span><span class="p">.</span><span class="n">rs</span><span class="p">:</span><span class="mi">1255</span><span class="p">:</span><span class="mi">23</span>
   <span class="mi">4</span><span class="p">:</span> <span class="n">roc_build</span><span class="p">::</span><span class="n">link</span><span class="p">::</span><span class="n">get_macos_version</span>
             <span class="n">at</span> <span class="o">/</span><span class="n">Users</span><span class="o">/</span><span class="n">nikitamounier</span><span class="o">/</span><span class="n">Desktop</span><span class="o">/</span><span class="n">roc</span><span class="o">/</span><span class="n">compiler</span><span class="o">/</span><span class="n">build</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">link</span><span class="p">.</span><span class="n">rs</span><span class="p">:</span><span class="mi">1003</span><span class="p">:</span><span class="mi">22</span>
   <span class="mi">5</span><span class="p">:</span> <span class="n">roc_build</span><span class="p">::</span><span class="n">link</span><span class="p">::</span><span class="n">link_macos</span>
             <span class="n">at</span> <span class="o">/</span><span class="n">Users</span><span class="o">/</span><span class="n">nikitamounier</span><span class="o">/</span><span class="n">Desktop</span><span class="o">/</span><span class="n">roc</span><span class="o">/</span><span class="n">compiler</span><span class="o">/</span><span class="n">build</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">link</span><span class="p">.</span><span class="n">rs</span><span class="p">:</span><span class="mi">931</span><span class="p">:</span><span class="mi">14</span>
   <span class="mi">6</span><span class="p">:</span> <span class="n">roc_build</span><span class="p">::</span><span class="n">link</span><span class="p">::</span><span class="n">link</span>
             <span class="n">at</span> <span class="o">/</span><span class="n">Users</span><span class="o">/</span><span class="n">nikitamounier</span><span class="o">/</span><span class="n">Desktop</span><span class="o">/</span><span class="n">roc</span><span class="o">/</span><span class="n">compiler</span><span class="o">/</span><span class="n">build</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">link</span><span class="p">.</span><span class="n">rs</span><span class="p">:</span><span class="mi">48</span><span class="p">:</span><span class="mi">14</span>
   <span class="mi">7</span><span class="p">:</span> <span class="n">roc_cli</span><span class="p">::</span><span class="n">build</span><span class="p">::</span><span class="n">build_file</span>
             <span class="n">at</span> <span class="o">/</span><span class="n">Users</span><span class="o">/</span><span class="n">nikitamounier</span><span class="o">/</span><span class="n">Desktop</span><span class="o">/</span><span class="n">roc</span><span class="o">/</span><span class="n">cli</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">build</span><span class="p">.</span><span class="n">rs</span><span class="p">:</span><span class="mi">259</span><span class="p">:</span><span class="mi">13</span>
   <span class="mi">8</span><span class="p">:</span> <span class="n">roc_cli</span><span class="p">::</span><span class="n">build</span>
             <span class="n">at</span> <span class="o">/</span><span class="n">Users</span><span class="o">/</span><span class="n">nikitamounier</span><span class="o">/</span><span class="n">Desktop</span><span class="o">/</span><span class="n">roc</span><span class="o">/</span><span class="n">cli</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">lib</span><span class="p">.</span><span class="n">rs</span><span class="p">:</span><span class="mi">332</span><span class="p">:</span><span class="mi">27</span>
   <span class="mi">9</span><span class="p">:</span> <span class="n">roc</span><span class="p">::</span><span class="n">main</span>
             <span class="n">at</span> <span class="o">/</span><span class="n">Users</span><span class="o">/</span><span class="n">nikitamounier</span><span class="o">/</span><span class="n">Desktop</span><span class="o">/</span><span class="n">roc</span><span class="o">/</span><span class="n">cli</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">main</span><span class="p">.</span><span class="n">rs</span><span class="p">:</span><span class="mi">30</span><span class="p">:</span><span class="mi">21</span>
  <span class="mi">10</span><span class="p">:</span> <span class="n">core</span><span class="p">::</span><span class="n">ops</span><span class="p">::</span><span class="n">function</span><span class="p">::</span><span class="n">FnOnce</span><span class="p">::</span><span class="n">call_once</span>
             <span class="n">at</span> <span class="o">/</span><span class="n">rustc</span><span class="o">/</span><span class="mi">02072</span><span class="n">b482a8b5357f7fb5e5637444ae30e423c40</span><span class="o">/</span><span class="n">library</span><span class="o">/</span><span class="n">core</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">ops</span><span class="o">/</span><span class="n">function</span><span class="p">.</span><span class="n">rs</span><span class="p">:</span><span class="mi">227</span><span class="p">:</span><span class="mi">5</span>
</code></pre></div>
<p>Same thing happens with <code>cargo run --release</code>.<br>
I did a quick search on the Zulip chat to see if this error has already popped up for someone, but it seems like it hasn't. What do you think?</p>



<a name="278153550"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/278153550" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#278153550">(Apr 07 2022 at 12:08)</a>:</h4>
<p>yeah this is one of those memory issues</p>



<a name="278158462"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/278158462" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nikita Mounier <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#278158462">(Apr 07 2022 at 12:47)</a>:</h4>
<p>I'm not sure whether this is helpful or not, but I get a different (probably related) error when running <code>cargo run examples/algorithms/fibonacci.roc</code>:</p>
<div class="codehilite" data-code-language="Swift"><pre><span></span><code><span class="n">thread</span> <span class="err">'</span><span class="p">&lt;</span><span class="n">unnamed</span><span class="p">&gt;</span><span class="err">'</span> <span class="n">panicked</span> <span class="n">at</span> <span class="err">'</span><span class="n">TODO</span> <span class="n">gracefully</span> <span class="n">handle</span> <span class="n">unsupported</span> <span class="n">target</span><span class="p">:</span> <span class="n">Triple</span> <span class="p">{</span> <span class="n">architecture</span><span class="p">:</span> <span class="n">Aarch64</span><span class="p">(</span><span class="n">Aarch64</span><span class="p">),</span> <span class="n">vendor</span><span class="p">:</span> <span class="n">Apple</span><span class="p">,</span> <span class="n">operating_system</span><span class="p">:</span> <span class="n">Darwin</span><span class="p">,</span> <span class="n">environment</span><span class="p">:</span> <span class="n">Unknown</span><span class="p">,</span> <span class="n">binary_format</span><span class="p">:</span> <span class="n">Macho</span> <span class="p">}</span><span class="err">'</span><span class="p">,</span> <span class="n">compiler</span><span class="o">/</span><span class="n">build</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">target</span><span class="p">.</span><span class="n">rs</span><span class="p">:</span><span class="mi">75</span><span class="p">:</span><span class="mi">14</span>
<span class="n">stack</span> <span class="n">backtrace</span><span class="p">:</span>
   <span class="mi">0</span><span class="p">:</span> <span class="n">rust_begin_unwind</span>
             <span class="n">at</span> <span class="o">/</span><span class="n">rustc</span><span class="o">/</span><span class="mi">02072</span><span class="n">b482a8b5357f7fb5e5637444ae30e423c40</span><span class="o">/</span><span class="n">library</span><span class="o">/</span><span class="n">std</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">panicking</span><span class="p">.</span><span class="n">rs</span><span class="p">:</span><span class="mi">498</span><span class="p">:</span><span class="mi">5</span>
   <span class="mi">1</span><span class="p">:</span> <span class="n">core</span><span class="p">::</span><span class="n">panicking</span><span class="p">::</span><span class="n">panic_fmt</span>
             <span class="n">at</span> <span class="o">/</span><span class="n">rustc</span><span class="o">/</span><span class="mi">02072</span><span class="n">b482a8b5357f7fb5e5637444ae30e423c40</span><span class="o">/</span><span class="n">library</span><span class="o">/</span><span class="n">core</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">panicking</span><span class="p">.</span><span class="n">rs</span><span class="p">:</span><span class="mi">107</span><span class="p">:</span><span class="mi">14</span>
   <span class="mi">2</span><span class="p">:</span> <span class="n">roc_build</span><span class="p">::</span><span class="n">target</span><span class="p">::</span><span class="n">target_zig_str</span>
             <span class="n">at</span> <span class="p">.</span><span class="o">/</span><span class="n">compiler</span><span class="o">/</span><span class="n">build</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">target</span><span class="p">.</span><span class="n">rs</span><span class="p">:</span><span class="mi">75</span><span class="p">:</span><span class="mi">14</span>
   <span class="mi">3</span><span class="p">:</span> <span class="n">roc_build</span><span class="p">::</span><span class="n">link</span><span class="p">::</span><span class="n">rebuild_host</span>
             <span class="n">at</span> <span class="p">.</span><span class="o">/</span><span class="n">compiler</span><span class="o">/</span><span class="n">build</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">link</span><span class="p">.</span><span class="n">rs</span><span class="p">:</span><span class="mi">460</span><span class="p">:</span><span class="mi">21</span>
   <span class="mi">4</span><span class="p">:</span> <span class="n">roc_cli</span><span class="p">::</span><span class="n">build</span><span class="p">::</span><span class="n">spawn_rebuild_thread</span><span class="p">::{{</span><span class="n">closure</span><span class="p">}}</span>
             <span class="n">at</span> <span class="p">.</span><span class="o">/</span><span class="n">cli</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">build</span><span class="p">.</span><span class="n">rs</span><span class="p">:</span><span class="mi">326</span><span class="p">:</span><span class="mi">17</span>
<span class="n">note</span><span class="p">:</span> <span class="n">Some</span> <span class="n">details</span> <span class="n">are</span> <span class="n">omitted</span><span class="p">,</span> <span class="n">run</span> <span class="n">with</span> <span class="p">`</span><span class="n">RUST_BACKTRACE</span><span class="p">=</span><span class="n">full</span><span class="p">`</span> <span class="k">for</span> <span class="n">a</span> <span class="n">verbose</span> <span class="n">backtrace</span><span class="p">.</span>
<span class="n">thread</span> <span class="err">'</span><span class="n">main</span><span class="err">'</span> <span class="n">panicked</span> <span class="n">at</span> <span class="err">'</span><span class="n">called</span> <span class="p">`</span><span class="n">Result</span><span class="p">::</span><span class="n">unwrap</span><span class="p">()`</span> <span class="n">on</span> <span class="n">an</span> <span class="p">`</span><span class="n">Err</span><span class="p">`</span> <span class="n">value</span><span class="p">:</span> <span class="nb">Any</span> <span class="p">{</span> <span class="p">..</span> <span class="p">}</span><span class="err">'</span><span class="p">,</span> <span class="n">cli</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">build</span><span class="p">.</span><span class="n">rs</span><span class="p">:</span><span class="mi">233</span><span class="p">:</span><span class="mi">50</span>
<span class="n">stack</span> <span class="n">backtrace</span><span class="p">:</span>
   <span class="mi">0</span><span class="p">:</span> <span class="n">rust_begin_unwind</span>
             <span class="n">at</span> <span class="o">/</span><span class="n">rustc</span><span class="o">/</span><span class="mi">02072</span><span class="n">b482a8b5357f7fb5e5637444ae30e423c40</span><span class="o">/</span><span class="n">library</span><span class="o">/</span><span class="n">std</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">panicking</span><span class="p">.</span><span class="n">rs</span><span class="p">:</span><span class="mi">498</span><span class="p">:</span><span class="mi">5</span>
   <span class="mi">1</span><span class="p">:</span> <span class="n">core</span><span class="p">::</span><span class="n">panicking</span><span class="p">::</span><span class="n">panic_fmt</span>
             <span class="n">at</span> <span class="o">/</span><span class="n">rustc</span><span class="o">/</span><span class="mi">02072</span><span class="n">b482a8b5357f7fb5e5637444ae30e423c40</span><span class="o">/</span><span class="n">library</span><span class="o">/</span><span class="n">core</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">panicking</span><span class="p">.</span><span class="n">rs</span><span class="p">:</span><span class="mi">107</span><span class="p">:</span><span class="mi">14</span>
   <span class="mi">2</span><span class="p">:</span> <span class="n">core</span><span class="p">::</span><span class="n">result</span><span class="p">::</span><span class="n">unwrap_failed</span>
             <span class="n">at</span> <span class="o">/</span><span class="n">rustc</span><span class="o">/</span><span class="mi">02072</span><span class="n">b482a8b5357f7fb5e5637444ae30e423c40</span><span class="o">/</span><span class="n">library</span><span class="o">/</span><span class="n">core</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">result</span><span class="p">.</span><span class="n">rs</span><span class="p">:</span><span class="mi">1613</span><span class="p">:</span><span class="mi">5</span>
   <span class="mi">3</span><span class="p">:</span> <span class="n">core</span><span class="p">::</span><span class="n">result</span><span class="p">::</span><span class="n">Result</span><span class="p">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">E</span><span class="p">&gt;::</span><span class="n">unwrap</span>
             <span class="n">at</span> <span class="o">/</span><span class="n">rustc</span><span class="o">/</span><span class="mi">02072</span><span class="n">b482a8b5357f7fb5e5637444ae30e423c40</span><span class="o">/</span><span class="n">library</span><span class="o">/</span><span class="n">core</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">result</span><span class="p">.</span><span class="n">rs</span><span class="p">:</span><span class="mi">1295</span><span class="p">:</span><span class="mi">23</span>
   <span class="mi">4</span><span class="p">:</span> <span class="n">roc_cli</span><span class="p">::</span><span class="n">build</span><span class="p">::</span><span class="n">build_file</span>
             <span class="n">at</span> <span class="p">.</span><span class="o">/</span><span class="n">cli</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">build</span><span class="p">.</span><span class="n">rs</span><span class="p">:</span><span class="mi">233</span><span class="p">:</span><span class="mi">28</span>
   <span class="mi">5</span><span class="p">:</span> <span class="n">roc_cli</span><span class="p">::</span><span class="n">build</span>
             <span class="n">at</span> <span class="p">.</span><span class="o">/</span><span class="n">cli</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">lib</span><span class="p">.</span><span class="n">rs</span><span class="p">:</span><span class="mi">332</span><span class="p">:</span><span class="mi">27</span>
   <span class="mi">6</span><span class="p">:</span> <span class="n">roc</span><span class="p">::</span><span class="n">main</span>
             <span class="n">at</span> <span class="p">.</span><span class="o">/</span><span class="n">cli</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">main</span><span class="p">.</span><span class="n">rs</span><span class="p">:</span><span class="mi">30</span><span class="p">:</span><span class="mi">21</span>
   <span class="mi">7</span><span class="p">:</span> <span class="n">core</span><span class="p">::</span><span class="n">ops</span><span class="p">::</span><span class="n">function</span><span class="p">::</span><span class="n">FnOnce</span><span class="p">::</span><span class="n">call_once</span>
</code></pre></div>
<p>Lmk if there's anything else I can do to help!</p>



<a name="278158811"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/278158811" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#278158811">(Apr 07 2022 at 12:50)</a>:</h4>
<p>huh, that unsupported target is weird. <span class="user-mention" data-user-id="343810">@Brendan Hansknecht</span> how could that happen? you run roc on your M1 right?</p>



<a name="278159790"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/278159790" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ayaz Hafiz <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#278159790">(Apr 07 2022 at 12:58)</a>:</h4>
<p>I ran into that too when running a test yesterday, but it worked on a re-run. We should handle that target correctly: <a href="https://github.com/rtfeldman/roc/blob/37729c08cc8ed6d808e323d7c1ba5a8a79b58228/compiler/build/src/target.rs#L34-L38">https://github.com/rtfeldman/roc/blob/37729c08cc8ed6d808e323d7c1ba5a8a79b58228/compiler/build/src/target.rs#L34-L38</a></p>



<a name="278160133"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/278160133" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nikita Mounier <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#278160133">(Apr 07 2022 at 13:00)</a>:</h4>
<p>I've been running most of the example files to see the different kind of errors I get, it seems like I only get the unsupported target error with algorithms/quicksort.roc, algorithms/fibonacci.roc, and effects/Effect.roc<br>
For the other files it's just the memory-related one</p>



<a name="278160557"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/278160557" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ayaz Hafiz <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#278160557">(Apr 07 2022 at 13:03)</a>:</h4>
<p>This might not be useful, but can you share the output of <code>uname -a; arch</code>?</p>



<a name="278160765"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/278160765" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nikita Mounier <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#278160765">(Apr 07 2022 at 13:05)</a>:</h4>
<p>Sure:</p>
<div class="codehilite" data-code-language="Swift"><pre><span></span><code><span class="n">Darwin</span> <span class="n">Nikitas</span><span class="o">-</span><span class="n">MacBook</span><span class="o">-</span><span class="n">Pro</span><span class="p">.</span><span class="n">local</span> <span class="mf">21.4</span><span class="p">.</span><span class="mi">0</span> <span class="n">Darwin</span> <span class="n">Kernel</span> <span class="n">Version</span> <span class="mf">21.4</span><span class="p">.</span><span class="mi">0</span><span class="p">:</span> <span class="n">Mon</span> <span class="n">Feb</span> <span class="mi">21</span> <span class="mi">20</span><span class="p">:</span><span class="mi">36</span><span class="p">:</span><span class="mi">53</span> <span class="n">PST</span> <span class="mi">2022</span><span class="p">;</span> <span class="n">root</span><span class="p">:</span><span class="n">xnu</span><span class="o">-</span><span class="mf">8020.101</span><span class="p">.</span><span class="mi">4</span><span class="o">~</span><span class="mi">2</span><span class="o">/</span><span class="n">RELEASE_ARM64_T8101</span> <span class="n">arm64</span> <span class="n">arm64</span> <span class="n">MacBookPro17</span><span class="p">,</span><span class="mi">1</span> <span class="n">Darwin</span>
<span class="n">bash</span><span class="p">:</span> <span class="n">arch</span><span class="p">:</span> <span class="n">command</span> <span class="n">not</span> <span class="n">found</span>
</code></pre></div>



<a name="278161535"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/278161535" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ayaz Hafiz <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#278161535">(Apr 07 2022 at 13:10)</a>:</h4>
<p>What is the current commit of the repo you are building from?</p>



<a name="278161764"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/278161764" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nikita Mounier <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#278161764">(Apr 07 2022 at 13:12)</a>:</h4>
<p>Ok, I think I've confirmed that the unsupported-platform error only shows up when using a zig platform in the Roc file. For instance in examples/hello-world/helloWorld.roc, I get the usual memory-related error for c and rust, but only get the unsupported platform one when using zig. The two algorithm files and the Effects.roc file also use zig as the platform.</p>



<a name="278161909"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/278161909" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nikita Mounier <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#278161909">(Apr 07 2022 at 13:14)</a>:</h4>
<p><span class="user-mention" data-user-id="454654">@Ayaz Hafiz</span> </p>
<blockquote>
<p>What is the current commit of the repo you are building from?</p>
</blockquote>
<p>I'm on the update_zig_09 branch using the latest commit dcc876d03aa5df139a6f5402c9d348f5e1be184b</p>



<a name="278162285"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/278162285" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ayaz Hafiz <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#278162285">(Apr 07 2022 at 13:17)</a>:</h4>
<p>Yeah that makes sense, you're hitting a panic in the function that gets the target for building zig code. Looks like that commit is missing the branch for Darwin on Mac. I just pushed 29739876876335b5ab4ca79b04290c58bb7749ed to that branch that should fix it; can you try?</p>



<a name="278162310"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/278162310" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nikita Mounier <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#278162310">(Apr 07 2022 at 13:17)</a>:</h4>
<p>I'm actually also getting the same unsupported-platform error when using <code>web-platform</code> in the helloWorld.roc. Not sure if that's related though</p>



<a name="278162356"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/278162356" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nikita Mounier <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#278162356">(Apr 07 2022 at 13:18)</a>:</h4>
<p>Sure, I'll give it a try</p>



<a name="278163088"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/278163088" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nikita Mounier <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#278163088">(Apr 07 2022 at 13:24)</a>:</h4>
<p>Ok, so I tried compiling algorithms/fibonacci.roc and hello-world/helloWorld.roc using <code>zig-platform</code>, and I'm not getting the unsupported-platform error anymore, but I am getting a new kind of error:</p>
<div class="codehilite" data-code-language="Swift"><pre><span></span><code><span class="n">thread</span> <span class="err">'</span><span class="p">&lt;</span><span class="n">unnamed</span><span class="p">&gt;</span><span class="err">'</span> <span class="n">panicked</span> <span class="n">at</span> <span class="err">'</span><span class="n">Failed</span> <span class="n">to</span> <span class="n">rebuild</span> <span class="n">host</span><span class="p">.</span><span class="n">zig</span> <span class="o">-</span> <span class="n">stderr</span> <span class="n">of</span> <span class="n">the</span> <span class="p">`</span><span class="n">zig</span><span class="p">`</span> <span class="n">command</span> <span class="n">was</span><span class="p">:</span>
<span class="o">/</span><span class="n">Users</span><span class="o">/</span><span class="n">nikitamounier</span><span class="o">/</span><span class="n">Desktop</span><span class="o">/</span><span class="n">roc</span><span class="o">/</span><span class="n">examples</span><span class="o">/</span><span class="n">algorithms</span><span class="o">/</span><span class="n">fibonacci</span><span class="o">-</span><span class="n">platform</span><span class="o">/</span><span class="n">host</span><span class="p">.</span><span class="n">zig</span><span class="p">:</span><span class="mi">28</span><span class="p">:</span><span class="mi">69</span><span class="p">:</span> <span class="n">error</span><span class="p">:</span> <span class="n">use</span> <span class="n">of</span> <span class="n">undeclared</span> <span class="n">identifier</span> <span class="err">'</span><span class="n">c_void</span><span class="err">'</span>
<span class="o">/</span><span class="n">Users</span><span class="o">/</span><span class="n">nikitamounier</span><span class="o">/</span><span class="n">Desktop</span><span class="o">/</span><span class="n">roc</span><span class="o">/</span><span class="n">examples</span><span class="o">/</span><span class="n">algorithms</span><span class="o">/</span><span class="n">fibonacci</span><span class="o">-</span><span class="n">platform</span><span class="o">/</span><span class="n">host</span><span class="p">.</span><span class="n">zig</span><span class="p">:</span><span class="mi">29</span><span class="p">:</span><span class="mi">84</span><span class="p">:</span> <span class="n">error</span><span class="p">:</span> <span class="n">use</span> <span class="n">of</span> <span class="n">undeclared</span> <span class="n">identifier</span> <span class="err">'</span><span class="n">c_void</span><span class="err">'</span>
<span class="o">/</span><span class="n">Users</span><span class="o">/</span><span class="n">nikitamounier</span><span class="o">/</span><span class="n">Desktop</span><span class="o">/</span><span class="n">roc</span><span class="o">/</span><span class="n">examples</span><span class="o">/</span><span class="n">algorithms</span><span class="o">/</span><span class="n">fibonacci</span><span class="o">-</span><span class="n">platform</span><span class="o">/</span><span class="n">host</span><span class="p">.</span><span class="n">zig</span><span class="p">:</span><span class="mi">34</span><span class="p">:</span><span class="mi">65</span><span class="p">:</span> <span class="n">error</span><span class="p">:</span> <span class="n">use</span> <span class="n">of</span> <span class="n">undeclared</span> <span class="n">identifier</span> <span class="err">'</span><span class="n">c_void</span><span class="err">'</span>
<span class="o">/</span><span class="n">Users</span><span class="o">/</span><span class="n">nikitamounier</span><span class="o">/</span><span class="n">Desktop</span><span class="o">/</span><span class="n">roc</span><span class="o">/</span><span class="n">examples</span><span class="o">/</span><span class="n">algorithms</span><span class="o">/</span><span class="n">fibonacci</span><span class="o">-</span><span class="n">platform</span><span class="o">/</span><span class="n">host</span><span class="p">.</span><span class="n">zig</span><span class="p">:</span><span class="mi">45</span><span class="p">:</span><span class="mi">31</span><span class="p">:</span> <span class="n">error</span><span class="p">:</span> <span class="n">use</span> <span class="n">of</span> <span class="n">undeclared</span> <span class="n">identifier</span> <span class="err">'</span><span class="n">c_void</span><span class="err">'</span>
<span class="o">/</span><span class="n">Users</span><span class="o">/</span><span class="n">nikitamounier</span><span class="o">/</span><span class="n">Desktop</span><span class="o">/</span><span class="n">roc</span><span class="o">/</span><span class="n">examples</span><span class="o">/</span><span class="n">algorithms</span><span class="o">/</span><span class="n">fibonacci</span><span class="o">-</span><span class="n">platform</span><span class="o">/</span><span class="n">host</span><span class="p">.</span><span class="n">zig</span><span class="p">:</span><span class="mi">54</span><span class="p">:</span><span class="mi">31</span><span class="p">:</span> <span class="n">error</span><span class="p">:</span> <span class="n">use</span> <span class="n">of</span> <span class="n">undeclared</span> <span class="n">identifier</span> <span class="err">'</span><span class="n">c_void</span><span class="err">'</span>
<span class="o">/</span><span class="n">Users</span><span class="o">/</span><span class="n">nikitamounier</span><span class="o">/</span><span class="n">Desktop</span><span class="o">/</span><span class="n">roc</span><span class="o">/</span><span class="n">examples</span><span class="o">/</span><span class="n">algorithms</span><span class="o">/</span><span class="n">fibonacci</span><span class="o">-</span><span class="n">platform</span><span class="o">/</span><span class="n">host</span><span class="p">.</span><span class="n">zig</span><span class="p">:</span><span class="mi">63</span><span class="p">:</span><span class="mi">29</span><span class="p">:</span> <span class="n">error</span><span class="p">:</span> <span class="n">use</span> <span class="n">of</span> <span class="n">undeclared</span> <span class="n">identifier</span> <span class="err">'</span><span class="n">c_void</span><span class="err">'</span>
<span class="err">'</span><span class="p">,</span> <span class="n">compiler</span><span class="o">/</span><span class="n">build</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">link</span><span class="p">.</span><span class="n">rs</span><span class="p">:</span><span class="mi">1111</span><span class="p">:</span><span class="mi">27</span>
<span class="n">stack</span> <span class="n">backtrace</span><span class="p">:</span>
   <span class="mi">0</span><span class="p">:</span> <span class="n">rust_begin_unwind</span>
             <span class="n">at</span> <span class="o">/</span><span class="n">rustc</span><span class="o">/</span><span class="mi">02072</span><span class="n">b482a8b5357f7fb5e5637444ae30e423c40</span><span class="o">/</span><span class="n">library</span><span class="o">/</span><span class="n">std</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">panicking</span><span class="p">.</span><span class="n">rs</span><span class="p">:</span><span class="mi">498</span><span class="p">:</span><span class="mi">5</span>
   <span class="mi">1</span><span class="p">:</span> <span class="n">core</span><span class="p">::</span><span class="n">panicking</span><span class="p">::</span><span class="n">panic_fmt</span>
             <span class="n">at</span> <span class="o">/</span><span class="n">rustc</span><span class="o">/</span><span class="mi">02072</span><span class="n">b482a8b5357f7fb5e5637444ae30e423c40</span><span class="o">/</span><span class="n">library</span><span class="o">/</span><span class="n">core</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">panicking</span><span class="p">.</span><span class="n">rs</span><span class="p">:</span><span class="mi">107</span><span class="p">:</span><span class="mi">14</span>
   <span class="mi">2</span><span class="p">:</span> <span class="n">roc_build</span><span class="p">::</span><span class="n">link</span><span class="p">::</span><span class="n">validate_output</span>
             <span class="n">at</span> <span class="p">.</span><span class="o">/</span><span class="n">compiler</span><span class="o">/</span><span class="n">build</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">link</span><span class="p">.</span><span class="n">rs</span><span class="p">:</span><span class="mi">1111</span><span class="p">:</span><span class="mi">27</span>
   <span class="mi">3</span><span class="p">:</span> <span class="n">roc_build</span><span class="p">::</span><span class="n">link</span><span class="p">::</span><span class="n">rebuild_host</span>
             <span class="n">at</span> <span class="p">.</span><span class="o">/</span><span class="n">compiler</span><span class="o">/</span><span class="n">build</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">link</span><span class="p">.</span><span class="n">rs</span><span class="p">:</span><span class="mi">469</span><span class="p">:</span><span class="mi">9</span>
   <span class="mi">4</span><span class="p">:</span> <span class="n">roc_cli</span><span class="p">::</span><span class="n">build</span><span class="p">::</span><span class="n">spawn_rebuild_thread</span><span class="p">::{{</span><span class="n">closure</span><span class="p">}}</span>
             <span class="n">at</span> <span class="p">.</span><span class="o">/</span><span class="n">cli</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">build</span><span class="p">.</span><span class="n">rs</span><span class="p">:</span><span class="mi">326</span><span class="p">:</span><span class="mi">17</span>
<span class="n">note</span><span class="p">:</span> <span class="n">Some</span> <span class="n">details</span> <span class="n">are</span> <span class="n">omitted</span><span class="p">,</span> <span class="n">run</span> <span class="n">with</span> <span class="p">`</span><span class="n">RUST_BACKTRACE</span><span class="p">=</span><span class="n">full</span><span class="p">`</span> <span class="k">for</span> <span class="n">a</span> <span class="n">verbose</span> <span class="n">backtrace</span><span class="p">.</span>
<span class="n">thread</span> <span class="err">'</span><span class="n">main</span><span class="err">'</span> <span class="n">panicked</span> <span class="n">at</span> <span class="err">'</span><span class="n">called</span> <span class="p">`</span><span class="n">Result</span><span class="p">::</span><span class="n">unwrap</span><span class="p">()`</span> <span class="n">on</span> <span class="n">an</span> <span class="p">`</span><span class="n">Err</span><span class="p">`</span> <span class="n">value</span><span class="p">:</span> <span class="nb">Any</span> <span class="p">{</span> <span class="p">..</span> <span class="p">}</span><span class="err">'</span><span class="p">,</span> <span class="n">cli</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">build</span><span class="p">.</span><span class="n">rs</span><span class="p">:</span><span class="mi">233</span><span class="p">:</span><span class="mi">50</span>
<span class="n">stack</span> <span class="n">backtrace</span><span class="p">:</span>
   <span class="mi">0</span><span class="p">:</span> <span class="n">rust_begin_unwind</span>
             <span class="n">at</span> <span class="o">/</span><span class="n">rustc</span><span class="o">/</span><span class="mi">02072</span><span class="n">b482a8b5357f7fb5e5637444ae30e423c40</span><span class="o">/</span><span class="n">library</span><span class="o">/</span><span class="n">std</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">panicking</span><span class="p">.</span><span class="n">rs</span><span class="p">:</span><span class="mi">498</span><span class="p">:</span><span class="mi">5</span>
   <span class="mi">1</span><span class="p">:</span> <span class="n">core</span><span class="p">::</span><span class="n">panicking</span><span class="p">::</span><span class="n">panic_fmt</span>
             <span class="n">at</span> <span class="o">/</span><span class="n">rustc</span><span class="o">/</span><span class="mi">02072</span><span class="n">b482a8b5357f7fb5e5637444ae30e423c40</span><span class="o">/</span><span class="n">library</span><span class="o">/</span><span class="n">core</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">panicking</span><span class="p">.</span><span class="n">rs</span><span class="p">:</span><span class="mi">107</span><span class="p">:</span><span class="mi">14</span>
   <span class="mi">2</span><span class="p">:</span> <span class="n">core</span><span class="p">::</span><span class="n">result</span><span class="p">::</span><span class="n">unwrap_failed</span>
             <span class="n">at</span> <span class="o">/</span><span class="n">rustc</span><span class="o">/</span><span class="mi">02072</span><span class="n">b482a8b5357f7fb5e5637444ae30e423c40</span><span class="o">/</span><span class="n">library</span><span class="o">/</span><span class="n">core</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">result</span><span class="p">.</span><span class="n">rs</span><span class="p">:</span><span class="mi">1613</span><span class="p">:</span><span class="mi">5</span>
   <span class="mi">3</span><span class="p">:</span> <span class="n">core</span><span class="p">::</span><span class="n">result</span><span class="p">::</span><span class="n">Result</span><span class="p">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">E</span><span class="p">&gt;::</span><span class="n">unwrap</span>
             <span class="n">at</span> <span class="o">/</span><span class="n">rustc</span><span class="o">/</span><span class="mi">02072</span><span class="n">b482a8b5357f7fb5e5637444ae30e423c40</span><span class="o">/</span><span class="n">library</span><span class="o">/</span><span class="n">core</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">result</span><span class="p">.</span><span class="n">rs</span><span class="p">:</span><span class="mi">1295</span><span class="p">:</span><span class="mi">23</span>
   <span class="mi">4</span><span class="p">:</span> <span class="n">roc_cli</span><span class="p">::</span><span class="n">build</span><span class="p">::</span><span class="n">build_file</span>
             <span class="n">at</span> <span class="p">.</span><span class="o">/</span><span class="n">cli</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">build</span><span class="p">.</span><span class="n">rs</span><span class="p">:</span><span class="mi">233</span><span class="p">:</span><span class="mi">28</span>
   <span class="mi">5</span><span class="p">:</span> <span class="n">roc_cli</span><span class="p">::</span><span class="n">build</span>
             <span class="n">at</span> <span class="p">.</span><span class="o">/</span><span class="n">cli</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">lib</span><span class="p">.</span><span class="n">rs</span><span class="p">:</span><span class="mi">332</span><span class="p">:</span><span class="mi">27</span>
   <span class="mi">6</span><span class="p">:</span> <span class="n">roc</span><span class="p">::</span><span class="n">main</span>
             <span class="n">at</span> <span class="p">.</span><span class="o">/</span><span class="n">cli</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">main</span><span class="p">.</span><span class="n">rs</span><span class="p">:</span><span class="mi">30</span><span class="p">:</span><span class="mi">21</span>
   <span class="mi">7</span><span class="p">:</span> <span class="n">core</span><span class="p">::</span><span class="n">ops</span><span class="p">::</span><span class="n">function</span><span class="p">::</span><span class="n">FnOnce</span><span class="p">::</span><span class="n">call_once</span>
             <span class="n">at</span> <span class="o">/</span><span class="n">rustc</span><span class="o">/</span><span class="mi">02072</span><span class="n">b482a8b5357f7fb5e5637444ae30e423c40</span><span class="o">/</span><span class="n">library</span><span class="o">/</span><span class="n">core</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">ops</span><span class="o">/</span><span class="n">function</span><span class="p">.</span><span class="n">rs</span><span class="p">:</span><span class="mi">227</span><span class="p">:</span><span class="mi">5</span>
</code></pre></div>



<a name="278164162"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/278164162" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ayaz Hafiz <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#278164162">(Apr 07 2022 at 13:33)</a>:</h4>
<p>Okay I fixed the zig errors and I think it should actually work now. Can you pull and try?</p>



<a name="278164834"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/278164834" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nikita Mounier <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#278164834">(Apr 07 2022 at 13:38)</a>:</h4>
<p>Yep, I'm not getting the zig-specific errors anymore (except in interactive/effects.roc which I forgot to mention up above) – I'm only getting the memory-related errors now from before</p>



<a name="278164911"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/278164911" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ayaz Hafiz <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#278164911">(Apr 07 2022 at 13:39)</a>:</h4>
<p>Pushed compile error fixes for effects.roc now too, but there are segfaults there when you actually run it :)</p>



<a name="278165254"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/278165254" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ayaz Hafiz <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#278165254">(Apr 07 2022 at 13:41)</a>:</h4>
<p>Are <code>arch</code> and <code>sw_vers</code> present under your <code>/usr/bin</code>?</p>



<a name="278169138"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/278169138" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nikita Mounier <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#278169138">(Apr 07 2022 at 14:08)</a>:</h4>
<blockquote>
<p>Are <code>arch</code> and <code>sw_vers</code> present under your <code>/usr/bin</code>?</p>
</blockquote>
<p>Yep!</p>



<a name="278169228"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/278169228" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nikita Mounier <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#278169228">(Apr 07 2022 at 14:09)</a>:</h4>
<blockquote>
<p>Pushed compile error fixes for effects.roc now too, but there are segfaults there when you actually run it :)</p>
</blockquote>
<p>Can confirm, same here.</p>



<a name="278169495"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/278169495" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ayaz Hafiz <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#278169495">(Apr 07 2022 at 14:11)</a>:</h4>
<p>Is <code>/usr/bin</code> in your path? Your error with <code>cargo run examples/hello-world/helloWorld.roc</code> is presumably because <code>sw_vers</code> couldn't be run</p>



<a name="278177193"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/278177193" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nikita Mounier <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#278177193">(Apr 07 2022 at 15:02)</a>:</h4>
<p>You're right that's my mistake --- my default shell is fish, but I forgot that nix uses bash, so had to update my .bashrc path.</p>



<a name="278178251"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/278178251" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nikita Mounier <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#278178251">(Apr 07 2022 at 15:08)</a>:</h4>
<p>So I'm back to getting the same zig error as before (the <code>c_void</code>) one from up above, with the same stacktrace, in interactive/tui.roc and hello-world/helloWorld.roc (on <code>zig-platform</code>). Otherwise, everything else compiles very nicely! Just whenever I do some Stdin input (like on interactive/echo.roc), I get back a seg fault 11.</p>



<a name="278178995"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/278178995" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#278178995">(Apr 07 2022 at 15:13)</a>:</h4>
<p>I think <code>c_void</code> was just a change between zig 0.8.1 an 0.9.1. So the example probably hasn't been updated yet</p>



<a name="278179014"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/278179014" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#278179014">(Apr 07 2022 at 15:13)</a>:</h4>
<p>It is now <code>anyopaque</code></p>



<a name="278214950"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/278214950" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nikita Mounier <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#278214950">(Apr 07 2022 at 19:31)</a>:</h4>
<p>It's been working like a charm, until just recently where whenever I try to do a <code>cargo build</code> or <code>cargo run</code>, it's unable to compile the <code>roc_cli</code> with:</p>
<div class="codehilite" data-code-language="Swift"><pre><span></span><code><span class="n">error</span><span class="p">:</span> <span class="n">linking</span> <span class="n">with</span> <span class="p">`</span><span class="n">cc</span><span class="p">`</span> <span class="n">failed</span><span class="p">:</span> <span class="n">exit</span> <span class="n">status</span><span class="p">:</span> <span class="mi">1</span>
  <span class="o">|</span>
  <span class="p">=</span> <span class="n">note</span><span class="p">:</span> <span class="s">"cc"</span> <span class="s">"-arch"</span> <span class="s">"arm64"</span> <span class="p">......</span>
  <span class="p">=</span> <span class="n">note</span><span class="p">:</span> <span class="n">ld</span><span class="p">:</span> <span class="n">library</span> <span class="n">not</span> <span class="n">found</span> <span class="k">for</span> <span class="o">-</span><span class="n">ltinfo</span>
          <span class="n">clang</span><span class="p">:</span> <span class="n">error</span><span class="p">:</span> <span class="n">linker</span> <span class="n">command</span> <span class="n">failed</span> <span class="n">with</span> <span class="n">exit</span> <span class="n">code</span> <span class="mi">1</span> <span class="p">(</span><span class="n">use</span> <span class="o">-</span><span class="n">v</span> <span class="n">to</span> <span class="n">see</span> <span class="n">invocation</span><span class="p">)</span>
</code></pre></div>
<p>I'm not sure why this error is popping up now, I don't think I changed anything or inadvertently removed a file. I downloaded a clean build of the repo and all, but to no avail --- same error.</p>



<a name="278345847"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/278345847" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nikita Mounier <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#278345847">(Apr 08 2022 at 18:43)</a>:</h4>
<p>I've been looking around online to see how to fix the issue – I found this potential solution:</p>
<div class="codehilite" data-code-language="Swift"><pre><span></span><code><span class="n">cd</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">lib</span>
<span class="n">ln</span> <span class="o">-</span><span class="n">s</span> <span class="n">libncurses</span><span class="p">.</span><span class="n">so</span><span class="p">.</span><span class="mi">5</span> <span class="n">libtinfo</span><span class="p">.</span><span class="n">so</span><span class="p">.</span><span class="mi">5</span>
<span class="n">ln</span> <span class="o">-</span><span class="n">s</span> <span class="n">libtinfo</span><span class="p">.</span><span class="n">so</span><span class="p">.</span><span class="mi">5</span> <span class="n">libtinfo</span><span class="p">.</span><span class="n">so</span>
</code></pre></div>
<p>What do you think?</p>



<a name="278345983"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/278345983" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ayaz Hafiz <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#278345983">(Apr 08 2022 at 18:44)</a>:</h4>
<p>what does “which cc” say?</p>



<a name="278347251"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/278347251" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nikita Mounier <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#278347251">(Apr 08 2022 at 18:55)</a>:</h4>
<div class="codehilite" data-code-language="Swift"><pre><span></span><code><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">cc</span>
</code></pre></div>



<a name="278347487"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/278347487" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nikita Mounier <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#278347487">(Apr 08 2022 at 18:56)</a>:</h4>
<p>Is it as simple as me have some libraries missing from my PATH?</p>



<a name="278347737"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/278347737" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ayaz Hafiz <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#278347737">(Apr 08 2022 at 18:58)</a>:</h4>
<p>I think you want the <code>cc</code> from nix. If you updated your bashrc, maybe you want to add <code>/usr/bin</code> to the back of the path rather than the front?</p>



<a name="278347973"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/278347973" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#278347973">(Apr 08 2022 at 19:00)</a>:</h4>
<p>btw that branch should be a lot more usable now, basically everything besides the wasm backend seems to at least work</p>



<a name="278348033"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/278348033" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#278348033">(Apr 08 2022 at 19:00)</a>:</h4>
<p>there are some tricky memory-related issues still, but those won't come up often if you're just playing around</p>



<a name="278350269"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/278350269" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nikita Mounier <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#278350269">(Apr 08 2022 at 19:18)</a>:</h4>
<blockquote>
<p>If you updated your bashrc, maybe you want to add <code>/usr/bin</code> to the back of the path rather than the front?</p>
</blockquote>
<p>I actually ended up downloading a plugin that lets me use fish with nix. Weird thing is, all of the nix-related things like <code>/Users/nikitamounier/.nix-profile/bin</code> are already at the front path. <br>
Here's my PATH for reference:</p>
<div class="codehilite" data-code-language="Swift"><pre><span></span><code><span class="o">/</span><span class="n">nix</span><span class="o">/</span><span class="kd">var</span><span class="o">/</span><span class="n">nix</span><span class="o">/</span><span class="n">profiles</span><span class="o">/</span><span class="k">default</span><span class="o">/</span><span class="n">bin</span> <span class="o">/</span><span class="n">Users</span><span class="o">/</span><span class="n">nikitamounier</span><span class="o">/</span><span class="p">.</span><span class="n">nix</span><span class="o">-</span><span class="n">profile</span><span class="o">/</span><span class="n">bin</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">homebrew</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">libpq</span><span class="o">/</span><span class="n">bin</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">homebrew</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">llvm</span><span class="p">@</span><span class="mi">12</span><span class="o">/</span><span class="n">bin</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">bin</span> <span class="o">/</span><span class="n">Users</span><span class="o">/</span><span class="n">nikitamounier</span><span class="o">/</span><span class="p">.</span><span class="n">cargo</span><span class="o">/</span><span class="n">bin</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">homebrew</span><span class="o">/</span><span class="n">bin</span> <span class="c1">//opt/homebrew/bin /Users/nikitamounier/.fig/bin /Users/nikitamounier/.fzf/bin /bin /usr/sbin /sbin /opt/X11/bin /Library/Apple/usr/bin /Library/TeX/texbin /Applications/kitty.app/Contents/MacOS</span>
</code></pre></div>



<a name="278350974"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/278350974" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ayaz Hafiz <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#278350974">(Apr 08 2022 at 19:25)</a>:</h4>
<p>Are you in a <code>nix-shell</code>?</p>



<a name="278351038"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/278351038" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ayaz Hafiz <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#278351038">(Apr 08 2022 at 19:25)</a>:</h4>
<p>In my nix shell I see a bunch of opaque paths to stuff in <code>nix/store</code> at the front of my path</p>



<a name="278354847"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/278354847" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nikita Mounier <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#278354847">(Apr 08 2022 at 19:58)</a>:</h4>
<p><span aria-label="face palm" class="emoji emoji-1f926" role="img" title="face palm">:face_palm:</span> Forgot that nix-shell has a different PATH. Attempting to move <code>usr/bin</code> to the end of the path, but fish is giving me a weirdly difficult time...</p>



<a name="278356419"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/278356419" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nikita Mounier <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#278356419">(Apr 08 2022 at 20:12)</a>:</h4>
<p>You were right! I was able to finally get the <code>usr/bin</code> to move at the end of PATH, and now it all works. Maybe someone could add to BUILDING_FROM_SOURCE.md that people using nix-shell should do this? I'll be happy to open a PR</p>



<a name="278357057"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/278357057" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ayaz Hafiz <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#278357057">(Apr 08 2022 at 20:18)</a>:</h4>
<p>Feel free to send a PR! All your insights here would be valuable.</p>



<a name="278364049"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/278364049" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nikita Mounier <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#278364049">(Apr 08 2022 at 21:22)</a>:</h4>
<p><span class="user-mention silent" data-user-id="281543">Folkert de Vries</span> <a href="#narrow/stream/231634-beginners/topic/building.20from.20source/near/278347973">said</a>:</p>
<blockquote>
<p>btw that branch should be a lot more usable now, basically everything besides the wasm backend seems to at least work</p>
</blockquote>
<p>Sounds good! Yeah, looks like <code>Stdin</code> still doesn't work for me (getting a SIGSEGV), I guess I'll try to avoid that for now. Everything else works like a charm though!</p>



<a name="278375162"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/278375162" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nikita Mounier <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#278375162">(Apr 08 2022 at 23:49)</a>:</h4>
<p>Actually, it's only the effects-platform and the cli-platform (from examples/interactive) that segfault on user input, the rest work great!</p>



<a name="278963853"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/278963853" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nikita Mounier <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#278963853">(Apr 14 2022 at 13:13)</a>:</h4>
<p><span class="user-mention silent" data-user-id="343810">Brendan Hansknecht</span> <a href="#narrow/stream/231634-beginners/topic/building.20from.20source/near/278113579">said</a>:</p>
<blockquote>
<p>The zig 0.9.1 branch isn't fully working, but <span class="user-mention silent" data-user-id="492598">Nikita Mounier</span>  can you check if you can at least build the compiler on the <code>update_zig_09</code> branch? (please <code>git pull</code> I just pushed a change to it)</p>
</blockquote>
<p>I see the <a href="https://github.com/rtfeldman/roc/pull/2268">Update to Zig 0.9 PR</a> doesn't say WIP anymore – so this will merge with trunk/upstream soon?</p>



<a name="278964061"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/278964061" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#278964061">(Apr 14 2022 at 13:15)</a>:</h4>
<p>yeah, likely somewhere in the next 14 days</p>



<a name="278964087"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/278964087" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#278964087">(Apr 14 2022 at 13:15)</a>:</h4>
<p>merging it is disruptive because everyone needs to get a new zig + llvm version</p>



<a name="278964160"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/278964160" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#278964160">(Apr 14 2022 at 13:16)</a>:</h4>
<p>so we don't want to do that before Richard records his demo, but soon after probably</p>



<a name="278964207"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/278964207" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nikita Mounier <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#278964207">(Apr 14 2022 at 13:16)</a>:</h4>
<p>Gotcha!</p>



<a name="278964262"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/278964262" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nikita Mounier <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#278964262">(Apr 14 2022 at 13:17)</a>:</h4>
<p>Yeah I guess it'll be a smoother experience for those of us who are on <code>nix-shell</code></p>



<a name="278964684"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/278964684" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#278964684">(Apr 14 2022 at 13:20)</a>:</h4>
<p>yeah and in general the upgrade process is a lot smoother now than it was in the past. We know (kinda) what we're doing now</p>



<a name="278964703"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/278964703" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#278964703">(Apr 14 2022 at 13:20)</a>:</h4>
<p>but still, it's complex and we want to time it right</p>



<a name="279038513"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/279038513" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Viktor Ferenczi <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#279038513">(Apr 15 2022 at 00:42)</a>:</h4>
<p>Trying to build Roc from GitHub repo sources on Ubuntu 20.04 running inside WSL (not WSL2). </p>
<p>Ran into this issue on trying to run nix-shell:</p>
<div class="codehilite" data-code-language="Bash Session"><pre><span></span><code><span class="go">Build with /nix/store/m0xw42nwrlfznfasiqfzwdavi4421x32-ghc-8.10.7.</span>
<span class="go">ghc-pkg: Couldn't open database /tmp/nix-build-niv-0.2.19.drv-0/setup-package.conf.d for modification: {handle: /tmp/nix-build-niv-0.2.19.drv-0/setup-package.conf.d/package.cache.lock}: hLock: invalid argument (Invalid argument)</span>
<span class="go">error: builder for '/nix/store/k5cy1lsddvq61hni78jdfyls8rf2ybsk-niv-0.2.19.drv' failed with exit code 1</span>
<span class="go">error: build of '/nix/store/10p69ddbzjzbln6zhpkxlgywlqm6ax3w-zig-0.8.1.drv', '/nix/store/ac6vy5ly0is5xr7jnhabr2kd975gvi6p-debugir.drv', '/nix/store/k5cy1lsddvq61hni78jdfyls8rf2ybsk-niv-0.2.19.drv' failed</span>
</code></pre></div>
<p>Have you seen this error before?</p>
<p>Seems like this issue: <a href="https://github.com/NixOS/nixpkgs/issues/79441">https://github.com/NixOS/nixpkgs/issues/79441</a></p>



<a name="279039036"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/279039036" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#279039036">(Apr 15 2022 at 00:52)</a>:</h4>
<p>Arm?</p>



<a name="279074245"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/279074245" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Viktor Ferenczi <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#279074245">(Apr 15 2022 at 12:02)</a>:</h4>
<p>Just a regular 64 bit Windows on a Ryzen 7 3800X (x86) CPU.</p>



<a name="279074886"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/279074886" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#279074886">(Apr 15 2022 at 12:13)</a>:</h4>
<p>We also have a flake.nix file, can you give <a href="https://nixos.wiki/wiki/Flakes">that</a> a try?</p>



<a name="279740076"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/279740076" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Carroll <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#279740076">(Apr 21 2022 at 21:07)</a>:</h4>
<p>I'm installing Roc on a new installation of Ubuntu 20.04. Installed nix and all the packages. But now I keep getting this error. Any ideas how to fix it?</p>
<div class="codehilite"><pre><span></span><code>[nix-shell:~/code/roc]$ nix rebuild
nix: /nix/store/nprym6lf8lzhp1irb42lb4vp8069l5rj-glibc-2.32-54/lib/libc.so.6: version `GLIBC_2.33&#39; not found (required by /nix/store/dd8swlwhpdhn6bv219562vyxhi8278hs-gcc-10.3.0-lib/lib/libstdc++.so.6)
</code></pre></div>



<a name="279741131"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/279741131" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Carroll <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#279741131">(Apr 21 2022 at 21:17)</a>:</h4>
<p>Actually I still seem to be able to run <code>cargo</code> and things, so it doesn't seem to be really blocking me</p>



<a name="279783866"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/279783866" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Carroll <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#279783866">(Apr 22 2022 at 06:16)</a>:</h4>
<p>OK this is actually blocking me for some commands</p>
<div class="codehilite"><pre><span></span><code>[nix-shell:~/code/roc]$ perf record target/debug/roc build examples/false-interpreter/False.roc
/bin/bash: /nix/store/wgp4l0jl7hm510x5615qsv4xikybzqb3-ncurses-6.2/lib/libtinfo.so.6: no version information available (required by /bin/bash)
/bin/bash: /lib/x86_64-linux-gnu/libc.so.6: version `GLIBC_2.33&#39; not found (required by /nix/store/wgp4l0jl7hm510x5615qsv4xikybzqb3-ncurses-6.2/lib/libtinfo.so.6)
</code></pre></div>



<a name="279784129"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/279784129" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Carroll <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#279784129">(Apr 22 2022 at 06:21)</a>:</h4>
<p>Anyone else using Ubuntu 20.04 with nix? Have you seen anything like this? Did you solve it?</p>



<a name="279787185"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/279787185" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#279787185">(Apr 22 2022 at 07:09)</a>:</h4>
<p>You can use the flake.nix:</p>
<ul>
<li><a href="https://nixos.wiki/wiki/Flakes">install flakes</a> (see Non-NixOS)</li>
<li>reboot</li>
<li>At the root of the repo in a terminal use <code>nix develop</code> (instead of nix-shell)</li>
</ul>
<p>building will spam a different ncurses message but as far as I could tell that one does not affect anything.</p>



<a name="293177652"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/293177652" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Guedes Pinto <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#293177652">(Aug 12 2022 at 19:17)</a>:</h4>
<p>Hi! I am having trouble compiling from source in an ubuntu VM running on an M1 mac.</p>
<ol>
<li>I run into an error when I try <code>nix develop</code>which said:</li>
</ol>
<div class="codehilite" data-code-language="error"><pre><span></span><code>       Did you mean devShell?
</code></pre></div>
<p>I solved this by adding "aarch64-linux" to the supportedSystems in the flake.nix file.</p>
<ol start="2">
<li>I then run into more trouble when doing <code>cargo  run help</code>and <code>cargo build</code>which says:</li>
</ol>
<div class="codehilite" data-code-language="error"><pre><span></span><code>   --&gt; crates/linker/src/lib.rs:505:65
    |
505 | ...                   let c_str = unsafe { CStr::from_ptr(str_bytes.as_ptr() as *const i8) };
    |                                                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ expected `u8`, found `i8`
    |
    = note: expected raw pointer `*const u8`
               found raw pointer `*const i8`

error[E0308]: mismatched types
    --&gt; crates/linker/src/lib.rs:1811:40
     |
1811 |             let c_buf: *const c_char = dynstr_data[dynstr_off..].as_ptr() as *const i8;
     |                        -------------   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ expected `u8`, found `i8`
     |                        |
     |                        expected due to this
     |
     = note: expected raw pointer `*const u8`
                found raw pointer `*const i8`

For more information about this error, try `rustc --explain E0308`.
error: could not compile `roc_linker` due to 2 previous errors
warning: build failed, waiting for other jobs to finish...
</code></pre></div>
<p>Has anyone seen this before? it is a type mismatch from the linker, so this should have come up before right?<br>
I installed everything from scratch following the build from source file. <br>
My system is updated.<br>
Could it be related to the issues with the silicon-Mac platform? Or versioning of some of the required libraries?</p>



<a name="293177875"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/293177875" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Notification Bot <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#293177875">(Aug 12 2022 at 19:18)</a>:</h4>
<p><span class="user-mention silent" data-user-id="521508">Eric Guedes Pinto</span> has marked this topic as resolved.</p>



<a name="293178076"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/293178076" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Notification Bot <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#293178076">(Aug 12 2022 at 19:20)</a>:</h4>
<p><span class="user-mention silent" data-user-id="521508">Eric Guedes Pinto</span> has marked this topic as unresolved.</p>



<a name="293178217"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/293178217" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#293178217">(Aug 12 2022 at 19:20)</a>:</h4>
<p>Hi eric, we do not (yet?) support the aarch64-linux platform. You should be able to run on macos aarch64 though.</p>



<a name="293178334"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/293178334" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Guedes Pinto <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#293178334">(Aug 12 2022 at 19:21)</a>:</h4>
<p>Ok, I'll do that<br>
Thanks</p>



<a name="293180899"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/293180899" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#293180899">(Aug 12 2022 at 19:37)</a>:</h4>
<p>The first error you got was not very clear, I'll make an issue for that.</p>



<a name="293191863"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/293191863" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#293191863">(Aug 12 2022 at 20:57)</a>:</h4>
<p>Oh, the second issue is a bug I have run into before and keep forgetting to fix. We just need to update some types as the error says.</p>



<a name="293191976"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/293191976" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#293191976">(Aug 12 2022 at 20:58)</a>:</h4>
<p>I developed that on x86, but didn't think about generic types because char is unsigned on some platforms and signed on others.</p>



<a name="293192022"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/293192022" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#293192022">(Aug 12 2022 at 20:58)</a>:</h4>
<p>Should be an easy fix, I just am traveling and can't deal with it currently.</p>



<a name="293336573"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/293336573" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ross Smyth <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#293336573">(Aug 14 2022 at 02:11)</a>:</h4>
<p>Hello, I am trying to build Roc from the latest commit on main on Windows, and it fails trying to link the symbols defined in roc_std.<br>
<a href="https://github.com/roc-lang/roc/blob/38a7b6cef0efa339af5d6bed25dfd45f2163f682/crates/roc_std/src/lib.rs#L25-L32">https://github.com/roc-lang/roc/blob/38a7b6cef0efa339af5d6bed25dfd45f2163f682/crates/roc_std/src/lib.rs#L25-L32</a><br>
This has happened with both the MSVC linker, and with LLD. I am not very familiar with linker failure modes so some guidance would be appreciated.</p>
<p>The specific error is:</p>
<div class="codehilite"><pre><span></span><code>note: lld: error: undefined symbol: roc_alloc
          &gt;&gt;&gt; referenced by C:\Users\RossSmyth\Documents\roc\crates\roc_std\src\lib.rs:51
          &gt;&gt;&gt;               libroc_std-c05e5e25b8ffcb50.rlib(roc_std-c05e5e25b8ffcb50.46ifwog7cqzs4dpa.rcgu.o):(roc_std::roc_alloc_refcounted_help::h08260161a777fba6)
</code></pre></div>
<p>repeated for roc_dealloc and roc_realloc but with different object names.</p>
<div class="codehilite"><pre><span></span><code>error: could not compile `roc_load` due to previous error
</code></pre></div>
<p>After the undefined symbol error.</p>



<a name="293338041"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/293338041" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#293338041">(Aug 14 2022 at 02:46)</a>:</h4>
<p>Windows support is very new <span aria-label="sweat smile" class="emoji emoji-1f605" role="img" title="sweat smile">:sweat_smile:</span></p>
<p><span class="user-mention" data-user-id="281543">@Folkert de Vries</span> is this a known issue?</p>



<a name="293381132"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/293381132" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#293381132">(Aug 14 2022 at 12:56)</a>:</h4>
<p>I'll need some more info here. What are you trying to build (what is the command) and where exactly does it fail?</p>



<a name="293381184"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/293381184" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#293381184">(Aug 14 2022 at 12:57)</a>:</h4>
<p>and yeah the status of windows is:  I got it to work once on one machine a little while ago</p>



<a name="293428414"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/293428414" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ross Smyth <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#293428414">(Aug 14 2022 at 18:07)</a>:</h4>
<ol>
<li>git clone</li>
<li>Put the LLVM archive file noted in the docs in <code>LLVM_SYS_130_PREFIX</code></li>
<li>Put the LLVM archive bin directory in PATH</li>
<li>cargo install bindgen</li>
<li><code>cd roc</code></li>
<li>
<p>git pull<br>
(for MSVC linker)</p>
</li>
<li>
<p><code>cargo +1.61.0-msvc build</code><br>
(For LLD)</p>
</li>
<li>
<p><code>$Env:RUSTFLAGS = "-Clinker=lld"</code></p>
</li>
<li>
<p><code>cargo +1.61.0-msvc build</code><br>
(Both, but LLD's error message is much clearer. both have same missing symbols though)</p>
</li>
<li>
<p>Gets to building 416/434 crates (on roc_load) and fails with message above.</p>
</li>
</ol>



<a name="293428510"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/293428510" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#293428510">(Aug 14 2022 at 18:08)</a>:</h4>
<p>hmm, ok</p>



<a name="293428528"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/293428528" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#293428528">(Aug 14 2022 at 18:08)</a>:</h4>
<p>do you know how to set environment variables? (I didn't really)</p>



<a name="293428563"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/293428563" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ross Smyth <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#293428563">(Aug 14 2022 at 18:09)</a>:</h4>
<p>Yeah, that's the <code>$Env:RUSTFLAGS = "-Clinker=lld"</code></p>



<a name="293428575"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/293428575" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#293428575">(Aug 14 2022 at 18:09)</a>:</h4>
<p>we recently added a flag <code>ROC_SKIP_SUBS_CACHE=1 cargo run</code> that should at least make that part work</p>



<a name="293428598"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/293428598" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ross Smyth <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#293428598">(Aug 14 2022 at 18:09)</a>:</h4>
<p>in powershell at least. In cmd you use <code>set RUSTFLAGS = -Clinker=lld</code></p>



<a name="293428671"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/293428671" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ross Smyth <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#293428671">(Aug 14 2022 at 18:10)</a>:</h4>
<p>Alrigth I'll try it</p>



<a name="293429251"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/293429251" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ross Smyth <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#293429251">(Aug 14 2022 at 18:17)</a>:</h4>
<p>Still fails, same location and error. Watching it closely as it is building it seems to fail specifically in the roc_load <a href="http://build.rs">build.rs</a>. I did do <code>cargo +1.61.0-msvc clean</code>to be safe as well.</p>



<a name="293429746"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/293429746" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#293429746">(Aug 14 2022 at 18:23)</a>:</h4>
<p>ok, that is weird and different from what I got</p>



<a name="293429763"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/293429763" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#293429763">(Aug 14 2022 at 18:23)</a>:</h4>
<p>or, well, maybe not</p>



<a name="293429850"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/293429850" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#293429850">(Aug 14 2022 at 18:24)</a>:</h4>
<p>so, basically, we want that <a href="http://build.rs">build.rs</a> script to do nothing</p>



<a name="293429890"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/293429890" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#293429890">(Aug 14 2022 at 18:25)</a>:</h4>
<p>the thing is, msvc on windows does not seem to do dead code elimination, so those function, that are not used, still need to be there on windows for some reason</p>



<a name="293429898"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/293429898" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#293429898">(Aug 14 2022 at 18:25)</a>:</h4>
<p>it is weird that lld also needs them to be there. But maybe this is really a windows-specific thing</p>



<a name="293430269"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/293430269" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#293430269">(Aug 14 2022 at 18:30)</a>:</h4>
<p>I pushed some changes to the <code>disable-subs-caching-windows</code>, can you try that?</p>



<a name="293430303"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/293430303" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#293430303">(Aug 14 2022 at 18:31)</a>:</h4>
<p>hope that compiles, but I hope the idea is clear from <a href="https://github.com/roc-lang/roc/compare/disable-subs-caching-windows">https://github.com/roc-lang/roc/compare/disable-subs-caching-windows</a>: we want to make sure the business logic just does not run on windows</p>



<a name="293430312"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/293430312" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#293430312">(Aug 14 2022 at 18:31)</a>:</h4>
<p>or actually, it's not even there on windows. That's really the important part</p>



<a name="293436526"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/293436526" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ross Smyth <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#293436526">(Aug 14 2022 at 19:48)</a>:</h4>
<p>I nuked my repo and recloned it just to be extra safe, checked out that branch, and same error. It is ignoring them because I get the "unused..." warnings, for example "warning: constant is never used: <code>SKIP_SUBS_CACHE</code>"</p>
<p>I then tried to build it in release (<code>cargo +1.61.0 build --release</code>) since LTO is on in release mode. There are spurious other linker failures in Zig in release before the failure above. Seems to do with file locking? But on a "good " run it still hit the failure above.</p>
<p>My next train of thought was maybe some weird parallel compilation race condition was messing things up, so I attempted to build with <code>cargo +1.61.0-msvc build -j 0</code>. Same failure.</p>



<a name="293437835"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/293437835" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#293437835">(Aug 14 2022 at 20:04)</a>:</h4>
<p>ok well you should now be able to just comment pretty much all of that <a href="http://build.rs">build.rs</a> away</p>



<a name="293437869"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/293437869" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#293437869">(Aug 14 2022 at 20:04)</a>:</h4>
<p>and yes on windows for now at least you'll get a bunch of unused warnings in many places.</p>



<a name="293438461"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/293438461" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ross Smyth <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#293438461">(Aug 14 2022 at 20:10)</a>:</h4>
<p>I just deleted the build file and roc_load finally built! But now the same error some from both roc_cli and roc_docs_cli <span aria-label="sad" class="emoji emoji-2639" role="img" title="sad">:sad:</span></p>



<a name="293440029"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/293440029" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#293440029">(Aug 14 2022 at 20:30)</a>:</h4>
<p>here's a new good first issue involving the repl! <a href="https://github.com/roc-lang/roc/issues/3793">https://github.com/roc-lang/roc/issues/3793</a></p>



<a name="293440065"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/293440065" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#293440065">(Aug 14 2022 at 20:30)</a>:</h4>
<p>if anyone is interested in picking it up, we'd be happy to help you get started on it!</p>



<a name="293441862"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/293441862" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#293441862">(Aug 14 2022 at 20:59)</a>:</h4>
<p>yeah, you can disable that by removing it from the top-level <code>Cargo.toml</code></p>



<a name="293441865"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/293441865" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#293441865">(Aug 14 2022 at 20:59)</a>:</h4>
<p>and then you have something that works</p>



<a name="293445447"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/293445447" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ross Smyth <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#293445447">(Aug 14 2022 at 22:07)</a>:</h4>
<p>That "worked" with some further modification. I'll write up something in an issue.</p>



<a name="293448548"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/293448548" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ross Smyth <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#293448548">(Aug 14 2022 at 23:11)</a>:</h4>
<p><a href="https://github.com/roc-lang/roc/issues/3805">https://github.com/roc-lang/roc/issues/3805</a></p>



<a name="293451155"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/293451155" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Thomas Dwyer <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#293451155">(Aug 15 2022 at 00:10)</a>:</h4>
<p>I don't have much experience in git PRs nor much with Rust, but this seems very approachable. Where could I get started on it? (i also need to get my nix environment set up for the latest version of the compiler, but that's a different issue)</p>



<a name="293452362"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/293452362" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ayaz Hafiz <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#293452362">(Aug 15 2022 at 00:37)</a>:</h4>
<p>Awesome! Two places where the change would need to be made are at <a href="https://github.com/roc-lang/roc/blob/603f6b6613d7d8380a5690700918a3e64b5ae013/crates/repl_eval/src/eval.rs#L337-L345">https://github.com/roc-lang/roc/blob/603f6b6613d7d8380a5690700918a3e64b5ae013/crates/repl_eval/src/eval.rs#L337-L345</a> and <a href="https://github.com/roc-lang/roc/blob/603f6b6613d7d8380a5690700918a3e64b5ae013/crates/repl_eval/src/eval.rs#L548-L552">https://github.com/roc-lang/roc/blob/603f6b6613d7d8380a5690700918a3e64b5ae013/crates/repl_eval/src/eval.rs#L548-L552</a> - that's where we read back a string from the memory of the Roc code executed in the repl, and build up the AST representation of the string expression, which is then printed out. We'll want to change the <code>StrLiteral</code> variant used in the cases where the string is multi-line.</p>
<p>The tests for the repl live in <a href="https://github.com/roc-lang/roc/blob/main/crates/repl_test/src/tests.rs">https://github.com/roc-lang/roc/blob/main/crates/repl_test/src/tests.rs</a> - before you run them, you'll need to build the roc cli (<code>cargo build -p roc_cli</code>).</p>



<a name="293455502"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/293455502" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Thomas Dwyer <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#293455502">(Aug 15 2022 at 01:48)</a>:</h4>
<p>Building everything works currently, but i run those tests after building the cli and i get a complaint about not finding GLIBC_2.34 for wasm3-sys. Checking the chat history here and on the issues page says using flakes solves this, but i <em>am</em> using flakes. My system libc version is 2.33 but in the nix develop environment it is 2.34. Any ideas? (This should be moved to <a class="stream-topic" data-stream-id="231634" href="/#narrow/stream/231634-beginners/topic/building.20from.20source">#beginners &gt; building from source</a> )</p>



<a name="293456280"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/293456280" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Notification Bot <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#293456280">(Aug 15 2022 at 02:07)</a>:</h4>
<p>5 messages were moved here from <a class="stream-topic" data-stream-id="316715" href="/#narrow/stream/316715-contributing/topic/good.20first.20issues">#contributing &gt; good first issues</a> by <span class="user-mention silent" data-user-id="281383">Richard Feldman</span>.</p>



<a name="293489841"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/293489841" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#293489841">(Aug 15 2022 at 09:29)</a>:</h4>
<p>Hi <span class="user-mention" data-user-id="484835">@Thomas Dwyer</span>, I'll try to look at your issue today. Can you tell me the exact sequence of commands you ran?</p>



<a name="293490208"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/293490208" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Thomas Dwyer <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#293490208">(Aug 15 2022 at 09:32)</a>:</h4>
<p>well i entered the nix shell with <code>nix develop</code>, built the roc cli using <code>cargo build -p roc_cli</code>, then simply ran <code>cargo test repl_test</code> (<code>cargo test</code> has the same issue). i get the following error: <br>
<a href="/user_uploads/22008/SVw7g01crPgF1Rc-0f6YFNLr/image.png">image.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/22008/SVw7g01crPgF1Rc-0f6YFNLr/image.png" title="image.png"><img src="/user_uploads/22008/SVw7g01crPgF1Rc-0f6YFNLr/image.png"></a></div>



<a name="293490869"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/293490869" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#293490869">(Aug 15 2022 at 09:38)</a>:</h4>
<p>Thanks <span class="user-mention" data-user-id="484835">@Thomas Dwyer</span>, I'll see if I can reproduce that.</p>



<a name="293494435"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/293494435" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#293494435">(Aug 15 2022 at 10:10)</a>:</h4>
<p>I failed to reproduce this on NixOS, can you tell me what operating system you are on <span class="user-mention" data-user-id="484835">@Thomas Dwyer</span>?</p>



<a name="293565120"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/293565120" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Thomas Dwyer <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#293565120">(Aug 15 2022 at 16:07)</a>:</h4>
<p><span class="user-mention" data-user-id="361169">@Anton</span> I am running WSL2 under my windows 10 pc. This is a single user nix installation.</p>



<a name="293569235"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/293569235" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#293569235">(Aug 15 2022 at 16:30)</a>:</h4>
<p>I will try to reproduce that with the same setup this week, hopefully tomorrow.</p>



<a name="294513234"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/294513234" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#294513234">(Aug 21 2022 at 06:44)</a>:</h4>
<p><span class="user-mention" data-user-id="484835">@Thomas Dwyer</span> can you try <code>nix develop</code> followed by <code>cargo clean</code> and <code>cargo build</code>? Doing that fixed it for someone else with a very similar error.</p>



<a name="294568760"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/294568760" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Thomas Dwyer <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#294568760">(Aug 21 2022 at 17:49)</a>:</h4>
<p><span class="user-mention" data-user-id="361169">@Anton</span> Thank you, that works! really strange! Perhaps there should be a troubleshooting section in the installation file for cases like this. Nix is a strange beast for many people (including me), so we should aim to make its use as simple as possible. I really do wonder <em>why</em> nix was doing this, but I'm not too bothered now that it's solved.</p>



<a name="294569121"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/294569121" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#294569121">(Aug 21 2022 at 17:54)</a>:</h4>
<p>Generally that happens when you build outside of nix and that pulls in the system Glibc then nix breaks due to linking to object files with the wrong glibc.</p>



<a name="294616320"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/294616320" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#294616320">(Aug 22 2022 at 06:57)</a>:</h4>
<p>Yes indeed, simply put it's because you probably did <code>cargo build</code> without doing <code>nix develop</code> first. I will mention this in BUILDING_FROM_SOURCE and create an issue for it so people can also find it that way.</p>



<a name="295828104"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/295828104" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryce Miller <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#295828104">(Aug 29 2022 at 11:49)</a>:</h4>
<p>When running <code>nix develop</code>, I get an error linking debugir. Does this sound like an issue with my Nix setup or somerhing else? (WSL2, Ubuntu 22.04). Happy to share logs if that would be helpful.</p>



<a name="295944763"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/295944763" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#295944763">(Aug 29 2022 at 16:05)</a>:</h4>
<p>Hi <span class="user-mention" data-user-id="522634">@Bryce Miller</span>, that is unexpected. A detailed error message and logs would indeed be very helpful.</p>



<a name="295945436"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/295945436" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#295945436">(Aug 29 2022 at 16:08)</a>:</h4>
<p>I'm also setting up a 22.04 virtual machine, the error did not reproduce on 20.04.</p>



<a name="295945903"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/295945903" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryce Miller <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#295945903">(Aug 29 2022 at 16:11)</a>:</h4>
<p><span class="user-mention" data-user-id="361169">@Anton</span>  Here's the log file. <a href="/user_uploads/22008/7RLb4nmzkBm77BskrpNMyE3u/nix_log.txt">nix_log.txt</a></p>



<a name="295946213"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/295946213" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryce Miller <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#295946213">(Aug 29 2022 at 16:12)</a>:</h4>
<p>I believe it was working when I had 20.04 under WSL2 on my win10 box. Can't quite remember though.</p>



<a name="295946703"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/295946703" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryce Miller <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#295946703">(Aug 29 2022 at 16:14)</a>:</h4>
<p>Curious to find out whether you get the same error on your VM. If not, maybe something peculiar about WSL?</p>



<a name="295947382"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/295947382" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryce Miller <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#295947382">(Aug 29 2022 at 16:18)</a>:</h4>
<p>Here's the error that gets printed to the console, in case it helps: </p>
<div class="codehilite"><pre><span></span><code>error: builder for &#39;/nix/store/8c55wxck5wxir0gsycdwxcdsa62ng41l-debugir.drv&#39; failed with exit code 2;
       last 10 log lines:
       &gt; /nix/store/vhf2cr6immz4qdxd83y025fnxim8mmfg-binutils-2.38/bin/ld: Main.cpp:(.text.startup+0xaf9): undefined reference to `llvm::raw_string_ostream::~raw_string_ostream()&#39;
       &gt; /nix/store/vhf2cr6immz4qdxd83y025fnxim8mmfg-binutils-2.38/bin/ld: CMakeFiles/debugir.dir/Main.cpp.o:(.data.rel.ro._ZTIN4llvm2cl15OptionValueCopyINSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEEEEE[_ZTIN4llvm2cl15OptionValueCopyINSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEEEEE]+0x10): undefined reference to `typeinfo for llvm::cl::GenericOptionValue&#39;
       &gt; /nix/store/vhf2cr6immz4qdxd83y025fnxim8mmfg-binutils-2.38/bin/ld: CMakeFiles/debugir.dir/Main.cpp.o:(.data.rel.ro._ZTIN4llvm2cl15OptionValueCopyIbEE[_ZTIN4llvm2cl15OptionValueCopyIbEE]+0x10): undefined reference to `typeinfo for llvm::cl::GenericOptionValue&#39;
       &gt; /nix/store/vhf2cr6immz4qdxd83y025fnxim8mmfg-binutils-2.38/bin/ld: CMakeFiles/debugir.dir/Main.cpp.o:(.data.rel.ro._ZTVN4llvm2cl15OptionValueCopyINSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEEEEE[_ZTVN4llvm2cl15OptionValueCopyINSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEEEEE]+0x18): undefined reference to `llvm::cl::GenericOptionValue::anchor()&#39;
       &gt; /nix/store/vhf2cr6immz4qdxd83y025fnxim8mmfg-binutils-2.38/bin/ld: CMakeFiles/debugir.dir/Main.cpp.o:(.data.rel.ro._ZTVN4llvm2cl11OptionValueIbEE[_ZTVN4llvm2cl11OptionValueIbEE]+0x18): undefined reference to `llvm::cl::GenericOptionValue::anchor()&#39;
       &gt; /nix/store/vhf2cr6immz4qdxd83y025fnxim8mmfg-binutils-2.38/bin/ld: CMakeFiles/debugir.dir/Main.cpp.o:(.data.rel+0x0): undefined reference to `llvm::DisableABIBreakingChecks&#39;
       &gt; collect2: error: ld returned 1 exit status
       &gt; make[2]: *** [CMakeFiles/debugir.dir/build.make:134: debugir] Error 1
       &gt; make[1]: *** [CMakeFiles/Makefile2:164: CMakeFiles/debugir.dir/all] Error 2
       &gt; make: *** [Makefile:91: all] Error 2
       For full logs, run &#39;nix log /nix/store/8c55wxck5wxir0gsycdwxcdsa62ng41l-debugir.drv&#39;.
error: 1 dependencies of derivation &#39;/nix/store/6c85ff13cb9xdv6x6hmq3axrdkjj7gwc-nix-shell-env.drv&#39; failed to build
</code></pre></div>
<p>Let me know if there's anything else I can share/test!</p>



<a name="295947652"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/295947652" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#295947652">(Aug 29 2022 at 16:20)</a>:</h4>
<p>We've had a <a href="https://github.com/roc-lang/roc/issues/3528">similar issue</a> before that I never really figured out but it disappeared with different versions of nixpkgs. Can you check with <code>git status</code> if the <code>flake.lock</code> file changed?</p>



<a name="295948188"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/295948188" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryce Miller <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#295948188">(Aug 29 2022 at 16:23)</a>:</h4>
<p>no uncommitted changes here. Should be the same as what's on <code>main</code></p>



<a name="295949734"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/295949734" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryce Miller <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#295949734">(Aug 29 2022 at 16:32)</a>:</h4>
<p>I was going to test on my M1 Mac last night but I managed to screw up my Nix installation lol. Last I checked it worked there.</p>



<a name="295958728"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/295958728" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#295958728">(Aug 29 2022 at 17:19)</a>:</h4>
<p>Uhu, yeah we test nix on an M1 for every PR.</p>



<a name="295962818"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/295962818" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#295962818">(Aug 29 2022 at 17:41)</a>:</h4>
<p>I failed to reproduce this in the VM on Ubuntu 22.04. I'll continue to investigate but if you want to unblock yourself you can just remove the <code>debugir</code> line from inside <code>sharedInputs = (with pkgs; [</code> in <code>flake.nix</code>. <code>debugir</code> is only used to debug a specific part of the compiler when needed, the build and tests can all pass without <code>debugir</code>. A similar error as you're having now can occur for another nix dependency though.</p>



<a name="295964797"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/295964797" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryce Miller <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#295964797">(Aug 29 2022 at 17:51)</a>:</h4>
<p>Commented out that line and it worked! Some  stuff isn't building now but I'm able to get into the shell at least. It also works without issue on my mac, so I can always use that. Definitely let me know if there is anything else I can do to help troubleshoot this, and I'll let you know if I find out anything new.</p>



<a name="295966253"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/295966253" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#295966253">(Aug 29 2022 at 17:59)</a>:</h4>
<p>I'll let you now :) I'll try it out in WSL2 tomorrow.<br>
Can you also share the errors for "Some stuff isn't building now"? Do those errors occur when doing <code>cargo build</code> or is this still with <code>nix develop</code>?</p>



<a name="295966926"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/295966926" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryce Miller <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#295966926">(Aug 29 2022 at 18:02)</a>:</h4>
<p>Doing <code>nix develop</code> successfully puts me into the shell. <code>cargo clean &amp;&amp; cargo build</code> results in the following:</p>
<div class="codehilite"><pre><span></span><code>...
   Compiling x11-dl v2.19.1
   Compiling wgpu-core v0.12.2
error: failed to run custom build command for `wasi_libc_sys v0.0.1 (/home/bdm/src/contrib/roc/crates/wasi-libc-sys)`

Caused by:
  process didn&#39;t exit successfully: `/home/bdm/src/contrib/roc/target/debug/build/wasi_libc_sys-ea0d16e6299e57fc/build-script-build` (exit status: 101)
  --- stdout
  cargo:rerun-if-changed=build.rs
  cargo:rerun-if-changed=src/dummy.c

  --- stderr
  thread &#39;main&#39; panicked at &#39;called `Result::unwrap()` on an `Err` value: Os { code: 2, kind: NotFound, message: &quot;No such file or directory&quot; }&#39;, crates/wasi-libc-sys/build.rs:33:10
  note: run with `RUST_BACKTRACE=1` environment variable to display a backtrace
warning: build failed, waiting for other jobs to finish...
</code></pre></div>



<a name="295968006"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/295968006" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryce Miller <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#295968006">(Aug 29 2022 at 18:08)</a>:</h4>
<p>Here's a similar error I got on my mac when I tried to<code>cargo build</code> <em>before</em> running <code>cargo clean</code>.</p>
<div class="codehilite"><pre><span></span><code>error: failed to run custom build command for `roc_repl_wasm v0.0.1 (/Users/bryce/src/roc/crates/repl_wasm)`

Caused by:
  process didn&#39;t exit successfully: `/Users/bryce/src/roc/target/debug/build/roc_repl_wasm-447f50ffdcb4a716/build-script-build` (exit status: 101)
  --- stdout
  cargo:rerun-if-changed=build.rs
  cargo:rerun-if-changed=src/repl_platform.c

  --- stderr
  thread &#39;main&#39; panicked at &#39;Output {
      status: ExitStatus(
          unix_wait_status(
              256,
          ),
      ),
      stdout: &quot;&quot;,
      stderr: &quot;wasm-ld: error: cannot open /Users/bryce/code/roc/target/debug/build/wasi_libc_sys-b55c70ecf1892372/out/zig-cache/o/1bb0d1cbfb762560ef47ddccdb2efdcf/compiler_rt.o: No such file or directory\nwasm-ld: error: cannot open /Users/bryce/code/roc/target/debug/build/wasi_libc_sys-b55c70ecf1892372/out/wasi-libc.a: No such file or directory\n&quot;,
  }&#39;, crates/repl_wasm/build.rs:42:5
  note: run with `RUST_BACKTRACE=1` environment variable to display a backtrace
warning: build failed, waiting for other jobs to finish...
</code></pre></div>
<p>Oddly, after I got this error, <code>cargo run repl</code> worked without running <code>cargo clean</code> first.  <code>cargo clean &amp;&amp; cargo build</code> fixed the build issue. </p>
<p>So to be clear, no problems on my Mac, but this is an issue that popped up and was easily fixable with <code>cargo clean</code>.</p>



<a name="296060239"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/296060239" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#296060239">(Aug 30 2022 at 08:53)</a>:</h4>
<p>You may have run <code>cargo build</code> once without doing <code>nix develop</code> first. Later trying to use nix with pre-built artifacts made without nix is known to lead to all kinds of problems. We mention this in BUILDING_FROM_SOURCE but I will improve the wording. To prevent this: tools like direnv or lorri can automatically put you in a nix shell whenever you <code>cd</code> into the directory, I also like using <a href="https://starship.rs/">starship</a> which clearly shows if you are in a nix shell or not.</p>



<a name="296142960"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/296142960" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#296142960">(Aug 30 2022 at 15:11)</a>:</h4>
<p><span class="user-mention" data-user-id="522634">@Bryce Miller</span> I failed to reproduce the debugir error with Ubuntu 22.04 on WSL. Because we are working on native windows support I'd like to end the investigation here.</p>



<a name="296146217"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/296146217" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryce Miller <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#296146217">(Aug 30 2022 at 15:26)</a>:</h4>
<p>Thanks for the tips! I believe I did run cargo build once before remembering to drop into the Nix shell. I just didn’t know how to clean up the mess beyond trying cargo clean. </p>
<p>Fair enough, you have higher priority things to work on! If I do manage to figure out a fix, should I share it here?</p>



<a name="296146254"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/296146254" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryce Miller <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#296146254">(Aug 30 2022 at 15:26)</a>:</h4>
<p>Thanks again for looking into this for me.</p>



<a name="296381933"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/296381933" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryce Miller <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#296381933">(Aug 31 2022 at 16:10)</a>:</h4>
<p>Update: I tried using the "Ubuntu 22.04.1" package from the Microsoft Store instead of the "Ubuntu" package. Nix shell and build worked flawlessly. Either I messed something up in the other environment, or there is some subtle difference in the way they are set up by default. Hope this helps for anyone else using WSL2.</p>



<a name="297873960"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/297873960" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Hashi364 <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#297873960">(Sep 08 2022 at 22:24)</a>:</h4>
<p>Hi,<br>
How can I just build a executable?<br>
I try</p>
<div class="codehilite" data-code-language="Bash Session"><pre><span></span><code><span class="go">nix develop</span>
<span class="go">cargo install</span>
</code></pre></div>
<p>and I get</p>
<div class="codehilite" data-code-language="Bash Session"><pre><span></span><code><span class="go">error: found a virtual manifest at `/path/to/roc/Cargo.toml` instead of a package manifest</span>
</code></pre></div>



<a name="297874019"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/297874019" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#297874019">(Sep 08 2022 at 22:24)</a>:</h4>
<p><code>cargo build</code></p>



<a name="297874501"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/297874501" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Hashi364 <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#297874501">(Sep 08 2022 at 22:29)</a>:</h4>
<p>Where is the binary?<br>
Sorry, I forgot to say that I want a binary and not to run <code>cargo run -- foo</code> every time</p>



<a name="297874517"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/297874517" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#297874517">(Sep 08 2022 at 22:29)</a>:</h4>
<p>ah</p>



<a name="297874549"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/297874549" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#297874549">(Sep 08 2022 at 22:29)</a>:</h4>
<p><code>/target/debug/roc</code> probably, or <code>/target/release/roc</code> is you built with <code>--release</code></p>



<a name="297874664"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/297874664" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#297874664">(Sep 08 2022 at 22:30)</a>:</h4>
<p>you should symlink that though, and not move the binary; it uses some files with a relative path</p>



<a name="297874803"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/297874803" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Hashi364 <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#297874803">(Sep 08 2022 at 22:31)</a>:</h4>
<p>Thanks, I was planning to do that (if I rebuild, I can just "do nothing")</p>



<a name="304271482"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/304271482" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Arbil <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#304271482">(Oct 16 2022 at 05:54)</a>:</h4>
<p>The guide says:</p>
<blockquote>
<p>If you want to load all dependencies automatically whenever you cd into roc, check out direnv. Then you will no longer need to execute nix develop first.</p>
</blockquote>
<p>What environment variables do I add to direnv?</p>



<a name="304271717"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/304271717" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#304271717">(Oct 16 2022 at 05:58)</a>:</h4>
<p><code>echo "use nix" &gt;&gt; .envrc</code></p>



<a name="304271729"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/304271729" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#304271729">(Oct 16 2022 at 05:58)</a>:</h4>
<p>That should work if you have nix setup correctly and direnv installed through nix</p>



<a name="304271770"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/304271770" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#304271770">(Oct 16 2022 at 05:59)</a>:</h4>
<p>That said, it is nicer to use <a href="https://github.com/nix-community/lorri">lorri</a> with nix</p>



<a name="304271804"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/304271804" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#304271804">(Oct 16 2022 at 05:59)</a>:</h4>
<p>It basically rebuilds the nix environment behind the scenes and caches the nix environment better. So you can just use things without waiting on updates.</p>



<a name="304362337"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/304362337" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chad Stearns <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#304362337">(Oct 17 2022 at 00:14)</a>:</h4>
<p><span class="user-mention silent" data-user-id="522634">Bryce Miller</span> <a href="#narrow/stream/231634-beginners/topic/building.20from.20source/near/295966926">said</a>:</p>
<blockquote>
<p>Doing <code>nix develop</code> successfully puts me into the shell. <code>cargo clean &amp;&amp; cargo build</code> results in the following:</p>
<p><div class="codehilite"><pre><span></span><code>...
   Compiling x11-dl v2.19.1
   Compiling wgpu-core v0.12.2
error: failed to run custom build command for `wasi_libc_sys v0.0.1 (/home/bdm/src/contrib/roc/crates/wasi-libc-sys)`

Caused by:
  process didn&#39;t exit successfully: `/home/bdm/src/contrib/roc/target/debug/build/wasi_libc_sys-ea0d16e6299e57fc/build-script-build` (exit status: 101)
  --- stdout
  cargo:rerun-if-changed=build.rs
  cargo:rerun-if-changed=src/dummy.c

  --- stderr
  thread &#39;main&#39; panicked at &#39;called `Result::unwrap()` on an `Err` value: Os { code: 2, kind: NotFound, message: &quot;No such file or directory&quot; }&#39;, crates/wasi-libc-sys/build.rs:33:10
  note: run with `RUST_BACKTRACE=1` environment variable to display a backtrace
warning: build failed, waiting for other jobs to finish...
</code></pre></div><br>
</p>
</blockquote>
<p>Hello! I am coming back to Roc since last working on it around February. Trying to build from source now, I am hitting this exact error Bryce reported. For me, <code>cargo clean</code> is not resolving. Has anyone else run into it?</p>



<a name="304362414"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/304362414" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chad Stearns <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#304362414">(Oct 17 2022 at 00:16)</a>:</h4>
<p>I am hitting this issue on my mac.</p>



<a name="304395607"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/304395607" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Carroll <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#304395607">(Oct 17 2022 at 07:19)</a>:</h4>
<p>Hi Chad, that error suggests that a previous Zig command failed. Maybe check what <code>zig version</code> says? We require Zig 0.9.1. We first check to see if the environment variable <code>ROC_ZIG</code> contains a path, and if not, we default to <code>zig</code>.</p>



<a name="304421770"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/304421770" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#304421770">(Oct 17 2022 at 10:00)</a>:</h4>
<p>Welcome back <span class="user-mention" data-user-id="281385">@Chad Stearns</span> :)<br>
Like Bryce, did you also do <code>nix develop</code> first? Zig should definitely be the right version when using <code>nix develop</code>.</p>



<a name="304469659"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/304469659" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Arbil <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#304469659">(Oct 17 2022 at 14:06)</a>:</h4>
<p><span class="user-mention silent" data-user-id="343810">Brendan Hansknecht</span> <a href="#narrow/stream/231634-beginners/topic/building.20from.20source/near/304271717">said</a>:</p>
<blockquote>
<p><code>echo "use nix" &gt;&gt; .envrc</code></p>
</blockquote>
<p>Thanks, it's working. However, every call of <code>nix develop</code>, or entry through direnv, takes away about 10GB of disk space which quickly kills this resource constrained box. Part of that seems copying of <code>roc-main</code> directory with all the compilation artifacts. <code>nix-collect-garbage</code> on the other hand forces download &amp; install of all dependencies again (and doesn't seem to free all the disk space anyway)</p>



<a name="304469699"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/304469699" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Arbil <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#304469699">(Oct 17 2022 at 14:06)</a>:</h4>
<p>Is there a way to deal with this?</p>



<a name="304495693"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/304495693" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#304495693">(Oct 17 2022 at 15:46)</a>:</h4>
<p>Yeah....nix can be annoying with storage space. I have never run out of space on my machine, so I can't imagine the 10 GB being consistently added without some other form of issue (though even a few times could be problematic). <span class="user-mention" data-user-id="361169">@Anton</span> any ideas? Can we get nix to ignore the files? Especially the target folder? Theoretically, nix should be able to just change paths and not move any data, right?</p>



<a name="304496170"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/304496170" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Hicks <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#304496170">(Oct 17 2022 at 15:49)</a>:</h4>
<p>I like using <a href="https://github.com/hercules-ci/gitignore.nix">https://github.com/hercules-ci/gitignore.nix</a> for this but it only makes sense for the <code>shell.nix</code>/<code>default.nix</code> combo. If you have a version of Nix that can use flakes, I'd recommend using <code>use flake</code> in your <code>.envrc</code> instead, as it'll ignore gitignored files automatically.</p>



<a name="304496251"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/304496251" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Hicks <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#304496251">(Oct 17 2022 at 15:49)</a>:</h4>
<p>(although I think <code>nix develop</code> uses flakes already so I am not sure what could be happening there.)</p>



<a name="304496524"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/304496524" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#304496524">(Oct 17 2022 at 15:50)</a>:</h4>
<p>I think our <code>shell.nix</code> was modified to be the same as <code>nix develop</code> as well</p>



<a name="304498100"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/304498100" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#304498100">(Oct 17 2022 at 15:57)</a>:</h4>
<p>Also, didn't realize <code>direnv</code> can support flakes directly now. Might switch to that until lorri updates.</p>



<a name="304498738"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/304498738" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Hicks <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#304498738">(Oct 17 2022 at 16:00)</a>:</h4>
<p>I switched away from Lorri a long time ago, FWIW. The only thing I miss is building in the background. I've got a direnv snippet loaded with home-manager that caches shells so that shell startup is negligible with just <code>use nix</code> or <code>use flake</code> without having to run a daemon.</p>



<a name="304498778"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/304498778" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Hicks <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#304498778">(Oct 17 2022 at 16:00)</a>:</h4>
<p>I can send it to you if you'd like, but I think I just got it from the Nix wiki</p>



<a name="304500434"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/304500434" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#304500434">(Oct 17 2022 at 16:07)</a>:</h4>
<p>No worries, found it.</p>



<a name="304517371"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/304517371" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#304517371">(Oct 17 2022 at 17:31)</a>:</h4>
<p>I don't think compilation artifacts are copied, but once you run <code>cargo build</code> after <code>nix develop</code> they will appear in the <code>nix/store/hash-source</code> folder.</p>



<a name="304522208"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/304522208" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#304522208">(Oct 17 2022 at 17:54)</a>:</h4>
<p><span class="user-mention" data-user-id="550456">@Arbil</span> I would check your target folder to make sure that you don't have both <code>release</code> and <code>debug</code> folders. Your IDE may also generate compiler artifacts. I would delete the <code>debug</code> folder and test building with <code>cargo build --release -p name_of_crate_you_changed</code> and testing with <code>cargo test --release -p name_of_crate_you_changed</code> to save storage space. I will send you a flake.nix tomorrow that does not contain the editor's dependencies, that should also save some space.</p>



<a name="304609717"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/304609717" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Arbil <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#304609717">(Oct 18 2022 at 04:57)</a>:</h4>
<p><span class="user-mention silent" data-user-id="361169">Anton</span> <a href="#narrow/stream/231634-beginners/topic/building.20from.20source/near/304517371">said</a>:</p>
<blockquote>
<p>I don't think compilation artifacts are copied, but once you run <code>cargo build</code> after <code>nix develop</code> they will appear in the <code>nix/store/hash-source</code> folder.</p>
</blockquote>
<p>Thank you. I've done a quick reformat of this box and it seems more managable this time. BTW, I'm using the vscode flake and 'arrow up' doesn't work in inbuilt terminal for 'previous command', is that normal?</p>



<a name="304609843"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/304609843" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#304609843">(Oct 18 2022 at 04:59)</a>:</h4>
<p>the flake terminal and your normal terminal have different histories.</p>



<a name="304609864"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/304609864" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#304609864">(Oct 18 2022 at 04:59)</a>:</h4>
<p>but up arrow should work within the history of your flake terminal</p>



<a name="304615554"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/304615554" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#304615554">(Oct 18 2022 at 06:09)</a>:</h4>
<blockquote>
<p>I'm using the vscode flake and 'arrow up' doesn't work in inbuilt terminal for 'previous command', is that normal?</p>
</blockquote>
<p>Yeah it's not just the different histories, I also have this. I tried digging into it but came up empty, so I use the terminal in which I entered <code>nix develop</code>.</p>



<a name="304615761"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/304615761" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#304615761">(Oct 18 2022 at 06:11)</a>:</h4>
<p>Oh, weird</p>



<a name="304616102"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/304616102" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#304616102">(Oct 18 2022 at 06:15)</a>:</h4>
<p>My terminal also looks like this:<br>
<a href="/user_uploads/22008/aJKhN1ZLNRElVF_lSzae6QmZ/nix_vscode_terminal.png">nix_vscode_terminal.png</a> </p>
<div class="message_inline_image"><a href="/user_uploads/22008/aJKhN1ZLNRElVF_lSzae6QmZ/nix_vscode_terminal.png" title="nix_vscode_terminal.png"><img src="/user_uploads/22008/aJKhN1ZLNRElVF_lSzae6QmZ/nix_vscode_terminal.png"></a></div><p>I wonder if it's because I use <a href="http://starship.rs">starship.rs</a></p>



<a name="304635282"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/304635282" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Arbil <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#304635282">(Oct 18 2022 at 08:47)</a>:</h4>
<p>Mine looks similar though not identical. I don't use starship</p>



<a name="304648444"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/304648444" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#304648444">(Oct 18 2022 at 10:18)</a>:</h4>
<p><span class="user-mention" data-user-id="550456">@Arbil</span> here is the flake.nix with all editor dependencies left out:</p>
<div class="codehilite" data-code-language="Nix"><pre><span></span><code><span class="p">{</span>
  <span class="ss">description =</span> <span class="s2">"Roc flake"</span><span class="p">;</span>

  <span class="ss">inputs =</span> <span class="p">{</span>
    nixpkgs<span class="o">.</span><span class="ss">url =</span> <span class="s2">"github:nixos/nixpkgs/nixos-unstable"</span><span class="p">;</span>

    <span class="c1"># rust from nixpkgs has some libc problems, this is patched in the rust-overlay</span>
    <span class="ss">rust-overlay =</span> <span class="p">{</span>
      <span class="ss">url =</span> <span class="s2">"github:oxalica/rust-overlay"</span><span class="p">;</span>
      inputs<span class="o">.</span>nixpkgs<span class="o">.</span><span class="ss">follows =</span> <span class="s2">"nixpkgs"</span><span class="p">;</span>
    <span class="p">};</span>
    <span class="c1"># to easily make configs for multiple architectures</span>
    flake-utils<span class="o">.</span><span class="ss">url =</span> <span class="s2">"github:numtide/flake-utils"</span><span class="p">;</span>
    <span class="c1"># to be able to use vulkan system libs for editor graphics</span>
    <span class="ss">nixgl =</span> <span class="p">{</span>
      <span class="ss">url =</span> <span class="s2">"github:guibou/nixGL"</span><span class="p">;</span>
      inputs<span class="o">.</span>nixpkgs<span class="o">.</span><span class="ss">follows =</span> <span class="s2">"nixpkgs"</span><span class="p">;</span>
    <span class="p">};</span>
  <span class="p">};</span>

  <span class="ss">outputs =</span> <span class="p">{</span> self<span class="p">,</span> nixpkgs<span class="p">,</span> rust-overlay<span class="p">,</span> flake-utils<span class="p">,</span> nixgl <span class="p">}:</span>
    <span class="k">let</span> <span class="ss">supportedSystems =</span> <span class="p">[</span> <span class="s2">"x86_64-linux"</span> <span class="s2">"x86_64-darwin"</span> <span class="s2">"aarch64-darwin"</span> <span class="p">];</span>
    <span class="k">in</span> flake-utils<span class="o">.</span>lib<span class="o">.</span>eachSystem supportedSystems <span class="p">(</span>system<span class="p">:</span>
      <span class="k">let</span>
        <span class="ss">overlays =</span> <span class="p">[</span> <span class="p">(</span><span class="nb">import</span> rust-overlay<span class="p">)</span> <span class="p">]</span>
          <span class="o">++</span> <span class="p">(</span><span class="k">if</span> <span class="ss">system =</span><span class="o">=</span> <span class="s2">"x86_64-linux"</span> <span class="k">then</span> <span class="p">[</span> nixgl<span class="o">.</span>overlay <span class="p">]</span> <span class="k">else</span> <span class="p">[</span> <span class="p">]);</span>
        <span class="ss">pkgs =</span> <span class="nb">import</span> nixpkgs <span class="p">{</span> <span class="k">inherit</span> system overlays<span class="p">;</span> <span class="p">};</span>
        <span class="ss">llvmPkgs =</span> pkgs<span class="o">.</span>llvmPackages_13<span class="p">;</span>

        <span class="c1"># get current working directory</span>
        <span class="ss">cwd =</span> <span class="nb">builtins</span><span class="o">.</span><span class="nb">toString</span> <span class="o">.</span><span class="l">/.</span><span class="p">;</span>
        <span class="ss">rust =</span>
          pkgs<span class="o">.</span>rust-bin<span class="o">.</span>fromRustupToolchainFile <span class="s2">"</span><span class="si">${</span>cwd<span class="si">}</span><span class="s2">/rust-toolchain.toml"</span><span class="p">;</span>

        <span class="ss">linuxInputs =</span> <span class="k">with</span> pkgs<span class="p">;</span>
          lib<span class="o">.</span>optionals stdenv<span class="o">.</span>isLinux <span class="p">[</span>
            valgrind <span class="c1"># used in cli tests, see cli/tests/cli_run.rs</span>
            <span class="c1">#vulkan-headers</span>
            <span class="c1">#vulkan-loader</span>
            <span class="c1">#vulkan-tools</span>
            <span class="c1">#vulkan-validation-layers</span>
            <span class="c1">#xorg.libX11</span>
            <span class="c1">#xorg.libXcursor</span>
            <span class="c1">#xorg.libXrandr</span>
            <span class="c1">#xorg.libXi</span>
            xorg<span class="o">.</span>libxcb
            <span class="c1">#alsa-lib</span>
          <span class="p">];</span>

        <span class="ss">darwinInputs =</span> <span class="k">with</span> pkgs<span class="p">;</span>
          lib<span class="o">.</span>optionals stdenv<span class="o">.</span>isDarwin
          <span class="p">(</span><span class="k">with</span> pkgs<span class="o">.</span>darwin<span class="o">.</span>apple_sdk<span class="o">.</span>frameworks<span class="p">;</span> <span class="p">[</span>
            AppKit
            CoreFoundation
            CoreServices
            CoreVideo
            Foundation
            Metal
            Security
          <span class="p">]);</span>

        <span class="c1"># For debugging LLVM IR</span>
        <span class="c1">#debugir = pkgs.stdenv.mkDerivation {</span>
        <span class="c1">#  name = "debugir";</span>
        <span class="c1">#  src = pkgs.fetchFromGitHub {</span>
        <span class="c1">#    owner = "vaivaswatha";</span>
        <span class="c1">#    repo = "debugir";</span>
        <span class="c1">#    rev = "b981e0b74872d9896ba447dd6391dfeb63332b80";</span>
        <span class="c1">#    sha256 = "Gzey0SF0NZkpiObk5e29nbc41dn4Olv1dx+6YixaZH0=";</span>
        <span class="c1">#  };</span>
        <span class="c1">#  buildInputs = with pkgs; [ cmake libxml2 llvmPackages_13.llvm.dev ];</span>
        <span class="c1">#  buildPhase = ''</span>
        <span class="c1">#    mkdir build</span>
        <span class="c1">#    cd build</span>
        <span class="c1">#    cmake -DLLVM_DIR=${pkgs.llvmPackages_13.llvm.dev} -DCMAKE_BUILD_TYPE=Release ../</span>
        <span class="c1">#    cmake --build ../</span>
        <span class="c1">#    cp ../debugir .</span>
        <span class="c1">#  '';</span>
        <span class="c1">#  installPhase = ''</span>
        <span class="c1">#    mkdir -p $out/bin</span>
        <span class="c1">#    cp debugir $out/bin</span>
        <span class="c1">#  '';</span>
        <span class="c1">#};</span>

        <span class="ss">sharedInputs =</span> <span class="p">(</span><span class="k">with</span> pkgs<span class="p">;</span> <span class="p">[</span>
          <span class="c1"># build libraries</span>
          cmake
          git
          python3
          llvmPkgs<span class="o">.</span>llvm<span class="o">.</span>dev
          llvmPkgs<span class="o">.</span>clang
          libxkbcommon
          pkg-config
          zig <span class="c1"># roc builtins are implemented in zig, see compiler/builtins/bitcode/</span>

          <span class="c1"># lib deps</span>
          libffi
          libxml2
          ncurses
          zlib
          libiconv

          <span class="c1"># faster builds - see https://github.com/roc-lang/roc/blob/main/BUILDING_FROM_SOURCE.md#use-lld-for-the-linker</span>
          llvmPkgs<span class="o">.</span>lld
          <span class="c1">#debugir</span>
          rust
          rust-bindgen
        <span class="p">]);</span>
      <span class="k">in</span> <span class="p">{</span>

        <span class="ss">devShell =</span> pkgs<span class="o">.</span>mkShell <span class="p">{</span>
          <span class="ss">buildInputs =</span> sharedInputs <span class="o">++</span> darwinInputs <span class="o">++</span> linuxInputs
            <span class="o">++</span> <span class="p">(</span><span class="k">if</span> <span class="ss">system =</span><span class="o">=</span> <span class="s2">"x86_64-linux"</span> <span class="k">then</span>
              <span class="p">[</span> pkgs<span class="o">.</span>nixgl<span class="o">.</span>nixVulkanIntel <span class="p">]</span>
            <span class="k">else</span>
              <span class="p">[</span> <span class="p">]);</span>

          <span class="ss">LLVM_SYS_130_PREFIX =</span> <span class="s2">"</span><span class="si">${</span>llvmPkgs<span class="o">.</span>llvm<span class="o">.</span>dev<span class="si">}</span><span class="s2">"</span><span class="p">;</span>
          <span class="c1"># nix does not store libs in /usr/lib or /lib</span>
          <span class="ss">NIX_GLIBC_PATH =</span>
            <span class="k">if</span> pkgs<span class="o">.</span>stdenv<span class="o">.</span>isLinux <span class="k">then</span> <span class="s2">"</span><span class="si">${</span>pkgs<span class="o">.</span>glibc<span class="o">.</span>out<span class="si">}</span><span class="s2">/lib"</span> <span class="k">else</span> <span class="s2">""</span><span class="p">;</span>
          <span class="ss">LD_LIBRARY_PATH =</span> <span class="k">with</span> pkgs<span class="p">;</span>
            lib<span class="o">.</span>makeLibraryPath
            <span class="p">([</span> pkg-config stdenv<span class="o">.</span>cc<span class="o">.</span>cc<span class="o">.</span>lib libffi ncurses zlib <span class="p">]</span>
              <span class="o">++</span> linuxInputs<span class="p">);</span>
          <span class="ss">NIXPKGS_ALLOW_UNFREE =</span>
            <span class="mi">1</span><span class="p">;</span> <span class="c1"># to run the editor with NVIDIA's closed source drivers</span>
        <span class="p">};</span>

        <span class="ss">formatter =</span> pkgs<span class="o">.</span>nixpkgs-fmt<span class="p">;</span>

        <span class="c1"># You can build this package (the roc CLI) with the `nix build` command.</span>
        packages<span class="o">.</span><span class="ss">default =</span> <span class="nb">import</span> <span class="o">.</span><span class="l">/.</span> <span class="p">{</span> <span class="k">inherit</span> pkgs<span class="p">;</span> <span class="p">};</span>
      <span class="p">});</span>
<span class="p">}</span>
</code></pre></div>



<a name="304651591"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/304651591" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Arbil <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#304651591">(Oct 18 2022 at 10:39)</a>:</h4>
<p>Thank you very much. Will use today</p>



<a name="305616166"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/305616166" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chad Stearns <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#305616166">(Oct 23 2022 at 03:57)</a>:</h4>
<p>Hey <span class="user-mention" data-user-id="361169">@Anton</span> <span class="user-mention" data-user-id="431893">@Brian Carroll</span> . Nice to see you all. I am not on nix. When I do <code>zig version</code> I do see <code>0.9.1</code>. I tried setting <code>ROC_ZIG</code> just in case and I am still seeing the same error. Looking at the error again, it is exactly the same one as Bryce's (except for the directory names of course).</p>



<a name="305617051"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/305617051" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chad Stearns <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#305617051">(Oct 23 2022 at 04:06)</a>:</h4>
<p>I see <code>build.rs</code> now. I am going to try adding some debugs and printlns.</p>



<a name="305617950"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/305617950" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chad Stearns <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#305617950">(Oct 23 2022 at 04:22)</a>:</h4>
<p>Yeah I can see that it is looking for my zig cache at:</p>
<div class="codehilite"><pre><span></span><code>/Users/chad/code/roc/target/debug/build/wasi_libc_sys-1aefd8d65824087d/out/zig-cache
</code></pre></div>
<p>but when I check that spot <code>zig-cache</code> is not present<br>
<a href="/user_uploads/22008/1mAqQ3pjstAy8fyGAoL2L5e4/Screen-Shot-2022-10-23-at-12.20.02-AM.png">Screen-Shot-2022-10-23-at-12.20.02-AM.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/22008/1mAqQ3pjstAy8fyGAoL2L5e4/Screen-Shot-2022-10-23-at-12.20.02-AM.png" title="Screen-Shot-2022-10-23-at-12.20.02-AM.png"><img src="/user_uploads/22008/1mAqQ3pjstAy8fyGAoL2L5e4/Screen-Shot-2022-10-23-at-12.20.02-AM.png"></a></div>



<a name="305632308"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/305632308" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#305632308">(Oct 23 2022 at 07:46)</a>:</h4>
<p>Hi Chad, I'd recommend adding some dbg prints to get the necessary values and executing <code>zig build-exe...</code> manually from the same working dir.</p>



<a name="305748166"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/305748166" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Arbil <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#305748166">(Oct 24 2022 at 05:15)</a>:</h4>
<p>Is there a more granular command to build the roc compiler than <code>cargo build</code> in project root? This one builds some editor, wasm and repl stuff also</p>



<a name="305751706"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/305751706" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#305751706">(Oct 24 2022 at 05:59)</a>:</h4>
<p>Rust let's you build specific packages. Otherwise, the compiler does have some feature flags that can reduce what is pulled in, but it is pretty limited in what can be removed</p>



<a name="306251249"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/306251249" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ghislain <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#306251249">(Oct 26 2022 at 14:22)</a>:</h4>
<p>Hi,<br>
Yesterday I made the upgrade of MacOS to Ventura 13.0, and now my build fails <span aria-label="cry" class="emoji emoji-1f622" role="img" title="cry">:cry:</span> <br>
I tried <code>cargo clean</code>, but same output for <code>cargo build</code>:</p>
<div class="codehilite" data-code-language="Bash"><pre><span></span><code>bash-5.1$ <span class="nv">RUST_BACKTRACE</span><span class="o">=</span><span class="m">1</span> cargo build
   Compiling roc_builtins v0.0.1 <span class="o">(</span>/Users/ghigt/code/roc/source/crates/compiler/builtins<span class="o">)</span>
   Compiling serde v1.0.144
   Compiling sha2 v0.10.2
   Compiling clap_derive v3.2.18
   Compiling futures-util v0.3.24
   Compiling wasm-bindgen-macro-support v0.2.83
   Compiling objc-foundation v0.1.1
   Compiling bytemuck v1.12.1
   Compiling object v0.29.0
   Compiling roc_collections v0.0.1 <span class="o">(</span>/Users/ghigt/code/roc/source/crates/compiler/collections<span class="o">)</span>
error: failed to run custom build <span class="nb">command</span> <span class="k">for</span> <span class="sb">`</span>roc_builtins v0.0.1 <span class="o">(</span>/Users/ghigt/code/roc/source/crates/compiler/builtins<span class="o">)</span><span class="sb">`</span>

Caused by:
  process didn<span class="s1">'t exit successfully: `/Users/ghigt/code/roc/source/target/debug/build/roc_builtins-4ce1b28dcf05f93e/build-script-build` (exit status: 101)</span>
<span class="s1">  --- stdout</span>
<span class="s1">  cargo:rerun-if-changed=build.rs</span>
<span class="s1">  Compiling host ir to: /Users/ghigt/code/roc/source/crates/compiler/builtins/bitcode/builtins-host.ll</span>
<span class="s1">  Compiling 64-bit bitcode to: /Users/ghigt/code/roc/source/crates/compiler/builtins/bitcode/builtins-host.bc</span>

<span class="s1">  --- stderr</span>
<span class="s1">  thread '</span>main<span class="s1">' panicked at '</span>zig failed: thread <span class="m">333562</span> panic: Darwin is handled separately via std.zig.system.darwin module
  Unable to dump stack trace: debug info stripped
  <span class="err">'</span>, crates/compiler/builtins/build.rs:240:21
  stack backtrace:
     <span class="m">0</span>: rust_begin_unwind
               at /rustc/fe5b13d681f25ee6474be29d748c65adcd91f69e/library/std/src/panicking.rs:584:5
     <span class="m">1</span>: core::panicking::panic_fmt
               at /rustc/fe5b13d681f25ee6474be29d748c65adcd91f69e/library/core/src/panicking.rs:143:14
     <span class="m">2</span>: build_script_build::run_command
               at ./build.rs:240:21
     <span class="m">3</span>: build_script_build::generate_bc_file
               at ./build.rs:133:5
     <span class="m">4</span>: build_script_build::main
               at ./build.rs:40:5
     <span class="m">5</span>: core::ops::function::FnOnce::call_once
               at /rustc/fe5b13d681f25ee6474be29d748c65adcd91f69e/library/core/src/ops/function.rs:227:5
  note: Some details are omitted, run with <span class="sb">`</span><span class="nv">RUST_BACKTRACE</span><span class="o">=</span>full<span class="sb">`</span> <span class="k">for</span> a verbose backtrace.
warning: build failed, waiting <span class="k">for</span> other <span class="nb">jobs</span> to finish...
</code></pre></div>
<p>(I use <code>nix develop</code>)</p>



<a name="306252341"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/306252341" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ghislain <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#306252341">(Oct 26 2022 at 14:27)</a>:</h4>
<p>Also, the previous builds using MacOS 12.0 are now failing:</p>
<div class="codehilite" data-code-language="Bash"><pre><span></span><code>» <span class="m">1</span>+1
ld: warning: directory not found <span class="k">for</span> option <span class="s1">'-F/Library/Developer/CommandLineTools/SDKs/MacOSX.sdk/System/Library/Frameworks/'</span>
ld: library not found <span class="k">for</span> -lSystem
/var/folders/y4/y9696g7j7hx_dhcfdlv9f4600000gn/T/.tmpOlm155/app.dylib: No such file or directory
</code></pre></div>



<a name="306252754"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/306252754" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#306252754">(Oct 26 2022 at 14:28)</a>:</h4>
<p>I guess they change the location of the system library?</p>



<a name="306252977"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/306252977" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ghislain <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#306252977">(Oct 26 2022 at 14:29)</a>:</h4>
<p>ah you're right, I currently have <code>/Library/Developer/CommandLineTools/SDKs/MacOSX12.1.sdk/</code></p>



<a name="306253665"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/306253665" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ghislain <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#306253665">(Oct 26 2022 at 14:32)</a>:</h4>
<p>brew is telling me to upgrade to XCode 14.1 instead of 14.0.1 but it is only in RC 2 and should be released in the next days, maybe it is related and will default to <code>MacOSX.sdk</code></p>



<a name="306253847"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/306253847" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ghislain <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#306253847">(Oct 26 2022 at 14:33)</a>:</h4>
<p>I don't know if I can <code>ln</code> the folder</p>



<a name="306257547"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/306257547" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ghislain <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#306257547">(Oct 26 2022 at 14:49)</a>:</h4>
<p>ok, after having the <code>/Library/Developer/CommandLineTools/SDKs/MacOSX.sdk</code> folder link, the previous builds work!</p>



<a name="306257639"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/306257639" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ghislain <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#306257639">(Oct 26 2022 at 14:49)</a>:</h4>
<p>But still, I can't build new one any more</p>



<a name="306267467"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/306267467" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#306267467">(Oct 26 2022 at 15:31)</a>:</h4>
<p>Zig has a branch up <a href="https://github.com/ziglang/zig/issues/10478">with a fix</a> but that is for zig master, it'll probably take them some time to release 0.9.2 I suppose.</p>



<a name="306273841"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/306273841" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ghislain <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#306273841">(Oct 26 2022 at 15:59)</a>:</h4>
<p>Thank you <span class="user-mention" data-user-id="361169">@Anton</span>, so I guess we're not able to compile on MacOS Ventura until then</p>



<a name="306274357"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/306274357" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ghislain <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#306274357">(Oct 26 2022 at 16:01)</a>:</h4>
<p>That will teach me to update too soon <span aria-label="sweat smile" class="emoji emoji-1f605" role="img" title="sweat smile">:sweat_smile:</span></p>



<a name="306274631"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/306274631" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#306274631">(Oct 26 2022 at 16:02)</a>:</h4>
<p>Yeah, I've heard several macos/ios update horror stories before...</p>



<a name="306630612"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/306630612" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ghislain <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#306630612">(Oct 28 2022 at 11:04)</a>:</h4>
<p>Would it be possible (following this answer <a href="https://github.com/ziglang/zig/issues/10478#issuecomment-1294313967">https://github.com/ziglang/zig/issues/10478#issuecomment-1294313967</a>) to make it run on Ventura using <code>-target native-macos.12</code>?<br>
I tried with a simple <code>hello-world.zig</code> and it works, but I'm lost in the Roc repo to know where to put and try it</p>



<a name="306634427"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/306634427" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#306634427">(Oct 28 2022 at 11:30)</a>:</h4>
<p>It's probably going to need to be added in multiple places. Based on the error you originally posted I would add <code>-target native-macos.12</code> <a href="https://github.com/roc-lang/roc/blob/de6e7840cb8e9ad114cc85c440002f125567f17d/crates/compiler/builtins/build.rs#L136">here</a> to get started.</p>



<a name="306634859"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/306634859" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ghislain <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#306634859">(Oct 28 2022 at 11:33)</a>:</h4>
<p>I tried to change this line, but without any result (I'm very new to Rust/Zig). Then I switched to <a href="https://github.com/roc-lang/roc/blob/de6e7840cb8e9ad114cc85c440002f125567f17d/crates/compiler/builtins/bitcode/build.zig#L25">build.zig</a> but I can't find how to manage this object.</p>



<a name="306635063"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/306635063" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#306635063">(Oct 28 2022 at 11:34)</a>:</h4>
<p>Did you get the exact same error? Feel free to post it again to make sure.</p>



<a name="306635421"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/306635421" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ghislain <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#306635421">(Oct 28 2022 at 11:37)</a>:</h4>
<p>yes, it's like I did nothing</p>



<a name="306635751"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/306635751" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ghislain <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#306635751">(Oct 28 2022 at 11:39)</a>:</h4>
<p>Maybe I'm doing something wrong, I changed it to:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="n">run_command</span><span class="p">(</span><span class="w"></span>
<span class="w">        </span><span class="o">&amp;</span><span class="n">bitcode_path</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="o">&amp;</span><span class="n">zig_executable</span><span class="p">(),</span><span class="w"></span>
<span class="w">        </span><span class="o">&amp;</span><span class="p">[</span><span class="w"></span>
<span class="w">            </span><span class="s">"build"</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="n">zig_object</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="s">"-target"</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="s">"native-macos.12"</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="s">"-Drelease=true"</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="p">],</span><span class="w"></span>
<span class="w">        </span><span class="mi">0</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="p">);</span><span class="w"></span>
</code></pre></div>



<a name="306636087"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/306636087" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#306636087">(Oct 28 2022 at 11:40)</a>:</h4>
<p>I think there are just more places you need to change the target</p>



<a name="306636230"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/306636230" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#306636230">(Oct 28 2022 at 11:41)</a>:</h4>
<p>llvm generation needs to use the right target, but probably generic macos is good enough there, then the host needs to be built with the right target, and the final linking needs to use the right target</p>



<a name="306638697"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/306638697" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#306638697">(Oct 28 2022 at 11:57)</a>:</h4>
<p>It would probably be good to make a single <code>zig_cmd</code> function that is used everywhere instead of going through <code>std::process::Command</code> in multiple places. I'll make an issue for that.</p>



<a name="306639088"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/306639088" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#306639088">(Oct 28 2022 at 12:00)</a>:</h4>
<p>well, that does not always work. You need the flexibility of <code>Command</code> sometimes</p>



<a name="306639680"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/306639680" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#306639680">(Oct 28 2022 at 12:03)</a>:</h4>
<p>Could the <code>zig_cmd</code> function not offer the same flexibility but still be centralized?</p>



<a name="306640569"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/306640569" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#306640569">(Oct 28 2022 at 12:09)</a>:</h4>
<p>not sure what type you have in mind, is it <code>fn zig_cmd() -&gt; Command</code>?</p>



<a name="306645695"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/306645695" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Carroll <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#306645695">(Oct 28 2022 at 12:37)</a>:</h4>
<p>Anoton we do lots of different things with Zig in different places. Sometimes we're compiling a host, sometimes an app, sometimes a preprocessed host, could be targeting WebAssembly or native, compiling C code or Zig code...<br>
So it's not just the same thing duplicated all over the place. There may be some duplication but I'm skeptical we can write just one command to satisfy all these needs.</p>



<a name="306646773"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/306646773" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Carroll <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#306646773">(Oct 28 2022 at 12:43)</a>:</h4>
<p>Oops, not an app! <span aria-label="sweat smile" class="emoji emoji-1f605" role="img" title="sweat smile">:sweat_smile:</span> But the other stuff</p>



<a name="306648117"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/306648117" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#306648117">(Oct 28 2022 at 12:51)</a>:</h4>
<p>I'm aware of that, the intent is not really to avoid duplication but to have one central function that allows us to easily track where in the code base zig is used. As Folkert suggested; <code>fn zig_cmd() -&gt; Command</code> would allow us to do this tracking without sacrificing any flexibility. You can still add args to the <code>Command</code> that gets returned.</p>
<p>Perhaps it makes sense to eventually go to a slightly less flexible version of <code>fn zig_cmd() -&gt; Command</code>, but it is a good start.</p>



<a name="306656076"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/306656076" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ghislain <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#306656076">(Oct 28 2022 at 13:29)</a>:</h4>
<p>Ok, so it looks out of my competence, I'll downgrade to MacOS Monterey until Roc migrate to zig 0.10.x (which looks to be released in the next 4 days)</p>



<a name="306657034"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/306657034" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#306657034">(Oct 28 2022 at 13:33)</a>:</h4>
<p>To set expectations; I believe zig 0.10 requires us upgrading to llvm 14 which requires significant effort.</p>



<a name="306659372"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/306659372" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#306659372">(Oct 28 2022 at 13:44)</a>:</h4>
<p>yeah if I were to guess, I'd guess we won't end up upgrading to Zig 0.10 until early 2023</p>



<a name="306659858"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/306659858" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#306659858">(Oct 28 2022 at 13:47)</a>:</h4>
<p>mainly because we're currently focusing on Advent of Code experience (which naturally runs through December), the 0.10 upgrade isn't needed for any of that, and it's a significant project</p>



<a name="306660348"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/306660348" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ghislain <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#306660348">(Oct 28 2022 at 13:49)</a>:</h4>
<p>Yes, I totally understand, so it's simpler - if I want to dive into the roc code and mess around with it - for me to downgrade</p>



<a name="306716154"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/306716154" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ghislain <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#306716154">(Oct 28 2022 at 17:51)</a>:</h4>
<p>Done, everything's working fine now I'm back to MacOS 12!</p>



<a name="320279139"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/320279139" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#320279139">(Jan 09 2023 at 17:10)</a>:</h4>
<p>For <span class="user-mention" data-user-id="550456">@Arbil</span> and others who had this issue with the vscode terminal from inside nix:<br>
<a href="/user_uploads/22008/aJKhN1ZLNRElVF_lSzae6QmZ/nix_vscode_terminal.png">nix_vscode_terminal.png</a> </p>
<div class="message_inline_image"><a href="/user_uploads/22008/aJKhN1ZLNRElVF_lSzae6QmZ/nix_vscode_terminal.png" title="nix_vscode_terminal.png"><img src="/user_uploads/22008/aJKhN1ZLNRElVF_lSzae6QmZ/nix_vscode_terminal.png"></a></div><p>I was able to resolve it in <a href="https://github.com/roc-lang/roc/pull/4868">this PR</a></p>



<a name="326502325"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/326502325" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Fred <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#326502325">(Feb 08 2023 at 04:18)</a>:</h4>
<p>Hi! I'm having an issue when building from source on macOS. <code>cargo build</code> works fine, and <code>cargo run repl</code> starts the repl, but when I enter anything it panics. I actually had the repl working fine when I initially set things up a few weeks ago, so I must have accidentally messed up my environment, but I can't figure out what changed. I'm using nix, and this is what happens after running <code>cargo clean</code>, <code>nix develop</code>, <code>cargo run repl</code> and then entering a value in the repl. Any ideas what this error is related to?</p>
<div class="codehilite"><pre><span></span><code>» 123
ld: unknown option: -no_fixup_chains
thread &#39;main&#39; panicked at &#39;
___________
Linking command failed with status ExitStatus(unix_wait_status(256)):

  Child { stdin: None, stdout: None, stderr: None, .. }
___________
&#39;, crates/compiler/build/src/link.rs:1464:5
stack backtrace:
   0: rust_begin_unwind
             at /rustc/a55dd71d5fb0ec5a6a3a9e8c27b2127ba491ce52/library/std/src/panicking.rs:584:5
   1: core::panicking::panic_fmt
             at /rustc/a55dd71d5fb0ec5a6a3a9e8c27b2127ba491ce52/library/core/src/panicking.rs:142:14
   2: roc_build::link::llvm_module_to_dylib
             at ./crates/compiler/build/src/link.rs:1464:5
   3: roc_repl_cli::cli_gen::mono_module_to_dylib
             at ./crates/repl_cli/src/cli_gen.rs:286:5
   4: roc_repl_cli::cli_gen::gen_and_eval_llvm
             at ./crates/repl_cli/src/cli_gen.rs:73:9
   5: roc_repl_cli::repl_state::ReplState::eval_and_format
             at ./crates/repl_cli/src/repl_state.rs:260:46
   6: roc_repl_cli::repl_state::ReplState::step
             at ./crates/repl_cli/src/repl_state.rs:122:46
   7: roc_repl_cli::main
             at ./crates/repl_cli/src/lib.rs:49:23
   8: roc::main
             at ./crates/cli/src/main.rs:194:35
   9: core::ops::function::FnOnce::call_once
             at /rustc/a55dd71d5fb0ec5a6a3a9e8c27b2127ba491ce52/library/core/src/ops/function.rs:248:5
</code></pre></div>



<a name="326510911"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/326510911" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#326510911">(Feb 08 2023 at 06:07)</a>:</h4>
<p>I tried it out using latest main and it seems to work for me. I'm on MacOS 12.6 using M2 silicon. </p>
<div class="codehilite" data-code-language="Bash"><pre><span></span><code><span class="m">192</span>-168-1-105:roc<span class="w"> </span>luke$<span class="w"> </span>cargo<span class="w"> </span>clean
<span class="m">192</span>-168-1-105:roc<span class="w"> </span>luke$<span class="w"> </span>nix<span class="w"> </span>develop
<span class="m">192</span>-168-1-105:roc<span class="w"> </span>luke$<span class="w"> </span>cargo<span class="w"> </span>run<span class="w"> </span>repl
<span class="w">   </span>Compiling<span class="w"> </span>libc<span class="w"> </span>v0.2.135
<span class="w">   </span><span class="o">[]</span>...<span class="w"> </span>deleted<span class="w"> </span>extra<span class="w"> </span>lines<span class="w"> </span>...<span class="o">[]</span>
<span class="w">   </span>Compiling<span class="w"> </span>roc_docs<span class="w"> </span>v0.0.1<span class="w"> </span><span class="o">(</span>/Users/luke/Documents/GitHub/roc/crates/docs<span class="o">)</span>
<span class="w">    </span>Finished<span class="w"> </span>dev<span class="w"> </span><span class="o">[</span>unoptimized<span class="w"> </span>+<span class="w"> </span>debuginfo<span class="o">]</span><span class="w"> </span>target<span class="o">(</span>s<span class="o">)</span><span class="w"> </span><span class="k">in</span><span class="w"> </span>1m<span class="w"> </span>20s
<span class="w">     </span>Running<span class="w"> </span><span class="sb">`</span>target/debug/roc<span class="w"> </span>repl<span class="sb">`</span>

<span class="w">  </span>The<span class="w"> </span>rockin’<span class="w"> </span>roc<span class="w"> </span>repl
────────────────────────

Enter<span class="w"> </span>an<span class="w"> </span>expression,<span class="w"> </span>or<span class="w"> </span>:help,<span class="w"> </span>or<span class="w"> </span>:q<span class="w"> </span>to<span class="w"> </span>quit.

»<span class="w"> </span><span class="m">123</span>

<span class="m">123</span><span class="w"> </span>:<span class="w"> </span>Num<span class="w"> </span>*<span class="w">               </span><span class="c1"># val1</span>
</code></pre></div>



<a name="327000563"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/327000563" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Fred <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#327000563">(Feb 10 2023 at 09:28)</a>:</h4>
<p>I was able to get this working by deleting "-no_fixup_chains" from crates/compiler/build/src/link.rs line 1283! Looks like it was <a href="https://github.com/roc-lang/roc/commit/1164fb47677ac208876b2da687780865c9542ceb">added in December</a>, so must have been before that when it was working for me.  I am also on MacOS 12.6 but with an intel chip by the way</p>



<a name="343934612"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/343934612" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> choonkeat <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#343934612">(Mar 23 2023 at 10:39)</a>:</h4>
<p><span class="user-mention silent" data-user-id="343810">Brendan Hansknecht</span> <a href="#narrow/stream/231634-beginners/topic/building.20from.20source/near/304271717">said</a>:</p>
<blockquote>
<p><code>echo "use nix" &gt;&gt; .envrc</code></p>
</blockquote>
<p>is quite slow</p>
<div class="codehilite"><pre><span></span><code>$ cd roc
direnv: loading ~/git/roc-lang/roc/.envrc
direnv: using nix
direnv: ([/opt/homebrew/bin/direnv export zsh]) is taking a while to execute. Use CTRL-C to give up.
</code></pre></div>
<p>am I doing it right?</p>
<div class="codehilite"><pre><span></span><code>$ cat .envrc
use nix
PATH_add target/debug
</code></pre></div>



<a name="344011036"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/344011036" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#344011036">(Mar 23 2023 at 15:14)</a>:</h4>
<p>The very first time is slow. Same with calling <code>nix develop</code> for the first time. After that, it should be cached and fast.</p>
<p>Not sure about the second line though. What does it do? If it cause nix to reevaluate whenever <code>target/debug</code> changes, that may break caching, but i have never used the <code>PATH_add</code> command. So i am not truly sure.</p>



<a name="344011724"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/344011724" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#344011724">(Mar 23 2023 at 15:16)</a>:</h4>
<p>My full <code>.envrc</code> is:</p>
<div class="codehilite"><pre><span></span><code>use flake
nix_direnv_watch_file rust-toolchain.toml
</code></pre></div>



<a name="344011964"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/344011964" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#344011964">(Mar 23 2023 at 15:17)</a>:</h4>
<p>First line at some point changed from <code>use nix</code> to <code>use flake</code>. Both should work cause our <code>shell.nix</code> just points to the flake. Not sure the real difference</p>



<a name="344012156"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/344012156" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#344012156">(Mar 23 2023 at 15:18)</a>:</h4>
<p>The second line is so that when I change the rust version to nightly (which I need for fuzzing and some random other times), it will force a re-evaluation</p>



<a name="344012915"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/344012915" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#344012915">(Mar 23 2023 at 15:20)</a>:</h4>
<p>Also, just looked of <code>PATH_add</code>, yeah, should be harmless. So probably just a matter of waiting for the first invocation that has to download and set everything up.</p>



<a name="344400712"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/344400712" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> choonkeat <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#344400712">(Mar 25 2023 at 02:04)</a>:</h4>
<p><span class="user-mention silent" data-user-id="343810">Brendan Hansknecht</span> <a href="#narrow/stream/231634-beginners/topic/building.20from.20source/near/344011964">said</a>:</p>
<blockquote>
<p>First line at some point changed from <code>use nix</code> to <code>use flake</code>. Both should work cause our <code>shell.nix</code> just points to the flake. Not sure the real difference</p>
</blockquote>
<p>using <code>use nix</code>, it's slow every time (not just first time)<br>
using <code>use flake</code> fails:</p>
<div class="codehilite"><pre><span></span><code>$ cd roc
direnv: loading ~/git/roc-lang/roc/.envrc
direnv: using flake
/bin/bash: eval:2231: conditional binary operator expected
/bin/bash: eval:2231: syntax error near `enableParallelBuilding&#39;
/bin/bash: eval:2231: `    if ! [[ -v enableParallelBuilding ]]; then&#39;
direnv: export +AR +AR_FOR_TARGET +AS +AS_FOR_TARGET +CC +CC_FOR_TARGET +CMAKE_FRAMEWORK_PATH +CMAKE_INCLUDE_PATH +CMAKE_LIBRARY_PATH +CMAKE_PREFIX_PATH +CONFIG_SHELL +CXX +CXX_FOR_TARGET +DETERMINISTIC_BUILD +HOST_PATH +IN_NIX_SHELL +LD +LD_DYLD_PATH +LD_FOR_TARGET +LD_LIBRARY_PATH +LLVM_SYS_130_PREFIX +MACOSX_DEPLOYMENT_TARGET +NIXPKGS_ALLOW_UNFREE +NIX_BINTOOLS +NIX_BINTOOLS_FOR_TARGET +NIX_BINTOOLS_WRAPPER_TARGET_HOST_aarch64_apple_darwin +NIX_BINTOOLS_WRAPPER_TARGET_TARGET_aarch64_apple_darwin +NIX_BUILD_CORES +NIX_CC +NIX_CC_FOR_TARGET +NIX_CC_WRAPPER_TARGET_HOST_aarch64_apple_darwin +NIX_CC_WRAPPER_TARGET_TARGET_aarch64_apple_darwin +NIX_CFLAGS_COMPILE +NIX_CFLAGS_COMPILE_FOR_TARGET +NIX_COREFOUNDATION_RPATH +NIX_DONT_SET_RPATH +NIX_DONT_SET_RPATH_FOR_BUILD +NIX_ENFORCE_NO_NATIVE +NIX_GLIBC_PATH +NIX_HARDENING_ENABLE +NIX_IGNORE_LD_THROUGH_GCC +NIX_INDENT_MAKE +NIX_LDFLAGS +NIX_LDFLAGS_FOR_TARGET +NIX_NO_SELF_RPATH +NIX_PKG_CONFIG_WRAPPER_TARGET_TARGET_aarch64_apple_darwin +NIX_STORE +NM +NM_FOR_TARGET +PATH_LOCALE +PKG_CONFIG_FOR_TARGET +PKG_CONFIG_PATH_FOR_TARGET +PYTHONHASHSEED +PYTHONNOUSERSITE +PYTHONPATH +RANLIB +RANLIB_FOR_TARGET +SIZE +SIZE_FOR_TARGET +SOURCE_DATE_EPOCH +STRINGS +STRINGS_FOR_TARGET +STRIP +STRIP_FOR_TARGET +XDG_DATA_DIRS +XML_CATALOG_FILES +__darwinAllowLocalNetworking +__impureHostDeps +__propagatedImpureHostDeps +__propagatedSandboxProfile +__sandboxProfile +__structuredAttrs +buildInputs +buildPhase +builder +cmakeFlags +configureFlags +depsBuildBuild +depsBuildBuildPropagated +depsBuildTarget +depsBuildTargetPropagated +depsHostHost +depsHostHostPropagated +depsTargetTarget +depsTargetTargetPropagated +doCheck +doInstallCheck +dontAddDisableDepTrack +mesonFlags +name +nativeBuildInputs +out +outputs +patches +phases +propagatedBuildInputs +propagatedNativeBuildInputs +shell +shellHook +stdenv +strictDeps +system ~PATH
</code></pre></div>
<p>so weird. probably my machine</p>
<div class="codehilite"><pre><span></span><code>$ nix --version
nix (Nix) 2.13.3
$ direnv version
2.32.2
</code></pre></div>



<a name="344408249"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/344408249" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#344408249">(Mar 25 2023 at 03:47)</a>:</h4>
<p>I don't have an immediate idea. What happens when you disable direnv and run <code>nix develop</code>?</p>



<a name="346290069"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/346290069" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> choonkeat <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#346290069">(Apr 02 2023 at 04:10)</a>:</h4>
<p><span class="user-mention silent" data-user-id="343810">Brendan Hansknecht</span> <a href="#narrow/stream/231634-beginners/topic/building.20from.20source/near/344408249">said</a>:</p>
<blockquote>
<p>I don't have an immediate idea. What happens when you disable direnv and run <code>nix develop</code>?</p>
</blockquote>
<p>running <code>nix develop</code> without any <code>direnv</code> interference works great (i.e. <code>cargo build</code> works)</p>
<p>just to close the loop: though I'd seen the notices about <code>old version of bash used in MacOS</code> everywhere but somehow my mind refused to follow the trail maybe because I'm using zsh?... but whatevs, I finally <code>brew install bash</code> and now <code>use flake</code> in my <code>.envrc</code> works and is super fast <span aria-label="tada" class="emoji emoji-1f389" role="img" title="tada">:tada:</span><span aria-label="face palm" class="emoji emoji-1f926" role="img" title="face palm">:face_palm:</span>‍♂️</p>



<a name="346304200"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/346304200" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#346304200">(Apr 02 2023 at 06:47)</a>:</h4>
<p>Glad you found a workaround. Direnv can definitely work with zsh in Mac, but i guess it may hit whatever issue you had. Maybe the issue is with trying to load bash config into the zsh shell...no real idea.</p>



<a name="405363525"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/405363525" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Matthew Phillips <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#405363525">(Dec 01 2023 at 13:28)</a>:</h4>
<p>I'm not familiar with Cargo, is there a "clean" command I can run? Or can I just delete the <code>target/</code> folder?</p>



<a name="405364017"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/405364017" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#405364017">(Dec 01 2023 at 13:30)</a>:</h4>
<p><code>cargo clean</code> should delete all the temporary stuff, yeah</p>



<a name="438157187"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/438157187" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> ZD <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#438157187">(May 12 2024 at 04:55)</a>:</h4>
<p>Hello, After a few tries I finally succeeded to build from source. There were warnings, but no more blocking errors. However, when I run <code>./target/debug/roc</code>, I got below message.</p>
<p>"Target triple (aarch64-unknown-freebsd) is not currently supported by the roc compiler."</p>
<p>Is FreeBSD a no-go, or did I miss something? Thank you.</p>



<a name="438162145"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/438162145" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#438162145">(May 12 2024 at 06:31)</a>:</h4>
<p>Probably would be easy to support</p>



<a name="438162153"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/438162153" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#438162153">(May 12 2024 at 06:31)</a>:</h4>
<p>We just don't have it in the compiler</p>



<a name="438162167"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/438162167" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#438162167">(May 12 2024 at 06:31)</a>:</h4>
<p>Like probably could just be mapped to Linux or a generic Unix. I don't think anything is special about it</p>



<a name="438172908"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/Building%20from%20source/near/438172908" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> ZD <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/Building.20from.20source.html#438172908">(May 12 2024 at 09:47)</a>:</h4>
<p>Noted, thank you</p>



<hr><p>Last updated: Mar 01 2026 at 12:20 UTC</p>
</html>