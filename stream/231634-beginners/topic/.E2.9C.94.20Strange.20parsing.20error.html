<html>
<head><meta charset="utf-8"><title>✔ Strange parsing error · beginners · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/index.html">beginners</a></h2>
<h3>Topic: <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/.E2.9C.94.20Strange.20parsing.20error.html">✔ Strange parsing error</a></h3>

<hr>

<base href="https://roc.zulipchat.com">

<head><link href="https://roc-lang.github.io/zulip-export/style.css" rel="stylesheet"></head>

<a name="574412888"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/%E2%9C%94%20Strange%20parsing%20error/near/574412888" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Claude Précourt <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/.E2.9C.94.20Strange.20parsing.20error.html#574412888">(Feb 18 2026 at 01:09)</a>:</h4>
<p>Hello all,</p>
<p>I am dipping my toes with the new compiler and I hit something strange, not knowing if it's me not understanding something obvious with the new syntax or if I've hit a bug/unimplemented feature.</p>
<p>Context: I am using the latest <em>basic_cli</em> with the recommended nightly build of <em>roc</em> (although I get the same error with the latest, along with others).</p>
<p>I've identified the part I don't understand within the code which is in the <em>walk_directory!</em> method:</p>
<div class="codehilite" data-code-language="Text only"><pre><span></span><code>app [main!] { pf: platform "../roc-new-compiler/basic-cli/platform/main.roc"}

import pf.Stdout
import pf.Dir

main! = |args| {

    root_paths = List.drop_first(args, 1).take_first(1)
    dirs = fold!(root_paths, [], walk_directory!)

    Stdout.line!(Str.inspect(dirs))

    Ok({})
}

fold! : List(item), state, (state, item =&gt; state) =&gt; state
fold! = |list, init, step| {
    var $state = init

    for item in list {
        $state = step($state, item)
    }

    $state
}

walk_directory! : List(Str), Str =&gt; List(Str)
walk_directory! = |paths, root_path| {
    children = match Dir.list!(root_path) {
        Ok(new_paths) =&gt; new_paths
        Err(_) =&gt; []
    }

    end_state = fold!(children, {files: [], directories: []},

            # This doesn't work:
            #
            # |state, _path|
            #     full_path = "A file name"
            #     {..state, files: List.append(state.files, full_path)}

            # But this does works :
            |state, _path|
                {..state, files: List.append(state.files, "A file name")}
        )

    List.concat(paths, end_state.files)
}
</code></pre></div>
<p>With the chunk of code uncommented I get this error:</p>
<div class="codehilite" data-code-language="Text only"><pre><span></span><code>-- PARSE ERROR -----------------------------------

A parsing error occurred: expected_expr_apply_close_round
This is an unexpected parsing error. Please check your syntax.

   ┌─ main.roc:34:17
   │
34 │     end_state = fold!(children, {files: [], directories: []},
   │                 ^^^^^

-- UNEXPECTED TOKEN IN EXPRESSION ----------------

The token ) is not expected in an expression.
Expressions can be identifiers, literals, function calls, or operators.

   ┌─ main.roc:45:9
   │
45 │         )
   │         ^
</code></pre></div>



<a name="574413945"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/%E2%9C%94%20Strange%20parsing%20error/near/574413945" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/.E2.9C.94.20Strange.20parsing.20error.html#574413945">(Feb 18 2026 at 01:19)</a>:</h4>
<p>The issue with this is you are missing the block expression I think</p>
<div class="codehilite"><pre><span></span><code># no block
|state, _path|
    full_path = &quot;A file name&quot;
    {..state, files: List.append(state.files, full_path)}

# with block
|state, _path| {
    full_path = &quot;A file name&quot;
    {..state, files: List.append(state.files, full_path)}
}
</code></pre></div>



<a name="574414508"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/%E2%9C%94%20Strange%20parsing%20error/near/574414508" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Notification Bot <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/.E2.9C.94.20Strange.20parsing.20error.html#574414508">(Feb 18 2026 at 01:25)</a>:</h4>
<p><span class="user-mention silent" data-user-id="928710">Claude Précourt</span> has marked this topic as resolved.</p>



<a name="574414578"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/%E2%9C%94%20Strange%20parsing%20error/near/574414578" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Claude Précourt <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/.E2.9C.94.20Strange.20parsing.20error.html#574414578">(Feb 18 2026 at 01:26)</a>:</h4>
<p>Exactly! It <em>felt</em> like a simple mistake... Thank you so much!</p>



<a name="574414889"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/%E2%9C%94%20Strange%20parsing%20error/near/574414889" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/.E2.9C.94.20Strange.20parsing.20error.html#574414889">(Feb 18 2026 at 01:30)</a>:</h4>
<p>I feel like we had a rough plan for detecting this exact syntax error and providing a more helpful error message... but I can't remember.</p>



<a name="574414935"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/%E2%9C%94%20Strange%20parsing%20error/near/574414935" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/.E2.9C.94.20Strange.20parsing.20error.html#574414935">(Feb 18 2026 at 01:31)</a>:</h4>
<p>I imagine it is difficult to solve in a really general way, so I feel like it was a heuristic trial and error thing</p>



<a name="574414947"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/%E2%9C%94%20Strange%20parsing%20error/near/574414947" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/.E2.9C.94.20Strange.20parsing.20error.html#574414947">(Feb 18 2026 at 01:31)</a>:</h4>
<p><span class="user-mention" data-user-id="453336">@Joshua Warner</span> can you remember if we had a plan for this?</p>



<a name="574415131"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/%E2%9C%94%20Strange%20parsing%20error/near/574415131" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/.E2.9C.94.20Strange.20parsing.20error.html#574415131">(Feb 18 2026 at 01:33)</a>:</h4>
<p>Roughly: track indentation and use that as a hint in the parser, but only for error code paths (never the happy path)</p>



<a name="574415290"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/%E2%9C%94%20Strange%20parsing%20error/near/574415290" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/.E2.9C.94.20Strange.20parsing.20error.html#574415290">(Feb 18 2026 at 01:35)</a>:</h4>
<p>I also have a pet project idea to train a tiny languages model of like 20m parameters that knows how to fix a variety of syntax errors, is well within the range that can be cheaply inferenced locally, and can just ship with the compiler.</p>



<a name="574415616"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/%E2%9C%94%20Strange%20parsing%20error/near/574415616" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/.E2.9C.94.20Strange.20parsing.20error.html#574415616">(Feb 18 2026 at 01:39)</a>:</h4>
<p>Generally bullish on the approach of having a significant corpus of roc code, with a way to introduce real syntax errors in ways that the fix remains “obvious” by looking at a small amount of context. Then you use that to either train a model, or tune a bunch of heuristics (possibly automatically), etc.</p>



<a name="574415925"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/%E2%9C%94%20Strange%20parsing%20error/near/574415925" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/.E2.9C.94.20Strange.20parsing.20error.html#574415925">(Feb 18 2026 at 01:43)</a>:</h4>
<p>Would it be worth putting anything together about this in a GH Issue so we can track it -- even if it's only an R&amp;D concept at this stage?</p>



<a name="574416068"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/%E2%9C%94%20Strange%20parsing%20error/near/574416068" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/.E2.9C.94.20Strange.20parsing.20error.html#574416068">(Feb 18 2026 at 01:44)</a>:</h4>
<p>It sounds like a generally interesting problem someone may want to pick up -- if you haven't already called dibbs <span class="user-mention" data-user-id="453336">@Joshua Warner</span></p>



<a name="574416150"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/%E2%9C%94%20Strange%20parsing%20error/near/574416150" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/.E2.9C.94.20Strange.20parsing.20error.html#574416150">(Feb 18 2026 at 01:45)</a>:</h4>
<p>It’s wide open! Happy to mentor someone a bit, but my time is incredibly limited currently.</p>



<hr><p>Last updated: Mar 01 2026 at 12:20 UTC</p>
</html>