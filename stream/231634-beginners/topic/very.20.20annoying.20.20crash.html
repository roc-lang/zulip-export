<html>
<head><meta charset="utf-8"><title>very  annoying  crash · beginners · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/index.html">beginners</a></h2>
<h3>Topic: <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/very.20.20annoying.20.20crash.html">very  annoying  crash</a></h3>

<hr>

<base href="https://roc.zulipchat.com">

<head><link href="https://roc-lang.github.io/zulip-export/style.css" rel="stylesheet"></head>

<a name="403442722"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/very%20%20annoying%20%20crash/near/403442722" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Artur Swiderski <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/very.20.20annoying.20.20crash.html#403442722">(Nov 21 2023 at 18:46)</a>:</h4>
<p>Commit "crash section line 240 - 244"<br>
18b860962c077031007f96150f6367787bb194d0<br>
in  file  <a href="https://github.com/salarii/peek/blob/main/regex.roc">https://github.com/salarii/peek/blob/main/regex.roc</a></p>
<p>this  crash  is very  annoying because  unlike in other  cases I can't figure out ways around  it : ( . I have to uncomment  for now</p>



<a name="403559292"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/very%20%20annoying%20%20crash/near/403559292" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/very.20.20annoying.20.20crash.html#403559292">(Nov 22 2023 at 10:04)</a>:</h4>
<p>I'll try to take a look today</p>



<a name="403602903"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/very%20%20annoying%20%20crash/near/403602903" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Artur Swiderski <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/very.20.20annoying.20.20crash.html#403602903">(Nov 22 2023 at 14:24)</a>:</h4>
<p>this  commit   37f0e9be0b014590b346cc75b6642938b352d78b  also crash <br>
It is   vicious because  it does not  inform  even that it is crashing, and it is unrelated to  previous issue</p>



<a name="403637582"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/very%20%20annoying%20%20crash/near/403637582" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/very.20.20annoying.20.20crash.html#403637582">(Nov 22 2023 at 17:34)</a>:</h4>
<p>I won't be able to look at this today or tomorrow, is someone else able to help out?</p>



<a name="403644948"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/very%20%20annoying%20%20crash/near/403644948" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/very.20.20annoying.20.20crash.html#403644948">(Nov 22 2023 at 18:27)</a>:</h4>
<p>I wanted to look but didn't get to it and will be travelling. Not sure I'll get a chance.</p>



<a name="403663376"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/very%20%20annoying%20%20crash/near/403663376" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/very.20.20annoying.20.20crash.html#403663376">(Nov 22 2023 at 20:49)</a>:</h4>
<p>I haven't found the issue causing this segfault yet. </p>
<p>But I do have some tips which I find help me with these kind of issues.</p>
<ol>
<li>I like to use type annotations it help the compiler to check the types are what I expect at various points. Even just top level definitions is really helpful, and significantly improves the error messages.</li>
<li>I like to unit tests for my functions using <code>expect</code></li>
<li>I find using <code>roc check</code> and working through to resolve all the warnings oftens helps lead me to a place where I see an issue.</li>
</ol>



<a name="403663379"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/very%20%20annoying%20%20crash/near/403663379" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/very.20.20annoying.20.20crash.html#403663379">(Nov 22 2023 at 20:49)</a>:</h4>
<p>The current implementation of <code>dbg</code> has been a common cause of bugs. It will soon be replaced with the <code>Inspect</code> ability which will significantly improve <code>dbg</code> stability I think.</p>



<a name="403665524"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/very%20%20annoying%20%20crash/near/403665524" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/very.20.20annoying.20.20crash.html#403665524">(Nov 22 2023 at 21:08)</a>:</h4>
<p>In the below snippet you are using the <code>Character</code> tag in two different ways, one without a payload and one with.</p>
<div class="codehilite"><pre><span></span><code>getRegexTokens = \result -&gt;
    when result.tag is
        Character -&gt;
            when List.first result.parsedResult.matched is
                Ok matched -&gt;
                    Ok [createToken (Character matched) Once Bool.false]

                Err _ -&gt; Err &quot;character  tag problem&quot;

        _ -&gt;
            Err &quot;wrong tag&quot;
</code></pre></div>



<a name="403667661"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/very%20%20annoying%20%20crash/near/403667661" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/very.20.20annoying.20.20crash.html#403667661">(Nov 22 2023 at 21:28)</a>:</h4>
<p>I'm finding it difficult to follow the types through this. I've spent some time adding annotations and looking at this, but it is a pretty big and complex. </p>
<p>I would love to find the segfault, but I probably should move on to other things. </p>
<p>If you  have the time and are able add more type annotations, I think you could narrow this issue down, and it would be really helpful to make an issue with a minimal reproduction of the segfault. Just keep removing code until you have a minimal example.</p>



<a name="403678962"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/very%20%20annoying%20%20crash/near/403678962" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Artur Swiderski <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/very.20.20annoying.20.20crash.html#403678962">(Nov 22 2023 at 23:14)</a>:</h4>
<p>sorry I knew  where bug  was I spotted it myself  but I was complaining that that  application  does not report  crash  or  anything was it ok ?</p>



<a name="403679199"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/very%20%20annoying%20%20crash/near/403679199" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Artur Swiderski <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/very.20.20annoying.20.20crash.html#403679199">(Nov 22 2023 at 23:17)</a>:</h4>
<p>clearly  I made  mistake  but that wasn't the point , I  did not expect  compiler to  show  just nothing as it is and I was reporting that</p>



<a name="403679750"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/very%20%20annoying%20%20crash/near/403679750" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Artur Swiderski <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/very.20.20annoying.20.20crash.html#403679750">(Nov 22 2023 at 23:23)</a>:</h4>
<p>regarding  type annotation  good and bad point at the same  time, usually I don't know  what I want, so I let compiler  to  decide, additionally   I do not have  skill  to add proper types  anyway. Still  compiler  should do it's work and  provide  some  feedback about  crash  or some discrepancies.</p>



<a name="403680109"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/very%20%20annoying%20%20crash/near/403680109" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Artur Swiderski <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/very.20.20annoying.20.20crash.html#403680109">(Nov 22 2023 at 23:27)</a>:</h4>
<p>beside that,  some  types, I am using  are complex and  to write them down it would be  painful , and I am grateful I don't have to</p>



<a name="403680110"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/very%20%20annoying%20%20crash/near/403680110" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Elias Mulhall <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/very.20.20annoying.20.20crash.html#403680110">(Nov 22 2023 at 23:27)</a>:</h4>
<p>You might find out helpful to use <code>roc check</code> until there are 0 reported errors, and only then use <code>roc run</code>. Roc will still try to run your code when there are issues, but if it runs into one of the invalid code paths it will crash. Right now that crash message is not helpful.</p>



<a name="403680208"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/very%20%20annoying%20%20crash/near/403680208" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Artur Swiderski <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/very.20.20annoying.20.20crash.html#403680208">(Nov 22 2023 at 23:28)</a>:</h4>
<p>I was using  run  dev , I expect  it to show  something</p>



<a name="403680228"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/very%20%20annoying%20%20crash/near/403680228" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Artur Swiderski <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/very.20.20annoying.20.20crash.html#403680228">(Nov 22 2023 at 23:28)</a>:</h4>
<p>because  it usually does but not this time</p>



<a name="403680508"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/very%20%20annoying%20%20crash/near/403680508" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Artur Swiderski <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/very.20.20annoying.20.20crash.html#403680508">(Nov 22 2023 at 23:32)</a>:</h4>
<p>sorry  I messed up completely I was talking  about second  problem <span aria-label="joy" class="emoji emoji-1f602" role="img" title="joy">:joy:</span><br>
Thx  for  tips  for   first  problem <span aria-label="sweat smile" class="emoji emoji-1f605" role="img" title="sweat smile">:sweat_smile:</span></p>



<a name="403680693"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/very%20%20annoying%20%20crash/near/403680693" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/very.20.20annoying.20.20crash.html#403680693">(Nov 22 2023 at 23:34)</a>:</h4>
<p>Sorry, I should have mentioned this additional context. I misunderstood your original question.</p>
<p>It looks like you have found a compiler bug. The issue you are seeing is that the executable that is generated is invalid, and when executed it segfaults on your machine. </p>
<p>You are not seeing a nice error message because it is not caused by a roc <code>crash</code> or rust <code>panic</code>. </p>
<p>This is certainly a bug in the compiler. </p>
<p>As Roc is still young and maturing, it is unfortunately still easy to run into these issues. </p>
<p>In future these will be really uncommon as the compiler is battle tested against lots of different kinds of programs. To help us get there, it is really helpful when you find an issue like this to report it. This way it can be fixed, and a test added to prevent future regressions.</p>



<a name="403681503"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/231634-beginners/topic/very%20%20annoying%20%20crash/near/403681503" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Artur Swiderski <a href="https://roc-lang.github.io/zulip-export/stream/231634-beginners/topic/very.20.20annoying.20.20crash.html#403681503">(Nov 22 2023 at 23:44)</a>:</h4>
<p>to be clear   first  issue I haven't solved  yet &lt;--- your tips for that is  to annotate more ??<br>
second reported  issue   &lt;---  this is easy , just reported  that compiler is  silent </p>
<p>type annotations  may help me  solve first  one?</p>
<p>The  problem  is that when I  narrowed  down  a bit  problematic  code  it seemed to  work  only together it seems  to  fail. </p>
<p>btw.  it is  true. In this  specific code I am using  sometimes  the  same  tag  by  name  in different  context without  warning.</p>



<hr><p>Last updated: Nov 01 2025 at 12:13 UTC</p>
</html>