<html>
<head><meta charset="utf-8"><title>Panic When Mapping -&gt; Try function on List · bugs · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://roc-lang.github.io/zulip-export/stream/463736-bugs/index.html">bugs</a></h2>
<h3>Topic: <a href="https://roc-lang.github.io/zulip-export/stream/463736-bugs/topic/Panic.20When.20Mapping.20-.3E.20Try.20function.20on.20List.html">Panic When Mapping -&gt; Try function on List</a></h3>

<hr>

<base href="https://roc.zulipchat.com">

<head><link href="https://roc-lang.github.io/zulip-export/style.css" rel="stylesheet"></head>

<a name="563094904"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/463736-bugs/topic/Panic%20When%20Mapping%20-%3E%20Try%20function%20on%20List/near/563094904" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Edwin Santos <a href="https://roc-lang.github.io/zulip-export/stream/463736-bugs/topic/Panic.20When.20Mapping.20-.3E.20Try.20function.20on.20List.html#563094904">(Dec 11 2025 at 02:35)</a>:</h4>
<p>Hi again <span aria-label="sweat smile" class="emoji emoji-1f605" role="img" title="sweat smile">:sweat_smile:</span> </p>
<p>When trying to run the below:</p>
<div class="codehilite"><pre><span></span><code>app [main!] { pf: platform &quot;https://github.com/lukewilliamboswell/roc-platform-template-zig/releases/download/0.4/6XA8JLWhmG1FSgb8GxPjBs9cGrtRqopohR3KAHYo722z.tar.zst&quot; }


import pf.Stdout

main! = |_args| {
    list_flats = [&quot;2022&quot;, &quot;22&quot;, &quot;11&quot;, &quot;ots&quot;]
    _list_try = List.map(list_flats, U64.from_str)
    Ok({})
}
</code></pre></div>
<p>I'm getting the stack trace:</p>
<p>thread 2065897 panic: reached unreachable code<br>
???:?:?: 0x1041cc0f3 in ??? (list_test.roc)<br>
???:?:?: 0x1042be157 in ??? (list_test.roc)<br>
???:?:?: 0x10437bce3 in ??? (list_test.roc)<br>
???:?:?: 0x10423ed2f in ??? (list_test.roc)<br>
???:?:?: 0x1041f0a7f in ??? (list_test.roc)<br>
???:?:?: 0x1041c5fcf in ??? (list_test.roc)<br>
???:?:?: 0x1041c37cf in ??? (list_test.roc)<br>
???:?:?: 0x1041c3237 in ??? (list_test.roc)<br>
???:?:?: 0x1041c319b in ??? (list_test.roc)<br>
???:?:?: 0x181a1c273 in ??? (???)<br>
???:?:?: 0x0 in ??? (???)</p>
<p>Roc check passes on this file without issue. The following code which applies the fallible function without creating a List does succeed:</p>
<div class="codehilite"><pre><span></span><code>main! = |_args| {
    list_flats = [&quot;2022&quot;, &quot;22&quot;, &quot;11&quot;, &quot;ots&quot;]
    for elt in list_flats {
        int_elt = match U64.from_str(elt) {
            Ok(i) =&gt; U64.to_str(i)
            Err(_) =&gt; &quot;Was not an int string&quot;
        }
        Stdout.line!(&quot;Val ${int_elt}&quot;)
    }
    Ok({})
}
</code></pre></div>
<p>Let me know if I should create a GH issue for this.</p>



<a name="563095189"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/463736-bugs/topic/Panic%20When%20Mapping%20-%3E%20Try%20function%20on%20List/near/563095189" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/463736-bugs/topic/Panic.20When.20Mapping.20-.3E.20Try.20function.20on.20List.html#563095189">(Dec 11 2025 at 02:38)</a>:</h4>
<p>Can you try with the latest platform release <a href="https://github.com/lukewilliamboswell/roc-platform-template-zig/releases/tag/0.5">https://github.com/lukewilliamboswell/roc-platform-template-zig/releases/tag/0.5</a></p>



<a name="563095216"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/463736-bugs/topic/Panic%20When%20Mapping%20-%3E%20Try%20function%20on%20List/near/563095216" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/463736-bugs/topic/Panic.20When.20Mapping.20-.3E.20Try.20function.20on.20List.html#563095216">(Dec 11 2025 at 02:38)</a>:</h4>
<p>Also are you using roc built from source? </p>
<p>Would you mind sharing the result of <code>roc version</code></p>



<a name="563095224"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/463736-bugs/topic/Panic%20When%20Mapping%20-%3E%20Try%20function%20on%20List/near/563095224" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Edwin Santos <a href="https://roc-lang.github.io/zulip-export/stream/463736-bugs/topic/Panic.20When.20Mapping.20-.3E.20Try.20function.20on.20List.html#563095224">(Dec 11 2025 at 02:39)</a>:</h4>
<p>On a potentially related note, the following code:</p>
<div class="codehilite"><pre><span></span><code>app [main!] { pf: platform &quot;https://github.com/lukewilliamboswell/roc-platform-template-zig/releases/download/0.3/98T93wthPgoBRLYtPTT4RBBsQunrfDG94gihPf1zYYmE.tar.zst&quot; }

input_multi =
    \\R41
    \\R17
    \\L15
    \\L2
    \\L41
    \\L47
    \\L42

import pf.Stdout


main! = |_args| {
    input_list : List(Str)
    input_list = input_multi.split_on(&quot;\n&quot;)
    _a = input_list.take_first(10).for_each!(|elt| Stdout.line!(&quot;Row value ${elt}&quot;))
    run_sample = input_list.take_first(10).map(parse_direction)
    _b = run_sample.take_first(10).for_each!(|r_elt| match r_elt {
        Ok(s) =&gt; Stdout.line!(&quot;Successful parse as ${s}&quot;)
        Err(e) =&gt; Stdout.line!(&quot;Parse failure: ${e}&quot;)
    })
}

parse_direction : Str -&gt; Try(I64, _)
parse_direction = |string| {
    if string.starts_with(&quot;L&quot;) {
        parse_attempt = string.drop_prefix(&quot;L&quot;) -&gt; I64.from_str
        parse = parse_attempt?
        Ok(parse *-1)
    } else if string.starts_with(&quot;R&quot;) {
        string.drop_prefix(&quot;R&quot;) -&gt; I64.from_str
    } else {
        Err(RotationIsNotLR)
    }
}
</code></pre></div>
<p>Also fails on applying a fallible function to a List. This one gives a distinct stack trace:</p>
<div class="codehilite"><pre><span></span><code>thread 2072461 panic: trying to add var at rank 1, but current rank is 0
???:?:?: 0x10673d07b in _generalize.VarPool.addVarToRank (???)
???:?:?: 0x106747907 in _Check.unifyWithCtx (???)
???:?:?: 0x1065d476b in _Check.unifyFromAnno (???)
???:?:?: 0x1063c1e77 in _Check.checkPlatformRequirements (???)
???:?:?: 0x1063bf037 in _main.setupSharedMemoryWithModuleEnv (???)
???:?:?: 0x1063c51bb in _main.rocRun (???)
???:?:?: 0x10652bcc3 in _main.mainArgs (???)
???:?:?: 0x10652d1eb in _main.main (???)
???:?:?: 0x10652d723 in _main (???)
???:?:?: 0x181a1c273 in ??? (???)
???:?:?: 0x0 in ??? (???)
zsh: abort      roc run aoc_2025_01.roc
</code></pre></div>



<a name="563095270"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/463736-bugs/topic/Panic%20When%20Mapping%20-%3E%20Try%20function%20on%20List/near/563095270" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Edwin Santos <a href="https://roc-lang.github.io/zulip-export/stream/463736-bugs/topic/Panic.20When.20Mapping.20-.3E.20Try.20function.20on.20List.html#563095270">(Dec 11 2025 at 02:39)</a>:</h4>
<p><span class="user-mention silent" data-user-id="515757">Luke Boswell</span> <a href="#narrow/channel/463736-bugs/topic/Panic.20When.20Mapping.20-.3E.20Try.20function.20on.20List/near/563095216">said</a>:</p>
<blockquote>
<p>Also are you using roc built from source? </p>
<p>Would you mind sharing the result of <code>roc version</code></p>
</blockquote>
<p>Yeah I just pulled from upstream main a second ago, this is the roc version</p>
<p>Roc compiler version debug-b1fd9424</p>



<a name="563095338"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/463736-bugs/topic/Panic%20When%20Mapping%20-%3E%20Try%20function%20on%20List/near/563095338" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/463736-bugs/topic/Panic.20When.20Mapping.20-.3E.20Try.20function.20on.20List.html#563095338">(Dec 11 2025 at 02:40)</a>:</h4>
<p>I'll take a look!</p>



<a name="563095339"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/463736-bugs/topic/Panic%20When%20Mapping%20-%3E%20Try%20function%20on%20List/near/563095339" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/463736-bugs/topic/Panic.20When.20Mapping.20-.3E.20Try.20function.20on.20List.html#563095339">(Dec 11 2025 at 02:40)</a>:</h4>
<p>We've had some breaking changes since those older releases... I might delete them</p>



<a name="563095354"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/463736-bugs/topic/Panic%20When%20Mapping%20-%3E%20Try%20function%20on%20List/near/563095354" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/463736-bugs/topic/Panic.20When.20Mapping.20-.3E.20Try.20function.20on.20List.html#563095354">(Dec 11 2025 at 02:40)</a>:</h4>
<p>I wish there was a way to "archive" a release in GH</p>



<a name="563095378"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/463736-bugs/topic/Panic%20When%20Mapping%20-%3E%20Try%20function%20on%20List/near/563095378" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/463736-bugs/topic/Panic.20When.20Mapping.20-.3E.20Try.20function.20on.20List.html#563095378">(Dec 11 2025 at 02:41)</a>:</h4>
<p>Or maybe I should just leave them..</p>



<a name="563095506"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/463736-bugs/topic/Panic%20When%20Mapping%20-%3E%20Try%20function%20on%20List/near/563095506" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/463736-bugs/topic/Panic.20When.20Mapping.20-.3E.20Try.20function.20on.20List.html#563095506">(Dec 11 2025 at 02:43)</a>:</h4>
<p>you can just delete them</p>



<a name="563095511"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/463736-bugs/topic/Panic%20When%20Mapping%20-%3E%20Try%20function%20on%20List/near/563095511" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Edwin Santos <a href="https://roc-lang.github.io/zulip-export/stream/463736-bugs/topic/Panic.20When.20Mapping.20-.3E.20Try.20function.20on.20List.html#563095511">(Dec 11 2025 at 02:43)</a>:</h4>
<p>I just reran the both examples  with the following:</p>
<p>app [main!] { pf: platform "<a href="https://github.com/lukewilliamboswell/roc-platform-template-zig/releases/download/0.5/BJBzo2SR2o5w3StmubGWvnPHq6hfePMaNWy5MwkPuZUs.tar.zst">https://github.com/lukewilliamboswell/roc-platform-template-zig/releases/download/0.5/BJBzo2SR2o5w3StmubGWvnPHq6hfePMaNWy5MwkPuZUs.tar.zst</a>" }</p>
<p>from the platform release yesterday, each had their same panics as before.</p>



<a name="563095519"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/463736-bugs/topic/Panic%20When%20Mapping%20-%3E%20Try%20function%20on%20List/near/563095519" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/463736-bugs/topic/Panic.20When.20Mapping.20-.3E.20Try.20function.20on.20List.html#563095519">(Dec 11 2025 at 02:43)</a>:</h4>
<p>anyone who was using them will have them cached locally anyway</p>



<hr><p>Last updated: Mar 01 2026 at 12:20 UTC</p>
</html>