<html>
<head><meta charset="utf-8"><title>roc build not compiling app sibling modules · bugs · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://roc-lang.github.io/zulip-export/stream/463736-bugs/index.html">bugs</a></h2>
<h3>Topic: <a href="https://roc-lang.github.io/zulip-export/stream/463736-bugs/topic/roc.20build.20not.20compiling.20app.20sibling.20modules.html">roc build not compiling app sibling modules</a></h3>

<hr>

<base href="https://roc.zulipchat.com">

<head><link href="https://roc-lang.github.io/zulip-export/style.css" rel="stylesheet"></head>

<a name="569151617"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/463736-bugs/topic/roc%20build%20not%20compiling%20app%20sibling%20modules/near/569151617" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nandi <a href="https://roc-lang.github.io/zulip-export/stream/463736-bugs/topic/roc.20build.20not.20compiling.20app.20sibling.20modules.html#569151617">(Jan 21 2026 at 00:43)</a>:</h4>
<ul>
<li><code>roc</code> goes through <code>setupSharedMemoryWithModuleEnv</code> and <strong>explicitly compiles sibling modules before app canonicalization</strong>, based on imports extracted from the app AST.<ul>
<li>File: <code>/home/nandi/code/roc/src/cli/main.zig</code> (see the section starting with “Compile sibling .roc files BEFORE app canonicalization.”)</li>
</ul>
</li>
<li><code>roc build</code> uses <code>compileAndSerializeModulesForEmbedding</code>, which <strong>only compiles platform modules + app</strong>, and does <strong>not</strong> compile app sibling modules.<ul>
<li>File: <code>/home/nandi/code/roc/src/cli/main.zig</code> inside <code>compileAndSerializeModulesForEmbedding</code>.</li>
</ul>
</li>
</ul>



<a name="569178921"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/463736-bugs/topic/roc%20build%20not%20compiling%20app%20sibling%20modules/near/569178921" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/463736-bugs/topic/roc.20build.20not.20compiling.20app.20sibling.20modules.html#569178921">(Jan 21 2026 at 06:18)</a>:</h4>
<p>Is this a question or bug report?</p>



<a name="569178941"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/463736-bugs/topic/roc%20build%20not%20compiling%20app%20sibling%20modules/near/569178941" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/463736-bugs/topic/roc.20build.20not.20compiling.20app.20sibling.20modules.html#569178941">(Jan 21 2026 at 06:19)</a>:</h4>
<p>Have you observed some behaviour that isn't right?</p>



<a name="569180732"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/463736-bugs/topic/roc%20build%20not%20compiling%20app%20sibling%20modules/near/569180732" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nandi <a href="https://roc-lang.github.io/zulip-export/stream/463736-bugs/topic/roc.20build.20not.20compiling.20app.20sibling.20modules.html#569180732">(Jan 21 2026 at 06:37)</a>:</h4>
<p>Is it a bug that <code>roc build</code> doesnt compile sibling modules?</p>



<a name="569181657"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/463736-bugs/topic/roc%20build%20not%20compiling%20app%20sibling%20modules/near/569181657" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/463736-bugs/topic/roc.20build.20not.20compiling.20app.20sibling.20modules.html#569181657">(Jan 21 2026 at 06:46)</a>:</h4>
<p>I don't understand what you mean by doesn't compile sibling modules. </p>
<p>Like if I have an app, with an <code>import Foo</code> in it -- you can't use <code>Foo</code> with <code>roc build app.roc</code> but you can with <code>roc app.roc</code>?</p>



<a name="569182363"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/463736-bugs/topic/roc%20build%20not%20compiling%20app%20sibling%20modules/near/569182363" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nandi <a href="https://roc-lang.github.io/zulip-export/stream/463736-bugs/topic/roc.20build.20not.20compiling.20app.20sibling.20modules.html#569182363">(Jan 21 2026 at 06:53)</a>:</h4>
<p>It has to be in platform folder in <code>roc build</code></p>



<a name="569182426"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/463736-bugs/topic/roc%20build%20not%20compiling%20app%20sibling%20modules/near/569182426" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nandi <a href="https://roc-lang.github.io/zulip-export/stream/463736-bugs/topic/roc.20build.20not.20compiling.20app.20sibling.20modules.html#569182426">(Jan 21 2026 at 06:54)</a>:</h4>
<p>Which kinda breaks for modules that aren't in platforms</p>



<a name="569596552"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/463736-bugs/topic/roc%20build%20not%20compiling%20app%20sibling%20modules/near/569596552" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/463736-bugs/topic/roc.20build.20not.20compiling.20app.20sibling.20modules.html#569596552">(Jan 22 2026 at 22:02)</a>:</h4>
<p>I've reproduced this... should be able to fix it soon</p>



<a name="569603792"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/463736-bugs/topic/roc%20build%20not%20compiling%20app%20sibling%20modules/near/569603792" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/463736-bugs/topic/roc.20build.20not.20compiling.20app.20sibling.20modules.html#569603792">(Jan 22 2026 at 22:58)</a>:</h4>
<p>ok <em>fixed</em> it... but going to take a side quest to refactor things and hopefully eliminate this kind of bug from happening again</p>



<a name="569604330"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/463736-bugs/topic/roc%20build%20not%20compiling%20app%20sibling%20modules/near/569604330" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nandi <a href="https://roc-lang.github.io/zulip-export/stream/463736-bugs/topic/roc.20build.20not.20compiling.20app.20sibling.20modules.html#569604330">(Jan 22 2026 at 23:02)</a>:</h4>
<p>what do you mean "this kind of bug"?</p>



<a name="569605334"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/463736-bugs/topic/roc%20build%20not%20compiling%20app%20sibling%20modules/near/569605334" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/463736-bugs/topic/roc.20build.20not.20compiling.20app.20sibling.20modules.html#569605334">(Jan 22 2026 at 23:11)</a>:</h4>
<p>Where there are different code paths <code>roc check</code> <code>roc test</code> <code>roc build</code> etc doing the same thing in different ways</p>



<a name="569605421"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/463736-bugs/topic/roc%20build%20not%20compiling%20app%20sibling%20modules/near/569605421" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/463736-bugs/topic/roc.20build.20not.20compiling.20app.20sibling.20modules.html#569605421">(Jan 22 2026 at 23:12)</a>:</h4>
<p>Just  refactor the common parts into helpers and keep things DRY</p>



<a name="569607519"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/463736-bugs/topic/roc%20build%20not%20compiling%20app%20sibling%20modules/near/569607519" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rick Hull <a href="https://roc-lang.github.io/zulip-export/stream/463736-bugs/topic/roc.20build.20not.20compiling.20app.20sibling.20modules.html#569607519">(Jan 22 2026 at 23:32)</a>:</h4>
<p>I had noticed some different behavior with <code>roc build</code> that was unexpected but assumed I was Doing It Wrong.  i think i hit this, though</p>



<a name="569612189"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/463736-bugs/topic/roc%20build%20not%20compiling%20app%20sibling%20modules/near/569612189" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/463736-bugs/topic/roc.20build.20not.20compiling.20app.20sibling.20modules.html#569612189">(Jan 23 2026 at 00:10)</a>:</h4>
<p><a href="https://github.com/roc-lang/roc/pull/9072">https://github.com/roc-lang/roc/pull/9072</a></p>



<hr><p>Last updated: Mar 01 2026 at 12:20 UTC</p>
</html>