<html>
<head><meta charset="utf-8"><title>Panic in new compiler · bugs · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://roc-lang.github.io/zulip-export/stream/463736-bugs/index.html">bugs</a></h2>
<h3>Topic: <a href="https://roc-lang.github.io/zulip-export/stream/463736-bugs/topic/Panic.20in.20new.20compiler.html">Panic in new compiler</a></h3>

<hr>

<base href="https://roc.zulipchat.com">

<head><link href="https://roc-lang.github.io/zulip-export/style.css" rel="stylesheet"></head>

<a name="562743962"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/463736-bugs/topic/Panic%20in%20new%20compiler/near/562743962" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jamie <a href="https://roc-lang.github.io/zulip-export/stream/463736-bugs/topic/Panic.20in.20new.20compiler.html#562743962">(Dec 09 2025 at 17:03)</a>:</h4>
<p>I have a roc file called <a href="/user_uploads/22008/-RB3UxUUgSQvl8FOYArG4rkc/PastedText.txt">main.roc</a>, and when I try to run it with <code>roc run ./main.roc</code> (compiled from <a href="https://github.com/roc-lang/roc/commit/ea76b7b1ee2c2725e08c9763b143b42285e5cffd">this commit</a>), I get the error:</p>
<div class="codehilite"><pre><span></span><code>thread 27610 panic: index out of bounds: index 2863311530, len 1611
/home/jg/roc/src/types/instantiate.zig:341:60: 0x54b53c7 in instantiateTagUnion (mod.zig)
                const arg_var = self.store.vars.items.items[args_start + i];
                                                           ^
/home/jg/roc/src/types/instantiate.zig:227:90: 0x53cea36 in instantiateFlatType (mod.zig)
            .tag_union =&gt; |tag_union| FlatType{ .tag_union = try self.instantiateTagUnion(tag_union) },
                                                                                         ^
/home/jg/roc/src/types/instantiate.zig:183:69: 0x52839d8 in instantiateContent (mod.zig)
                const fresh_flat_type = try self.instantiateFlatType(flat_type);
                                                                    ^
/home/jg/roc/src/types/instantiate.zig:152:66: 0x509881f in instantiateVar (mod.zig)
                const fresh_content = try self.instantiateContent(resolved.desc.content);
                                                                 ^
/home/jg/roc/src/types/instantiate.zig:357:43: 0x54b5f0d in instantiateTagUnion (mod.zig)
            .ext = try self.instantiateVar(tag_union.ext),
                                          ^
/home/jg/roc/src/types/instantiate.zig:227:90: 0x53cea36 in instantiateFlatType (mod.zig)
            .tag_union =&gt; |tag_union| FlatType{ .tag_union = try self.instantiateTagUnion(tag_union) },
                                                                                         ^
/home/jg/roc/src/types/instantiate.zig:183:69: 0x52839d8 in instantiateContent (mod.zig)
                const fresh_flat_type = try self.instantiateFlatType(flat_type);
                                                                    ^
/home/jg/roc/src/types/instantiate.zig:152:66: 0x509881f in instantiateVar (mod.zig)
                const fresh_content = try self.instantiateContent(resolved.desc.content);
                                                                 ^
/home/jg/roc/src/types/instantiate.zig:212:58: 0x53cda4a in instantiateAlias (mod.zig)
        const fresh_backing_var = try self.instantiateVar(backing_var);
                                                         ^
/home/jg/roc/src/types/instantiate.zig:179:49: 0x52838a8 in instantiateContent (mod.zig)
                return try self.instantiateAlias(alias);
                                                ^
/home/jg/roc/src/types/instantiate.zig:152:66: 0x509881f in instantiateVar (mod.zig)
                const fresh_content = try self.instantiateContent(resolved.desc.content);
                                                                 ^
/home/jg/roc/src/types/instantiate.zig:342:58: 0x54b5419 in instantiateTagUnion (mod.zig)
                const fresh_arg = try self.instantiateVar(arg_var);
                                                         ^
/home/jg/roc/src/types/instantiate.zig:227:90: 0x53cea36 in instantiateFlatType (mod.zig)
            .tag_union =&gt; |tag_union| FlatType{ .tag_union = try self.instantiateTagUnion(tag_union) },
                                                                                         ^
/home/jg/roc/src/types/instantiate.zig:183:69: 0x52839d8 in instantiateContent (mod.zig)
                const fresh_flat_type = try self.instantiateFlatType(flat_type);
                                                                    ^
/home/jg/roc/src/types/instantiate.zig:152:66: 0x509881f in instantiateVar (mod.zig)
                const fresh_content = try self.instantiateContent(resolved.desc.content);
                                                                 ^
/home/jg/roc/src/types/instantiate.zig:234:58: 0x54b20ad in instantiateNominalType (mod.zig)
        const fresh_backing_var = try self.instantiateVar(backing_var);
                                                         ^
/home/jg/roc/src/types/instantiate.zig:220:97: 0x53ce0cf in instantiateFlatType (mod.zig)
            .nominal_type =&gt; |nominal| FlatType{ .nominal_type = try self.instantiateNominalType(nominal) },
                                                                                                ^
/home/jg/roc/src/types/instantiate.zig:183:69: 0x52839d8 in instantiateContent (mod.zig)
                const fresh_flat_type = try self.instantiateFlatType(flat_type);
                                                                    ^
/home/jg/roc/src/types/instantiate.zig:152:66: 0x509881f in instantiateVar (mod.zig)
                const fresh_content = try self.instantiateContent(resolved.desc.content);
                                                                 ^
/home/jg/roc/src/check/Check.zig:545:61: 0x4da5790 in instantiateVarHelp (mod.zig)
    const instantiated_var = try instantiator.instantiateVar(var_to_instantiate);
                                                            ^
/home/jg/roc/src/check/Check.zig:490:35: 0x4b71fb8 in instantiateVar (mod.zig)
    return self.instantiateVarHelp(var_to_instantiate, &amp;instantiate_ctx, env, region_behavior);
                                  ^
/home/jg/roc/src/check/Check.zig:3093:61: 0x4b245fb in checkExpr (mod.zig)
                const instantiated = try self.instantiateVar(pat_var, env, .use_last_var);
                                                            ^
/home/jg/roc/src/check/Check.zig:2829:45: 0x4b2103e in checkExpr (mod.zig)
                does_fx = try self.checkExpr(single_elem_expr_idx, env, .no_expectation) or does_fx;
                                            ^
/home/jg/roc/src/check/Check.zig:3351:53: 0x4b27fdd in checkExpr (mod.zig)
                        does_fx = try self.checkExpr(call_arg_idx, env, .no_expectation) or does_fx;
                                                    ^
/home/jg/roc/src/check/Check.zig:4262:37: 0x4d86564 in checkMatchExpr (mod.zig)
    var does_fx = try self.checkExpr(match.cond, env, .no_expectation);
                                    ^
/home/jg/roc/src/check/Check.zig:3547:46: 0x4b2a6b0 in checkExpr (mod.zig)
            does_fx = try self.checkMatchExpr(expr_idx, env, match) or does_fx;
                                             ^
/home/jg/roc/src/check/Check.zig:3843:49: 0x4d7ea0b in checkBlockStatements (mod.zig)
                    does_fx = try self.checkExpr(decl_stmt.expr, env, expectation) or does_fx;
                                                ^
/home/jg/roc/src/check/Check.zig:3137:62: 0x4b24f98 in checkExpr (mod.zig)
            const stmt_result = try self.checkBlockStatements(statements, env, expr_region);
                                                             ^
/home/jg/roc/src/check/Check.zig:4317:37: 0x4d87227 in checkMatchExpr (mod.zig)
        does_fx = try self.checkExpr(branch.value, env, .no_expectation) or does_fx;
                                    ^
/home/jg/roc/src/check/Check.zig:3547:46: 0x4b2a6b0 in checkExpr (mod.zig)
            does_fx = try self.checkMatchExpr(expr_idx, env, match) or does_fx;
                                             ^
/home/jg/roc/src/check/Check.zig:3141:41: 0x4b250e7 in checkExpr (mod.zig)
            does_fx = try self.checkExpr(block.final_expr, env, expected) or does_fx;
                                        ^
/home/jg/roc/src/check/Check.zig:3299:49: 0x4b272d2 in checkExpr (mod.zig)
                    does_fx = try self.checkExpr(lambda.body, env, .no_expectation) or does_fx;
                                                ^
/home/jg/roc/src/check/Check.zig:3331:41: 0x4b27b9e in checkExpr (mod.zig)
            does_fx = try self.checkExpr(closure.lambda_idx, env, expected) or does_fx;
                                        ^
/home/jg/roc/src/check/Check.zig:1247:35: 0x4b19f77 in checkDef (mod.zig)
            _ = try self.checkExpr(def.expr, env, .no_expectation);
                                  ^
/home/jg/roc/src/check/Check.zig:1026:26: 0x48ddc51 in checkFile (mod.zig)
        try self.checkDef(def_idx, &amp;env);
                         ^
/home/jg/roc/src/cli/main.zig:1862:30: 0x458872d in setupSharedMemoryWithModuleEnv (main.zig)
    try app_checker.checkFile();
                             ^
/home/jg/roc/src/cli/main.zig:1109:54: 0x4595f9f in rocRun (main.zig)
    const shm_result = setupSharedMemoryWithModuleEnv(allocs, args.path, args.allow_errors) catch |err| {
                                                     ^
/home/jg/roc/src/cli/main.zig:680:23: 0x4836a05 in mainArgs (main.zig)
            try rocRun(allocs, run_args);
                      ^
/home/jg/roc/src/cli/main.zig:619:13: 0x4838fb8 in main (main.zig)
    mainArgs(&amp;allocs, args) catch {
            ^
/home/jg/binary-repository/downloadedSources/zig/lib/std/start.zig:627:37: 0x4839571 in main (std.zig)
            const result = root.main() catch |err| {
                                    ^
/home/jg/binary-repository/downloadedSources/zig/lib/libc/musl/src/env/__libc_start_main.c:95:7: 0x9437d9d in libc_start_main_stage2 (/home/jg/binary-repository/downloadedSources/zig/lib/libc/musl/src/env/__libc_start_main.c)
 exit(main(argc, argv, envp));
      ^
???:?:?: 0x9433349 in ??? (???)
Unwind error at address `exe:0x9433349` (error.MissingFDE), trace may be incomplete

Aborted                    (core dumped) ~/roc/zig-out/bin/roc run ./main2.roc
</code></pre></div>



<a name="562744690"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/463736-bugs/topic/Panic%20in%20new%20compiler/near/562744690" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Matthieu Pizenberg <a href="https://roc-lang.github.io/zulip-export/stream/463736-bugs/topic/Panic.20in.20new.20compiler.html#562744690">(Dec 09 2025 at 17:06)</a>:</h4>
<p>I don’t think there is a <code>run</code> subcommand. It would be <code>roc main.roc</code> directly.</p>



<a name="562745022"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/463736-bugs/topic/Panic%20in%20new%20compiler/near/562745022" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jamie <a href="https://roc-lang.github.io/zulip-export/stream/463736-bugs/topic/Panic.20in.20new.20compiler.html#562745022">(Dec 09 2025 at 17:07)</a>:</h4>
<p><code>roc run</code> seems to work the same as just <code>roc</code></p>



<a name="562745545"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/463736-bugs/topic/Panic%20in%20new%20compiler/near/562745545" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Matthieu Pizenberg <a href="https://roc-lang.github.io/zulip-export/stream/463736-bugs/topic/Panic.20in.20new.20compiler.html#562745545">(Dec 09 2025 at 17:09)</a>:</h4>
<p>I see you are calling <code>File.read_utf8</code> but I don’t think the temporary platform made for AoC by <span class="user-mention" data-user-id="515757">@Luke Boswell</span> has file IO yet.</p>



<a name="562749250"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/463736-bugs/topic/Panic%20in%20new%20compiler/near/562749250" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/463736-bugs/topic/Panic.20in.20new.20compiler.html#562749250">(Dec 09 2025 at 17:22)</a>:</h4>
<p>Yeah, no File support yet</p>



<a name="562751652"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/463736-bugs/topic/Panic%20in%20new%20compiler/near/562751652" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jamie <a href="https://roc-lang.github.io/zulip-export/stream/463736-bugs/topic/Panic.20in.20new.20compiler.html#562751652">(Dec 09 2025 at 17:31)</a>:</h4>
<p>Yeah, my program is really bad right now, and it probably has lots of bugs in it. One of the issues is using unimplemented things like file reading/writing, <code>Inspect.to_str</code>, and <code>Num.to_str</code>. But the new compiler should still be able to always either run a program or give a list of errors that the program has.</p>



<a name="562751930"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/463736-bugs/topic/Panic%20in%20new%20compiler/near/562751930" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jamie <a href="https://roc-lang.github.io/zulip-export/stream/463736-bugs/topic/Panic.20in.20new.20compiler.html#562751930">(Dec 09 2025 at 17:32)</a>:</h4>
<p>And this bug stops that from working</p>



<a name="562757411"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/463736-bugs/topic/Panic%20in%20new%20compiler/near/562757411" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/463736-bugs/topic/Panic.20in.20new.20compiler.html#562757411">(Dec 09 2025 at 17:54)</a>:</h4>
<p>Agreed :)<br>
Can you make a github issue?</p>



<a name="562767111"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/463736-bugs/topic/Panic%20in%20new%20compiler/near/562767111" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jamie <a href="https://roc-lang.github.io/zulip-export/stream/463736-bugs/topic/Panic.20in.20new.20compiler.html#562767111">(Dec 09 2025 at 18:34)</a>:</h4>
<p>Here is the issue I've created <a href="https://github.com/roc-lang/roc/issues/8599">https://github.com/roc-lang/roc/issues/8599</a></p>



<hr><p>Last updated: Mar 01 2026 at 12:20 UTC</p>
</html>