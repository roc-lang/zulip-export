<html>
<head><meta charset="utf-8"><title>✔ Can&#x27;t rename a polymorphic function? · bugs · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://roc-lang.github.io/zulip-export/stream/463736-bugs/index.html">bugs</a></h2>
<h3>Topic: <a href="https://roc-lang.github.io/zulip-export/stream/463736-bugs/topic/.E2.9C.94.20Can.27t.20rename.20a.20polymorphic.20function.3F.html">✔ Can&#x27;t rename a polymorphic function?</a></h3>

<hr>

<base href="https://roc.zulipchat.com">

<head><link href="https://roc-lang.github.io/zulip-export/style.css" rel="stylesheet"></head>

<a name="494850557"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/463736-bugs/topic/%E2%9C%94%20Can%27t%20rename%20a%20polymorphic%20function%3F/near/494850557" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jan kili <a href="https://roc-lang.github.io/zulip-export/stream/463736-bugs/topic/.E2.9C.94.20Can.27t.20rename.20a.20polymorphic.20function.3F.html#494850557">(Jan 20 2025 at 16:19)</a>:</h4>
<p>I expect this to work, but it seems to be bugged. Is this actually intended behavior?</p>
<div class="codehilite" data-code-language="Perl"><pre><span></span><code><span class="n">app</span><span class="w"> </span><span class="p">[</span><span class="n">main</span><span class="o">!</span><span class="p">]</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">basic_cli:</span><span class="w"> </span><span class="n">platform</span><span class="w"> </span><span class="s">"./platform/main.roc"</span><span class="w"> </span><span class="p">}</span>

<span class="nb">import</span><span class="w"> </span><span class="n">basic_cli</span><span class="o">.</span><span class="n">Stdout</span>

<span class="n">main</span><span class="o">!</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">\</span><span class="nn">_</span><span class="w"> </span><span class="o">-&gt;</span>
<span class="w">    </span><span class="n">foo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mappy</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="n">Num</span><span class="o">.</span><span class="n">toStr</span>
<span class="w">    </span><span class="n">bar</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mappy</span><span class="w"> </span><span class="p">[</span><span class="s">" a"</span><span class="p">,</span><span class="w"> </span><span class="s">"b "</span><span class="p">]</span><span class="w"> </span><span class="n">Str</span><span class="o">.</span><span class="n">trim</span>
<span class="w">    </span><span class="n">foo</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="n">Str</span><span class="o">.</span><span class="n">joinWith</span><span class="w"> </span><span class="s">"&amp;"</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="n">try</span><span class="w"> </span><span class="n">Stdout</span><span class="o">.</span><span class="n">line</span><span class="o">!</span>
<span class="w">    </span><span class="n">bar</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="n">Str</span><span class="o">.</span><span class="n">joinWith</span><span class="w"> </span><span class="s">"&amp;"</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="n">try</span><span class="w"> </span><span class="n">Stdout</span><span class="o">.</span><span class="n">line</span><span class="o">!</span>
<span class="w">    </span><span class="n">Stdout</span><span class="o">.</span><span class="n">line</span><span class="o">!</span><span class="w"> </span><span class="s">"success"</span>

<span class="n">mappy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">rename</span><span class="w"> </span><span class="n">List</span><span class="o">.</span><span class="nb">map</span>
<span class="nb">rename</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">\</span><span class="nn">anything</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">anything</span>
</code></pre></div>
<div class="codehilite"><pre><span></span><code>...
But mappy needs its 1st argument to be:

    List (Num *)
...
But mappy needs its 2nd argument to be:

    Num * -&gt; Str
...
</code></pre></div>
<p><a href="/user_uploads/22008/1OXS-pZCIK8bIgJC2zksJdhU/Screenshot_20250120_092613.png">Screenshot_20250120_092613.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/22008/1OXS-pZCIK8bIgJC2zksJdhU/Screenshot_20250120_092613.png" title="Screenshot_20250120_092613.png"><img data-original-content-type="image/png" data-original-dimensions="1920x1200" src="/user_uploads/thumbnail/22008/1OXS-pZCIK8bIgJC2zksJdhU/Screenshot_20250120_092613.png/840x560.webp"></a></div><p>Edit: No-op refactor to simplify.</p>



<a name="494852253"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/463736-bugs/topic/%E2%9C%94%20Can%27t%20rename%20a%20polymorphic%20function%3F/near/494852253" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jan kili <a href="https://roc-lang.github.io/zulip-export/stream/463736-bugs/topic/.E2.9C.94.20Can.27t.20rename.20a.20polymorphic.20function.3F.html#494852253">(Jan 20 2025 at 16:29)</a>:</h4>
<p>Specifying <code>rename : anything -&gt; anything</code> doesn't fix it.</p>



<a name="494852486"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/463736-bugs/topic/%E2%9C%94%20Can%27t%20rename%20a%20polymorphic%20function%3F/near/494852486" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jan kili <a href="https://roc-lang.github.io/zulip-export/stream/463736-bugs/topic/.E2.9C.94.20Can.27t.20rename.20a.20polymorphic.20function.3F.html#494852486">(Jan 20 2025 at 16:30)</a>:</h4>
<p>Specifying <code>mappy : List a, (a -&gt; b) -&gt; List b</code> yields</p>
<div class="codehilite"><pre><span></span><code>TYPE MISMATCH

This 2nd argument to `mappy` has an unexpected type:

6│      foo = mappy [1, 2, 3, 4] Num.toStr
                                 ^^^^^^^^^

This `toStr` value is a:

    Num * -&gt; Str

But `mappy` needs its 2nd argument to be:

    a -&gt; b

Tip: The type annotation uses the type variable `b` to say
that this definition can produce any type of value. But in
the body I see that it will only produce a `Str` value of a
single specific type. Maybe change the type annotation to be
more specific? Maybe change the code to be more general?
</code></pre></div>



<a name="494853460"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/463736-bugs/topic/%E2%9C%94%20Can%27t%20rename%20a%20polymorphic%20function%3F/near/494853460" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jan kili <a href="https://roc-lang.github.io/zulip-export/stream/463736-bugs/topic/.E2.9C.94.20Can.27t.20rename.20a.20polymorphic.20function.3F.html#494853460">(Jan 20 2025 at 16:34)</a>:</h4>
<p><code>I see that it will only produce a `Str` value</code> <span aria-label="point left" class="emoji emoji-1f448" role="img" title="point left">:point_left:</span> that definitely seems like a bug</p>



<a name="494854434"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/463736-bugs/topic/%E2%9C%94%20Can%27t%20rename%20a%20polymorphic%20function%3F/near/494854434" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jan kili <a href="https://roc-lang.github.io/zulip-export/stream/463736-bugs/topic/.E2.9C.94.20Can.27t.20rename.20a.20polymorphic.20function.3F.html#494854434">(Jan 20 2025 at 16:39)</a>:</h4>
<p>If I "run the program anyway with <code>roc run</code>" it does crash with</p>
<div class="codehilite"><pre><span></span><code>Running program anyway…

────────────────────────────────────────────────────────────────────────────────
Roc crashed with:

        Erroneous: specialize_symbol

Here is the call stack that led to the crash:

        .libc

Optimizations can make this list inaccurate! If it looks wrong, try running without `--optimize` and with `--linker=legacy`
</code></pre></div>
<p>while it doesn't crash if I first comment out either the <code>foo</code> lines or the <code>bar</code> lines.</p>



<a name="494854972"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/463736-bugs/topic/%E2%9C%94%20Can%27t%20rename%20a%20polymorphic%20function%3F/near/494854972" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/463736-bugs/topic/.E2.9C.94.20Can.27t.20rename.20a.20polymorphic.20function.3F.html#494854972">(Jan 20 2025 at 16:42)</a>:</h4>
<p><span class="user-mention" data-user-id="454654">@Ayaz Hafiz</span> probably knows what's going on</p>



<a name="494857306"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/463736-bugs/topic/%E2%9C%94%20Can%27t%20rename%20a%20polymorphic%20function%3F/near/494857306" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Notification Bot <a href="https://roc-lang.github.io/zulip-export/stream/463736-bugs/topic/.E2.9C.94.20Can.27t.20rename.20a.20polymorphic.20function.3F.html#494857306">(Jan 20 2025 at 16:51)</a>:</h4>
<p>This topic was moved here from <a class="stream-topic" data-stream-id="231634" href="/#narrow/channel/231634-beginners/topic/Can.27t.20rename.20a.20polymorphic.20function.3F">#beginners &gt; Can't rename a polymorphic function?</a> by <span class="user-mention silent" data-user-id="462053">JanCVanB</span>.</p>



<a name="494857569"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/463736-bugs/topic/%E2%9C%94%20Can%27t%20rename%20a%20polymorphic%20function%3F/near/494857569" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jan kili <a href="https://roc-lang.github.io/zulip-export/stream/463736-bugs/topic/.E2.9C.94.20Can.27t.20rename.20a.20polymorphic.20function.3F.html#494857569">(Jan 20 2025 at 16:53)</a>:</h4>
<p>(upgraded to bug, for at least the <code>I see that it will only produce a `Str` value</code> problem)</p>



<a name="494858125"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/463736-bugs/topic/%E2%9C%94%20Can%27t%20rename%20a%20polymorphic%20function%3F/near/494858125" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jan kili <a href="https://roc-lang.github.io/zulip-export/stream/463736-bugs/topic/.E2.9C.94.20Can.27t.20rename.20a.20polymorphic.20function.3F.html#494858125">(Jan 20 2025 at 16:56)</a>:</h4>
<p>Not urgent, but looking forward to what <span class="user-mention" data-user-id="454654">@Ayaz Hafiz</span> (or another polymorphism specialist) thinks should be intended behavior here!</p>



<a name="494880853"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/463736-bugs/topic/%E2%9C%94%20Can%27t%20rename%20a%20polymorphic%20function%3F/near/494880853" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/463736-bugs/topic/.E2.9C.94.20Can.27t.20rename.20a.20polymorphic.20function.3F.html#494880853">(Jan 20 2025 at 17:50)</a>:</h4>
<p>I'm pretty sure it should just work. It also should just work without the rename function just <code>mappy = List.msp</code></p>



<a name="494891828"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/463736-bugs/topic/%E2%9C%94%20Can%27t%20rename%20a%20polymorphic%20function%3F/near/494891828" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jan kili <a href="https://roc-lang.github.io/zulip-export/stream/463736-bugs/topic/.E2.9C.94.20Can.27t.20rename.20a.20polymorphic.20function.3F.html#494891828">(Jan 20 2025 at 18:42)</a>:</h4>
<p>Glad to hear! Yeah <code>mappy = List.map</code> doesn't work either, which seems like a better starting point for debugging. (I do want the two-step version too.)</p>



<a name="494896828"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/463736-bugs/topic/%E2%9C%94%20Can%27t%20rename%20a%20polymorphic%20function%3F/near/494896828" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ayaz Hafiz <a href="https://roc-lang.github.io/zulip-export/stream/463736-bugs/topic/.E2.9C.94.20Can.27t.20rename.20a.20polymorphic.20function.3F.html#494896828">(Jan 20 2025 at 19:16)</a>:</h4>
<p>yes, this is intended behavior</p>



<a name="494896877"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/463736-bugs/topic/%E2%9C%94%20Can%27t%20rename%20a%20polymorphic%20function%3F/near/494896877" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ayaz Hafiz <a href="https://roc-lang.github.io/zulip-export/stream/463736-bugs/topic/.E2.9C.94.20Can.27t.20rename.20a.20polymorphic.20function.3F.html#494896877">(Jan 20 2025 at 19:17)</a>:</h4>
<p><code>mappy : List a, (a -&gt; b) -&gt; List b</code> should yield an error, i just landed a PR to generate that error</p>



<a name="494896923"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/463736-bugs/topic/%E2%9C%94%20Can%27t%20rename%20a%20polymorphic%20function%3F/near/494896923" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ayaz Hafiz <a href="https://roc-lang.github.io/zulip-export/stream/463736-bugs/topic/.E2.9C.94.20Can.27t.20rename.20a.20polymorphic.20function.3F.html#494896923">(Jan 20 2025 at 19:17)</a>:</h4>
<p>you need to wrap <code>mappy</code> in an explicit lambda for it to be polymorphic</p>



<a name="494896966"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/463736-bugs/topic/%E2%9C%94%20Can%27t%20rename%20a%20polymorphic%20function%3F/near/494896966" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ayaz Hafiz <a href="https://roc-lang.github.io/zulip-export/stream/463736-bugs/topic/.E2.9C.94.20Can.27t.20rename.20a.20polymorphic.20function.3F.html#494896966">(Jan 20 2025 at 19:17)</a>:</h4>
<p>eg <code>mappy = \l, f -&gt; List.map l f</code></p>



<a name="494897062"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/463736-bugs/topic/%E2%9C%94%20Can%27t%20rename%20a%20polymorphic%20function%3F/near/494897062" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/463736-bugs/topic/.E2.9C.94.20Can.27t.20rename.20a.20polymorphic.20function.3F.html#494897062">(Jan 20 2025 at 19:18)</a>:</h4>
<p>This is due to let generalization? Didn't realize that affected lambdas</p>



<a name="494897075"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/463736-bugs/topic/%E2%9C%94%20Can%27t%20rename%20a%20polymorphic%20function%3F/near/494897075" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ayaz Hafiz <a href="https://roc-lang.github.io/zulip-export/stream/463736-bugs/topic/.E2.9C.94.20Can.27t.20rename.20a.20polymorphic.20function.3F.html#494897075">(Jan 20 2025 at 19:18)</a>:</h4>
<p>yes</p>



<a name="494897189"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/463736-bugs/topic/%E2%9C%94%20Can%27t%20rename%20a%20polymorphic%20function%3F/near/494897189" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ayaz Hafiz <a href="https://roc-lang.github.io/zulip-export/stream/463736-bugs/topic/.E2.9C.94.20Can.27t.20rename.20a.20polymorphic.20function.3F.html#494897189">(Jan 20 2025 at 19:19)</a>:</h4>
<p>everything that's not explicitly a function (syntactically) is not polymorphic. Everything that is not explicitly a function gets at most one type, and that type is determined by the first usage</p>



<a name="494897684"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/463736-bugs/topic/%E2%9C%94%20Can%27t%20rename%20a%20polymorphic%20function%3F/near/494897684" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/463736-bugs/topic/.E2.9C.94.20Can.27t.20rename.20a.20polymorphic.20function.3F.html#494897684">(Jan 20 2025 at 19:22)</a>:</h4>
<p>wasn't this one of the situations where we could relax that if desired?</p>



<a name="494898517"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/463736-bugs/topic/%E2%9C%94%20Can%27t%20rename%20a%20polymorphic%20function%3F/near/494898517" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/463736-bugs/topic/.E2.9C.94.20Can.27t.20rename.20a.20polymorphic.20function.3F.html#494898517">(Jan 20 2025 at 19:28)</a>:</h4>
<p><span class="user-mention silent" data-user-id="454654">Ayaz Hafiz</span> <a href="#narrow/stream/463736-bugs/topic/Can't.20rename.20a.20polymorphic.20function.3F/near/494897189">said</a>:</p>
<blockquote>
<p>everything that's not explicitly a function (syntactically) is not polymorphic. Everything that is not explicitly a function gets at most one type, and that type is determined by the first usage</p>
</blockquote>
<p>Ah, didn't realize it had to be syntactically.</p>



<a name="494898971"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/463736-bugs/topic/%E2%9C%94%20Can%27t%20rename%20a%20polymorphic%20function%3F/near/494898971" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ayaz Hafiz <a href="https://roc-lang.github.io/zulip-export/stream/463736-bugs/topic/.E2.9C.94.20Can.27t.20rename.20a.20polymorphic.20function.3F.html#494898971">(Jan 20 2025 at 19:32)</a>:</h4>
<p>it can be relaxed if you perform eta-expansion</p>



<a name="494899096"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/463736-bugs/topic/%E2%9C%94%20Can%27t%20rename%20a%20polymorphic%20function%3F/near/494899096" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ayaz Hafiz <a href="https://roc-lang.github.io/zulip-export/stream/463736-bugs/topic/.E2.9C.94.20Can.27t.20rename.20a.20polymorphic.20function.3F.html#494899096">(Jan 20 2025 at 19:32)</a>:</h4>
<p>i.e. write any value <code>v</code> of type <code>a -&gt; b</code> to <code>\a -&gt; (v) a</code></p>



<a name="494899106"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/463736-bugs/topic/%E2%9C%94%20Can%27t%20rename%20a%20polymorphic%20function%3F/near/494899106" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jan kili <a href="https://roc-lang.github.io/zulip-export/stream/463736-bugs/topic/.E2.9C.94.20Can.27t.20rename.20a.20polymorphic.20function.3F.html#494899106">(Jan 20 2025 at 19:32)</a>:</h4>
<p>Does that mean that <code>rename = \anything -&gt; anything</code> is impossible?</p>



<a name="494899410"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/463736-bugs/topic/%E2%9C%94%20Can%27t%20rename%20a%20polymorphic%20function%3F/near/494899410" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ayaz Hafiz <a href="https://roc-lang.github.io/zulip-export/stream/463736-bugs/topic/.E2.9C.94.20Can.27t.20rename.20a.20polymorphic.20function.3F.html#494899410">(Jan 20 2025 at 19:35)</a>:</h4>
<p>yeah <code>rename List.map</code> doesn't work on its own if you want it to be polymorphic it needs to be <code>\l, f -&gt; (rename List.map) l f</code></p>



<a name="494899642"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/463736-bugs/topic/%E2%9C%94%20Can%27t%20rename%20a%20polymorphic%20function%3F/near/494899642" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jan kili <a href="https://roc-lang.github.io/zulip-export/stream/463736-bugs/topic/.E2.9C.94.20Can.27t.20rename.20a.20polymorphic.20function.3F.html#494899642">(Jan 20 2025 at 19:37)</a>:</h4>
<p><span aria-label="sad" class="emoji emoji-2639" role="img" title="sad">:sad:</span></p>



<a name="494899775"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/463736-bugs/topic/%E2%9C%94%20Can%27t%20rename%20a%20polymorphic%20function%3F/near/494899775" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jan kili <a href="https://roc-lang.github.io/zulip-export/stream/463736-bugs/topic/.E2.9C.94.20Can.27t.20rename.20a.20polymorphic.20function.3F.html#494899775">(Jan 20 2025 at 19:38)</a>:</h4>
<p>Is this due to Roc's design or the compiler's implementation?</p>



<a name="494899948"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/463736-bugs/topic/%E2%9C%94%20Can%27t%20rename%20a%20polymorphic%20function%3F/near/494899948" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/463736-bugs/topic/.E2.9C.94.20Can.27t.20rename.20a.20polymorphic.20function.3F.html#494899948">(Jan 20 2025 at 19:39)</a>:</h4>
<p><span class="user-mention silent" data-user-id="454654">Ayaz Hafiz</span> <a href="#narrow/channel/463736-bugs/topic/Can't.20rename.20a.20polymorphic.20function.3F/near/494898971">said</a>:</p>
<blockquote>
<p>it can be relaxed if you perform eta-expansion<br>
i.e. write any value <code>v</code> of type <code>a -&gt; b</code> to <code>\a -&gt; (v) a</code></p>
</blockquote>
<p>I think we should do this</p>



<a name="494900049"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/463736-bugs/topic/%E2%9C%94%20Can%27t%20rename%20a%20polymorphic%20function%3F/near/494900049" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/463736-bugs/topic/.E2.9C.94.20Can.27t.20rename.20a.20polymorphic.20function.3F.html#494900049">(Jan 20 2025 at 19:40)</a>:</h4>
<p>it's surprising that it doesn't work, and then the workaround is to do eta-expansion manually, so seems like a good thing for the compiler to do for you automatically</p>



<a name="494900608"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/463736-bugs/topic/%E2%9C%94%20Can%27t%20rename%20a%20polymorphic%20function%3F/near/494900608" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/463736-bugs/topic/.E2.9C.94.20Can.27t.20rename.20a.20polymorphic.20function.3F.html#494900608">(Jan 20 2025 at 19:44)</a>:</h4>
<p>to clarify: this is just when naming it in defs, right?</p>



<a name="494900699"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/463736-bugs/topic/%E2%9C%94%20Can%27t%20rename%20a%20polymorphic%20function%3F/near/494900699" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/463736-bugs/topic/.E2.9C.94.20Can.27t.20rename.20a.20polymorphic.20function.3F.html#494900699">(Jan 20 2025 at 19:44)</a>:</h4>
<p>like when a function is being passed in as an argument, that's not necessary</p>



<a name="495152272"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/463736-bugs/topic/%E2%9C%94%20Can%27t%20rename%20a%20polymorphic%20function%3F/near/495152272" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jan kili <a href="https://roc-lang.github.io/zulip-export/stream/463736-bugs/topic/.E2.9C.94.20Can.27t.20rename.20a.20polymorphic.20function.3F.html#495152272">(Jan 21 2025 at 22:01)</a>:</h4>
<p>It sounds like this wasn't/isn't a bug. Shall I move the last few messages to a new #ideas topic?</p>



<a name="495361719"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/463736-bugs/topic/%E2%9C%94%20Can%27t%20rename%20a%20polymorphic%20function%3F/near/495361719" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jan kili <a href="https://roc-lang.github.io/zulip-export/stream/463736-bugs/topic/.E2.9C.94.20Can.27t.20rename.20a.20polymorphic.20function.3F.html#495361719">(Jan 22 2025 at 19:46)</a>:</h4>
<p>Friendly ping :) I'm iterating on a script with the equivalent of mappy1 &amp; mappy2 to work around this, but it's a low priority for me.</p>



<a name="495362414"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/463736-bugs/topic/%E2%9C%94%20Can%27t%20rename%20a%20polymorphic%20function%3F/near/495362414" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jan kili <a href="https://roc-lang.github.io/zulip-export/stream/463736-bugs/topic/.E2.9C.94.20Can.27t.20rename.20a.20polymorphic.20function.3F.html#495362414">(Jan 22 2025 at 19:51)</a>:</h4>
<p><span class="user-mention silent" data-user-id="281383">Richard Feldman</span> <a href="#narrow/channel/463736-bugs/topic/Can't.20rename.20a.20polymorphic.20function.3F/near/494900608">said</a>:</p>
<blockquote>
<p>to clarify: this is just when naming it in defs, right?<br>
like when a function is being passed in as an argument, that's not necessary</p>
</blockquote>
<p>In case this answers your question, this gets the same type checking errors with Monday's nightly release:</p>
<div class="codehilite" data-code-language="Perl"><pre><span></span><code><span class="n">app</span><span class="w"> </span><span class="p">[</span><span class="n">main</span><span class="o">!</span><span class="p">]</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">basic_cli:</span><span class="w"> </span><span class="n">platform</span><span class="w"> </span><span class="s">"./platform/main.roc"</span><span class="w"> </span><span class="p">}</span>

<span class="nb">import</span><span class="w"> </span><span class="n">basic_cli</span><span class="o">.</span><span class="n">Stdout</span>

<span class="n">main</span><span class="o">!</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">\</span><span class="nn">_</span><span class="w"> </span><span class="o">-&gt;</span>
<span class="w">    </span><span class="n">List</span><span class="o">.</span><span class="nb">map</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="n">do_it</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="n">Stdout</span><span class="o">.</span><span class="n">line</span><span class="o">!</span>

<span class="n">do_it</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">\</span><span class="nn">some_function</span><span class="w"> </span><span class="o">-&gt;</span>
<span class="w">    </span><span class="n">foo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">some_function</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="n">Num</span><span class="o">.</span><span class="n">toStr</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="n">Str</span><span class="o">.</span><span class="n">joinWith</span><span class="w"> </span><span class="s">"&amp;"</span>
<span class="w">    </span><span class="n">bar</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">some_function</span><span class="w"> </span><span class="p">[</span><span class="s">" a"</span><span class="p">,</span><span class="w"> </span><span class="s">"b "</span><span class="p">]</span><span class="w"> </span><span class="n">Str</span><span class="o">.</span><span class="n">trim</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="n">Str</span><span class="o">.</span><span class="n">joinWith</span><span class="w"> </span><span class="s">"&amp;"</span>
<span class="w">    </span><span class="n">Str</span><span class="o">.</span><span class="n">concat</span><span class="w"> </span><span class="n">foo</span><span class="w"> </span><span class="n">bar</span>
</code></pre></div>
<p>like</p>
<div class="codehilite"><pre><span></span><code>But `some_function` needs its 1st argument to be:

    List (Num *)
</code></pre></div>



<a name="495363004"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/463736-bugs/topic/%E2%9C%94%20Can%27t%20rename%20a%20polymorphic%20function%3F/near/495363004" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jan kili <a href="https://roc-lang.github.io/zulip-export/stream/463736-bugs/topic/.E2.9C.94.20Can.27t.20rename.20a.20polymorphic.20function.3F.html#495363004">(Jan 22 2025 at 19:55)</a>:</h4>
<p>Specifying</p>
<div class="codehilite"><pre><span></span><code>do_it : (List a, (a -&gt; b) -&gt; List b) -&gt; Str
</code></pre></div>
<p>leads to a similar secondary message:</p>
<div class="codehilite"><pre><span></span><code>TYPE MISMATCH

This 1st argument to |&gt; has an unexpected type:

10│      foo = some_function [1, 2, 3, 4] Num.toStr |&gt; Str.joinWith &quot;&amp;&quot;
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

This `some_function` call produces:

    List b

But |&gt; needs its 1st argument to be:

    List Str

Tip: The type annotation uses the type variable `b` to say
that this definition can produce any type of value. But in
the body I see that it will only produce a `Str` value of a
single specific type. Maybe change the type annotation to be
more specific? Maybe change the code to be more general?
</code></pre></div>
<p>but maybe the next nightly will include an improvement from Ayaz's PR?</p>



<a name="495363318"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/463736-bugs/topic/%E2%9C%94%20Can%27t%20rename%20a%20polymorphic%20function%3F/near/495363318" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/463736-bugs/topic/.E2.9C.94.20Can.27t.20rename.20a.20polymorphic.20function.3F.html#495363318">(Jan 22 2025 at 19:57)</a>:</h4>
<p>I don't think his last PR will have fixed this</p>



<a name="495363402"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/463736-bugs/topic/%E2%9C%94%20Can%27t%20rename%20a%20polymorphic%20function%3F/near/495363402" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/463736-bugs/topic/.E2.9C.94.20Can.27t.20rename.20a.20polymorphic.20function.3F.html#495363402">(Jan 22 2025 at 19:57)</a>:</h4>
<p>That PR was warning devs when they implied code was generic with a type signature that actually only operated on a single, specific type</p>



<a name="495363525"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/463736-bugs/topic/%E2%9C%94%20Can%27t%20rename%20a%20polymorphic%20function%3F/near/495363525" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/463736-bugs/topic/.E2.9C.94.20Can.27t.20rename.20a.20polymorphic.20function.3F.html#495363525">(Jan 22 2025 at 19:58)</a>:</h4>
<p>The <a href="https://math.stackexchange.com/questions/65622/whats-the-point-of-eta-conversion-in-lambda-calculus">eta-expansion</a> would need to be implemented separately</p>



<a name="495364009"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/463736-bugs/topic/%E2%9C%94%20Can%27t%20rename%20a%20polymorphic%20function%3F/near/495364009" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jan kili <a href="https://roc-lang.github.io/zulip-export/stream/463736-bugs/topic/.E2.9C.94.20Can.27t.20rename.20a.20polymorphic.20function.3F.html#495364009">(Jan 22 2025 at 20:01)</a>:</h4>
<p><span class="user-mention silent" data-user-id="461444">Sam Mohr</span> <a href="#narrow/channel/463736-bugs/topic/Can't.20rename.20a.20polymorphic.20function.3F/near/495363318">said</a>:</p>
<blockquote>
<p>I don't think his last PR will have fixed this</p>
</blockquote>
<p>Yeah, confirmed with today's TESTING release and basic-cli@main - no change.</p>



<a name="495399962"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/463736-bugs/topic/%E2%9C%94%20Can%27t%20rename%20a%20polymorphic%20function%3F/near/495399962" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ayaz Hafiz <a href="https://roc-lang.github.io/zulip-export/stream/463736-bugs/topic/.E2.9C.94.20Can.27t.20rename.20a.20polymorphic.20function.3F.html#495399962">(Jan 23 2025 at 00:44)</a>:</h4>
<p>&gt;</p>
<div class="codehilite"><pre><span></span><code>do_it = \some_function -&gt;
    foo = some_function [1, 2, 3, 4] Num.toStr |&gt; Str.joinWith &quot;&amp;&quot;
    bar = some_function [&quot; a&quot;, &quot;b &quot;] Str.trim |&gt; Str.joinWith &quot;&amp;&quot;
    Str.concat foo bar
</code></pre></div>
<p>This case is separate to the previous examples - this requires a type system feature called "higher ranked types". The name is confusing but it basically means that <code>some_function</code> has to itself be polymorphic, and not be of a specific type. Normally, if I had a function </p>
<div class="codehilite"><pre><span></span><code>do_it = \some_function, l, f -&gt; some_function l f

do_it List.map [] (\x -&gt; x + 1)
</code></pre></div>
<p><code>some_function</code> gets the concrete type <code>List I64, (I64 -&gt; I64) -&gt; List I64</code> when it is called. But in the case you showed, <code>some_function</code> needs to always be polymorphic - I cannot call it with a <code>I64 -&gt; I64</code>, I need to call it with something that's always an <code>a -&gt; a</code>. This isn't supported in Roc and I would be surprised if it is added</p>



<a name="495400632"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/463736-bugs/topic/%E2%9C%94%20Can%27t%20rename%20a%20polymorphic%20function%3F/near/495400632" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jan kili <a href="https://roc-lang.github.io/zulip-export/stream/463736-bugs/topic/.E2.9C.94.20Can.27t.20rename.20a.20polymorphic.20function.3F.html#495400632">(Jan 23 2025 at 00:50)</a>:</h4>
<p>Ah, okay. Does that mean that type variables are only supported within function parameters that aren't functions themselves?<br>
as in, <code>do_it : (List a, (a -&gt; b) -&gt; List b) -&gt; Str</code> is unsupported<br>
or here's a simpler one ~ <code>do_it : (a -&gt; Str) -&gt; Str</code></p>



<a name="495401271"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/463736-bugs/topic/%E2%9C%94%20Can%27t%20rename%20a%20polymorphic%20function%3F/near/495401271" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ayaz Hafiz <a href="https://roc-lang.github.io/zulip-export/stream/463736-bugs/topic/.E2.9C.94.20Can.27t.20rename.20a.20polymorphic.20function.3F.html#495401271">(Jan 23 2025 at 00:56)</a>:</h4>
<p>No, that works, but the type variable becomes a concrete type when the outer function (<code>do_it</code>) is called, not when the inner function is called</p>



<a name="495401430"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/463736-bugs/topic/%E2%9C%94%20Can%27t%20rename%20a%20polymorphic%20function%3F/near/495401430" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ayaz Hafiz <a href="https://roc-lang.github.io/zulip-export/stream/463736-bugs/topic/.E2.9C.94.20Can.27t.20rename.20a.20polymorphic.20function.3F.html#495401430">(Jan 23 2025 at 00:57)</a>:</h4>
<p>another way to think about it is like</p>
<div class="codehilite"><pre><span></span><code>do_it = \some_function, throwaway_arg -&gt;
  dbg throwaway_arg
    foo = some_function [1, 2, 3, 4] Num.toStr |&gt; Str.joinWith &quot;&amp;&quot;
    bar = some_function [&quot; a&quot;, &quot;b &quot;] Str.trim |&gt; Str.joinWith &quot;&amp;&quot;
    Str.concat foo bar
</code></pre></div>
<p><code>throwaway_arg</code> can be <code>a</code>, but <code>some_function</code> needs to be something like <code>(forall b : List b, (b -&gt; Str) -&gt; List Str)</code></p>



<a name="495401436"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/463736-bugs/topic/%E2%9C%94%20Can%27t%20rename%20a%20polymorphic%20function%3F/near/495401436" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jan kili <a href="https://roc-lang.github.io/zulip-export/stream/463736-bugs/topic/.E2.9C.94.20Can.27t.20rename.20a.20polymorphic.20function.3F.html#495401436">(Jan 23 2025 at 00:57)</a>:</h4>
<p>Side note - I now see that this doesn't work either:</p>
<div class="codehilite" data-code-language="Perl"><pre><span></span><code><span class="n">do_it</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">foo</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Str</span>
<span class="n">do_it</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">\</span><span class="p">{</span><span class="w"> </span><span class="n">foo</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="o">-&gt;</span>
<span class="w">    </span><span class="n">Inspect</span><span class="o">.</span><span class="n">toStr</span><span class="w"> </span><span class="n">foo</span>
</code></pre></div>
<div class="codehilite"><pre><span></span><code>TYPE MISMATCH

This 1st argument to `toStr` has an unexpected type:

37│      Inspect.toStr foo
                       ^^^

This `foo` value is a:

    a

But `toStr` needs its 1st argument to be:

    val where val implements Inspect

Tip: The type annotation uses the type variable `a` to say
that this definition can produce any type of value. But in
the body I see that it will only produce an instance of the
ability `Inspect` of a single specific type. Maybe change the
type annotation to be more specific? Maybe change the code
to be more general?
</code></pre></div>



<a name="495401543"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/463736-bugs/topic/%E2%9C%94%20Can%27t%20rename%20a%20polymorphic%20function%3F/near/495401543" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ayaz Hafiz <a href="https://roc-lang.github.io/zulip-export/stream/463736-bugs/topic/.E2.9C.94.20Can.27t.20rename.20a.20polymorphic.20function.3F.html#495401543">(Jan 23 2025 at 00:58)</a>:</h4>
<p>The tip at the bottom is not good but you need to say that <code>a</code> implements <code>Inpsect</code>. This should work</p>
<div class="codehilite"><pre><span></span><code>do_it : { foo : a } -&gt; Str where a implement Inspect
do_it = \{ foo } -&gt;
    Inspect.toStr foo
</code></pre></div>



<a name="495402143"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/463736-bugs/topic/%E2%9C%94%20Can%27t%20rename%20a%20polymorphic%20function%3F/near/495402143" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jan kili <a href="https://roc-lang.github.io/zulip-export/stream/463736-bugs/topic/.E2.9C.94.20Can.27t.20rename.20a.20polymorphic.20function.3F.html#495402143">(Jan 23 2025 at 01:03)</a>:</h4>
<p><span class="user-mention silent" data-user-id="454654">Ayaz Hafiz</span> <a href="#narrow/channel/463736-bugs/topic/Can't.20rename.20a.20polymorphic.20function.3F/near/495401430">said</a>:</p>
<blockquote>
<p><code>throwaway_arg</code> can be <code>a</code>, but <code>some_function</code> needs to be something like <code>(forall b : List b, (b -&gt; Str) -&gt; List Str)</code></p>
</blockquote>
<p><span class="user-mention" data-user-id="454654">@Ayaz Hafiz</span> Am I doing it wrong?<br>
<a href="/user_uploads/22008/ID05hb9YBAyocpK1sgRXOfX4/Screenshot_20250122_180239.png">Screenshot_20250122_180239.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/22008/ID05hb9YBAyocpK1sgRXOfX4/Screenshot_20250122_180239.png" title="Screenshot_20250122_180239.png"><img data-original-content-type="image/png" data-original-dimensions="1067x705" src="/user_uploads/thumbnail/22008/ID05hb9YBAyocpK1sgRXOfX4/Screenshot_20250122_180239.png/840x560.webp"></a></div>



<a name="495402295"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/463736-bugs/topic/%E2%9C%94%20Can%27t%20rename%20a%20polymorphic%20function%3F/near/495402295" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jan kili <a href="https://roc-lang.github.io/zulip-export/stream/463736-bugs/topic/.E2.9C.94.20Can.27t.20rename.20a.20polymorphic.20function.3F.html#495402295">(Jan 23 2025 at 01:05)</a>:</h4>
<p>Regardless, it sounds like I should start an #ideas topic for "Automatic eta expansion" based on Richard's suggestion above.</p>



<a name="495402773"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/463736-bugs/topic/%E2%9C%94%20Can%27t%20rename%20a%20polymorphic%20function%3F/near/495402773" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ayaz Hafiz <a href="https://roc-lang.github.io/zulip-export/stream/463736-bugs/topic/.E2.9C.94.20Can.27t.20rename.20a.20polymorphic.20function.3F.html#495402773">(Jan 23 2025 at 01:09)</a>:</h4>
<p>well, i was saying roc doesn’t support that</p>



<a name="495403131"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/463736-bugs/topic/%E2%9C%94%20Can%27t%20rename%20a%20polymorphic%20function%3F/near/495403131" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jan kili <a href="https://roc-lang.github.io/zulip-export/stream/463736-bugs/topic/.E2.9C.94.20Can.27t.20rename.20a.20polymorphic.20function.3F.html#495403131">(Jan 23 2025 at 01:12)</a>:</h4>
<p><span class="user-mention silent" data-user-id="454654">Ayaz Hafiz</span> <a href="#narrow/channel/463736-bugs/topic/Can't.20rename.20a.20polymorphic.20function.3F/near/495401271">said</a>:</p>
<blockquote>
<p>No, that works, but the type variable becomes a concrete type when the outer function (<code>do_it</code>) is called, not when the inner function is called</p>
</blockquote>
<p><del>In practice, type vars don't seem to work within parameters that are functions:</del></p>
<div class="codehilite" data-code-language="Perl"><pre><span></span><code><span class="n">app</span><span class="w"> </span><span class="p">[</span><span class="n">main</span><span class="o">!</span><span class="p">]</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">basic_cli:</span><span class="w"> </span><span class="n">platform</span><span class="w"> </span><span class="s">"./platform/main.roc"</span><span class="w"> </span><span class="p">}</span>

<span class="nb">import</span><span class="w"> </span><span class="n">basic_cli</span><span class="o">.</span><span class="n">Stdout</span>

<span class="n">main</span><span class="o">!</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">\</span><span class="nn">_</span><span class="w"> </span><span class="o">-&gt;</span>
<span class="w">    </span><span class="n">f</span><span class="w"> </span><span class="n">Inspect</span><span class="o">.</span><span class="n">toStr</span>
<span class="w">    </span><span class="o">|&gt;</span><span class="w"> </span><span class="n">Str</span><span class="o">.</span><span class="n">concat</span><span class="w"> </span><span class="p">(</span><span class="n">f</span><span class="w"> </span><span class="n">Num</span><span class="o">.</span><span class="n">toStr</span><span class="p">)</span>
<span class="w">    </span><span class="o">|&gt;</span><span class="w"> </span><span class="n">Stdout</span><span class="o">.</span><span class="n">line</span><span class="o">!</span>

<span class="n">f</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="nn">a</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Str</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Str</span>
<span class="n">f</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">\</span><span class="nn">g</span><span class="w"> </span><span class="o">-&gt;</span>
<span class="w">    </span><span class="n">g</span><span class="w"> </span><span class="mi">10</span>
</code></pre></div>
<div class="codehilite"><pre><span></span><code>TYPE MISMATCH

This 1st argument to `g` has an unexpected type:

12│      g 10
           ^^

The argument is a number of type:

    Num *

But `g` needs its 1st argument to be:

    a

Tip: The type annotation uses the type variable `a` to say
that this definition can produce any type of value. But in
the body I see that it will only produce a `Num` value of a
single specific type. Maybe change the type annotation to be
more specific? Maybe change the code to be more general?
</code></pre></div>



<a name="495403192"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/463736-bugs/topic/%E2%9C%94%20Can%27t%20rename%20a%20polymorphic%20function%3F/near/495403192" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jan kili <a href="https://roc-lang.github.io/zulip-export/stream/463736-bugs/topic/.E2.9C.94.20Can.27t.20rename.20a.20polymorphic.20function.3F.html#495403192">(Jan 23 2025 at 01:13)</a>:</h4>
<p><del>Which is understandable if it's unsupported, I'm just seeking what the support boundary means in practice.</del></p>



<a name="495403347"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/463736-bugs/topic/%E2%9C%94%20Can%27t%20rename%20a%20polymorphic%20function%3F/near/495403347" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jan kili <a href="https://roc-lang.github.io/zulip-export/stream/463736-bugs/topic/.E2.9C.94.20Can.27t.20rename.20a.20polymorphic.20function.3F.html#495403347">(Jan 23 2025 at 01:14)</a>:</h4>
<p>NEVERMIND, I'm wrong - fix coming</p>



<a name="495403380"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/463736-bugs/topic/%E2%9C%94%20Can%27t%20rename%20a%20polymorphic%20function%3F/near/495403380" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jan kili <a href="https://roc-lang.github.io/zulip-export/stream/463736-bugs/topic/.E2.9C.94.20Can.27t.20rename.20a.20polymorphic.20function.3F.html#495403380">(Jan 23 2025 at 01:15)</a>:</h4>
<p>This works just fine:</p>
<div class="codehilite" data-code-language="Perl"><pre><span></span><code><span class="n">app</span><span class="w"> </span><span class="p">[</span><span class="n">main</span><span class="o">!</span><span class="p">]</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">basic_cli:</span><span class="w"> </span><span class="n">platform</span><span class="w"> </span><span class="s">"./platform/main.roc"</span><span class="w"> </span><span class="p">}</span>

<span class="nb">import</span><span class="w"> </span><span class="n">basic_cli</span><span class="o">.</span><span class="n">Stdout</span>

<span class="n">main</span><span class="o">!</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">\</span><span class="nn">_</span><span class="w"> </span><span class="o">-&gt;</span>
<span class="w">    </span><span class="n">f</span><span class="w"> </span><span class="n">Inspect</span><span class="o">.</span><span class="n">toStr</span><span class="w"> </span><span class="mi">10</span>
<span class="w">    </span><span class="o">|&gt;</span><span class="w"> </span><span class="n">Str</span><span class="o">.</span><span class="n">concat</span><span class="w"> </span><span class="p">(</span><span class="n">f</span><span class="w"> </span><span class="n">Num</span><span class="o">.</span><span class="n">toStr</span><span class="w"> </span><span class="mi">10</span><span class="p">)</span>
<span class="w">    </span><span class="o">|&gt;</span><span class="w"> </span><span class="n">Stdout</span><span class="o">.</span><span class="n">line</span><span class="o">!</span>

<span class="n">f</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="nn">a</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Str</span><span class="p">),</span><span class="w"> </span><span class="nn">a</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Str</span>
<span class="n">f</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">\</span><span class="n">g</span><span class="p">,</span><span class="w"> </span><span class="nn">x</span><span class="w"> </span><span class="o">-&gt;</span>
<span class="w">    </span><span class="n">g</span><span class="w"> </span><span class="n">x</span>
</code></pre></div>



<a name="495403570"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/463736-bugs/topic/%E2%9C%94%20Can%27t%20rename%20a%20polymorphic%20function%3F/near/495403570" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jan kili <a href="https://roc-lang.github.io/zulip-export/stream/463736-bugs/topic/.E2.9C.94.20Can.27t.20rename.20a.20polymorphic.20function.3F.html#495403570">(Jan 23 2025 at 01:16)</a>:</h4>
<p>So the unsupported thing here seems to just be over-generalizing a function signature, which I don't mind.</p>



<a name="495404175"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/463736-bugs/topic/%E2%9C%94%20Can%27t%20rename%20a%20polymorphic%20function%3F/near/495404175" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jan kili <a href="https://roc-lang.github.io/zulip-export/stream/463736-bugs/topic/.E2.9C.94.20Can.27t.20rename.20a.20polymorphic.20function.3F.html#495404175">(Jan 23 2025 at 01:22)</a>:</h4>
<p>Regarding Richard's suggestion of automatic eta expansion, I'm unsure how to interpret your replies. My optimistic reading is that you haven't addressed it yet, but my pessimistic reading sees this sequence:</p>
<p><span class="user-mention silent" data-user-id="454654">Ayaz Hafiz</span> <a href="#narrow/channel/463736-bugs/topic/Can't.20rename.20a.20polymorphic.20function.3F/near/495399962">said</a>:</p>
<blockquote>
<p>... This isn't supported in Roc and I would be surprised if it is added</p>
</blockquote>
<p><span class="user-mention silent" data-user-id="462053">JanCVanB</span> <a href="#narrow/channel/463736-bugs/topic/Can't.20rename.20a.20polymorphic.20function.3F/near/495402295">said</a>:</p>
<blockquote>
<p>...it sounds like I should start an #ideas topic for "Automatic eta expansion" based on Richard's suggestion above.</p>
</blockquote>
<p><span class="user-mention silent" data-user-id="454654">Ayaz Hafiz</span> <a href="#narrow/channel/463736-bugs/topic/Can't.20rename.20a.20polymorphic.20function.3F/near/495402773">said</a>:</p>
<blockquote>
<p>well, i was saying roc doesn’t support that</p>
</blockquote>



<a name="495404547"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/463736-bugs/topic/%E2%9C%94%20Can%27t%20rename%20a%20polymorphic%20function%3F/near/495404547" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jan kili <a href="https://roc-lang.github.io/zulip-export/stream/463736-bugs/topic/.E2.9C.94.20Can.27t.20rename.20a.20polymorphic.20function.3F.html#495404547">(Jan 23 2025 at 01:26)</a>:</h4>
<p>I'm specifically interested in the "when naming it in defs" case:</p>
<div class="codehilite" data-code-language="Perl"><pre><span></span><code><span class="n">mappy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">rename</span><span class="w"> </span><span class="n">List</span><span class="o">.</span><span class="nb">map</span>
<span class="nb">rename</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">\</span><span class="nn">anything</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">anything</span>
</code></pre></div>



<a name="495408743"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/463736-bugs/topic/%E2%9C%94%20Can%27t%20rename%20a%20polymorphic%20function%3F/near/495408743" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ayaz Hafiz <a href="https://roc-lang.github.io/zulip-export/stream/463736-bugs/topic/.E2.9C.94.20Can.27t.20rename.20a.20polymorphic.20function.3F.html#495408743">(Jan 23 2025 at 02:06)</a>:</h4>
<p>those conversations are interleaved about different things… in the messages quoted from me i was referring to higher rank types, richard was referring to eta expansion. i dont see an issue with eta expansion</p>



<a name="495606453"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/463736-bugs/topic/%E2%9C%94%20Can%27t%20rename%20a%20polymorphic%20function%3F/near/495606453" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jan kili <a href="https://roc-lang.github.io/zulip-export/stream/463736-bugs/topic/.E2.9C.94.20Can.27t.20rename.20a.20polymorphic.20function.3F.html#495606453">(Jan 23 2025 at 23:57)</a>:</h4>
<p>The clearest "bug(s)" here seem to just be unsatisfying error messages, but those are improving daily. I'm resolving this for now, with discussion hopefully continuing here: <a class="stream-topic" data-stream-id="304641" href="/#narrow/channel/304641-ideas/topic/automatic.20eta.20expansion.2C.20to.20rename.20polymorphic.20f.27ns">#ideas &gt; automatic eta expansion, to rename polymorphic f'ns</a></p>



<a name="495606458"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/463736-bugs/topic/%E2%9C%94%20Can%27t%20rename%20a%20polymorphic%20function%3F/near/495606458" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Notification Bot <a href="https://roc-lang.github.io/zulip-export/stream/463736-bugs/topic/.E2.9C.94.20Can.27t.20rename.20a.20polymorphic.20function.3F.html#495606458">(Jan 23 2025 at 23:57)</a>:</h4>
<p><span class="user-mention silent" data-user-id="462053">JanCVanB</span> has marked this topic as resolved.</p>



<hr><p>Last updated: Mar 01 2026 at 12:20 UTC</p>
</html>