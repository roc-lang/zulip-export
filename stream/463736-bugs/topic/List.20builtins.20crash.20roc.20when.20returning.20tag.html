<html>
<head><meta charset="utf-8"><title>List builtins crash roc when returning tag · bugs · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://roc-lang.github.io/zulip-export/stream/463736-bugs/index.html">bugs</a></h2>
<h3>Topic: <a href="https://roc-lang.github.io/zulip-export/stream/463736-bugs/topic/List.20builtins.20crash.20roc.20when.20returning.20tag.html">List builtins crash roc when returning tag</a></h3>

<hr>

<base href="https://roc.zulipchat.com">

<head><link href="https://roc-lang.github.io/zulip-export/style.css" rel="stylesheet"></head>

<a name="560865863"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/463736-bugs/topic/List%20builtins%20crash%20roc%20when%20returning%20tag/near/560865863" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Andres Villegas <a href="https://roc-lang.github.io/zulip-export/stream/463736-bugs/topic/List.20builtins.20crash.20roc.20when.20returning.20tag.html#560865863">(Nov 28 2025 at 23:47)</a>:</h4>
<p>List builtins that return a <code>ListWasEmpty</code> tag when the list is empty, make the compiler crash with </p>
<div class="codehilite"><pre><span></span><code>Roc crashed: Invalid tag `ListWasEmpty`
</code></pre></div>
<p>Steps to reproduce:<br>
roc version: Roc compiler version debug-2d4bb929<br>
use the following code in the <code>test/fx/app.roc</code> file</p>
<div class="codehilite"><pre><span></span><code>app [main!] { pf: platform &quot;./platform/main.roc&quot; }

import pf.Stdout
import pf.Stderr

str : Str -&gt; Str
str = |s| s

main! = || {
    x = List.get([], 0)
    if Try.is_ok(x) {
        Stdout.line!(&quot;is ok&quot;)
    } else {
        Stdout.line!(&quot;is err&quot;)
    }
}
</code></pre></div>
<p>run: <code> ./zig-out/bin/roc test/fx/app.roc</code><br>
it crashes.<br>
if you replace the list with a non empty list  it works</p>



<a name="560865890"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/463736-bugs/topic/List%20builtins%20crash%20roc%20when%20returning%20tag/near/560865890" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Andres Villegas <a href="https://roc-lang.github.io/zulip-export/stream/463736-bugs/topic/List.20builtins.20crash.20roc.20when.20returning.20tag.html#560865890">(Nov 28 2025 at 23:47)</a>:</h4>
<p>This also affects <code>List.first</code></p>



<a name="560869606"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/463736-bugs/topic/List%20builtins%20crash%20roc%20when%20returning%20tag/near/560869606" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/463736-bugs/topic/List.20builtins.20crash.20roc.20when.20returning.20tag.html#560869606">(Nov 29 2025 at 00:46)</a>:</h4>
<p><span aria-label="thumbs up" class="emoji emoji-1f44d" role="img" title="thumbs up">:thumbs_up:</span></p>



<a name="560870001"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/463736-bugs/topic/List%20builtins%20crash%20roc%20when%20returning%20tag/near/560870001" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/463736-bugs/topic/List.20builtins.20crash.20roc.20when.20returning.20tag.html#560870001">(Nov 29 2025 at 00:53)</a>:</h4>
<p>If you create GH Issues it's a bit easier to track the resolution of these. But zulip is also fine to report</p>



<a name="560870070"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/463736-bugs/topic/List%20builtins%20crash%20roc%20when%20returning%20tag/near/560870070" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/463736-bugs/topic/List.20builtins.20crash.20roc.20when.20returning.20tag.html#560870070">(Nov 29 2025 at 00:54)</a>:</h4>
<p>I'm currently debugging some issues with the platform integration -- happy to look at this after if Richard or someone doesn't get to it first.</p>



<a name="560870097"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/463736-bugs/topic/List%20builtins%20crash%20roc%20when%20returning%20tag/near/560870097" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/463736-bugs/topic/List.20builtins.20crash.20roc.20when.20returning.20tag.html#560870097">(Nov 29 2025 at 00:54)</a>:</h4>
<p>I'm working on this one already!</p>



<a name="560871544"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/463736-bugs/topic/List%20builtins%20crash%20roc%20when%20returning%20tag/near/560871544" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/463736-bugs/topic/List.20builtins.20crash.20roc.20when.20returning.20tag.html#560871544">(Nov 29 2025 at 01:24)</a>:</h4>
<p>PR fixing this: <a href="https://github.com/roc-lang/roc/pull/8494">https://github.com/roc-lang/roc/pull/8494</a></p>



<a name="560871706"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/463736-bugs/topic/List%20builtins%20crash%20roc%20when%20returning%20tag/near/560871706" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Matthieu Pizenberg <a href="https://roc-lang.github.io/zulip-export/stream/463736-bugs/topic/List.20builtins.20crash.20roc.20when.20returning.20tag.html#560871706">(Nov 29 2025 at 01:28)</a>:</h4>
<p>You seem to have also commented out the long stack safety tests in there. Not sure if commit is intentional so just warning.</p>



<a name="560871734"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/463736-bugs/topic/List%20builtins%20crash%20roc%20when%20returning%20tag/near/560871734" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/463736-bugs/topic/List.20builtins.20crash.20roc.20when.20returning.20tag.html#560871734">(Nov 29 2025 at 01:28)</a>:</h4>
<p>yeah that was intentional</p>



<a name="560871752"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/463736-bugs/topic/List%20builtins%20crash%20roc%20when%20returning%20tag/near/560871752" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/463736-bugs/topic/List.20builtins.20crash.20roc.20when.20returning.20tag.html#560871752">(Nov 29 2025 at 01:29)</a>:</h4>
<p>I wanted them for the stack safety PR but I noticed they take up a big chunk of <code>zig build test</code> time and the odds of regression there are very low haha</p>



<hr><p>Last updated: Mar 01 2026 at 12:20 UTC</p>
</html>