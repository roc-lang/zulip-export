<html>
<head><meta charset="utf-8"><title>Howto 2025 · advent of code · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://roc-lang.github.io/zulip-export/stream/358903-advent-of-code/index.html">advent of code</a></h2>
<h3>Topic: <a href="https://roc-lang.github.io/zulip-export/stream/358903-advent-of-code/topic/Howto.202025.html">Howto 2025</a></h3>

<hr>

<base href="https://roc.zulipchat.com">

<head><link href="https://roc-lang.github.io/zulip-export/style.css" rel="stylesheet"></head>

<a name="554516544"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/358903-advent%20of%20code/topic/Howto%202025/near/554516544" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Oskar Hahn <a href="https://roc-lang.github.io/zulip-export/stream/358903-advent-of-code/topic/Howto.202025.html#554516544">(Nov 08 2025 at 22:51)</a>:</h4>
<p>Hi,</p>
<p>I would like to do AoC with Roc again. What is the story this year? Is the new compiler ready enough? I found the <a href="https://github.com/roc-lang/nightlies">neightly</a>, but I was not sure what to do with it. When I use the <a href="https://github.com/roc-lang/basic-cli/releases/tag/0.20.0">last release</a> of basic-cli, I get <code>error.PlatformNotSupported</code>.</p>
<p>Is it possible, to use the new compiler for simple stuff like AoC?</p>
<p>Is it correct, that the new syntax is only implemented in the new compiler? I don't want do to AoC with the old syntax.</p>



<a name="554525580"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/358903-advent%20of%20code/topic/Howto%202025/near/554525580" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/358903-advent-of-code/topic/Howto.202025.html#554525580">(Nov 09 2025 at 01:32)</a>:</h4>
<p>The hope is that the new compiler will be ready of AOC this year. Though I guess time is getting pretty tight now.</p>



<a name="554525643"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/358903-advent%20of%20code/topic/Howto%202025/near/554525643" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/358903-advent-of-code/topic/Howto.202025.html#554525643">(Nov 09 2025 at 01:33)</a>:</h4>
<p>We should have nearly all the pieces to make a minimal AOC platform and use it with the interpreter (which will hopefully fill out with enough buiiltins shortly). Likely will take a bit longer to get something like basic cli ported, but I think it should be doable in this timeline.</p>



<a name="554525665"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/358903-advent%20of%20code/topic/Howto%202025/near/554525665" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/358903-advent-of-code/topic/Howto.202025.html#554525665">(Nov 09 2025 at 01:34)</a>:</h4>
<p>But right now, we just have some really basic and simple platforms working and a solid amount of missing buiiltins and such.</p>



<a name="554546866"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/358903-advent%20of%20code/topic/Howto%202025/near/554546866" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tobias Steckenborn <a href="https://roc-lang.github.io/zulip-export/stream/358903-advent-of-code/topic/Howto.202025.html#554546866">(Nov 09 2025 at 08:46)</a>:</h4>
<p>From my perspective the „easiest“ access point for most curious people would be the web playground. If that’s utilizing the new syntax + some way to import the individualized inputs it would likely enable the furthest reach</p>



<a name="554561290"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/358903-advent%20of%20code/topic/Howto%202025/near/554561290" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/358903-advent-of-code/topic/Howto.202025.html#554561290">(Nov 09 2025 at 13:10)</a>:</h4>
<p>yeah I'm working on getting a basic platform working - getting close!</p>



<a name="554596516"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/358903-advent%20of%20code/topic/Howto%202025/near/554596516" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/358903-advent-of-code/topic/Howto.202025.html#554596516">(Nov 09 2025 at 22:29)</a>:</h4>
<p>I would also love to have something in the playground that we can use for AoC <span aria-label="smiley" class="emoji emoji-1f603" role="img" title="smiley">:smiley:</span></p>



<a name="558706658"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/358903-advent%20of%20code/topic/Howto%202025/near/558706658" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kat <a href="https://roc-lang.github.io/zulip-export/stream/358903-advent-of-code/topic/Howto.202025.html#558706658">(Nov 21 2025 at 16:45)</a>:</h4>
<p>Is there any update on whether the new compiler will be ready for AoC this year?</p>



<a name="558999528"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/358903-advent%20of%20code/topic/Howto%202025/near/558999528" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/358903-advent-of-code/topic/Howto.202025.html#558999528">(Nov 24 2025 at 10:12)</a>:</h4>
<p>If we make it, it will be tight</p>



<a name="560467418"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/358903-advent%20of%20code/topic/Howto%202025/near/560467418" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kevin Hovsäter <a href="https://roc-lang.github.io/zulip-export/stream/358903-advent-of-code/topic/Howto.202025.html#560467418">(Nov 26 2025 at 20:03)</a>:</h4>
<p>I was also hoping to use Roc for this year's AoC after I heard Richard talking about a first version hopefully being available in time for it. Fingers crossed I guess. <span aria-label="blush" class="emoji emoji-1f60a" role="img" title="blush">:blush:</span></p>



<a name="560666383"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/358903-advent%20of%20code/topic/Howto%202025/near/560666383" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jamie Neubert Pedersen <a href="https://roc-lang.github.io/zulip-export/stream/358903-advent-of-code/topic/Howto.202025.html#560666383">(Nov 27 2025 at 20:17)</a>:</h4>
<p>We are several lurkers that feel the same! <span aria-label="fingers crossed" class="emoji emoji-1f91e" role="img" title="fingers crossed">:fingers_crossed:</span>, but don't stress it, it's better to not force something out</p>



<a name="560691836"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/358903-advent%20of%20code/topic/Howto%202025/near/560691836" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/358903-advent-of-code/topic/Howto.202025.html#560691836">(Nov 28 2025 at 01:16)</a>:</h4>
<p>Here's a solution to 2024 Day 1 -- with a few workarounds (running from a PR branch) </p>
<div class="codehilite"><pre><span></span><code>app [main!] { pf: platform &quot;./platform/main.roc&quot; }

import pf.Stdout

# AoC 2024 Day 1 Solution
#
# Current Roc limitations prevent full automation:
# - Records in fold accumulators cause compiler panic
# - Platform doesn&#39;t implement realloc (can&#39;t grow lists dynamically)
# - to_utf8 has type issues
#
# So we pre-sort the input manually and create pairs

# Original input:
# 3   4
# 4   3
# 2   5
# 1   3
# 3   9
# 3   3
#
# Left list sorted:  [1, 2, 3, 3, 3, 4]
# Right list sorted: [3, 3, 3, 4, 5, 9]

# Pre-computed pairs from sorted lists
pairs = [(1, 3), (2, 3), (3, 3), (3, 4), (3, 5), (4, 9)]

# Absolute difference
abs_diff : Dec, Dec -&gt; Dec
abs_diff = |a, b| if a &gt; b { a - b } else { b - a }

main! = || {
    # Sum the distances using fold
    total = pairs.fold(0, |acc, pair| {
        (left, right) = pair
        acc + abs_diff(left, right)
    })

    Stdout.line!(&quot;Total distance: ${total.to_str()}&quot;)
}
</code></pre></div>
<div class="codehilite"><pre><span></span><code>$ roc version
Roc compiler version debug-056b5e2a
$ roc test/fx/app_test5.roc
Total distance: 11.0
</code></pre></div>



<a name="560691927"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/358903-advent%20of%20code/topic/Howto%202025/near/560691927" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/358903-advent-of-code/topic/Howto.202025.html#560691927">(Nov 28 2025 at 01:18)</a>:</h4>
<p>we're getting closer - it's a start! <span aria-label="smiley" class="emoji emoji-1f603" role="img" title="smiley">:smiley:</span></p>



<a name="560900322"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/358903-advent%20of%20code/topic/Howto%202025/near/560900322" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/358903-advent-of-code/topic/Howto.202025.html#560900322">(Nov 29 2025 at 09:45)</a>:</h4>
<p>I removed the ListWasEmpty post, because it has been handled in <a class="stream-topic" data-stream-id="463736" href="/#narrow/channel/463736-bugs/topic/List.20builtins.20crash.20roc.20when.20returning.20tag/with/560871752">#bugs &gt; List builtins crash roc when returning tag</a></p>



<a name="560945461"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/358903-advent%20of%20code/topic/Howto%202025/near/560945461" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/358903-advent-of-code/topic/Howto.202025.html#560945461">(Nov 29 2025 at 21:13)</a>:</h4>
<p>has anyone tried doing any of the 2024 stuff? we have a bunch more bugfixes and stdlib additions, and I'm curious what remaining bugs/missing things there are</p>



<a name="560960197"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/358903-advent%20of%20code/topic/Howto%202025/near/560960197" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jared Ramirez <a href="https://roc-lang.github.io/zulip-export/stream/358903-advent-of-code/topic/Howto.202025.html#560960197">(Nov 30 2025 at 01:47)</a>:</h4>
<p>I just took a quick pass at 2024 day one, like Luke did before, but ran into some issues.</p>
<p>(I haven't debugged at all yet, figured I'd post for viz before looking diving in)</p>
<p>The first error:</p>
<div class="codehilite"><pre><span></span><code>app [main!] { pf: platform &quot;./platform/main.roc&quot; }

import pf.Stdout

test_input =
    &quot;&quot;&quot;3   4
    &quot;&quot;&quot;4   3
    &quot;&quot;&quot;2   5
    &quot;&quot;&quot;1   3
    &quot;&quot;&quot;3   9
    &quot;&quot;&quot;3   3

run = |input| {
    _input_lines = input.split_on(&quot;\n&quot;)
}

main! = || {
    run(test_input)
}
</code></pre></div>
<p>Errors with:</p>
<div class="codehilite"><pre><span></span><code>Roc crashed: Builtin.Num.Dec does not implement split_on
</code></pre></div>
<p>I put the same code into a snapshot and the inferred types are:</p>
<div class="codehilite"><pre><span></span><code>    (defs
        (patt (type &quot;Str&quot;))
        (patt (type &quot;a -&gt; {} where [a.split_on : a, Str -&gt; _ret]&quot;))
        (patt (type &quot;({}) -&gt; {}&quot;)))
</code></pre></div>
<p>Which look correct, so not sure where the <code>Dec</code> is coming from</p>



<a name="560960337"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/358903-advent%20of%20code/topic/Howto%202025/near/560960337" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jared Ramirez <a href="https://roc-lang.github.io/zulip-export/stream/358903-advent-of-code/topic/Howto.202025.html#560960337">(Nov 30 2025 at 01:51)</a>:</h4>
<p>I also tried a simpler version of just splitting the puzzle text and printing in a for loop:</p>
<div class="codehilite"><pre><span></span><code>app [main!] { pf: platform &quot;./platform/main.roc&quot; }

import pf.Stdout

test_input =
    &quot;&quot;&quot;3   4
    &quot;&quot;&quot;4   3
    &quot;&quot;&quot;2   5
    &quot;&quot;&quot;1   3
    &quot;&quot;&quot;3   9
    &quot;&quot;&quot;3   3

main! = || {
    for line in test_input.split_on(&quot;\n&quot;) {
        Stdout.line!(line)
    }
}
</code></pre></div>
<p>And this errors with:</p>
<div class="codehilite"><pre><span></span><code>└─ ❯ ./zig-out/bin/roc test/aoc2024/one.roc
3   4
thread 143170 panic: Host allocation failed
???:?:?: 0x100494a6f in ??? (roc_run_883903227)
???:?:?: 0x1005d236b in ??? (roc_run_883903227)
???:?:?: 0x10056dc73 in ??? (roc_run_883903227)
???:?:?: 0x100537c3f in ??? (roc_run_883903227)
???:?:?: 0x10053669f in ??? (roc_run_883903227)
???:?:?: 0x10053982f in ??? (roc_run_883903227)
???:?:?: 0x10053dfcf in ??? (roc_run_883903227)
???:?:?: 0x10059559b in ??? (roc_run_883903227)
???:?:?: 0x100549267 in ??? (roc_run_883903227)
???:?:?: 0x1005258e3 in ??? (roc_run_883903227)
???:?:?: 0x1005232ab in ??? (roc_run_883903227)
???:?:?: 0x100522d0f in ??? (roc_run_883903227)
???:?:?: 0x1004947f7 in ??? (roc_run_883903227)
???:?:?: 0x100495103 in ??? (roc_run_883903227)
???:?:?: 0x196425d53 in ??? (???)
???:?:?: 0x0 in ??? (???)
error: Child process /Users/jaredramirez/Library/Caches/roc/080b753687f4b2c24027986b2e400969/temp/roc-tmp-XSwGdYZ8MR0wOSCaEKMX41QAAVAWys37/roc_run_883903227 killed by signal: 6
error: Child process aborted (SIGABRT)
</code></pre></div>



<a name="560960354"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/358903-advent%20of%20code/topic/Howto%202025/near/560960354" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/358903-advent-of-code/topic/Howto.202025.html#560960354">(Nov 30 2025 at 01:51)</a>:</h4>
<p>Multi line string syntax is double backslash</p>



<a name="560960378"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/358903-advent%20of%20code/topic/Howto%202025/near/560960378" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jared Ramirez <a href="https://roc-lang.github.io/zulip-export/stream/358903-advent-of-code/topic/Howto.202025.html#560960378">(Nov 30 2025 at 01:52)</a>:</h4>
<p>(these are with the platform in <code>fx</code> also)</p>



<a name="560960390"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/358903-advent%20of%20code/topic/Howto%202025/near/560960390" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jared Ramirez <a href="https://roc-lang.github.io/zulip-export/stream/358903-advent-of-code/topic/Howto.202025.html#560960390">(Nov 30 2025 at 01:52)</a>:</h4>
<p><span class="user-mention silent" data-user-id="515757">Luke Boswell</span> <a href="#narrow/channel/358903-advent-of-code/topic/Howto.202025/near/560960354">said</a>:</p>
<blockquote>
<p>Multi line string syntax is double backslash</p>
</blockquote>
<p>oh oops! lemme fix that and try again</p>



<a name="560960398"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/358903-advent%20of%20code/topic/Howto%202025/near/560960398" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/358903-advent-of-code/topic/Howto.202025.html#560960398">(Nov 30 2025 at 01:52)</a>:</h4>
<p>Can you try on my PR branch please?</p>



<a name="560960409"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/358903-advent%20of%20code/topic/Howto%202025/near/560960409" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/358903-advent-of-code/topic/Howto.202025.html#560960409">(Nov 30 2025 at 01:53)</a>:</h4>
<p><a href="https://github.com/roc-lang/roc/pull/8505">https://github.com/roc-lang/roc/pull/8505</a></p>



<a name="560960427"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/358903-advent%20of%20code/topic/Howto%202025/near/560960427" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/358903-advent-of-code/topic/Howto.202025.html#560960427">(Nov 30 2025 at 01:53)</a>:</h4>
<p>I've upgraded the fx platform and added lots more instrumentation around allocations</p>



<a name="560960674"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/358903-advent%20of%20code/topic/Howto%202025/near/560960674" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/358903-advent-of-code/topic/Howto.202025.html#560960674">(Nov 30 2025 at 02:00)</a>:</h4>
<p>I'm looking at this issue now</p>



<a name="560960736"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/358903-advent%20of%20code/topic/Howto%202025/near/560960736" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/358903-advent-of-code/topic/Howto.202025.html#560960736">(Nov 30 2025 at 02:01)</a>:</h4>
<p>I noticed a similar issue before, but this is a nice repro I think where we try to make an infinite sized allocation</p>



<a name="560960807"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/358903-advent%20of%20code/topic/Howto%202025/near/560960807" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jared Ramirez <a href="https://roc-lang.github.io/zulip-export/stream/358903-advent-of-code/topic/Howto.202025.html#560960807">(Nov 30 2025 at 02:03)</a>:</h4>
<p>i get the same error on that branch, but it seems that it may have to do with the size of the string being split. </p>
<p>with this input string, it prints each line &amp; exits</p>
<div class="codehilite"><pre><span></span><code>input =
    \\a   x
    \\b   x
    \\c   x
    \\d   x
</code></pre></div>
<p>but with one more row, it fails with <code>Host error: allocation failed, out of memory</code></p>
<div class="codehilite"><pre><span></span><code>input =
    \\a   x
    \\b   x
    \\c   x
    \\d   x
    \\e   x
</code></pre></div>



<a name="560960892"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/358903-advent%20of%20code/topic/Howto%202025/near/560960892" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jared Ramirez <a href="https://roc-lang.github.io/zulip-export/stream/358903-advent-of-code/topic/Howto.202025.html#560960892">(Nov 30 2025 at 02:05)</a>:</h4>
<p>Same error without multiline:</p>
<div class="codehilite"><pre><span></span><code>input = &quot;a   x \nb   x \nc   x \nd   x&quot;
</code></pre></div>
<p>but interestingly, this version is the shorter string, but it still fails</p>



<a name="560961142"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/358903-advent%20of%20code/topic/Howto%202025/near/560961142" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jared Ramirez <a href="https://roc-lang.github.io/zulip-export/stream/358903-advent-of-code/topic/Howto.202025.html#560961142">(Nov 30 2025 at 02:11)</a>:</h4>
<p>Then, possibly related, but maybe not, the program runs no problem with this string:</p>
<div class="codehilite"><pre><span></span><code>input = &quot;aaaaaaaaaaaaaaaaaaaaaaa&quot; # there are 23 &quot;a&quot;s
</code></pre></div>
<p>But with this one</p>
<div class="codehilite"><pre><span></span><code>input = &quot;aaaaaaaaaaaaaaaaaaaaaaaa&quot; # there are 24 &quot;a&quot;s
</code></pre></div>
<p>It prints then segfaults:</p>
<div class="codehilite"><pre><span></span><code>aaaaaaaaaaaaaaaaaaaaaaaa
error: Child process /Users/jaredramirez/Library/Caches/roc/70dead706a5693ea80a872968b332d57/temp/roc-tmp-vkBVgcVhBIIO8OnLfRmSafE27WMwYoRp/roc_run_3325363814 killed by signal: 11
error: Child process crashed with segmentation fault (SIGSEGV)
</code></pre></div>



<a name="560961215"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/358903-advent%20of%20code/topic/Howto%202025/near/560961215" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/358903-advent-of-code/topic/Howto.202025.html#560961215">(Nov 30 2025 at 02:12)</a>:</h4>
<p>From Claude</p>
<blockquote>
<p>I see the issue! Looking at the trace:<br>
  1. DECREF str ptr=0x105660010 len=35 cap=35 - The original test_input string gets decremented<br>
  2. Later INCREF str ptr=0x105660010 len=5 cap=35 - Trying to incref the same string (as a seamless slice)<br>
  3. Finally INCREF str ptr=0x105660010 len=5 cap=5 - cap changed from 35 to 5, indicating memory corruption<br>
  The original string is being DECREF'd before the seamless slices (from split_on) are done using it.</p>
</blockquote>



<a name="560961260"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/358903-advent%20of%20code/topic/Howto%202025/near/560961260" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/358903-advent-of-code/topic/Howto.202025.html#560961260">(Nov 30 2025 at 02:13)</a>:</h4>
<p>I can look at the long string segfault next</p>



<a name="560961814"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/358903-advent%20of%20code/topic/Howto%202025/near/560961814" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/358903-advent-of-code/topic/Howto.202025.html#560961814">(Nov 30 2025 at 02:27)</a>:</h4>
<blockquote>
<p><strong>Found the bug!</strong> The allocation is trying to allocate size=9223372036854775829 bytes, which is 0x8000000000000015 - that's 21 | SEAMLESS_SLICE_BIT!<br>
The issue is in RocStr.clone() - it uses str.length directly instead of str.len(), so for seamless slices it includes the SEAMLESS_SLICE_BIT in the allocation size!</p>
</blockquote>



<a name="560961948"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/358903-advent%20of%20code/topic/Howto%202025/near/560961948" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/358903-advent-of-code/topic/Howto.202025.html#560961948">(Nov 30 2025 at 02:31)</a>:</h4>
<p>That bug was masking another bug too, there's another double decref with the test_input binding</p>



<a name="560962011"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/358903-advent%20of%20code/topic/Howto%202025/near/560962011" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/358903-advent-of-code/topic/Howto.202025.html#560962011">(Nov 30 2025 at 02:33)</a>:</h4>
<p><span class="user-mention" data-user-id="343810">@Brendan Hansknecht</span> <span class="user-mention" data-user-id="281383">@Richard Feldman</span>     in a method call like <code>test_input.split_on(...)</code> we should just be incrementing the refcount on the string right?</p>



<a name="560962055"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/358903-advent%20of%20code/topic/Howto%202025/near/560962055" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/358903-advent-of-code/topic/Howto.202025.html#560962055">(Nov 30 2025 at 02:34)</a>:</h4>
<p>Anyway, I've got a solid fix for these issues now</p>



<a name="560962165"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/358903-advent%20of%20code/topic/Howto%202025/near/560962165" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/358903-advent-of-code/topic/Howto.202025.html#560962165">(Nov 30 2025 at 02:36)</a>:</h4>
<p>I'm a little concerned we might be cloning unnecessarily though so just investigating a little more.</p>



<a name="560962445"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/358903-advent%20of%20code/topic/Howto%202025/near/560962445" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/358903-advent-of-code/topic/Howto.202025.html#560962445">(Nov 30 2025 at 02:43)</a>:</h4>
<p>Ok, all fixed without any cloning in <a href="https://github.com/roc-lang/roc/pull/8505">https://github.com/roc-lang/roc/pull/8505</a></p>



<a name="560963890"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/358903-advent%20of%20code/topic/Howto%202025/near/560963890" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/358903-advent-of-code/topic/Howto.202025.html#560963890">(Nov 30 2025 at 03:20)</a>:</h4>
<p>For split_on, I would expect to:</p>
<ol>
<li>Count the number of splits (n)</li>
<li>Incref the main string n time</li>
<li>Create a list of size n</li>
<li>Put n seamless slices in the list</li>
</ol>



<a name="560963899"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/358903-advent%20of%20code/topic/Howto%202025/near/560963899" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/358903-advent-of-code/topic/Howto.202025.html#560963899">(Nov 30 2025 at 03:20)</a>:</h4>
<p>Oh wait, does split on only split once or many times?</p>



<a name="560963979"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/358903-advent%20of%20code/topic/Howto%202025/near/560963979" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/358903-advent-of-code/topic/Howto.202025.html#560963979">(Nov 30 2025 at 03:22)</a>:</h4>
<p>I think many times</p>



<a name="560978085"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/358903-advent%20of%20code/topic/Howto%202025/near/560978085" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Astating <a href="https://roc-lang.github.io/zulip-export/stream/358903-advent-of-code/topic/Howto.202025.html#560978085">(Nov 30 2025 at 07:45)</a>:</h4>
<p>Hello, I don't have the time to make a minimal repro until this evening (european) but here's a small working program (Robot Simulator from Exercism : <a href="https://exercism.org/tracks/roc/exercises/robot-simulator">https://exercism.org/tracks/roc/exercises/robot-simulator</a>) with a list of problems I ran into :</p>
<div class="codehilite" data-code-language="Ruby"><pre><span></span><code><span class="n">app</span><span class="w"> </span><span class="o">[</span><span class="n">main!</span><span class="o">]</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="ss">pf</span><span class="p">:</span><span class="w"> </span><span class="n">platform</span><span class="w"> </span><span class="s2">"./platform/main.roc"</span><span class="w"> </span><span class="p">}</span>

<span class="n">import</span><span class="w"> </span><span class="n">pf</span><span class="o">.</span><span class="n">Stdout</span>
<span class="n">import</span><span class="w"> </span><span class="n">pf</span><span class="o">.</span><span class="n">Stderr</span>

<span class="no">Direction</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="o">[</span><span class="no">North</span><span class="p">,</span><span class="w"> </span><span class="no">East</span><span class="p">,</span><span class="w"> </span><span class="no">South</span><span class="p">,</span><span class="w"> </span><span class="no">West</span><span class="o">]</span>
<span class="no">Robot</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="no">Dec</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="no">Dec</span><span class="p">,</span><span class="w"> </span><span class="n">direction</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="no">Direction</span><span class="w"> </span><span class="p">}</span>

<span class="n">move</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="no">Robot</span><span class="p">,</span><span class="w"> </span><span class="no">Str</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="no">Robot</span>
<span class="n">move</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">|</span><span class="n">robot</span><span class="p">,</span><span class="w"> </span><span class="n">instructions</span><span class="o">|</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="no">Str</span><span class="o">.</span><span class="n">to_utf8</span><span class="p">(</span><span class="n">instructions</span><span class="p">)</span>
<span class="w">        </span><span class="o">.</span><span class="n">fold</span><span class="p">(</span>
<span class="w">            </span><span class="n">robot</span><span class="p">,</span>
<span class="w">            </span><span class="o">|</span><span class="n">robot_state</span><span class="p">,</span><span class="w"> </span><span class="n">robot_move</span><span class="o">|</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">match</span><span class="w"> </span><span class="p">(</span><span class="n">robot_move</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="s1">'A'</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">robot_state</span><span class="o">-&gt;</span><span class="n">advance</span><span class="p">()</span>
<span class="w">                    </span><span class="s1">'L'</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">robot_state</span><span class="o">-&gt;</span><span class="n">turn</span><span class="p">(</span><span class="no">Left</span><span class="p">)</span>
<span class="w">                    </span><span class="s1">'R'</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">robot_state</span><span class="o">-&gt;</span><span class="n">turn</span><span class="p">(</span><span class="no">Right</span><span class="p">)</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">            </span><span class="p">},</span>
<span class="w">        </span><span class="p">)</span>
<span class="p">}</span>

<span class="n">advance</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">|</span><span class="n">robot</span><span class="o">|</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">match</span><span class="w"> </span><span class="p">(</span><span class="n">robot</span><span class="o">.</span><span class="n">direction</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="no">North</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="o">..</span><span class="n">robot</span><span class="p">,</span><span class="w"> </span><span class="ss">y</span><span class="p">:</span><span class="w"> </span><span class="n">robot</span><span class="o">.</span><span class="n">y</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">}</span>
<span class="w">        </span><span class="no">South</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="o">..</span><span class="n">robot</span><span class="p">,</span><span class="w"> </span><span class="ss">y</span><span class="p">:</span><span class="w"> </span><span class="n">robot</span><span class="o">.</span><span class="n">y</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">}</span>
<span class="w">        </span><span class="no">East</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="o">..</span><span class="n">robot</span><span class="p">,</span><span class="w"> </span><span class="ss">x</span><span class="p">:</span><span class="w"> </span><span class="n">robot</span><span class="o">.</span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">}</span>
<span class="w">        </span><span class="no">West</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="o">..</span><span class="n">robot</span><span class="p">,</span><span class="w"> </span><span class="ss">x</span><span class="p">:</span><span class="w"> </span><span class="n">robot</span><span class="o">.</span><span class="n">x</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="n">turn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">|</span><span class="n">robot</span><span class="p">,</span><span class="w"> </span><span class="n">left_or_right</span><span class="o">|</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">match</span><span class="w"> </span><span class="p">((</span><span class="n">robot</span><span class="o">.</span><span class="n">direction</span><span class="p">,</span><span class="w"> </span><span class="n">left_or_right</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="p">(</span><span class="no">North</span><span class="p">,</span><span class="w"> </span><span class="no">Left</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="o">..</span><span class="n">robot</span><span class="p">,</span><span class="w"> </span><span class="ss">direction</span><span class="p">:</span><span class="w"> </span><span class="no">West</span><span class="w"> </span><span class="p">}</span>
<span class="w">        </span><span class="p">(</span><span class="no">North</span><span class="p">,</span><span class="w"> </span><span class="no">Right</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="o">..</span><span class="n">robot</span><span class="p">,</span><span class="w"> </span><span class="ss">direction</span><span class="p">:</span><span class="w"> </span><span class="no">East</span><span class="w"> </span><span class="p">}</span>

<span class="w">        </span><span class="p">(</span><span class="no">East</span><span class="p">,</span><span class="w"> </span><span class="no">Left</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="o">..</span><span class="n">robot</span><span class="p">,</span><span class="w"> </span><span class="ss">direction</span><span class="p">:</span><span class="w"> </span><span class="no">North</span><span class="w"> </span><span class="p">}</span>
<span class="w">        </span><span class="p">(</span><span class="no">East</span><span class="p">,</span><span class="w"> </span><span class="no">Right</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="o">..</span><span class="n">robot</span><span class="p">,</span><span class="w"> </span><span class="ss">direction</span><span class="p">:</span><span class="w"> </span><span class="no">South</span><span class="w"> </span><span class="p">}</span>

<span class="w">        </span><span class="p">(</span><span class="no">South</span><span class="p">,</span><span class="w"> </span><span class="no">Left</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="o">..</span><span class="n">robot</span><span class="p">,</span><span class="w"> </span><span class="ss">direction</span><span class="p">:</span><span class="w"> </span><span class="no">East</span><span class="w"> </span><span class="p">}</span>
<span class="w">        </span><span class="p">(</span><span class="no">South</span><span class="p">,</span><span class="w"> </span><span class="no">Right</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="o">..</span><span class="n">robot</span><span class="p">,</span><span class="w"> </span><span class="ss">direction</span><span class="p">:</span><span class="w"> </span><span class="no">West</span><span class="w"> </span><span class="p">}</span>

<span class="w">        </span><span class="p">(</span><span class="no">West</span><span class="p">,</span><span class="w"> </span><span class="no">Left</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="o">..</span><span class="n">robot</span><span class="p">,</span><span class="w"> </span><span class="ss">direction</span><span class="p">:</span><span class="w"> </span><span class="no">South</span><span class="w"> </span><span class="p">}</span>
<span class="w">        </span><span class="p">(</span><span class="no">West</span><span class="p">,</span><span class="w"> </span><span class="no">Right</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="o">..</span><span class="n">robot</span><span class="p">,</span><span class="w"> </span><span class="ss">direction</span><span class="p">:</span><span class="w"> </span><span class="no">North</span><span class="w"> </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="n">main!</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">dbg</span><span class="w"> </span><span class="n">move</span><span class="p">({</span><span class="w"> </span><span class="ss">x</span><span class="p">:</span><span class="w"> </span><span class="mi">7</span><span class="p">,</span><span class="w"> </span><span class="ss">y</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="ss">direction</span><span class="p">:</span><span class="w"> </span><span class="no">North</span><span class="w"> </span><span class="p">},</span><span class="w"> </span><span class="s2">"RAALAL"</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>
<p>Well first, I'm not parsing the instructions string : so I should get an unexhaustive match error. But I don't.</p>
<p>If you replace <code>Str.to_utf8(instructions)</code> by <code>instructions.to_utf8()</code> : you get an error =&gt; <code>Roc crashed: str_to_utf8 requires return type info</code></p>
<p>If you replace <code>Dec</code> by <code>I64</code>, you get an error =&gt;</p>
<div class="codehilite"><pre><span></span><code>thread 111198 panic: access of union field &#39;int&#39; while field &#39;dec&#39; is active
/home/user/roc/src/eval/interpreter.zig:1992:55: 0x5c9ae8 in callLowLevelBuiltin (mod.zig)
                    .int =&gt; |l| try out.setInt(l + rhs.int),
                                                      ^
/home/user/roc/src/eval/interpreter.zig:10153:62: 0x621767 in applyContinuation (mod.zig)
                    var result = try self.callLowLevelBuiltin(low_level.op, &amp;args, roc_ops, null);
                                                             ^
/home/user/roc/src/eval/interpreter.zig:6769:71: 0x418440 in evalWithExpectedType (mod.zig)
                    const should_continue = try self.applyContinuation(&amp;work_stack, &amp;value_stack, cont, roc_ops);
                                                                      ^
/home/user/roc/src/eval/interpreter.zig:464:59: 0x3bf1f7 in evaluateExpression (mod.zig)
            const result_value = self.evalWithExpectedType(header.body_idx, roc_ops, null) catch |err| {
                                                          ^
/home/user/roc/src/interpreter_shim/main.zig:169:39: 0x3a0c55 in evaluateFromSharedMemory (main.zig)
    try interpreter.evaluateExpression(expr_idx, ret_ptr, roc_ops, arg_ptr);
                                      ^
/home/user/roc/src/interpreter_shim/main.zig:68:29: 0x3a000e in roc_entrypoint (main.zig)
    evaluateFromSharedMemory(entry_idx, ops, ret_ptr, arg_ptr) catch |err| {
                            ^
/home/user/roc/test/fx/platform/host.zig:202:23: 0x27c57f in platform_main (host.zig)
    roc__main_for_host(&amp;roc_ops, @as(*anyopaque, @ptrCast(&amp;ret)), @as(*anyopaque, @ptrCast(&amp;args)));
                      ^
/home/user/roc/test/fx/platform/host.zig:85:18: 0x27c708 in main (host.zig)
    platform_main() catch |err| {
                 ^
src/env/__libc_start_main.c:95:2: 0x95907c in libc_start_main_stage2 (src/env/__libc_start_main.c)
Unwind error at address `exe:0x95907c` (error.MissingFDE), trace may be incomplete

???:?:?: 0x0 in ??? (???)
error: Child process /home/user/.cache/roc/f5270dd847a7a6c61bb1e95f0925684e/temp/roc-tmp-gWEfXWyUa3joiowSwIiGq8mgzL880aKs/roc_run_3406543992 killed by signal: 6
error: Child process aborted (SIGABRT)
</code></pre></div>
<p>Also, not an error but a question : what's the replacement of record optional fields, I forgot ?</p>
<p>Thanks, amazing work !</p>



<a name="561019906"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/358903-advent%20of%20code/topic/Howto%202025/near/561019906" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/358903-advent-of-code/topic/Howto.202025.html#561019906">(Nov 30 2025 at 18:10)</a>:</h4>
<p>I can address part of this, although we don't yet have exhaustiveness checking implemented yet, and realistically won't have it in time for Advent of Code <span aria-label="smile" class="emoji emoji-1f604" role="img" title="smile">:smile:</span></p>



<a name="561021253"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/358903-advent%20of%20code/topic/Howto%202025/near/561021253" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/358903-advent-of-code/topic/Howto.202025.html#561021253">(Nov 30 2025 at 18:30)</a>:</h4>
<p>fix for the <code>instructions.to_utf8()</code> part: <a href="https://github.com/roc-lang/roc/pull/8514">https://github.com/roc-lang/roc/pull/8514</a></p>



<a name="561021537"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/358903-advent%20of%20code/topic/Howto%202025/near/561021537" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> ducdetronquitp <a href="https://roc-lang.github.io/zulip-export/stream/358903-advent-of-code/topic/Howto.202025.html#561021537">(Nov 30 2025 at 18:34)</a>:</h4>
<p>Hello !</p>
<p>I stumbled upon <a href="https://gist.github.com/rtfeldman/f46bcbfe5132d62c4095dfa687bb9aa4">Roc's New Compiler for Advent of Code 2025</a> today but  I cannot get the hello world snippet to compile because of a segfault.</p>
<p>I'm using Ubuntu 24.04.3 (x86_64), I downloaded <a href="https://github.com/roc-lang/nightlies/releases/tag/nightly-2025-November-30-77e8bbc">the nightly build of today</a> and here is the output:</p>
<div class="codehilite"><pre><span></span><code>❯ ./roc version
Roc compiler version release-fast-77e8bbc1

❯ ./roc app.roc
error: Child process /home/.cache/roc/eeb72bc7915352738b41dafe7bc88401/temp/roc-tmp-2ec6QLmttmiRNiAvuG7tvzbfwtzEQqBA/roc_run_1662736024 killed by signal: 11
error: Child process crashed with segmentation fault (SIGSEGV)

❯ cat /home/.cache/roc/eeb72bc7915352738b41dafe7bc88401/temp/roc-tmp-2ec6QLmttmiRNiAvuG7tvzbfwtzEQqBA/roc_run_1662736024
ELF&gt;@8@8@@@ @ �  Q�tdzRx
                       Linker: LLD 20.1.2 (https://github.com/roc-lang/roc-bootstrap fe08b059a848f15dc43b2f23e2c0a500360356c9)����(��.eh_frame.comment.symtab.shstrtab.strtabroc_platform_shimroc_interpreter_shimcompiler_rt� �
                                                               0hp�.&amp;�4
</code></pre></div>
<p>I would love to give more detail about the error but I don't know how to right now ^^</p>
<p>Any ideas ?</p>
<p>Have a nice day !</p>



<a name="561023210"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/358903-advent%20of%20code/topic/Howto%202025/near/561023210" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/358903-advent-of-code/topic/Howto.202025.html#561023210">(Nov 30 2025 at 19:00)</a>:</h4>
<p>Can you try again with latest main? I think that error is fixed now. So <code>zig build roc</code>, <code>./zig-out/bin/roc app.roc</code></p>



<a name="561023828"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/358903-advent%20of%20code/topic/Howto%202025/near/561023828" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Niclas Ahden <a href="https://roc-lang.github.io/zulip-export/stream/358903-advent-of-code/topic/Howto.202025.html#561023828">(Nov 30 2025 at 19:05)</a>:</h4>
<p>I tried the same on latest <code>main</code> (<code>6a1585d9132bd14360f0475eabe0d6e99a03157f</code>) and get:</p>
<div class="codehilite"><pre><span></span><code>./zig-out/bin/roc test/fx/appc.roc
error: Child process /home/niclas/.cache/roc/8c41db55289d8fdb9fc8557b96c7b123/temp/roc-tmp-ufrkqUSBk3CqRzmIeoPi7r1rrr5sFltU/roc_run_349899816 killed by signal: 11
error: Child process crashed with segmentation fault (SIGSEGV)
</code></pre></div>
<p>The Hello World is from here: <a href="https://gist.github.com/rtfeldman/f46bcbfe5132d62c4095dfa687bb9aa4">https://gist.github.com/rtfeldman/f46bcbfe5132d62c4095dfa687bb9aa4</a></p>
<div class="codehilite" data-code-language="Ruby"><pre><span></span><code><span class="n">app</span><span class="w"> </span><span class="o">[</span><span class="n">main!</span><span class="o">]</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="ss">pf</span><span class="p">:</span><span class="w"> </span><span class="n">platform</span><span class="w"> </span><span class="s2">"https://github.com/lukewilliamboswell/roc-platform-template-zig/releases/download/0.1-test/7iDKk44no3gF9Nrh2VyF8Y5yvy1jUBhrbhHURN1WQptB.tar.zst"</span><span class="w"> </span><span class="p">}</span>

<span class="n">import</span><span class="w"> </span><span class="n">pf</span><span class="o">.</span><span class="n">Stdout</span>

<span class="n">main!</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">|</span><span class="n">_args</span><span class="o">|</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="no">Stdout</span><span class="o">.</span><span class="n">line!</span><span class="p">(</span><span class="s2">"Hello, World!"</span><span class="p">)</span>
<span class="w">    </span><span class="no">Ok</span><span class="p">({})</span>
<span class="p">}</span>
</code></pre></div>
<p><del>It's not just that snippet though, I get the same result with <code>test/fx/app.roc</code>.</del></p>
<p>NixOS x86, ran <code>git clean -dfx</code> before building.</p>



<a name="561025123"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/358903-advent%20of%20code/topic/Howto%202025/near/561025123" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/358903-advent-of-code/topic/Howto.202025.html#561025123">(Nov 30 2025 at 19:24)</a>:</h4>
<p>Might be worth clearing the cached app as well in case it is bugged: <code>rm -rf /home/niclas/.cache/roc/8c41db55289d8fdb9fc8557b96c7b123</code></p>



<a name="561025175"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/358903-advent%20of%20code/topic/Howto%202025/near/561025175" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Niclas Ahden <a href="https://roc-lang.github.io/zulip-export/stream/358903-advent-of-code/topic/Howto.202025.html#561025175">(Nov 30 2025 at 19:24)</a>:</h4>
<p>I deleted the whole cache (<code>rm -rf /home/niclas/.cache/roc</code>) and re-ran with the same result</p>



<a name="561025634"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/358903-advent%20of%20code/topic/Howto%202025/near/561025634" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Niclas Ahden <a href="https://roc-lang.github.io/zulip-export/stream/358903-advent-of-code/topic/Howto.202025.html#561025634">(Nov 30 2025 at 19:31)</a>:</h4>
<p>After clearing the Roc cache (and <code>git clean -dfx</code> again for good measure) I no longer segfault when running the built-in example, <code>./zig-out/bin/roc test/fx/app.roc </code>. Now I get:</p>
<div class="codehilite"><pre><span></span><code>error: Failed to resolve platform spec &#39;./platform/main.roc&#39;: error.PlatformNotSupported
</code></pre></div>
<p>But the hello world snippet still gives:</p>
<div class="codehilite"><pre><span></span><code>./zig-out/bin/roc test/fx/appc.roc
error: Child process /home/niclas/.cache/roc/8c41db55289d8fdb9fc8557b96c7b123/temp/roc-tmp-8ME9qm3IFOEZKp2Fc77x6gEUOLIe31E5/roc_run_349899816 killed by signal: 11
error: Child process crashed with segmentation fault (SIGSEGV)
</code></pre></div>



<a name="561029643"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/358903-advent%20of%20code/topic/Howto%202025/near/561029643" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> ducdetronquitp <a href="https://roc-lang.github.io/zulip-export/stream/358903-advent-of-code/topic/Howto.202025.html#561029643">(Nov 30 2025 at 20:29)</a>:</h4>
<p><span class="user-mention silent" data-user-id="361169">Anton</span> <a href="#narrow/channel/358903-advent-of-code/topic/Howto.202025/near/561023210">said</a>:</p>
<blockquote>
<p>Can you try again with latest main? I think that error is fixed now. So <code>zig build roc</code>, <code>./zig-out/bin/roc app.roc</code></p>
</blockquote>
<p>Hey Anton,</p>
<p>Thanks for the answer !</p>
<p>I built the main branch of roc with zig 0.15.2 and the hello world snippet still segfault:</p>
<div class="codehilite"><pre><span></span><code>❯ ./roc/zig-out/bin/roc version
Roc compiler version debug-6a1585d9

~/tools
❯ ./roc/zig-out/bin/roc app.roc
error: Child process /home/.cache/roc/8c41db55289d8fdb9fc8557b96c7b123/temp/roc-tmp-VSWr14wnLgGfgOewpkXp506M6pHXJBSu/roc_run_1662736024 killed by signal: 11
error: Child process crashed with segmentation fault (SIGSEGV)
</code></pre></div>
<p>If it helps, I send the resulting executable as attachment: it's way larger than my previous attempt.<br>
<a href="/user_uploads/22008/UOGOVxEx0kFwkQOSsUbMgbbw/roc_run_1662736024">roc_run_1662736024</a></p>



<a name="561154908"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/358903-advent%20of%20code/topic/Howto%202025/near/561154908" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> walther <a href="https://roc-lang.github.io/zulip-export/stream/358903-advent-of-code/topic/Howto.202025.html#561154908">(Dec 01 2025 at 13:12)</a>:</h4>
<p>I'm on linux x86_64 and getting a segfault also with the hello world snippet from the gist</p>
<ul>
<li>using the zig template platform</li>
<li>built compiler from src, <code>Roc compiler version debug-5e229e20</code></li>
</ul>
<p>I believe I also tried using the fx platform at some time in the past and got a similar </p>
<div class="codehilite"><pre><span></span><code>error: Failed to resolve platform spec &#39;./platform/main.roc&#39;: error.PlatformNotSupported
</code></pre></div>
<p>as above, also.</p>



<a name="561182261"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/358903-advent%20of%20code/topic/Howto%202025/near/561182261" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> walther <a href="https://roc-lang.github.io/zulip-export/stream/358903-advent-of-code/topic/Howto.202025.html#561182261">(Dec 01 2025 at 14:52)</a>:</h4>
<p>I've done some mucking around with the zig template platform, but was unable to get it to work (still sigsev). But, I was able to get the fx platform to work. Which I think is enough to do the experimenting I want to do right now.</p>



<a name="561206660"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/358903-advent%20of%20code/topic/Howto%202025/near/561206660" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/358903-advent-of-code/topic/Howto.202025.html#561206660">(Dec 01 2025 at 16:14)</a>:</h4>
<p><span class="user-mention silent" data-user-id="524503">Niclas Ahden</span> <a href="#narrow/channel/358903-advent-of-code/topic/Howto.202025/near/561023828">said</a>:</p>
<blockquote>
<p>I tried the same on latest <code>main</code> (<code>6a1585d9132bd14360f0475eabe0d6e99a03157f</code>) and get:</p>
<div class="codehilite"><pre><span></span><code>./zig-out/bin/roc test/fx/appc.roc
error: Child process /home/niclas/.cache/roc/8c41db55289d8fdb9fc8557b96c7b123/temp/roc-tmp-ufrkqUSBk3CqRzmIeoPi7r1rrr5sFltU/roc_run_349899816 killed by signal: 11
error: Child process crashed with segmentation fault (SIGSEGV)
</code></pre></div>
<p>The Hello World is from here: <a href="https://gist.github.com/rtfeldman/f46bcbfe5132d62c4095dfa687bb9aa4">https://gist.github.com/rtfeldman/f46bcbfe5132d62c4095dfa687bb9aa4</a></p>
<div class="codehilite" data-code-language="Ruby"><pre><span></span><code><span class="n">app</span><span class="w"> </span><span class="o">[</span><span class="n">main!</span><span class="o">]</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="ss">pf</span><span class="p">:</span><span class="w"> </span><span class="n">platform</span><span class="w"> </span><span class="s2">"https://github.com/lukewilliamboswell/roc-platform-template-zig/releases/download/0.1-test/7iDKk44no3gF9Nrh2VyF8Y5yvy1jUBhrbhHURN1WQptB.tar.zst"</span><span class="w"> </span><span class="p">}</span>

<span class="n">import</span><span class="w"> </span><span class="n">pf</span><span class="o">.</span><span class="n">Stdout</span>

<span class="n">main!</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">|</span><span class="n">_args</span><span class="o">|</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="no">Stdout</span><span class="o">.</span><span class="n">line!</span><span class="p">(</span><span class="s2">"Hello, World!"</span><span class="p">)</span>
<span class="w">    </span><span class="no">Ok</span><span class="p">({})</span>
<span class="p">}</span>
</code></pre></div>
<p><del>It's not just that snippet though, I get the same result with <code>test/fx/app.roc</code>.</del></p>
<p>NixOS x86, ran <code>git clean -dfx</code> before building.</p>
</blockquote>
<p>I was able to reproduce this</p>



<a name="561209118"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/358903-advent%20of%20code/topic/Howto%202025/near/561209118" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Niclas Ahden <a href="https://roc-lang.github.io/zulip-export/stream/358903-advent-of-code/topic/Howto.202025.html#561209118">(Dec 01 2025 at 16:23)</a>:</h4>
<p>I reproduced both issues on the latest commit (<code>2ac12ee62127e86e54efba4942b063719add7585</code>):</p>
<div class="codehilite"><pre><span></span><code>$ zig build roc
Cleared roc cache at /home/niclas/.cache/roc
$ ./zig-out/bin/roc test/fx/app.roc
error: Failed to resolve platform spec &#39;./platform/main.roc&#39;: error.PlatformNotSupported

# Paste the Hello World snippet into appc.roc
$ v test/fx/appc.roc
$ ./zig-out/bin/roc test/fx/appc.roc
error: Child process /home/niclas/.cache/roc/098d65273b3e7fea486849c277601edd/temp/roc-tmp-ed0z1y0nLSGpmXqLhaHQ1DDSLnhYbU8R/roc_run_349899816 killed by signal: 11
error: Child process crashed with segmentation fault (SIGSEGV)
</code></pre></div>



<a name="561211145"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/358903-advent%20of%20code/topic/Howto%202025/near/561211145" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/358903-advent-of-code/topic/Howto.202025.html#561211145">(Dec 01 2025 at 16:28)</a>:</h4>
<p>it would be great to get some ci around this, since we seem to have had it working and then redressed it without a CI failure letting us know <span aria-label="smile" class="emoji emoji-1f604" role="img" title="smile">:smile:</span></p>



<a name="561211653"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/358903-advent%20of%20code/topic/Howto%202025/near/561211653" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/358903-advent-of-code/topic/Howto.202025.html#561211653">(Dec 01 2025 at 16:30)</a>:</h4>
<p>Yeah, I'll get on that</p>



<a name="561211744"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/358903-advent%20of%20code/topic/Howto%202025/near/561211744" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/358903-advent-of-code/topic/Howto.202025.html#561211744">(Dec 01 2025 at 16:30)</a>:</h4>
<p><span class="user-mention" data-user-id="524503">@Niclas Ahden</span>, does your appc.roc still contain the platform url?</p>



<a name="561211965"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/358903-advent%20of%20code/topic/Howto%202025/near/561211965" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Niclas Ahden <a href="https://roc-lang.github.io/zulip-export/stream/358903-advent-of-code/topic/Howto.202025.html#561211965">(Dec 01 2025 at 16:31)</a>:</h4>
<p>Yes, exactly the text in the reply you quoted</p>



<a name="561213484"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/358903-advent%20of%20code/topic/Howto%202025/near/561213484" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/358903-advent-of-code/topic/Howto.202025.html#561213484">(Dec 01 2025 at 16:36)</a>:</h4>
<p>As a temporary workaround; please work inside the repo with the test/fx platform there, but run <code>zig build test</code> first.<br>
You can modify the app.roc here and then run it with ./zig-out/bin/roc app.roc<br>
<a href="https://github.com/roc-lang/roc/blob/2ac12ee62127e86e54efba4942b063719add7585/test/fx/app.roc#L1">https://github.com/roc-lang/roc/blob/2ac12ee62127e86e54efba4942b063719add7585/test/fx/app.roc#L1</a></p>



<a name="561214232"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/358903-advent%20of%20code/topic/Howto%202025/near/561214232" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Niclas Ahden <a href="https://roc-lang.github.io/zulip-export/stream/358903-advent-of-code/topic/Howto.202025.html#561214232">(Dec 01 2025 at 16:39)</a>:</h4>
<p>Confirming that running <code>zig build test</code> did solve the <code>PlatformNotSupported</code> issue. I can now:</p>
<div class="codehilite"><pre><span></span><code>./zig-out/bin/roc test/fx/app.roc
Hello from stdout!
Line 1 to stdout
Line 2 to stderr
Line 3 to stdout
Error from stderr!
</code></pre></div>
<p>(the Hello World example (<code>appc.roc</code>) still segfaults)</p>



<a name="561283244"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/358903-advent%20of%20code/topic/Howto%202025/near/561283244" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/358903-advent-of-code/topic/Howto.202025.html#561283244">(Dec 01 2025 at 21:56)</a>:</h4>
<p><span class="user-mention silent" data-user-id="524503">Niclas Ahden</span> <a href="#narrow/channel/358903-advent-of-code/topic/Howto.202025/near/561209118">said</a>:</p>
<blockquote>
<p>I reproduced both issues on the latest commit (<code>2ac12ee62127e86e54efba4942b063719add7585</code>):</p>
<p><div class="codehilite"><pre><span></span><code>$ zig build roc
Cleared roc cache at /home/niclas/.cache/roc
$ ./zig-out/bin/roc test/fx/app.roc
error: Failed to resolve platform spec &#39;./platform/main.roc&#39;: error.PlatformNotSupported

# Paste the Hello World snippet into appc.roc
$ v test/fx/appc.roc
$ ./zig-out/bin/roc test/fx/appc.roc
error: Child process /home/niclas/.cache/roc/098d65273b3e7fea486849c277601edd/temp/roc-tmp-ed0z1y0nLSGpmXqLhaHQ1DDSLnhYbU8R/roc_run_349899816 killed by signal: 11
error: Child process crashed with segmentation fault (SIGSEGV)
</code></pre></div><br>
</p>
</blockquote>
<p>This is a hard one, I have a good guess what's going wrong, will continue tomorrow...</p>



<a name="561450269"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/358903-advent%20of%20code/topic/Howto%202025/near/561450269" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/358903-advent-of-code/topic/Howto.202025.html#561450269">(Dec 02 2025 at 15:45)</a>:</h4>
<p>I solved the core issue in <a href="https://github.com/lukewilliamboswell/roc-platform-template-zig/pull/13">https://github.com/lukewilliamboswell/roc-platform-template-zig/pull/13</a>, still trying to fix a memory leak in examples/echo.roc</p>



<hr><p>Last updated: Mar 01 2026 at 12:20 UTC</p>
</html>