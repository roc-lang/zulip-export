<html>
<head><meta charset="utf-8"><title>2023 Day 3 · advent of code · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://roc-lang.github.io/zulip-export/stream/358903-advent-of-code/index.html">advent of code</a></h2>
<h3>Topic: <a href="https://roc-lang.github.io/zulip-export/stream/358903-advent-of-code/topic/2023.20Day.203.html">2023 Day 3</a></h3>

<hr>

<base href="https://roc.zulipchat.com">

<head><link href="https://roc-lang.github.io/zulip-export/style.css" rel="stylesheet"></head>

<a name="405610008"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/358903-advent%20of%20code/topic/2023%20Day%203/near/405610008" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Murray <a href="https://roc-lang.github.io/zulip-export/stream/358903-advent-of-code/topic/2023.20Day.203.html#405610008">(Dec 03 2023 at 06:26)</a>:</h4>
<p>I'm not done yet but the <a href="#narrow/stream/304902-show-and-tell/topic/Array2D.20package.20updated.20for.20AoC/near/404961424">array 2d lib</a> by <span class="user-mention" data-user-id="586417">@Elias Mulhall</span>  is soo nice</p>



<a name="405611607"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/358903-advent%20of%20code/topic/2023%20Day%203/near/405611607" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ayaz Hafiz <a href="https://roc-lang.github.io/zulip-export/stream/358903-advent-of-code/topic/2023.20Day.203.html#405611607">(Dec 03 2023 at 06:50)</a>:</h4>
<div class="spoiler-block"><div class="spoiler-header">
<p>My solution</p>
</div><div class="spoiler-content" aria-hidden="true">
<div class="codehilite" data-code-language="Elm"><pre><span></span><code><span class="nv">app</span><span class="w"> </span><span class="s">"AoC"</span>
<span class="w">    </span><span class="nv">packages</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nv">pf</span><span class="nf">:</span><span class="w"> </span><span class="s">"https://github.com/roc-lang/basic-cli/releases/download/0.7.0/bkGby8jb0tmZYsy2hg1E_B2QrCgcSTxdUlHtETwm5m4.tar.br"</span><span class="p">,</span>
<span class="w">        </span><span class="nv">parser</span><span class="nf">:</span><span class="w"> </span><span class="s">"https://github.com/lukewilliamboswell/roc-parser/releases/download/0.2.0/dJQSsSmorujhiPNIvJKlQoI92RFIG_JQwUfIxZsCSwE.tar.br"</span><span class="p">,</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="nv">imports</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="nv">pf</span><span class="nf">.</span><span class="kt">Stdout</span><span class="p">,</span>
<span class="w">        </span><span class="nv">pf</span><span class="nf">.</span><span class="kt">Task</span><span class="nf">.</span><span class="p">{</span><span class="w"> </span><span class="kt">Task</span><span class="w"> </span><span class="p">},</span>
<span class="w">        </span><span class="nv">parser</span><span class="nf">.</span><span class="kt">Core</span><span class="nf">.</span><span class="p">{</span>
<span class="w">            </span><span class="kt">Parser</span><span class="p">,</span>
<span class="w">            </span><span class="nv">const</span><span class="p">,</span>
<span class="w">            </span><span class="nv">keep</span><span class="p">,</span>
<span class="w">            </span><span class="nv">skip</span><span class="p">,</span>
<span class="w">            </span><span class="nv">many</span><span class="p">,</span>
<span class="w">            </span><span class="nv">oneOf</span><span class="p">,</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="nv">parser</span><span class="nf">.</span><span class="kt">String</span><span class="nf">.</span><span class="p">{</span>
<span class="w">            </span><span class="nv">digit</span><span class="p">,</span>
<span class="w">            </span><span class="nv">string</span><span class="p">,</span>
<span class="w">            </span><span class="nv">parseStr</span><span class="p">,</span>
<span class="w">            </span><span class="nv">anyCodeunit</span><span class="p">,</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="s">"day-3-input.txt"</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="nv">input</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Str</span><span class="p">,</span>
<span class="w">    </span><span class="p">]</span>
<span class="w">    </span><span class="nv">provides</span><span class="w"> </span><span class="p">[</span><span class="nv">main</span><span class="p">]</span><span class="w"> </span><span class="nv">to</span><span class="w"> </span><span class="nv">pf</span>

<span class="kr">main </span><span class="nf">:</span><span class="w"> </span><span class="kt">Task</span><span class="w"> </span><span class="p">{}</span><span class="w"> </span><span class="nf">*</span>
<span class="kr">main </span><span class="nf">=</span>
<span class="w">    </span><span class="kt">Stdout</span><span class="nf">.</span><span class="nv">line</span><span class="w"> </span><span class="nv">part1</span>
<span class="w">    </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">Task</span><span class="nf">.</span><span class="nv">await</span><span class="w"> </span><span class="nf">\</span><span class="nv">_</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Stdout</span><span class="nf">.</span><span class="nv">line</span><span class="w"> </span><span class="nv">part2</span>

<span class="nv">part1</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Str</span>
<span class="nv">part1</span><span class="w"> </span><span class="nf">=</span>
<span class="w">    </span><span class="p">(</span><span class="nv">schematic</span><span class="p">,</span><span class="w"> </span><span class="nv">potentialParts</span><span class="p">)</span><span class="w"> </span><span class="nf">=</span>
<span class="w">        </span><span class="nv">input</span>
<span class="w">        </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">Str</span><span class="nf">.</span><span class="nv">split</span><span class="w"> </span><span class="s">"</span><span class="se">\n</span><span class="s">"</span>
<span class="w">        </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">List</span><span class="nf">.</span><span class="nv">dropIf</span><span class="w"> </span><span class="kt">Str</span><span class="nf">.</span><span class="nv">isEmpty</span>
<span class="w">        </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">List</span><span class="nf">.</span><span class="nv">mapWithIndex</span><span class="w"> </span><span class="p">(</span><span class="nf">\</span><span class="nv">s</span><span class="p">,</span><span class="w"> </span><span class="nv">i</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="nv">parseRow</span><span class="w"> </span><span class="nv">i</span><span class="w"> </span><span class="nv">s</span><span class="p">)</span>
<span class="w">        </span><span class="nf">|&gt;</span><span class="w"> </span><span class="nv">splitIntoParts</span>

<span class="w">    </span><span class="nv">findPartItems</span><span class="w"> </span><span class="nv">schematic</span><span class="w"> </span><span class="nv">potentialParts</span>
<span class="w">    </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">List</span><span class="nf">.</span><span class="nv">sum</span>
<span class="w">    </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">Num</span><span class="nf">.</span><span class="nv">toStr</span>

<span class="nv">part2</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Str</span>
<span class="nv">part2</span><span class="w"> </span><span class="nf">=</span>
<span class="w">    </span><span class="p">(</span><span class="nv">schematic</span><span class="p">,</span><span class="w"> </span><span class="nv">potentialParts</span><span class="p">)</span><span class="w"> </span><span class="nf">=</span>
<span class="w">        </span><span class="nv">input</span>
<span class="w">        </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">Str</span><span class="nf">.</span><span class="nv">split</span><span class="w"> </span><span class="s">"</span><span class="se">\n</span><span class="s">"</span>
<span class="w">        </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">List</span><span class="nf">.</span><span class="nv">dropIf</span><span class="w"> </span><span class="kt">Str</span><span class="nf">.</span><span class="nv">isEmpty</span>
<span class="w">        </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">List</span><span class="nf">.</span><span class="nv">mapWithIndex</span><span class="w"> </span><span class="p">(</span><span class="nf">\</span><span class="nv">s</span><span class="p">,</span><span class="w"> </span><span class="nv">i</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="nv">parseRow</span><span class="w"> </span><span class="nv">i</span><span class="w"> </span><span class="nv">s</span><span class="p">)</span>
<span class="w">        </span><span class="nf">|&gt;</span><span class="w"> </span><span class="nv">splitIntoParts</span>

<span class="w">    </span><span class="nv">findGears</span><span class="w"> </span><span class="nv">schematic</span><span class="w"> </span><span class="nv">potentialParts</span>
<span class="w">    </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">List</span><span class="nf">.</span><span class="nv">sum</span>
<span class="w">    </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">Num</span><span class="nf">.</span><span class="nv">toStr</span>

<span class="kt">Item</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="p">[</span><span class="kt">Space</span><span class="p">,</span><span class="w"> </span><span class="kt">Symbol</span><span class="w"> </span><span class="kt">U8</span><span class="p">,</span><span class="w"> </span><span class="kt">Number</span><span class="w"> </span><span class="kt">Nat</span><span class="p">]</span>
<span class="kt">Row</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">List</span><span class="w"> </span><span class="kt">Item</span>
<span class="kt">Schematic</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">List</span><span class="w"> </span><span class="kt">Row</span>

<span class="kt">PotentialPart</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nv">row</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Nat</span><span class="p">,</span><span class="w"> </span><span class="nv">col</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Nat</span><span class="p">,</span><span class="w"> </span><span class="nv">len</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Nat</span><span class="p">,</span><span class="w"> </span><span class="nv">part</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Nat</span><span class="w"> </span><span class="p">}</span>

<span class="nv">index</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nf">\</span><span class="nv">schematic</span><span class="p">,</span><span class="w"> </span><span class="nv">r</span><span class="p">,</span><span class="w"> </span><span class="nv">c</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">    </span><span class="kt">List</span><span class="nf">.</span><span class="nv">get</span><span class="w"> </span><span class="nv">schematic</span><span class="w"> </span><span class="nv">r</span>
<span class="w">    </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">Result</span><span class="nf">.</span><span class="nv">try</span><span class="w"> </span><span class="nf">\</span><span class="nv">row</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">List</span><span class="nf">.</span><span class="nv">get</span><span class="w"> </span><span class="nv">row</span><span class="w"> </span><span class="nv">c</span>

<span class="nv">getAdj</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nf">\</span><span class="nv">r</span><span class="p">,</span><span class="w"> </span><span class="nv">c</span><span class="p">,</span><span class="w"> </span><span class="nv">f</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">    </span><span class="nv">rI</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="kt">Num</span><span class="nf">.</span><span class="nv">toI64</span><span class="w"> </span><span class="nv">r</span>
<span class="w">    </span><span class="nv">cI</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="kt">Num</span><span class="nf">.</span><span class="nv">toI64</span><span class="w"> </span><span class="nv">c</span>
<span class="w">    </span><span class="kt">List</span><span class="nf">.</span><span class="nv">map</span><span class="w"> </span><span class="p">[</span><span class="nv">rI</span><span class="w"> </span><span class="nf">-</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="nv">rI</span><span class="p">,</span><span class="w"> </span><span class="nv">rI</span><span class="w"> </span><span class="nf">+</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="nf">\</span><span class="nv">nr</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">        </span><span class="kt">List</span><span class="nf">.</span><span class="nv">keepOks</span><span class="w"> </span><span class="p">[</span><span class="nv">cI</span><span class="w"> </span><span class="nf">-</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="nv">cI</span><span class="p">,</span><span class="w"> </span><span class="nv">cI</span><span class="w"> </span><span class="nf">+</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="nf">\</span><span class="nv">nc</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">            </span><span class="kr">if</span><span class="w"> </span><span class="nv">r</span><span class="w"> </span><span class="nf">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="nf">&amp;&amp;</span><span class="w"> </span><span class="nv">c</span><span class="w"> </span><span class="nf">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="kr">then</span><span class="w"> </span><span class="nv">f</span><span class="w"> </span><span class="p">(</span><span class="kt">Num</span><span class="nf">.</span><span class="nv">toNat</span><span class="w"> </span><span class="nv">nr</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="kt">Num</span><span class="nf">.</span><span class="nv">toNat</span><span class="w"> </span><span class="nv">nc</span><span class="p">)</span><span class="w"> </span><span class="kr">else</span><span class="w"> </span><span class="kt">Err</span><span class="w"> </span><span class="kt">OOB</span>
<span class="w">    </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">List</span><span class="nf">.</span><span class="nv">join</span>

<span class="nv">findPartItems</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Schematic</span><span class="p">,</span><span class="w"> </span><span class="kt">List</span><span class="w"> </span><span class="kt">PotentialPart</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">List</span><span class="w"> </span><span class="kt">Nat</span>
<span class="nv">findPartItems</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nf">\</span><span class="nv">schematic</span><span class="p">,</span><span class="w"> </span><span class="nv">potentialParts</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">    </span><span class="nv">getPart</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nf">\</span><span class="nv">r</span><span class="p">,</span><span class="w"> </span><span class="nv">c</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">        </span><span class="nv">when</span><span class="w"> </span><span class="nv">index</span><span class="w"> </span><span class="nv">schematic</span><span class="w"> </span><span class="nv">r</span><span class="w"> </span><span class="nv">c</span><span class="w"> </span><span class="nv">is</span>
<span class="w">            </span><span class="kt">Ok</span><span class="w"> </span><span class="p">(</span><span class="kt">Symbol</span><span class="w"> </span><span class="nv">_</span><span class="p">)</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Ok</span><span class="w"> </span><span class="mi">1</span>
<span class="w">            </span><span class="nv">_</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Err</span><span class="w"> </span><span class="kt">NotAPart</span>

<span class="w">    </span><span class="nv">goPotentialPart</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nf">\</span><span class="p">{</span><span class="w"> </span><span class="nv">row</span><span class="p">,</span><span class="w"> </span><span class="nv">col</span><span class="p">,</span><span class="w"> </span><span class="nv">len</span><span class="p">,</span><span class="w"> </span><span class="nv">part</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">        </span><span class="nv">cols</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="kt">List</span><span class="nf">.</span><span class="nv">range</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nv">start</span><span class="nf">:</span><span class="w"> </span><span class="kt">At</span><span class="w"> </span><span class="nv">col</span><span class="p">,</span><span class="w"> </span><span class="nv">end</span><span class="nf">:</span><span class="w"> </span><span class="kt">Before</span><span class="w"> </span><span class="p">(</span><span class="nv">col</span><span class="w"> </span><span class="nf">+</span><span class="w"> </span><span class="nv">len</span><span class="p">)</span><span class="w"> </span><span class="p">}</span>
<span class="w">        </span><span class="kr">if</span>
<span class="w">            </span><span class="kt">List</span><span class="nf">.</span><span class="nv">any</span><span class="w"> </span><span class="nv">cols</span><span class="w"> </span><span class="nf">\</span><span class="nv">c</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">List</span><span class="nf">.</span><span class="nv">sum</span><span class="w"> </span><span class="p">(</span><span class="nv">getAdj</span><span class="w"> </span><span class="nv">row</span><span class="w"> </span><span class="nv">c</span><span class="w"> </span><span class="nv">getPart</span><span class="p">)</span><span class="w"> </span><span class="nf">&gt;=</span><span class="w"> </span><span class="mi">1</span>
<span class="w">        </span><span class="kr">then</span>
<span class="w">            </span><span class="kt">Ok</span><span class="w"> </span><span class="nv">part</span>
<span class="w">        </span><span class="kr">else</span>
<span class="w">            </span><span class="kt">Err</span><span class="w"> </span><span class="kt">NotAPart</span>

<span class="w">    </span><span class="kt">List</span><span class="nf">.</span><span class="nv">keepOks</span><span class="w"> </span><span class="nv">potentialParts</span><span class="w"> </span><span class="nv">goPotentialPart</span>

<span class="nv">getNum</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nf">\</span><span class="nv">schematic</span><span class="p">,</span><span class="w"> </span><span class="nv">r</span><span class="p">,</span><span class="w"> </span><span class="nv">c</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">    </span><span class="nv">when</span><span class="w"> </span><span class="nv">index</span><span class="w"> </span><span class="nv">schematic</span><span class="w"> </span><span class="nv">r</span><span class="w"> </span><span class="nv">c</span><span class="w"> </span><span class="nv">is</span>
<span class="w">        </span><span class="kt">Ok</span><span class="w"> </span><span class="p">(</span><span class="kt">Number</span><span class="w"> </span><span class="nv">_</span><span class="p">)</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Ok</span><span class="w"> </span><span class="p">(</span><span class="nv">r</span><span class="p">,</span><span class="w"> </span><span class="nv">c</span><span class="p">)</span>
<span class="w">        </span><span class="nv">_</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Err</span><span class="w"> </span><span class="kt">NotANum</span>

<span class="nv">findGears</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Schematic</span><span class="p">,</span><span class="w"> </span><span class="kt">List</span><span class="w"> </span><span class="kt">PotentialPart</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">List</span><span class="w"> </span><span class="kt">Nat</span>
<span class="nv">findGears</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nf">\</span><span class="nv">schematic</span><span class="p">,</span><span class="w"> </span><span class="nv">potentialParts</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">    </span><span class="nv">findPart</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Nat</span><span class="p">,</span><span class="w"> </span><span class="kt">Nat</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">PotentialPart</span>
<span class="w">    </span><span class="nv">findPart</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nf">\</span><span class="nv">r</span><span class="p">,</span><span class="w"> </span><span class="nv">c</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">        </span><span class="nv">found</span><span class="w"> </span><span class="nf">=</span>
<span class="w">            </span><span class="kt">List</span><span class="nf">.</span><span class="nv">findFirst</span><span class="w"> </span><span class="nv">potentialParts</span><span class="w"> </span><span class="nf">\</span><span class="p">{</span><span class="w"> </span><span class="nv">row</span><span class="p">,</span><span class="w"> </span><span class="nv">col</span><span class="p">,</span><span class="w"> </span><span class="nv">len</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">                </span><span class="nv">row</span><span class="w"> </span><span class="nf">==</span><span class="w"> </span><span class="nv">r</span><span class="w"> </span><span class="nf">&amp;&amp;</span><span class="w"> </span><span class="nv">c</span><span class="w"> </span><span class="nf">&gt;=</span><span class="w"> </span><span class="nv">col</span><span class="w"> </span><span class="nf">&amp;&amp;</span><span class="w"> </span><span class="nv">c</span><span class="w"> </span><span class="nf">&lt;</span><span class="w"> </span><span class="nv">col</span><span class="w"> </span><span class="nf">+</span><span class="w"> </span><span class="nv">len</span>
<span class="w">        </span><span class="nv">when</span><span class="w"> </span><span class="nv">found</span><span class="w"> </span><span class="nv">is</span>
<span class="w">            </span><span class="kt">Ok</span><span class="w"> </span><span class="nv">part</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="nv">part</span>
<span class="w">            </span><span class="kt">Err</span><span class="w"> </span><span class="kt">NotFound</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="nv">crash</span><span class="w"> </span><span class="s">"no part found"</span>

<span class="w">    </span><span class="nv">goGear</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nf">\</span><span class="nv">r</span><span class="p">,</span><span class="w"> </span><span class="nv">c</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">        </span><span class="nv">adjNums</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nv">getAdj</span><span class="w"> </span><span class="nv">r</span><span class="w"> </span><span class="nv">c</span><span class="w"> </span><span class="p">(</span><span class="nf">\</span><span class="nv">r1</span><span class="p">,</span><span class="w"> </span><span class="nv">c1</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="nv">getNum</span><span class="w"> </span><span class="nv">schematic</span><span class="w"> </span><span class="nv">r1</span><span class="w"> </span><span class="nv">c1</span><span class="p">)</span>
<span class="w">        </span><span class="nv">adjParts</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="kt">List</span><span class="nf">.</span><span class="nv">map</span><span class="w"> </span><span class="nv">adjNums</span><span class="w"> </span><span class="p">(</span><span class="nf">\</span><span class="p">(</span><span class="nv">r1</span><span class="p">,</span><span class="w"> </span><span class="nv">c1</span><span class="p">)</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="nv">findPart</span><span class="w"> </span><span class="nv">r1</span><span class="w"> </span><span class="nv">c1</span><span class="p">)</span><span class="w"> </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">Set</span><span class="nf">.</span><span class="nv">fromList</span><span class="w"> </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">Set</span><span class="nf">.</span><span class="nv">toList</span>

<span class="w">        </span><span class="nv">when</span><span class="w"> </span><span class="nv">adjParts</span><span class="w"> </span><span class="nv">is</span>
<span class="w">            </span><span class="p">[</span><span class="nv">p1</span><span class="p">,</span><span class="w"> </span><span class="nv">p2</span><span class="p">]</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Ok</span><span class="w"> </span><span class="p">(</span><span class="nv">p1</span><span class="nf">.</span><span class="nv">part</span><span class="w"> </span><span class="nf">*</span><span class="w"> </span><span class="nv">p2</span><span class="nf">.</span><span class="nv">part</span><span class="p">)</span>
<span class="w">            </span><span class="nv">_</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Err</span><span class="w"> </span><span class="kt">NotAGear</span>

<span class="w">    </span><span class="nv">goItem</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nf">\</span><span class="nv">r</span><span class="p">,</span><span class="w"> </span><span class="nv">c</span><span class="p">,</span><span class="w"> </span><span class="nv">i</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">        </span><span class="nv">when</span><span class="w"> </span><span class="nv">i</span><span class="w"> </span><span class="nv">is</span>
<span class="w">            </span><span class="kt">Symbol</span><span class="w"> </span><span class="nf">'*'</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="nv">goGear</span><span class="w"> </span><span class="nv">r</span><span class="w"> </span><span class="nv">c</span>
<span class="w">            </span><span class="nv">_</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Err</span><span class="w"> </span><span class="kt">NotAGear</span>

<span class="w">    </span><span class="nv">goRow</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nf">\</span><span class="nv">r</span><span class="p">,</span><span class="w"> </span><span class="nv">row</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">        </span><span class="kt">List</span><span class="nf">.</span><span class="nv">mapWithIndex</span><span class="w"> </span><span class="nv">row</span><span class="w"> </span><span class="nf">\</span><span class="nv">i</span><span class="p">,</span><span class="w"> </span><span class="nv">c</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="nv">goItem</span><span class="w"> </span><span class="nv">r</span><span class="w"> </span><span class="nv">c</span><span class="w"> </span><span class="nv">i</span>

<span class="w">    </span><span class="kt">List</span><span class="nf">.</span><span class="nv">mapWithIndex</span><span class="w"> </span><span class="nv">schematic</span><span class="w"> </span><span class="nf">\</span><span class="nv">row</span><span class="p">,</span><span class="w"> </span><span class="nv">r</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="nv">goRow</span><span class="w"> </span><span class="nv">r</span><span class="w"> </span><span class="nv">row</span>
<span class="w">    </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">List</span><span class="nf">.</span><span class="nv">join</span>
<span class="w">    </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">List</span><span class="nf">.</span><span class="nv">keepOks</span><span class="w"> </span><span class="nf">\</span><span class="nv">n</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="nv">n</span>

<span class="nv">splitIntoParts</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">List</span><span class="w"> </span><span class="p">(</span><span class="kt">Row</span><span class="p">,</span><span class="w"> </span><span class="kt">List</span><span class="w"> </span><span class="kt">PotentialPart</span><span class="p">)</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="p">(</span><span class="kt">Schematic</span><span class="p">,</span><span class="w"> </span><span class="kt">List</span><span class="w"> </span><span class="kt">PotentialPart</span><span class="p">)</span>
<span class="nv">splitIntoParts</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nf">\</span><span class="nv">l</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">    </span><span class="kt">List</span><span class="nf">.</span><span class="nv">walk</span><span class="w"> </span><span class="nv">l</span><span class="w"> </span><span class="p">([],</span><span class="w"> </span><span class="p">[])</span><span class="w"> </span><span class="nf">\</span><span class="p">(</span><span class="nv">rows</span><span class="p">,</span><span class="w"> </span><span class="nv">allPotentialParts</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="nv">row</span><span class="p">,</span><span class="w"> </span><span class="nv">potentialParts</span><span class="p">)</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">        </span><span class="p">(</span><span class="kt">List</span><span class="nf">.</span><span class="nv">append</span><span class="w"> </span><span class="nv">rows</span><span class="w"> </span><span class="nv">row</span><span class="p">,</span><span class="w"> </span><span class="kt">List</span><span class="nf">.</span><span class="nv">concat</span><span class="w"> </span><span class="nv">allPotentialParts</span><span class="w"> </span><span class="nv">potentialParts</span><span class="p">)</span>

<span class="nv">parseRow</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Nat</span><span class="p">,</span><span class="w"> </span><span class="kt">Str</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="p">(</span><span class="kt">Row</span><span class="p">,</span><span class="w"> </span><span class="kt">List</span><span class="w"> </span><span class="kt">PotentialPart</span><span class="p">)</span>
<span class="nv">parseRow</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nf">\</span><span class="nv">row</span><span class="p">,</span><span class="w"> </span><span class="nv">s</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">    </span><span class="nv">pspace</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nv">const</span><span class="w"> </span><span class="kt">Space</span><span class="w"> </span><span class="nf">|&gt;</span><span class="w"> </span><span class="nv">skip</span><span class="w"> </span><span class="p">(</span><span class="nv">string</span><span class="w"> </span><span class="s">"."</span><span class="p">)</span>
<span class="w">    </span><span class="nv">pdigit</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nv">const</span><span class="w"> </span><span class="kt">Number</span><span class="w"> </span><span class="nf">|&gt;</span><span class="w"> </span><span class="nv">keep</span><span class="w"> </span><span class="nv">digit</span>
<span class="w">    </span><span class="nv">psymbol</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nv">const</span><span class="w"> </span><span class="kt">Symbol</span><span class="w"> </span><span class="nf">|&gt;</span><span class="w"> </span><span class="nv">keep</span><span class="w"> </span><span class="nv">anyCodeunit</span>

<span class="w">    </span><span class="nv">pitem</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Parser</span><span class="w"> </span><span class="nv">_</span><span class="w"> </span><span class="kt">Item</span>
<span class="w">    </span><span class="nv">pitem</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nv">oneOf</span><span class="w"> </span><span class="p">[</span><span class="nv">pspace</span><span class="p">,</span><span class="w"> </span><span class="nv">pdigit</span><span class="p">,</span><span class="w"> </span><span class="nv">psymbol</span><span class="p">]</span>

<span class="w">    </span><span class="nv">findPotentialParts</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">List</span><span class="w"> </span><span class="kt">PotentialPart</span><span class="p">,</span><span class="w"> </span><span class="kt">Nat</span><span class="p">,</span><span class="w"> </span><span class="nv">_</span><span class="p">,</span><span class="w"> </span><span class="kt">Row</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">List</span><span class="w"> </span><span class="kt">PotentialPart</span>
<span class="w">    </span><span class="nv">findPotentialParts</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nf">\</span><span class="nv">accum</span><span class="p">,</span><span class="w"> </span><span class="nv">c</span><span class="p">,</span><span class="w"> </span><span class="nv">partial</span><span class="p">,</span><span class="w"> </span><span class="nv">items</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="kt">Ideally</span><span class="w"> </span><span class="nv">we'd</span><span class="w"> </span><span class="nv">match</span><span class="w"> </span><span class="nv">on</span><span class="w"> </span><span class="p">(</span><span class="nv">items</span><span class="p">,</span><span class="w"> </span><span class="nv">partial</span><span class="p">)</span><span class="w"> </span><span class="nv">here</span><span class="p">,</span><span class="w"> </span><span class="nv">but</span><span class="w"> </span><span class="nv">that</span><span class="w"> </span><span class="nv">hits</span><span class="w"> </span><span class="nv">an</span><span class="w"> </span><span class="kt">RC</span><span class="w"> </span><span class="nv">inference</span><span class="w"> </span><span class="nv">bug</span><span class="nf">.</span>
<span class="w">        </span><span class="nv">when</span><span class="w"> </span><span class="nv">items</span><span class="w"> </span><span class="nv">is</span>
<span class="w">            </span><span class="p">[]</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">                </span><span class="nv">when</span><span class="w"> </span><span class="nv">partial</span><span class="w"> </span><span class="nv">is</span>
<span class="w">                    </span><span class="kt">None</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="nv">accum</span>
<span class="w">                    </span><span class="kt">Some</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nv">col</span><span class="p">,</span><span class="w"> </span><span class="nv">len</span><span class="p">,</span><span class="w"> </span><span class="nv">part</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">                        </span><span class="kt">List</span><span class="nf">.</span><span class="nv">append</span><span class="w"> </span><span class="nv">accum</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nv">row</span><span class="p">,</span><span class="w"> </span><span class="nv">col</span><span class="p">,</span><span class="w"> </span><span class="nv">len</span><span class="p">,</span><span class="w"> </span><span class="nv">part</span><span class="w"> </span><span class="p">}</span>

<span class="w">            </span><span class="p">[</span><span class="kt">Number</span><span class="w"> </span><span class="nv">n</span><span class="p">,</span><span class="w"> </span><span class="nf">..</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="nv">rest</span><span class="p">]</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">                </span><span class="nv">when</span><span class="w"> </span><span class="nv">partial</span><span class="w"> </span><span class="nv">is</span>
<span class="w">                    </span><span class="kt">None</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">                        </span><span class="nv">findPotentialParts</span><span class="w"> </span><span class="nv">accum</span><span class="w"> </span><span class="p">(</span><span class="nv">c</span><span class="w"> </span><span class="nf">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="kt">Some</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nv">col</span><span class="nf">:</span><span class="w"> </span><span class="nv">c</span><span class="p">,</span><span class="w"> </span><span class="nv">len</span><span class="nf">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="nv">part</span><span class="nf">:</span><span class="w"> </span><span class="nv">n</span><span class="w"> </span><span class="p">})</span><span class="w"> </span><span class="nv">rest</span>

<span class="w">                    </span><span class="kt">Some</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nv">col</span><span class="p">,</span><span class="w"> </span><span class="nv">len</span><span class="p">,</span><span class="w"> </span><span class="nv">part</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">                        </span><span class="nv">findPotentialParts</span>
<span class="w">                            </span><span class="nv">accum</span>
<span class="w">                            </span><span class="p">(</span><span class="nv">c</span><span class="w"> </span><span class="nf">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>
<span class="w">                            </span><span class="p">(</span><span class="kt">Some</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nv">col</span><span class="p">,</span><span class="w"> </span><span class="nv">len</span><span class="nf">:</span><span class="w"> </span><span class="nv">len</span><span class="w"> </span><span class="nf">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="nv">part</span><span class="nf">:</span><span class="w"> </span><span class="nv">part</span><span class="w"> </span><span class="nf">*</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="nf">+</span><span class="w"> </span><span class="nv">n</span><span class="w"> </span><span class="p">})</span>
<span class="w">                            </span><span class="nv">rest</span>

<span class="w">            </span><span class="p">[</span><span class="nv">_</span><span class="p">,</span><span class="w"> </span><span class="nf">..</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="nv">rest</span><span class="p">]</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">                </span><span class="nv">when</span><span class="w"> </span><span class="nv">partial</span><span class="w"> </span><span class="nv">is</span>
<span class="w">                    </span><span class="kt">None</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">                        </span><span class="nv">findPotentialParts</span><span class="w"> </span><span class="nv">accum</span><span class="w"> </span><span class="p">(</span><span class="nv">c</span><span class="w"> </span><span class="nf">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="kt">None</span><span class="w"> </span><span class="nv">rest</span>

<span class="w">                    </span><span class="kt">Some</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nv">col</span><span class="p">,</span><span class="w"> </span><span class="nv">len</span><span class="p">,</span><span class="w"> </span><span class="nv">part</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">                        </span><span class="nv">findPotentialParts</span><span class="w"> </span><span class="p">(</span><span class="kt">List</span><span class="nf">.</span><span class="nv">append</span><span class="w"> </span><span class="nv">accum</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nv">row</span><span class="p">,</span><span class="w"> </span><span class="nv">col</span><span class="p">,</span><span class="w"> </span><span class="nv">len</span><span class="p">,</span><span class="w"> </span><span class="nv">part</span><span class="w"> </span><span class="p">})</span><span class="w"> </span><span class="p">(</span><span class="nv">c</span><span class="w"> </span><span class="nf">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="kt">None</span><span class="w"> </span><span class="nv">rest</span>

<span class="w">    </span><span class="nv">parsedRow</span><span class="w"> </span><span class="nf">=</span>
<span class="w">        </span><span class="nv">when</span><span class="w"> </span><span class="nv">parseStr</span><span class="w"> </span><span class="p">(</span><span class="nv">many</span><span class="w"> </span><span class="nv">pitem</span><span class="p">)</span><span class="w"> </span><span class="nv">s</span><span class="w"> </span><span class="nv">is</span>
<span class="w">            </span><span class="kt">Ok</span><span class="w"> </span><span class="nv">items</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="nv">items</span>
<span class="w">            </span><span class="kt">Err</span><span class="w"> </span><span class="p">(</span><span class="kt">ParsingFailure</span><span class="w"> </span><span class="nv">e</span><span class="p">)</span><span class="w"> </span><span class="nf">|</span><span class="w"> </span><span class="kt">Err</span><span class="w"> </span><span class="p">(</span><span class="kt">ParsingIncomplete</span><span class="w"> </span><span class="nv">e</span><span class="p">)</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="nv">crash</span><span class="w"> </span><span class="s">"bad input: '\(e)'"</span>

<span class="w">    </span><span class="nv">expect</span><span class="w"> </span><span class="kt">List</span><span class="nf">.</span><span class="nv">len</span><span class="w"> </span><span class="nv">parsedRow</span><span class="w"> </span><span class="nf">==</span><span class="w"> </span><span class="kt">Str</span><span class="nf">.</span><span class="nv">countUtf8Bytes</span><span class="w"> </span><span class="nv">s</span>

<span class="w">    </span><span class="nv">potentialParts</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nv">findPotentialParts</span><span class="w"> </span><span class="p">[]</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="kt">None</span><span class="w"> </span><span class="nv">parsedRow</span>

<span class="w">    </span><span class="p">(</span><span class="nv">parsedRow</span><span class="p">,</span><span class="w"> </span><span class="nv">potentialParts</span><span class="p">)</span>
</code></pre></div>
</div></div>



<a name="405611634"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/358903-advent%20of%20code/topic/2023%20Day%203/near/405611634" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ayaz Hafiz <a href="https://roc-lang.github.io/zulip-export/stream/358903-advent-of-code/topic/2023.20Day.203.html#405611634">(Dec 03 2023 at 06:50)</a>:</h4>
<p>I feel like I overcomplicated it, and should totally have used Elias's 2D lib, but... today I really felt like wow, Roc is nice language</p>



<a name="405611671"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/358903-advent%20of%20code/topic/2023%20Day%203/near/405611671" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ayaz Hafiz <a href="https://roc-lang.github.io/zulip-export/stream/358903-advent-of-code/topic/2023.20Day.203.html#405611671">(Dec 03 2023 at 06:51)</a>:</h4>
<p>Things just worked (language server, dbg, expect) and even though I ran into some compiler bugs this is the best experience I've had writing Roc code since I joined the project</p>



<a name="405612047"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/358903-advent%20of%20code/topic/2023%20Day%203/near/405612047" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/358903-advent-of-code/topic/2023.20Day.203.html#405612047">(Dec 03 2023 at 06:56)</a>:</h4>
<p>So I decided to solve this in a really strange way. Not sure why...definitely would not recommend this code, but if you want to read a strange solution: <a href="https://github.com/bhansconnect/roc-aoc-2023/blob/main/day3.roc">https://github.com/bhansconnect/roc-aoc-2023/blob/main/day3.roc</a></p>



<a name="405615818"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/358903-advent%20of%20code/topic/2023%20Day%203/near/405615818" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Oskar Hahn <a href="https://roc-lang.github.io/zulip-export/stream/358903-advent-of-code/topic/2023.20Day.203.html#405615818">(Dec 03 2023 at 07:53)</a>:</h4>
<p>Here is mine: <a href="https://github.com/ostcar/aoc2023/blob/main/days/day03.roc">https://github.com/ostcar/aoc2023/blob/main/days/day03.roc</a></p>
<div class="spoiler-block"><div class="spoiler-header">
<p>Todays Problems</p>
</div><div class="spoiler-content" aria-hidden="true">
<p>If the roc-parser head the function <code>getPosition</code> like <a href="https://package.elm-lang.org/packages/elm/parser/latest/Parser#getPosition">elm does</a>, I would probably used the parser to get the positions of the numbers. <span class="user-mention" data-user-id="515757">@Luke Boswell</span> Is this something you would add to the roc-parser?</p>
<p>I had some problems with the different number types of roc. For example, I got the following error:</p>
<div class="codehilite"><pre><span></span><code>The argument is an anonymous function of type:

    Int Natural -&gt; Bool

But any needs its 2nd argument to be:

    Int Unsigned32 -&gt; Bool
</code></pre></div>
<p>The only solution I found was to convert all numbers in the hole file to I32.</p>
<p>Another number related bug was <code>integer addition overflowed!</code>.</p>
<p>It was hard to find the place where this was happening. It was this line:</p>
<div class="codehilite"><pre><span></span><code>lines = List.range { start: At (number.height - 1), end: At (number.height + 1) }
</code></pre></div>
<p><code>number.height</code> had type <code>U32</code> and <code>0 - 1</code> is of cause is an overflow. But I would call the operation a <code>substraction</code> and not a <code>addition</code> as the error message suggested.</p>
</div></div>



<a name="405621674"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/358903-advent%20of%20code/topic/2023%20Day%203/near/405621674" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/358903-advent-of-code/topic/2023.20Day.203.html#405621674">(Dec 03 2023 at 09:02)</a>:</h4>
<p>This is <a href="https://github.com/lukewilliamboswell/aoc/blob/main/src/S2023/D03.roc">my solution for Day 3</a>. That was a little hairy in some parts. </p>
<p>I also feel like Roc is running really great. I haven't ran into any compiler bugs yet. <span aria-label="octopus" class="emoji emoji-1f419" role="img" title="octopus">:octopus:</span></p>



<a name="405621704"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/358903-advent%20of%20code/topic/2023%20Day%203/near/405621704" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/358903-advent-of-code/topic/2023.20Day.203.html#405621704">(Dec 03 2023 at 09:03)</a>:</h4>
<p>I pretty much wrote the whole program using <code>roc check</code> and then <code>roc test</code> occasionally. When I finally wired it all together and it compiled, there were are couple of easy to debug logic bugs ( <code>dbg</code> <span aria-label="hearts" class="emoji emoji-2665" role="img" title="hearts">:hearts:</span>) and then it Just Worked™ which was super fun.</p>



<a name="405622748"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/358903-advent%20of%20code/topic/2023%20Day%203/near/405622748" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/358903-advent-of-code/topic/2023.20Day.203.html#405622748">(Dec 03 2023 at 09:09)</a>:</h4>
<div class="spoiler-block"><div class="spoiler-header">
<p>speed comparison between dev and --optimize</p>
</div><div class="spoiler-content" aria-hidden="true">
<p>$ roc dev src/cli.roc -- 2023 3<br>
2023 Day 3: Gear Ratios completed in 144 ms</p>
<hr>
<p>Part 1 took 75 ms<br>
The sum of all of the part numbers in the engine schematic is 507214</p>
<hr>
<p>Part 2 took 69 ms<br>
The the sum of all of the gear ratios in the engine schematic is 72553319</p>
<hr>
<p>$ roc run --optimize src/cli.roc -- 2023 3<br>
2023 Day 3: Gear Ratios completed in 15 ms</p>
<hr>
<p>Part 1 took 10 ms<br>
The sum of all of the part numbers in the engine schematic is 507214</p>
<hr>
<p>Part 2 took 5 ms<br>
The the sum of all of the gear ratios in the engine schematic is 72553319</p>
</div></div>



<a name="405630903"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/358903-advent%20of%20code/topic/2023%20Day%203/near/405630903" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Johan Lindskogen <a href="https://roc-lang.github.io/zulip-export/stream/358903-advent-of-code/topic/2023.20Day.203.html#405630903">(Dec 03 2023 at 10:07)</a>:</h4>
<p>Still on P1... I bumped into several compiler bugs.. Then I finally got the right answer for the sample data! But it doesn't work for the input: <a href="https://github.com/lindskogen/advent-of-code-2023/blob/main/day03/main.roc">https://github.com/lindskogen/advent-of-code-2023/blob/main/day03/main.roc</a></p>



<a name="405660016"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/358903-advent%20of%20code/topic/2023%20Day%203/near/405660016" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> joshi <a href="https://roc-lang.github.io/zulip-export/stream/358903-advent-of-code/topic/2023.20Day.203.html#405660016">(Dec 03 2023 at 12:04)</a>:</h4>
<p>Huh, things run a lot faster if you put them into main instead of at the top level.. weird.</p>
<p>At least I'm no longer painfully, like 200x compared to Luke, slow (but still very slow)</p>
<p><a href="https://gitlab.com/arkandos/aoc/-/blob/2023/solutions/day3.roc">https://gitlab.com/arkandos/aoc/-/blob/2023/solutions/day3.roc</a></p>
<div class="spoiler-block"><div class="spoiler-header">
<p>timings</p>
</div><div class="spoiler-content" aria-hidden="true">
<div class="codehilite" data-code-language="Bash"><pre><span></span><code><span class="c1"># With part1, part2 at the top level:</span>
›<span class="w"> </span><span class="nb">time</span><span class="w"> </span>./solutions/day3
real<span class="w">        </span>0m1.744s
user<span class="w">        </span>0m1.702s
sys<span class="w">         </span>0m0.043s

<span class="c1"># With both definitions moved into main:</span>
real<span class="w">        </span>0m0.232s
user<span class="w">        </span>0m0.229s
sys<span class="w">         </span>0m0.005s
</code></pre></div>
<p>These were debug builds, using <code>--optimize</code> the difference is still there, but less so (0.307s vs 0.045s real time)</p>
</div></div>



<a name="405660608"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/358903-advent%20of%20code/topic/2023%20Day%203/near/405660608" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/358903-advent-of-code/topic/2023.20Day.203.html#405660608">(Dec 03 2023 at 12:11)</a>:</h4>
<p><span class="user-mention silent" data-user-id="630752">joshi</span> <a href="#narrow/stream/358903-Advent-of-Code/topic/2023.20Day.203/near/405660016">said</a>:</p>
<blockquote>
<p>Huh, things run a lot faster if you put them into main instead of at the top level.. weird.</p>
</blockquote>
<p>I think you're the first person to notice this in practice! <span aria-label="big smile" class="emoji emoji-1f604" role="img" title="big smile">:big_smile:</span> </p>
<p>this is currently the case because today the way we compile top-level values is essentially that we turn them into functions, and then call those functions every time you reference the value. There's a plan to instead evaluate them at compile time (at which point there will be no performance difference to using them this way) but we haven't started on that project yet. <span aria-label="big smile" class="emoji emoji-1f604" role="img" title="big smile">:big_smile:</span></p>



<a name="405661399"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/358903-advent%20of%20code/topic/2023%20Day%203/near/405661399" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> joshi <a href="https://roc-lang.github.io/zulip-export/stream/358903-advent-of-code/topic/2023.20Day.203.html#405661399">(Dec 03 2023 at 12:22)</a>:</h4>
<p>Well that makes sense that parsing the same file thousands of times might take a second or two <span aria-label="big smile" class="emoji emoji-1f604" role="img" title="big smile">:big_smile:</span></p>
<p>But so far it's great! Roc does almost everything I ever wanted in a programming language, and everyone here seems super friendly and welcoming! <span aria-label="smiling face" class="emoji emoji-263a" role="img" title="smiling face">:smiling_face:</span></p>



<a name="405667885"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/358903-advent%20of%20code/topic/2023%20Day%203/near/405667885" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> LoipesMas <a href="https://roc-lang.github.io/zulip-export/stream/358903-advent-of-code/topic/2023.20Day.203.html#405667885">(Dec 03 2023 at 13:55)</a>:</h4>
<p>I wrote all of the part 1 logic first and then moved onto parsing, which was an interesting change. I know it's not optimal (in terms of performance and dev speed), but it just feels so nice to parse the file to a structure and then just operate on that.<br>
A classic off-by-one error got me stumped for a moment, because it only came up in the real input, but I managed to debug it. I've also spent some time trying to implement Eq for a custom type, but I managed to figure out how to do it by looking at the standard library. <br>
Code: <a href="https://github.com/LoipesMas/roc-aoc2023/blob/main/3/main.roc">https://github.com/LoipesMas/roc-aoc2023/blob/main/3/main.roc</a><br>
~30ms for part2, could probably be greatly improved with partitioning (instead of checking every <code>*</code> with every number...)</p>



<a name="405673752"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/358903-advent%20of%20code/topic/2023%20Day%203/near/405673752" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/358903-advent-of-code/topic/2023.20Day.203.html#405673752">(Dec 03 2023 at 15:15)</a>:</h4>
<p>Not sure if anyone else does this, but for working on AOC instead of using <code>roc check</code> or <code>roc test</code>, I now just change my main function to:</p>
<div class="codehilite" data-code-language="CoffeeScript"><pre><span></span><code><span class="nv">main</span><span class="w"> </span><span class="o">=</span>
<span class="w">    </span><span class="nx">dbg</span><span class="w"> </span><span class="p">(</span><span class="nx">part1</span><span class="w"> </span><span class="nx">p1Sample</span><span class="p">)</span>
<span class="w">    </span><span class="nx">Stout</span><span class="p">.</span><span class="nx">line</span><span class="w"> </span><span class="s">"done"</span>
</code></pre></div>
<p>Enables me to just run the code and look at whatever intermediate value. Really nice repl like loop. Just see whatever value my current function generates and then add the next pipeline stage to my current function.</p>
<p>While doing things, I temporarily comment out the type signature for <code>part1</code> so that it can return anything.</p>
<p>I probably should set this up with <code>entr</code> so it autoruns on file change.</p>



<a name="405674911"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/358903-advent%20of%20code/topic/2023%20Day%203/near/405674911" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jean Niklas L&#x27;orange <a href="https://roc-lang.github.io/zulip-export/stream/358903-advent-of-code/topic/2023.20Day.203.html#405674911">(Dec 03 2023 at 15:29)</a>:</h4>
<p>Here's <a href="https://github.com/hypirion/advent-of-code/blob/master/2023/day3.roc">my solution for Day 3</a>. Pain points today was Nat underflowing (it said overflow, which confused me for a second), and me using a previous state instead of updating the current one. It's a variant of the shadowing pain, kinda related to the threading issues already mentioned in <a href="#narrow/stream/304641-ideas/topic/Shadowing.20.26.20Redeclaration">#ideas &gt; Shadowing &amp; Redeclaration</a> </p>
<div class="spoiler-block"><div class="spoiler-header">
<p>Implementation trick</p>
</div><div class="spoiler-content" aria-hidden="true">
<p>It's a bit easier to work with objects and bounding boxes than working over a 2D grid, because you don't have to deal with deltas and grid bounds checking.</p>
</div></div>



<a name="405676155"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/358903-advent%20of%20code/topic/2023%20Day%203/near/405676155" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Elias Mulhall <a href="https://roc-lang.github.io/zulip-export/stream/358903-advent-of-code/topic/2023.20Day.203.html#405676155">(Dec 03 2023 at 15:50)</a>:</h4>
<p><a href="https://gist.github.com/mulias/b07e012ced92406f59cc2548d0f01323">Day 3, this one has a performance bug that I'll talk about below</a><br>
<a href="https://gist.github.com/mulias/f217e7461a2b847b1110d27e6c6191a1">Day 3, with a workaround</a></p>
<div class="spoiler-block"><div class="spoiler-header">
<p>Performance Issue Details</p>
</div><div class="spoiler-content" aria-hidden="true">
<p>I used a set of <code>{x: Nat, y: Nat}</code> indices to solve for adjacency. Something about this is hella slow. There's a benchmark in the gist, but the implementation using sets takes ~6 seconds to run. If I try  running a build compiled with <code>--optimize</code> then  it hangs forever while using 100% of a CPU core.</p>
<p>To troubleshoot I did a super naive swap, changing out the sets for lists, used concat instead of union, and searching through the two lists to find the intersection. That runs in ~2 seconds unoptimized and ~150ms optimized.</p>
<p>There's some inefficiency in my code but the set implementation being so much slower seems like a bug to me.</p>
</div></div>



<a name="405677428"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/358903-advent%20of%20code/topic/2023%20Day%203/near/405677428" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/358903-advent-of-code/topic/2023.20Day.203.html#405677428">(Dec 03 2023 at 16:06)</a>:</h4>
<p>Interesting. I'll have to look at that set issue. We have something similar to anal::flat_hash_set, so it should generally be pretty fast. Though depending on the size wouldn't be surprised if skipping hashing and linearly scanning ends up being faster. But yeah, probably a bug.</p>



<a name="405702211"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/358903-advent%20of%20code/topic/2023%20Day%203/near/405702211" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jason Hobbs <a href="https://roc-lang.github.io/zulip-export/stream/358903-advent-of-code/topic/2023.20Day.203.html#405702211">(Dec 03 2023 at 22:03)</a>:</h4>
<p><span class="user-mention silent" data-user-id="586417">Elias Mulhall</span> <a href="#narrow/stream/358903-Advent-of-Code/topic/2023.20Day.203/near/405676155">said</a>:</p>
<blockquote>
<p><a href="https://gist.github.com/mulias/b07e012ced92406f59cc2548d0f01323">Day 3, this one has a performance bug that I'll talk about below</a><br>
<a href="https://gist.github.com/mulias/f217e7461a2b847b1110d27e6c6191a1">Day 3, with a workaround</a></p>
<div class="spoiler-block"><div class="spoiler-header">
<p>Performance Issue Details</p>
</div><div class="spoiler-content" aria-hidden="true">
<p>I used a set of <code>{x: Nat, y: Nat}</code> indices to solve for adjacency. Something about this is hella slow. There's a benchmark in the gist, but the implementation using sets takes ~6 seconds to run. If I try  running a build compiled with <code>--optimize</code> then  it hangs forever while using 100% of a CPU core.</p>
<p>To troubleshoot I did a super naive swap, changing out the sets for lists, used concat instead of union, and searching through the two lists to find the intersection. That runs in ~2 seconds unoptimized and ~150ms optimized.</p>
<p>There's some inefficiency in my code but the set implementation being so much slower seems like a bug to me.</p>
<p></div></div><br>
</p>
</blockquote>
<div class="spoiler-block"><div class="spoiler-header">
<p>Poor performance here too at 33s</p>
</div><div class="spoiler-content" aria-hidden="true">
<p>I'm running <code>Set.fromList</code> and <code>Set.toList</code> in several places. It could be the bug, or just my code isn't performant. I'm not trying to learn about performance at this point in my Roc learning journey.</p>
</div></div>
<div class="spoiler-block"><div class="spoiler-header">
<p>And here's my code...</p>
</div><div class="spoiler-content" aria-hidden="true">
<p>Happy to have finally solved this one! It took me awhile, but I learned a bunch on the way.</p>
<div class="codehilite" data-code-language="Elm"><pre><span></span><code><span class="nv">app</span><span class="w"> </span><span class="s">"hello"</span>
<span class="w">  </span><span class="nv">packages</span>
<span class="w">    </span><span class="p">{</span><span class="w"> </span><span class="nv">pf</span><span class="nf">:</span><span class="w"> </span><span class="s">"https://github.com/roc-lang/basic-cli/releases/download/0.7.0/bkGby8jb0tmZYsy2hg1E_B2QrCgcSTxdUlHtETwm5m4.tar.br"</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="nv">parser</span><span class="nf">:</span><span class="w"> </span><span class="s">"https://github.com/lukewilliamboswell/roc-parser/releases/download/0.3.0/-e3ebWWmlFPfe9fYrr2z1urfslzygbtQQsl69iH1qzQ.tar.br"</span><span class="p">,</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="nv">imports</span>
<span class="w">    </span><span class="p">[</span><span class="w"> </span><span class="nv">pf</span><span class="nf">.</span><span class="kt">Stdout</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="nv">pf</span><span class="nf">.</span><span class="kt">Task</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="s">"./day3-input.txt"</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="nv">input</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Str</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="nv">parser</span><span class="nf">.</span><span class="kt">Core</span><span class="nf">.</span><span class="p">{</span><span class="w"> </span><span class="kt">Parser</span><span class="p">,</span><span class="w"> </span><span class="nv">const</span><span class="p">,</span><span class="w"> </span><span class="nv">keep</span><span class="p">,</span><span class="w"> </span><span class="nv">map</span><span class="p">,</span><span class="w"> </span><span class="nv">oneOrMore</span><span class="w"> </span><span class="p">}</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="nv">parser</span><span class="nf">.</span><span class="kt">String</span><span class="nf">.</span><span class="p">{</span><span class="w"> </span><span class="nv">anyCodeunit</span><span class="p">,</span><span class="w"> </span><span class="nv">digits</span><span class="p">,</span><span class="w"> </span><span class="nv">oneOf</span><span class="p">,</span><span class="w"> </span><span class="nv">parseStr</span><span class="p">,</span><span class="w"> </span><span class="nv">string</span><span class="w"> </span><span class="p">}</span>
<span class="w">    </span><span class="p">]</span>
<span class="w">  </span><span class="nv">provides</span><span class="w"> </span><span class="p">[</span><span class="nv">main</span><span class="p">]</span><span class="w"> </span><span class="nv">to</span><span class="w"> </span><span class="nv">pf</span>


<span class="kr">main </span><span class="nf">=</span>
<span class="w">  </span><span class="p">{}</span><span class="w"> </span><span class="nf">&lt;-</span><span class="w"> </span><span class="kt">Stdout</span><span class="nf">.</span><span class="nv">line</span><span class="w"> </span><span class="s">"The total sum is \(part1 input)"</span><span class="w"> </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">Task</span><span class="nf">.</span><span class="nv">await</span>
<span class="w">  </span><span class="p">{}</span><span class="w"> </span><span class="nf">&lt;-</span><span class="w"> </span><span class="kt">Stdout</span><span class="nf">.</span><span class="nv">line</span><span class="w"> </span><span class="s">"The gear ratios are \(part2 input)"</span><span class="w"> </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">Task</span><span class="nf">.</span><span class="nv">await</span>
<span class="w">  </span><span class="kt">Task</span><span class="nf">.</span><span class="nv">ok</span><span class="w"> </span><span class="p">{}</span>

<span class="nv">part1</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nf">\</span><span class="nv">schematic</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">  </span><span class="nv">width</span><span class="w"> </span><span class="nf">=</span>
<span class="w">    </span><span class="kt">Str</span><span class="nf">.</span><span class="nv">split</span><span class="w"> </span><span class="nv">schematic</span><span class="w"> </span><span class="s">"</span><span class="se">\n</span><span class="s">"</span>
<span class="w">    </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">List</span><span class="nf">.</span><span class="nv">first</span>
<span class="w">    </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">Result</span><span class="nf">.</span><span class="nv">withDefault</span><span class="w"> </span><span class="s">""</span>
<span class="w">    </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">Str</span><span class="nf">.</span><span class="nv">countGraphemes</span>
<span class="w">    </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">Num</span><span class="nf">.</span><span class="nv">add</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="err">#</span><span class="w"> </span><span class="kt">The</span><span class="w"> </span><span class="nf">+</span><span class="mi">1</span><span class="w"> </span><span class="nv">is</span><span class="w"> </span><span class="nv">for</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="kt">Newline</span><span class="w"> </span><span class="nv">character</span>
<span class="w">    </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">Num</span><span class="nf">.</span><span class="nv">toI16</span>

<span class="w">  </span><span class="nv">identifyParts</span><span class="w"> </span><span class="nv">schematic</span>
<span class="w">  </span><span class="nf">|&gt;</span><span class="w"> </span><span class="nv">appendAdjacentSymbol</span><span class="w"> </span><span class="nv">width</span>
<span class="w">  </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">List</span><span class="nf">.</span><span class="nv">keepIf</span><span class="w"> </span><span class="nf">\</span><span class="nv">cell</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="nv">when</span><span class="w"> </span><span class="nv">cell</span><span class="nf">.</span><span class="kr">type</span><span class="w"> </span><span class="nv">is</span>
<span class="w">                            </span><span class="kt">Correct</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Bool</span><span class="nf">.</span><span class="nv">true</span>
<span class="w">                            </span><span class="nv">_</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Bool</span><span class="nf">.</span><span class="nv">false</span>
<span class="w">  </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">Set</span><span class="nf">.</span><span class="nv">fromList</span>
<span class="w">  </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">Set</span><span class="nf">.</span><span class="nv">toList</span>
<span class="w">  </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">List</span><span class="nf">.</span><span class="nv">map</span><span class="w"> </span><span class="nf">\</span><span class="nv">part</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="nv">when</span><span class="w"> </span><span class="nv">part</span><span class="nf">.</span><span class="nv">cell</span><span class="w"> </span><span class="nv">is</span>
<span class="w">                          </span><span class="kt">Part</span><span class="w"> </span><span class="nv">num</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Result</span><span class="nf">.</span><span class="nv">withDefault</span><span class="w"> </span><span class="p">(</span><span class="kt">Str</span><span class="nf">.</span><span class="nv">toU32</span><span class="w"> </span><span class="nv">num</span><span class="p">)</span><span class="w"> </span><span class="mi">0</span>
<span class="w">                          </span><span class="nv">_</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="mi">0</span>
<span class="w">  </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">List</span><span class="nf">.</span><span class="nv">sum</span>
<span class="w">  </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">Num</span><span class="nf">.</span><span class="nv">toStr</span>

<span class="nv">expect</span><span class="w"> </span><span class="nv">part1</span><span class="w"> </span><span class="nv">exampleInput</span><span class="w"> </span><span class="nf">==</span><span class="w"> </span><span class="s">"4361"</span>

<span class="nv">part2</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nf">\</span><span class="nv">schematic</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">  </span><span class="nv">width</span><span class="w"> </span><span class="nf">=</span>
<span class="w">    </span><span class="kt">Str</span><span class="nf">.</span><span class="nv">split</span><span class="w"> </span><span class="nv">schematic</span><span class="w"> </span><span class="s">"</span><span class="se">\n</span><span class="s">"</span>
<span class="w">    </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">List</span><span class="nf">.</span><span class="nv">first</span>
<span class="w">    </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">Result</span><span class="nf">.</span><span class="nv">withDefault</span><span class="w"> </span><span class="s">""</span>
<span class="w">    </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">Str</span><span class="nf">.</span><span class="nv">countGraphemes</span>
<span class="w">    </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">Num</span><span class="nf">.</span><span class="nv">add</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="err">#</span><span class="w"> </span><span class="kt">The</span><span class="w"> </span><span class="nf">+</span><span class="mi">1</span><span class="w"> </span><span class="nv">is</span><span class="w"> </span><span class="nv">for</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="kt">Newline</span><span class="w"> </span><span class="nv">character</span>
<span class="w">    </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">Num</span><span class="nf">.</span><span class="nv">toI16</span>

<span class="w">  </span><span class="nv">identifyParts</span><span class="w"> </span><span class="nv">schematic</span>
<span class="w">  </span><span class="nf">|&gt;</span><span class="w"> </span><span class="nv">appendAdjacentSymbol</span><span class="w"> </span><span class="nv">width</span>
<span class="w">  </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">List</span><span class="nf">.</span><span class="nv">keepIf</span><span class="w"> </span><span class="nf">\</span><span class="nv">cell</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="nv">when</span><span class="w"> </span><span class="nv">cell</span><span class="nf">.</span><span class="kr">type</span><span class="w"> </span><span class="nv">is</span>
<span class="w">                          </span><span class="kt">Gear</span><span class="w"> </span><span class="nv">_</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Bool</span><span class="nf">.</span><span class="nv">true</span>
<span class="w">                          </span><span class="nv">_</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Bool</span><span class="nf">.</span><span class="nv">false</span>
<span class="w">  </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">Set</span><span class="nf">.</span><span class="nv">fromList</span>
<span class="w">  </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">Set</span><span class="nf">.</span><span class="nv">toList</span>
<span class="w">  </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">List</span><span class="nf">.</span><span class="nv">map</span><span class="w"> </span><span class="nf">\</span><span class="nv">symbol</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="nv">when</span><span class="w"> </span><span class="nv">symbol</span><span class="nf">.</span><span class="kr">type</span><span class="w"> </span><span class="nv">is</span>
<span class="w">                        </span><span class="kt">Gear</span><span class="w"> </span><span class="nv">ratio</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="nv">ratio</span>
<span class="w">                        </span><span class="nv">_</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="mi">0</span>
<span class="w">  </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">List</span><span class="nf">.</span><span class="nv">sum</span>
<span class="w">  </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">Num</span><span class="nf">.</span><span class="nv">toStr</span>


<span class="nv">element</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Parser</span><span class="w"> </span><span class="p">(</span><span class="kt">List</span><span class="w"> </span><span class="kt">U8</span><span class="p">)</span><span class="w"> </span><span class="kt">CellContent</span>
<span class="nv">element</span><span class="w"> </span><span class="nf">=</span>
<span class="w">  </span><span class="nv">oneOf</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="nv">digits</span><span class="w"> </span><span class="nf">|&gt;</span><span class="w"> </span><span class="nv">map</span><span class="w"> </span><span class="nf">\</span><span class="nv">d</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Part</span><span class="w"> </span><span class="p">(</span><span class="kt">Num</span><span class="nf">.</span><span class="nv">toStr</span><span class="w"> </span><span class="nv">d</span><span class="p">),</span>
<span class="w">    </span><span class="nv">string</span><span class="w"> </span><span class="s">"."</span><span class="w"> </span><span class="nf">|&gt;</span><span class="w"> </span><span class="nv">map</span><span class="w"> </span><span class="nf">\</span><span class="nv">_</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Separator</span><span class="p">,</span>
<span class="w">    </span><span class="nv">string</span><span class="w"> </span><span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="w"> </span><span class="nf">|&gt;</span><span class="w"> </span><span class="nv">map</span><span class="w"> </span><span class="nf">\</span><span class="nv">_</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">NewLine</span><span class="p">,</span>
<span class="w">    </span><span class="nv">string</span><span class="w"> </span><span class="s">"*"</span><span class="w"> </span><span class="nf">|&gt;</span><span class="w"> </span><span class="nv">map</span><span class="w"> </span><span class="nf">\</span><span class="nv">_</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Symbol</span><span class="w"> </span><span class="kt">PossibleGear</span><span class="p">,</span>
<span class="w">    </span><span class="nv">anyCodeunit</span><span class="w"> </span><span class="nf">|&gt;</span><span class="w"> </span><span class="nv">map</span><span class="w"> </span><span class="nf">\</span><span class="nv">_</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Symbol</span><span class="w"> </span><span class="kt">NotAGear</span><span class="p">,</span>
<span class="w">  </span><span class="p">]</span>

<span class="nv">expect</span><span class="w"> </span><span class="nv">parseStr</span><span class="w"> </span><span class="nv">element</span><span class="w"> </span><span class="s">"467"</span><span class="w"> </span><span class="nf">==</span><span class="w"> </span><span class="kt">Ok</span><span class="w"> </span><span class="p">(</span><span class="kt">Part</span><span class="w"> </span><span class="s">"467"</span><span class="p">)</span>
<span class="nv">expect</span><span class="w"> </span><span class="nv">parseStr</span><span class="w"> </span><span class="nv">element</span><span class="w"> </span><span class="s">"."</span><span class="w"> </span><span class="nf">==</span><span class="w"> </span><span class="kt">Ok</span><span class="w"> </span><span class="kt">Separator</span>

<span class="nv">schematicParser</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Parser</span><span class="w"> </span><span class="p">(</span><span class="kt">List</span><span class="w"> </span><span class="kt">U8</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="kt">List</span><span class="w"> </span><span class="kt">CellContent</span><span class="p">)</span>
<span class="nv">schematicParser</span><span class="w"> </span><span class="nf">=</span>
<span class="w">  </span><span class="nv">const</span><span class="w"> </span><span class="p">(</span><span class="nf">\</span><span class="nv">i</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="nv">i</span><span class="p">)</span>
<span class="w">  </span><span class="nf">|&gt;</span><span class="w"> </span><span class="nv">keep</span><span class="w"> </span><span class="p">(</span><span class="nv">oneOrMore</span><span class="w"> </span><span class="nv">element</span><span class="p">)</span>

<span class="nv">expect</span>
<span class="w">  </span><span class="nv">parseStr</span><span class="w"> </span><span class="nv">schematicParser</span><span class="w"> </span><span class="nv">smallInput</span>
<span class="w">  </span><span class="nf">==</span><span class="w"> </span><span class="kt">Ok</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="kt">Part</span><span class="w"> </span><span class="s">"11"</span><span class="p">,</span>
<span class="w">    </span><span class="kt">Separator</span><span class="p">,</span>
<span class="w">    </span><span class="kt">Part</span><span class="w"> </span><span class="s">"2"</span><span class="p">,</span>
<span class="w">    </span><span class="kt">NewLine</span><span class="p">,</span>
<span class="w">    </span><span class="kt">Symbol</span><span class="w"> </span><span class="kt">NotAGear</span><span class="p">,</span>
<span class="w">    </span><span class="kt">Separator</span><span class="p">,</span>
<span class="w">    </span><span class="kt">Separator</span><span class="p">,</span>
<span class="w">    </span><span class="kt">Separator</span>
<span class="w">  </span><span class="p">]</span>

<span class="nv">identifyParts</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nf">\</span><span class="nv">schematic</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">  </span><span class="nv">parseStr</span><span class="w"> </span><span class="nv">schematicParser</span><span class="w"> </span><span class="nv">schematic</span>
<span class="w">  </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">Result</span><span class="nf">.</span><span class="nv">withDefault</span><span class="w"> </span><span class="p">[]</span>
<span class="w">  </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">List</span><span class="nf">.</span><span class="nv">walkWithIndex</span><span class="w"> </span><span class="p">[]</span><span class="w"> </span><span class="nf">\</span><span class="nv">state</span><span class="p">,</span><span class="w"> </span><span class="nv">cell</span><span class="p">,</span><span class="w"> </span><span class="nv">index</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">        </span><span class="nv">when</span><span class="w"> </span><span class="nv">cell</span><span class="w"> </span><span class="nv">is</span>
<span class="w">          </span><span class="kt">Part</span><span class="w"> </span><span class="nv">num</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">            </span><span class="kt">List</span><span class="nf">.</span><span class="nv">concat</span>
<span class="w">              </span><span class="nv">state</span>
<span class="w">              </span><span class="p">(</span><span class="kt">List</span><span class="nf">.</span><span class="nv">repeat</span>
<span class="w">                </span><span class="p">{</span><span class="w"> </span><span class="nv">id</span><span class="nf">:</span><span class="w"> </span><span class="nv">index</span>
<span class="w">                </span><span class="p">,</span><span class="w"> </span><span class="nv">cell</span><span class="nf">:</span><span class="w"> </span><span class="nv">cell</span>
<span class="w">                </span><span class="p">,</span><span class="w"> </span><span class="kr">type</span><span class="nf">:</span><span class="w"> </span><span class="kt">Unknown</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">                </span><span class="p">(</span><span class="kt">Str</span><span class="nf">.</span><span class="nv">countGraphemes</span><span class="w"> </span><span class="nv">num</span><span class="p">))</span>

<span class="w">          </span><span class="nv">_</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">List</span><span class="nf">.</span><span class="nv">append</span>
<span class="w">                  </span><span class="nv">state</span>
<span class="w">                  </span><span class="p">{</span><span class="w"> </span><span class="nv">id</span><span class="nf">:</span><span class="w"> </span><span class="nv">index</span>
<span class="w">                  </span><span class="p">,</span><span class="w"> </span><span class="nv">cell</span><span class="nf">:</span><span class="w"> </span><span class="nv">cell</span>
<span class="w">                  </span><span class="p">,</span><span class="w"> </span><span class="kr">type</span><span class="nf">:</span><span class="w"> </span><span class="kt">Unknown</span>
<span class="w">                  </span><span class="p">}</span>

<span class="nv">expect</span>
<span class="w">  </span><span class="nv">x</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nv">identifyParts</span><span class="w"> </span><span class="nv">smallInput</span>
<span class="w">  </span><span class="nv">x</span><span class="w"> </span><span class="nf">==</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="p">{</span><span class="w"> </span><span class="nv">cell</span><span class="nf">:</span><span class="w"> </span><span class="kt">Part</span><span class="w"> </span><span class="s">"11"</span><span class="p">,</span><span class="w"> </span><span class="nv">id</span><span class="nf">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="kr">type</span><span class="nf">:</span><span class="w"> </span><span class="kt">Unknown</span><span class="w"> </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span><span class="w"> </span><span class="nv">cell</span><span class="nf">:</span><span class="w"> </span><span class="kt">Part</span><span class="w"> </span><span class="s">"11"</span><span class="p">,</span><span class="w"> </span><span class="nv">id</span><span class="nf">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="kr">type</span><span class="nf">:</span><span class="w"> </span><span class="kt">Unknown</span><span class="w"> </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span><span class="w"> </span><span class="nv">cell</span><span class="nf">:</span><span class="w"> </span><span class="kt">Separator</span><span class="p">,</span><span class="w"> </span><span class="nv">id</span><span class="nf">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="kr">type</span><span class="nf">:</span><span class="w"> </span><span class="kt">Unknown</span><span class="w"> </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span><span class="w"> </span><span class="nv">cell</span><span class="nf">:</span><span class="w"> </span><span class="kt">Part</span><span class="w"> </span><span class="s">"2"</span><span class="p">,</span><span class="w"> </span><span class="nv">id</span><span class="nf">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="kr">type</span><span class="nf">:</span><span class="w"> </span><span class="kt">Unknown</span><span class="w"> </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span><span class="w"> </span><span class="nv">cell</span><span class="nf">:</span><span class="w"> </span><span class="kt">NewLine</span><span class="p">,</span><span class="w"> </span><span class="nv">id</span><span class="nf">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="kr">type</span><span class="nf">:</span><span class="w"> </span><span class="kt">Unknown</span><span class="w"> </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span><span class="w"> </span><span class="nv">cell</span><span class="nf">:</span><span class="w"> </span><span class="kt">Symbol</span><span class="w"> </span><span class="kt">NotAGear</span><span class="p">,</span><span class="w"> </span><span class="nv">id</span><span class="nf">:</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="kr">type</span><span class="nf">:</span><span class="w"> </span><span class="kt">Unknown</span><span class="w"> </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span><span class="w"> </span><span class="nv">cell</span><span class="nf">:</span><span class="w"> </span><span class="kt">Separator</span><span class="p">,</span><span class="w"> </span><span class="nv">id</span><span class="nf">:</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="kr">type</span><span class="nf">:</span><span class="w"> </span><span class="kt">Unknown</span><span class="w"> </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span><span class="w"> </span><span class="nv">cell</span><span class="nf">:</span><span class="w"> </span><span class="kt">Separator</span><span class="p">,</span><span class="w"> </span><span class="nv">id</span><span class="nf">:</span><span class="w"> </span><span class="mi">6</span><span class="p">,</span><span class="w"> </span><span class="kr">type</span><span class="nf">:</span><span class="w"> </span><span class="kt">Unknown</span><span class="w"> </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span><span class="w"> </span><span class="nv">cell</span><span class="nf">:</span><span class="w"> </span><span class="kt">Separator</span><span class="p">,</span><span class="w"> </span><span class="nv">id</span><span class="nf">:</span><span class="w"> </span><span class="mi">7</span><span class="p">,</span><span class="w"> </span><span class="kr">type</span><span class="nf">:</span><span class="w"> </span><span class="kt">Unknown</span><span class="w"> </span><span class="p">}]</span>

<span class="kt">CellType</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="p">[</span><span class="kt">Unknown</span><span class="p">,</span><span class="w"> </span><span class="kt">Correct</span><span class="p">,</span><span class="w"> </span><span class="kt">Extra</span><span class="p">,</span><span class="w"> </span><span class="kt">Gear</span><span class="w"> </span><span class="kt">U32</span><span class="p">,</span><span class="w"> </span><span class="kt">NotAPart</span><span class="p">]</span>
<span class="kt">CellContent</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="p">[</span><span class="kt">NewLine</span><span class="p">,</span>
<span class="w">  </span><span class="kt">Part</span><span class="w"> </span><span class="kt">Str</span><span class="p">,</span>
<span class="w">  </span><span class="kt">Separator</span><span class="p">,</span>
<span class="w">  </span><span class="kt">Symbol</span><span class="w"> </span><span class="p">[</span><span class="kt">PossibleGear</span><span class="p">,</span><span class="w"> </span><span class="kt">NotAGear</span><span class="p">],</span>
<span class="w">  </span><span class="p">]</span>

<span class="nv">appendAdjacentSymbol</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">List</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nv">cell</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">CellContent</span><span class="p">,</span>
<span class="w">  </span><span class="kr">type</span><span class="nf">:</span><span class="w"> </span><span class="kt">CellType</span><span class="p">,</span>
<span class="w">  </span><span class="nv">id</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Nat</span><span class="p">,</span>
<span class="p">},</span><span class="w"> </span><span class="kt">I16</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">List</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nv">cell</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">CellContent</span><span class="p">,</span>
<span class="w">  </span><span class="kr">type</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">CellType</span><span class="p">,</span>
<span class="w">  </span><span class="nv">id</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Nat</span><span class="p">,</span>
<span class="p">}</span>
<span class="nv">appendAdjacentSymbol</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nf">\</span><span class="nv">identifiedParts</span><span class="p">,</span><span class="w"> </span><span class="nv">width</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">  </span><span class="err">#</span><span class="w"> </span><span class="nv">width</span><span class="w"> </span><span class="nv">should</span><span class="w"> </span><span class="nv">include</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">newline</span>
<span class="w">  </span><span class="nv">adjacentCellIndexes</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="nf">-</span><span class="nv">width</span><span class="w"> </span><span class="nf">-</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span>
<span class="w">    </span><span class="nf">-</span><span class="nv">width</span><span class="p">,</span>
<span class="w">    </span><span class="nf">-</span><span class="nv">width</span><span class="w"> </span><span class="nf">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span>
<span class="w">    </span><span class="nf">-</span><span class="mi">1</span><span class="p">,</span>
<span class="w">    </span><span class="mi">1</span><span class="p">,</span>
<span class="w">    </span><span class="nv">width</span><span class="w"> </span><span class="nf">-</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span>
<span class="w">    </span><span class="nv">width</span><span class="p">,</span>
<span class="w">    </span><span class="nv">width</span><span class="w"> </span><span class="nf">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">  </span><span class="p">]</span>

<span class="w">  </span><span class="kt">State</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">List</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nv">cell</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">CellContent</span><span class="p">,</span>
<span class="w">      </span><span class="kr">type</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">CellType</span><span class="p">,</span>
<span class="w">      </span><span class="nv">id</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Nat</span><span class="p">,</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="kt">Cell</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nv">cell</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">CellContent</span><span class="p">,</span>
<span class="w">      </span><span class="kr">type</span><span class="nf">:</span><span class="w"> </span><span class="kt">CellType</span><span class="p">,</span>
<span class="w">      </span><span class="nv">id</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Nat</span><span class="p">,</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">  </span><span class="nv">x</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">State</span><span class="p">,</span><span class="w"> </span><span class="kt">Cell</span><span class="p">,</span><span class="w"> </span><span class="kt">Nat</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">State</span>
<span class="w">  </span><span class="nv">x</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nf">\</span><span class="nv">state</span><span class="p">,</span><span class="w"> </span><span class="nv">cell</span><span class="p">,</span><span class="w"> </span><span class="nv">index</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">    </span><span class="nv">when</span><span class="w"> </span><span class="nv">cell</span><span class="nf">.</span><span class="nv">cell</span><span class="w"> </span><span class="nv">is</span>
<span class="w">      </span><span class="kt">Part</span><span class="w"> </span><span class="nv">_</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">        </span><span class="nv">adjacentSymbols</span><span class="w"> </span><span class="nf">=</span>
<span class="w">          </span><span class="kt">List</span><span class="nf">.</span><span class="nv">map</span><span class="w"> </span><span class="nv">adjacentCellIndexes</span><span class="w"> </span><span class="nf">\</span><span class="nv">relativeIndex</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="p">(</span><span class="kt">Num</span><span class="nf">.</span><span class="nv">add</span><span class="w"> </span><span class="nv">relativeIndex</span><span class="w"> </span><span class="p">(</span><span class="kt">Num</span><span class="nf">.</span><span class="nv">toI16</span><span class="w"> </span><span class="nv">index</span><span class="p">))</span>
<span class="w">          </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">List</span><span class="nf">.</span><span class="nv">keepIf</span><span class="w"> </span><span class="nf">\</span><span class="nv">absoluteIndex</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="nv">absoluteIndex</span><span class="w"> </span><span class="nf">&gt;=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">          </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">List</span><span class="nf">.</span><span class="nv">map</span><span class="w"> </span><span class="kt">Num</span><span class="nf">.</span><span class="nv">toNat</span>
<span class="w">          </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">List</span><span class="nf">.</span><span class="nv">keepOks</span><span class="w"> </span><span class="nf">\</span><span class="nv">absoluteIndex</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">List</span><span class="nf">.</span><span class="nv">get</span><span class="w"> </span><span class="nv">identifiedParts</span><span class="w"> </span><span class="nv">absoluteIndex</span>
<span class="w">          </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">List</span><span class="nf">.</span><span class="nv">keepIf</span><span class="w"> </span><span class="nf">\</span><span class="nv">adjacentCell</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">                </span><span class="nv">when</span><span class="w"> </span><span class="nv">adjacentCell</span><span class="nf">.</span><span class="nv">cell</span><span class="w"> </span><span class="nv">is</span>
<span class="w">                  </span><span class="kt">Symbol</span><span class="w"> </span><span class="nv">_</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Bool</span><span class="nf">.</span><span class="nv">true</span>
<span class="w">                  </span><span class="nv">_</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Bool</span><span class="nf">.</span><span class="nv">false</span>

<span class="w">        </span><span class="kt">List</span><span class="nf">.</span><span class="nv">append</span><span class="w"> </span><span class="nv">state</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="nv">cell</span><span class="w"> </span><span class="err">&amp;</span>
<span class="w">          </span><span class="kr">type</span><span class="nf">:</span><span class="w"> </span><span class="kr">if</span><span class="w"> </span><span class="kt">List</span><span class="nf">.</span><span class="nv">isEmpty</span><span class="w"> </span><span class="nv">adjacentSymbols</span><span class="w"> </span><span class="kr">then</span><span class="w"> </span><span class="kt">Extra</span><span class="w"> </span><span class="kr">else</span><span class="w"> </span><span class="kt">Correct</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">      </span><span class="kt">Symbol</span><span class="w"> </span><span class="nv">symbolType</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">        </span><span class="nv">when</span><span class="w"> </span><span class="nv">symbolType</span><span class="w"> </span><span class="nv">is</span>
<span class="w">          </span><span class="kt">PossibleGear</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">            </span><span class="nv">adjacentParts</span><span class="w"> </span><span class="nf">=</span>
<span class="w">              </span><span class="kt">List</span><span class="nf">.</span><span class="nv">map</span><span class="w"> </span><span class="nv">adjacentCellIndexes</span><span class="w"> </span><span class="nf">\</span><span class="nv">relativeIndex</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="p">(</span><span class="kt">Num</span><span class="nf">.</span><span class="nv">add</span><span class="w"> </span><span class="nv">relativeIndex</span><span class="w"> </span><span class="p">(</span><span class="kt">Num</span><span class="nf">.</span><span class="nv">toI16</span><span class="w"> </span><span class="nv">index</span><span class="p">))</span>
<span class="w">              </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">List</span><span class="nf">.</span><span class="nv">keepIf</span><span class="w"> </span><span class="nf">\</span><span class="nv">absoluteIndex</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="nv">absoluteIndex</span><span class="w"> </span><span class="nf">&gt;=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">              </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">List</span><span class="nf">.</span><span class="nv">map</span><span class="w"> </span><span class="kt">Num</span><span class="nf">.</span><span class="nv">toNat</span>
<span class="w">              </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">List</span><span class="nf">.</span><span class="nv">keepOks</span><span class="w"> </span><span class="nf">\</span><span class="nv">absoluteIndex</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">List</span><span class="nf">.</span><span class="nv">get</span><span class="w"> </span><span class="nv">identifiedParts</span><span class="w"> </span><span class="nv">absoluteIndex</span>
<span class="w">              </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">List</span><span class="nf">.</span><span class="nv">keepIf</span><span class="w"> </span><span class="nf">\</span><span class="nv">adjacentCell</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">                    </span><span class="nv">when</span><span class="w"> </span><span class="nv">adjacentCell</span><span class="nf">.</span><span class="nv">cell</span><span class="w"> </span><span class="nv">is</span>
<span class="w">                      </span><span class="kt">Part</span><span class="w"> </span><span class="nv">_</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Bool</span><span class="nf">.</span><span class="nv">true</span>
<span class="w">                      </span><span class="nv">_</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Bool</span><span class="nf">.</span><span class="nv">false</span>
<span class="w">              </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">Set</span><span class="nf">.</span><span class="nv">fromList</span>
<span class="w">              </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">Set</span><span class="nf">.</span><span class="nv">toList</span>

<span class="w">            </span><span class="kr">if</span><span class="w"> </span><span class="kt">List</span><span class="nf">.</span><span class="nv">len</span><span class="w"> </span><span class="nv">adjacentParts</span><span class="w"> </span><span class="nf">&gt;=</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="kr">then</span>
<span class="w">              </span><span class="err">#</span><span class="w"> </span><span class="nv">_</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nv">debug</span><span class="w"> </span><span class="nv">index</span><span class="w"> </span><span class="s">"index"</span>
<span class="w">              </span><span class="err">#</span><span class="w"> </span><span class="nv">_</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nv">debug</span><span class="w"> </span><span class="nv">cell</span><span class="w"> </span><span class="s">"cell"</span>
<span class="w">              </span><span class="err">#</span><span class="w"> </span><span class="nv">_</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nv">debug</span><span class="w"> </span><span class="nv">adjacentParts</span><span class="w"> </span><span class="s">"adjacentParts"</span>

<span class="w">              </span><span class="nv">gearRatio</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                </span><span class="nv">adjacentParts</span>
<span class="w">                </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">Set</span><span class="nf">.</span><span class="nv">fromList</span>
<span class="w">                </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">Set</span><span class="nf">.</span><span class="nv">toList</span>
<span class="w">                </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">List</span><span class="nf">.</span><span class="nv">map</span><span class="w"> </span><span class="nf">\</span><span class="nv">adjacentCell</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="nv">when</span><span class="w"> </span><span class="nv">adjacentCell</span><span class="nf">.</span><span class="nv">cell</span><span class="w"> </span><span class="nv">is</span>
<span class="w">                                                </span><span class="kt">Part</span><span class="w"> </span><span class="nv">num</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Result</span><span class="nf">.</span><span class="nv">withDefault</span><span class="w"> </span><span class="p">(</span><span class="kt">Str</span><span class="nf">.</span><span class="nv">toU32</span><span class="w"> </span><span class="nv">num</span><span class="p">)</span><span class="w"> </span><span class="mi">1</span>
<span class="w">                                                </span><span class="nv">_</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="mi">1</span>
<span class="w">                </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">List</span><span class="nf">.</span><span class="nv">product</span>

<span class="w">              </span><span class="kt">List</span><span class="nf">.</span><span class="nv">append</span><span class="w"> </span><span class="nv">state</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nv">cell</span><span class="w"> </span><span class="err">&amp;</span><span class="w"> </span><span class="kr">type</span><span class="nf">:</span><span class="w"> </span><span class="kt">Gear</span><span class="w"> </span><span class="nv">gearRatio</span><span class="w"> </span><span class="p">}</span>
<span class="w">            </span><span class="kr">else</span>
<span class="w">              </span><span class="kt">List</span><span class="nf">.</span><span class="nv">append</span><span class="w"> </span><span class="nv">state</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nv">cell</span><span class="w"> </span><span class="err">&amp;</span><span class="w"> </span><span class="kr">type</span><span class="nf">:</span><span class="w"> </span><span class="kt">NotAPart</span><span class="w"> </span><span class="p">}</span>

<span class="w">          </span><span class="nv">_</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">List</span><span class="nf">.</span><span class="nv">append</span><span class="w"> </span><span class="nv">state</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nv">cell</span><span class="w"> </span><span class="err">&amp;</span><span class="w"> </span><span class="kr">type</span><span class="nf">:</span><span class="w"> </span><span class="kt">NotAPart</span><span class="w"> </span><span class="p">}</span>

<span class="w">      </span><span class="nv">_</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">List</span><span class="nf">.</span><span class="nv">append</span><span class="w"> </span><span class="nv">state</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nv">cell</span><span class="w"> </span><span class="err">&amp;</span><span class="w"> </span><span class="kr">type</span><span class="nf">:</span><span class="w"> </span><span class="kt">NotAPart</span><span class="w"> </span><span class="p">}</span>

<span class="w">  </span><span class="kt">List</span><span class="nf">.</span><span class="nv">walkWithIndex</span><span class="w"> </span><span class="nv">identifiedParts</span><span class="w"> </span><span class="p">[]</span><span class="w"> </span><span class="nv">x</span>

<span class="nv">expect</span><span class="w"> </span><span class="nv">identifyParts</span><span class="w"> </span><span class="nv">smallInput</span><span class="w"> </span><span class="nf">|&gt;</span><span class="w"> </span><span class="nv">appendAdjacentSymbol</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="nf">==</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="p">{</span><span class="w"> </span><span class="nv">cell</span><span class="nf">:</span><span class="w"> </span><span class="kt">Part</span><span class="w"> </span><span class="s">"11"</span><span class="p">,</span><span class="w"> </span><span class="nv">id</span><span class="nf">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="kr">type</span><span class="nf">:</span><span class="w"> </span><span class="kt">Correct</span><span class="w"> </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span><span class="w"> </span><span class="nv">cell</span><span class="nf">:</span><span class="w"> </span><span class="kt">Part</span><span class="w"> </span><span class="s">"11"</span><span class="p">,</span><span class="w"> </span><span class="nv">id</span><span class="nf">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="kr">type</span><span class="nf">:</span><span class="w"> </span><span class="kt">Correct</span><span class="w"> </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span><span class="w"> </span><span class="nv">cell</span><span class="nf">:</span><span class="w"> </span><span class="kt">Separator</span><span class="p">,</span><span class="w"> </span><span class="nv">id</span><span class="nf">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="kr">type</span><span class="nf">:</span><span class="w"> </span><span class="kt">NotAPart</span><span class="w"> </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span><span class="w"> </span><span class="nv">cell</span><span class="nf">:</span><span class="w"> </span><span class="kt">Part</span><span class="w"> </span><span class="s">"2"</span><span class="p">,</span><span class="w"> </span><span class="nv">id</span><span class="nf">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="kr">type</span><span class="nf">:</span><span class="w"> </span><span class="kt">Extra</span><span class="w"> </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span><span class="w"> </span><span class="nv">cell</span><span class="nf">:</span><span class="w"> </span><span class="kt">NewLine</span><span class="p">,</span><span class="w"> </span><span class="nv">id</span><span class="nf">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="kr">type</span><span class="nf">:</span><span class="w"> </span><span class="kt">NotAPart</span><span class="w"> </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span><span class="w"> </span><span class="nv">cell</span><span class="nf">:</span><span class="w"> </span><span class="kt">Symbol</span><span class="w"> </span><span class="kt">NotAGear</span><span class="p">,</span><span class="w"> </span><span class="nv">id</span><span class="nf">:</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="kr">type</span><span class="nf">:</span><span class="w"> </span><span class="kt">NotAPart</span><span class="w"> </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span><span class="w"> </span><span class="nv">cell</span><span class="nf">:</span><span class="w"> </span><span class="kt">Separator</span><span class="p">,</span><span class="w"> </span><span class="nv">id</span><span class="nf">:</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="kr">type</span><span class="nf">:</span><span class="w"> </span><span class="kt">NotAPart</span><span class="w"> </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span><span class="w"> </span><span class="nv">cell</span><span class="nf">:</span><span class="w"> </span><span class="kt">Separator</span><span class="p">,</span><span class="w"> </span><span class="nv">id</span><span class="nf">:</span><span class="w"> </span><span class="mi">6</span><span class="p">,</span><span class="w"> </span><span class="kr">type</span><span class="nf">:</span><span class="w"> </span><span class="kt">NotAPart</span><span class="w"> </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span><span class="w"> </span><span class="nv">cell</span><span class="nf">:</span><span class="w"> </span><span class="kt">Separator</span><span class="p">,</span><span class="w"> </span><span class="nv">id</span><span class="nf">:</span><span class="w"> </span><span class="mi">7</span><span class="p">,</span><span class="w"> </span><span class="kr">type</span><span class="nf">:</span><span class="w"> </span><span class="kt">NotAPart</span><span class="w"> </span><span class="p">}</span>
<span class="p">]</span>



<span class="nv">smallInput</span><span class="w"> </span><span class="nf">=</span>
<span class="w">  </span><span class="s">"""</span>
<span class="s">  11.2</span>
<span class="s">  $...</span>
<span class="s">  """</span><span class="w"> </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">Str</span><span class="nf">.</span><span class="nv">trim</span>

<span class="nv">smallGearInput</span><span class="w"> </span><span class="nf">=</span>
<span class="w">  </span><span class="s">"""</span>
<span class="s">  11.2</span>
<span class="s">  $.*.</span>
<span class="s">  """</span><span class="w"> </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">Str</span><span class="nf">.</span><span class="nv">trim</span>

<span class="nv">exampleInput</span><span class="w"> </span><span class="nf">=</span>
<span class="w">  </span><span class="s">"""</span>
<span class="s">  467..114..</span>
<span class="s">  ...*......</span>
<span class="s">  ..35..633.</span>
<span class="s">  ......#...</span>
<span class="s">  617*......</span>
<span class="s">  .....+.58.</span>
<span class="s">  ..592.....</span>
<span class="s">  ......755.</span>
<span class="s">  ...$.*....</span>
<span class="s">  .664.598..</span>
<span class="s">  """</span>
<span class="w">  </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">Str</span><span class="nf">.</span><span class="nv">trim</span>


<span class="nv">debug</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nf">\</span><span class="nv">v</span><span class="p">,</span><span class="w"> </span><span class="nv">ctx</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">  </span><span class="nv">dbg</span><span class="w"> </span><span class="nv">ctx</span>
<span class="w">  </span><span class="nv">dbg</span><span class="w"> </span><span class="nv">v</span>
<span class="w">  </span><span class="nv">v</span>
</code></pre></div>
</div></div>



<a name="405702570"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/358903-advent%20of%20code/topic/2023%20Day%203/near/405702570" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/358903-advent-of-code/topic/2023.20Day.203.html#405702570">(Dec 03 2023 at 22:08)</a>:</h4>
<p><code>Set.toList</code> definitely is not fast currently, but I wouldn't expect to to totally ruin perf. Though I guess it depends on the size of the lists</p>
<p><a href="https://github.com/roc-lang/roc/blob/a187d141bd881e3515133ee484fb8ffa1ba790e8/crates/compiler/builtins/roc/Dict.roc#L194">https://github.com/roc-lang/roc/blob/a187d141bd881e3515133ee484fb8ffa1ba790e8/crates/compiler/builtins/roc/Dict.roc#L194</a></p>



<a name="405702586"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/358903-advent%20of%20code/topic/2023%20Day%203/near/405702586" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Asbjørn Olling <a href="https://roc-lang.github.io/zulip-export/stream/358903-advent-of-code/topic/2023.20Day.203.html#405702586">(Dec 03 2023 at 22:08)</a>:</h4>
<p>Alrighty, here's my day 3: <a href="https://gitlab.com/AsbjornOlling/aoc2023/-/blob/main/03/main.roc">https://gitlab.com/AsbjornOlling/aoc2023/-/blob/main/03/main.roc</a></p>
<p>Had to do a bit of a refactor for part2, but managed to reuse almost all of my code- and stuff just worked once <code>roc dev</code> stopped politely informing me that I was wrong about something.</p>
<p>Took some typing, but otherwise pretty painless day.</p>
<div class="spoiler-block"><div class="spoiler-header">
<p>part2 spoilers</p>
</div><div class="spoiler-content" aria-hidden="true">
<p>I spent very little on parsing today. Just made a big ol' <code>List (List U8)</code> and went from there.<br>
My part-two refactor was basically just turning it into a <code>List (List ((Nat, Nat), U8))</code> instead, so I could track of which specific neighbors a number has. (the <code>(Nat, Nat)</code> tuple is the coords of a given char, but really it's just a unique identifier).</p>
</div></div>
<p>Probably not as performant as it could be, but hey. I'm happy with this.</p>



<a name="405704401"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/358903-advent%20of%20code/topic/2023%20Day%203/near/405704401" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pearce Keesling <a href="https://roc-lang.github.io/zulip-export/stream/358903-advent-of-code/topic/2023.20Day.203.html#405704401">(Dec 03 2023 at 22:35)</a>:</h4>
<p>Really bad performance for my solutions today (takes about 10s to run both parts <span aria-label="grimacing" class="emoji emoji-1f62c" role="img" title="grimacing">:grimacing:</span>) <a href="https://github.com/keeslinp/AoC2023/blob/main/day3.roc">https://github.com/keeslinp/AoC2023/blob/main/day3.roc</a> still got both answers first try though which just shows how good the type system + expect workflow works.</p>
<p>I think I'm really starting to feel the pain of not having syntax highlighting setup correctly for my editor (I tried getting the treesitter stuff running but helix doesn't seem to actually display it, idk why). I kept getting a little lost, but thankfully hover from the LSP was super helpful trying to figure out how nested my lists were at any given point. Maybe a roc formatter would help me, I don't really know the best way to format things yet.</p>
<p>Also my solution crashes if I turn on optimize so maybe the performance wouldn't be so bad if it were on</p>



<a name="405704638"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/358903-advent%20of%20code/topic/2023%20Day%203/near/405704638" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/358903-advent-of-code/topic/2023.20Day.203.html#405704638">(Dec 03 2023 at 22:38)</a>:</h4>
<p><code>roc format</code> will format things for you! <span aria-label="smiley" class="emoji emoji-1f603" role="img" title="smiley">:smiley:</span></p>



<a name="405705129"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/358903-advent%20of%20code/topic/2023%20Day%203/near/405705129" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/358903-advent-of-code/topic/2023.20Day.203.html#405705129">(Dec 03 2023 at 22:45)</a>:</h4>
<p>For helix, make sure you also copy the queries over</p>



<a name="405705156"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/358903-advent%20of%20code/topic/2023%20Day%203/near/405705156" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/358903-advent-of-code/topic/2023.20Day.203.html#405705156">(Dec 03 2023 at 22:45)</a>:</h4>
<p>So add the grammar, build it, copy the queries so helix knows about them</p>



<a name="405705622"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/358903-advent%20of%20code/topic/2023%20Day%203/near/405705622" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Fabian Schmalzried <a href="https://roc-lang.github.io/zulip-export/stream/358903-advent-of-code/topic/2023.20Day.203.html#405705622">(Dec 03 2023 at 22:51)</a>:</h4>
<p>Here is also my solution:</p>
<div class="spoiler-block"><div class="spoiler-header">
<p>code</p>
</div><div class="spoiler-content" aria-hidden="true">
<div class="codehilite" data-code-language="Elm"><pre><span></span><code><span class="nv">app</span><span class="w"> </span><span class="s">"AoC"</span>
<span class="w">    </span><span class="nv">packages</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nv">pf</span><span class="nf">:</span><span class="w"> </span><span class="s">"https://github.com/roc-lang/basic-cli/releases/download/0.7.0/bkGby8jb0tmZYsy2hg1E_B2QrCgcSTxdUlHtETwm5m4.tar.br"</span><span class="w"> </span><span class="p">}</span>

<span class="w">    </span><span class="nv">imports</span><span class="w"> </span><span class="p">[</span><span class="nv">pf</span><span class="nf">.</span><span class="kt">Stdout</span><span class="p">,</span><span class="w"> </span><span class="nv">pf</span><span class="nf">.</span><span class="kt">Task</span><span class="nf">.</span><span class="p">{</span><span class="w"> </span><span class="kt">Task</span><span class="w"> </span><span class="p">},</span><span class="w"> </span><span class="s">"day-3-input.txt"</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="nv">input</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Str</span><span class="p">]</span>
<span class="w">    </span><span class="nv">provides</span><span class="w"> </span><span class="p">[</span><span class="nv">main</span><span class="p">]</span><span class="w"> </span><span class="nv">to</span><span class="w"> </span><span class="nv">pf</span>

<span class="kr">main </span><span class="nf">:</span><span class="w"> </span><span class="kt">Task</span><span class="w"> </span><span class="p">{}</span><span class="w"> </span><span class="nf">*</span>
<span class="kr">main </span><span class="nf">=</span>
<span class="w">    </span><span class="nv">dbg</span>
<span class="w">        </span><span class="kt">P1</span><span class="w"> </span><span class="p">(</span><span class="nv">part1</span><span class="w"> </span><span class="nv">input</span><span class="p">)</span>

<span class="w">    </span><span class="nv">dbg</span>
<span class="w">        </span><span class="kt">P2</span><span class="w"> </span><span class="p">(</span><span class="nv">part2</span><span class="w"> </span><span class="nv">input</span><span class="p">)</span>

<span class="w">    </span><span class="kt">Stdout</span><span class="nf">.</span><span class="nv">line</span><span class="w"> </span><span class="s">"done"</span>

<span class="nv">part1</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nf">\</span><span class="nv">str</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">    </span><span class="nv">s</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="kt">Str</span><span class="nf">.</span><span class="nv">toUtf8</span><span class="w"> </span><span class="nv">str</span>
<span class="w">    </span><span class="nv">lineLength</span><span class="w"> </span><span class="nf">=</span>
<span class="w">        </span><span class="kt">List</span><span class="nf">.</span><span class="nv">findFirstIndex</span><span class="w"> </span><span class="nv">s</span><span class="w"> </span><span class="p">(</span><span class="nf">\</span><span class="nv">c</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="nv">c</span><span class="w"> </span><span class="nf">==</span><span class="w"> </span><span class="nf">'\</span><span class="nv">n'</span><span class="p">)</span>
<span class="w">        </span><span class="nf">|&gt;</span><span class="w"> </span><span class="nv">unwrap</span>
<span class="w">        </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">Num</span><span class="nf">.</span><span class="nv">add</span><span class="w"> </span><span class="mi">1</span>

<span class="w">    </span><span class="nv">startState</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nv">row</span><span class="nf">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<span class="w">        </span><span class="nv">sum</span><span class="nf">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<span class="w">        </span><span class="nv">currentNumber</span><span class="nf">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<span class="w">        </span><span class="nv">shouldAdd</span><span class="nf">:</span><span class="w"> </span><span class="kt">Bool</span><span class="nf">.</span><span class="nv">false</span><span class="p">,</span>

<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="nv">s</span>
<span class="w">    </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">List</span><span class="nf">.</span><span class="nv">walkWithIndex</span><span class="w"> </span><span class="nv">startState</span><span class="w"> </span><span class="nf">\</span><span class="nv">state</span><span class="p">,</span><span class="w"> </span><span class="nv">elem</span><span class="p">,</span><span class="w"> </span><span class="nv">index</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="nv">sumPartNumbers</span><span class="w"> </span><span class="nv">state</span><span class="w"> </span><span class="nv">elem</span><span class="w"> </span><span class="nv">s</span><span class="w"> </span><span class="nv">index</span><span class="w"> </span><span class="nv">lineLength</span>

<span class="nv">part2</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nf">\</span><span class="nv">str</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">    </span><span class="nv">s</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="kt">Str</span><span class="nf">.</span><span class="nv">toUtf8</span><span class="w"> </span><span class="nv">str</span>
<span class="w">    </span><span class="nv">lineLength</span><span class="w"> </span><span class="nf">=</span>
<span class="w">        </span><span class="kt">List</span><span class="nf">.</span><span class="nv">findFirstIndex</span><span class="w"> </span><span class="nv">s</span><span class="w"> </span><span class="p">(</span><span class="nf">\</span><span class="nv">c</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="nv">c</span><span class="w"> </span><span class="nf">==</span><span class="w"> </span><span class="nf">'\</span><span class="nv">n'</span><span class="p">)</span>
<span class="w">        </span><span class="nf">|&gt;</span><span class="w"> </span><span class="nv">unwrap</span>
<span class="w">        </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">Num</span><span class="nf">.</span><span class="nv">add</span><span class="w"> </span><span class="mi">1</span>

<span class="w">    </span><span class="nv">startState</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">    </span><span class="kt">List</span><span class="nf">.</span><span class="nv">walkWithIndex</span><span class="w"> </span><span class="nv">s</span><span class="w"> </span><span class="nv">startState</span><span class="w"> </span><span class="nf">\</span><span class="nv">state</span><span class="p">,</span><span class="w"> </span><span class="nv">elem</span><span class="p">,</span><span class="w"> </span><span class="nv">index</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="nv">sumGearRatio</span><span class="w"> </span><span class="nv">state</span><span class="w"> </span><span class="nv">elem</span><span class="w"> </span><span class="nv">s</span><span class="w"> </span><span class="nv">index</span><span class="w"> </span><span class="nv">lineLength</span>

<span class="nv">sumGearRatio</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nf">\</span><span class="nv">state</span><span class="p">,</span><span class="w"> </span><span class="nv">elem</span><span class="p">,</span><span class="w"> </span><span class="nv">inp</span><span class="p">,</span><span class="w"> </span><span class="nv">index</span><span class="p">,</span><span class="w"> </span><span class="nv">lineLength</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">    </span><span class="kr">if</span><span class="w"> </span><span class="nv">elem</span><span class="w"> </span><span class="nf">==</span><span class="w"> </span><span class="nf">'*'</span><span class="w"> </span><span class="kr">then</span>
<span class="w">        </span><span class="nv">nearNumbers</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nv">getNumbersNear</span><span class="w"> </span><span class="nv">inp</span><span class="w"> </span><span class="nv">index</span><span class="w"> </span><span class="nv">lineLength</span>
<span class="w">        </span><span class="kr">if</span><span class="w"> </span><span class="kt">List</span><span class="nf">.</span><span class="nv">len</span><span class="w"> </span><span class="nv">nearNumbers</span><span class="w"> </span><span class="nf">==</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="kr">then</span>
<span class="w">            </span><span class="nv">state</span><span class="w"> </span><span class="nf">+</span><span class="w"> </span><span class="kt">List</span><span class="nf">.</span><span class="nv">product</span><span class="w"> </span><span class="nv">nearNumbers</span>
<span class="w">        </span><span class="kr">else</span>
<span class="w">            </span><span class="nv">state</span>
<span class="w">    </span><span class="kr">else</span>
<span class="w">        </span><span class="nv">state</span>

<span class="nv">getNumbersNear</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nf">\</span><span class="nv">list</span><span class="p">,</span><span class="w"> </span><span class="nv">index</span><span class="p">,</span><span class="w"> </span><span class="nv">lineLength</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">    </span><span class="nv">getToRight</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nf">\</span><span class="nv">pos</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">        </span><span class="kr">if</span><span class="w"> </span><span class="nv">isDigitAt</span><span class="w"> </span><span class="nv">list</span><span class="w"> </span><span class="nv">pos</span><span class="w"> </span><span class="kr">then</span>
<span class="w">            </span><span class="kt">List</span><span class="nf">.</span><span class="nv">dropFirst</span><span class="w"> </span><span class="nv">list</span><span class="w"> </span><span class="nv">pos</span>
<span class="w">            </span><span class="nf">|&gt;</span><span class="w"> </span><span class="nv">takeWhile</span><span class="w"> </span><span class="nv">isDigit</span>
<span class="w">            </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">Str</span><span class="nf">.</span><span class="nv">fromUtf8</span>
<span class="w">            </span><span class="nf">|&gt;</span><span class="w"> </span><span class="nv">unwrap</span>
<span class="w">            </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">Str</span><span class="nf">.</span><span class="nv">toNat</span>
<span class="w">            </span><span class="nf">|&gt;</span><span class="w"> </span><span class="nv">unwrap</span>
<span class="w">            </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">Ok</span>
<span class="w">        </span><span class="kr">else</span>
<span class="w">            </span><span class="kt">Err</span><span class="w"> </span><span class="kt">NoNumber</span>
<span class="w">    </span><span class="nv">getToLeft</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nf">\</span><span class="nv">pos</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">        </span><span class="kr">if</span><span class="w"> </span><span class="nv">isDigitAt</span><span class="w"> </span><span class="nv">list</span><span class="w"> </span><span class="nv">pos</span><span class="w"> </span><span class="kr">then</span>
<span class="w">            </span><span class="kt">List</span><span class="nf">.</span><span class="nv">takeFirst</span><span class="w"> </span><span class="nv">list</span><span class="w"> </span><span class="p">(</span><span class="nv">pos</span><span class="w"> </span><span class="nf">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>
<span class="w">            </span><span class="nf">|&gt;</span><span class="w"> </span><span class="nv">takeWhileBackwards</span><span class="w"> </span><span class="nv">isDigit</span>
<span class="w">            </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">Str</span><span class="nf">.</span><span class="nv">fromUtf8</span>
<span class="w">            </span><span class="nf">|&gt;</span><span class="w"> </span><span class="nv">unwrap</span>
<span class="w">            </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">Str</span><span class="nf">.</span><span class="nv">toNat</span>
<span class="w">            </span><span class="nf">|&gt;</span><span class="w"> </span><span class="nv">unwrap</span>
<span class="w">            </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">Ok</span>
<span class="w">        </span><span class="kr">else</span>
<span class="w">            </span><span class="kt">Err</span><span class="w"> </span><span class="kt">NoNumber</span>

<span class="w">    </span><span class="nv">right</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nv">getToRight</span><span class="w"> </span><span class="p">(</span><span class="nv">index</span><span class="w"> </span><span class="nf">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>
<span class="w">    </span><span class="nv">left</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nv">getToLeft</span><span class="w"> </span><span class="p">(</span><span class="nv">index</span><span class="w"> </span><span class="nf">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>

<span class="w">    </span><span class="nv">topindex</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="kt">Num</span><span class="nf">.</span><span class="nv">subWrap</span><span class="w"> </span><span class="nv">index</span><span class="w"> </span><span class="nv">lineLength</span>
<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="nv">extracting</span><span class="w"> </span><span class="nv">this</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="nv">a</span><span class="w"> </span><span class="nv">closure</span><span class="w"> </span><span class="nv">creates</span><span class="w"> </span><span class="nv">a</span><span class="w"> </span><span class="nv">compiler</span><span class="w"> </span><span class="nv">error</span><span class="p">,</span><span class="w"> </span><span class="nv">that's</span><span class="w"> </span><span class="nv">why</span><span class="w"> </span><span class="nv">it</span><span class="w"> </span><span class="nv">is</span><span class="w"> </span><span class="nv">copied</span><span class="w"> </span><span class="nv">for</span><span class="w"> </span><span class="nv">bottom</span>
<span class="w">    </span><span class="nv">top</span><span class="w"> </span><span class="nf">=</span>
<span class="w">        </span><span class="kr">if</span><span class="w"> </span><span class="nv">isDigitAt</span><span class="w"> </span><span class="nv">list</span><span class="w"> </span><span class="nv">topindex</span><span class="w"> </span><span class="kr">then</span>
<span class="w">            </span><span class="err">#</span><span class="w"> </span><span class="nv">only</span><span class="w"> </span><span class="nv">one</span><span class="w"> </span><span class="nv">possible</span>
<span class="w">            </span><span class="nv">leftPart</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                </span><span class="kt">List</span><span class="nf">.</span><span class="nv">takeFirst</span><span class="w"> </span><span class="nv">list</span><span class="w"> </span><span class="nv">topindex</span>
<span class="w">                </span><span class="nf">|&gt;</span><span class="w"> </span><span class="nv">takeWhileBackwards</span><span class="w"> </span><span class="nv">isDigit</span>
<span class="w">            </span><span class="nv">rightPart</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                </span><span class="kt">List</span><span class="nf">.</span><span class="nv">dropFirst</span><span class="w"> </span><span class="nv">list</span><span class="w"> </span><span class="nv">topindex</span>
<span class="w">                </span><span class="nf">|&gt;</span><span class="w"> </span><span class="nv">takeWhile</span><span class="w"> </span><span class="nv">isDigit</span>
<span class="w">            </span><span class="kt">List</span><span class="nf">.</span><span class="nv">concat</span><span class="w"> </span><span class="nv">leftPart</span><span class="w"> </span><span class="nv">rightPart</span>
<span class="w">            </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">Str</span><span class="nf">.</span><span class="nv">fromUtf8</span>
<span class="w">            </span><span class="nf">|&gt;</span><span class="w"> </span><span class="nv">unwrap</span>
<span class="w">            </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">Str</span><span class="nf">.</span><span class="nv">toNat</span>
<span class="w">            </span><span class="nf">|&gt;</span><span class="w"> </span><span class="nv">unwrap</span>
<span class="w">            </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">List</span><span class="nf">.</span><span class="nv">single</span>
<span class="w">        </span><span class="kr">else</span>
<span class="w">            </span><span class="p">[</span><span class="nv">getToRight</span><span class="w"> </span><span class="p">(</span><span class="nv">topindex</span><span class="w"> </span><span class="nf">+</span><span class="w"> </span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="nv">getToLeft</span><span class="w"> </span><span class="p">(</span><span class="nv">topindex</span><span class="w"> </span><span class="nf">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)]</span>
<span class="w">            </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">List</span><span class="nf">.</span><span class="nv">keepOks</span><span class="w"> </span><span class="nf">\</span><span class="nv">x</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="nv">x</span>

<span class="w">    </span><span class="nv">bottomindex</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nv">index</span><span class="w"> </span><span class="nf">+</span><span class="w"> </span><span class="nv">lineLength</span>
<span class="w">    </span><span class="nv">bottom</span><span class="w"> </span><span class="nf">=</span>
<span class="w">        </span><span class="kr">if</span><span class="w"> </span><span class="nv">isDigitAt</span><span class="w"> </span><span class="nv">list</span><span class="w"> </span><span class="nv">bottomindex</span><span class="w"> </span><span class="kr">then</span>
<span class="w">            </span><span class="err">#</span><span class="w"> </span><span class="nv">only</span><span class="w"> </span><span class="nv">one</span><span class="w"> </span><span class="nv">possible</span>
<span class="w">            </span><span class="nv">leftPart</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                </span><span class="kt">List</span><span class="nf">.</span><span class="nv">takeFirst</span><span class="w"> </span><span class="nv">list</span><span class="w"> </span><span class="nv">bottomindex</span>
<span class="w">                </span><span class="nf">|&gt;</span><span class="w"> </span><span class="nv">takeWhileBackwards</span><span class="w"> </span><span class="nv">isDigit</span>
<span class="w">            </span><span class="nv">rightPart</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                </span><span class="kt">List</span><span class="nf">.</span><span class="nv">dropFirst</span><span class="w"> </span><span class="nv">list</span><span class="w"> </span><span class="nv">bottomindex</span>
<span class="w">                </span><span class="nf">|&gt;</span><span class="w"> </span><span class="nv">takeWhile</span><span class="w"> </span><span class="nv">isDigit</span>
<span class="w">            </span><span class="kt">List</span><span class="nf">.</span><span class="nv">concat</span><span class="w"> </span><span class="nv">leftPart</span><span class="w"> </span><span class="nv">rightPart</span>
<span class="w">            </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">Str</span><span class="nf">.</span><span class="nv">fromUtf8</span>
<span class="w">            </span><span class="nf">|&gt;</span><span class="w"> </span><span class="nv">unwrap</span>
<span class="w">            </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">Str</span><span class="nf">.</span><span class="nv">toNat</span>
<span class="w">            </span><span class="nf">|&gt;</span><span class="w"> </span><span class="nv">unwrap</span>
<span class="w">            </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">List</span><span class="nf">.</span><span class="nv">single</span>
<span class="w">        </span><span class="kr">else</span>
<span class="w">            </span><span class="p">[</span><span class="nv">getToRight</span><span class="w"> </span><span class="p">(</span><span class="nv">bottomindex</span><span class="w"> </span><span class="nf">+</span><span class="w"> </span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="nv">getToLeft</span><span class="w"> </span><span class="p">(</span><span class="nv">bottomindex</span><span class="w"> </span><span class="nf">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)]</span>
<span class="w">            </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">List</span><span class="nf">.</span><span class="nv">keepOks</span><span class="w"> </span><span class="nf">\</span><span class="nv">x</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="nv">x</span>
<span class="w">    </span><span class="p">[</span><span class="nv">right</span><span class="p">,</span><span class="w"> </span><span class="nv">left</span><span class="p">]</span>
<span class="w">    </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">List</span><span class="nf">.</span><span class="nv">keepOks</span><span class="w"> </span><span class="nf">\</span><span class="nv">x</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="nv">x</span>
<span class="w">    </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">List</span><span class="nf">.</span><span class="nv">concat</span><span class="w"> </span><span class="nv">top</span>
<span class="w">    </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">List</span><span class="nf">.</span><span class="nv">concat</span><span class="w"> </span><span class="nv">bottom</span>

<span class="nv">takeWhile</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nf">\</span><span class="nv">list</span><span class="p">,</span><span class="w"> </span><span class="nv">cond</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">    </span><span class="nv">when</span><span class="w"> </span><span class="kt">List</span><span class="nf">.</span><span class="nv">findFirstIndex</span><span class="w"> </span><span class="nv">list</span><span class="w"> </span><span class="nf">\</span><span class="nv">elem</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="err">!</span><span class="p">(</span><span class="nv">cond</span><span class="w"> </span><span class="nv">elem</span><span class="p">)</span><span class="w"> </span><span class="nv">is</span>
<span class="w">        </span><span class="kt">Ok</span><span class="w"> </span><span class="nv">firstWrongIndex</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">List</span><span class="nf">.</span><span class="nv">takeFirst</span><span class="w"> </span><span class="nv">list</span><span class="w"> </span><span class="nv">firstWrongIndex</span>
<span class="w">        </span><span class="kt">Err</span><span class="w"> </span><span class="kt">NotFound</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="nv">list</span>

<span class="nv">takeWhileBackwards</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nf">\</span><span class="nv">list</span><span class="p">,</span><span class="w"> </span><span class="nv">cond</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">    </span><span class="nv">when</span><span class="w"> </span><span class="kt">List</span><span class="nf">.</span><span class="nv">findLastIndex</span><span class="w"> </span><span class="nv">list</span><span class="w"> </span><span class="nf">\</span><span class="nv">elem</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="err">!</span><span class="p">(</span><span class="nv">cond</span><span class="w"> </span><span class="nv">elem</span><span class="p">)</span><span class="w"> </span><span class="nv">is</span>
<span class="w">        </span><span class="kt">Ok</span><span class="w"> </span><span class="nv">lastWrongIndex</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">List</span><span class="nf">.</span><span class="nv">dropFirst</span><span class="w"> </span><span class="nv">list</span><span class="w"> </span><span class="p">(</span><span class="nv">lastWrongIndex</span><span class="w"> </span><span class="nf">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>
<span class="w">        </span><span class="kt">Err</span><span class="w"> </span><span class="kt">NotFound</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="nv">list</span>

<span class="nv">isDigitAt</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nf">\</span><span class="nv">list</span><span class="p">,</span><span class="w"> </span><span class="nv">index</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">    </span><span class="nv">when</span><span class="w"> </span><span class="kt">List</span><span class="nf">.</span><span class="nv">get</span><span class="w"> </span><span class="nv">list</span><span class="w"> </span><span class="nv">index</span><span class="w"> </span><span class="nv">is</span>
<span class="w">        </span><span class="kt">Err</span><span class="w"> </span><span class="nv">_</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Bool</span><span class="nf">.</span><span class="nv">false</span>
<span class="w">        </span><span class="kt">Ok</span><span class="w"> </span><span class="nv">d</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="nv">isDigit</span><span class="w"> </span><span class="nv">d</span>

<span class="nv">sumPartNumbers</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nf">\</span><span class="nv">state</span><span class="p">,</span><span class="w"> </span><span class="nv">elem</span><span class="p">,</span><span class="w"> </span><span class="nv">inp</span><span class="p">,</span><span class="w"> </span><span class="nv">index</span><span class="p">,</span><span class="w"> </span><span class="nv">lineLength</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">    </span><span class="kr">if</span><span class="w"> </span><span class="nv">elem</span><span class="w"> </span><span class="nf">==</span><span class="w"> </span><span class="nf">'\</span><span class="nv">n'</span><span class="w"> </span><span class="kr">then</span>
<span class="w">        </span><span class="kr">if</span><span class="w"> </span><span class="nv">state</span><span class="nf">.</span><span class="nv">shouldAdd</span><span class="w"> </span><span class="kr">then</span>
<span class="w">            </span><span class="nv">newState</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nv">addToSum</span><span class="w"> </span><span class="nv">state</span>
<span class="w">            </span><span class="p">{</span><span class="w"> </span><span class="nv">newState</span><span class="w"> </span><span class="err">&amp;</span><span class="w"> </span><span class="nv">row</span><span class="nf">:</span><span class="w"> </span><span class="nv">state</span><span class="nf">.</span><span class="nv">row</span><span class="w"> </span><span class="nf">+</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">}</span>
<span class="w">        </span><span class="kr">else</span>
<span class="w">            </span><span class="p">{</span><span class="w"> </span><span class="nv">state</span><span class="w"> </span><span class="err">&amp;</span><span class="w"> </span><span class="nv">row</span><span class="nf">:</span><span class="w"> </span><span class="nv">state</span><span class="nf">.</span><span class="nv">row</span><span class="w"> </span><span class="nf">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="nv">currentNumber</span><span class="nf">:</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">}</span>
<span class="w">    </span><span class="kr">else</span><span class="w"> </span><span class="kr">if</span><span class="w"> </span><span class="nv">isDigit</span><span class="w"> </span><span class="nv">elem</span><span class="w"> </span><span class="kr">then</span>
<span class="w">        </span><span class="p">{</span><span class="w"> </span><span class="nv">state</span><span class="w"> </span><span class="err">&amp;</span><span class="w"> </span><span class="nv">currentNumber</span><span class="nf">:</span><span class="w"> </span><span class="nv">state</span><span class="nf">.</span><span class="nv">currentNumber</span><span class="w"> </span><span class="nf">*</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="nf">+</span><span class="w"> </span><span class="p">(</span><span class="kt">Num</span><span class="nf">.</span><span class="nv">toNat</span><span class="w"> </span><span class="nv">elem</span><span class="p">)</span><span class="w"> </span><span class="nf">-</span><span class="w"> </span><span class="nf">'</span><span class="mi">0</span><span class="nf">'</span><span class="p">,</span><span class="w"> </span><span class="nv">shouldAdd</span><span class="nf">:</span><span class="w"> </span><span class="nv">state</span><span class="nf">.</span><span class="nv">shouldAdd</span><span class="w"> </span><span class="nf">||</span><span class="w"> </span><span class="nv">hasSymbolNear</span><span class="w"> </span><span class="nv">inp</span><span class="w"> </span><span class="nv">index</span><span class="w"> </span><span class="nv">lineLength</span><span class="w"> </span><span class="p">}</span>
<span class="w">    </span><span class="kr">else</span><span class="w"> </span><span class="kr">if</span><span class="w"> </span><span class="nv">state</span><span class="nf">.</span><span class="nv">shouldAdd</span><span class="w"> </span><span class="kr">then</span>
<span class="w">        </span><span class="nv">addToSum</span><span class="w"> </span><span class="nv">state</span>
<span class="w">    </span><span class="kr">else</span>
<span class="w">        </span><span class="p">{</span><span class="w"> </span><span class="nv">state</span><span class="w"> </span><span class="err">&amp;</span><span class="w"> </span><span class="nv">currentNumber</span><span class="nf">:</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">}</span>

<span class="nv">hasSymbolNear</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nf">\</span><span class="nv">list</span><span class="p">,</span><span class="w"> </span><span class="nv">index</span><span class="p">,</span><span class="w"> </span><span class="nv">lineLength</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">    </span><span class="nv">isSymbolAt</span><span class="w"> </span><span class="nv">list</span><span class="w"> </span><span class="p">(</span><span class="nv">index</span><span class="w"> </span><span class="nf">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>
<span class="w">    </span><span class="nf">||</span><span class="w"> </span><span class="nv">isSymbolAt</span><span class="w"> </span><span class="nv">list</span><span class="w"> </span><span class="p">(</span><span class="kt">Num</span><span class="nf">.</span><span class="nv">subWrap</span><span class="w"> </span><span class="nv">index</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>
<span class="w">    </span><span class="nf">||</span><span class="w"> </span><span class="nv">isSymbolAt</span><span class="w"> </span><span class="nv">list</span><span class="w"> </span><span class="p">(</span><span class="nv">index</span><span class="w"> </span><span class="nf">+</span><span class="w"> </span><span class="nv">lineLength</span><span class="p">)</span>
<span class="w">    </span><span class="nf">||</span><span class="w"> </span><span class="nv">isSymbolAt</span><span class="w"> </span><span class="nv">list</span><span class="w"> </span><span class="p">(</span><span class="nv">index</span><span class="w"> </span><span class="nf">+</span><span class="w"> </span><span class="nv">lineLength</span><span class="w"> </span><span class="nf">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>
<span class="w">    </span><span class="nf">||</span><span class="w"> </span><span class="nv">isSymbolAt</span><span class="w"> </span><span class="nv">list</span><span class="w"> </span><span class="p">(</span><span class="nv">index</span><span class="w"> </span><span class="nf">+</span><span class="w"> </span><span class="nv">lineLength</span><span class="w"> </span><span class="nf">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>
<span class="w">    </span><span class="nf">||</span><span class="w"> </span><span class="nv">isSymbolAt</span><span class="w"> </span><span class="nv">list</span><span class="w"> </span><span class="p">(</span><span class="kt">Num</span><span class="nf">.</span><span class="nv">subWrap</span><span class="w"> </span><span class="nv">index</span><span class="w"> </span><span class="nv">lineLength</span><span class="p">)</span>
<span class="w">    </span><span class="nf">||</span><span class="w"> </span><span class="nv">isSymbolAt</span><span class="w"> </span><span class="nv">list</span><span class="w"> </span><span class="p">(</span><span class="kt">Num</span><span class="nf">.</span><span class="nv">subWrap</span><span class="w"> </span><span class="nv">index</span><span class="w"> </span><span class="p">(</span><span class="nv">lineLength</span><span class="w"> </span><span class="nf">-</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span>
<span class="w">    </span><span class="nf">||</span><span class="w"> </span><span class="nv">isSymbolAt</span><span class="w"> </span><span class="nv">list</span><span class="w"> </span><span class="p">(</span><span class="kt">Num</span><span class="nf">.</span><span class="nv">subWrap</span><span class="w"> </span><span class="nv">index</span><span class="w"> </span><span class="p">(</span><span class="nv">lineLength</span><span class="w"> </span><span class="nf">+</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span>

<span class="nv">isSymbolAt</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nf">\</span><span class="nv">list</span><span class="p">,</span><span class="w"> </span><span class="nv">index</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">    </span><span class="nv">when</span><span class="w"> </span><span class="kt">List</span><span class="nf">.</span><span class="nv">get</span><span class="w"> </span><span class="nv">list</span><span class="w"> </span><span class="nv">index</span><span class="w"> </span><span class="nv">is</span>
<span class="w">        </span><span class="kt">Err</span><span class="w"> </span><span class="nv">_</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Bool</span><span class="nf">.</span><span class="nv">false</span>
<span class="w">        </span><span class="kt">Ok</span><span class="w"> </span><span class="nv">d</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="nv">isSymbol</span><span class="w"> </span><span class="nv">d</span>

<span class="nv">isSymbol</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nf">\</span><span class="nv">c</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">    </span><span class="p">(</span><span class="nv">c</span><span class="w"> </span><span class="nf">&lt;</span><span class="w"> </span><span class="nf">'</span><span class="mi">0</span><span class="nf">'</span><span class="w"> </span><span class="nf">||</span><span class="w"> </span><span class="nv">c</span><span class="w"> </span><span class="nf">&gt;</span><span class="w"> </span><span class="nf">'</span><span class="mi">9</span><span class="nf">'</span><span class="p">)</span><span class="w"> </span><span class="nf">&amp;&amp;</span><span class="w"> </span><span class="nv">c</span><span class="w"> </span><span class="err">!</span><span class="nf">=</span><span class="w"> </span><span class="nf">'.'</span><span class="w"> </span><span class="nf">&amp;&amp;</span><span class="w"> </span><span class="nv">c</span><span class="w"> </span><span class="err">!</span><span class="nf">=</span><span class="w"> </span><span class="nf">'\</span><span class="nv">n'</span>

<span class="nv">isDigit</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nf">\</span><span class="nv">c</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">    </span><span class="nv">c</span><span class="w"> </span><span class="nf">&gt;=</span><span class="w"> </span><span class="nf">'</span><span class="mi">0</span><span class="nf">'</span><span class="w"> </span><span class="nf">&amp;&amp;</span><span class="w"> </span><span class="nv">c</span><span class="w"> </span><span class="nf">&lt;=</span><span class="w"> </span><span class="nf">'</span><span class="mi">9</span><span class="nf">'</span>

<span class="nv">addToSum</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nf">\</span><span class="nv">state</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">    </span><span class="p">{</span><span class="w"> </span><span class="nv">state</span><span class="w"> </span><span class="err">&amp;</span><span class="w"> </span><span class="nv">sum</span><span class="nf">:</span><span class="w"> </span><span class="nv">state</span><span class="nf">.</span><span class="nv">sum</span><span class="w"> </span><span class="nf">+</span><span class="w"> </span><span class="nv">state</span><span class="nf">.</span><span class="nv">currentNumber</span><span class="p">,</span><span class="w"> </span><span class="nv">shouldAdd</span><span class="nf">:</span><span class="w"> </span><span class="kt">Bool</span><span class="nf">.</span><span class="nv">false</span><span class="p">,</span><span class="w"> </span><span class="nv">currentNumber</span><span class="nf">:</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">}</span>

<span class="nv">example</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Str</span>
<span class="nv">example</span><span class="w"> </span><span class="nf">=</span>
<span class="w">    </span><span class="s">"""</span>
<span class="s">    467..114..</span>
<span class="s">    ...*......</span>
<span class="s">    ..35..633.</span>
<span class="s">    ......#...</span>
<span class="s">    617*......</span>
<span class="s">    .....+.58.</span>
<span class="s">    ..592.....</span>
<span class="s">    ......755.</span>
<span class="s">    ...$.*....</span>
<span class="s">    .664.598..</span>
<span class="s">    """</span>

<span class="nv">unwrap</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nf">\</span><span class="nv">res</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">    </span><span class="nv">when</span><span class="w"> </span><span class="nv">res</span><span class="w"> </span><span class="nv">is</span>
<span class="w">        </span><span class="kt">Ok</span><span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="nv">x</span>
<span class="w">        </span><span class="kt">Err</span><span class="w"> </span><span class="nv">_</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="nv">crash</span><span class="w"> </span><span class="s">"bad unwrap"</span>
</code></pre></div>
</div></div>
<p>Part 1 was pretty quick for me, but I could not reuse it for part 2, so quite some more typing for part 2. Performance is good, but I did run into a bug at one point. I will try to create a minimal example for it before opening a bug on github.</p>



<a name="405708231"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/358903-advent%20of%20code/topic/2023%20Day%203/near/405708231" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Axel <a href="https://roc-lang.github.io/zulip-export/stream/358903-advent-of-code/topic/2023.20Day.203.html#405708231">(Dec 03 2023 at 23:26)</a>:</h4>
<p>Late to the party, but <a href="https://github.com/axelerator/aoc23/blob/main/03/main.roc">here is mine</a> (also just using Array2D, no perf problems <span aria-label="see no evil" class="emoji emoji-1f648" role="img" title="see no evil">:see_no_evil:</span> )<br>
The thing that bogs me down most is that <code>dbg</code> doesn't work during test runs (at leas on my Mac). It just terminates with <code>[1]    85268 trace trap  roc test</code></p>



<a name="405708817"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/358903-advent%20of%20code/topic/2023%20Day%203/near/405708817" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/358903-advent-of-code/topic/2023.20Day.203.html#405708817">(Dec 03 2023 at 23:31)</a>:</h4>
<p>should be fixed on main</p>



<a name="405708843"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/358903-advent%20of%20code/topic/2023%20Day%203/near/405708843" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/358903-advent-of-code/topic/2023.20Day.203.html#405708843">(Dec 03 2023 at 23:32)</a>:</h4>
<p>maybe even in the very latest nightly</p>



<a name="405708877"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/358903-advent%20of%20code/topic/2023%20Day%203/near/405708877" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/358903-advent-of-code/topic/2023.20Day.203.html#405708877">(Dec 03 2023 at 23:32)</a>:</h4>
<p>otherwise, should be in the next nightly</p>



<a name="405709977"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/358903-advent%20of%20code/topic/2023%20Day%203/near/405709977" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Fabian Schmalzried <a href="https://roc-lang.github.io/zulip-export/stream/358903-advent-of-code/topic/2023.20Day.203.html#405709977">(Dec 03 2023 at 23:49)</a>:</h4>
<p><span class="user-mention silent" data-user-id="481892">Axel</span> <a href="#narrow/stream/358903-Advent-of-Code/topic/2023.20Day.203/near/405708231">said</a>:</p>
<blockquote>
<p>The thing that bogs me down most is that <code>dbg</code> doesn't work during test runs (at leas on my Mac).</p>
</blockquote>
<p>Yes, it would be nice to have dbg output on tests, is there a reason for why this is missing?</p>



<a name="405710185"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/358903-advent%20of%20code/topic/2023%20Day%203/near/405710185" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/358903-advent-of-code/topic/2023.20Day.203.html#405710185">(Dec 03 2023 at 23:52)</a>:</h4>
<p>it used to work, but we recently changed how <code>dbg</code> works (to fix a bunch of bugs, among other benefits) and haven't updated tests to use that new way yet</p>



<a name="405710198"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/358903-advent%20of%20code/topic/2023%20Day%203/near/405710198" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/358903-advent-of-code/topic/2023.20Day.203.html#405710198">(Dec 03 2023 at 23:52)</a>:</h4>
<p><span class="user-mention" data-user-id="281543">@Folkert de Vries</span> do you know offhand where we define <code>roc_alloc</code> and such for <code>roc test</code>?</p>



<a name="405710212"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/358903-advent%20of%20code/topic/2023%20Day%203/near/405710212" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/358903-advent-of-code/topic/2023.20Day.203.html#405710212">(Dec 03 2023 at 23:52)</a>:</h4>
<p>I assume if we add a <code>roc_dbg</code> implementation there it'll fix it</p>



<a name="405712566"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/358903-advent%20of%20code/topic/2023%20Day%203/near/405712566" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/358903-advent-of-code/topic/2023.20Day.203.html#405712566">(Dec 04 2023 at 00:20)</a>:</h4>
<p>It should be fixed on main already</p>



<a name="405727449"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/358903-advent%20of%20code/topic/2023%20Day%203/near/405727449" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jason Hobbs <a href="https://roc-lang.github.io/zulip-export/stream/358903-advent-of-code/topic/2023.20Day.203.html#405727449">(Dec 04 2023 at 02:32)</a>:</h4>
<p><span class="user-mention silent" data-user-id="281383">Richard Feldman</span> <a href="#narrow/stream/358903-Advent-of-Code/topic/2023.20Day.203/near/405704638">said</a>:</p>
<blockquote>
<p><code>roc format</code> will format things for you! <span aria-label="smiley" class="emoji emoji-1f603" role="img" title="smiley">:smiley:</span></p>
</blockquote>
<p>Not having this was such a pet peeve of mine as I've been coding lol</p>
<p>The whole time I've been thinking, we need to get on this for some sanity! Ty to everyone who put it together!</p>



<a name="405944894"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/358903-advent%20of%20code/topic/2023%20Day%203/near/405944894" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ryan Bates <a href="https://roc-lang.github.io/zulip-export/stream/358903-advent-of-code/topic/2023.20Day.203.html#405944894">(Dec 05 2023 at 01:02)</a>:</h4>
<p>Here's my day 3 solution.<br>
<a href="https://github.com/ryanb/advent-2023-roc/blob/main/day03/main.roc">https://github.com/ryanb/advent-2023-roc/blob/main/day03/main.roc</a></p>



<a name="406381132"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/358903-advent%20of%20code/topic/2023%20Day%203/near/406381132" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nikolaus Wettstein <a href="https://roc-lang.github.io/zulip-export/stream/358903-advent-of-code/topic/2023.20Day.203.html#406381132">(Dec 06 2023 at 20:27)</a>:</h4>
<p>Hi roc community! These are my solutions so far: <a href="https://github.com/ni-ko-o-kin/advent-of-code/tree/main/2023">https://github.com/ni-ko-o-kin/advent-of-code/tree/main/2023</a> I'm having so much fun with roc this year! A huge difference to last year where I ran into a couple of compiler bugs. And it also helped to let my brain process and digest for one year how roc works and how it differs from other languages I already know (like elm or haskell).</p>



<a name="418511104"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/358903-advent%20of%20code/topic/2023%20Day%203/near/418511104" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jonas Schell <a href="https://roc-lang.github.io/zulip-export/stream/358903-advent-of-code/topic/2023.20Day.203.html#418511104">(Jan 28 2024 at 15:24)</a>:</h4>
<p>My solution for day 3: <a href="https://github.com/Ocupe/advent-of-code-2023/tree/main/day_03">https://github.com/Ocupe/advent-of-code-2023/tree/main/day_03</a></p>
<p>I look forward to seeing how outers tackle this problem. I struggled with nested lists in pipes. Sometimes I didn't realize that I was still working on the first level where I should have used <a href="http://List.map">List.map</a> on the nested list. I guess this is mostly due to my brain adapting to the functional style of doing things and getting used to Roc.</p>
<p>A lot of things took longer than I expected, but I also had some moments of "wow, this is so cool!". Amazing work!</p>



<a name="418511477"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/358903-advent%20of%20code/topic/2023%20Day%203/near/418511477" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/358903-advent-of-code/topic/2023.20Day.203.html#418511477">(Jan 28 2024 at 15:29)</a>:</h4>
<blockquote>
<p>I look forward to seeing how outers tackle this problem.</p>
</blockquote>
<p>If you click on the header of this topic "# Advent of Code &gt; 2023 Day 3" you can see the solutions posted in previous messages :)</p>



<a name="418512126"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/358903-advent%20of%20code/topic/2023%20Day%203/near/418512126" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jonas Schell <a href="https://roc-lang.github.io/zulip-export/stream/358903-advent-of-code/topic/2023.20Day.203.html#418512126">(Jan 28 2024 at 15:37)</a>:</h4>
<p>Thanks <span class="user-mention" data-user-id="361169">@Anton</span>, that is what I am currently doing. I just don't want to read anything related to the problem before I've solved it :)</p>



<a name="418539778"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/358903-advent%20of%20code/topic/2023%20Day%203/near/418539778" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/358903-advent-of-code/topic/2023.20Day.203.html#418539778">(Jan 28 2024 at 22:05)</a>:</h4>
<p>Nice work, one thing I noticed I thought I might mention. </p>
<div class="codehilite" data-code-language="Ruby"><pre><span></span><code><span class="w">    </span><span class="c1"># we can remove the braces</span>
<span class="w">    </span><span class="o">|&gt;</span><span class="w"> </span><span class="p">(\</span><span class="n">numList</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="ss">value</span><span class="p">:</span><span class="w"> </span><span class="n">numList</span><span class="p">,</span><span class="w"> </span><span class="ss">row</span><span class="p">:</span><span class="w"> </span><span class="n">hit</span><span class="o">.</span><span class="n">row</span><span class="p">,</span><span class="w"> </span><span class="ss">cols</span><span class="p">:</span><span class="w"> </span><span class="n">range</span><span class="w"> </span><span class="p">})</span>

<span class="w">    </span><span class="c1"># like this</span>
<span class="w">    </span><span class="o">|&gt;</span><span class="w"> </span><span class="p">\</span><span class="n">numList</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="ss">value</span><span class="p">:</span><span class="w"> </span><span class="n">numList</span><span class="p">,</span><span class="w"> </span><span class="ss">row</span><span class="p">:</span><span class="w"> </span><span class="n">hit</span><span class="o">.</span><span class="n">row</span><span class="p">,</span><span class="w"> </span><span class="ss">cols</span><span class="p">:</span><span class="w"> </span><span class="n">range</span><span class="w"> </span><span class="p">}</span>
</code></pre></div>
<p>In general I wonder if <code>roc format</code> could/should do this automatically?</p>



<a name="418709511"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/358903-advent%20of%20code/topic/2023%20Day%203/near/418709511" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Isaac Van Doren <a href="https://roc-lang.github.io/zulip-export/stream/358903-advent-of-code/topic/2023.20Day.203.html#418709511">(Jan 29 2024 at 19:55)</a>:</h4>
<p><span aria-label="100" class="emoji emoji-1f4af" role="img" title="100">:100:</span></p>



<hr><p>Last updated: Nov 01 2025 at 12:13 UTC</p>
</html>