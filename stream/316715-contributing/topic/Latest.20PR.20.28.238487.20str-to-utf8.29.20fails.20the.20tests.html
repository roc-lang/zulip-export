<html>
<head><meta charset="utf-8"><title>Latest PR (#8487 str-to-utf8) fails the tests · contributing · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/index.html">contributing</a></h2>
<h3>Topic: <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Latest.20PR.20.28.238487.20str-to-utf8.29.20fails.20the.20tests.html">Latest PR (#8487 str-to-utf8) fails the tests</a></h3>

<hr>

<base href="https://roc.zulipchat.com">

<head><link href="https://roc-lang.github.io/zulip-export/style.css" rel="stylesheet"></head>

<a name="560742789"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Latest%20PR%20%28%238487%20str-to-utf8%29%20fails%20the%20tests/near/560742789" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Matthieu Pizenberg <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Latest.20PR.20.28.238487.20str-to-utf8.29.20fails.20the.20tests.html#560742789">(Nov 28 2025 at 09:40)</a>:</h4>
<p>The latest merged PR makes the tests fail on my machine (osx M3, zig 0.15.2).<br>
<a href="https://github.com/roc-lang/roc/pull/8487">https://github.com/roc-lang/roc/pull/8487</a></p>
<div class="codehilite"><pre><span></span><code>Build Summary: 50/59 steps succeeded; 4 failed; 1039/1055 tests passed; 16 failed
test transitive failure
└─ tests_summary transitive failure
   ├─ run test eval transitive failure
   │  └─ compile test eval Debug native 1 errors
   ├─ run test repl transitive failure
   │  └─ compile test repl Debug native 1 errors
   ├─ run test snapshot_tool_test transitive failure
   │  └─ compile test snapshot_tool_test Debug native 1 errors
   └─ run test fx_platform_test 0/16 passed, 16 failed
</code></pre></div>



<a name="560743495"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Latest%20PR%20%28%238487%20str-to-utf8%29%20fails%20the%20tests/near/560743495" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Matthieu Pizenberg <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Latest.20PR.20.28.238487.20str-to-utf8.29.20fails.20the.20tests.html#560743495">(Nov 28 2025 at 09:44)</a>:</h4>
<p>This is the error I see most in the error message, which is huge.</p>
<div class="codehilite"><pre><span></span><code>src/eval/interpreter.zig:9615:94: error: missing struct field: saved_rigid_subst
                            try work_stack.push(.{ .apply_continuation = .{ .call_cleanup = .{
                                                                                            ~^
</code></pre></div>



<a name="560746992"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Latest%20PR%20%28%238487%20str-to-utf8%29%20fails%20the%20tests/near/560746992" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Latest.20PR.20.28.238487.20str-to-utf8.29.20fails.20the.20tests.html#560746992">(Nov 28 2025 at 10:02)</a>:</h4>
<p>Thanks for reporting <span class="user-mention" data-user-id="479073">@Matthieu Pizenberg</span>! I was able to reproduce and will investigate.</p>



<a name="560749129"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Latest%20PR%20%28%238487%20str-to-utf8%29%20fails%20the%20tests/near/560749129" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Latest.20PR.20.28.238487.20str-to-utf8.29.20fails.20the.20tests.html#560749129">(Nov 28 2025 at 10:13)</a>:</h4>
<p>I suspect this error snuck in because we don't use a merge queue. I don't think we should use one though to avoid a large increase in our power usage even though github CI is free. It just seems wasteful given how rarely it creates problems.</p>



<a name="560758435"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Latest%20PR%20%28%238487%20str-to-utf8%29%20fails%20the%20tests/near/560758435" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Latest.20PR.20.28.238487.20str-to-utf8.29.20fails.20the.20tests.html#560758435">(Nov 28 2025 at 11:01)</a>:</h4>
<p><a href="https://github.com/roc-lang/roc/pull/8489">PR#8489</a> should fix it (not merged yet).</p>



<a name="560763935"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Latest%20PR%20%28%238487%20str-to-utf8%29%20fails%20the%20tests/near/560763935" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Latest.20PR.20.28.238487.20str-to-utf8.29.20fails.20the.20tests.html#560763935">(Nov 28 2025 at 11:30)</a>:</h4>
<p>Merged :)</p>



<a name="560831528"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Latest%20PR%20%28%238487%20str-to-utf8%29%20fails%20the%20tests/near/560831528" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Latest.20PR.20.28.238487.20str-to-utf8.29.20fails.20the.20tests.html#560831528">(Nov 28 2025 at 17:23)</a>:</h4>
<p>yeah we used to have a merge queue and it was more annoying than helpful, so we ended up accepting that occasionally we will land two PRs that interact to break main, and that's the less bad option for now <span aria-label="smile" class="emoji emoji-1f604" role="img" title="smile">:smile:</span></p>



<a name="560838945"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Latest%20PR%20%28%238487%20str-to-utf8%29%20fails%20the%20tests/near/560838945" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Isaac Van Doren <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Latest.20PR.20.28.238487.20str-to-utf8.29.20fails.20the.20tests.html#560838945">(Nov 28 2025 at 18:21)</a>:</h4>
<p><span aria-label="100" class="emoji emoji-1f4af" role="img" title="100">:100:</span></p>



<a name="560838956"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Latest%20PR%20%28%238487%20str-to-utf8%29%20fails%20the%20tests/near/560838956" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Isaac Van Doren <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Latest.20PR.20.28.238487.20str-to-utf8.29.20fails.20the.20tests.html#560838956">(Nov 28 2025 at 18:21)</a>:</h4>
<p>Merge queues are so annoying</p>



<a name="560852992"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Latest%20PR%20%28%238487%20str-to-utf8%29%20fails%20the%20tests/near/560852992" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Latest.20PR.20.28.238487.20str-to-utf8.29.20fails.20the.20tests.html#560852992">(Nov 28 2025 at 20:47)</a>:</h4>
<p>When they work well, at scale, they are awesome.</p>
<p>But most implementations I have seen,  especially ones used with Github, are much more pain than good.</p>



<a name="560853454"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Latest%20PR%20%28%238487%20str-to-utf8%29%20fails%20the%20tests/near/560853454" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Latest.20PR.20.28.238487.20str-to-utf8.29.20fails.20the.20tests.html#560853454">(Nov 28 2025 at 20:54)</a>:</h4>
<p>In work environments, I am definitely a fan of one commit per PR with the ability to create a small tree of PRs, but I have not seen that implemented well in open source.</p>



<a name="560853488"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Latest%20PR%20%28%238487%20str-to-utf8%29%20fails%20the%20tests/near/560853488" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Latest.20PR.20.28.238487.20str-to-utf8.29.20fails.20the.20tests.html#560853488">(Nov 28 2025 at 20:54)</a>:</h4>
<p>And that workflow works best with being able to merge a stack at once or automatically with a queue.</p>



<hr><p>Last updated: Mar 01 2026 at 12:20 UTC</p>
</html>