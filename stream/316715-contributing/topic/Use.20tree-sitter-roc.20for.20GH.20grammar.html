<html>
<head><meta charset="utf-8"><title>Use tree-sitter-roc for GH grammar · contributing · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/index.html">contributing</a></h2>
<h3>Topic: <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Use.20tree-sitter-roc.20for.20GH.20grammar.html">Use tree-sitter-roc for GH grammar</a></h3>

<hr>

<base href="https://roc.zulipchat.com">

<head><link href="https://roc-lang.github.io/zulip-export/style.css" rel="stylesheet"></head>

<a name="495793752"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Use%20tree-sitter-roc%20for%20GH%20grammar/near/495793752" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Use.20tree-sitter-roc.20for.20GH.20grammar.html#495793752">(Jan 24 2025 at 21:13)</a>:</h4>
<p>According to the <a href="https://github.com/github-linguist/linguist/tree/main/vendor">vendor list for linguist</a> (which is GitHub's syntax highlighting lib), we can use tree sitter for our GitHub syntax, which would keep everything aligned with the tool most users rely on for syntax highlighting. We currently use the <a href="https://github.com/ivan-demchenko/roc-vscode-unofficial">VSCode Roc highlighting</a> which I think gets less love.</p>



<a name="495793814"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Use%20tree-sitter-roc%20for%20GH%20grammar/near/495793814" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Use.20tree-sitter-roc.20for.20GH.20grammar.html#495793814">(Jan 24 2025 at 21:13)</a>:</h4>
<p>We definitely need that treesitter grammar to be updated</p>



<a name="495793817"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Use%20tree-sitter-roc%20for%20GH%20grammar/near/495793817" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Use.20tree-sitter-roc.20for.20GH.20grammar.html#495793817">(Jan 24 2025 at 21:13)</a>:</h4>
<p>I'm biased for tree-sitter being a Helix user, but also because it seems like the more future-facing technology</p>



<a name="495793842"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Use%20tree-sitter-roc%20for%20GH%20grammar/near/495793842" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Use.20tree-sitter-roc.20for.20GH.20grammar.html#495793842">(Jan 24 2025 at 21:13)</a>:</h4>
<p>I have some experience with TS, but <span class="user-mention" data-user-id="651372">@Eli Dowling</span> owns the repo I think and is on vacation</p>



<a name="495793900"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Use%20tree-sitter-roc%20for%20GH%20grammar/near/495793900" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Use.20tree-sitter-roc.20for.20GH.20grammar.html#495793900">(Jan 24 2025 at 21:14)</a>:</h4>
<p>Yes, we'd want to update the tree-sitter-roc grammar to point at all the syntax features we want for the foreseeable future</p>



<a name="495793909"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Use%20tree-sitter-roc%20for%20GH%20grammar/near/495793909" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Use.20tree-sitter-roc.20for.20GH.20grammar.html#495793909">(Jan 24 2025 at 21:14)</a>:</h4>
<p>Yeah TM grammars are not the future</p>



<a name="495793935"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Use%20tree-sitter-roc%20for%20GH%20grammar/near/495793935" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Use.20tree-sitter-roc.20for.20GH.20grammar.html#495793935">(Jan 24 2025 at 21:14)</a>:</h4>
<p>It should become a roc-lang repo</p>



<a name="495793942"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Use%20tree-sitter-roc%20for%20GH%20grammar/near/495793942" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Use.20tree-sitter-roc.20for.20GH.20grammar.html#495793942">(Jan 24 2025 at 21:14)</a>:</h4>
<p>And then we would make a PR to GitHub to point at the updated commit hash of tree-sitter-roc</p>



<a name="495794038"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Use%20tree-sitter-roc%20for%20GH%20grammar/near/495794038" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Use.20tree-sitter-roc.20for.20GH.20grammar.html#495794038">(Jan 24 2025 at 21:15)</a>:</h4>
<p>GitHub makes releases of linguist every few months, and the last one was at the end of November, so if we update by mid-February we can probably get this done</p>



<a name="495794071"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Use%20tree-sitter-roc%20for%20GH%20grammar/near/495794071" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Use.20tree-sitter-roc.20for.20GH.20grammar.html#495794071">(Jan 24 2025 at 21:15)</a>:</h4>
<p>I agree that it should be an official Roc repo</p>



<a name="495794197"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Use%20tree-sitter-roc%20for%20GH%20grammar/near/495794197" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Use.20tree-sitter-roc.20for.20GH.20grammar.html#495794197">(Jan 24 2025 at 21:16)</a>:</h4>
<p>Maybe someone with a more holistic vision than of the planned syntax could write down a set of what we'd need to highlight, even informally</p>



<a name="495794220"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Use%20tree-sitter-roc%20for%20GH%20grammar/near/495794220" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Use.20tree-sitter-roc.20for.20GH.20grammar.html#495794220">(Jan 24 2025 at 21:16)</a>:</h4>
<p>And then it wouldn't be so bad to update the tree-sitter grammar given that kind of list</p>



<a name="495794483"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Use%20tree-sitter-roc%20for%20GH%20grammar/near/495794483" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eli Dowling <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Use.20tree-sitter-roc.20for.20GH.20grammar.html#495794483">(Jan 24 2025 at 21:18)</a>:</h4>
<p>I think that's reasonable. And yes, I'm on vacation. I'll be ending that by late February though.<br>
The syntax will need some pretty low level changes for the PNC syntax. But that will be the hardest part. It's much simpler than the current calling syntax in many ways though.</p>



<a name="495794768"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Use%20tree-sitter-roc%20for%20GH%20grammar/near/495794768" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eli Dowling <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Use.20tree-sitter-roc.20for.20GH.20grammar.html#495794768">(Jan 24 2025 at 21:21)</a>:</h4>
<p>It would be worth making it support the for syntax as well and just putting it behind an ifdef for now. <br>
I agree with <span class="user-mention" data-user-id="461444">@Sam Mohr</span> about getting a list of all planned syntax changes and then making ts ahead of what's actually implemented in the roc compiler.</p>



<a name="495794773"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Use%20tree-sitter-roc%20for%20GH%20grammar/near/495794773" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Use.20tree-sitter-roc.20for.20GH.20grammar.html#495794773">(Jan 24 2025 at 21:21)</a>:</h4>
<p>Unfortunately we need to support both whitespace for types and parens for values</p>



<a name="495794834"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Use%20tree-sitter-roc%20for%20GH%20grammar/near/495794834" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Use.20tree-sitter-roc.20for.20GH.20grammar.html#495794834">(Jan 24 2025 at 21:21)</a>:</h4>
<p>Yep, <code>for</code>, <code>var</code>, <code>reassignable_</code> variables, etc.</p>



<a name="495863435"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Use%20tree-sitter-roc%20for%20GH%20grammar/near/495863435" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eli Dowling <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Use.20tree-sitter-roc.20for.20GH.20grammar.html#495863435">(Jan 25 2025 at 11:42)</a>:</h4>
<p>I have some time today to work on the TS grammar. I'll make some corpus entries from the real-world example repo that <span class="user-mention" data-user-id="281383">@Richard Feldman</span> made and then work on getting the syntax right. </p>
<p>One of the big areas we could work on first is starting a new corpus that has nice, simple examples of the new features. </p>
<p>As I said I'll use the realworld repo to try to rough out what the changes should be to the grammar</p>



<a name="495863476"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Use%20tree-sitter-roc%20for%20GH%20grammar/near/495863476" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Use.20tree-sitter-roc.20for.20GH.20grammar.html#495863476">(Jan 25 2025 at 11:43)</a>:</h4>
<p>Awesome! I can try to put together some such syntax examples</p>



<a name="495863527"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Use%20tree-sitter-roc%20for%20GH%20grammar/near/495863527" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Use.20tree-sitter-roc.20for.20GH.20grammar.html#495863527">(Jan 25 2025 at 11:44)</a>:</h4>
<p>It feels like having an official, tested syntax definition might help here as well</p>



<a name="495863555"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Use%20tree-sitter-roc%20for%20GH%20grammar/near/495863555" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Use.20tree-sitter-roc.20for.20GH.20grammar.html#495863555">(Jan 25 2025 at 11:44)</a>:</h4>
<p>I started working on a <a href="https://docs.rs/pest/latest/pest/">https://docs.rs/pest/latest/pest/</a> definition for Roc earlier, but it feels like it's just gonna be another dependency we'd try to remove eventually</p>



<a name="495863577"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Use%20tree-sitter-roc%20for%20GH%20grammar/near/495863577" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Use.20tree-sitter-roc.20for.20GH.20grammar.html#495863577">(Jan 25 2025 at 11:45)</a>:</h4>
<p>I wonder if there's some simple specification for a grammar we could implement ourselves</p>



<a name="495863605"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Use%20tree-sitter-roc%20for%20GH%20grammar/near/495863605" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Use.20tree-sitter-roc.20for.20GH.20grammar.html#495863605">(Jan 25 2025 at 11:45)</a>:</h4>
<p>Though maybe a dependency like <code>pest</code> that we only use for testing and LSP/tree-sitter coherence wouldn't be such a bad thing to pull in</p>



<a name="495863710"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Use%20tree-sitter-roc%20for%20GH%20grammar/near/495863710" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eli Dowling <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Use.20tree-sitter-roc.20for.20GH.20grammar.html#495863710">(Jan 25 2025 at 11:47)</a>:</h4>
<p>Is a pest definition going to be more understandable than a treesitter definition?</p>



<a name="495863734"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Use%20tree-sitter-roc%20for%20GH%20grammar/near/495863734" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Use.20tree-sitter-roc.20for.20GH.20grammar.html#495863734">(Jan 25 2025 at 11:47)</a>:</h4>
<p>I don't think so...</p>



<a name="495863797"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Use%20tree-sitter-roc%20for%20GH%20grammar/near/495863797" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Use.20tree-sitter-roc.20for.20GH.20grammar.html#495863797">(Jan 25 2025 at 11:48)</a>:</h4>
<p>I think it's a PEG-adjacent grammar that we could test both our custom parser <em>and</em> tree-sitter against (probably)</p>



<a name="495863809"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Use%20tree-sitter-roc%20for%20GH%20grammar/near/495863809" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Use.20tree-sitter-roc.20for.20GH.20grammar.html#495863809">(Jan 25 2025 at 11:48)</a>:</h4>
<p>We used pest in the past</p>



<a name="495863817"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Use%20tree-sitter-roc%20for%20GH%20grammar/near/495863817" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Use.20tree-sitter-roc.20for.20GH.20grammar.html#495863817">(Jan 25 2025 at 11:48)</a>:</h4>
<p>Whatever tool would fill the behavior would be great</p>



<a name="495863853"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Use%20tree-sitter-roc%20for%20GH%20grammar/near/495863853" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Use.20tree-sitter-roc.20for.20GH.20grammar.html#495863853">(Jan 25 2025 at 11:49)</a>:</h4>
<p>I think the new tutorial has plenty of small examples of new syntax, as well as the new release of roc-lang/examples</p>



<a name="495863857"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Use%20tree-sitter-roc%20for%20GH%20grammar/near/495863857" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eli Dowling <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Use.20tree-sitter-roc.20for.20GH.20grammar.html#495863857">(Jan 25 2025 at 11:49)</a>:</h4>
<p>ocaml has what I'd consider the best syntax docs. They have these fancy (I asssume autogenerated) syntax specs.<br>
take this:<br>
<a href="https://ocaml.org/manual/5.3/bindingops.html">https://ocaml.org/manual/5.3/bindingops.html</a></p>



<a name="495863942"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Use%20tree-sitter-roc%20for%20GH%20grammar/near/495863942" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Use.20tree-sitter-roc.20for.20GH.20grammar.html#495863942">(Jan 25 2025 at 11:50)</a>:</h4>
<p>Here's the source for that page: <a href="https://github.com/ocaml/ocaml/blob/trunk/manual/src/refman/extensions/bindingops.etex">https://github.com/ocaml/ocaml/blob/trunk/manual/src/refman/extensions/bindingops.etex</a></p>



<a name="495863945"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Use%20tree-sitter-roc%20for%20GH%20grammar/near/495863945" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eli Dowling <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Use.20tree-sitter-roc.20for.20GH.20grammar.html#495863945">(Jan 25 2025 at 11:50)</a>:</h4>
<p>or their docs on what an expression is:<br>
<a href="https://ocaml.org/manual/5.3/expr.html">https://ocaml.org/manual/5.3/expr.html</a></p>



<a name="495863991"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Use%20tree-sitter-roc%20for%20GH%20grammar/near/495863991" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Use.20tree-sitter-roc.20for.20GH.20grammar.html#495863991">(Jan 25 2025 at 11:51)</a>:</h4>
<p><span class="user-mention silent" data-user-id="361169">Anton</span> <a href="#narrow/channel/316715-contributing/topic/Use.20tree-sitter-roc.20for.20GH.20grammar/near/495863809">said</a>:</p>
<blockquote>
<p>We used pest in the past</p>
</blockquote>
<p>This is not the latest version of the file but here's the link: <a href="https://github.com/roc-lang/roc/pull/2675/files#diff-490af2dd8e5b9915ae07391871ab6575a352e10294bc3d90f4d05e7328aab278">https://github.com/roc-lang/roc/pull/2675/files#diff-490af2dd8e5b9915ae07391871ab6575a352e10294bc3d90f4d05e7328aab278</a></p>



<a name="495864023"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Use%20tree-sitter-roc%20for%20GH%20grammar/near/495864023" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eli Dowling <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Use.20tree-sitter-roc.20for.20GH.20grammar.html#495864023">(Jan 25 2025 at 11:51)</a>:</h4>
<p><span class="user-mention silent" data-user-id="461444">Sam Mohr</span> <a href="#narrow/channel/316715-contributing/topic/Use.20tree-sitter-roc.20for.20GH.20grammar/near/495863942">said</a>:</p>
<blockquote>
<p>Here's the source for that page: <a href="https://github.com/ocaml/ocaml/blob/trunk/manual/src/refman/extensions/bindingops.etex">https://github.com/ocaml/ocaml/blob/trunk/manual/src/refman/extensions/bindingops.etex</a></p>
</blockquote>
<p>Oh well, maybe it's not autogenerated.... shame</p>



<a name="495864031"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Use%20tree-sitter-roc%20for%20GH%20grammar/near/495864031" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Use.20tree-sitter-roc.20for.20GH.20grammar.html#495864031">(Jan 25 2025 at 11:51)</a>:</h4>
<p><span class="user-mention" data-user-id="651372">@Eli Dowling</span> if we could generate something like those docs from some PEG-adjacent grammar, that'd be great</p>



<a name="495864894"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Use%20tree-sitter-roc%20for%20GH%20grammar/near/495864894" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eli Dowling <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Use.20tree-sitter-roc.20for.20GH.20grammar.html#495864894">(Jan 25 2025 at 12:02)</a>:</h4>
<p>This isn't a topic I know a whole lot about but :<br>
<a href="https://github.com/matthijsgroen/ebnf2railroad">https://github.com/matthijsgroen/ebnf2railroad</a><br>
And it seems there are a number of parser generators that take EBNF as input it seems the most standardised. Could be a good choice as a way to generate some docs and also a reference implementation that while maybe slow could be used to compare against the rust and TS implementations and provide a spec</p>
<p><a href="https://www.researchgate.net/publication/376883410_Comparison_of_Leading_Language_Parsers_-_ANTLR_JavaCC_SableCC_Tree-sitter_Yacc_Bison">https://www.researchgate.net/publication/376883410_Comparison_of_Leading_Language_Parsers_-_ANTLR_JavaCC_SableCC_Tree-sitter_Yacc_Bison</a></p>



<a name="495866865"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Use%20tree-sitter-roc%20for%20GH%20grammar/near/495866865" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Use.20tree-sitter-roc.20for.20GH.20grammar.html#495866865">(Jan 25 2025 at 12:28)</a>:</h4>
<p>I think this is a good thing to explore, but syntax highlighting grammar != actual parsing grammar</p>



<a name="495867139"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Use%20tree-sitter-roc%20for%20GH%20grammar/near/495867139" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Use.20tree-sitter-roc.20for.20GH.20grammar.html#495867139">(Jan 25 2025 at 12:32)</a>:</h4>
<p>Yep</p>



<a name="495867163"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Use%20tree-sitter-roc%20for%20GH%20grammar/near/495867163" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Use.20tree-sitter-roc.20for.20GH.20grammar.html#495867163">(Jan 25 2025 at 12:32)</a>:</h4>
<p>Something it'd be nice to enable for the future is easy, safe codegen</p>



<a name="495867185"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Use%20tree-sitter-roc%20for%20GH%20grammar/near/495867185" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Use.20tree-sitter-roc.20for.20GH.20grammar.html#495867185">(Jan 25 2025 at 12:33)</a>:</h4>
<p>Without a macro system, we need codegen for stuff like gRPC and DB access interfacing</p>



<a name="495867191"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Use%20tree-sitter-roc%20for%20GH%20grammar/near/495867191" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eli Dowling <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Use.20tree-sitter-roc.20for.20GH.20grammar.html#495867191">(Jan 25 2025 at 12:33)</a>:</h4>
<p><span class="user-mention silent" data-user-id="781658">Anthony Bullard</span> <a href="#narrow/channel/316715-contributing/topic/Use.20tree-sitter-roc.20for.20GH.20grammar/near/495866865">said</a>:</p>
<blockquote>
<p>I think this is a good thing to explore, but syntax highlighting grammar != actual parsing grammar</p>
</blockquote>
<p>Sure but from a testing standpoint, if the syntax grammar ever rejects anything the parsing grammar accepts we have an issue</p>



<a name="495867255"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Use%20tree-sitter-roc%20for%20GH%20grammar/near/495867255" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Use.20tree-sitter-roc.20for.20GH.20grammar.html#495867255">(Jan 25 2025 at 12:34)</a>:</h4>
<p>I want something that everyone can point at for "correctness"</p>



<a name="495867272"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Use%20tree-sitter-roc%20for%20GH%20grammar/near/495867272" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Use.20tree-sitter-roc.20for.20GH.20grammar.html#495867272">(Jan 25 2025 at 12:34)</a>:</h4>
<p>But doing good error handling in PEG grammars can't compare to what we have today</p>



<a name="495875644"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Use%20tree-sitter-roc%20for%20GH%20grammar/near/495875644" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eli Dowling <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Use.20tree-sitter-roc.20for.20GH.20grammar.html#495875644">(Jan 25 2025 at 14:30)</a>:</h4>
<p><a href="https://github.com/faldor20/tree-sitter-roc/new-syntax">https://github.com/faldor20/tree-sitter-roc/new-syntax</a><br>
I made a tiny start, but got a bit bogged down in nix stuff trying to update tree-sitter on my terrible train wifi <span aria-label="sweat smile" class="emoji emoji-1f605" role="img" title="sweat smile">:sweat_smile:</span></p>



<a name="495875770"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Use%20tree-sitter-roc%20for%20GH%20grammar/near/495875770" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eli Dowling <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Use.20tree-sitter-roc.20for.20GH.20grammar.html#495875770">(Jan 25 2025 at 14:32)</a>:</h4>
<p>I might get some more train time, but otherwise I'll finish it when I'm more free in a month.</p>



<a name="495876189"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Use%20tree-sitter-roc%20for%20GH%20grammar/near/495876189" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Use.20tree-sitter-roc.20for.20GH.20grammar.html#495876189">(Jan 25 2025 at 14:38)</a>:</h4>
<p>I'm not very familiar with tree sitter, but I can try to work on it too</p>



<a name="495876200"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Use%20tree-sitter-roc%20for%20GH%20grammar/near/495876200" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Use.20tree-sitter-roc.20for.20GH.20grammar.html#495876200">(Jan 25 2025 at 14:38)</a>:</h4>
<p>Would you have time to review on vacation if you didn't have to write it?</p>



<a name="495876210"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Use%20tree-sitter-roc%20for%20GH%20grammar/near/495876210" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Use.20tree-sitter-roc.20for.20GH.20grammar.html#495876210">(Jan 25 2025 at 14:38)</a>:</h4>
<p>Please feel free to say no</p>



<a name="495876358"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Use%20tree-sitter-roc%20for%20GH%20grammar/near/495876358" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eli Dowling <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Use.20tree-sitter-roc.20for.20GH.20grammar.html#495876358">(Jan 25 2025 at 14:40)</a>:</h4>
<p>yeah, for for sure. I can definitely carve out the time for that. <br>
Honestly If you're not familiar with TS working on the test corpus would be the biggest help. <br>
I can crank out the changes to TS, but I'm not familiar enough with the changes to roc to know exactly what needs doing. <br>
Having a list of changes and a test corpus to make the changes against would be amazing.</p>



<a name="495876395"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Use%20tree-sitter-roc%20for%20GH%20grammar/near/495876395" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Use.20tree-sitter-roc.20for.20GH.20grammar.html#495876395">(Jan 25 2025 at 14:41)</a>:</h4>
<p>Any particular format for the test corpus?</p>



<a name="495876408"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Use%20tree-sitter-roc%20for%20GH%20grammar/near/495876408" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Use.20tree-sitter-roc.20for.20GH.20grammar.html#495876408">(Jan 25 2025 at 14:41)</a>:</h4>
<p>Presumably just a list of Roc snippets</p>



<a name="495876421"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Use%20tree-sitter-roc%20for%20GH%20grammar/near/495876421" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Use.20tree-sitter-roc.20for.20GH.20grammar.html#495876421">(Jan 25 2025 at 14:41)</a>:</h4>
<p>Without their TS S expression translation</p>



<a name="495876422"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Use%20tree-sitter-roc%20for%20GH%20grammar/near/495876422" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eli Dowling <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Use.20tree-sitter-roc.20for.20GH.20grammar.html#495876422">(Jan 25 2025 at 14:41)</a>:</h4>
<p>I suspect you or others a little more dialled into the current roc changes would be much quicker at the sorting out the corpus and I'd probably be quicker at doing the TS changes, so we may as well work together</p>



<a name="495876427"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Use%20tree-sitter-roc%20for%20GH%20grammar/near/495876427" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eli Dowling <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Use.20tree-sitter-roc.20for.20GH.20grammar.html#495876427">(Jan 25 2025 at 14:41)</a>:</h4>
<p>take a look at the existing corpus</p>



<a name="495876435"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Use%20tree-sitter-roc%20for%20GH%20grammar/near/495876435" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Use.20tree-sitter-roc.20for.20GH.20grammar.html#495876435">(Jan 25 2025 at 14:41)</a>:</h4>
<p>Yeah, I think I know what everything will look like</p>



<a name="495876500"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Use%20tree-sitter-roc%20for%20GH%20grammar/near/495876500" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eli Dowling <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Use.20tree-sitter-roc.20for.20GH.20grammar.html#495876500">(Jan 25 2025 at 14:42)</a>:</h4>
<p>Don't bother with the s-expressions. I'll just be checking that the generated expressions have no errors and look reasonable and I'll accept whatever TS generates.</p>



<a name="495876513"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Use%20tree-sitter-roc%20for%20GH%20grammar/near/495876513" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Use.20tree-sitter-roc.20for.20GH.20grammar.html#495876513">(Jan 25 2025 at 14:42)</a>:</h4>
<p>Okay</p>



<a name="495876539"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Use%20tree-sitter-roc%20for%20GH%20grammar/near/495876539" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eli Dowling <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Use.20tree-sitter-roc.20for.20GH.20grammar.html#495876539">(Jan 25 2025 at 14:43)</a>:</h4>
<p>you can omit the output part of the corpus and just add the samples, then tree-sitter will insert all the s-expressions when we accept the test output as good</p>



<a name="495876552"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Use%20tree-sitter-roc%20for%20GH%20grammar/near/495876552" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Use.20tree-sitter-roc.20for.20GH.20grammar.html#495876552">(Jan 25 2025 at 14:43)</a>:</h4>
<p>I'll ping you if/when I get to this. Should be this weekend, but I've suggested I'll be doing like 4 things so we'll see which of them happen...</p>



<a name="495876678"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Use%20tree-sitter-roc%20for%20GH%20grammar/near/495876678" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eli Dowling <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Use.20tree-sitter-roc.20for.20GH.20grammar.html#495876678">(Jan 25 2025 at 14:45)</a>:</h4>
<p>no worries at all.</p>
<p>My one suggestion is format the test names as <code>category_less_specific_name_</code><br>
that makes it easy to filter  and run a small subset of tests:<code>tree-sitter test -t func_def</code></p>



<a name="495876731"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Use%20tree-sitter-roc%20for%20GH%20grammar/near/495876731" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Use.20tree-sitter-roc.20for.20GH.20grammar.html#495876731">(Jan 25 2025 at 14:46)</a>:</h4>
<p>Just like we do with the compiler tests, got it</p>



<a name="495876933"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Use%20tree-sitter-roc%20for%20GH%20grammar/near/495876933" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eli Dowling <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Use.20tree-sitter-roc.20for.20GH.20grammar.html#495876933">(Jan 25 2025 at 14:48)</a>:</h4>
<p>I like to build each group of tests starting with a super basic test that's really short and then building up to much longer more complex ones, but I think you know what you're doing :)</p>



<a name="495876955"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Use%20tree-sitter-roc%20for%20GH%20grammar/near/495876955" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eli Dowling <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Use.20tree-sitter-roc.20for.20GH.20grammar.html#495876955">(Jan 25 2025 at 14:48)</a>:</h4>
<p>feel free to reuse the existing tests, I just copied them all to old_corpus so we can be intenional about what is compatible and what isn't</p>



<a name="495876957"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Use%20tree-sitter-roc%20for%20GH%20grammar/near/495876957" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Use.20tree-sitter-roc.20for.20GH.20grammar.html#495876957">(Jan 25 2025 at 14:48)</a>:</h4>
<p>I appreciate the reminder!</p>



<a name="495876973"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Use%20tree-sitter-roc%20for%20GH%20grammar/near/495876973" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Use.20tree-sitter-roc.20for.20GH.20grammar.html#495876973">(Jan 25 2025 at 14:48)</a>:</h4>
<p>It's good to reinforce shared knowledge</p>



<a name="495894053"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Use%20tree-sitter-roc%20for%20GH%20grammar/near/495894053" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Use.20tree-sitter-roc.20for.20GH.20grammar.html#495894053">(Jan 25 2025 at 18:28)</a>:</h4>
<p>Why not just make a platform that uses the actual roc parser as a library? </p>
<p>I was talking with Josh Warner about this and we made a bit of a start on that. He has some ideas he was cooking. </p>
<p>I guess fuzzing has been the priority rn.</p>



<a name="495902831"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Use%20tree-sitter-roc%20for%20GH%20grammar/near/495902831" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eli Dowling <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Use.20tree-sitter-roc.20for.20GH.20grammar.html#495902831">(Jan 25 2025 at 20:33)</a>:</h4>
<p>Update on this: <br>
I added a couple more features (new string interpolation, PNC calling and static dispatch calling ), and added some very basic corpus tests for them.</p>



<a name="495906148"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Use%20tree-sitter-roc%20for%20GH%20grammar/near/495906148" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Use.20tree-sitter-roc.20for.20GH.20grammar.html#495906148">(Jan 25 2025 at 21:19)</a>:</h4>
<p><span class="user-mention silent" data-user-id="515757">Luke Boswell</span> <a href="#narrow/channel/316715-contributing/topic/Use.20tree-sitter-roc.20for.20GH.20grammar/near/495894053">said</a>:</p>
<blockquote>
<p>Why not just make a platform that uses the actual roc parser as a library? </p>
<p>I was talking with Josh Warner about this and we made a bit of a start on that. He has some ideas he was cooking. </p>
<p>I guess fuzzing has been the priority rn.</p>
</blockquote>
<p>This generally makes sense, but there are two problems that it'd be interested to find a solution to:</p>
<ul>
<li>interfacing with the platform is always effectful, even if the operation on the platform side is pure.</li>
<li>If we pass a string to <code>roc_parse</code> and it parses an AST node, how do we access that arena-allocated syntax tree if not with a lot of indirection. Would we copy the whole thing into Roc recursively?</li>
</ul>
<p>If those problems can be mitigated, then this solution makes sense</p>



<a name="495908371"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Use%20tree-sitter-roc%20for%20GH%20grammar/near/495908371" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Use.20tree-sitter-roc.20for.20GH.20grammar.html#495908371">(Jan 25 2025 at 21:56)</a>:</h4>
<p>Yeah I think the idea was to serialise and deserialise the AST.</p>



<a name="496916137"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Use%20tree-sitter-roc%20for%20GH%20grammar/near/496916137" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Use.20tree-sitter-roc.20for.20GH.20grammar.html#496916137">(Jan 31 2025 at 04:25)</a>:</h4>
<p>What's the connection between tree-sitter / GH grammar and the "roc ast platform" thing (for lack of a better name)?</p>



<a name="496916203"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Use%20tree-sitter-roc%20for%20GH%20grammar/near/496916203" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Use.20tree-sitter-roc.20for.20GH.20grammar.html#496916203">(Jan 31 2025 at 04:26)</a>:</h4>
<p>Is that just the ast serialization?</p>



<a name="496916313"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Use%20tree-sitter-roc%20for%20GH%20grammar/near/496916313" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Use.20tree-sitter-roc.20for.20GH.20grammar.html#496916313">(Jan 31 2025 at 04:27)</a>:</h4>
<p><span class="user-mention silent" data-user-id="461444">Sam Mohr</span> <a href="#narrow/channel/316715-contributing/topic/Use.20tree-sitter-roc.20for.20GH.20grammar/near/495867185">said</a>:</p>
<blockquote>
<p>Something it'd be nice to enable for the future is easy, safe codegen<br>
Without a macro system, we need codegen for stuff like gRPC and DB access interfacing</p>
</blockquote>
<p>Things like this</p>



<a name="496916511"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Use%20tree-sitter-roc%20for%20GH%20grammar/near/496916511" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Use.20tree-sitter-roc.20for.20GH.20grammar.html#496916511">(Jan 31 2025 at 04:30)</a>:</h4>
<p>So I took that to mean, we want a way to parse roc code, to get an AST we can do interesting things with</p>



<a name="496916767"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Use%20tree-sitter-roc%20for%20GH%20grammar/near/496916767" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Warner <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Use.20tree-sitter-roc.20for.20GH.20grammar.html#496916767">(Jan 31 2025 at 04:33)</a>:</h4>
<p>Ahh, so that kinda sounds like the reverse - you'd have a roc platform that is 100% sandboxed, and only has a single <code>main: Ast</code> (or perhaps <code>main: {} -&gt; Ast</code>) it exposes, where it's expected to <code>import</code> any source files it needs as str/byte literals, run, and then spit out the generated code</p>



<a name="496934622"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Use%20tree-sitter-roc%20for%20GH%20grammar/near/496934622" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Use.20tree-sitter-roc.20for.20GH.20grammar.html#496934622">(Jan 31 2025 at 06:02)</a>:</h4>
<p>Something like that, yeah</p>



<hr><p>Last updated: Mar 01 2026 at 12:20 UTC</p>
</html>