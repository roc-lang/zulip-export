<html>
<head><meta charset="utf-8"><title>generating a big Roc program for benchmarking · contributing · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/index.html">contributing</a></h2>
<h3>Topic: <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/generating.20a.20big.20Roc.20program.20for.20benchmarking.html">generating a big Roc program for benchmarking</a></h3>

<hr>

<base href="https://roc.zulipchat.com">

<head><link href="https://roc-lang.github.io/zulip-export/style.css" rel="stylesheet"></head>

<a name="294853021"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/generating%20a%20big%20Roc%20program%20for%20benchmarking/near/294853021" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/generating.20a.20big.20Roc.20program.20for.20benchmarking.html#294853021">(Aug 23 2022 at 12:15)</a>:</h4>
<p>right now we only have small Roc programs on which to try out the compiler</p>



<a name="294853070"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/generating%20a%20big%20Roc%20program%20for%20benchmarking/near/294853070" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/generating.20a.20big.20Roc.20program.20for.20benchmarking.html#294853070">(Aug 23 2022 at 12:15)</a>:</h4>
<p>it would be helpful to have a bigger code base (e.g. 100K or 1M LoC), but of course nobody has written any real Roc programs that big yet!</p>



<a name="294853139"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/generating%20a%20big%20Roc%20program%20for%20benchmarking/near/294853139" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/generating.20a.20big.20Roc.20program.20for.20benchmarking.html#294853139">(Aug 23 2022 at 12:15)</a>:</h4>
<p>still, we could get some really useful information if we had an actual code base with line counts like that - even if it was generated by a script</p>



<a name="294853282"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/generating%20a%20big%20Roc%20program%20for%20benchmarking/near/294853282" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/generating.20a.20big.20Roc.20program.20for.20benchmarking.html#294853282">(Aug 23 2022 at 12:16)</a>:</h4>
<p>e.g. having a script that randomly generates a valid Roc <code>interface</code> module with a random name, a handful of functions in it, randomly imports a few of the other modules, etc.</p>



<a name="294853363"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/generating%20a%20big%20Roc%20program%20for%20benchmarking/near/294853363" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/generating.20a.20big.20Roc.20program.20for.20benchmarking.html#294853363">(Aug 23 2022 at 12:17)</a>:</h4>
<p>that way, we could run the compiler on it and not only see how long it takes, but also see where specific bottlenecks are in the compilation pipeline etc.</p>



<a name="294853478"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/generating%20a%20big%20Roc%20program%20for%20benchmarking/near/294853478" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/generating.20a.20big.20Roc.20program.20for.20benchmarking.html#294853478">(Aug 23 2022 at 12:18)</a>:</h4>
<p>anyone interested in generating something like that?</p>



<a name="294867661"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/generating%20a%20big%20Roc%20program%20for%20benchmarking/near/294867661" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Hicks <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/generating.20a.20big.20Roc.20program.20for.20benchmarking.html#294867661">(Aug 23 2022 at 13:41)</a>:</h4>
<p>are you thinking something similar to a fuzzer/shrinker or just a random generator?</p>



<a name="294870615"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/generating%20a%20big%20Roc%20program%20for%20benchmarking/near/294870615" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/generating.20a.20big.20Roc.20program.20for.20benchmarking.html#294870615">(Aug 23 2022 at 13:56)</a>:</h4>
<p>I wrote a super basic one a long while ago. I remember that after some number of files the compiler would just hang back then...not sure the state now.</p>



<a name="294877708"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/generating%20a%20big%20Roc%20program%20for%20benchmarking/near/294877708" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/generating.20a.20big.20Roc.20program.20for.20benchmarking.html#294877708">(Aug 23 2022 at 14:33)</a>:</h4>
<p>just a random generator - like something that makes valid <code>.roc</code> files which reference each other</p>



<a name="294877822"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/generating%20a%20big%20Roc%20program%20for%20benchmarking/near/294877822" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/generating.20a.20big.20Roc.20program.20for.20benchmarking.html#294877822">(Aug 23 2022 at 14:34)</a>:</h4>
<p>the goal wouldn't be fuzzing because the point wouldn't be to identify edge cases (e.g. no need for shrinking)</p>



<a name="294877943"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/generating%20a%20big%20Roc%20program%20for%20benchmarking/near/294877943" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/generating.20a.20big.20Roc.20program.20for.20benchmarking.html#294877943">(Aug 23 2022 at 14:34)</a>:</h4>
<p>the goal would just be raw lines of code in some generally realistic structure (e.g. files of nontrivial length that import various other files of nontrivial length)</p>



<a name="294877986"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/generating%20a%20big%20Roc%20program%20for%20benchmarking/near/294877986" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/generating.20a.20big.20Roc.20program.20for.20benchmarking.html#294877986">(Aug 23 2022 at 14:35)</a>:</h4>
<p>for the purpose of seeing how well the compiler can handle it, identifying performance bottlenecks, etc.</p>



<a name="294880413"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/generating%20a%20big%20Roc%20program%20for%20benchmarking/near/294880413" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/generating.20a.20big.20Roc.20program.20for.20benchmarking.html#294880413">(Aug 23 2022 at 14:44)</a>:</h4>
<p>My version just used jinja2 templates and in this case made a binary expansion of files.</p>
<div class="codehilite" data-code-language="Django/Jinja"><pre><span></span><code><span class="x">interface </span><span class="cp">{{</span> <span class="nv">name</span> <span class="cp">}}</span><span class="x"></span>
<span class="x">    exposes [ a, b ]</span>
<span class="x">    imports [ </span><span class="cp">{{</span> <span class="nv">left</span> <span class="cp">}}</span><span class="x">, </span><span class="cp">{{</span> <span class="nv">right</span> <span class="cp">}}</span><span class="x">]</span>

<span class="x">a = \n -&gt;</span>
<span class="x">    </span><span class="cp">{%</span> <span class="k">if</span> <span class="nv">flip1</span> <span class="cp">%}{{</span> <span class="nv">op1</span> <span class="cp">}}</span><span class="x"> (</span><span class="cp">{{</span> <span class="nv">left</span> <span class="cp">}}</span><span class="x">.a n) (</span><span class="cp">{{</span> <span class="nv">right</span> <span class="cp">}}</span><span class="x">.a </span><span class="cp">{{</span> <span class="nv">rand</span> <span class="cp">}}</span><span class="x">)</span><span class="cp">{%</span> <span class="k">else</span> <span class="cp">%}{{</span> <span class="nv">op1</span> <span class="cp">}}</span><span class="x"> (</span><span class="cp">{{</span> <span class="nv">left</span> <span class="cp">}}</span><span class="x">.a </span><span class="cp">{{</span> <span class="nv">rand</span> <span class="cp">}}</span><span class="x">) (</span><span class="cp">{{</span> <span class="nv">right</span> <span class="cp">}}</span><span class="x">.a n)</span><span class="cp">{%</span> <span class="k">endif</span> <span class="cp">%}</span><span class="x"></span>

<span class="x">b = \n -&gt;</span>
<span class="x">    </span><span class="cp">{%</span> <span class="k">if</span> <span class="nv">flip2</span> <span class="cp">%}{{</span> <span class="nv">op2</span> <span class="cp">}}</span><span class="x"> (</span><span class="cp">{{</span> <span class="nv">left</span> <span class="cp">}}</span><span class="x">.b n) (</span><span class="cp">{{</span> <span class="nv">right</span> <span class="cp">}}</span><span class="x">.b </span><span class="cp">{{</span> <span class="nv">rand</span> <span class="cp">}}</span><span class="x">)</span><span class="cp">{%</span> <span class="k">else</span> <span class="cp">%}{{</span> <span class="nv">op2</span> <span class="cp">}}</span><span class="x"> (</span><span class="cp">{{</span> <span class="nv">left</span> <span class="cp">}}</span><span class="x">.b </span><span class="cp">{{</span> <span class="nv">rand</span> <span class="cp">}}</span><span class="x">) (</span><span class="cp">{{</span> <span class="nv">right</span> <span class="cp">}}</span><span class="x">.b n)</span><span class="cp">{%</span> <span class="k">endif</span> <span class="cp">%}</span><span class="x"></span>
</code></pre></div>



<a name="294880534"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/generating%20a%20big%20Roc%20program%20for%20benchmarking/near/294880534" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/generating.20a.20big.20Roc.20program.20for.20benchmarking.html#294880534">(Aug 23 2022 at 14:44)</a>:</h4>
<p>Of course you could do something way more interesting. This just used a few possible functions from <code>Num</code> and some randomness to build out the tree.</p>



<a name="294880861"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/generating%20a%20big%20Roc%20program%20for%20benchmarking/near/294880861" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/generating.20a.20big.20Roc.20program.20for.20benchmarking.html#294880861">(Aug 23 2022 at 14:46)</a>:</h4>
<p>Making interesting to compiler functions is of course a much larger challenge than focus on something specific like number of files and module depth.</p>



<a name="294881642"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/generating%20a%20big%20Roc%20program%20for%20benchmarking/near/294881642" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/generating.20a.20big.20Roc.20program.20for.20benchmarking.html#294881642">(Aug 23 2022 at 14:47)</a>:</h4>
<p>right, the idea here would be to keep the scope minimal so it can be a quick project <span aria-label="big smile" class="emoji emoji-1f604" role="img" title="big smile">:big_smile:</span></p>



<a name="294884398"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/generating%20a%20big%20Roc%20program%20for%20benchmarking/near/294884398" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ayaz Hafiz <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/generating.20a.20big.20Roc.20program.20for.20benchmarking.html#294884398">(Aug 23 2022 at 14:56)</a>:</h4>
<p>If this is done, we'd want to be careful about the shape of the program that's generated. For example, I don't think we'd want to have any deeply nested closures - that is a known bottleneck that will dominate any perf trace, and how those constructs are treated in the compiler are likely to change soon.</p>



<a name="294887234"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/generating%20a%20big%20Roc%20program%20for%20benchmarking/near/294887234" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/generating.20a.20big.20Roc.20program.20for.20benchmarking.html#294887234">(Aug 23 2022 at 15:05)</a>:</h4>
<p>Depending on how complex of generation is wanted, I may be able to modify what I have to support this use case. I think what I had here was specifically trying to also support the dev backend, which is why it was so restricted.</p>



<hr><p>Last updated: Nov 01 2025 at 12:13 UTC</p>
</html>