<html>
<head><meta charset="utf-8"><title>language server · contributing · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/index.html">contributing</a></h2>
<h3>Topic: <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/language.20server.html">language server</a></h3>

<hr>

<base href="https://roc.zulipchat.com">

<head><link href="https://roc-lang.github.io/zulip-export/style.css" rel="stylesheet"></head>

<a name="345398194"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/language%20server/near/345398194" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> itmuckel <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/language.20server.html#345398194">(Mar 29 2023 at 13:17)</a>:</h4>
<p>Hi, is anyone already working on a language server? I would really like one, because I'm using roc in WSL2 all the time, can't have a GUI there and I also probably would want to use my default editor with all my settings, keybindings etc. If no one is working on one, I'd like to give it a go (also to learn more about the parser and compiler <span aria-label="nerd" class="emoji emoji-1f913" role="img" title="nerd">:nerd:</span> )</p>



<a name="345416962"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/language%20server/near/345416962" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/language.20server.html#345416962">(Mar 29 2023 at 14:19)</a>:</h4>
<p>Ayaz made a simple language server, it's available <a href="https://github.com/ayazhafiz/roc/releases/tag/langsrv">here</a>. We don't plan on officially supporting one because we're making our own editor where we can connect with the compiler without the restrictions or the latency of the language server protocol.</p>



<a name="345422582"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/language%20server/near/345422582" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> itmuckel <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/language.20server.html#345422582">(Mar 29 2023 at 14:35)</a>:</h4>
<p>Oh, that's cool, thank you for the hint :-)</p>



<a name="345424449"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/language%20server/near/345424449" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ayaz Hafiz <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/language.20server.html#345424449">(Mar 29 2023 at 14:40)</a>:</h4>
<p>As Anton mentioned it's quite naive, but if you are interested in learning more about the compiler of Roc, it could be interesting to add another feature you find valuable to it. Or, if you just want to learn more about and/or play with the compiler, we would be happy to find a project that would be interesting to work on!</p>



<a name="345437117"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/language%20server/near/345437117" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> itmuckel <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/language.20server.html#345437117">(Mar 29 2023 at 15:19)</a>:</h4>
<p>On linux and on windows I get these kind of errors:</p>
<div class="codehilite"><pre><span></span><code>error[E0512]: cannot transmute between types of different sizes, or dependently-sized types
  --&gt; /home/itmuckel/.cargo/git/checkouts/roc-f2007fde281427d6/52fa78a/crates/compiler/mono/src/ir.rs:75:1
   |
75 | roc_error_macros::assert_sizeof_non_wasm!(Expr, 9 * 8);
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
   |
   = note: source type: `ir::Expr&lt;&#39;_&gt;` (640 bits)
   = note: target type: `[u8; 72]` (576 bits)
   = note: this error originates in the macro `static_assertions::assert_eq_size` which comes from the expansion of the macro `roc_error_macros::assert_sizeof_non_wasm` (in Nightly builds, run with -Z macro-backtrace for more info)

error[E0512]: cannot transmute between types of different sizes, or dependently-sized types
  --&gt; /home/itmuckel/.cargo/git/checkouts/roc-f2007fde281427d6/52fa78a/crates/compiler/mono/src/ir.rs:76:1
   |
76 | roc_error_macros::assert_sizeof_non_wasm!(Stmt, 12 * 8);
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
   |
   = note: source type: `Stmt&lt;&#39;_&gt;` (832 bits)
   = note: target type: `[u8; 96]` (768 bits)
   = note: this error originates in the macro `static_assertions::assert_eq_size` which comes from the expansion of the macro `roc_error_macros::assert_sizeof_non_wasm` (in Nightly builds, run with -Z macro-backtrace for more info)
</code></pre></div>
<p>any idea where they could come from?</p>



<a name="345451766"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/language%20server/near/345451766" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> itmuckel <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/language.20server.html#345451766">(Mar 29 2023 at 16:10)</a>:</h4>
<p>compiling only with nix develop fixed it. :-/</p>



<a name="345455137"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/language%20server/near/345455137" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/language.20server.html#345455137">(Mar 29 2023 at 16:22)</a>:</h4>
<p>Ah yes, that can occur when you tried to build with a different rust version</p>



<a name="406906240"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/language%20server/near/406906240" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/language.20server.html#406906240">(Dec 09 2023 at 08:08)</a>:</h4>
<p>Just updated the language server and now I am getting unused variable warning where I don't think I was before. In the screenshot below you can see that I am using <code>calcNextHistory</code> in the <code>expect</code> but for some reason it is reporting this warning.<br>
<a href="/user_uploads/22008/Q3czrQfCDe23fEvpZeeS0qou/Screenshot-2023-12-09-at-19.06.16.png">Screenshot-2023-12-09-at-19.06.16.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/22008/Q3czrQfCDe23fEvpZeeS0qou/Screenshot-2023-12-09-at-19.06.16.png" title="Screenshot-2023-12-09-at-19.06.16.png"><img src="/user_uploads/22008/Q3czrQfCDe23fEvpZeeS0qou/Screenshot-2023-12-09-at-19.06.16.png"></a></div>



<a name="406906493"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/language%20server/near/406906493" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/language.20server.html#406906493">(Dec 09 2023 at 08:11)</a>:</h4>
<p>Also I have noticed messages like this occurring (though I don't think this is a recent change or anything), I suspect it has been running on repeat in the background and crashing. Is there a way to have it only run on file save?<br>
<a href="/user_uploads/22008/FU3BwLkJ4i6PnK7gB3FPruWq/Screenshot-2023-12-09-at-19.10.13.png">Screenshot-2023-12-09-at-19.10.13.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/22008/FU3BwLkJ4i6PnK7gB3FPruWq/Screenshot-2023-12-09-at-19.10.13.png" title="Screenshot-2023-12-09-at-19.10.13.png"><img src="/user_uploads/22008/FU3BwLkJ4i6PnK7gB3FPruWq/Screenshot-2023-12-09-at-19.10.13.png"></a></div>



<a name="406906722"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/language%20server/near/406906722" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/language.20server.html#406906722">(Dec 09 2023 at 08:14)</a>:</h4>
<p>Figured out where the errors are logged, this is what I see<br>
<a href="/user_uploads/22008/dP0pVvblYFoCwFaOR_F4TAYx/Screenshot-2023-12-09-at-19.14.03.png">Screenshot-2023-12-09-at-19.14.03.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/22008/dP0pVvblYFoCwFaOR_F4TAYx/Screenshot-2023-12-09-at-19.14.03.png" title="Screenshot-2023-12-09-at-19.14.03.png"><img src="/user_uploads/22008/dP0pVvblYFoCwFaOR_F4TAYx/Screenshot-2023-12-09-at-19.14.03.png"></a></div>



<a name="406906740"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/language%20server/near/406906740" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/language.20server.html#406906740">(Dec 09 2023 at 08:14)</a>:</h4>
<p>The program was in a known bad state (mid writing a function) when this occurred</p>



<a name="406906772"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/language%20server/near/406906772" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/language.20server.html#406906772">(Dec 09 2023 at 08:15)</a>:</h4>
<p>This might be more of a <span class="user-mention" data-user-id="625544">@Ivan Demchenko</span> VS code extension issue than language server?</p>



<a name="406908246"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/language%20server/near/406908246" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/language.20server.html#406908246">(Dec 09 2023 at 08:28)</a>:</h4>
<p>Logged <a href="https://github.com/roc-lang/roc/issues/6227">Issue #6227</a> for the unhandled parse issue.</p>
<p>I guess there is no way for VS Code to recover here. If the language server instantly panics all it can do it try again?</p>
<p>I was thinking maybe we could try once. But then wait until the file is saved before trying to restart the server? OTOH maybe this is a great way to find issues?</p>



<a name="406960154"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/language%20server/near/406960154" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pearce Keesling <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/language.20server.html#406960154">(Dec 09 2023 at 18:07)</a>:</h4>
<p>I've noticed I frequently need to restart the server in helix (luckily the server is so fast it is not a hassle)</p>



<a name="406961018"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/language%20server/near/406961018" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ayaz Hafiz <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/language.20server.html#406961018">(Dec 09 2023 at 18:21)</a>:</h4>
<p>The language server runs in the normal compile mode, not with expects turned on. That's an easy fix though if anyone wants to do it.</p>



<a name="406961118"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/language%20server/near/406961118" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ayaz Hafiz <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/language.20server.html#406961118">(Dec 09 2023 at 18:22)</a>:</h4>
<p>I'm pretty sure there is no way to configure a language server to only update documents on save. There might be a VSCode-specific setting but in general I think the answer is to fix the panics</p>



<a name="406968211"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/language%20server/near/406968211" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/language.20server.html#406968211">(Dec 09 2023 at 20:16)</a>:</h4>
<p>No worries. Well, now that I've seen the issue I'm going to watch the server like a hawk and try to catch and fix everything that crashes it, which also has the benefit of helpong roc provide better errors. I just hadn't noticed the notification before, and wasn't sure what to do about it.</p>



<a name="430401774"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/language%20server/near/430401774" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nat-418 <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/language.20server.html#430401774">(Mar 30 2024 at 16:14)</a>:</h4>
<p><span class="user-mention silent" data-user-id="361169">Anton</span> <a href="#narrow/stream/316715-contributing/topic/language.20server/near/345416962">said</a>:</p>
<blockquote>
<p>Ayaz made a simple language server, it's available <a href="https://github.com/ayazhafiz/roc/releases/tag/langsrv">here</a>. We don't plan on officially supporting one because we're making our own editor where we can connect with the compiler without the restrictions or the latency of the language server protocol.</p>
</blockquote>
<p>Is this information still accurate? It seems to me that LSP is basically a standard at this point, and having an officially "blessed" one would make it much easier to get people up and working in Roc with whatever editor they already have.</p>



<a name="430402267"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/language%20server/near/430402267" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/language.20server.html#430402267">(Mar 30 2024 at 16:23)</a>:</h4>
<blockquote>
<p>Is this information still accurate?</p>
</blockquote>
<p>No, a language server is now included with the nightly release :)</p>



<a name="430402643"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/language%20server/near/430402643" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nat-418 <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/language.20server.html#430402643">(Mar 30 2024 at 16:28)</a>:</h4>
<p><span class="user-mention silent" data-user-id="361169">Anton</span> <a href="#narrow/stream/316715-contributing/topic/language.20server/near/430402267">said</a>:</p>
<blockquote>
<blockquote>
<p>Is this information still accurate?</p>
</blockquote>
<p>No, a language server is now included with the nightly release :)</p>
</blockquote>
<p>Great, I am going to try and get it working with Neovim and contribute the configuration upstream so future new users can have an easy setup.</p>



<hr><p>Last updated: Nov 01 2025 at 12:13 UTC</p>
</html>