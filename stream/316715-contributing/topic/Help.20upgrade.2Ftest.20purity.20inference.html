<html>
<head><meta charset="utf-8"><title>Help upgrade/test purity inference · contributing · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/index.html">contributing</a></h2>
<h3>Topic: <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Help.20upgrade.2Ftest.20purity.20inference.html">Help upgrade/test purity inference</a></h3>

<hr>

<base href="https://roc.zulipchat.com">

<head><link href="https://roc-lang.github.io/zulip-export/style.css" rel="stylesheet"></head>

<a name="478391839"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Help%20upgrade/test%20purity%20inference/near/478391839" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Help.20upgrade.2Ftest.20purity.20inference.html#478391839">(Oct 23 2024 at 01:13)</a>:</h4>
<p>I'm just wondering if anyone would like to help with the work to upgrade to Purity Inference? My understanding is that Agus has made the changes backwards compatible, so this isn't an urgent or blocking thing, but helpful to find any issues.</p>
<p>I've been having fun working on it, and thought others might like to get involved too. I'm happy to help anyone if they would like to learn more.</p>
<p>I've started the upgrade for basic-cli here <a href="https://github.com/roc-lang/basic-cli/pull/257">https://github.com/roc-lang/basic-cli/pull/257</a> and done all the <code>platform/*.roc</code> files. Next up would be upgrading the <code>examples/*.roc</code> files and getting those all happy with <code>roc check</code>.</p>
<p>Then we need to update the host <code>roc_fx_*</code> type signatures, and update the call from the host into roc (which is now so much simpler with purity inference).</p>
<p>I've completely upgraded roc-ray to purity inference, so we have that as an example if we need. You can see the code and test it out if you want here <a href="https://github.com/lukewilliamboswell/roc-ray/pull/38">https://github.com/lukewilliamboswell/roc-ray/pull/38</a></p>



<a name="478401706"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Help%20upgrade/test%20purity%20inference/near/478401706" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Help.20upgrade.2Ftest.20purity.20inference.html#478401706">(Oct 23 2024 at 03:05)</a>:</h4>
<p>I'm your guy</p>



<a name="478401985"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Help%20upgrade/test%20purity%20inference/near/478401985" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Help.20upgrade.2Ftest.20purity.20inference.html#478401985">(Oct 23 2024 at 03:06)</a>:</h4>
<p>Do you have anything in particular that you already want to do, or is it just the stuff you listed?</p>



<a name="478403670"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Help%20upgrade/test%20purity%20inference/near/478403670" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Help.20upgrade.2Ftest.20purity.20inference.html#478403670">(Oct 23 2024 at 03:17)</a>:</h4>
<p>Yeah just the stuff I listed. <span aria-label="sunglasses" class="emoji emoji-1f60e" role="img" title="sunglasses">:sunglasses:</span></p>



<a name="478403934"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Help%20upgrade/test%20purity%20inference/near/478403934" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Help.20upgrade.2Ftest.20purity.20inference.html#478403934">(Oct 23 2024 at 03:20)</a>:</h4>
<p>Sounds good. I probably won't have <em>that</em> much time for this, so we'd be happy to have any volunteers for this!</p>



<a name="478419178"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Help%20upgrade/test%20purity%20inference/near/478419178" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Oskar Hahn <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Help.20upgrade.2Ftest.20purity.20inference.html#478419178">(Oct 23 2024 at 06:10)</a>:</h4>
<p>Could you list the things necessary to update a platform?</p>
<ul>
<li>Remove Task</li>
<li>Change the signature functions, that call into the host. Add an <code>!</code> and change <code>-&gt;</code> to <code>=&gt;</code>. </li>
</ul>
<p>How did the interface between the platform and the host change? You write, that <code>roc_fx_*</code> has to be updated. In which way?</p>



<a name="478490280"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Help%20upgrade/test%20purity%20inference/near/478490280" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Agus Zubiaga <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Help.20upgrade.2Ftest.20purity.20inference.html#478490280">(Oct 23 2024 at 12:59)</a>:</h4>
<p>The main difference is that effects that can’t fail would return their values directly instead of being wrapped in <code>Result</code>, so you need to adjust the host to reflect that. If the effectful function returns <code>{}</code>, the host side would just be <code>void</code>. The name of the <code>roc_fx_*</code> function remains unchanged. The <code>!</code> suffix that would appear in the hosted function is dropped.</p>



<a name="478491013"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Help%20upgrade/test%20purity%20inference/near/478491013" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Agus Zubiaga <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Help.20upgrade.2Ftest.20purity.20inference.html#478491013">(Oct 23 2024 at 13:02)</a>:</h4>
<p>The other difference is that when you are running <code>Task</code> in the host today (from the entry point), you have to unwrap the closure inside and call that, but now you’d get effectful functions instead that you can run directly</p>



<a name="478491112"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Help%20upgrade/test%20purity%20inference/near/478491112" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Agus Zubiaga <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Help.20upgrade.2Ftest.20purity.20inference.html#478491112">(Oct 23 2024 at 13:03)</a>:</h4>
<p>You can see these changes in Luke’s PR: <a href="https://github.com/lukewilliamboswell/roc-ray/pull/38/files#diff-fb36a3f95902a5f802b4bedd10bbe149ef6acb768f7815bf10f15ecbeb486595">https://github.com/lukewilliamboswell/roc-ray/pull/38/files#diff-fb36a3f95902a5f802b4bedd10bbe149ef6acb768f7815bf10f15ecbeb486595</a></p>



<a name="478491350"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Help%20upgrade/test%20purity%20inference/near/478491350" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Agus Zubiaga <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Help.20upgrade.2Ftest.20purity.20inference.html#478491350">(Oct 23 2024 at 13:04)</a>:</h4>
<p>That’s it for the host side</p>



<a name="478491788"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Help%20upgrade/test%20purity%20inference/near/478491788" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Agus Zubiaga <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Help.20upgrade.2Ftest.20purity.20inference.html#478491788">(Oct 23 2024 at 13:06)</a>:</h4>
<p>As Luke said, the compiler will be backwards compatible with <code>Task</code> for a while. It detects what fx mode to use based on whether the platform’s <code>hosted</code> module exposes effectful functions or <code>Task</code>.</p>



<a name="478519777"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Help%20upgrade/test%20purity%20inference/near/478519777" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Help.20upgrade.2Ftest.20purity.20inference.html#478519777">(Oct 23 2024 at 15:10)</a>:</h4>
<p>As a note, the changes to the platform API are basically going back to before we had task as builtin. For example, I updated wasm4 from before task as builtin directly to purity inference. The host basically didn't change. The one caveat is that I stopped returning a record of lambdas to the host and instead returned two functions cause that is simply nicer to use from the host.</p>



<a name="478585620"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Help%20upgrade/test%20purity%20inference/near/478585620" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Oskar Hahn <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Help.20upgrade.2Ftest.20purity.20inference.html#478585620">(Oct 23 2024 at 21:22)</a>:</h4>
<p>So is it possible now to export more than one function? That is nice.</p>



<a name="478591513"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Help%20upgrade/test%20purity%20inference/near/478591513" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Help.20upgrade.2Ftest.20purity.20inference.html#478591513">(Oct 23 2024 at 22:10)</a>:</h4>
<p>One thing I'd add is that purity inference hasn't landed in roc main yet. So the first thing I did was update the nix flake to point at the branch.</p>
<div class="codehilite" data-code-language="Nix"><pre><span></span><code><span class="ss">inputs</span> <span class="o">=</span> <span class="p">{</span>
     roc<span class="o">.</span><span class="ss">url</span> <span class="o">=</span> <span class="s2">"github:roc-lang/roc?ref=purity-inference"</span><span class="p">;</span>
     nixpkgs<span class="o">.</span><span class="ss">url</span> <span class="o">=</span> <span class="s2">"github:nixos/nixpkgs"</span><span class="p">;</span>
   <span class="p">};</span>
</code></pre></div>
<p>Then I basically started updating the type annotations and just followed the compiler errors all the way through until I was completed (for the platform side). <span aria-label="smiley" class="emoji emoji-1f603" role="img" title="smiley">:smiley:</span></p>



<a name="478596198"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Help%20upgrade/test%20purity%20inference/near/478596198" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Help.20upgrade.2Ftest.20purity.20inference.html#478596198">(Oct 23 2024 at 22:56)</a>:</h4>
<blockquote>
<p>So is it possible now to export more than one function? That is nice.</p>
</blockquote>
<p>yeah, this is in nightly currently. Don't even need purity inference for it. I added it a few weeks back</p>



<a name="478596213"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Help%20upgrade/test%20purity%20inference/near/478596213" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Help.20upgrade.2Ftest.20purity.20inference.html#478596213">(Oct 23 2024 at 22:56)</a>:</h4>
<p>Makes a lot of apis a lot simpler in the platform. Anything to get away from dealing with closures</p>



<a name="478774251"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Help%20upgrade/test%20purity%20inference/near/478774251" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Help.20upgrade.2Ftest.20purity.20inference.html#478774251">(Oct 24 2024 at 18:17)</a>:</h4>
<p><span class="user-mention" data-user-id="489294">@Agus Zubiaga</span> one thing to double check that came up in <a class="stream-topic" data-stream-id="395097" href="/#narrow/channel/395097-compiler-development/topic/Early.20return.20and.20correct.20refcounting">#compiler development &gt; Early return and correct refcounting</a>. We need to make sure that we don't reorder effectful function calls. I assume they all get toposorted with the pure functions currently. Unlike task where the await lambas enforced order, purity inference would have nothing to enforce order.</p>



<a name="478777643"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Help%20upgrade/test%20purity%20inference/near/478777643" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Help.20upgrade.2Ftest.20purity.20inference.html#478777643">(Oct 24 2024 at 18:41)</a>:</h4>
<p>Yeah, just tested something really basic in roc-wasm4. This will reorder, which could be really problematic for side effecting ops:</p>
<div class="codehilite"><pre><span></span><code>    i =
        W4.trace! &quot;this should print first&quot;
        j

    j =
        W4.trace! &quot;this should print second&quot;
        1
</code></pre></div>
<p>outputs:</p>
<div class="codehilite"><pre><span></span><code>this should print second
this should print first
</code></pre></div>



<a name="478778002"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Help%20upgrade/test%20purity%20inference/near/478778002" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Help.20upgrade.2Ftest.20purity.20inference.html#478778002">(Oct 24 2024 at 18:43)</a>:</h4>
<p>I think this, while being problematic, should still be outside of the purity inference PR</p>



<a name="478778214"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Help%20upgrade/test%20purity%20inference/near/478778214" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Help.20upgrade.2Ftest.20purity.20inference.html#478778214">(Oct 24 2024 at 18:44)</a>:</h4>
<p>We should make a separate PR that:</p>
<ul>
<li>Stops reordering defs outside of top-level functions</li>
<li>Gives more helpful error messages in light of this where efficiently feasible</li>
</ul>



<a name="478778955"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Help%20upgrade/test%20purity%20inference/near/478778955" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Help.20upgrade.2Ftest.20purity.20inference.html#478778955">(Oct 24 2024 at 18:49)</a>:</h4>
<p>By "efficiently feasible", I mean that even though errors saying "you defined y after x so you can't use y in x" would be helpful, I'm not sure if they require creation of a dependency graph, and I expect standard liveness checking would be a good bit more efficient</p>



<a name="478779438"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Help%20upgrade/test%20purity%20inference/near/478779438" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Help.20upgrade.2Ftest.20purity.20inference.html#478779438">(Oct 24 2024 at 18:52)</a>:</h4>
<p>I think we still need the same dependency graph to check for things like cyclic definitions</p>



<a name="478779463"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Help%20upgrade/test%20purity%20inference/near/478779463" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Help.20upgrade.2Ftest.20purity.20inference.html#478779463">(Oct 24 2024 at 18:52)</a>:</h4>
<p>we just need to not use it to reorder as many things as we are today</p>



<a name="478779576"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Help%20upgrade/test%20purity%20inference/near/478779576" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Agus Zubiaga <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Help.20upgrade.2Ftest.20purity.20inference.html#478779576">(Oct 24 2024 at 18:53)</a>:</h4>
<p>Oh, great catch! I forgot we did this</p>



<a name="478779958"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Help%20upgrade/test%20purity%20inference/near/478779958" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Agus Zubiaga <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Help.20upgrade.2Ftest.20purity.20inference.html#478779958">(Oct 24 2024 at 18:56)</a>:</h4>
<p>So we would reorder unless the def calls an effectful function, in which case we would report an error?</p>



<a name="478780035"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Help%20upgrade/test%20purity%20inference/near/478780035" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Agus Zubiaga <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Help.20upgrade.2Ftest.20purity.20inference.html#478780035">(Oct 24 2024 at 18:56)</a>:</h4>
<p>Or do we want to always require that defs are defined in order unless recursive?</p>



<a name="478780077"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Help%20upgrade/test%20purity%20inference/near/478780077" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Agus Zubiaga <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Help.20upgrade.2Ftest.20purity.20inference.html#478780077">(Oct 24 2024 at 18:57)</a>:</h4>
<p>(deleted)</p>



<a name="478780542"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Help%20upgrade/test%20purity%20inference/near/478780542" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Help.20upgrade.2Ftest.20purity.20inference.html#478780542">(Oct 24 2024 at 18:59)</a>:</h4>
<p>Current plan is that everything is in order except for top level definitions.</p>



<a name="478780638"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Help%20upgrade/test%20purity%20inference/near/478780638" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Help.20upgrade.2Ftest.20purity.20inference.html#478780638">(Oct 24 2024 at 19:00)</a>:</h4>
<p>Just makes the model simple</p>



<a name="478780789"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Help%20upgrade/test%20purity%20inference/near/478780789" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Agus Zubiaga <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Help.20upgrade.2Ftest.20purity.20inference.html#478780789">(Oct 24 2024 at 19:01)</a>:</h4>
<p>Oh ok. Except top-level and recursive functions, right?</p>



<a name="478780828"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Help%20upgrade/test%20purity%20inference/near/478780828" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Help.20upgrade.2Ftest.20purity.20inference.html#478780828">(Oct 24 2024 at 19:01)</a>:</h4>
<p>I think we decided to disallow inline recursive functions</p>



<a name="478780843"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Help%20upgrade/test%20purity%20inference/near/478780843" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Agus Zubiaga <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Help.20upgrade.2Ftest.20purity.20inference.html#478780843">(Oct 24 2024 at 19:01)</a>:</h4>
<p>I’ll read the other thread</p>



<a name="478780845"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Help%20upgrade/test%20purity%20inference/near/478780845" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Help.20upgrade.2Ftest.20purity.20inference.html#478780845">(Oct 24 2024 at 19:01)</a>:</h4>
<p>just be like if you need a recursive function, make it top-level</p>



<a name="478780892"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Help%20upgrade/test%20purity%20inference/near/478780892" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Help.20upgrade.2Ftest.20purity.20inference.html#478780892">(Oct 24 2024 at 19:01)</a>:</h4>
<p>comes up super rarely (if ever) anyway haha</p>



<a name="478780927"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Help%20upgrade/test%20purity%20inference/near/478780927" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Agus Zubiaga <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Help.20upgrade.2Ftest.20purity.20inference.html#478780927">(Oct 24 2024 at 19:02)</a>:</h4>
<p>Ok yeah, that’s really simple <span aria-label="grinning" class="emoji emoji-1f600" role="img" title="grinning">:grinning:</span></p>



<a name="478781336"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Help%20upgrade/test%20purity%20inference/near/478781336" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Agus Zubiaga <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Help.20upgrade.2Ftest.20purity.20inference.html#478781336">(Oct 24 2024 at 19:04)</a>:</h4>
<p><span class="user-mention" data-user-id="461444">@Sam Mohr</span> are you planning to work on this change or should I?</p>



<a name="478781564"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Help%20upgrade/test%20purity%20inference/near/478781564" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Help.20upgrade.2Ftest.20purity.20inference.html#478781564">(Oct 24 2024 at 19:06)</a>:</h4>
<p>I'm happy to work on it, but not planning on it</p>



<a name="478781586"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Help%20upgrade/test%20purity%20inference/near/478781586" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Help.20upgrade.2Ftest.20purity.20inference.html#478781586">(Oct 24 2024 at 19:06)</a>:</h4>
<p>If you've got time, feel free!</p>



<a name="478781717"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Help%20upgrade/test%20purity%20inference/near/478781717" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Help.20upgrade.2Ftest.20purity.20inference.html#478781717">(Oct 24 2024 at 19:07)</a>:</h4>
<p>If you don't pick it up, I'll do it once I finish return</p>



<a name="478781736"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Help%20upgrade/test%20purity%20inference/near/478781736" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Help.20upgrade.2Ftest.20purity.20inference.html#478781736">(Oct 24 2024 at 19:07)</a>:</h4>
<p>As you point out, it's easy for either of us to do <span aria-label="smile" class="emoji emoji-1f642" role="img" title="smile">:smile:</span></p>



<a name="478781856"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Help%20upgrade/test%20purity%20inference/near/478781856" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Agus Zubiaga <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Help.20upgrade.2Ftest.20purity.20inference.html#478781856">(Oct 24 2024 at 19:08)</a>:</h4>
<p>Cool! Let’s just make sure we tell the other if we start it <span aria-label="big smile" class="emoji emoji-1f604" role="img" title="big smile">:big_smile:</span></p>



<a name="478781886"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Help%20upgrade/test%20purity%20inference/near/478781886" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Help.20upgrade.2Ftest.20purity.20inference.html#478781886">(Oct 24 2024 at 19:08)</a>:</h4>
<p>haha sure thing</p>



<a name="478786439"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Help%20upgrade/test%20purity%20inference/near/478786439" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Help.20upgrade.2Ftest.20purity.20inference.html#478786439">(Oct 24 2024 at 19:39)</a>:</h4>
<blockquote>
<p>just be like if you need a recursive function, make it top-level</p>
</blockquote>
<p>I assume a self recursive function should work fine even if nested? It is just mutually recursive functions that will be blocked?</p>



<a name="478786812"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Help%20upgrade/test%20purity%20inference/near/478786812" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Help.20upgrade.2Ftest.20purity.20inference.html#478786812">(Oct 24 2024 at 19:41)</a>:</h4>
<p>right, yeah</p>



<a name="481153103"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Help%20upgrade/test%20purity%20inference/near/481153103" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jan kili <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Help.20upgrade.2Ftest.20purity.20inference.html#481153103">(Nov 07 2024 at 16:09)</a>:</h4>
<p>I've been working with Luke to try to update roc-platform-template-rust, and I've been hitting confusing setup issues and lower-level-than-expected errors. Is that work the best way for a higher-level programmer like me to help purity-inference along, or is there another way I can help it get into main / usable?</p>



<a name="481173956"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Help%20upgrade/test%20purity%20inference/near/481173956" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Agus Zubiaga <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Help.20upgrade.2Ftest.20purity.20inference.html#481173956">(Nov 07 2024 at 18:05)</a>:</h4>
<p>Can you post an example? Do you mean you found bugs in the code generation or confusing error messages?</p>



<a name="481174298"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Help%20upgrade/test%20purity%20inference/near/481174298" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Agus Zubiaga <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Help.20upgrade.2Ftest.20purity.20inference.html#481174298">(Nov 07 2024 at 18:07)</a>:</h4>
<p>I know getting the memory layouts right on the platform side is tricky, but I think that’s orthogonal to purity inference itself</p>



<a name="481174995"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Help%20upgrade/test%20purity%20inference/near/481174995" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Agus Zubiaga <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Help.20upgrade.2Ftest.20purity.20inference.html#481174995">(Nov 07 2024 at 18:12)</a>:</h4>
<p>Re getting on main, I’m planning to merge shortly but some tests seem to be failing on Linux despite the programs they run working fine outside of tests</p>



<a name="481175359"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Help%20upgrade/test%20purity%20inference/near/481175359" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Agus Zubiaga <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Help.20upgrade.2Ftest.20purity.20inference.html#481175359">(Nov 07 2024 at 18:15)</a>:</h4>
<p>It seems to be related to building a platform multiple times in parallel. I tried to fix it by building it only once and then using <code>—prebuilt-platform</code> but that didn’t help. I’ll take another look tonight.</p>



<a name="481177184"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Help%20upgrade/test%20purity%20inference/near/481177184" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jan kili <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Help.20upgrade.2Ftest.20purity.20inference.html#481177184">(Nov 07 2024 at 18:27)</a>:</h4>
<ol>
<li>I'm getting confused between building PI roc locally and referencing PI roc via <code>roc_std</code> in <code>roc_host/</code>, which seems like a simple confusion that compounds everything else but also points to my general ignorance as to how packages are built</li>
<li><code>cargo build</code> froze with no error message here: <a href="https://github.com/lukewilliamboswell/roc-platform-template-rust/pull/2#issue-2636489209">https://github.com/lukewilliamboswell/roc-platform-template-rust/pull/2#issue-2636489209</a></li>
<li>updating FFI seems required, which is deeper than I want to go <a href="https://github.com/lukewilliamboswell/roc-platform-template-rust/pull/2#issuecomment-2460978387">https://github.com/lukewilliamboswell/roc-platform-template-rust/pull/2#issuecomment-2460978387</a></li>
</ol>



<a name="481177968"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Help%20upgrade/test%20purity%20inference/near/481177968" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jan kili <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Help.20upgrade.2Ftest.20purity.20inference.html#481177968">(Nov 07 2024 at 18:32)</a>:</h4>
<p>Stepping back a bit, I'm getting frustrated because I've been wanting to write a new Roc app by extending a basic platform, but I keep getting blocked by lower-level things like how platforms work behind the senes. It feels like we're in an in-between time where I shouldn't use main and I can't use purity-inference, but maybe I just need to start with main &amp; basic-cli instead of a template?</p>



<a name="481178270"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Help%20upgrade/test%20purity%20inference/near/481178270" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jan kili <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Help.20upgrade.2Ftest.20purity.20inference.html#481178270">(Nov 07 2024 at 18:34)</a>:</h4>
<p>Perhaps I've oversold my capacity to assist, since I'm only poking at this for like 30 minutes per day and don't feel like learning much that is tangential to my goals.</p>



<a name="481178692"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Help%20upgrade/test%20purity%20inference/near/481178692" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Agus Zubiaga <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Help.20upgrade.2Ftest.20purity.20inference.html#481178692">(Nov 07 2024 at 18:36)</a>:</h4>
<p>Note that we don’t have to migrate platforms to get the purity inference PR merged since it’s backwards compatible with <code>Task</code>-based platforms.</p>



<a name="481178888"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Help%20upgrade/test%20purity%20inference/near/481178888" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Agus Zubiaga <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Help.20upgrade.2Ftest.20purity.20inference.html#481178888">(Nov 07 2024 at 18:38)</a>:</h4>
<p>You can’t mix and match in an app, but we can incrementally migrate platforms after merging</p>



<a name="481179014"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Help%20upgrade/test%20purity%20inference/near/481179014" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Agus Zubiaga <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Help.20upgrade.2Ftest.20purity.20inference.html#481179014">(Nov 07 2024 at 18:39)</a>:</h4>
<p>I don’t have a lot of free time now, so my focus is on getting the PR merged, but I’m happy to help with any platform efforts after</p>



<a name="481180321"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Help%20upgrade/test%20purity%20inference/near/481180321" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jan kili <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Help.20upgrade.2Ftest.20purity.20inference.html#481180321">(Nov 07 2024 at 18:47)</a>:</h4>
<p>Sounds like maybe I should just use the nightly and build on basic-cli as-is!</p>



<a name="481189978"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Help%20upgrade/test%20purity%20inference/near/481189978" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Help.20upgrade.2Ftest.20purity.20inference.html#481189978">(Nov 07 2024 at 19:55)</a>:</h4>
<p><span class="user-mention silent" data-user-id="489294">Agus Zubiaga</span> <a href="#narrow/channel/316715-contributing/topic/Help.20upgrade.2Ftest.20purity.20inference/near/481174995">said</a>:</p>
<blockquote>
<p>Re getting on main, I’m planning to merge shortly but some tests seem to be failing on Linux despite the programs they run working fine outside of tests</p>
</blockquote>
<p>Can we please ignore them. We've done a big uplift in the rebuild host PR and we will merge them in once purity inference lands.</p>



<a name="481192601"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Help%20upgrade/test%20purity%20inference/near/481192601" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Agus Zubiaga <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Help.20upgrade.2Ftest.20purity.20inference.html#481192601">(Nov 07 2024 at 20:12)</a>:</h4>
<p>Yeah, we could. It just occurred to me that I was testing the program on Linux arm while the tests run on x86. I’ll check that first just in case.</p>



<a name="481210216"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Help%20upgrade/test%20purity%20inference/near/481210216" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jasper Woudenberg <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Help.20upgrade.2Ftest.20purity.20inference.html#481210216">(Nov 07 2024 at 22:30)</a>:</h4>
<p>I'm trying out the purity inference branch with the Zig platform I'm working on. Really pleaseant experience so far, with great error messages.</p>
<p>I ran into a corner case. Suppose I have the following code:</p>
<div class="codehilite"><pre><span></span><code>foo : {} =&gt; U8

expect foo {} == 25
</code></pre></div>
<p>I get this warning:</p>
<div class="codehilite"><pre><span></span><code>── EFFECT IN TOP-LEVEL in platform/PagesInternal.roc ───────────────────────────

This call to PagesInternal.foo might produce an effect:

12│  expect foo {} == 25
            ^^^^^^
</code></pre></div>
<p>This is a weird example, in the real one that I simplified to this I have a higher-level function that supports running effectfully or not depending on the function passed in, and I have a couple of tests where I pass in pure functions. I don't think the warning should show under those circumstances (the test pass).</p>
<p>Also, I don't think code in an <code>expect</code> is considered top-level, right?</p>



<a name="481210648"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Help%20upgrade/test%20purity%20inference/near/481210648" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Help.20upgrade.2Ftest.20purity.20inference.html#481210648">(Nov 07 2024 at 22:34)</a>:</h4>
<p>To my understanding, we have avoided support for effect polymorphism, meaning that a function that takes in either a pure or effectful function will "assume" it takes an effectful function</p>



<a name="481210690"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Help%20upgrade/test%20purity%20inference/near/481210690" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Help.20upgrade.2Ftest.20purity.20inference.html#481210690">(Nov 07 2024 at 22:34)</a>:</h4>
<p>For us to support that would entail exposing <code>fx</code> variables in user code, which is messier than we want for now</p>



<a name="481210749"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Help%20upgrade/test%20purity%20inference/near/481210749" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Help.20upgrade.2Ftest.20purity.20inference.html#481210749">(Nov 07 2024 at 22:35)</a>:</h4>
<p>Though in the future we may realize we get strong benefit from effect polymorphism, so the door isn't fully closed</p>



<a name="481210764"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Help%20upgrade/test%20purity%20inference/near/481210764" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Help.20upgrade.2Ftest.20purity.20inference.html#481210764">(Nov 07 2024 at 22:35)</a>:</h4>
<p>All in all, I'd say this is expected behavior</p>



<a name="481210820"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Help%20upgrade/test%20purity%20inference/near/481210820" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Agus Zubiaga <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Help.20upgrade.2Ftest.20purity.20inference.html#481210820">(Nov 07 2024 at 22:35)</a>:</h4>
<p>Yeah, if you managed to write an effect polymorphic function, I’d be really interested to see it because that’d be considered a bug <span aria-label="laughing" class="emoji emoji-1f606" role="img" title="laughing">:laughing:</span></p>



<a name="481210948"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Help%20upgrade/test%20purity%20inference/near/481210948" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Help.20upgrade.2Ftest.20purity.20inference.html#481210948">(Nov 07 2024 at 22:36)</a>:</h4>
<p>And yes, the <code>expect</code>at the top-level considers its body as part of the "top-level" code</p>



<a name="481210968"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Help%20upgrade/test%20purity%20inference/near/481210968" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Agus Zubiaga <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Help.20upgrade.2Ftest.20purity.20inference.html#481210968">(Nov 07 2024 at 22:37)</a>:</h4>
<p>we probably need a specific error message for effects in expects</p>



<a name="481210991"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Help%20upgrade/test%20purity%20inference/near/481210991" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Agus Zubiaga <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Help.20upgrade.2Ftest.20purity.20inference.html#481210991">(Nov 07 2024 at 22:37)</a>:</h4>
<p>“top-level” might be confusing in that context</p>



<a name="481211042"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Help%20upgrade/test%20purity%20inference/near/481211042" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Help.20upgrade.2Ftest.20purity.20inference.html#481211042">(Nov 07 2024 at 22:38)</a>:</h4>
<p>Eventually the plan is to remove <code>expect-fx</code> and just have <code>expect \get!, set! -&gt; ...</code>, so we can probably improve the error messages then</p>



<a name="481211098"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Help%20upgrade/test%20purity%20inference/near/481211098" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Help.20upgrade.2Ftest.20purity.20inference.html#481211098">(Nov 07 2024 at 22:38)</a>:</h4>
<p>But it would be an improvement to add that now, too</p>



<a name="481211397"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Help%20upgrade/test%20purity%20inference/near/481211397" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Agus Zubiaga <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Help.20upgrade.2Ftest.20purity.20inference.html#481211397">(Nov 07 2024 at 22:41)</a>:</h4>
<p>Yeah, that’ll come later</p>



<a name="481211474"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Help%20upgrade/test%20purity%20inference/near/481211474" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Help.20upgrade.2Ftest.20purity.20inference.html#481211474">(Nov 07 2024 at 22:42)</a>:</h4>
<p>"add that now" meaning the top-level expect with effects message</p>



<a name="481212070"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Help%20upgrade/test%20purity%20inference/near/481212070" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Agus Zubiaga <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Help.20upgrade.2Ftest.20purity.20inference.html#481212070">(Nov 07 2024 at 22:48)</a>:</h4>
<p>Oh, I think I know where the confusion might come from. You are allowed to pass a pure function to something that expects an effectful function. However, the higher order function is still considered effectful.</p>



<a name="481212389"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Help%20upgrade/test%20purity%20inference/near/481212389" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Agus Zubiaga <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Help.20upgrade.2Ftest.20purity.20inference.html#481212389">(Nov 07 2024 at 22:52)</a>:</h4>
<p>You get warnings for things that don’t make sense like discarding the result of a pure function because that’s dead code. But otherwise, pure unifies with effectful.</p>



<a name="481212456"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Help%20upgrade/test%20purity%20inference/near/481212456" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Agus Zubiaga <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Help.20upgrade.2Ftest.20purity.20inference.html#481212456">(Nov 07 2024 at 22:53)</a>:</h4>
<p>and not the other way around, of course</p>



<a name="481212543"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Help%20upgrade/test%20purity%20inference/near/481212543" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jasper Woudenberg <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Help.20upgrade.2Ftest.20purity.20inference.html#481212543">(Nov 07 2024 at 22:54)</a>:</h4>
<p>Ah that makes sense, thanks.</p>
<p>I ran into something else. I've some functions that construct some build steps. Basically they take effectful functions and store them in a record without running them, and so are not effectul themselves (the compiler agrees). The record field needs a <code>!</code>, so far so good. However, in some places I'm initializing that record with a pure function and I get a warning</p>
<div class="codehilite"><pre><span></span><code>Config : {
    fn! : U8 =&gt; U8,
}

init : Config
init = {
    fn!: \x -&gt; x,
}
</code></pre></div>
<div class="codehilite"><pre><span></span><code>── UNNECESSARY EXCLAMATION in platform/PagesInternal.roc ───────────────────────

This field&#39;s value is a pure function, but its name suggests
otherwise:

20│      fn!: \x -&gt; x,
         ^^^^^^^^^^^^
</code></pre></div>
<p>I can't take out the <code>!</code> as the error suggests, because that would break the contract and constrain <code>fn</code> to be effectful everywhere.</p>



<a name="481213534"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Help%20upgrade/test%20purity%20inference/near/481213534" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jasper Woudenberg <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Help.20upgrade.2Ftest.20purity.20inference.html#481213534">(Nov 07 2024 at 23:04)</a>:</h4>
<p>I managed to get rid of those earlier warnings I mentioned. I just had to manually created a pure version of the "polymorphic" function, use that version in tests, pull the common pure logic between the two (almost the entire function) into a helper. Pretty neat <span aria-label="heart eyes" class="emoji emoji-1f60d" role="img" title="heart eyes">:heart_eyes:</span>.</p>



<a name="481218379"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Help%20upgrade/test%20purity%20inference/near/481218379" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Agus Zubiaga <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Help.20upgrade.2Ftest.20purity.20inference.html#481218379">(Nov 07 2024 at 23:56)</a>:</h4>
<p><span class="user-mention silent" data-user-id="477725">Jasper Woudenberg</span> <a href="#narrow/channel/316715-contributing/topic/Help.20upgrade.2Ftest.20purity.20inference/near/481212543">said</a>:</p>
<blockquote>
<div class="codehilite"><pre><span></span><code>── UNNECESSARY EXCLAMATION in platform/PagesInternal.roc ───────────────────────

This field&#39;s value is a pure function, but its name suggests
otherwise:

20│      fn!: \x -&gt; x,
         ^^^^^^^^^^^^
</code></pre></div>
<p>I can't take out the <code>!</code> as the error suggests, because that would break the contract and constrain <code>fn</code> to be effectful everywhere.</p>
</blockquote>
<p>Oh, that's a really good catch! I guess we only want this warning for record annotations, and destructuring, but not in record literals specifically.</p>



<a name="481218934"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Help%20upgrade/test%20purity%20inference/near/481218934" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Agus Zubiaga <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Help.20upgrade.2Ftest.20purity.20inference.html#481218934">(Nov 08 2024 at 00:01)</a>:</h4>
<p>we do want the opposite (MISSING EXCLAMATION) for record literals</p>



<a name="482929237"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Help%20upgrade/test%20purity%20inference/near/482929237" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Help.20upgrade.2Ftest.20purity.20inference.html#482929237">(Nov 18 2024 at 04:55)</a>:</h4>
<p>I think I found another strange purity-inference related bug while upgrading roc-wasm4</p>
<p><a href="https://github.com/lukewilliamboswell/roc-wasm4/pull/32#issuecomment-2481949480">https://github.com/lukewilliamboswell/roc-wasm4/pull/32#issuecomment-2481949480</a></p>
<p>I'm having trouble finding the source of this.</p>



<a name="482929255"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Help%20upgrade/test%20purity%20inference/near/482929255" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Help.20upgrade.2Ftest.20purity.20inference.html#482929255">(Nov 18 2024 at 04:55)</a>:</h4>
<div class="codehilite"><pre><span></span><code>$ roc build ./examples/sound.roc --target=wasm32 --no-link
thread &#39;main&#39; panicked at crates/compiler/mono/src/reset_reuse.rs:1269:42:
Expected symbol to have a layout. It should have been inserted in the environment already.
note: run with `RUST_BACKTRACE=1` environment variable to display a backtrace
</code></pre></div>



<a name="483800791"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Help%20upgrade/test%20purity%20inference/near/483800791" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jan kili <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Help.20upgrade.2Ftest.20purity.20inference.html#483800791">(Nov 21 2024 at 22:31)</a>:</h4>
<p>I see that all first-party platforms use pre-purity-inference Task-ful syntax. Do we/you want to intentionally defer all purity-inference update work until after AoC for stability and to prioritize responding to newcomer issues? Or do we/you hope to push <code>basic-*</code> across the finish line by next week?</p>



<a name="483801194"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Help%20upgrade/test%20purity%20inference/near/483801194" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Help.20upgrade.2Ftest.20purity.20inference.html#483801194">(Nov 21 2024 at 22:34)</a>:</h4>
<p>Just waiting on a review for <a href="https://github.com/roc-lang/roc/pull/7204">https://github.com/roc-lang/roc/pull/7204</a></p>
<p>If we can merge that and get a new nightly... it's a clear path to a new purity-inference basic-cli</p>



<a name="483801463"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Help%20upgrade/test%20purity%20inference/near/483801463" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Help.20upgrade.2Ftest.20purity.20inference.html#483801463">(Nov 21 2024 at 22:36)</a>:</h4>
<p>So could be on the streets early next week... folks can always use an older Task-based version of basic-cli if there are any issues with the new purity inference one, so we can keep it in pre-release until it's had a few more people test it out</p>



<a name="483802002"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Help%20upgrade/test%20purity%20inference/near/483802002" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jan kili <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Help.20upgrade.2Ftest.20purity.20inference.html#483802002">(Nov 21 2024 at 22:40)</a>:</h4>
<p>In all but the most optimistic forecasts, does that mean we should prepare to keep post-purity-inference first-party platforms in pre-release mode until after AoC?</p>



<a name="483802339"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Help%20upgrade/test%20purity%20inference/near/483802339" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jan kili <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Help.20upgrade.2Ftest.20purity.20inference.html#483802339">(Nov 21 2024 at 22:43)</a>:</h4>
<p>If not, then the tutorial and documentation seem unready to assist newcomers with that, conceptually or snippetly. <a href="https://www.roc-lang.org/tutorial#tasks">https://www.roc-lang.org/tutorial#tasks</a></p>



<a name="483803223"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Help%20upgrade/test%20purity%20inference/near/483803223" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jan kili <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Help.20upgrade.2Ftest.20purity.20inference.html#483803223">(Nov 21 2024 at 22:50)</a>:</h4>
<p>Basically, I'm expecting someone to announce a month-long AoC freeze on breaking changes to @roc-lang, for UX.</p>



<a name="483803483"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Help%20upgrade/test%20purity%20inference/near/483803483" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Help.20upgrade.2Ftest.20purity.20inference.html#483803483">(Nov 21 2024 at 22:52)</a>:</h4>
<p>I'm hoping we can switch over to the release management process we've discuss/agreed on</p>
<p><a href="#narrow/channel/304641-ideas/topic/roc.20release.20management/near/478608428">https://roc.zulipchat.com/#narrow/channel/304641-ideas/topic/roc.20release.20management/near/478608428</a></p>
<p>Basically, we can make breaking changes to roc but the supported platforms and recommended version for everything stays stable/relibable.</p>



<a name="483828161"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Help%20upgrade/test%20purity%20inference/near/483828161" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Help.20upgrade.2Ftest.20purity.20inference.html#483828161">(Nov 22 2024 at 03:08)</a>:</h4>
<p>Does anyone want to have a crack at updating the Tutorial for purity inference? Not a major uplift, just removing Task</p>



<a name="483843580"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Help%20upgrade/test%20purity%20inference/near/483843580" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jan kili <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Help.20upgrade.2Ftest.20purity.20inference.html#483843580">(Nov 22 2024 at 06:13)</a>:</h4>
<p>Shouldn't such an update also add explainers for <code>!</code>, <code>=&gt;</code>, and <code>try</code>?</p>



<a name="483844166"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Help%20upgrade/test%20purity%20inference/near/483844166" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Help.20upgrade.2Ftest.20purity.20inference.html#483844166">(Nov 22 2024 at 06:20)</a>:</h4>
<p>Sounds like you're halfway there <span class="user-mention" data-user-id="462053">@JanCVanB</span> <span aria-label="grinning face with smiling eyes" class="emoji emoji-1f601" role="img" title="grinning face with smiling eyes">:grinning_face_with_smiling_eyes:</span></p>



<a name="483844348"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Help%20upgrade/test%20purity%20inference/near/483844348" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jan kili <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Help.20upgrade.2Ftest.20purity.20inference.html#483844348">(Nov 22 2024 at 06:22)</a>:</h4>
<p>Hehe but I still don't fully understand where Tasks went so I'm hesitant to explain anything!</p>



<a name="483844438"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Help%20upgrade/test%20purity%20inference/near/483844438" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jan kili <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Help.20upgrade.2Ftest.20purity.20inference.html#483844438">(Nov 22 2024 at 06:23)</a>:</h4>
<p>(Side note, the tutorial and linked examples still use <code>?</code>, which seems maybe deprecated/removed?)</p>



<a name="483844669"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Help%20upgrade/test%20purity%20inference/near/483844669" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jan kili <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Help.20upgrade.2Ftest.20purity.20inference.html#483844669">(Nov 22 2024 at 06:26)</a>:</h4>
<p>I'm happy to give it a try tomorrow, partly as an exercise in outlining my own confusions!</p>



<a name="483844899"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Help%20upgrade/test%20purity%20inference/near/483844899" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jan kili <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Help.20upgrade.2Ftest.20purity.20inference.html#483844899">(Nov 22 2024 at 06:28)</a>:</h4>
<p>With such inspiring sentences as "I infer that <code>try</code> bubbles any downstream <code>Err</code> tags up all the way to the platform, though you can no longer see the tags in function signature types... hmm that doesn't seem right..."</p>
<p>Edit: yay I'm wrong on the "no longer see" part</p>



<a name="483844903"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Help%20upgrade/test%20purity%20inference/near/483844903" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Help.20upgrade.2Ftest.20purity.20inference.html#483844903">(Nov 22 2024 at 06:28)</a>:</h4>
<p>Getting started is the hard part <span aria-label="smiley" class="emoji emoji-1f603" role="img" title="smiley">:smiley:</span> I'm sure we can help to find the right words. It would be very helpful to sit back and think about the new things (syntax etc) and map out what is missing or needs adding. </p>
<p>I'm not thinking we should add/update everything, but we could do a pass or two and polish it a little so newcomers can still follow along and have a good experience.</p>



<a name="483845534"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Help%20upgrade/test%20purity%20inference/near/483845534" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jan kili <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Help.20upgrade.2Ftest.20purity.20inference.html#483845534">(Nov 22 2024 at 06:35)</a>:</h4>
<p>As a returning user, I'm concerned that in the last month or two Roc has frontloaded its complexity (slightly steepened its learning curve to greatly improve code readability) without yet paying the cost in documentation or newcomer pushback... right before AoC.</p>



<a name="483845834"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Help%20upgrade/test%20purity%20inference/near/483845834" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Help.20upgrade.2Ftest.20purity.20inference.html#483845834">(Nov 22 2024 at 06:38)</a>:</h4>
<p><span class="user-mention silent" data-user-id="462053">JanCVanB</span> <a href="#narrow/stream/316715-contributing/topic/Help.20upgrade.2Ftest.20purity.20inference/near/483844348">said</a>:</p>
<blockquote>
<p>Hehe but I still don't fully understand where Tasks went so I'm hesitant to explain anything!</p>
</blockquote>
<p>Tasks are still functional, we just decide whether to use the old style of Tasks or the new style of purity inference based on the following three rules:</p>
<ul>
<li>if the platform requires something with an exclam at the end</li>
<li>if an hosted module exposes something with an exclam</li>
<li>if the module is builtin</li>
</ul>
<p><a href="https://github.com/roc-lang/roc/blob/22423ca98bef41e2f55ae54e11c632bd0610c241/crates/compiler/load_internal/src/file.rs#L2262">https://github.com/roc-lang/roc/blob/22423ca98bef41e2f55ae54e11c632bd0610c241/crates/compiler/load_internal/src/file.rs#L2262</a></p>



<a name="483845919"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Help%20upgrade/test%20purity%20inference/near/483845919" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Help.20upgrade.2Ftest.20purity.20inference.html#483845919">(Nov 22 2024 at 06:39)</a>:</h4>
<p>? is still present, but will be removed at least for now, since it desugars with <code>Result.try</code> instead of the <code>try</code> keyword with early returns</p>



<a name="483845990"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Help%20upgrade/test%20purity%20inference/near/483845990" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Help.20upgrade.2Ftest.20purity.20inference.html#483845990">(Nov 22 2024 at 06:40)</a>:</h4>
<p>So it's still in the language, but in a month or so it's probably gone. Basically, whenever we remove tasks</p>



<a name="483846148"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Help%20upgrade/test%20purity%20inference/near/483846148" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jan kili <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Help.20upgrade.2Ftest.20purity.20inference.html#483846148">(Nov 22 2024 at 06:42)</a>:</h4>
<p>True, but if in the next week we ensure that every AoC-friendly platform requires <code>main!</code>, then to a newcomer the concept of tasks is fully implicit and the tutorial should never capitalize the word.</p>



<a name="483846150"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Help%20upgrade/test%20purity%20inference/near/483846150" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Help.20upgrade.2Ftest.20purity.20inference.html#483846150">(Nov 22 2024 at 06:42)</a>:</h4>
<p>The <code>try</code> keyword is much simpler to understand now IMO, since it just does what Rust does. it desugars to</p>
<div class="codehilite" data-code-language="Elm"><pre><span></span><code><span class="nv">when</span><span class="w"> </span><span class="nv">thingYouTried</span><span class="w"> </span><span class="nv">and</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">args</span><span class="w"> </span><span class="nv">is</span>
<span class="w">    </span><span class="kt">Ok</span><span class="w"> </span><span class="nv">val</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="nv">val</span>
<span class="w">    </span><span class="kt">Err</span><span class="w"> </span><span class="nv">err</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">        </span><span class="nv">return</span><span class="w"> </span><span class="kt">Err</span><span class="w"> </span><span class="nv">err</span>
</code></pre></div>



<a name="483846261"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Help%20upgrade/test%20purity%20inference/near/483846261" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Help.20upgrade.2Ftest.20purity.20inference.html#483846261">(Nov 22 2024 at 06:43)</a>:</h4>
<p>I can't think of a reason the word Task, uppercase or lowercase, should be preserved at all in the tutorial. Though I'm open to being wrong</p>



<a name="483846342"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Help%20upgrade/test%20purity%20inference/near/483846342" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jan kili <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Help.20upgrade.2Ftest.20purity.20inference.html#483846342">(Nov 22 2024 at 06:44)</a>:</h4>
<p>In that example, does the type of <code>err</code> appear in the <code>try</code>ing function's type signature?</p>



<a name="483846380"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Help%20upgrade/test%20purity%20inference/near/483846380" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Help.20upgrade.2Ftest.20purity.20inference.html#483846380">(Nov 22 2024 at 06:44)</a>:</h4>
<p>Yes</p>



<a name="483846531"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Help%20upgrade/test%20purity%20inference/near/483846531" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jan kili <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Help.20upgrade.2Ftest.20purity.20inference.html#483846531">(Nov 22 2024 at 06:46)</a>:</h4>
<p>I may be being overly pessimistic (or exhibiting an "old dog new tricks" stiffness). Also, AoC is both an opportunity for adoption and an opportunity for constructive feedback on Roc's recent choices.</p>



<a name="483846678"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Help%20upgrade/test%20purity%20inference/near/483846678" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Help.20upgrade.2Ftest.20purity.20inference.html#483846678">(Nov 22 2024 at 06:47)</a>:</h4>
<p>So for example</p>
<div class="codehilite" data-code-language="Elm"><pre><span></span><code><span class="nv">parseThenDoubleAndPrint</span><span class="err">!</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nf">\</span><span class="nv">strNum</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">    </span><span class="nv">num</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nv">try</span><span class="w"> </span><span class="kt">Str</span><span class="nf">.</span><span class="nv">toU64</span><span class="w"> </span><span class="nv">strNum</span>
<span class="w">    </span><span class="nv">doubled</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nv">num</span><span class="w"> </span><span class="nf">*</span><span class="w"> </span><span class="mi">2</span>

<span class="w">    </span><span class="nv">try</span><span class="w"> </span><span class="kt">Stdout</span><span class="nf">.</span><span class="nv">line</span><span class="err">!</span><span class="w"> </span><span class="s">"$(Inspect.toStr doubled)"</span>

<span class="w">    </span><span class="kt">Ok</span><span class="w"> </span><span class="p">{}</span>
</code></pre></div>



<a name="483846769"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Help%20upgrade/test%20purity%20inference/near/483846769" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Help.20upgrade.2Ftest.20purity.20inference.html#483846769">(Nov 22 2024 at 06:48)</a>:</h4>
<p>Would infer type Str =&gt; Result {} [InvalidNumStr, StdoutErr _]</p>



<a name="483846985"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Help%20upgrade/test%20purity%20inference/near/483846985" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jan kili <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Help.20upgrade.2Ftest.20purity.20inference.html#483846985">(Nov 22 2024 at 06:50)</a>:</h4>
<p>Sweet! Like this? <a href="https://github.com/roc-lang/basic-cli/pull/257#discussion_r1853325645">https://github.com/roc-lang/basic-cli/pull/257#discussion_r1853325645</a> (comment on line 11)</p>



<a name="483847033"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Help%20upgrade/test%20purity%20inference/near/483847033" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jan kili <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Help.20upgrade.2Ftest.20purity.20inference.html#483847033">(Nov 22 2024 at 06:51)</a>:</h4>
<p>In other words, jinx, cause I forgot to hit submit on the PR review until now.</p>



<a name="483849824"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Help%20upgrade/test%20purity%20inference/near/483849824" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Help.20upgrade.2Ftest.20purity.20inference.html#483849824">(Nov 22 2024 at 07:16)</a>:</h4>
<p>Yes, but replace the a with the actual error type</p>



<a name="483931536"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Help%20upgrade/test%20purity%20inference/near/483931536" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Help.20upgrade.2Ftest.20purity.20inference.html#483931536">(Nov 22 2024 at 15:13)</a>:</h4>
<p>Also, though task still exists, it is deprecated and will be removed once purity inference is fully working and things are updated.</p>



<a name="483991532"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Help%20upgrade/test%20purity%20inference/near/483991532" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jan kili <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Help.20upgrade.2Ftest.20purity.20inference.html#483991532">(Nov 22 2024 at 21:07)</a>:</h4>
<p>Just a tracking issue for my in-progress tutorial work: <a href="https://github.com/roc-lang/roc/issues/7242">https://github.com/roc-lang/roc/issues/7242</a></p>



<a name="484085983"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Help%20upgrade/test%20purity%20inference/near/484085983" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Help.20upgrade.2Ftest.20purity.20inference.html#484085983">(Nov 23 2024 at 18:35)</a>:</h4>
<p>found a bug</p>



<a name="484085999"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Help%20upgrade/test%20purity%20inference/near/484085999" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Help.20upgrade.2Ftest.20purity.20inference.html#484085999">(Nov 23 2024 at 18:35)</a>:</h4>
<p>If a platform exposes a function like <code>respond!</code> and the implementation in the app uses no effects, it generates a warning</p>



<a name="484086019"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Help%20upgrade/test%20purity%20inference/near/484086019" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Help.20upgrade.2Ftest.20purity.20inference.html#484086019">(Nov 23 2024 at 18:35)</a>:</h4>
<p>It is valid for the app to implement <code>respond!</code> with a simple static response that uses no effects</p>



<a name="484086080"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Help%20upgrade/test%20purity%20inference/near/484086080" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Help.20upgrade.2Ftest.20purity.20inference.html#484086080">(Nov 23 2024 at 18:36)</a>:</h4>
<p>So we should not check the <code>!</code> effectfulness over the platform to app boundary</p>



<a name="484086133"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Help%20upgrade/test%20purity%20inference/near/484086133" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Help.20upgrade.2Ftest.20purity.20inference.html#484086133">(Nov 23 2024 at 18:37)</a>:</h4>
<p>Yeah, I noticed that as well. We could add a constraint to all top-level defs to allow them to be effectful without an effectful body?</p>



<a name="484086158"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Help%20upgrade/test%20purity%20inference/near/484086158" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Help.20upgrade.2Ftest.20purity.20inference.html#484086158">(Nov 23 2024 at 18:37)</a>:</h4>
<p>I think it would be best if we make a special exception just for the platform</p>



<a name="484086163"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Help%20upgrade/test%20purity%20inference/near/484086163" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Help.20upgrade.2Ftest.20purity.20inference.html#484086163">(Nov 23 2024 at 18:38)</a>:</h4>
<p>Other locations this shouldn't happen</p>



<a name="484086230"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Help%20upgrade/test%20purity%20inference/near/484086230" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Agus Zubiaga <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Help.20upgrade.2Ftest.20purity.20inference.html#484086230">(Nov 23 2024 at 18:38)</a>:</h4>
<p>Yeah, good catch. It should definitely be only for functions provided to the platform.</p>



<a name="484086373"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Help%20upgrade/test%20purity%20inference/near/484086373" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Agus Zubiaga <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Help.20upgrade.2Ftest.20purity.20inference.html#484086373">(Nov 23 2024 at 18:40)</a>:</h4>
<p>Top-level defs are the main motivation for this warning since those are the functions you can call from far away. Disabling it for all of them would kind of defeat the purpose.</p>



<a name="484087101"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Help%20upgrade/test%20purity%20inference/near/484087101" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Help.20upgrade.2Ftest.20purity.20inference.html#484087101">(Nov 23 2024 at 18:52)</a>:</h4>
<p>Yeah, I think it should just be an exception for the functions specified in the provides.</p>



<a name="484088401"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Help%20upgrade/test%20purity%20inference/near/484088401" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Agus Zubiaga <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Help.20upgrade.2Ftest.20purity.20inference.html#484088401">(Nov 23 2024 at 19:10)</a>:</h4>
<p>I’ll look into it tonight</p>



<a name="484765615"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Help%20upgrade/test%20purity%20inference/near/484765615" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Agus Zubiaga <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Help.20upgrade.2Ftest.20purity.20inference.html#484765615">(Nov 27 2024 at 17:10)</a>:</h4>
<p>Fixed in <a href="https://github.com/roc-lang/roc/pull/7254">#7254</a></p>



<a name="485173617"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Help%20upgrade/test%20purity%20inference/near/485173617" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jan kili <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Help.20upgrade.2Ftest.20purity.20inference.html#485173617">(Nov 29 2024 at 23:46)</a>:</h4>
<p>Should <a href="https://github.com/roc-lang/examples/blob/main/examples/Results/main.roc">this file of Result parsing/trying examples</a> (linked from the tutorial) include versions using the new <code>try</code> keyword?<br>
CC <span class="user-mention" data-user-id="361169">@Anton</span> <span class="user-mention" data-user-id="734214">@Aurélien Geron</span></p>



<a name="485174805"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Help%20upgrade/test%20purity%20inference/near/485174805" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Help.20upgrade.2Ftest.20purity.20inference.html#485174805">(Nov 30 2024 at 00:03)</a>:</h4>
<p>Yes - that would be good <span aria-label="thumbs up" class="emoji emoji-1f44d" role="img" title="thumbs up">:thumbs_up:</span></p>



<a name="485175273"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Help%20upgrade/test%20purity%20inference/near/485175273" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jan kili <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Help.20upgrade.2Ftest.20purity.20inference.html#485175273">(Nov 30 2024 at 00:10)</a>:</h4>
<p>Tutorial PR mostly finished - final additions coming tomorrow, ready for primary feedback whenever, hoping to merge tomorrow<br>
<a href="https://github.com/roc-lang/roc/pull/7274">https://github.com/roc-lang/roc/pull/7274</a><br>
(TODO: purity inference previews, Result examples file additions)</p>



<a name="485213330"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Help%20upgrade/test%20purity%20inference/near/485213330" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aurélien Geron <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Help.20upgrade.2Ftest.20purity.20inference.html#485213330">(Nov 30 2024 at 10:00)</a>:</h4>
<p><span class="user-mention silent" data-user-id="462053">JanCVanB</span> <a href="#narrow/stream/316715-contributing/topic/Help.20upgrade.2Ftest.20purity.20inference/near/485173617">said</a>:</p>
<blockquote>
<p>Should <a href="https://github.com/roc-lang/examples/blob/main/examples/Results/main.roc">this file of Result parsing/trying examples</a> (linked from the tutorial) include versions using the new <code>try</code> keyword?<br>
CC <span class="user-mention silent" data-user-id="361169">Anton</span> <span class="user-mention silent" data-user-id="734214">Aurélien Geron</span></p>
</blockquote>
<p>Thanks for the heads up. I'm on vacation without my laptop, I'll be back home on Thursday. If it can wait until then, I'm happy to update the example. <span aria-label="+1" class="emoji emoji-1f44d" role="img" title="+1">:+1:</span></p>



<hr><p>Last updated: Nov 01 2025 at 12:13 UTC</p>
</html>