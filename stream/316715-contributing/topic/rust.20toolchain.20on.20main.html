<html>
<head><meta charset="utf-8"><title>rust toolchain on main · contributing · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/index.html">contributing</a></h2>
<h3>Topic: <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/rust.20toolchain.20on.20main.html">rust toolchain on main</a></h3>

<hr>

<base href="https://roc.zulipchat.com">

<head><link href="https://roc-lang.github.io/zulip-export/style.css" rel="stylesheet"></head>

<a name="345110349"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/rust%20toolchain%20on%20main/near/345110349" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/rust.20toolchain.20on.20main.html#345110349">(Mar 28 2023 at 12:06)</a>:</h4>
<p>Hi! Which rust toolchain should I use to run builds and tests on main? After running tests in <code>nix develop</code>first I got error about this-error crate using nightly feature <code>provide_any</code>, but after switching to nightly in <code>rust-toolchain.toml</code> I got another error in gen_llvm crate about <code>let ... else</code> statement being unstable. I tried adding the <code>#![feature(let_else)]</code> but I'm not sure where to put it.</p>



<a name="345112885"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/rust%20toolchain%20on%20main/near/345112885" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/rust.20toolchain.20on.20main.html#345112885">(Mar 28 2023 at 12:16)</a>:</h4>
<p>I suspect your rust version is old</p>



<a name="345113208"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/rust%20toolchain%20on%20main/near/345113208" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/rust.20toolchain.20on.20main.html#345113208">(Mar 28 2023 at 12:17)</a>:</h4>
<p>hmm actually, maybe the compiler rust version is old? <span class="user-mention" data-user-id="361169">@Anton</span> the toolchain toml says it's 1.65 still. rust is on 1.68 at this point. maybe we can upgrade again?</p>



<a name="345113658"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/rust%20toolchain%20on%20main/near/345113658" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/rust.20toolchain.20on.20main.html#345113658">(Mar 28 2023 at 12:18)</a>:</h4>
<p>to anwer the question: the roc compiler uses the stable toolchain</p>



<a name="345113744"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/rust%20toolchain%20on%20main/near/345113744" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/rust.20toolchain.20on.20main.html#345113744">(Mar 28 2023 at 12:19)</a>:</h4>
<p>and based on the <code>rust-toolchain.toml</code> it uses rust 1.65</p>



<a name="345113786"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/rust%20toolchain%20on%20main/near/345113786" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/rust.20toolchain.20on.20main.html#345113786">(Mar 28 2023 at 12:19)</a>:</h4>
<p>you can run e.g. <code>cargo --version</code> to see which version you actually have</p>



<a name="345113901"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/rust%20toolchain%20on%20main/near/345113901" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/rust.20toolchain.20on.20main.html#345113901">(Mar 28 2023 at 12:19)</a>:</h4>
<p>I'll make a note to upgrade.<br>
But with nix you can basically not use the wrong rust version, so I think something is off</p>



<a name="345114201"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/rust%20toolchain%20on%20main/near/345114201" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/rust.20toolchain.20on.20main.html#345114201">(Mar 28 2023 at 12:20)</a>:</h4>
<p>well based on the errors, the compiler used is too old for the code that it is compiling</p>



<a name="345114224"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/rust%20toolchain%20on%20main/near/345114224" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/rust.20toolchain.20on.20main.html#345114224">(Mar 28 2023 at 12:20)</a>:</h4>
<p><span class="user-mention" data-user-id="524729">@ziutech</span> can you tell me what OS you are on and the sequence of commands you executed?</p>



<a name="345114418"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/rust%20toolchain%20on%20main/near/345114418" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/rust.20toolchain.20on.20main.html#345114418">(Mar 28 2023 at 12:21)</a>:</h4>
<p>Are you using the main branch without any changes?</p>



<a name="345115393"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/rust%20toolchain%20on%20main/near/345115393" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/rust.20toolchain.20on.20main.html#345115393">(Mar 28 2023 at 12:25)</a>:</h4>
<p>I'm on linux<br>
I'm directly on main, without any changes<br>
I updated my fork, pulled changes, then run <code>nix develop</code> and <code>cargo run</code></p>



<a name="345115896"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/rust%20toolchain%20on%20main/near/345115896" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/rust.20toolchain.20on.20main.html#345115896">(Mar 28 2023 at 12:27)</a>:</h4>
<p>While in a nix shell (=after having executed <code>nix develop</code>), can you do a <code>cargo clean</code>, followed by <code>cargo run repl</code>?</p>



<a name="345116046"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/rust%20toolchain%20on%20main/near/345116046" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/rust.20toolchain.20on.20main.html#345116046">(Mar 28 2023 at 12:27)</a>:</h4>
<p>I suspect that you have some rust crates in play from once executing cargo without nix.</p>



<a name="345118077"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/rust%20toolchain%20on%20main/near/345118077" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/rust.20toolchain.20on.20main.html#345118077">(Mar 28 2023 at 12:35)</a>:</h4>
<p>Okay, now everything works, thank you</p>



<a name="345120457"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/rust%20toolchain%20on%20main/near/345120457" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/rust.20toolchain.20on.20main.html#345120457">(Mar 28 2023 at 12:44)</a>:</h4>
<p>Several people have encountered this issue. I wonder if we could alias cargo in the flake to quickly inspect some metadata before running so that we can provide a nice error message when crates compiled outside of nix are detected <span aria-label="thinking" class="emoji emoji-1f914" role="img" title="thinking">:thinking:</span></p>



<hr><p>Last updated: Mar 01 2026 at 12:20 UTC</p>
</html>