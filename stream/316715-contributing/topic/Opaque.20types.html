<html>
<head><meta charset="utf-8"><title>Opaque types · contributing · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/index.html">contributing</a></h2>
<h3>Topic: <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Opaque.20types.html">Opaque types</a></h3>

<hr>

<base href="https://roc.zulipchat.com">

<head><link href="https://roc-lang.github.io/zulip-export/style.css" rel="stylesheet"></head>

<a name="273424951"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Opaque%20types/near/273424951" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ayaz Hafiz <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Opaque.20types.html#273424951">(Feb 27 2022 at 21:01)</a>:</h4>
<p>We just landed <a href="https://github.com/rtfeldman/roc/issues/2214">opaque types</a> in the language and need help migrating uses of  <a href="https://github.com/rtfeldman/roc/blob/trunk/roc-for-elm-programmers.md#opaque-types">private tags</a> to these new opaque types! If you'd like to help out, please see <a href="https://github.com/rtfeldman/roc/issues/2584">https://github.com/rtfeldman/roc/issues/2584</a> and feel free to follow up in this thread!</p>



<a name="273425605"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Opaque%20types/near/273425605" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Philippe <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Opaque.20types.html#273425605">(Feb 27 2022 at 21:16)</a>:</h4>
<p>Hi,</p>
<p>Happy to give a hand</p>



<a name="273425704"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Opaque%20types/near/273425704" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Carlo Munguia <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Opaque.20types.html#273425704">(Feb 27 2022 at 21:19)</a>:</h4>
<p>Happy to work on this as well</p>



<a name="273426131"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Opaque%20types/near/273426131" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Philippe <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Opaque.20types.html#273426131">(Feb 27 2022 at 21:28)</a>:</h4>
<p><span class="user-mention" data-user-id="478882">@Carlo Munguia</span> about to go to bed and then I have work tomorrow... Won't be able to make any progress before tomorrow evening (18 UTC).</p>
<p>Feel free to take lead</p>



<a name="273447927"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Opaque%20types/near/273447927" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bastian Beuttel <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Opaque.20types.html#273447927">(Feb 28 2022 at 05:33)</a>:</h4>
<p>I might be able to look into some aspects of it later this week / next week. Very busy at them moment and not yet confident at all in the codebase.<br>
Will check in then and see if there’s still stuff to do on this.</p>



<a name="273462206"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Opaque%20types/near/273462206" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Loric Brevet <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Opaque.20types.html#273462206">(Feb 28 2022 at 09:13)</a>:</h4>
<p>Hey, I’d be happy to help with this. Which of the subtasks do you think could be a good start for a first dig into the codebase <span class="user-mention" data-user-id="454654">@Ayaz Hafiz</span>?</p>



<a name="273493450"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Opaque%20types/near/273493450" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ayaz Hafiz <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Opaque.20types.html#273493450">(Feb 28 2022 at 14:07)</a>:</h4>
<p>They need to be done roughly in order, so the first one. The first will also show you roughly how the code base is organized.</p>



<a name="273538636"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Opaque%20types/near/273538636" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Philippe <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Opaque.20types.html#273538636">(Feb 28 2022 at 19:10)</a>:</h4>
<p>Currently looking at ^^<br>
But I am having issues finding private tags</p>
<p>When I search the project for <code>@</code> I see a lot of results<br>
When I look for <code>private</code> I see a few different constucts<br>
Overall, I am just unsure where to start</p>
<p>Anyone would have a clue<br>
Possibly the name of a test to fix</p>



<a name="273539379"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Opaque%20types/near/273539379" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Philippe <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Opaque.20types.html#273539379">(Feb 28 2022 at 19:16)</a>:</h4>
<p>Ok, one test fixed, N to go :)</p>



<a name="273540674"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Opaque%20types/near/273540674" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Philippe <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Opaque.20types.html#273540674">(Feb 28 2022 at 19:26)</a>:</h4>
<p>Also, I see "opaque type" and "opaque reference"<br>
What would the difference be?</p>



<a name="273541849"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Opaque%20types/near/273541849" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Carroll <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Opaque.20types.html#273541849">(Feb 28 2022 at 19:34)</a>:</h4>
<p>Can you give some more context about where you saw "opaque reference"?</p>



<a name="273543030"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Opaque%20types/near/273543030" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Philippe <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Opaque.20types.html#273543030">(Feb 28 2022 at 19:43)</a>:</h4>
<p>An error message, will grab the test name</p>



<a name="273543361"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Opaque%20types/near/273543361" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Philippe <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Opaque.20types.html#273543361">(Feb 28 2022 at 19:45)</a>:</h4>
<p>qualified_private_tag</p>
<p>When I change the @Foo.Bar to $Foo.Bar<br>
The <code>SYNTAX PROBLEM</code> becomes "Looks like an opaque reference is treated like a module name."</p>



<a name="273544243"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Opaque%20types/near/273544243" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Carroll <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Opaque.20types.html#273544243">(Feb 28 2022 at 19:52)</a>:</h4>
<p>OK so it means a reference to an opaque type. As in, referring to it by name.</p>



<a name="273544683"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Opaque%20types/near/273544683" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Carroll <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Opaque.20types.html#273544683">(Feb 28 2022 at 19:55)</a>:</h4>
<p>You asked about the difference. The opaque type is the type itself. The "opaque reference" is a particular place in the code where it is used.</p>



<a name="273565252"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Opaque%20types/near/273565252" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Philippe <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Opaque.20types.html#273565252">(Feb 28 2022 at 22:44)</a>:</h4>
<p>I have updated all tests didn't require any additional changes<br>
Those that remain, grep <code>@[A-Za-z]</code>, are comments or throw errors that don't seem to be right</p>
<p>Could someone nudge me in the right direction?<br>
<a href="https://github.com/rtfeldman/roc/pull/2614">https://github.com/rtfeldman/roc/pull/2614</a></p>



<a name="273600776"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Opaque%20types/near/273600776" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Opaque.20types.html#273600776">(Mar 01 2022 at 07:40)</a>:</h4>
<p>I'll fix the error in <code>constrain::test_constrain::constrain_private_tag</code>.</p>



<a name="273615291"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Opaque%20types/near/273615291" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Opaque.20types.html#273615291">(Mar 01 2022 at 10:00)</a>:</h4>
<p>Should <code>TagName</code> in <code>compiler/module/src/ident.rs</code> be updated as well? It still has a <code>Private(Symbol)</code> variant.</p>



<a name="274588941"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Opaque%20types/near/274588941" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Opaque.20types.html#274588941">(Mar 08 2022 at 19:00)</a>:</h4>
<p>For opaque types, why doesn't this work?</p>
<div class="codehilite" data-code-language="CoffeeScript"><pre><span></span><code><span class="nx">Age</span> <span class="o">:=</span> <span class="nx">U64</span>

<span class="nv">test : </span><span class="p">{}</span> <span class="nf">-&gt;</span> <span class="nx">Age</span>
<span class="nv">test = </span><span class="err">\</span><span class="p">{}</span> <span class="nf">-&gt;</span> <span class="nx">@Age</span> <span class="mi">42</span>
</code></pre></div>
<p>The returned error is:</p>
<div class="codehilite"><pre><span></span><code>Something is off with the body of the test definition:

17│  test : {} -&gt; Age
18│  test = \{} -&gt; @Age 42
                   ^^^^^^^

This @Age private tag application has the type:

    [ @Age (Num a) ]b

But the type annotation on test says it should be:

    Age
</code></pre></div>
<p>Is it a bug? I feel like the types should check here.</p>



<a name="274590632"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Opaque%20types/near/274590632" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ayaz Hafiz <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Opaque.20types.html#274590632">(Mar 08 2022 at 19:10)</a>:</h4>
<p>Because we haven’t flipped them to use @ yet since we still have private tags :)</p>



<a name="274590656"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Opaque%20types/near/274590656" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ayaz Hafiz <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Opaque.20types.html#274590656">(Mar 08 2022 at 19:10)</a>:</h4>
<p>$Age instead of @Age should work</p>



<a name="274591002"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Opaque%20types/near/274591002" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Opaque.20types.html#274591002">(Mar 08 2022 at 19:12)</a>:</h4>
<p>Thanks</p>



<a name="274591249"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Opaque%20types/near/274591249" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ayaz Hafiz <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Opaque.20types.html#274591249">(Mar 08 2022 at 19:14)</a>:</h4>
<p>for sure. let us know if you do see any bugs. i don’t think there should be many but i’m sure i missed something</p>



<a name="278408500"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Opaque%20types/near/278408500" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Carlo Munguia <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Opaque.20types.html#278408500">(Apr 09 2022 at 12:47)</a>:</h4>
<p>My apologies on super delay on this work  - my windows laptop died an unhappy death but has since been replaced - I can now resume any Roc work</p>



<hr><p>Last updated: Nov 01 2025 at 12:13 UTC</p>
</html>