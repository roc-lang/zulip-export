<html>
<head><meta charset="utf-8"><title>Zed extension: roc tree sitter build error · contributing · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/index.html">contributing</a></h2>
<h3>Topic: <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Zed.20extension.3A.20roc.20tree.20sitter.20build.20error.html">Zed extension: roc tree sitter build error</a></h3>

<hr>

<base href="https://roc.zulipchat.com">

<head><link href="https://roc-lang.github.io/zulip-export/style.css" rel="stylesheet"></head>

<a name="435887629"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Zed%20extension%3A%20roc%20tree%20sitter%20build%20error/near/435887629" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alf Richter <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Zed.20extension.3A.20roc.20tree.20sitter.20build.20error.html#435887629">(Apr 28 2024 at 16:09)</a>:</h4>
<p><span class="user-mention" data-user-id="651372">@Eli Dowling</span> the Zed Extensions CI gives following error:<br>
<a href="/user_uploads/22008/9QChQ8_oykGz3L2tb4rhOrbz/image.png">image.png</a><br>
<a href="https://github.com/zed-industries/extensions/actions/runs/8860237363/job/24335434614">https://github.com/zed-industries/extensions/actions/runs/8860237363/job/24335434614</a></p>
<div class="message_inline_image"><a href="/user_uploads/22008/9QChQ8_oykGz3L2tb4rhOrbz/image.png" title="image.png"><img src="/user_uploads/22008/9QChQ8_oykGz3L2tb4rhOrbz/image.png"></a></div>



<a name="435914057"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Zed%20extension%3A%20roc%20tree%20sitter%20build%20error/near/435914057" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eli Dowling <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Zed.20extension.3A.20roc.20tree.20sitter.20build.20error.html#435914057">(Apr 28 2024 at 22:28)</a>:</h4>
<p>Okay, so that's going to be because just like helix and neovim zed supports it's own specific selection of tree sitter queries. The default ones inside the tree-sitter-roc repo are from Helix and I imagine zed probably matches that closely but we'll have to either find documentation for the queries that z supports or just go by trial and error removing the ones that don't work for now</p>



<a name="435914072"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Zed%20extension%3A%20roc%20tree%20sitter%20build%20error/near/435914072" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eli Dowling <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Zed.20extension.3A.20roc.20tree.20sitter.20build.20error.html#435914072">(Apr 28 2024 at 22:28)</a>:</h4>
<p>I'd love to help you but unfortunately zed it's completely borked on Linux for me :(</p>



<a name="435914910"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Zed%20extension%3A%20roc%20tree%20sitter%20build%20error/near/435914910" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alf Richter <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Zed.20extension.3A.20roc.20tree.20sitter.20build.20error.html#435914910">(Apr 28 2024 at 22:42)</a>:</h4>
<p>We could try to run their CI scripts inside of the your tree sitter or the my zed-roc repo, so we would at least get the errors step by step.</p>



<a name="435915355"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Zed%20extension%3A%20roc%20tree%20sitter%20build%20error/near/435915355" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eli Dowling <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Zed.20extension.3A.20roc.20tree.20sitter.20build.20error.html#435915355">(Apr 28 2024 at 22:48)</a>:</h4>
<p>You get the errors when you load the plugin in zed if you run zed from the CLI</p>



<a name="435915375"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Zed%20extension%3A%20roc%20tree%20sitter%20build%20error/near/435915375" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eli Dowling <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Zed.20extension.3A.20roc.20tree.20sitter.20build.20error.html#435915375">(Apr 28 2024 at 22:48)</a>:</h4>
<p>I was able to get that far on my Linux setup</p>



<a name="435915377"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Zed%20extension%3A%20roc%20tree%20sitter%20build%20error/near/435915377" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eli Dowling <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Zed.20extension.3A.20roc.20tree.20sitter.20build.20error.html#435915377">(Apr 28 2024 at 22:48)</a>:</h4>
<p>I was able to get that far on my Linux setup test</p>



<a name="436211817"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Zed%20extension%3A%20roc%20tree%20sitter%20build%20error/near/436211817" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alf Richter <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Zed.20extension.3A.20roc.20tree.20sitter.20build.20error.html#436211817">(Apr 30 2024 at 07:29)</a>:</h4>
<p><span class="user-mention" data-user-id="651372">@Eli Dowling</span>: I have  build the zed extension cli tool locally on my ARM Mac, they are using the tool in the CI Build. It’s included as create in the main zed.git, but only published for x86 Linux. I’ll try to detect the problematic queries and mark these, bc. I have no clue about tree sitter and queries atm. :)</p>



<a name="436277819"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Zed%20extension%3A%20roc%20tree%20sitter%20build%20error/near/436277819" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> dwyd <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Zed.20extension.3A.20roc.20tree.20sitter.20build.20error.html#436277819">(Apr 30 2024 at 13:57)</a>:</h4>
<p>Commenting out the following lines got it "working" for me on arm mac.</p>
<div class="codehilite"><pre><span></span><code># highlights.scm
(backpassing_expr assignee: (identifier_pattern (identifier) @parameter.definition))
;----function invocations ----
(function_call_expr
  caller:  (variable_expr
      (identifier)@function))

(function_call_expr
  caller: (field_access_expr (identifier)@function .))

; pattern captures
(when_is_branch pattern: (_ (identifier_pattern (identifier) @variable.parameter)))

# indents.scm
;;It&#39;s annoying when pipelines automatically dedent this pervents that
(expr_body
    result: (bin_op_expr)
)@extend

;this automatically dedents, this may be more annying than helpful when writing pipelines
(expr_body
    result: (_)
) @extend.prevent-once

# injections.scm
;injection from piping function calls
(bin_op_expr
part: (const
    [(multiline_string)(string)] @injection.content)
part: (operator)
part: (variable_expr
  (identifier)@injection.language))
</code></pre></div>
<p>Logs all displayed the error message of <code>Impossible pattern</code></p>
<div class="codehilite"><pre><span></span><code># example
Error loading highlights query

Caused by:
    Query error at 143:19. Impossible pattern:
    (backpassing_expr assignee: (identifier_pattern (identifier) @parameter.definition))
</code></pre></div>



<a name="436366459"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Zed%20extension%3A%20roc%20tree%20sitter%20build%20error/near/436366459" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eli Dowling <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Zed.20extension.3A.20roc.20tree.20sitter.20build.20error.html#436366459">(Apr 30 2024 at 22:53)</a>:</h4>
<p>Lovely! I'll look into this when I get some time :)</p>



<a name="436461163"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Zed%20extension%3A%20roc%20tree%20sitter%20build%20error/near/436461163" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eli Dowling <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Zed.20extension.3A.20roc.20tree.20sitter.20build.20error.html#436461163">(May 01 2024 at 07:15)</a>:</h4>
<p>Okay I think this is now a fixed issue I updated my version of zed and it's working fine. It seems like at some point zed didn't support part of the query syntax and now it does. Using <span class="user-mention" data-user-id="485505">@Alf Richter</span>'s extension worked well for me</p>



<a name="436538999"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Zed%20extension%3A%20roc%20tree%20sitter%20build%20error/near/436538999" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> dwyd <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Zed.20extension.3A.20roc.20tree.20sitter.20build.20error.html#436538999">(May 01 2024 at 17:08)</a>:</h4>
<p>Thank you both! Seems to be working for me too. Pulled down the latest changes and I don't see any  errors in the Zed log when rebuilding.</p>



<a name="436545755"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Zed%20extension%3A%20roc%20tree%20sitter%20build%20error/near/436545755" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alf Richter <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Zed.20extension.3A.20roc.20tree.20sitter.20build.20error.html#436545755">(May 01 2024 at 17:52)</a>:</h4>
<p>I've triggered a new build of my PR <br>
<a href="https://github.com/zed-industries/extensions/pull/432">https://github.com/zed-industries/extensions/pull/432</a><br>
If this CI/CD run is successful, then the roc extension should be installable as normal zed plugin.</p>



<a name="436549542"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Zed%20extension%3A%20roc%20tree%20sitter%20build%20error/near/436549542" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Zed.20extension.3A.20roc.20tree.20sitter.20build.20error.html#436549542">(May 01 2024 at 18:15)</a>:</h4>
<p>yeah I forgot to mention, this has been working well for me too!</p>



<hr><p>Last updated: Nov 01 2025 at 12:13 UTC</p>
</html>