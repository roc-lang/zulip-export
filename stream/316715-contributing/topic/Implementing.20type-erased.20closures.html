<html>
<head><meta charset="utf-8"><title>Implementing type-erased closures · contributing · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/index.html">contributing</a></h2>
<h3>Topic: <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Implementing.20type-erased.20closures.html">Implementing type-erased closures</a></h3>

<hr>

<base href="https://roc.zulipchat.com">

<head><link href="https://roc-lang.github.io/zulip-export/style.css" rel="stylesheet"></head>

<a name="375098728"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/316715-contributing/topic/Implementing%20type-erased%20closures/near/375098728" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ayaz Hafiz <a href="https://roc-lang.github.io/zulip-export/stream/316715-contributing/topic/Implementing.20type-erased.20closures.html#375098728">(Jul 14 2023 at 01:04)</a>:</h4>
<p>If anyone is interested, I have a well-scoped project that could use some help - compiling type-erased closures to WASM and dev compilation backends, and supporting their reference counting.</p>
<p>Most languages implement closures by "type erasure" of the values that they capture, hiding them away somewhere on the heap and loading them only when needed. Roc generally does not use this scheme, because it begets various useful optimizations. However, in some cases, type erasure of closures will be required in the future, and in other cases it is useful to have as an option.</p>
<p><a href="https://github.com/roc-lang/roc/pull/5576">https://github.com/roc-lang/roc/pull/5576</a> implements initial support for type-erased closures for the LLVM backend, but there are several things missing:</p>
<ul>
<li>Compilation to the WASM backend</li>
<li>Compilation to the machine-code dev backend</li>
<li>Injection of reference counting functions in the erased closure value representation</li>
<li>Support for erased closures in glue (more involved)</li>
</ul>
<p>With the exception of the last bullet, none of these require significant knowledge of the rest of the Roc compiler's implementation. I won't claim that these are easy, but they are small and well-scoped projects that you could sink into if you wanted to.</p>
<p>If anyone is interested, please follow up on this thread or DM me and I am happy to help you get started.</p>



<hr><p>Last updated: Nov 01 2025 at 12:13 UTC</p>
</html>