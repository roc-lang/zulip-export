<html>
<head><meta charset="utf-8"><title>draft article about ! syntax · show and tell · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://roc-lang.github.io/zulip-export/stream/304902-show-and-tell/index.html">show and tell</a></h2>
<h3>Topic: <a href="https://roc-lang.github.io/zulip-export/stream/304902-show-and-tell/topic/draft.20article.20about.20.21.20syntax.html">draft article about ! syntax</a></h3>

<hr>

<base href="https://roc.zulipchat.com">

<head><link href="https://roc-lang.github.io/zulip-export/style.css" rel="stylesheet"></head>

<a name="434558110"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/304902-show%20and%20tell/topic/draft%20article%20about%20%21%20syntax/near/434558110" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/304902-show-and-tell/topic/draft.20article.20about.20.21.20syntax.html#434558110">(Apr 21 2024 at 04:26)</a>:</h4>
<p>I wrote a draft of an article about the new <code>!</code> suffix - any feedback welcome! <a href="https://docs.google.com/document/d/1XKZEtOg5efJFnzXxwY2rPRE64H796lCrt7H_j0340P4/edit?usp=sharing">https://docs.google.com/document/d/1XKZEtOg5efJFnzXxwY2rPRE64H796lCrt7H_j0340P4/edit?usp=sharing</a></p>



<a name="434558144"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/304902-show%20and%20tell/topic/draft%20article%20about%20%21%20syntax/near/434558144" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/304902-show-and-tell/topic/draft.20article.20about.20.21.20syntax.html#434558144">(Apr 21 2024 at 04:27)</a>:</h4>
<p>as previously discussed, I plan to post this on a personal site rather than as any kind of official announcement on <a href="http://roc-lang.org">roc-lang.org</a></p>



<a name="434558714"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/304902-show%20and%20tell/topic/draft%20article%20about%20%21%20syntax/near/434558714" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Karl <a href="https://roc-lang.github.io/zulip-export/stream/304902-show-and-tell/topic/draft.20article.20about.20.21.20syntax.html#434558714">(Apr 21 2024 at 04:39)</a>:</h4>
<p>Your javascript syntax example has a <code>then</code> instead of an <code>afterwards</code> for the last callback operation</p>



<a name="434558783"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/304902-show%20and%20tell/topic/draft%20article%20about%20%21%20syntax/near/434558783" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/304902-show-and-tell/topic/draft.20article.20about.20.21.20syntax.html#434558783">(Apr 21 2024 at 04:40)</a>:</h4>
<p>thanks, fixed!</p>



<a name="434559498"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/304902-show%20and%20tell/topic/draft%20article%20about%20%21%20syntax/near/434559498" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Karl <a href="https://roc-lang.github.io/zulip-export/stream/304902-show-and-tell/topic/draft.20article.20about.20.21.20syntax.html#434559498">(Apr 21 2024 at 04:55)</a>:</h4>
<p>Somewhat off topic but the discussion in the article about the output format jogged my memory:</p>
<p>The best async primitive I've run across in any language is <code>let-flow</code> in Clojure's  aleph library. In Clojure the <code>let</code> form lets you make a series of bindings and then use it within the body works a lot like <code>let...in</code> in Elm. Aleph uses some macro magic to sort the bindings topologically and dispatches independent tasks in parallel. I think of it basically every time I read about an async await primitive which generally have semantics that precludes this type of optimization.</p>
<p>I understood that Roc desugared into callbacks and from that assumed it wouldn't be possible to get let-flow style optimizations but in reading this it occurs to me that the output is a data structure so this sort of optimization might be possible.</p>



<a name="434559652"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/304902-show%20and%20tell/topic/draft%20article%20about%20%21%20syntax/near/434559652" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/304902-show-and-tell/topic/draft.20article.20about.20.21.20syntax.html#434559652">(Apr 21 2024 at 04:58)</a>:</h4>
<blockquote>
<p>sort the bindings topologically and dispatches independent tasks in parallel</p>
</blockquote>
<p>that's cool! we have <a href="https://docs.google.com/document/d/1Jo9nZCekkoF6SaDcRqPqoPcgPaAAvlNZC7v3kgVQ3Tc/edit">record builder syntax</a> for this use case - the syntax is implemented, but we don't have any parallel-capable platform runtimes to use it on yet <span aria-label="big smile" class="emoji emoji-1f604" role="img" title="big smile">:big_smile:</span></p>



<a name="434559654"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/304902-show%20and%20tell/topic/draft%20article%20about%20%21%20syntax/near/434559654" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/304902-show-and-tell/topic/draft.20article.20about.20.21.20syntax.html#434559654">(Apr 21 2024 at 04:58)</a>:</h4>
<p>(that's because we need to make <code>Task</code> a builtin to enable that, which hasn't happened yet)</p>



<a name="434560947"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/304902-show%20and%20tell/topic/draft%20article%20about%20%21%20syntax/near/434560947" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/304902-show-and-tell/topic/draft.20article.20about.20.21.20syntax.html#434560947">(Apr 21 2024 at 05:22)</a>:</h4>
<p>Are there any blockers for making Task a builtin? Does it just need implementation?</p>



<a name="434560953"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/304902-show%20and%20tell/topic/draft%20article%20about%20%21%20syntax/near/434560953" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Karl <a href="https://roc-lang.github.io/zulip-export/stream/304902-show-and-tell/topic/draft.20article.20about.20.21.20syntax.html#434560953">(Apr 21 2024 at 05:22)</a>:</h4>
<p>I could see how it could be done with that syntax but it'd be nicer if it worked everywhere without having to think about it. If <code>Task</code> is a builtin that the compiler knows about then the compiler could also know where task values are used. Extending the example syntax to include an <code>id</code> per op and  <code>dependencies: id[]</code> would give platforms the information needed to dispatch in parallel but they could just head of line block like they currently do if they ignore the information.</p>



<a name="434561396"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/304902-show%20and%20tell/topic/draft%20article%20about%20%21%20syntax/near/434561396" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Norbert Hajagos <a href="https://roc-lang.github.io/zulip-export/stream/304902-show-and-tell/topic/draft.20article.20about.20.21.20syntax.html#434561396">(Apr 21 2024 at 05:32)</a>:</h4>
<p>That sounds very cool for a library, but not so much as the default behaviour for a language. Based on a sofware unscripted podcast episode (i think it was "making jit-ed code run faster") this seems like it would work a nice number of times, but when it wouldn't, it would be really bad, because you need to get around it somehow. I dont know how often that comes up in clojure though, since it doesn't have the same goals as parralelising c++ code. For Roc, I think Task builtins would be better for concurrency (ofc the platform would need to declare wheather it supports parralelism or not)</p>



<a name="434562178"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/304902-show%20and%20tell/topic/draft%20article%20about%20%21%20syntax/near/434562178" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/304902-show-and-tell/topic/draft.20article.20about.20.21.20syntax.html#434562178">(Apr 21 2024 at 05:48)</a>:</h4>
<p><span class="user-mention silent" data-user-id="515757">Luke Boswell</span> <a href="#narrow/stream/304902-show-and-tell/topic/draft.20article.20about.20!.20syntax/near/434560947">said</a>:</p>
<blockquote>
<p>Are there any blockers for making Task a builtin? Does it just need implementation?</p>
</blockquote>
<p>no blockers! No one is working on it yet though</p>



<a name="434562206"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/304902-show%20and%20tell/topic/draft%20article%20about%20%21%20syntax/near/434562206" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/304902-show-and-tell/topic/draft.20article.20about.20.21.20syntax.html#434562206">(Apr 21 2024 at 05:49)</a>:</h4>
<p>yeah regarding parallelization, I think it's really important to be able to have confidence that your code is running in parallel vs not</p>



<a name="434562266"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/304902-show%20and%20tell/topic/draft%20article%20about%20%21%20syntax/near/434562266" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/304902-show-and-tell/topic/draft.20article.20about.20.21.20syntax.html#434562266">(Apr 21 2024 at 05:50)</a>:</h4>
<p>one of the reasons records were chosen explicitly for that syntax is because it's really obvious syntactically that when you're building a record, the fields can't depend on each other (because the record hasn't been built yet)</p>



<a name="434562285"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/304902-show%20and%20tell/topic/draft%20article%20about%20%21%20syntax/near/434562285" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/304902-show-and-tell/topic/draft.20article.20about.20.21.20syntax.html#434562285">(Apr 21 2024 at 05:50)</a>:</h4>
<p>and for them to run in parallel, they can't depend on each other</p>



<a name="434562308"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/304902-show%20and%20tell/topic/draft%20article%20about%20%21%20syntax/near/434562308" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/304902-show-and-tell/topic/draft.20article.20about.20.21.20syntax.html#434562308">(Apr 21 2024 at 05:51)</a>:</h4>
<p>Haskell's <a href="https://ghc.gitlab.haskell.org/ghc/doc/users_guide/exts/applicative_do.html">applicative <code>do</code></a> also does it automatically based on compiler analysis, but I prefer it to be explicit in syntax</p>



<a name="434593307"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/304902-show%20and%20tell/topic/draft%20article%20about%20%21%20syntax/near/434593307" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/304902-show-and-tell/topic/draft.20article.20about.20.21.20syntax.html#434593307">(Apr 21 2024 at 14:36)</a>:</h4>
<p>I thought there was a blocker related to effects and dependences. Though maybe that is only an issue once we have the effect interpreter version of task?</p>



<a name="434593822"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/304902-show%20and%20tell/topic/draft%20article%20about%20%21%20syntax/near/434593822" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/304902-show-and-tell/topic/draft.20article.20about.20.21.20syntax.html#434593822">(Apr 21 2024 at 14:44)</a>:</h4>
<p>yeah basically task as builtin (on its own) just requires:</p>
<ul>
<li>add the <code>Task</code> module to builtins</li>
<li>instead of generating <code>Effect</code> in <code>hosted</code> modules we generate <code>Task</code></li>
<li>hosts have to update their effect implementations accordingly (basically now they'll always be dealing with a <code>Result</code>)</li>
</ul>



<a name="434593854"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/304902-show%20and%20tell/topic/draft%20article%20about%20%21%20syntax/near/434593854" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/304902-show-and-tell/topic/draft.20article.20about.20.21.20syntax.html#434593854">(Apr 21 2024 at 14:45)</a>:</h4>
<p>making <code>Task.map2</code> able to parallelize has other blockers, but at a minimum it requires task being a builtin, which doesn't have blockers</p>



<a name="434593967"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/304902-show%20and%20tell/topic/draft%20article%20about%20%21%20syntax/near/434593967" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/304902-show-and-tell/topic/draft.20article.20about.20.21.20syntax.html#434593967">(Apr 21 2024 at 14:46)</a>:</h4>
<p>separately, once we have module params we can (and should) replace <code>hosted</code> modules with declarations in the <code>platform</code> module, but that's blocked on task being a builtin</p>



<a name="434594001"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/304902-show%20and%20tell/topic/draft%20article%20about%20%21%20syntax/near/434594001" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/304902-show-and-tell/topic/draft.20article.20about.20.21.20syntax.html#434594001">(Apr 21 2024 at 14:47)</a>:</h4>
<p>that change might be the dependencies thing you're thinking of; we can't make that change without module params or else the ergonomics would be terrible <span aria-label="sweat smile" class="emoji emoji-1f605" role="img" title="sweat smile">:sweat_smile:</span></p>



<a name="434596447"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/304902-show%20and%20tell/topic/draft%20article%20about%20%21%20syntax/near/434596447" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/304902-show-and-tell/topic/draft.20article.20about.20.21.20syntax.html#434596447">(Apr 21 2024 at 15:22)</a>:</h4>
<blockquote>
<p>Instead of generating <code>Effect</code> in <code>hosted</code> modules we generate <code>Task</code></p>
</blockquote>
<p>Ah yeah, that would definitely fix any <code>Effect</code> and <code>Task</code> related dependency issues.</p>



<a name="434596472"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/304902-show%20and%20tell/topic/draft%20article%20about%20%21%20syntax/near/434596472" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hansknecht <a href="https://roc-lang.github.io/zulip-export/stream/304902-show-and-tell/topic/draft.20article.20about.20.21.20syntax.html#434596472">(Apr 21 2024 at 15:22)</a>:</h4>
<p>Can't have a dependency on <code>Effect</code> if <code>Effect</code> doesn't exist</p>



<hr><p>Last updated: Mar 01 2026 at 12:20 UTC</p>
</html>