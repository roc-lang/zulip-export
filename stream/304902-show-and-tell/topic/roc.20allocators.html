<html>
<head><meta charset="utf-8"><title>roc allocators · show and tell · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://roc-lang.github.io/zulip-export/stream/304902-show-and-tell/index.html">show and tell</a></h2>
<h3>Topic: <a href="https://roc-lang.github.io/zulip-export/stream/304902-show-and-tell/topic/roc.20allocators.html">roc allocators</a></h3>

<hr>

<base href="https://roc.zulipchat.com">

<head><link href="https://roc-lang.github.io/zulip-export/style.css" rel="stylesheet"></head>

<a name="571361251"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/304902-show%20and%20tell/topic/roc%20allocators/near/571361251" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nandi <a href="https://roc-lang.github.io/zulip-export/stream/304902-show-and-tell/topic/roc.20allocators.html#571361251">(Feb 02 2026 at 07:26)</a>:</h4>
<p>I implemented zig allocators in my platform lol</p>
<div class="codehilite"><pre><span></span><code>app [main!] { pf: platform &quot;../platform/main.roc&quot; }

import pf.Stdout
import pf.AllocHost

main! : List(Str) =&gt; Try({}, [Exit(I32)])
main! = |_args| {
    Stdout.line!(&quot;Testing poke/peek with Try-based alloc...&quot;)

    # Allocate 4 bytes - returns [Ok(U64), OutOfMemory]
    alloc_result = AllocHost.alloc_impl!(4)

    match alloc_result {
        OutOfMemory =&gt; {
            Stdout.line!(&quot;Allocation failed: OutOfMemory&quot;)
            Err(Exit(1))
        }

        Ok(ptr) =&gt; {
            Stdout.line!(&quot;Allocated 4 bytes.&quot;)

            # Write &quot;Roc!&quot; using poke
            AllocHost.poke_impl!({ byte: 82, ptr: ptr })
            AllocHost.poke_impl!({ byte: 111, ptr: ptr + 1 })
            AllocHost.poke_impl!({ byte: 99, ptr: ptr + 2 })
            AllocHost.poke_impl!({ byte: 33, ptr: ptr + 3 })

            Stdout.line!(&quot;Written &#39;Roc!&#39; to memory.&quot;)

            # Read back using peek
            c1 = AllocHost.peek_impl!(ptr)
            c2 = AllocHost.peek_impl!(ptr + 1)
            c3 = AllocHost.peek_impl!(ptr + 2)
            c4 = AllocHost.peek_impl!(ptr + 3)

            Stdout.line!(&quot;Read back: ${Str.inspect(c1)} ${Str.inspect(c2)} ${Str.inspect(c3)} ${Str.inspect(c4)}&quot;)

            # Expected: 82 111 99 33 = &quot;Roc!&quot;
            Stdout.line!(&quot;Expected:  82 111 99 33&quot;)

            # Deallocate
            AllocHost.dealloc_impl!(ptr)
            Stdout.line!(&quot;Deallocated. SUCCESS!&quot;)
            Ok({})
        }
    }
}
</code></pre></div>



<a name="571485441"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/304902-show%20and%20tell/topic/roc%20allocators/near/571485441" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rick Hull <a href="https://roc-lang.github.io/zulip-export/stream/304902-show-and-tell/topic/roc.20allocators.html#571485441">(Feb 02 2026 at 17:12)</a>:</h4>
<p>Cool!  Note, I have never issued a <code>malloc()</code>, ever.  However, in my reading, it seems that malloc/free is really a bad pattern unless you need it, and that arena allocation is probably a better starting point, depending on context, or else never-free-and-quit (not for long-running processes, obviously; but web workers can quit once the request is cleared).</p>



<a name="571485673"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/304902-show%20and%20tell/topic/roc%20allocators/near/571485673" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nandi <a href="https://roc-lang.github.io/zulip-export/stream/304902-show-and-tell/topic/roc.20allocators.html#571485673">(Feb 02 2026 at 17:14)</a>:</h4>
<p>It was mostly satire since roc is not memory managed</p>



<a name="571486803"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/304902-show%20and%20tell/topic/roc%20allocators/near/571486803" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rick Hull <a href="https://roc-lang.github.io/zulip-export/stream/304902-show-and-tell/topic/roc.20allocators.html#571486803">(Feb 02 2026 at 17:19)</a>:</h4>
<p>RIP me <span aria-label="laughing" class="emoji emoji-1f606" role="img" title="laughing">:laughing:</span></p>



<hr><p>Last updated: Mar 01 2026 at 12:20 UTC</p>
</html>