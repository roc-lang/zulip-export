<html>
<head><meta charset="utf-8"><title>Weaver: record builder CLI parsing library · show and tell · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://roc-lang.github.io/zulip-export/stream/304902-show-and-tell/index.html">show and tell</a></h2>
<h3>Topic: <a href="https://roc-lang.github.io/zulip-export/stream/304902-show-and-tell/topic/Weaver.3A.20record.20builder.20CLI.20parsing.20library.html">Weaver: record builder CLI parsing library</a></h3>

<hr>

<base href="https://roc.zulipchat.com">

<head><link href="https://roc-lang.github.io/zulip-export/style.css" rel="stylesheet"></head>

<a name="431955826"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/304902-show%20and%20tell/topic/Weaver%3A%20record%20builder%20CLI%20parsing%20library/near/431955826" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/304902-show-and-tell/topic/Weaver.3A.20record.20builder.20CLI.20parsing.20library.html#431955826">(Apr 08 2024 at 12:17)</a>:</h4>
<p>I've been pretty excited by the <a href="https://github.com/roc-lang/roc/pull/5421">record builder changes</a> that got added last year, and I've been seeing some discussion around us having a good example of using them. I thought of all of my experience using <a href="https://github.com/clap-rs/clap">Clap</a> in Rust, since their <code>#[derive(Parser)]</code> user experience is great because you can "Parse, not Validate". I spent the last week cracking out a library to do type-safe CLI parser generation using the record builder pattern and I'm really happy with the results!</p>
<p>Some of the nice features we get:</p>
<ul>
<li>Automatic help pages and usage error reports</li>
<li>Composable and reusable tools, define your parsers separate from using them</li>
<li>Type-safe ordering of argument parsing (options <em>must</em> be before subcommands, which <em>must</em> be before parameters)</li>
<li>A great example to point people to if they want to see what the <code>: &lt;-</code> can do for them</li>
</ul>
<p>Below is a small example of using the lib, and here's the repo if you're interested: <a href="https://github.com/smores56/weaver">https://github.com/smores56/weaver</a></p>
<div class="codehilite" data-code-language="Elm"><pre><span></span><code><span class="nv">expect</span>
<span class="w">    </span><span class="nv">subcommandParser</span><span class="w"> </span><span class="nf">=</span>
<span class="w">        </span><span class="nv">cliBuilder</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nv">d</span><span class="nf">:</span><span class="w"> </span><span class="nf">&lt;-</span><span class="w"> </span><span class="nv">numOption</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nv">name</span><span class="nf">:</span><span class="w"> </span><span class="kt">Short</span><span class="w"> </span><span class="s">"d"</span><span class="p">,</span><span class="w"> </span><span class="nv">help</span><span class="nf">:</span><span class="w"> </span><span class="s">"A required number."</span><span class="w"> </span><span class="p">},</span>
<span class="w">            </span><span class="nv">f</span><span class="nf">:</span><span class="w"> </span><span class="nf">&lt;-</span><span class="w"> </span><span class="nv">maybeNumOption</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nv">name</span><span class="nf">:</span><span class="w"> </span><span class="kt">Short</span><span class="w"> </span><span class="s">"f"</span><span class="p">,</span><span class="w"> </span><span class="nv">help</span><span class="nf">:</span><span class="w"> </span><span class="s">"An optional number."</span><span class="w"> </span><span class="p">},</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="nf">|&gt;</span><span class="w"> </span><span class="nv">finishSubcommand</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nv">name</span><span class="nf">:</span><span class="w"> </span><span class="s">"sub"</span><span class="p">,</span><span class="w"> </span><span class="nv">description</span><span class="nf">:</span><span class="w"> </span><span class="s">"A specific action to take."</span><span class="p">,</span><span class="w"> </span><span class="nv">mapper</span><span class="nf">:</span><span class="w"> </span><span class="kt">Sub</span><span class="w"> </span><span class="p">}</span>

<span class="w">    </span><span class="p">{</span><span class="w"> </span><span class="nv">parser</span><span class="p">,</span><span class="w"> </span><span class="nv">config</span><span class="nf">:</span><span class="w"> </span><span class="nv">_</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="nf">=</span>
<span class="w">        </span><span class="nv">cliBuilder</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nv">alpha</span><span class="nf">:</span><span class="w"> </span><span class="nf">&lt;-</span><span class="w"> </span><span class="nv">numOption</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nv">name</span><span class="nf">:</span><span class="w"> </span><span class="kt">Short</span><span class="w"> </span><span class="s">"a"</span><span class="p">,</span><span class="w"> </span><span class="nv">help</span><span class="nf">:</span><span class="w"> </span><span class="s">"Set the alpha level."</span><span class="w"> </span><span class="p">},</span>
<span class="w">            </span><span class="nv">beta</span><span class="nf">:</span><span class="w"> </span><span class="nf">&lt;-</span><span class="w"> </span><span class="nv">flagOption</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nv">name</span><span class="nf">:</span><span class="w"> </span><span class="kt">Both</span><span class="w"> </span><span class="s">"b"</span><span class="w"> </span><span class="s">"beta"</span><span class="w"> </span><span class="p">},</span>
<span class="w">            </span><span class="nv">xyz</span><span class="nf">:</span><span class="w"> </span><span class="nf">&lt;-</span><span class="w"> </span><span class="nv">strOption</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nv">name</span><span class="nf">:</span><span class="w"> </span><span class="kt">Long</span><span class="w"> </span><span class="s">"xyz"</span><span class="w"> </span><span class="p">},</span>
<span class="w">            </span><span class="nv">verbosity</span><span class="nf">:</span><span class="w"> </span><span class="nf">&lt;-</span><span class="w"> </span><span class="nv">occurrenceOption</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nv">name</span><span class="nf">:</span><span class="w"> </span><span class="kt">Both</span><span class="w"> </span><span class="s">"v"</span><span class="w"> </span><span class="s">"verbose"</span><span class="w"> </span><span class="p">},</span>
<span class="w">            </span><span class="nv">sc</span><span class="nf">:</span><span class="w"> </span><span class="nf">&lt;-</span><span class="w"> </span><span class="nv">subcommandField</span><span class="w"> </span><span class="p">[</span><span class="nv">subcommandParser</span><span class="p">],</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="nf">|&gt;</span><span class="w"> </span><span class="nv">finishCli</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nv">name</span><span class="nf">:</span><span class="w"> </span><span class="s">"app"</span><span class="p">,</span><span class="w"> </span><span class="nv">version</span><span class="nf">:</span><span class="w"> </span><span class="s">"v0.0.1"</span><span class="p">,</span><span class="w"> </span><span class="nv">authors</span><span class="nf">:</span><span class="w"> </span><span class="p">[</span><span class="s">"Some One &lt;some.one@mail.com&gt;"</span><span class="p">]</span><span class="w"> </span><span class="p">}</span>
<span class="w">        </span><span class="nf">|&gt;</span><span class="w"> </span><span class="nv">assertCliIsValid</span><span class="w"> </span><span class="err">#</span><span class="w"> </span><span class="nv">crash</span><span class="w"> </span><span class="nv">immediately</span><span class="w"> </span><span class="nv">on</span><span class="w"> </span><span class="nv">unrecoverable</span><span class="w"> </span><span class="nv">issues</span><span class="p">,</span><span class="w"> </span><span class="nv">e</span><span class="nf">.</span><span class="nv">g</span><span class="nf">.</span><span class="w"> </span><span class="nv">empty</span><span class="w"> </span><span class="nv">flag</span><span class="w"> </span><span class="nv">names</span>

<span class="w">    </span><span class="nv">out</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nv">parser</span><span class="w"> </span><span class="p">[</span><span class="s">"app"</span><span class="p">,</span><span class="w"> </span><span class="s">"-a"</span><span class="p">,</span><span class="w"> </span><span class="s">"123"</span><span class="p">,</span><span class="w"> </span><span class="s">"-b"</span><span class="p">,</span><span class="w"> </span><span class="s">"--xyz"</span><span class="p">,</span><span class="w"> </span><span class="s">"some_text"</span><span class="p">,</span><span class="w"> </span><span class="s">"-vvvv"</span><span class="p">,</span><span class="w"> </span><span class="s">"sub"</span><span class="p">,</span><span class="w"> </span><span class="s">"-d"</span><span class="p">,</span><span class="w"> </span><span class="s">"456"</span><span class="p">]</span>

<span class="w">    </span><span class="nv">out</span>
<span class="w">    </span><span class="nf">==</span><span class="w"> </span><span class="kt">SuccessfullyParsed</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nv">alpha</span><span class="nf">:</span><span class="w"> </span><span class="mi">123</span><span class="p">,</span>
<span class="w">        </span><span class="nv">beta</span><span class="nf">:</span><span class="w"> </span><span class="kt">Bool</span><span class="nf">.</span><span class="nv">true</span><span class="p">,</span>
<span class="w">        </span><span class="nv">xyz</span><span class="nf">:</span><span class="w"> </span><span class="s">"some_text"</span><span class="p">,</span>
<span class="w">        </span><span class="nv">verbosity</span><span class="nf">:</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span>
<span class="w">        </span><span class="nv">sc</span><span class="nf">:</span><span class="w"> </span><span class="kt">Ok</span><span class="w"> </span><span class="p">(</span><span class="kt">Sub</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nv">d</span><span class="nf">:</span><span class="w"> </span><span class="mi">456</span><span class="p">,</span><span class="w"> </span><span class="nv">f</span><span class="nf">:</span><span class="w"> </span><span class="kt">Err</span><span class="w"> </span><span class="kt">NoValue</span><span class="w"> </span><span class="p">}),</span>
<span class="w">    </span><span class="p">}</span>
</code></pre></div>
<p>As mentioned in the README, I've got the basics mostly sorted, but I've got to go through and do a good bit more testing than is currently being done. Then, the next step is documentation, and once this feels stable, I'll start doing GitHub releases so you can use this library without having to download it first <span aria-label="sweat smile" class="emoji emoji-1f605" role="img" title="sweat smile">:sweat_smile:</span> </p>
<p>I have to go to bed now, but I'd love to discuss any ideas you have for "must-have" features or ergonomic fixes you'd make to the API or internals. Feel free to ping me!</p>



<a name="431957662"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/304902-show%20and%20tell/topic/Weaver%3A%20record%20builder%20CLI%20parsing%20library/near/431957662" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Isaac Van Doren <a href="https://roc-lang.github.io/zulip-export/stream/304902-show-and-tell/topic/Weaver.3A.20record.20builder.20CLI.20parsing.20library.html#431957662">(Apr 08 2024 at 12:25)</a>:</h4>
<p>Awesome!</p>



<a name="431977872"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/304902-show%20and%20tell/topic/Weaver%3A%20record%20builder%20CLI%20parsing%20library/near/431977872" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anton <a href="https://roc-lang.github.io/zulip-export/stream/304902-show-and-tell/topic/Weaver.3A.20record.20builder.20CLI.20parsing.20library.html#431977872">(Apr 08 2024 at 14:02)</a>:</h4>
<p>Clever use of the record builder syntax!</p>



<a name="432009572"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/304902-show%20and%20tell/topic/Weaver%3A%20record%20builder%20CLI%20parsing%20library/near/432009572" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/304902-show-and-tell/topic/Weaver.3A.20record.20builder.20CLI.20parsing.20library.html#432009572">(Apr 08 2024 at 15:58)</a>:</h4>
<p>wow, fantastic!!! <span aria-label="heart eyes" class="emoji emoji-1f60d" role="img" title="heart eyes">:heart_eyes:</span></p>



<a name="432010073"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/304902-show%20and%20tell/topic/Weaver%3A%20record%20builder%20CLI%20parsing%20library/near/432010073" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/304902-show-and-tell/topic/Weaver.3A.20record.20builder.20CLI.20parsing.20library.html#432010073">(Apr 08 2024 at 15:59)</a>:</h4>
<p>I love that you got the automatic help text generation in there...being able to support that was one of the original motivating reasons behind having the record builder syntax, and it's super exciting to see the first-ever example of it in action! <span aria-label="grinning face with smiling eyes" class="emoji emoji-1f601" role="img" title="grinning face with smiling eyes">:grinning_face_with_smiling_eyes:</span></p>



<a name="432010429"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/304902-show%20and%20tell/topic/Weaver%3A%20record%20builder%20CLI%20parsing%20library/near/432010429" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/304902-show-and-tell/topic/Weaver.3A.20record.20builder.20CLI.20parsing.20library.html#432010429">(Apr 08 2024 at 16:01)</a>:</h4>
<p>what do you think of putting the different argument styles into a separate module? e.g. <code>d: &lt;- Arg.num { ... }</code> instead of <code>d: &lt;- numOption { ... }</code></p>



<a name="432028148"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/304902-show%20and%20tell/topic/Weaver%3A%20record%20builder%20CLI%20parsing%20library/near/432028148" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/304902-show-and-tell/topic/Weaver.3A.20record.20builder.20CLI.20parsing.20library.html#432028148">(Apr 08 2024 at 17:08)</a>:</h4>
<p>Yeah, that seems like a good way to compactify the method calls. I was also trying to do something terse for the argument names with default records, but I realized that default values in type definitions universalize, meaning two function calls to the same function can't omit <em>different</em> fields from the same record definition. Is that intended behavior?</p>



<a name="432029394"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/304902-show%20and%20tell/topic/Weaver%3A%20record%20builder%20CLI%20parsing%20library/near/432029394" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Hristo <a href="https://roc-lang.github.io/zulip-export/stream/304902-show-and-tell/topic/Weaver.3A.20record.20builder.20CLI.20parsing.20library.html#432029394">(Apr 08 2024 at 17:15)</a>:</h4>
<p>I'm still a beginner, so my apologies. I could be misunderstanding, but if I'm not, this isn't intended behaviour. It was recently discussed <a href="#narrow/stream/231634-beginners/topic/optional.20field.20problem/near/431181945">here</a>.</p>



<a name="432029469"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/304902-show%20and%20tell/topic/Weaver%3A%20record%20builder%20CLI%20parsing%20library/near/432029469" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/304902-show-and-tell/topic/Weaver.3A.20record.20builder.20CLI.20parsing.20library.html#432029469">(Apr 08 2024 at 17:16)</a>:</h4>
<p>I figured, thanks for the link!</p>



<a name="432048241"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/304902-show%20and%20tell/topic/Weaver%3A%20record%20builder%20CLI%20parsing%20library/near/432048241" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Agus Zubiaga <a href="https://roc-lang.github.io/zulip-export/stream/304902-show-and-tell/topic/Weaver.3A.20record.20builder.20CLI.20parsing.20library.html#432048241">(Apr 08 2024 at 19:03)</a>:</h4>
<p>Nice! Looking forward to using this <span aria-label="smiley" class="emoji emoji-1f603" role="img" title="smiley">:smiley:</span></p>



<a name="432476433"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/304902-show%20and%20tell/topic/Weaver%3A%20record%20builder%20CLI%20parsing%20library/near/432476433" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/304902-show-and-tell/topic/Weaver.3A.20record.20builder.20CLI.20parsing.20library.html#432476433">(Apr 10 2024 at 10:55)</a>:</h4>
<p>Weaver has now been <a href="https://github.com/smores56/weaver/releases/tag/0.1.0">released on GitHub</a>, so you can use it in your applications now! The example in the <a href="https://github.com/smores56/weaver/blob/main/README.md">README</a> shows a working example of using Weaver from the net. I've documented all of the public features for now, and I've released said docs on GitHub pages <a href="https://smores56.github.io/weaver/Cli/">here</a> using the GitHub workflows I <del>stole</del> borrowed from <span class="user-mention" data-user-id="515757">@Luke Boswell</span> 's <a href="https://github.com/lukewilliamboswell/roc-json">roc-json</a> library.</p>
<p>Since you last saw it, I made the change that <span class="user-mention" data-user-id="281383">@Richard Feldman</span> suggested to name functions assuming they'll be called as module members, so <code>numOption</code> is now <code>Opt.num</code>, and <code>strListParam</code> is now <code>Param.strList</code>, and so on. (I didn't call it <code>Arg.num</code> because that overlaps with <code>basic-cli</code>'s <code>Arg</code> module and we can't currently rename imports, though I know that's in progress).</p>
<p>I probably won't be going nearly as fast in developing it now that's it's in an MVP state, but I'll still be working on it after my vacation comes and goes this weekend. Happy Weaving!</p>
<p>Repo: <a href="https://github.com/smores56/weaver">https://github.com/smores56/weaver</a><br>
Docs: <a href="https://smores56.github.io/weaver/Cli/">https://smores56.github.io/weaver/Cli/</a><br>
Download URL: <a href="https://github.com/smores56/weaver/releases/download/0.1.0/MnJi0GTNzOI77qDnH99iuBNsM5ZKnc-gZTLFj7sIdqo.tar.br">https://github.com/smores56/weaver/releases/download/0.1.0/MnJi0GTNzOI77qDnH99iuBNsM5ZKnc-gZTLFj7sIdqo.tar.br</a></p>



<a name="437096029"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/304902-show%20and%20tell/topic/Weaver%3A%20record%20builder%20CLI%20parsing%20library/near/437096029" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/304902-show-and-tell/topic/Weaver.3A.20record.20builder.20CLI.20parsing.20library.html#437096029">(May 05 2024 at 09:21)</a>:</h4>
<p>Weaver has now reached v0.2.0! The main changes are:</p>
<ul>
<li>There's a parser for every number type instead of just <code>U64</code></li>
<li>There's simple ANSI styling by default for help text, which can be turned off</li>
<li>The help page content formatting is a bit nicer</li>
</ul>
<p>At the suggestion of Richard Feldman, I wrote <a href="https://sammohr.dev/blog/announcing-weaver">an article</a> that explains why I wrote Weaver, which should be ready to go. However, before it's properly disseminated, I'd love to get a pair of eyes that aren't mine on it just to double check it. Then we can get more Roc propaganda on HackerNews!</p>



<a name="437096485"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/304902-show%20and%20tell/topic/Weaver%3A%20record%20builder%20CLI%20parsing%20library/near/437096485" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/304902-show-and-tell/topic/Weaver.3A.20record.20builder.20CLI.20parsing.20library.html#437096485">(May 05 2024 at 09:29)</a>:</h4>
<p>Nice. </p>
<p>Noticed some issues with the article on my phone using chrome.</p>
<p><a href="/user_uploads/22008/3M8m0vZlVkgrXDOm4qfunRjj/Screenshot_20240505-112812_Chrome.jpg">Screenshot_20240505-112812_Chrome.jpg</a></p>
<div class="message_inline_image"><a href="/user_uploads/22008/3M8m0vZlVkgrXDOm4qfunRjj/Screenshot_20240505-112812_Chrome.jpg" title="Screenshot_20240505-112812_Chrome.jpg"><img src="/user_uploads/22008/3M8m0vZlVkgrXDOm4qfunRjj/Screenshot_20240505-112812_Chrome.jpg"></a></div>



<a name="437096496"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/304902-show%20and%20tell/topic/Weaver%3A%20record%20builder%20CLI%20parsing%20library/near/437096496" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/304902-show-and-tell/topic/Weaver.3A.20record.20builder.20CLI.20parsing.20library.html#437096496">(May 05 2024 at 09:29)</a>:</h4>
<p>I cant read or scroll to see on the right.</p>



<a name="437096588"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/304902-show%20and%20tell/topic/Weaver%3A%20record%20builder%20CLI%20parsing%20library/near/437096588" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/304902-show-and-tell/topic/Weaver.3A.20record.20builder.20CLI.20parsing.20library.html#437096588">(May 05 2024 at 09:31)</a>:</h4>
<p>Yeah, seems that making it narrower on my computer wasn't narrow enough</p>



<a name="437096849"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/304902-show%20and%20tell/topic/Weaver%3A%20record%20builder%20CLI%20parsing%20library/near/437096849" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/304902-show-and-tell/topic/Weaver.3A.20record.20builder.20CLI.20parsing.20library.html#437096849">(May 05 2024 at 09:35)</a>:</h4>
<p>Can you put the Arg.List! inline in the when statement? If that doesnt work I might need to look into the unrwapping for that part.</p>
<div class="codehilite"><pre><span></span><code>    when Cli.parseOrDisplayMessage cli (Arg.list!) is
</code></pre></div>



<a name="437096908"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/304902-show%20and%20tell/topic/Weaver%3A%20record%20builder%20CLI%20parsing%20library/near/437096908" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/304902-show-and-tell/topic/Weaver.3A.20record.20builder.20CLI.20parsing.20library.html#437096908">(May 05 2024 at 09:36)</a>:</h4>
<p>Only if you want to do it like that</p>



<a name="437097690"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/304902-show%20and%20tell/topic/Weaver%3A%20record%20builder%20CLI%20parsing%20library/near/437097690" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/304902-show-and-tell/topic/Weaver.3A.20record.20builder.20CLI.20parsing.20library.html#437097690">(May 05 2024 at 09:50)</a>:</h4>
<blockquote>
<p>Can you put the Arg.list! inline?</p>
</blockquote>
<p>Done! And your mobile should work better, please let me know if you've still got issues</p>



<a name="437097776"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/304902-show%20and%20tell/topic/Weaver%3A%20record%20builder%20CLI%20parsing%20library/near/437097776" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/304902-show-and-tell/topic/Weaver.3A.20record.20builder.20CLI.20parsing.20library.html#437097776">(May 05 2024 at 09:52)</a>:</h4>
<p>I tested that on the <a href="https://github.com/smores56/weaver/blob/151ff3aa593ec709d4752085cc0779c3df208ce2/examples/basic.roc#L16">basic.roc</a> example from the Weaver repo and it worked</p>



<a name="437100404"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/304902-show%20and%20tell/topic/Weaver%3A%20record%20builder%20CLI%20parsing%20library/near/437100404" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/304902-show-and-tell/topic/Weaver.3A.20record.20builder.20CLI.20parsing.20library.html#437100404">(May 05 2024 at 10:35)</a>:</h4>
<p>Looks good on mobile now <span aria-label="+1" class="emoji emoji-1f44d" role="img" title="+1">:+1:</span></p>



<a name="437100528"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/304902-show%20and%20tell/topic/Weaver%3A%20record%20builder%20CLI%20parsing%20library/near/437100528" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Boswell <a href="https://roc-lang.github.io/zulip-export/stream/304902-show-and-tell/topic/Weaver.3A.20record.20builder.20CLI.20parsing.20library.html#437100528">(May 05 2024 at 10:37)</a>:</h4>
<p>Btw, I've been using Weaver on something I've been working on and it's super awesome. <span aria-label="ok" class="emoji emoji-1f44c" role="img" title="ok">:ok:</span> It just works nicely and haven't had any issues. Looking forward to trying out v2.</p>



<a name="437101498"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/304902-show%20and%20tell/topic/Weaver%3A%20record%20builder%20CLI%20parsing%20library/near/437101498" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Hannes <a href="https://roc-lang.github.io/zulip-export/stream/304902-show-and-tell/topic/Weaver.3A.20record.20builder.20CLI.20parsing.20library.html#437101498">(May 05 2024 at 10:52)</a>:</h4>
<p>Nice article, I'm looking forward to use Weaver for my next Roc project! </p>
<p>I'm confused about the Python example though, that syntax is very unfamiliar to me, is it real code or just hypothetical? </p>
<p>Using the Python stdlib, I would write something like: </p>
<div class="codehilite" data-code-language="Python"><pre><span></span><code><span class="kn">import</span> <span class="nn">argparse</span>

<span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s1">'my-app'</span><span class="p">)</span>
<span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">'-f'</span><span class="p">,</span> <span class="s1">'--force'</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">'store_true'</span><span class="p">)</span>
<span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">'file'</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">)</span>
<span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">'amount'</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>

<span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">"File:"</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">file</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Amount:"</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">amount</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Force:"</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">force</span><span class="p">)</span>
</code></pre></div>
<p>The <code>type</code> arguments are functions that are run on the corresponding argument to parse the string to a specified type, which makes it seem like there could be some type inference, but the <code>args</code> variable has the <code>Namespace</code> type, and all the properties have the <code>Any</code> type.</p>



<a name="437129282"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/304902-show%20and%20tell/topic/Weaver%3A%20record%20builder%20CLI%20parsing%20library/near/437129282" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris <a href="https://roc-lang.github.io/zulip-export/stream/304902-show-and-tell/topic/Weaver.3A.20record.20builder.20CLI.20parsing.20library.html#437129282">(May 05 2024 at 15:04)</a>:</h4>
<p>great article! I don't really understand the builder syntax (and applicative in general lol), so I'm even more impressed by weaver</p>



<a name="437129542"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/304902-show%20and%20tell/topic/Weaver%3A%20record%20builder%20CLI%20parsing%20library/near/437129542" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris <a href="https://roc-lang.github.io/zulip-export/stream/304902-show-and-tell/topic/Weaver.3A.20record.20builder.20CLI.20parsing.20library.html#437129542">(May 05 2024 at 15:05)</a>:</h4>
<p>i believe the type for <code>allColors</code> here would be a <code>List [Red, Green, Custom U64]</code>?<br>
<a href="/user_uploads/22008/6ynUwaKdg3hxVUClid38aKOi/image.png">image.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/22008/6ynUwaKdg3hxVUClid38aKOi/image.png" title="image.png"><img src="/user_uploads/22008/6ynUwaKdg3hxVUClid38aKOi/image.png"></a></div>



<a name="437142688"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/304902-show%20and%20tell/topic/Weaver%3A%20record%20builder%20CLI%20parsing%20library/near/437142688" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/304902-show-and-tell/topic/Weaver.3A.20record.20builder.20CLI.20parsing.20library.html#437142688">(May 05 2024 at 16:14)</a>:</h4>
<p><span class="user-mention silent" data-user-id="524729">ziutech</span> <a href="#narrow/stream/304902-show-and-tell/topic/Weaver.3A.20record.20builder.20CLI.20parsing.20library/near/437129282">said</a>:</p>
<blockquote>
<p>I don't really understand the builder syntax (and applicative in general lol)</p>
</blockquote>
<p><span class="user-mention" data-user-id="489294">@Agus Zubiaga</span> and I have talked about a way to make it simpler from both a types and syntax perspective, so this is encouraging feedback to hear! <span aria-label="smiley" class="emoji emoji-1f603" role="img" title="smiley">:smiley:</span></p>
<p>I'll write that design up, maybe in the next week or two</p>



<a name="437150695"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/304902-show%20and%20tell/topic/Weaver%3A%20record%20builder%20CLI%20parsing%20library/near/437150695" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/304902-show-and-tell/topic/Weaver.3A.20record.20builder.20CLI.20parsing.20library.html#437150695">(May 05 2024 at 17:54)</a>:</h4>
<p><span class="user-mention silent" data-user-id="508951">Hannes</span> <a href="#narrow/stream/304902-show-and-tell/topic/Weaver.3A.20record.20builder.20CLI.20parsing.20library/near/437101498">said</a>:</p>
<blockquote>
<p>I'm confused about the Python example though, that syntax is very unfamiliar to me, is it real code or just hypothetical? </p>
</blockquote>
<p>It's hypothetical. I tried to clarify that a bit in the article by saying it's a "simplified example" and "if I used the stdlib, it'd be nicer, but only because dynamic type system"</p>



<a name="437150698"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/304902-show%20and%20tell/topic/Weaver%3A%20record%20builder%20CLI%20parsing%20library/near/437150698" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/304902-show-and-tell/topic/Weaver.3A.20record.20builder.20CLI.20parsing.20library.html#437150698">(May 05 2024 at 17:54)</a>:</h4>
<p>Okay <span class="user-mention" data-user-id="281383">@Richard Feldman</span> it's ready to send out (<a href="https://sammohr.dev/blog/announcing-weaver">link</a>), at your leisure. Unless you'd rather I send it out?</p>



<a name="437150711"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/304902-show%20and%20tell/topic/Weaver%3A%20record%20builder%20CLI%20parsing%20library/near/437150711" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/304902-show-and-tell/topic/Weaver.3A.20record.20builder.20CLI.20parsing.20library.html#437150711">(May 05 2024 at 17:54)</a>:</h4>
<p>go for it! <span aria-label="smiley" class="emoji emoji-1f603" role="img" title="smiley">:smiley:</span></p>



<a name="437150719"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/304902-show%20and%20tell/topic/Weaver%3A%20record%20builder%20CLI%20parsing%20library/near/437150719" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/304902-show-and-tell/topic/Weaver.3A.20record.20builder.20CLI.20parsing.20library.html#437150719">(May 05 2024 at 17:54)</a>:</h4>
<p>thanks for writing it up!</p>



<a name="437150752"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/304902-show%20and%20tell/topic/Weaver%3A%20record%20builder%20CLI%20parsing%20library/near/437150752" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/304902-show-and-tell/topic/Weaver.3A.20record.20builder.20CLI.20parsing.20library.html#437150752">(May 05 2024 at 17:55)</a>:</h4>
<p>Not a social media person, so uh... where should I send it? I don't have a twitter or an HN account.</p>



<a name="437150816"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/304902-show%20and%20tell/topic/Weaver%3A%20record%20builder%20CLI%20parsing%20library/near/437150816" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/304902-show-and-tell/topic/Weaver.3A.20record.20builder.20CLI.20parsing.20library.html#437150816">(May 05 2024 at 17:56)</a>:</h4>
<p>I'll put it on Reddit for starters</p>



<a name="437152780"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/304902-show%20and%20tell/topic/Weaver%3A%20record%20builder%20CLI%20parsing%20library/near/437152780" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/304902-show-and-tell/topic/Weaver.3A.20record.20builder.20CLI.20parsing.20library.html#437152780">(May 05 2024 at 18:26)</a>:</h4>
<p><a href="https://www.reddit.com/r/programming/comments/1ckxqyi/announcing_weaver_an_ergonomic_cli_parsing/">https://www.reddit.com/r/programming/comments/1ckxqyi/announcing_weaver_an_ergonomic_cli_parsing/</a><br>
<a href="https://www.reddit.com/r/functionalprogramming/comments/1ckxnub/announcing_weaver_an_ergonomic_cli_parsing/">https://www.reddit.com/r/functionalprogramming/comments/1ckxnub/announcing_weaver_an_ergonomic_cli_parsing/</a></p>
<p>I posted it to these two subreddits to get a large audience, and a small but more-appropriate audience. Feel free to upvote if you want to!</p>



<a name="437152971"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/304902-show%20and%20tell/topic/Weaver%3A%20record%20builder%20CLI%20parsing%20library/near/437152971" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/304902-show-and-tell/topic/Weaver.3A.20record.20builder.20CLI.20parsing.20library.html#437152971">(May 05 2024 at 18:29)</a>:</h4>
<p>very nice, will do!</p>



<a name="437153042"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/304902-show%20and%20tell/topic/Weaver%3A%20record%20builder%20CLI%20parsing%20library/near/437153042" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/304902-show-and-tell/topic/Weaver.3A.20record.20builder.20CLI.20parsing.20library.html#437153042">(May 05 2024 at 18:30)</a>:</h4>
<p>thanks for writing it up, and on a personal note, thank you for the kind words in it <span aria-label="hug" class="emoji emoji-1f917" role="img" title="hug">:hug:</span></p>



<a name="437175853"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/304902-show%20and%20tell/topic/Weaver%3A%20record%20builder%20CLI%20parsing%20library/near/437175853" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Hannes <a href="https://roc-lang.github.io/zulip-export/stream/304902-show-and-tell/topic/Weaver.3A.20record.20builder.20CLI.20parsing.20library.html#437175853">(May 06 2024 at 00:56)</a>:</h4>
<p>I've submitted it to Lobsters, I'm not sure if Lobsters penalises upvotes from a direct link like HN does, so if you want to upvote there, go to <a href="https://lobste.rs/recent">https://lobste.rs/recent</a> and search for "Weaver" :)</p>



<a name="485598516"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/304902-show%20and%20tell/topic/Weaver%3A%20record%20builder%20CLI%20parsing%20library/near/485598516" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/304902-show-and-tell/topic/Weaver.3A.20record.20builder.20CLI.20parsing.20library.html#485598516">(Dec 02 2024 at 11:06)</a>:</h4>
<p>Weaver has been updated to work with current Roc: <a href="https://github.com/smores56/weaver/releases/tag/0.4.0">https://github.com/smores56/weaver/releases/tag/0.4.0</a></p>
<p>You should be able to use it for all your purity inference needs once that rolls out.</p>



<a name="490348207"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/304902-show%20and%20tell/topic/Weaver%3A%20record%20builder%20CLI%20parsing%20library/near/490348207" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/304902-show-and-tell/topic/Weaver.3A.20record.20builder.20CLI.20parsing.20library.html#490348207">(Dec 22 2024 at 01:56)</a>:</h4>
<h1>v0.5.1 - OS-aware arg parsing!</h1>
<p>download here: <a href="https://github.com/smores56/weaver/releases/download/0.5.1/nqyqbOkpECWgDUMbY-rG9ug883TVbOimHZFHek-bQeI.tar.br">https://github.com/smores56/weaver/releases/download/0.5.1/nqyqbOkpECWgDUMbY-rG9ug883TVbOimHZFHek-bQeI.tar.br</a></p>
<p>This release brings OS-aware arg parsing to Weaver! </p>
<p>Most operating systems don't guarantee UTF-8 encoding of arguments, and Windows doesn't even use bytes, but <code>U16</code> codepoints. To handle this for you, Weaver and <a href="https://github.com/roc-lang/basic-cli/">basic-cli</a> have provided OS-aware arguments that are <code>U8</code> lists for Unix systems and <code>U16</code> lists for Windows systems. You'll get these from <code>main!</code> in <code>basic-cli</code>, and you can call Weaver almost the same way you used to, but you'll need to pass one extra argument to <code>Cli.parse_or_display_message</code>:</p>
<div class="codehilite" data-code-language="Elm"><pre><span></span><code><span class="nv">main</span><span class="err">!</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nf">\</span><span class="nv">args</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">    </span><span class="nv">data</span><span class="w"> </span><span class="nf">=</span>
<span class="w">        </span><span class="kt">Cli</span><span class="nf">.</span><span class="nv">parse_or_display_message</span><span class="w"> </span><span class="nv">cli_parser</span><span class="w"> </span><span class="nv">args</span><span class="w"> </span><span class="kt">Arg</span><span class="nf">.</span><span class="nv">to_os_raw</span>
<span class="w">        </span><span class="nf">|&gt;</span><span class="w"> </span><span class="nv">try</span><span class="w"> </span><span class="kt">Result</span><span class="nf">.</span><span class="nv">onErr</span><span class="err">!</span><span class="w"> </span><span class="nf">\</span><span class="nv">message</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">            </span><span class="nv">try</span><span class="w"> </span><span class="kt">Stdout</span><span class="nf">.</span><span class="nv">line</span><span class="err">!</span><span class="w"> </span><span class="nv">message</span>
<span class="w">            </span><span class="kt">Err</span><span class="w"> </span><span class="p">(</span><span class="kt">Exit</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="s">""</span><span class="p">)</span>

<span class="w">    </span><span class="nv">try</span><span class="w"> </span><span class="kt">Stdout</span><span class="nf">.</span><span class="nv">line</span><span class="err">!</span><span class="w"> </span><span class="s">"Successfully parsed! Here's what I got:"</span>
<span class="w">    </span><span class="nv">try</span><span class="w"> </span><span class="kt">Stdout</span><span class="nf">.</span><span class="nv">line</span><span class="err">!</span><span class="w"> </span><span class="s">""</span>
<span class="w">    </span><span class="nv">try</span><span class="w"> </span><span class="kt">Stdout</span><span class="nf">.</span><span class="nv">line</span><span class="err">!</span><span class="w"> </span><span class="p">(</span><span class="kt">Inspect</span><span class="nf">.</span><span class="nv">toStr</span><span class="w"> </span><span class="nv">data</span><span class="p">)</span>

<span class="w">    </span><span class="kt">Ok</span><span class="w"> </span><span class="p">{}</span>
</code></pre></div>
<p>You'll see that there's an extra argument, <code>Arg.to_os_raw</code>. <code>Cli.parse_or_display_message</code> now takes a generic <code>List arg</code> for the args, and that third function is something that converts such a generic <code>arg</code> to a <code>[Unix (List U8), Windows (List U16)]</code>. <code>Arg.to_os_raw</code> is provided by <code>basic-cli</code> in the <code>Arg</code> module, but you could use any such function if you have a different <code>arg</code> type.</p>
<p>This new argument should be temporary, as with the accepted <a href="https://docs.google.com/document/d/1OUd0f4PQjH8jb6i1vEJ5DOnfpVBJbGTjnCakpXAYeT8/edit?tab=t.0#heading=h.vuo6e14bvfkt">static dispatch proposal</a> we should be able to infer a method to do this conversion.</p>
<blockquote>
<p>NOTE: <code>basic-cli</code> only just merged <a href="https://github.com/roc-lang/basic-cli/pull/293">the PR</a> for OS-aware <code>Arg</code>s, so you'll need to wait a few days for you to upgrade to using this Weaver version until <code>basic-cli</code> at least makes a pre-release.</p>
</blockquote>
<blockquote>
<p>CAUTION: <code>Str</code> and <code>Num *</code> arguments can now fail decoding if the provided command line args are not valid UTF-8.</p>
</blockquote>
<h2>Two new <code>Opt</code> and <code>Param</code> types: <code>Arg</code> and <code>List U8</code> (bytes)</h2>
<p>Now that <code>Arg</code>s are represented in a variable encoding, there are two new groups of methods available for both <code>Opt</code> and <code>Param</code>:</p>
<ul>
<li><code>Opt.arg</code> requires an <code>Arg</code> argument</li>
<li><code>Opt.maybe_arg</code> takes zero or one <code>Arg</code>s</li>
<li><code>Opt.arg_list</code> takes zero or more <code>Arg</code>s</li>
<li><code>Opt.bytes</code> requires a <code>List U8</code> argument (which it gets by infallibly converting an <code>Arg</code> to the underlying bytes)</li>
<li><code>Opt.maybe_bytes</code> takes zero or one <code>List U8</code>s</li>
<li><code>Opt.bytes_list</code> takes zero or more <code>List U8</code>s</li>
</ul>
<p>The same APIs are available for <code>Param</code>. These arg types are a great way to support reading file names might not be UTF-8 encoded.</p>



<a name="490348322"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/304902-show%20and%20tell/topic/Weaver%3A%20record%20builder%20CLI%20parsing%20library/near/490348322" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bullard <a href="https://roc-lang.github.io/zulip-export/stream/304902-show-and-tell/topic/Weaver.3A.20record.20builder.20CLI.20parsing.20library.html#490348322">(Dec 22 2024 at 01:59)</a>:</h4>
<p>Great job Luke!</p>



<a name="490348414"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/304902-show%20and%20tell/topic/Weaver%3A%20record%20builder%20CLI%20parsing%20library/near/490348414" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sam Mohr <a href="https://roc-lang.github.io/zulip-export/stream/304902-show-and-tell/topic/Weaver.3A.20record.20builder.20CLI.20parsing.20library.html#490348414">(Dec 22 2024 at 02:00)</a>:</h4>
<p>Yes, thanks to <span class="user-mention" data-user-id="515757">@Luke Boswell</span> for implementing the <code>basic-cli</code> side of things, and to the team for helping design this!</p>



<a name="490391200"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/304902-show%20and%20tell/topic/Weaver%3A%20record%20builder%20CLI%20parsing%20library/near/490391200" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Isaac Van Doren <a href="https://roc-lang.github.io/zulip-export/stream/304902-show-and-tell/topic/Weaver.3A.20record.20builder.20CLI.20parsing.20library.html#490391200">(Dec 22 2024 at 13:59)</a>:</h4>
<p>Thanks for your work on this Sam!</p>



<hr><p>Last updated: Mar 01 2026 at 12:20 UTC</p>
</html>