<html>
<head><meta charset="utf-8"><title>roc-bevies Â· show and tell Â· Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://roc-lang.github.io/zulip-export/stream/304902-show-and-tell/index.html">show and tell</a></h2>
<h3>Topic: <a href="https://roc-lang.github.io/zulip-export/stream/304902-show-and-tell/topic/roc-bevies.html">roc-bevies</a></h3>

<hr>

<base href="https://roc.zulipchat.com">

<head><link href="https://roc-lang.github.io/zulip-export/style.css" rel="stylesheet"></head>

<a name="270167094"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/304902-show%20and%20tell/topic/roc-bevies/near/270167094" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jan kili <a href="https://roc-lang.github.io/zulip-export/stream/304902-show-and-tell/topic/roc-bevies.html#270167094">(Feb 01 2022 at 08:18)</a>:</h4>
<p>I don't know if this counts as "the first Roc game", since all Roc is doing is adjusting the speed of the ball+paddle... but it works great!<br>
<a href="https://github.com/JanCVanB/roc-bevies">https://github.com/JanCVanB/roc-bevies</a></p>
<p><a href="/user_uploads/22008/Qpep-iLsmMJZO057kA2b0DOu/breakout.gif">breakout gameplay</a></p>
<div class="message_inline_image"><a href="/user_uploads/22008/Qpep-iLsmMJZO057kA2b0DOu/breakout.gif" title="breakout gameplay"><img src="/user_uploads/22008/Qpep-iLsmMJZO057kA2b0DOu/breakout.gif"></a></div>



<a name="270167419"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/304902-show%20and%20tell/topic/roc-bevies/near/270167419" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/304902-show-and-tell/topic/roc-bevies.html#270167419">(Feb 01 2022 at 08:21)</a>:</h4>
<p>oh very cool!</p>



<a name="270167446"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/304902-show%20and%20tell/topic/roc-bevies/near/270167446" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/304902-show-and-tell/topic/roc-bevies.html#270167446">(Feb 01 2022 at 08:21)</a>:</h4>
<p>the platform should be able to accept an u16, I can check why that did not work later today</p>



<a name="270167708"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/304902-show%20and%20tell/topic/roc-bevies/near/270167708" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jan kili <a href="https://roc-lang.github.io/zulip-export/stream/304902-show-and-tell/topic/roc-bevies.html#270167708">(Feb 01 2022 at 08:23)</a>:</h4>
<p>Thanks! This is my first original (not entirely copy-pasted) Rust code, so it's likely that I misunderstood <code>roc_std</code>'s (and Bevy's) constraints.</p>



<a name="270293199"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/304902-show%20and%20tell/topic/roc-bevies/near/270293199" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/304902-show-and-tell/topic/roc-bevies.html#270293199">(Feb 01 2022 at 21:48)</a>:</h4>
<p>so bevy does not work for me currently (linker problems), but looking at the LLVM IR I don't see why having the roc code (ultimately <code>speedForHost</code>) return an <code>I16</code>. What was the problem you ran into?</p>



<a name="270297116"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/304902-show%20and%20tell/topic/roc-bevies/near/270297116" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jan kili <a href="https://roc-lang.github.io/zulip-export/stream/304902-show-and-tell/topic/roc-bevies.html#270297116">(Feb 01 2022 at 22:15)</a>:</h4>
<p>I was simply hacking naively until something worked, so this could all be incorrect: The equation it plugs into seems to expect an f32, and Rust told me that it couldn't autocast an i128 to an f32. Instead, it suggested that it could do so for an i16, so I went with that.</p>



<a name="270297509"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/304902-show%20and%20tell/topic/roc-bevies/near/270297509" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/304902-show-and-tell/topic/roc-bevies.html#270297509">(Feb 01 2022 at 22:18)</a>:</h4>
<p>are there downsides to roc just giving you an f32?</p>



<a name="270298735"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/304902-show%20and%20tell/topic/roc-bevies/near/270298735" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jan kili <a href="https://roc-lang.github.io/zulip-export/stream/304902-show-and-tell/topic/roc-bevies.html#270298735">(Feb 01 2022 at 22:28)</a>:</h4>
<p>No, that would be great! I was working under the assumption that the only types I could pass between Roc &amp; Rust were the <code>pub RocFoo</code> things in <code>roc_std/</code>, so basically <code>RocStr</code>, <code>RocDec</code>, and <code>RocResult</code>.</p>



<a name="270298760"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/304902-show%20and%20tell/topic/roc-bevies/near/270298760" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/304902-show-and-tell/topic/roc-bevies.html#270298760">(Feb 01 2022 at 22:28)</a>:</h4>
<p>oh, no</p>



<a name="270298775"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/304902-show%20and%20tell/topic/roc-bevies/near/270298775" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/304902-show-and-tell/topic/roc-bevies.html#270298775">(Feb 01 2022 at 22:28)</a>:</h4>
<p>all the primitive types also work</p>



<a name="270298795"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/304902-show%20and%20tell/topic/roc-bevies/near/270298795" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/304902-show-and-tell/topic/roc-bevies.html#270298795">(Feb 01 2022 at 22:28)</a>:</h4>
<p>so ints and floats</p>



<a name="270298810"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/304902-show%20and%20tell/topic/roc-bevies/near/270298810" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jan kili <a href="https://roc-lang.github.io/zulip-export/stream/304902-show-and-tell/topic/roc-bevies.html#270298810">(Feb 01 2022 at 22:28)</a>:</h4>
<p>ðŸ¤¯</p>



<a name="270298869"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/304902-show%20and%20tell/topic/roc-bevies/near/270298869" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/304902-show-and-tell/topic/roc-bevies.html#270298869">(Feb 01 2022 at 22:29)</a>:</h4>
<p>these map 1 to 1 (except <code>Nat</code> becomes <code>usize</code>)</p>



<a name="270298894"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/304902-show%20and%20tell/topic/roc-bevies/near/270298894" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jan kili <a href="https://roc-lang.github.io/zulip-export/stream/304902-show-and-tell/topic/roc-bevies.html#270298894">(Feb 01 2022 at 22:29)</a>:</h4>
<p>Well that's wonderful.</p>



<a name="270298953"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/304902-show%20and%20tell/topic/roc-bevies/near/270298953" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/304902-show-and-tell/topic/roc-bevies.html#270298953">(Feb 01 2022 at 22:29)</a>:</h4>
<p>and as I said elsewhere records/structs also work in a predictable but not always intuitive way</p>



<a name="270298958"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/304902-show%20and%20tell/topic/roc-bevies/near/270298958" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jan kili <a href="https://roc-lang.github.io/zulip-export/stream/304902-show-and-tell/topic/roc-bevies.html#270298958">(Feb 01 2022 at 22:29)</a>:</h4>
<p>I think I skimmed the examples and only found <code>RocStr</code> used.</p>



<a name="270299032"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/304902-show%20and%20tell/topic/roc-bevies/near/270299032" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/304902-show-and-tell/topic/roc-bevies.html#270299032">(Feb 01 2022 at 22:30)</a>:</h4>
<p>so far sending integers was boring</p>



<a name="270299145"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/304902-show%20and%20tell/topic/roc-bevies/near/270299145" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jan kili <a href="https://roc-lang.github.io/zulip-export/stream/304902-show-and-tell/topic/roc-bevies.html#270299145">(Feb 01 2022 at 22:31)</a>:</h4>
<p>Me: "Passing ints &amp; floats must be hard, somehow. Dec it is!"</p>



<a name="270299436"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/304902-show%20and%20tell/topic/roc-bevies/near/270299436" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/304902-show-and-tell/topic/roc-bevies.html#270299436">(Feb 01 2022 at 22:33)</a>:</h4>
<p>we just happen to agree on what the bits mean for number types</p>



<a name="270299472"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/304902-show%20and%20tell/topic/roc-bevies/near/270299472" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/304902-show-and-tell/topic/roc-bevies.html#270299472">(Feb 01 2022 at 22:33)</a>:</h4>
<p>for strings for instance that is not true, because we have the small string optimization</p>



<a name="270299700"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/304902-show%20and%20tell/topic/roc-bevies/near/270299700" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jan kili <a href="https://roc-lang.github.io/zulip-export/stream/304902-show-and-tell/topic/roc-bevies.html#270299700">(Feb 01 2022 at 22:35)</a>:</h4>
<p>Therefore, my next steps for roc-bevies is to (a) simplify int passing and (b) expanding breakout to populate most constant values &amp;  primitive formulae with Int/Float/Str/function fields of a big Roc configuration record</p>



<a name="270299905"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/304902-show%20and%20tell/topic/roc-bevies/near/270299905" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jan kili <a href="https://roc-lang.github.io/zulip-export/stream/304902-show-and-tell/topic/roc-bevies.html#270299905">(Feb 01 2022 at 22:37)</a>:</h4>
<p>I love the idea of Rust/Bevy handling all the heavy rendering logic, then asking its boss Roc "hey, what sprite should I use here, and how many points does the player get for this?"</p>



<a name="270300673"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/304902-show%20and%20tell/topic/roc-bevies/near/270300673" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/304902-show-and-tell/topic/roc-bevies.html#270300673">(Feb 01 2022 at 22:43)</a>:</h4>
<p>yes! I think it gets really interesting if the roc app stores some state</p>



<a name="270300927"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/304902-show%20and%20tell/topic/roc-bevies/near/270300927" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jan kili <a href="https://roc-lang.github.io/zulip-export/stream/304902-show-and-tell/topic/roc-bevies.html#270300927">(Feb 01 2022 at 22:45)</a>:</h4>
<p>How??</p>



<a name="270300942"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/304902-show%20and%20tell/topic/roc-bevies/near/270300942" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jan kili <a href="https://roc-lang.github.io/zulip-export/stream/304902-show-and-tell/topic/roc-bevies.html#270300942">(Feb 01 2022 at 22:45)</a>:</h4>
<p>Monadically?</p>



<a name="270301126"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/304902-show%20and%20tell/topic/roc-bevies/near/270301126" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jan kili <a href="https://roc-lang.github.io/zulip-export/stream/304902-show-and-tell/topic/roc-bevies.html#270301126">(Feb 01 2022 at 22:47)</a>:</h4>
<p>I'd love to hear an example :D</p>



<a name="270301471"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/304902-show%20and%20tell/topic/roc-bevies/near/270301471" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/304902-show-and-tell/topic/roc-bevies.html#270301471">(Feb 01 2022 at 22:50)</a>:</h4>
<p>No, I think game logic could live in roc. This may be a bit contrived but</p>
<div class="codehilite"><pre><span></span><code>Model : { score : U64 }

Msg : [ ScoredPoint ]

update : Model, Msg -&gt; Model
update = \model, msg -&gt;
    when msg is
        ScoredPoint -&gt; { score: model.score + 1 }


view : Model -&gt; U64
view = .score
</code></pre></div>



<a name="270301524"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/304902-show%20and%20tell/topic/roc-bevies/near/270301524" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/304902-show-and-tell/topic/roc-bevies.html#270301524">(Feb 01 2022 at 22:50)</a>:</h4>
<p>you'd also need <code>init = { score: 0 }</code></p>



<a name="270301638"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/304902-show%20and%20tell/topic/roc-bevies/near/270301638" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/304902-show-and-tell/topic/roc-bevies.html#270301638">(Feb 01 2022 at 22:51)</a>:</h4>
<p>then the platform can call <code>init</code>, and then update the model it has every time a game event happens (e.g. score is increased), and "render" the score when needed</p>



<a name="270301786"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/304902-show%20and%20tell/topic/roc-bevies/near/270301786" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/304902-show-and-tell/topic/roc-bevies.html#270301786">(Feb 01 2022 at 22:52)</a>:</h4>
<p>does this make sense in practice? I don't really know, but it's possible</p>



<a name="270306463"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/304902-show%20and%20tell/topic/roc-bevies/near/270306463" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jan kili <a href="https://roc-lang.github.io/zulip-export/stream/304902-show-and-tell/topic/roc-bevies.html#270306463">(Feb 01 2022 at 23:27)</a>:</h4>
<p>Yes! This update-state-on-event loop is common in games, and Bevy has a managed hyperscalable version of that pattern in its ECS architecture</p>



<a name="270307644"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/304902-show%20and%20tell/topic/roc-bevies/near/270307644" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jan kili <a href="https://roc-lang.github.io/zulip-export/stream/304902-show-and-tell/topic/roc-bevies.html#270307644">(Feb 01 2022 at 23:37)</a>:</h4>
<p>I suppose that Roc could complement an ECS platform with its own additional state management layer, but I'm not sure why it would</p>



<a name="270307859"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/304902-show%20and%20tell/topic/roc-bevies/near/270307859" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jan kili <a href="https://roc-lang.github.io/zulip-export/stream/304902-show-and-tell/topic/roc-bevies.html#270307859">(Feb 01 2022 at 23:39)</a>:</h4>
<p>If your app doesn't have a fixed timestep, that could be a fun pattern for discrete event simulations :)</p>



<a name="270329497"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/304902-show%20and%20tell/topic/roc-bevies/near/270329497" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jan kili <a href="https://roc-lang.github.io/zulip-export/stream/304902-show-and-tell/topic/roc-bevies.html#270329497">(Feb 02 2022 at 03:46)</a>:</h4>
<p>On second thought, since Bevy claims to be modular, moving state management (data layer, ECS, whatever) into Roc could be quite fun</p>



<a name="270329558"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/304902-show%20and%20tell/topic/roc-bevies/near/270329558" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jan kili <a href="https://roc-lang.github.io/zulip-export/stream/304902-show-and-tell/topic/roc-bevies.html#270329558">(Feb 02 2022 at 03:47)</a>:</h4>
<p>I'm pretty bummed that it looks like Roc can't define Bevy game nouns (entities are defined via Rust struct literals) or verbs (system functions reference entity types), only support them with primitive-passing functions. Is that accurate?</p>



<a name="270353653"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/304902-show%20and%20tell/topic/roc-bevies/near/270353653" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Matthias Devlamynck <a href="https://roc-lang.github.io/zulip-export/stream/304902-show-and-tell/topic/roc-bevies.html#270353653">(Feb 02 2022 at 09:11)</a>:</h4>
<p>I guess you'd need to have your platform code create rust types (macro?) from roc types.</p>



<a name="270353833"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/304902-show%20and%20tell/topic/roc-bevies/near/270353833" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Matthias Devlamynck <a href="https://roc-lang.github.io/zulip-export/stream/304902-show-and-tell/topic/roc-bevies.html#270353833">(Feb 02 2022 at 09:13)</a>:</h4>
<p>Mirroring bevy's systems API to expose it to Roc may prove to be difficult ^^'</p>



<a name="270373768"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/304902-show%20and%20tell/topic/roc-bevies/near/270373768" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/304902-show-and-tell/topic/roc-bevies.html#270373768">(Feb 02 2022 at 12:12)</a>:</h4>
<p>actrually <span class="user-mention" data-user-id="281383">@Richard Feldman</span> have you thought about this? I remember we discussed writing database plugins in Roc which would run into the same issues: you'd want the database to understand your specific roc data structure. As far as I know, you can only do that with additional code gen</p>



<a name="270373814"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/304902-show%20and%20tell/topic/roc-bevies/near/270373814" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/304902-show-and-tell/topic/roc-bevies.html#270373814">(Feb 02 2022 at 12:12)</a>:</h4>
<p>e.g. for postgress extensions in rust you need to derive a bunch of things</p>



<a name="270373824"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/304902-show%20and%20tell/topic/roc-bevies/near/270373824" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/304902-show-and-tell/topic/roc-bevies.html#270373824">(Feb 02 2022 at 12:12)</a>:</h4>
<p>and it generates a ton of C code</p>



<a name="270374007"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/304902-show%20and%20tell/topic/roc-bevies/near/270374007" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jan kili <a href="https://roc-lang.github.io/zulip-export/stream/304902-show-and-tell/topic/roc-bevies.html#270374007">(Feb 02 2022 at 12:14)</a>:</h4>
<p><span aria-label="nerd" class="emoji emoji-1f913" role="img" title="nerd">:nerd:</span><span aria-label="memo" class="emoji emoji-1f4dd" role="img" title="memo">:memo:</span></p>



<a name="270375692"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/304902-show%20and%20tell/topic/roc-bevies/near/270375692" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/304902-show-and-tell/topic/roc-bevies.html#270375692">(Feb 02 2022 at 12:30)</a>:</h4>
<p>so what we'd talked about awhile ago (a year or so maybe?) was something along these lines:</p>
<ul>
<li>Give the Roc compiler CLI a command where you give it a <code>.roc</code> file and it outputs a serialized representation (exact format TBD) of all the types that would get sent to the host, in a format that includes all the necessary low-level information (e.g. struct field ordering would have already taken into account alignment and alphabetizing)</li>
<li>Anyone can now take that serialized representation and write a generator for a particular language, e.g. one that goes from that representation to Rust type declarations, another that goes to C declarations, etc.</li>
</ul>
<p>we hadn't talked about it in the context of Rust macros needing to get involved, but one idea for a particularly fancy way that could potentially work: in your Rust host's <code>build.rs</code>, use <span aria-label="point up" class="emoji emoji-1f446" role="img" title="point up">:point_up:</span> to generate <code>.rs</code> files from your Roc types, with the (un-annotated) structs and everything, then - still in <code>build.rs</code> - modify those files to add the annotations (e.g. find/replace <code>struct Player {</code> with <code>#[derive(BevyStuff)]\nstruct Player {</code>), and then let the build continue as normal.</p>



<a name="270375998"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/304902-show%20and%20tell/topic/roc-bevies/near/270375998" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Feldman <a href="https://roc-lang.github.io/zulip-export/stream/304902-show-and-tell/topic/roc-bevies.html#270375998">(Feb 02 2022 at 12:34)</a>:</h4>
<p>so assuming all the generator prerequisites were in place (they don't exist yet, of course!) the workflow would be:</p>
<ul>
<li>The Roc types are the source of truth; you can just change them whenever</li>
<li>The <code>build.rs</code> stuff will take care of keeping the Rust types in sync with the Roc types, and adding any annotations Bevy needs, so you can also build your Rust project with <code>cargo</code> as normal and it will stay in sync</li>
</ul>
<p>of course there's some extra setup work involved to make that generation/substitution happen at the right time, but I don't think that's avoidable in the general case whenever the goal is to sync type definitions between two decoupled programming languages <span aria-label="big smile" class="emoji emoji-1f604" role="img" title="big smile">:big_smile:</span></p>



<a name="270376253"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/304902-show%20and%20tell/topic/roc-bevies/near/270376253" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/304902-show-and-tell/topic/roc-bevies.html#270376253">(Feb 02 2022 at 12:36)</a>:</h4>
<p>Right, the challenge is then to make the whole rust/c/zig codegen bit hidden from the Roc user</p>



<a name="270376300"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/304902-show%20and%20tell/topic/roc-bevies/near/270376300" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Folkert de Vries <a href="https://roc-lang.github.io/zulip-export/stream/304902-show-and-tell/topic/roc-bevies.html#270376300">(Feb 02 2022 at 12:37)</a>:</h4>
<p>for <a href="https://github.com/zombodb/pgx">https://github.com/zombodb/pgx</a> they do this with a custom cargo command</p>



<a name="270376345"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/304902-show%20and%20tell/topic/roc-bevies/near/270376345" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jan kili <a href="https://roc-lang.github.io/zulip-export/stream/304902-show-and-tell/topic/roc-bevies.html#270376345">(Feb 02 2022 at 12:37)</a>:</h4>
<p><span class="user-mention" data-user-id="281383">@Richard Feldman</span> That sounds awesome! I had no idea Roc could get that powerful.</p>



<a name="270382193"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/304902-show%20and%20tell/topic/roc-bevies/near/270382193" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jan kili <a href="https://roc-lang.github.io/zulip-export/stream/304902-show-and-tell/topic/roc-bevies.html#270382193">(Feb 02 2022 at 13:22)</a>:</h4>
<p>That codegen feature addition would enable replacing <code>roc-bevies</code> (dozens of subgenre-specific platforms) with <code>roc-bevy</code> (one general-purpose gamedev platform).</p>



<a name="270428880"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/304902-show%20and%20tell/topic/roc-bevies/near/270428880" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lucas Rosa <a href="https://roc-lang.github.io/zulip-export/stream/304902-show-and-tell/topic/roc-bevies.html#270428880">(Feb 02 2022 at 17:52)</a>:</h4>
<p>cool stuff!</p>



<a name="271231607"></a>
<h4><a href="https://roc.zulipchat.com#narrow/stream/304902-show%20and%20tell/topic/roc-bevies/near/271231607" class="zl"><img src="https://roc-lang.github.io/zulip-export/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jan kili <a href="https://roc-lang.github.io/zulip-export/stream/304902-show-and-tell/topic/roc-bevies.html#271231607">(Feb 09 2022 at 05:09)</a>:</h4>
<p><span class="user-mention" data-user-id="281543">@Folkert de Vries</span> <span aria-label="smiley" class="emoji emoji-1f603" role="img" title="smiley">:smiley:</span> <a href="https://github.com/JanCVanB/roc-bevies/commit/70fc0e">https://github.com/JanCVanB/roc-bevies/commit/70fc0e</a></p>



<hr><p>Last updated: Nov 01 2025 at 12:13 UTC</p>
</html>